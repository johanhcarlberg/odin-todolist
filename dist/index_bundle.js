/*! For license information please see index_bundle.js.LICENSE.txt */
(()=>{var t={454:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".add-container {\r\n    position: relative;\r\n}\r\n\r\n.icon-container {\r\n    display: grid;\r\n    grid-template-columns: 1fr min-content;\r\n}\r\n\r\n.add-icon {\r\n    height: 20px;\r\n    width: 20px;\r\n    align-self: center;\r\n    fill: #333;\r\n}\r\n\r\n.icon-container:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.chevron-icon {\r\n    height: 14px;\r\n    width: 14px;\r\n    align-self: end;\r\n    fill: #333;\r\n}\r\n\r\n.add-dropdown {\r\n    position: absolute;\r\n    top: 100%;\r\n    right: 25%;\r\n    width: max-content;\r\n    background-color: #fff;\r\n    border: 1px solid #000;\r\n}\r\n\r\n.add-dropdown-list {\r\n    list-style: none;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 0;\r\n    margin: 0;\r\n    flex: 1;\r\n}\r\n\r\n.add-dropdown-list li {\r\n    padding: 10px 20px;\r\n    font-size: 14px;\r\n}\r\n\r\n.add-dropdown-list li:hover {\r\n    background-color: #eee;\r\n}\r\n\r\n.add-dropdown-list a {\r\n    text-decoration: none;\r\n    color: #333;\r\n}","",{version:3,sources:["webpack://./src/components/AddComponent.css"],names:[],mappings:"AAAA;IACI,kBAAkB;AACtB;;AAEA;IACI,aAAa;IACb,sCAAsC;AAC1C;;AAEA;IACI,YAAY;IACZ,WAAW;IACX,kBAAkB;IAClB,UAAU;AACd;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,YAAY;IACZ,WAAW;IACX,eAAe;IACf,UAAU;AACd;;AAEA;IACI,kBAAkB;IAClB,SAAS;IACT,UAAU;IACV,kBAAkB;IAClB,sBAAsB;IACtB,sBAAsB;AAC1B;;AAEA;IACI,gBAAgB;IAChB,aAAa;IACb,sBAAsB;IACtB,UAAU;IACV,SAAS;IACT,OAAO;AACX;;AAEA;IACI,kBAAkB;IAClB,eAAe;AACnB;;AAEA;IACI,sBAAsB;AAC1B;;AAEA;IACI,qBAAqB;IACrB,WAAW;AACf",sourcesContent:[".add-container {\r\n    position: relative;\r\n}\r\n\r\n.icon-container {\r\n    display: grid;\r\n    grid-template-columns: 1fr min-content;\r\n}\r\n\r\n.add-icon {\r\n    height: 20px;\r\n    width: 20px;\r\n    align-self: center;\r\n    fill: #333;\r\n}\r\n\r\n.icon-container:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.chevron-icon {\r\n    height: 14px;\r\n    width: 14px;\r\n    align-self: end;\r\n    fill: #333;\r\n}\r\n\r\n.add-dropdown {\r\n    position: absolute;\r\n    top: 100%;\r\n    right: 25%;\r\n    width: max-content;\r\n    background-color: #fff;\r\n    border: 1px solid #000;\r\n}\r\n\r\n.add-dropdown-list {\r\n    list-style: none;\r\n    display: flex;\r\n    flex-direction: column;\r\n    padding: 0;\r\n    margin: 0;\r\n    flex: 1;\r\n}\r\n\r\n.add-dropdown-list li {\r\n    padding: 10px 20px;\r\n    font-size: 14px;\r\n}\r\n\r\n.add-dropdown-list li:hover {\r\n    background-color: #eee;\r\n}\r\n\r\n.add-dropdown-list a {\r\n    text-decoration: none;\r\n    color: #333;\r\n}"],sourceRoot:""}]);const a=o},110:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".checkbox {\r\n    border: 1px solid #333;\r\n    width: 25px;\r\n    height: 25px;\r\n    background-color: #fff;\r\n}\r\n\r\n.checkbox.critical {\r\n    background-color: rgb(253, 246, 246);\r\n    border: 1px solid rgb(255, 58, 58);\r\n}\r\n\r\n.checkbox.important {\r\n    background-color: rgb(253, 250, 245);\r\n    border: 1px solid rgb(255, 182, 25);\r\n}","",{version:3,sources:["webpack://./src/components/Checkbox.css"],names:[],mappings:"AAAA;IACI,sBAAsB;IACtB,WAAW;IACX,YAAY;IACZ,sBAAsB;AAC1B;;AAEA;IACI,oCAAoC;IACpC,kCAAkC;AACtC;;AAEA;IACI,oCAAoC;IACpC,mCAAmC;AACvC",sourcesContent:[".checkbox {\r\n    border: 1px solid #333;\r\n    width: 25px;\r\n    height: 25px;\r\n    background-color: #fff;\r\n}\r\n\r\n.checkbox.critical {\r\n    background-color: rgb(253, 246, 246);\r\n    border: 1px solid rgb(255, 58, 58);\r\n}\r\n\r\n.checkbox.important {\r\n    background-color: rgb(253, 250, 245);\r\n    border: 1px solid rgb(255, 182, 25);\r\n}"],sourceRoot:""}]);const a=o},938:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".sidebar-link-item > a {\r\n    display: grid;\r\n    grid-template-columns: min-content 1fr 1fr;\r\n    text-decoration: none;\r\n    color: #000;\r\n    padding: 5px;\r\n    font-size: 14px;\r\n    align-items: center;\r\n    gap: 5px;\r\n}\r\n\r\n.sidebar-link-item > a:hover {\r\n    text-decoration: none;\r\n    background-color: #eee;\r\n}\r\n\r\n.sidebar-link-list-header > a {\r\n    font-weight: bold;\r\n}\r\n\r\n.sidebar-link-item-number {\r\n    background-color: #dedede;\r\n    padding: 2px 6px;\r\n    border-radius: 40%;\r\n    justify-self: end;\r\n    grid-column: 3;\r\n}\r\n\r\n.sidebar-link-item i {\r\n    height: 18px;\r\n    width: 18px;\r\n}\r\n\r\n.sidebar-link-item i > svg {\r\n    fill: #333;\r\n}","",{version:3,sources:["webpack://./src/components/SidebarLinkItem.css"],names:[],mappings:"AAAA;IACI,aAAa;IACb,0CAA0C;IAC1C,qBAAqB;IACrB,WAAW;IACX,YAAY;IACZ,eAAe;IACf,mBAAmB;IACnB,QAAQ;AACZ;;AAEA;IACI,qBAAqB;IACrB,sBAAsB;AAC1B;;AAEA;IACI,iBAAiB;AACrB;;AAEA;IACI,yBAAyB;IACzB,gBAAgB;IAChB,kBAAkB;IAClB,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,YAAY;IACZ,WAAW;AACf;;AAEA;IACI,UAAU;AACd",sourcesContent:[".sidebar-link-item > a {\r\n    display: grid;\r\n    grid-template-columns: min-content 1fr 1fr;\r\n    text-decoration: none;\r\n    color: #000;\r\n    padding: 5px;\r\n    font-size: 14px;\r\n    align-items: center;\r\n    gap: 5px;\r\n}\r\n\r\n.sidebar-link-item > a:hover {\r\n    text-decoration: none;\r\n    background-color: #eee;\r\n}\r\n\r\n.sidebar-link-list-header > a {\r\n    font-weight: bold;\r\n}\r\n\r\n.sidebar-link-item-number {\r\n    background-color: #dedede;\r\n    padding: 2px 6px;\r\n    border-radius: 40%;\r\n    justify-self: end;\r\n    grid-column: 3;\r\n}\r\n\r\n.sidebar-link-item i {\r\n    height: 18px;\r\n    width: 18px;\r\n}\r\n\r\n.sidebar-link-item i > svg {\r\n    fill: #333;\r\n}"],sourceRoot:""}]);const a=o},411:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".todo-items-list {\r\n    list-style: none;\r\n}\r\n\r\n.todo-items-list li {\r\n    display: grid;\r\n    grid-template-columns: min-content 1fr;\r\n    grid-template-rows: 1fr 1fr;\r\n    align-items: center;\r\n    gap: 10px;\r\n    border-bottom: 1px solid #ccc;\r\n    padding: 10px;\r\n    cursor: pointer;\r\n}\r\n\r\n.todo-items-list li.checked {\r\n    background-color: #eee;\r\n    color: #555;\r\n}\r\n\r\n.todo-items-list li.checked .checkbox{\r\n    background-color: #eee;\r\n    border: 1px solid #777;\r\n    fill: #777;\r\n}\r\n\r\n.todo-items-list li:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.todo-items-list .checkbox {\r\n    grid-row: 1 / span 2;\r\n}\r\n\r\n.todo-items-list-item-content {\r\n    grid-row: 1 / span 2;\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n}\r\n\r\n\r\n","",{version:3,sources:["webpack://./src/components/TodoItemsList.css"],names:[],mappings:"AAAA;IACI,gBAAgB;AACpB;;AAEA;IACI,aAAa;IACb,sCAAsC;IACtC,2BAA2B;IAC3B,mBAAmB;IACnB,SAAS;IACT,6BAA6B;IAC7B,aAAa;IACb,eAAe;AACnB;;AAEA;IACI,sBAAsB;IACtB,WAAW;AACf;;AAEA;IACI,sBAAsB;IACtB,sBAAsB;IACtB,UAAU;AACd;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,oBAAoB;AACxB;;AAEA;IACI,oBAAoB;IACpB,aAAa;IACb,2BAA2B;AAC/B",sourcesContent:[".todo-items-list {\r\n    list-style: none;\r\n}\r\n\r\n.todo-items-list li {\r\n    display: grid;\r\n    grid-template-columns: min-content 1fr;\r\n    grid-template-rows: 1fr 1fr;\r\n    align-items: center;\r\n    gap: 10px;\r\n    border-bottom: 1px solid #ccc;\r\n    padding: 10px;\r\n    cursor: pointer;\r\n}\r\n\r\n.todo-items-list li.checked {\r\n    background-color: #eee;\r\n    color: #555;\r\n}\r\n\r\n.todo-items-list li.checked .checkbox{\r\n    background-color: #eee;\r\n    border: 1px solid #777;\r\n    fill: #777;\r\n}\r\n\r\n.todo-items-list li:last-child {\r\n    border-bottom: none;\r\n}\r\n\r\n.todo-items-list .checkbox {\r\n    grid-row: 1 / span 2;\r\n}\r\n\r\n.todo-items-list-item-content {\r\n    grid-row: 1 / span 2;\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n}\r\n\r\n\r\n"],sourceRoot:""}]);const a=o},9:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,"header {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr;\r\n    align-items: center;\r\n    background-color: #FC8621;\r\n    grid-row: 1;\r\n    grid-column: 1 / span 2;\r\n}\r\n\r\n.buttons-container {\r\n    grid-column: 2;\r\n    grid-row: 1;\r\n    display: flex;\r\n    margin-right: 4rem;\r\n    gap: 25px;\r\n    align-items: center;\r\n    justify-content: end;\r\n}\r\n\r\n.buttons-container button {\r\n    padding: 10px 30px;\r\n    font-weight: bold;\r\n    border-radius: 8px;\r\n    color: #333;\r\n    background-color: #fff;\r\n}\r\n\r\n.add-todo-button {\r\n    border: 1px solid #0099ff;\r\n}\r\n\r\n.buttons-container button:hover {\r\n    cursor: pointer;\r\n    background-color: #eee;\r\n}\r\n\r\n.add-project-button {\r\n    border: 1px solid #2eec57;\r\n}\r\n\r\nnav {\r\n    justify-self: start;\r\n    grid-column: 1;\r\n    grid-row: 1;\r\n    margin-left: 2rem;\r\n}\r\n\r\nnav ul {\r\n    list-style: none;\r\n}\r\n\r\nnav ul li a {\r\n    text-decoration: none;\r\n    color: #333;\r\n}\r\n\r\n.logo-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n    margin-left: 20px;\r\n}\r\n\r\n.logo-container:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.logo-text {\r\n    font-weight: bold;\r\n    font-size: 18px;\r\n    color: #222;\r\n}\r\n\r\n.logo-icon {\r\n    width: 32px;\r\n    height: 32px;\r\n    fill: #222;\r\n}","",{version:3,sources:["webpack://./src/modules/Layout/header.css"],names:[],mappings:"AAAA;IACI,aAAa;IACb,8BAA8B;IAC9B,mBAAmB;IACnB,yBAAyB;IACzB,WAAW;IACX,uBAAuB;AAC3B;;AAEA;IACI,cAAc;IACd,WAAW;IACX,aAAa;IACb,kBAAkB;IAClB,SAAS;IACT,mBAAmB;IACnB,oBAAoB;AACxB;;AAEA;IACI,kBAAkB;IAClB,iBAAiB;IACjB,kBAAkB;IAClB,WAAW;IACX,sBAAsB;AAC1B;;AAEA;IACI,yBAAyB;AAC7B;;AAEA;IACI,eAAe;IACf,sBAAsB;AAC1B;;AAEA;IACI,yBAAyB;AAC7B;;AAEA;IACI,mBAAmB;IACnB,cAAc;IACd,WAAW;IACX,iBAAiB;AACrB;;AAEA;IACI,gBAAgB;AACpB;;AAEA;IACI,qBAAqB;IACrB,WAAW;AACf;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,QAAQ;IACR,iBAAiB;AACrB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,iBAAiB;IACjB,eAAe;IACf,WAAW;AACf;;AAEA;IACI,WAAW;IACX,YAAY;IACZ,UAAU;AACd",sourcesContent:["header {\r\n    display: grid;\r\n    grid-template-columns: 1fr 1fr;\r\n    align-items: center;\r\n    background-color: #FC8621;\r\n    grid-row: 1;\r\n    grid-column: 1 / span 2;\r\n}\r\n\r\n.buttons-container {\r\n    grid-column: 2;\r\n    grid-row: 1;\r\n    display: flex;\r\n    margin-right: 4rem;\r\n    gap: 25px;\r\n    align-items: center;\r\n    justify-content: end;\r\n}\r\n\r\n.buttons-container button {\r\n    padding: 10px 30px;\r\n    font-weight: bold;\r\n    border-radius: 8px;\r\n    color: #333;\r\n    background-color: #fff;\r\n}\r\n\r\n.add-todo-button {\r\n    border: 1px solid #0099ff;\r\n}\r\n\r\n.buttons-container button:hover {\r\n    cursor: pointer;\r\n    background-color: #eee;\r\n}\r\n\r\n.add-project-button {\r\n    border: 1px solid #2eec57;\r\n}\r\n\r\nnav {\r\n    justify-self: start;\r\n    grid-column: 1;\r\n    grid-row: 1;\r\n    margin-left: 2rem;\r\n}\r\n\r\nnav ul {\r\n    list-style: none;\r\n}\r\n\r\nnav ul li a {\r\n    text-decoration: none;\r\n    color: #333;\r\n}\r\n\r\n.logo-container {\r\n    display: flex;\r\n    align-items: center;\r\n    gap: 5px;\r\n    margin-left: 20px;\r\n}\r\n\r\n.logo-container:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.logo-text {\r\n    font-weight: bold;\r\n    font-size: 18px;\r\n    color: #222;\r\n}\r\n\r\n.logo-icon {\r\n    width: 32px;\r\n    height: 32px;\r\n    fill: #222;\r\n}"],sourceRoot:""}]);const a=o},464:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".sidebar {\r\n    grid-column: 1;\r\n    grid-row: 2;\r\n\r\n    background-color: #FAF9F6;\r\n    padding: 10px 20px 10px 10px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 30px;\r\n}\r\n\r\n.sidebar-link-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    list-style: none;\r\n}\r\n\r\n","",{version:3,sources:["webpack://./src/modules/Layout/sidebar.css"],names:[],mappings:"AAAA;IACI,cAAc;IACd,WAAW;;IAEX,yBAAyB;IACzB,4BAA4B;IAC5B,aAAa;IACb,sBAAsB;IACtB,SAAS;AACb;;AAEA;IACI,aAAa;IACb,sBAAsB;IACtB,gBAAgB;AACpB",sourcesContent:[".sidebar {\r\n    grid-column: 1;\r\n    grid-row: 2;\r\n\r\n    background-color: #FAF9F6;\r\n    padding: 10px 20px 10px 10px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: 30px;\r\n}\r\n\r\n.sidebar-link-list {\r\n    display: flex;\r\n    flex-direction: column;\r\n    list-style: none;\r\n}\r\n\r\n"],sourceRoot:""}]);const a=o},780:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,"\r\n.todo-items-container {\r\n    display: grid;\r\n    gap: 25px;\r\n    grid-template-columns: minmax(300px, min-content);\r\n}\r\n\r\n\r\n\r\n.todo-item {\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n    grid-template-columns: minmax(200px, 300px) minmax(200px, 300px);\r\n    align-items: center;\r\n    border: 1px solid #ccc;\r\n    border-left: 8px solid rgb(68, 127, 255);\r\n\r\n    border-radius: 4px;\r\n    padding: 5px 10px;\r\n    background-color: #FAF9F6;\r\n}\r\n\r\n.todo-item:hover {\r\n    box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16);\r\n    cursor: pointer;\r\n}\r\n\r\n.todo-item h3 {\r\n    margin: 0;\r\n    padding: 0;\r\n    align-self: end;\r\n}\r\n\r\n.todo-item h3 a {\r\n    text-decoration: none;\r\n    color: #000;\r\n}\r\n\r\n.checkBoxContainer {\r\n    justify-self: end;\r\n    grid-row: 1 / span 2;\r\n    grid-column: 2;\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n    justify-items: center;\r\n    align-items: center;\r\n    padding: 0px 10px;\r\n}\r\n\r\n.checkBoxContainer span {\r\n    font-size: 12px;\r\n}\r\n\r\n.priority-high {\r\n    border-left: 8px solid rgb(255, 87, 58);\r\n}\r\n\r\n.priority-medium {\r\n    border-left: 8px solid rgb(255, 202, 58);\r\n}\r\n\r\n.priority-low {\r\n    border: 1px solid rgb(140, 253, 88);\r\n    border-left: 8px solid rgb(140, 253, 88);\r\n}\r\n\r\n.checkbox:hover {\r\n    cursor:default;\r\n}\r\n\r\n.delete-project-button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(255, 66, 66);\r\n    color: white;\r\n    font-weight: bold;\r\n    cursor: pointer;\r\n    justify-self: start;\r\n}\r\n\r\n.delete-project-button:disabled {\r\n    background-color: #bbb;\r\n    cursor: not-allowed;\r\n}","",{version:3,sources:["webpack://./src/modules/Project/ProjectDetail.css"],names:[],mappings:";AACA;IACI,aAAa;IACb,SAAS;IACT,iDAAiD;AACrD;;;;AAIA;IACI,aAAa;IACb,2BAA2B;IAC3B,gEAAgE;IAChE,mBAAmB;IACnB,sBAAsB;IACtB,wCAAwC;;IAExC,kBAAkB;IAClB,iBAAiB;IACjB,yBAAyB;AAC7B;;AAEA;IACI,2CAA2C;IAC3C,eAAe;AACnB;;AAEA;IACI,SAAS;IACT,UAAU;IACV,eAAe;AACnB;;AAEA;IACI,qBAAqB;IACrB,WAAW;AACf;;AAEA;IACI,iBAAiB;IACjB,oBAAoB;IACpB,cAAc;IACd,aAAa;IACb,2BAA2B;IAC3B,qBAAqB;IACrB,mBAAmB;IACnB,iBAAiB;AACrB;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,uCAAuC;AAC3C;;AAEA;IACI,wCAAwC;AAC5C;;AAEA;IACI,mCAAmC;IACnC,wCAAwC;AAC5C;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,SAAS;IACT,iBAAiB;IACjB,kCAAkC;IAClC,YAAY;IACZ,iBAAiB;IACjB,eAAe;IACf,mBAAmB;AACvB;;AAEA;IACI,sBAAsB;IACtB,mBAAmB;AACvB",sourcesContent:["\r\n.todo-items-container {\r\n    display: grid;\r\n    gap: 25px;\r\n    grid-template-columns: minmax(300px, min-content);\r\n}\r\n\r\n\r\n\r\n.todo-item {\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n    grid-template-columns: minmax(200px, 300px) minmax(200px, 300px);\r\n    align-items: center;\r\n    border: 1px solid #ccc;\r\n    border-left: 8px solid rgb(68, 127, 255);\r\n\r\n    border-radius: 4px;\r\n    padding: 5px 10px;\r\n    background-color: #FAF9F6;\r\n}\r\n\r\n.todo-item:hover {\r\n    box-shadow: 0 2px 5px 0 rgba(0, 0, 0, 0.16);\r\n    cursor: pointer;\r\n}\r\n\r\n.todo-item h3 {\r\n    margin: 0;\r\n    padding: 0;\r\n    align-self: end;\r\n}\r\n\r\n.todo-item h3 a {\r\n    text-decoration: none;\r\n    color: #000;\r\n}\r\n\r\n.checkBoxContainer {\r\n    justify-self: end;\r\n    grid-row: 1 / span 2;\r\n    grid-column: 2;\r\n    display: grid;\r\n    grid-template-rows: 1fr 1fr;\r\n    justify-items: center;\r\n    align-items: center;\r\n    padding: 0px 10px;\r\n}\r\n\r\n.checkBoxContainer span {\r\n    font-size: 12px;\r\n}\r\n\r\n.priority-high {\r\n    border-left: 8px solid rgb(255, 87, 58);\r\n}\r\n\r\n.priority-medium {\r\n    border-left: 8px solid rgb(255, 202, 58);\r\n}\r\n\r\n.priority-low {\r\n    border: 1px solid rgb(140, 253, 88);\r\n    border-left: 8px solid rgb(140, 253, 88);\r\n}\r\n\r\n.checkbox:hover {\r\n    cursor:default;\r\n}\r\n\r\n.delete-project-button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(255, 66, 66);\r\n    color: white;\r\n    font-weight: bold;\r\n    cursor: pointer;\r\n    justify-self: start;\r\n}\r\n\r\n.delete-project-button:disabled {\r\n    background-color: #bbb;\r\n    cursor: not-allowed;\r\n}"],sourceRoot:""}]);const a=o},528:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,'form {\r\n    display: grid;\r\n    grid-template-columns: minmax(30%, 400px);\r\n    justify-items: start;\r\n    gap: 10px;\r\n    padding: 20px;\r\n}\r\n\r\nform input[type="text"], textarea {\r\n    justify-self: stretch;\r\n}\r\n\r\nform button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(0, 140, 255);\r\n    color: white;\r\n    font-weight: bold;\r\n}',"",{version:3,sources:["webpack://./src/modules/TodoItem/AddTodoItem.css"],names:[],mappings:"AAAA;IACI,aAAa;IACb,yCAAyC;IACzC,oBAAoB;IACpB,SAAS;IACT,aAAa;AACjB;;AAEA;IACI,qBAAqB;AACzB;;AAEA;IACI,SAAS;IACT,iBAAiB;IACjB,kCAAkC;IAClC,YAAY;IACZ,iBAAiB;AACrB",sourcesContent:['form {\r\n    display: grid;\r\n    grid-template-columns: minmax(30%, 400px);\r\n    justify-items: start;\r\n    gap: 10px;\r\n    padding: 20px;\r\n}\r\n\r\nform input[type="text"], textarea {\r\n    justify-self: stretch;\r\n}\r\n\r\nform button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(0, 140, 255);\r\n    color: white;\r\n    font-weight: bold;\r\n}'],sourceRoot:""}]);const a=o},563:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,".todoItemContent {\r\n    width: 30%;\r\n    display: grid;\r\n    grid-template-columns: 2fr 3fr;\r\n    justify-items: start;\r\n    gap: 10px;\r\n}\r\n\r\n.todo-item-container h2 {\r\n    margin: 0;\r\n    margin-bottom: 1rem;\r\n}\r\n\r\n.todo-item-container {\r\n    background-color: #FAF9F6;\r\n    border-radius: 8px;\r\n    padding: 1rem;\r\n    box-shadow: 2px 2px 5px rgba(0,0,0,0.17);\r\n}\r\n\r\n.project span {\r\n    grid-column: 1;\r\n\r\n}\r\n\r\n.project select {\r\n    grid-column: 2;\r\n}\r\n\r\n.delete-todoitem-button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(255, 66, 66);\r\n    color: white;\r\n    font-weight: bold;\r\n    cursor: pointer;\r\n}\r\n\r\n.delete-todoitem-button button:hover {\r\n    background-color: rgb(255, 87, 87);\r\n}","",{version:3,sources:["webpack://./src/modules/TodoItem/TodoItemDetail.css"],names:[],mappings:"AAAA;IACI,UAAU;IACV,aAAa;IACb,8BAA8B;IAC9B,oBAAoB;IACpB,SAAS;AACb;;AAEA;IACI,SAAS;IACT,mBAAmB;AACvB;;AAEA;IACI,yBAAyB;IACzB,kBAAkB;IAClB,aAAa;IACb,wCAAwC;AAC5C;;AAEA;IACI,cAAc;;AAElB;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,SAAS;IACT,iBAAiB;IACjB,kCAAkC;IAClC,YAAY;IACZ,iBAAiB;IACjB,eAAe;AACnB;;AAEA;IACI,kCAAkC;AACtC",sourcesContent:[".todoItemContent {\r\n    width: 30%;\r\n    display: grid;\r\n    grid-template-columns: 2fr 3fr;\r\n    justify-items: start;\r\n    gap: 10px;\r\n}\r\n\r\n.todo-item-container h2 {\r\n    margin: 0;\r\n    margin-bottom: 1rem;\r\n}\r\n\r\n.todo-item-container {\r\n    background-color: #FAF9F6;\r\n    border-radius: 8px;\r\n    padding: 1rem;\r\n    box-shadow: 2px 2px 5px rgba(0,0,0,0.17);\r\n}\r\n\r\n.project span {\r\n    grid-column: 1;\r\n\r\n}\r\n\r\n.project select {\r\n    grid-column: 2;\r\n}\r\n\r\n.delete-todoitem-button {\r\n    border: 0;\r\n    padding: 8px 30px;\r\n    background-color: rgb(255, 66, 66);\r\n    color: white;\r\n    font-weight: bold;\r\n    cursor: pointer;\r\n}\r\n\r\n.delete-todoitem-button button:hover {\r\n    background-color: rgb(255, 87, 87);\r\n}"],sourceRoot:""}]);const a=o},426:(t,e,n)=>{"use strict";n.d(e,{Z:()=>a});var r=n(537),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([t.id,"* {\r\n    font-family: 'Helvetica', 'Arial', sans-serif;\r\n}\r\n\r\nbody {\r\n    background-color: #fff;\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100%;\r\n    height: 100vh;\r\n\r\n    display: grid;\r\n    grid-template-columns: 300px 1fr;\r\n    grid-template-rows: 60px 1fr;\r\n}\r\n\r\n.main-content {\r\n    padding: 20px 40px;\r\n    grid-column: 2;\r\n}","",{version:3,sources:["webpack://./src/style.css"],names:[],mappings:"AAAA;IACI,6CAA6C;AACjD;;AAEA;IACI,sBAAsB;IACtB,SAAS;IACT,UAAU;IACV,WAAW;IACX,aAAa;;IAEb,aAAa;IACb,gCAAgC;IAChC,4BAA4B;AAChC;;AAEA;IACI,kBAAkB;IAClB,cAAc;AAClB",sourcesContent:["* {\r\n    font-family: 'Helvetica', 'Arial', sans-serif;\r\n}\r\n\r\nbody {\r\n    background-color: #fff;\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100%;\r\n    height: 100vh;\r\n\r\n    display: grid;\r\n    grid-template-columns: 300px 1fr;\r\n    grid-template-rows: 60px 1fr;\r\n}\r\n\r\n.main-content {\r\n    padding: 20px 40px;\r\n    grid-column: 2;\r\n}"],sourceRoot:""}]);const a=o},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,s){"string"==typeof t&&(t=[[null,t,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var l=0;l<t.length;l++){var h=[].concat(t[l]);r&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),e.push(h))}},e}},537:t=>{"use strict";t.exports=function(t){var e=t[1],n=t[3];if(!n)return e;if("function"==typeof btoa){var r=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(r),s="/*# ".concat(i," */");return[e].concat([s]).join("\n")}return[e].join("\n")}},379:t=>{"use strict";var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var s={},o=[],a=0;a<t.length;a++){var c=t[a],l=r.base?c[0]+r.base:c[0],h=s[l]||0,u="".concat(l," ").concat(h);s[l]=h+1;var d=n(u),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var f=i(p,r);r.byIndex=a,e.splice(a,0,{identifier:u,updater:f,references:1})}o.push(u)}return o}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var s=r(t=t||[],i=i||{});return function(t){t=t||[];for(var o=0;o<s.length;o++){var a=n(s[o]);e[a].references--}for(var c=r(t,i),l=0;l<s.length;l++){var h=n(s[l]);0===e[h].references&&(e[h].updater(),e.splice(h,1))}s=c}}},569:t=>{"use strict";var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,n)=>{"use strict";t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},428:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1"></path></svg>'},646:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15,13H16.5V15.82L18.94,17.23L18.19,18.53L15,16.69V13M19,8H5V19H9.67C9.24,18.09 9,17.07 9,16A7,7 0 0,1 16,9C17.07,9 18.09,9.24 19,9.67V8M5,21C3.89,21 3,20.1 3,19V5C3,3.89 3.89,3 5,3H6V1H8V3H16V1H18V3H19A2,2 0 0,1 21,5V11.1C22.24,12.36 23,14.09 23,16A7,7 0 0,1 16,23C14.09,23 12.36,22.24 11.1,21H5M16,11.15A4.85,4.85 0 0,0 11.15,16C11.15,18.68 13.32,20.85 16,20.85A4.85,4.85 0 0,0 20.85,16C20.85,13.32 18.68,11.15 16,11.15Z"></path></svg>'},586:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg>'},168:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z"></path></svg>'},718:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H14.82C14.4 1.84 13.3 1 12 1S9.6 1.84 9.18 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M12 3C12.55 3 13 3.45 13 4S12.55 5 12 5 11 4.55 11 4 11.45 3 12 3M7 7H17V5H19V19H5V5H7V7M12 17V15H17V17H12M12 11V9H17V11H12M8 12V9H7V8H9V12H8M9.25 14C9.66 14 10 14.34 10 14.75C10 14.95 9.92 15.14 9.79 15.27L8.12 17H10V18H7V17.08L9 15H7V14H9.25"></path></svg>'},27:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M7 7H9V9H7V7M7 11H9V13H7V11M7 15H9V17H7V15M17 17H11V15H17V17M17 13H11V11H17V13M17 9H11V7H17V9Z"></path></svg>'},697:t=>{t.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"></path></svg>'}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={id:r,exports:{}};return t[r](s,s.exports,n),s.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nc=void 0,(()=>{"use strict";const t=new class{events={};publish(t,e){if(this.events[t])for(let n of this.events[t])n(e)}subscribe(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}unsubscribe(t,e){this.events[t]&&this.events[t].remove(this.events[t].find((t=>t===e)))}};class e{constructor(t,e,n,r,i,s,o){this.id=t,this.title=e,this.priority=n,this.description=r,this.dueDate=i,this.isComplete=s||!1,this.projectId=o}static priorities={1:"Critical",2:"Important",3:"Default"}}function r(t){return 0===t.length?1:t.reduce(((t,e)=>t.id<e.id?e:t)).id+1}function i(e,n){t.publish("changePage",{page:e,data:n})}function s(t,e){return t.findIndex((t=>t.id===e))}function o(t,e){if(e.length<t)throw new TypeError(t+" argument"+(t>1?"s":"")+" required, but only "+e.length+" present")}function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function c(t){o(1,arguments);var e=Object.prototype.toString.call(t);return t instanceof Date||"object"===a(t)&&"[object Date]"===e?new Date(t.getTime()):"number"==typeof t||"[object Number]"===e?new Date(t):("string"!=typeof t&&"[object String]"!==e||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn((new Error).stack)),new Date(NaN))}function l(t){o(1,arguments);var e=c(t);return e.setHours(0,0,0,0),e}function h(t,e){o(2,arguments);var n=l(t),r=l(e);return n.getTime()===r.getTime()}const u=(()=>{const n=function(){const t=JSON.parse(localStorage.getItem("todoItems"));return!!t&&t.map((t=>new e(t.id,t.title,t.priority,t.description,new Date(t.dueDate),t.isComplete,Number(t.projectId))))}()||[];async function i(t){return n.find((e=>e.id===t))}return t.subscribe("TodoItemsChanged",(()=>{localStorage.setItem("todoItems",JSON.stringify(n))})),{getTodoItems:async function(){return n},getTodoItemById:i,addTodoItem:async function(i,s,o,a,c){const l=r(n);if(!(i&&s&&o&&a))return null;if(!Number(s))return null;a=new Date(a);const h=new e(l,i,Number(s),o,a,!1,c||1);return n.push(h),t.publish("TodoItemsChanged"),h},deleteTodoItem:async function(e){n.splice(s(n,e),1),t.publish("TodoItemsChanged")},updateTodoItem:async function(e){i(e.id)&&(n[s(n,e.id)]=e,t.publish("TodoItemsChanged"))}}})(),d=u;async function p(t,e,n,r,i){return await d.addTodoItem(t,e,n,r,i)}async function f(){return await d.getTodoItems()}async function g(){return(await d.getTodoItems()).filter((t=>function(t){return o(1,arguments),h(t,Date.now())}(t.dueDate)))}async function m(){return(await d.getTodoItems()).filter((t=>function(t){return o(1,arguments),c(t).getTime()>Date.now()}(t.dueDate)))}async function A(t){await d.updateTodoItem(t)}class y{constructor(t,e){this.id=t||"",this.name=e}}const b=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},v={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let e=0;e<t.length;e+=3){const i=t[e],s=e+1<t.length,o=s?t[e+1]:0,a=e+2<t.length,c=a?t[e+2]:0,l=i>>2,h=(3&i)<<4|o>>4;let u=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(u=64)),r.push(n[l],n[h],n[u],n[d])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(b(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let e=0;e<t.length;){const i=n[t.charAt(e++)],s=e<t.length?n[t.charAt(e)]:0;++e;const o=e<t.length?n[t.charAt(e)]:64;++e;const a=e<t.length?n[t.charAt(e)]:64;if(++e,null==i||null==s||null==o||null==a)throw new C;const c=i<<2|s>>4;if(r.push(c),64!==o){const t=s<<4&240|o>>2;if(r.push(t),64!==a){const t=o<<6&192|a;r.push(t)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class C extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const I=function(t){return function(t){const e=b(t);return v.encodeByteArray(e,!0)}(t).replace(/\./g,"")},w=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const t=process.env.__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&function(t){try{return v.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}};class E{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}class x extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,x.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},r=`${this.service}/${t}`,i=this.errors[t],s=i?function(t,e){return t.replace(k,((t,n)=>{const r=e[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new x(r,o,n)}}const k=/\{\$([^}]+)}/g;function B(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const n=t[i],s=e[i];if(S(n)&&S(s)){if(!B(n,s))return!1}else if(n!==s)return!1}for(const t of r)if(!n.includes(t))return!1;return!0}function S(t){return null!==t&&"object"==typeof t}class D{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const _="[DEFAULT]";class L{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new E;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:_})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=_){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=_){return this.instances.has(t)}getOptions(t=_){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(r);return r}onInit(t,e){var n;const r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&t(s,r),()=>{i.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=t,r===_?void 0:r),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var r;return n||null}normalizeInstanceIdentifier(t=_){return this.component?this.component.multipleInstances?t:_:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class j{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new L(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const R=[];var P,N;(N=P||(P={}))[N.DEBUG=0]="DEBUG",N[N.VERBOSE=1]="VERBOSE",N[N.INFO=2]="INFO",N[N.WARN=3]="WARN",N[N.ERROR=4]="ERROR",N[N.SILENT=5]="SILENT";const O={debug:P.DEBUG,verbose:P.VERBOSE,info:P.INFO,warn:P.WARN,error:P.ERROR,silent:P.SILENT},M=P.INFO,F={[P.DEBUG]:"log",[P.VERBOSE]:"log",[P.INFO]:"info",[P.WARN]:"warn",[P.ERROR]:"error"},H=(t,e,...n)=>{if(e<t.logLevel)return;const r=(new Date).toISOString(),i=F[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${t.name}:`,...n)};class U{constructor(t){this.name=t,this._logLevel=M,this._logHandler=H,this._userLogHandler=null,R.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in P))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?O[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,P.DEBUG,...t),this._logHandler(this,P.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,P.VERBOSE,...t),this._logHandler(this,P.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,P.INFO,...t),this._logHandler(this,P.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,P.WARN,...t),this._logHandler(this,P.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,P.ERROR,...t),this._logHandler(this,P.ERROR,...t)}}let V,z;const $=new WeakMap,W=new WeakMap,Z=new WeakMap,X=new WeakMap,q=new WeakMap;let K={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return W.get(t);if("objectStoreNames"===e)return t.objectStoreNames||Z.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return G(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function Y(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(z||(z=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(J(this),t),G($.get(this))}:function(...t){return G(e.apply(J(this),t))}:function(t,...n){const r=e.call(J(this),t,...n);return Z.set(r,t.sort?t.sort():[t]),G(r)}:(t instanceof IDBTransaction&&function(t){if(W.has(t))return;const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",s),t.removeEventListener("abort",s)},i=()=>{e(),r()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",s),t.addEventListener("abort",s)}));W.set(t,e)}(t),n=t,(V||(V=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>n instanceof t))?new Proxy(t,K):t);var e,n}function G(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",s)},i=()=>{e(G(t.result)),r()},s=()=>{n(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&$.set(e,t)})).catch((()=>{})),q.set(e,t),e}(t);if(X.has(t))return X.get(t);const e=Y(t);return e!==t&&(X.set(t,e),q.set(e,t)),e}const J=t=>q.get(t),Q=["get","getKey","getAll","getAllKeys","count"],tt=["put","add","delete","clear"],et=new Map;function nt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(et.get(e))return et.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=tt.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Q.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),i&&s.done]))[0]};return et.set(e,s),s}var rt;rt=K,K={...rt,get:(t,e,n)=>nt(t,e)||rt.get(t,e,n),has:(t,e)=>!!nt(t,e)||rt.has(t,e)};class it{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const st="@firebase/app",ot="0.9.9",at=new U("@firebase/app"),ct="[DEFAULT]",lt={[st]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},ht=new Map,ut=new Map;function dt(t,e){try{t.container.addComponent(e)}catch(n){at.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function pt(t){const e=t.name;if(ut.has(e))return at.debug(`There were multiple attempts to register component ${e}.`),!1;ut.set(e,t);for(const e of ht.values())dt(e,t);return!0}const ft=new T("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class gt{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new D("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw ft.create("app-deleted",{appName:this._name})}}function mt(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:ct,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw ft.create("bad-app-name",{appName:String(i)});if(n||(n=null===(s=w())||void 0===s?void 0:s.config),!n)throw ft.create("no-options");var s;const o=ht.get(i);if(o){if(B(n,o.options)&&B(r,o.config))return o;throw ft.create("duplicate-app",{appName:i})}const a=new j(i);for(const t of ut.values())a.addComponent(t);const c=new gt(n,r,a);return ht.set(i,c),c}function At(t,e,n){var r;let i=null!==(r=lt[t])&&void 0!==r?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const t=[`Unable to register library "${i}" with version "${e}":`];return s&&t.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void at.warn(t.join(" "))}pt(new D(`${i}-version`,(()=>({library:i,version:e})),"VERSION"))}const yt="firebase-heartbeat-store";let bt=null;function vt(){return bt||(bt=function(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=G(o);return r&&o.addEventListener("upgradeneeded",(t=>{r(G(o.result),t.oldVersion,t.newVersion,G(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{s&&t.addEventListener("close",(()=>s())),i&&t.addEventListener("versionchange",(t=>i(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(t,e)=>{0===e&&t.createObjectStore(yt)}}).catch((t=>{throw ft.create("idb-open",{originalErrorMessage:t.message})}))),bt}async function Ct(t,e){try{const n=(await vt()).transaction(yt,"readwrite"),r=n.objectStore(yt);return await r.put(e,It(t)),n.done}catch(t){if(t instanceof x)at.warn(t.message);else{const e=ft.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});at.warn(e.message)}}}function It(t){return`${t.name}!${t.options.appId}`}class wt{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new xt(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=Et();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=Et(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let r=t.slice();for(const i of t){const t=n.find((t=>t.agent===i.agent));if(t){if(t.dates.push(i.date),Tt(n)>e){t.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Tt(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=I(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Et(){return(new Date).toISOString().substring(0,10)}class xt{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(t){return!1}}()&&new Promise(((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){try{return(await vt()).transaction(yt).objectStore(yt).get(It(t))}catch(t){if(t instanceof x)at.warn(t.message);else{const e=ft.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});at.warn(e.message)}}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Tt(t){return I(JSON.stringify({version:2,heartbeats:t})).length}pt(new D("platform-logger",(t=>new it(t)),"PRIVATE")),pt(new D("heartbeat",(t=>new wt(t)),"PRIVATE")),At(st,ot,""),At(st,ot,"esm2017"),At("fire-js",""),At("firebase","9.21.0","app");const kt={apiKey:"AIzaSyDAtMq2wCoVjLTx8P33yftc-HKkWN5_oSM",authDomain:"todolist-15239.firebaseapp.com",projectId:"todolist-15239",storageBucket:"todolist-15239.appspot.com",messagingSenderId:"992383528176",appId:"1:992383528176:web:1c0f5ef95a7c2e84fae635"};var Bt,St="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Dt={},_t=_t||{},Lt=St||self;function jt(){}function Rt(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function Pt(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Nt="closure_uid_"+(1e9*Math.random()>>>0),Ot=0;function Mt(t,e,n){return t.call.apply(t.bind,arguments)}function Ft(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function Ht(t,e,n){return(Ht=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?Mt:Ft).apply(null,arguments)}function Ut(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function Vt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(t,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return e.prototype[n].apply(t,i)}}function zt(){this.s=this.s,this.o=this.o}zt.prototype.s=!1,zt.prototype.ra=function(){var t;!this.s&&(this.s=!0,this.N(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,Nt)&&t[Nt]||(t[Nt]=++Ot))},zt.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const $t=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Wt(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Zt(t,e){for(let e=1;e<arguments.length;e++){const n=arguments[e];if(Rt(n)){const e=t.length||0,r=n.length||0;t.length=e+r;for(let i=0;i<r;i++)t[e+i]=n[i]}else t.push(n)}}function Xt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Xt.prototype.h=function(){this.defaultPrevented=!0};var qt=function(){if(!Lt.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Lt.addEventListener("test",jt,e),Lt.removeEventListener("test",jt,e)}catch(t){}return t}();function Kt(t){return/^[\s\xa0]*$/.test(t)}var Yt=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Gt(t,e){return t<e?-1:t>e?1:0}function Jt(){var t=Lt.navigator;return t&&(t=t.userAgent)?t:""}function Qt(t){return-1!=Jt().indexOf(t)}function te(t){return te[" "](t),t}function ee(t,e,n){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:t[e]=n(e)}te[" "]=jt;var ne,re,ie=Qt("Opera"),se=Qt("Trident")||Qt("MSIE"),oe=Qt("Edge"),ae=oe||se,ce=Qt("Gecko")&&!(-1!=Jt().toLowerCase().indexOf("webkit")&&!Qt("Edge"))&&!(Qt("Trident")||Qt("MSIE"))&&!Qt("Edge"),le=-1!=Jt().toLowerCase().indexOf("webkit")&&!Qt("Edge");function he(){var t=Lt.document;return t?t.documentMode:void 0}t:{var ue="",de=(re=Jt(),ce?/rv:([^\);]+)(\)|;)/.exec(re):oe?/Edge\/([\d\.]+)/.exec(re):se?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(re):le?/WebKit\/(\S+)/.exec(re):ie?/(?:Version)[ \/]?(\S+)/.exec(re):void 0);if(de&&(ue=de?de[1]:""),se){var pe=he();if(null!=pe&&pe>parseFloat(ue)){ne=String(pe);break t}}ne=ue}var fe,ge={};Lt.document&&se?fe=he()||parseInt(ne,10)||void 0:fe=void 0;var me=fe;function Ae(t,e){if(Xt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(ce){t:{try{te(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ye[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Ae.$.h.call(this)}}Vt(Ae,Xt);var ye={2:"touch",3:"pen",4:"mouse"};Ae.prototype.h=function(){Ae.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var be="closure_listenable_"+(1e6*Math.random()|0),ve=0;function Ce(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++ve,this.fa=this.ia=!1}function Ie(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function we(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function Ee(t){const e={};for(const n in t)e[n]=t[n];return e}const xe="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Te(t,e){let n,r;for(let e=1;e<arguments.length;e++){for(n in r=arguments[e],r)t[n]=r[n];for(let e=0;e<xe.length;e++)n=xe[e],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function ke(t){this.src=t,this.g={},this.h=0}function Be(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],s=$t(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Ie(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function Se(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}ke.prototype.add=function(t,e,n,r,i){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=Se(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):((e=new Ce(e,this.src,s,!!r,i)).ia=n,t.push(e)),e};var De="closure_lm_"+(1e6*Math.random()|0),_e={};function Le(t,e,n,r,i){if(r&&r.once)return Re(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Le(t,e[s],n,r,i);return null}return n=Ue(n),t&&t[be]?t.O(e,n,Pt(r)?!!r.capture:!!r,i):je(t,e,n,!1,r,i)}function je(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Pt(i)?!!i.capture:!!i,a=Fe(t);if(a||(t[De]=a=new ke(t)),(n=a.add(e,n,r,o,s)).proxy)return n;if(r=function(){const t=Me;return function e(n){return t.call(e.src,e.listener,n)}}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)qt||(i=o),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Oe(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Re(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Re(t,e[s],n,r,i);return null}return n=Ue(n),t&&t[be]?t.P(e,n,Pt(r)?!!r.capture:!!r,i):je(t,e,n,!0,r,i)}function Pe(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Pe(t,e[s],n,r,i);else r=Pt(r)?!!r.capture:!!r,n=Ue(n),t&&t[be]?(t=t.i,(e=String(e).toString())in t.g&&-1<(n=Se(s=t.g[e],n,r,i))&&(Ie(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--))):t&&(t=Fe(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Se(e,n,r,i)),(n=-1<t?e[t]:null)&&Ne(n))}function Ne(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[be])Be(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Oe(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Fe(e))?(Be(n,t),0==n.h&&(n.src=null,e[De]=null)):Ie(t)}}}function Oe(t){return t in _e?_e[t]:_e[t]="on"+t}function Me(t,e){if(t.fa)t=!0;else{e=new Ae(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Ne(t),t=n.call(r,e)}return t}function Fe(t){return(t=t[De])instanceof ke?t:null}var He="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ue(t){return"function"==typeof t?t:(t[He]||(t[He]=function(e){return t.handleEvent(e)}),t[He])}function Ve(){zt.call(this),this.i=new ke(this),this.S=this,this.J=null}function ze(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,"string"==typeof e)e=new Xt(e,t);else if(e instanceof Xt)e.target=e.target||t;else{var i=e;Te(e=new Xt(r,t),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=$e(o,r,!0,e)&&i}if(i=$e(o=e.g=t,r,!0,e)&&i,i=$e(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)i=$e(o=e.g=n[s],r,!1,e)&&i}function $e(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Be(t.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}Vt(Ve,zt),Ve.prototype[be]=!0,Ve.prototype.removeEventListener=function(t,e,n,r){Pe(this,t,e,n,r)},Ve.prototype.N=function(){if(Ve.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)Ie(n[r]);delete e.g[t],e.h--}}this.J=null},Ve.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Ve.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var We=Lt.JSON.stringify;function Ze(){var t=Qe;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Xe,qe=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Ke),(t=>t.reset()));class Ke{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Ye(t){Lt.setTimeout((()=>{throw t}),0)}function Ge(t,e){Xe||function(){var t=Lt.Promise.resolve(void 0);Xe=function(){t.then(tn)}}(),Je||(Xe(),Je=!0),Qe.add(t,e)}var Je=!1,Qe=new class{constructor(){this.h=this.g=null}add(t,e){const n=qe.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function tn(){for(var t;t=Ze();){try{t.h.call(t.g)}catch(t){Ye(t)}var e=qe;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Je=!1}function en(t,e){Ve.call(this),this.h=t||1,this.g=e||Lt,this.j=Ht(this.qb,this),this.l=Date.now()}function nn(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function rn(t,e,n){if("function"==typeof t)n&&(t=Ht(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=Ht(t.handleEvent,t)}return 2147483647<Number(e)?-1:Lt.setTimeout(t,e||0)}function sn(t){t.g=rn((()=>{t.g=null,t.i&&(t.i=!1,sn(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}Vt(en,Ve),(Bt=en.prototype).ga=!1,Bt.T=null,Bt.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ze(this,"tick"),this.ga&&(nn(this),this.start()))}},Bt.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},Bt.N=function(){en.$.N.call(this),nn(this),delete this.g};class on extends zt{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:sn(this)}N(){super.N(),this.g&&(Lt.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(t){zt.call(this),this.h=t,this.g={}}Vt(an,zt);var cn=[];function ln(t,e,n,r){Array.isArray(n)||(n&&(cn[0]=n.toString()),n=cn);for(var i=0;i<n.length;i++){var s=Le(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function hn(t){we(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ne(t)}),t),t.g={}}function un(){this.g=!0}function dn(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return We(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}an.prototype.N=function(){an.$.N.call(this),hn(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},un.prototype.Ea=function(){this.g=!1},un.prototype.info=function(){};var pn={},fn=null;function gn(){return fn=fn||new Ve}function mn(t){Xt.call(this,pn.Ta,t)}function An(t){const e=gn();ze(e,new mn(e))}function yn(t,e){Xt.call(this,pn.STAT_EVENT,t),this.stat=e}function bn(t){const e=gn();ze(e,new yn(e,t))}function vn(t,e){Xt.call(this,pn.Ua,t),this.size=e}function Cn(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return Lt.setTimeout((function(){t()}),e)}pn.Ta="serverreachability",Vt(mn,Xt),pn.STAT_EVENT="statevent",Vt(yn,Xt),pn.Ua="timingevent",Vt(vn,Xt);var In={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},wn={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function En(){}function xn(t){return t.h||(t.h=t.i())}function Tn(){}En.prototype.h=null;var kn,Bn={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Sn(){Xt.call(this,"d")}function Dn(){Xt.call(this,"c")}function _n(){}function Ln(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new an(this),this.P=Rn,t=ae?125:void 0,this.V=new en(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.aa=-1,this.J=!1,this.O=0,this.M=null,this.ca=this.K=this.ba=this.S=!1,this.h=new jn}function jn(){this.i=null,this.g="",this.h=!1}Vt(Sn,Xt),Vt(Dn,Xt),Vt(_n,En),_n.prototype.g=function(){return new XMLHttpRequest},_n.prototype.i=function(){return{}},kn=new _n;var Rn=45e3,Pn={},Nn={};function On(t,e,n){t.L=1,t.v=nr(Gn(e)),t.s=n,t.S=!0,Mn(t,null)}function Mn(t,e){t.G=Date.now(),Vn(t),t.A=Gn(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),gr(n.i,"t",r),t.C=0,n=t.l.I,t.h=new jn,t.g=fi(t.l,n?e:null,!t.s),0<t.O&&(t.M=new on(Ht(t.Pa,t,t.g),t.O)),ln(t.U,t.g,"readystatechange",t.nb),e=t.I?Ee(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),An(),function(t,e,n,r,i,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var h=l[0];l=l[1];var u=h.split("_");o=2<=u.length&&"type"==u[1]?o+(h+"=")+l+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.W,t.s)}function Fn(t){return!!t.g&&"GET"==t.u&&2!=t.L&&t.l.Ha}function Hn(t,e,n){let r,i=!0;for(;!t.J&&t.C<n.length;){if(r=Un(t,n),r==Nn){4==e&&(t.o=4,bn(14),i=!1),dn(t.j,t.m,null,"[Incomplete Response]");break}if(r==Pn){t.o=4,bn(15),dn(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}dn(t.j,t.m,r,null),Xn(t,r)}Fn(t)&&r!=Nn&&r!=Pn&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,bn(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.ca&&(t.ca=!0,(e=t.l).g==t&&e.ca&&!e.L&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),oi(e),e.L=!0,bn(11))):(dn(t.j,t.m,n,"[Invalid Chunked Response]"),Zn(t),Wn(t))}function Un(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Nn:(n=Number(e.substring(n,r)),isNaN(n)?Pn:(r+=1)+n>e.length?Nn:(e=e.substr(r,n),t.C=r+n,e))}function Vn(t){t.Y=Date.now()+t.P,zn(t,t.P)}function zn(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=Cn(Ht(t.lb,t),e)}function $n(t){t.B&&(Lt.clearTimeout(t.B),t.B=null)}function Wn(t){0==t.l.H||t.J||li(t.l,t)}function Zn(t){$n(t);var e=t.M;e&&"function"==typeof e.ra&&e.ra(),t.M=null,nn(t.V),hn(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.ra())}function Xn(t,e){try{var n=t.l;if(0!=n.H&&(n.g==t||Cr(n.h,t)))if(!t.K&&Cr(n.h,t)&&3==n.H){try{var r=n.Ja.g.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.G+3e3<t.G))break t;ci(n),Jr(n)}si(n),bn(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.M&&0==n.A&&!n.v&&(n.v=Cn(Ht(n.ib,n),6e3));if(1>=vr(n.h)&&n.na){try{n.na()}catch(t){}n.na=void 0}}else ui(n,11)}else if((t.K||n.g==t)&&ci(n),!Kt(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let l=i[e];if(n.V=l[0],l=l[1],2==n.H)if("c"==l[0]){n.J=l[1],n.oa=l[2];const e=l[3];null!=e&&(n.qa=e,n.j.info("VER="+n.qa));const i=l[4];null!=i&&(n.Ga=i,n.j.info("SVER="+n.Ga));const h=l[5];null!=h&&"number"==typeof h&&0<h&&(r=1.5*h,n.K=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const u=t.g;if(u){const t=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=r.h;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Ir(s,s.h),s.h=null))}if(r.F){const t=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(r.Da=t,er(r.G,r.F,t))}}n.H=3,n.l&&n.l.Ba(),n.ca&&(n.S=Date.now()-t.G,n.j.info("Handshake RTT: "+n.S+"ms"));var o=t;if((r=n).wa=pi(r,r.I?r.oa:null,r.Y),o.K){wr(r.h,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&($n(a),Vn(a)),r.g=o}else ii(r);0<n.i.length&&ti(n)}else"stop"!=l[0]&&"close"!=l[0]||ui(n,7);else 3==n.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?ui(n,7):Gr(n):"noop"!=l[0]&&n.l&&n.l.Aa(l),n.A=0)}An()}catch(t){}}function qn(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Rt(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var n=function(t){if(t.sa&&"function"==typeof t.sa)return t.sa();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(Rt(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}(t),r=function(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(Rt(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}(Bt=Ln.prototype).setTimeout=function(t){this.P=t},Bt.nb=function(t){t=t.target;const e=this.M;e&&3==Wr(t)?e.l():this.Pa(t)},Bt.Pa=function(t){try{if(t==this.g)t:{const h=Wr(this.g);var e=this.g.Ia();if(this.g.da(),!(3>h)&&(3!=h||ae||this.g&&(this.h.h||this.g.ja()||Zr(this.g)))){this.J||4!=h||7==e||An(),$n(this);var n=this.g.da();this.aa=n;e:if(Fn(this)){var r=Zr(this.g);t="";var i=r.length,s=4==Wr(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Zn(this),Wn(this);var o="";break e}this.h.i=new Lt.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(t,e,n,r,i,s,o){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.W,h,n),this.i){if(this.ba&&!this.K){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Kt(a)){var l=a;break e}}l=null}if(!(n=l)){this.i=!1,this.o=3,bn(12),Zn(this),Wn(this);break t}dn(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xn(this,n)}this.S?(Hn(this,h,o),ae&&this.i&&3==h&&(ln(this.U,this.V,"tick",this.mb),this.V.start())):(dn(this.j,this.m,o,null),Xn(this,o)),4==h&&Zn(this),this.i&&!this.J&&(4==h?li(this.l,this):(this.i=!1,Vn(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,bn(12)):(this.o=0,bn(13)),Zn(this),Wn(this)}}}catch(t){}},Bt.mb=function(){if(this.g){var t=Wr(this.g),e=this.g.ja();this.C<e.length&&($n(this),Hn(this,t,e),this.i&&4!=t&&Vn(this))}},Bt.cancel=function(){this.J=!0,Zn(this)},Bt.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.L&&(An(),bn(17)),Zn(this),this.o=2,Wn(this)):zn(this,this.Y-t)};var Kn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Yn(t,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Yn){this.h=void 0!==e?e:t.h,Jn(this,t.j),this.s=t.s,this.g=t.g,Qn(this,t.m),this.l=t.l,e=t.i;var n=new ur;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),tr(this,n),this.o=t.o}else t&&(n=String(t).match(Kn))?(this.h=!!e,Jn(this,n[1]||"",!0),this.s=rr(n[2]||""),this.g=rr(n[3]||"",!0),Qn(this,n[4]),this.l=rr(n[5]||"",!0),tr(this,n[6]||"",!0),this.o=rr(n[7]||"")):(this.h=!!e,this.i=new ur(null,this.h))}function Gn(t){return new Yn(t)}function Jn(t,e,n){t.j=n?rr(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Qn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function tr(t,e,n){e instanceof ur?(t.i=e,function(t,e){e&&!t.j&&(dr(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(pr(this,e),gr(this,n,t))}),t)),t.j=e}(t.i,t.h)):(n||(e=ir(e,lr)),t.i=new ur(e,t.h))}function er(t,e,n){t.i.set(e,n)}function nr(t){return er(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function rr(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ir(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,sr),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function sr(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Yn.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ir(e,or,!0),":");var n=this.g;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ir(e,or,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&t.push("/"),t.push(ir(n,"/"==n.charAt(0)?cr:ar,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ir(n,hr)),t.join("")};var or=/[#\/\?@]/g,ar=/[#\?:]/g,cr=/[#\?]/g,lr=/[#\?@]/g,hr=/#/g;function ur(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function dr(t){t.g||(t.g=new Map,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function pr(t,e){dr(t),e=mr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function fr(t,e){return dr(t),e=mr(t,e),t.g.has(e)}function gr(t,e,n){pr(t,e),0<n.length&&(t.i=null,t.g.set(mr(t,e),Wt(n)),t.h+=n.length)}function mr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ar(t){this.l=t||yr,t=Lt.PerformanceNavigationTiming?0<(t=Lt.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Lt.g&&Lt.g.Ka&&Lt.g.Ka()&&Lt.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(Bt=ur.prototype).add=function(t,e){dr(this),this.i=null,t=mr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},Bt.forEach=function(t,e){dr(this),this.g.forEach((function(n,r){n.forEach((function(n){t.call(e,n,r,this)}),this)}),this)},Bt.sa=function(){dr(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const i=t[r];for(let t=0;t<i.length;t++)n.push(e[r])}return n},Bt.Z=function(t){dr(this);let e=[];if("string"==typeof t)fr(this,t)&&(e=e.concat(this.g.get(mr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e},Bt.set=function(t,e){return dr(this),this.i=null,fr(this,t=mr(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},Bt.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},Bt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};var yr=10;function br(t){return!!t.h||!!t.g&&t.g.size>=t.j}function vr(t){return t.h?1:t.g?t.g.size:0}function Cr(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function Ir(t,e){t.g?t.g.add(e):t.h=e}function wr(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function Er(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return Wt(t.i)}function xr(){}function Tr(){this.g=new xr}function kr(t,e,n){const r=n||"";try{qn(t,(function(t,n){let i=t;Pt(t)&&(i=We(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function Br(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Sr(t){this.l=t.fc||null,this.j=t.ob||!1}function Dr(t,e){Ve.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=_r,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Ar.prototype.cancel=function(){if(this.i=Er(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},xr.prototype.stringify=function(t){return Lt.JSON.stringify(t,void 0)},xr.prototype.parse=function(t){return Lt.JSON.parse(t,void 0)},Vt(Sr,En),Sr.prototype.g=function(){return new Dr(this.l,this.j)},Sr.prototype.i=function(t){return function(){return t}}({}),Vt(Dr,Ve);var _r=0;function Lr(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function jr(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Rr(t)}function Rr(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(Bt=Dr.prototype).open=function(t,e){if(this.readyState!=_r)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Rr(this)},Bt.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Lt).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},Bt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,jr(this)),this.readyState=_r},Bt.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Rr(this)),this.g&&(this.readyState=3,Rr(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==Lt.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Lr(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},Bt.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?jr(this):Rr(this),3==this.readyState&&Lr(this)}},Bt.Za=function(t){this.g&&(this.response=this.responseText=t,jr(this))},Bt.Ya=function(t){this.g&&(this.response=t,jr(this))},Bt.ka=function(){this.g&&jr(this)},Bt.setRequestHeader=function(t,e){this.v.append(t,e)},Bt.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},Bt.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Dr.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Pr=Lt.JSON.parse;function Nr(t){Ve.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Or,this.L=this.M=!1}Vt(Nr,Ve);var Or="",Mr=/^https?$/i,Fr=["POST","PUT"];function Hr(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ur(t),zr(t)}function Ur(t){t.F||(t.F=!0,ze(t,"complete"),ze(t,"error"))}function Vr(t){if(t.h&&void 0!==_t&&(!t.C[1]||4!=Wr(t)||2!=t.da()))if(t.v&&4==Wr(t))rn(t.La,0,t);else if(ze(t,"readystatechange"),4==Wr(t)){t.h=!1;try{const a=t.da();t:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var r;if(r=0===a){var i=String(t.I).match(Kn)[1]||null;if(!i&&Lt.self&&Lt.self.location){var s=Lt.self.location.protocol;i=s.substr(0,s.length-1)}r=!Mr.test(i?i.toLowerCase():"")}n=r}if(n)ze(t,"complete"),ze(t,"success");else{t.m=6;try{var o=2<Wr(t)?t.g.statusText:""}catch(t){o=""}t.j=o+" ["+t.da()+"]",Ur(t)}}finally{zr(t)}}}function zr(t,e){if(t.g){$r(t);const n=t.g,r=t.C[0]?jt:null;t.g=null,t.C=null,e||ze(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function $r(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Lt.clearTimeout(t.A),t.A=null)}function Wr(t){return t.g?t.g.readyState:0}function Zr(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Or:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Xr(t){let e="";return we(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}function qr(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=Xr(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):er(t,e,n))}function Kr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Yr(t){this.Ga=0,this.i=[],this.j=new un,this.oa=this.wa=this.G=this.Y=this.g=this.Da=this.F=this.ma=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Kr("failFast",!1,t),this.M=this.v=this.u=this.m=this.l=null,this.aa=!0,this.ta=this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Kr("baseRetryDelayMs",5e3,t),this.hb=Kr("retryDelaySeedMs",1e4,t),this.eb=Kr("forwardChannelMaxRetries",2,t),this.xa=Kr("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.K=void 0,this.I=t&&t.supportsCrossDomainXhr||!1,this.J="",this.h=new Ar(t&&t.concurrentRequestLimit),this.Ja=new Tr,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.j.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.na=void 0,this.S=0,this.L=!1,this.pa=this.B=null}function Gr(t){if(Qr(t),3==t.H){var e=t.W++,n=Gn(t.G);er(n,"SID",t.J),er(n,"RID",e),er(n,"TYPE","terminate"),ni(t,n),(e=new Ln(t,t.j,e,void 0)).L=2,e.v=nr(Gn(n)),n=!1,Lt.navigator&&Lt.navigator.sendBeacon&&(n=Lt.navigator.sendBeacon(e.v.toString(),"")),!n&&Lt.Image&&((new Image).src=e.v,n=!0),n||(e.g=fi(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Vn(e)}di(t)}function Jr(t){t.g&&(oi(t),t.g.cancel(),t.g=null)}function Qr(t){Jr(t),t.u&&(Lt.clearTimeout(t.u),t.u=null),ci(t),t.h.cancel(),t.m&&("number"==typeof t.m&&Lt.clearTimeout(t.m),t.m=null)}function ti(t){br(t.h)||t.m||(t.m=!0,Ge(t.Na,t),t.C=0)}function ei(t,e){var n;n=e?e.m:t.W++;const r=Gn(t.G);er(r,"SID",t.J),er(r,"RID",n),er(r,"AID",t.V),ni(t,r),t.o&&t.s&&qr(r,t.o,t.s),n=new Ln(t,t.j,n,t.C+1),null===t.o&&(n.I=t.s),e&&(t.i=e.F.concat(t.i)),e=ri(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Ir(t.h,n),On(n,r,e)}function ni(t,e){t.ma&&we(t.ma,(function(t,n){er(e,n,t)})),t.l&&qn({},(function(t,n){er(e,n,t)}))}function ri(t,e,n){n=Math.min(t.i.length,n);var r=t.l?Ht(t.l.Va,t.l,t):null;t:{var i=t.i;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=i[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=e,0>n)e=Math.max(0,i[o].h-100),s=!1;else try{kr(a,t,"req"+n+"_")}catch(t){r&&r(a)}}if(s){r=t.join("&");break t}}}return t=t.i.splice(0,n),e.F=t,r}function ii(t){t.g||t.u||(t.ba=1,Ge(t.Ma,t),t.A=0)}function si(t){return!(t.g||t.u||3<=t.A||(t.ba++,t.u=Cn(Ht(t.Ma,t),hi(t,t.A)),t.A++,0))}function oi(t){null!=t.B&&(Lt.clearTimeout(t.B),t.B=null)}function ai(t){t.g=new Ln(t,t.j,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=Gn(t.wa);er(e,"RID","rpc"),er(e,"SID",t.J),er(e,"CI",t.M?"0":"1"),er(e,"AID",t.V),er(e,"TYPE","xmlhttp"),ni(t,e),t.o&&t.s&&qr(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.oa,n.L=1,n.v=nr(Gn(e)),n.s=null,n.S=!0,Mn(n,t)}function ci(t){null!=t.v&&(Lt.clearTimeout(t.v),t.v=null)}function li(t,e){var n=null;if(t.g==e){ci(t),oi(t),t.g=null;var r=2}else{if(!Cr(t.h,e))return;n=e.F,wr(t.h,e),r=1}if(0!=t.H)if(t.ta=e.aa,e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.G;var i=t.C;ze(r=gn(),new vn(r,n)),ti(t)}else ii(t);else if(3==(i=e.o)||0==i&&0<t.ta||!(1==r&&function(t,e){return!(vr(t.h)>=t.h.j-(t.m?1:0)||(t.m?(t.i=e.F.concat(t.i),0):1==t.H||2==t.H||t.C>=(t.cb?0:t.eb)||(t.m=Cn(Ht(t.Na,t,e),hi(t,t.C)),t.C++,0)))}(t,e)||2==r&&si(t)))switch(n&&0<n.length&&(e=t.h,e.i=e.i.concat(n)),i){case 1:ui(t,5);break;case 4:ui(t,10);break;case 3:ui(t,6);break;default:ui(t,2)}}function hi(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.l||(n*=2),n*e}function ui(t,e){if(t.j.info("Error code "+e),2==e){var n=null;t.l&&(n=null);var r=Ht(t.pb,t);n||(n=new Yn("//www.google.com/images/cleardot.gif"),Lt.location&&"http"==Lt.location.protocol||Jn(n,"https"),nr(n)),function(t,e){const n=new un;if(Lt.Image){const r=new Image;r.onload=Ut(Br,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Ut(Br,n,r,"TestLoadImage: error",!1,e),r.onabort=Ut(Br,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Ut(Br,n,r,"TestLoadImage: timeout",!1,e),Lt.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else bn(2);t.H=0,t.l&&t.l.za(e),di(t),Qr(t)}function di(t){if(t.H=0,t.pa=[],t.l){const e=Er(t.h);0==e.length&&0==t.i.length||(Zt(t.pa,e),Zt(t.pa,t.i),t.h.i.length=0,Wt(t.i),t.i.length=0),t.l.ya()}}function pi(t,e,n){var r=n instanceof Yn?Gn(n):new Yn(n,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),Qn(r,r.m);else{var i=Lt.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Yn(null,void 0);r&&Jn(s,r),e&&(s.g=e),i&&Qn(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&er(r,n,e),er(r,"VER",t.qa),ni(t,r),r}function fi(t,e,n){if(e&&!t.I)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ha&&!t.va?new Nr(new Sr({ob:!0})):new Nr(t.va)).Oa(t.I),e}function gi(){}function mi(){if(se&&!(10<=Number(me)))throw Error("Environmental error: no available transport.")}function Ai(t,e){Ve.call(this),this.g=new Yr(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Kt(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Kt(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&e in(t=this.h)&&delete t[e]),this.j=new vi(this)}function yi(t){Sn.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function bi(){Dn.call(this),this.status=1}function vi(t){this.g=t}function Ci(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function Ii(t,e,n){n||(n=0);var r=Array(16);if("string"==typeof e)for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=(n=(i=(s=(e=n+(o<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^e&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(e^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(e^i&(s^e))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(e^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(e^n&(s^e))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^e&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^e^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^e)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(e^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~e))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=n+((o=e+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(e|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(e^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}function wi(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=0|t[i];r&&s==e||(n[i]=s,r=!1)}this.g=n}(Bt=Nr.prototype).Oa=function(t){this.M=t},Bt.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():kn.g(),this.C=this.u?xn(this.u):xn(kn),this.g.onreadystatechange=Ht(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(t){return void Hr(this,t)}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const t of r.keys())n.set(t,r.get(t))}r=Array.from(n.keys()).find((t=>"content-type"==t.toLowerCase())),i=Lt.FormData&&t instanceof Lt.FormData,!(0<=$t(Fr,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[t,e]of n)this.g.setRequestHeader(t,e);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{$r(this),0<this.B&&((this.L=function(t){return se&&ee(ge,9,(function(){let t=0;const e=Yt(String(ne)).split("."),n=Yt("9").split("."),r=Math.max(e.length,n.length);for(let o=0;0==t&&o<r;o++){var i=e[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;t=Gt(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||Gt(0==i[2].length,0==s[2].length)||Gt(i[2],s[2]),i=i[3],s=s[3]}while(0==t)}return 0<=t}))&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ht(this.ua,this)):this.A=rn(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Hr(this,t)}},Bt.ua=function(){void 0!==_t&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ze(this,"timeout"),this.abort(8))},Bt.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,ze(this,"complete"),ze(this,"abort"),zr(this))},Bt.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),zr(this,!0)),Nr.$.N.call(this)},Bt.La=function(){this.s||(this.G||this.v||this.l?Vr(this):this.kb())},Bt.kb=function(){Vr(this)},Bt.da=function(){try{return 2<Wr(this)?this.g.status:-1}catch(t){return-1}},Bt.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},Bt.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Pr(e)}},Bt.Ia=function(){return this.m},Bt.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(Bt=Yr.prototype).qa=8,Bt.H=1,Bt.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const i=new Ln(this,this.j,t,void 0);let s=this.s;if(this.U&&(s?(s=Ee(s),Te(s,this.U)):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)t:{for(var e=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=n;break t}if(4096===e||n===this.i.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=ri(this,i,e),er(n=Gn(this.G),"RID",t),er(n,"CVER",22),this.F&&er(n,"X-HTTP-Session-Id",this.F),ni(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(Xr(s)))+"&"+e:this.o&&qr(n,this.o,s)),Ir(this.h,i),this.bb&&er(n,"TYPE","init"),this.P?(er(n,"$req",e),er(n,"SID","null"),i.ba=!0,On(i,n,null)):On(i,n,e),this.H=2}}else 3==this.H&&(t?ei(this,t):0==this.i.length||br(this.h)||ei(this))},Bt.Ma=function(){if(this.u=null,ai(this),this.ca&&!(this.L||null==this.g||0>=this.S)){var t=2*this.S;this.j.info("BP detection timer enabled: "+t),this.B=Cn(Ht(this.jb,this),t)}},Bt.jb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.M=!1,this.L=!0,bn(10),Jr(this),ai(this))},Bt.ib=function(){null!=this.v&&(this.v=null,Jr(this),si(this),bn(19))},Bt.pb=function(t){t?(this.j.info("Successfully pinged google.com"),bn(2)):(this.j.info("Failed to ping google.com"),bn(1))},(Bt=gi.prototype).Ba=function(){},Bt.Aa=function(){},Bt.za=function(){},Bt.ya=function(){},Bt.Va=function(){},mi.prototype.g=function(t,e){return new Ai(t,e)},Vt(Ai,Ve),Ai.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.I=!0);var t=this.g,e=this.l,n=this.h||void 0;bn(0),t.Y=e,t.ma=n||{},t.M=t.aa,t.G=pi(t,null,t.Y),ti(t)},Ai.prototype.close=function(){Gr(this.g)},Ai.prototype.u=function(t){var e=this.g;if("string"==typeof t){var n={};n.__data__=t,t=n}else this.v&&((n={}).__data__=We(t),t=n);e.i.push(new class{constructor(t,e){this.h=t,this.g=e}}(e.fb++,t)),3==e.H&&ti(e)},Ai.prototype.N=function(){this.g.l=null,delete this.j,Gr(this.g),delete this.g,Ai.$.N.call(this)},Vt(yi,Sn),Vt(bi,Dn),Vt(vi,gi),vi.prototype.Ba=function(){ze(this.g,"a")},vi.prototype.Aa=function(t){ze(this.g,new yi(t))},vi.prototype.za=function(t){ze(this.g,new bi)},vi.prototype.ya=function(){ze(this.g,"b")},Vt(Ci,(function(){this.blockSize=-1})),Ci.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},Ci.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(0==i)for(;s<=n;)Ii(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Ii(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Ii(this,r),i=0;break}}this.h=i,this.i+=e},Ci.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&n,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};var Ei={};function xi(t){return-128<=t&&128>t?ee(Ei,t,(function(t){return new wi([0|t],0>t?-1:0)})):new wi([0|t],0>t?-1:0)}function Ti(t){if(isNaN(t)||!isFinite(t))return Bi;if(0>t)return ji(Ti(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=ki;return new wi(e,0)}var ki=4294967296,Bi=xi(0),Si=xi(1),Di=xi(16777216);function _i(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function Li(t){return-1==t.h}function ji(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new wi(n,~t.h).add(Si)}function Ri(t,e){return t.add(ji(e))}function Pi(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ni(t,e){this.g=t,this.h=e}function Oi(t,e){if(_i(e))throw Error("division by zero");if(_i(t))return new Ni(Bi,Bi);if(Li(t))return e=Oi(ji(t),e),new Ni(ji(e.g),ji(e.h));if(Li(e))return e=Oi(t,ji(e)),new Ni(ji(e.g),e.h);if(30<t.g.length){if(Li(t)||Li(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Si,r=e;0>=r.X(t);)n=Mi(n),r=Mi(r);var i=Fi(n,1),s=Fi(r,1);for(r=Fi(r,2),n=Fi(n,2);!_i(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Fi(r,1),n=Fi(n,1)}return e=Ri(t,i.R(e)),new Ni(i,e)}for(i=Bi;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),o=(s=Ti(n)).R(e);Li(o)||0<o.X(t);)o=(s=Ti(n-=r)).R(e);_i(s)&&(s=Si),i=i.add(s),t=Ri(t,o)}return new Ni(i,t)}function Mi(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new wi(n,t.h)}function Fi(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new wi(i,t.h)}(Bt=wi.prototype).ea=function(){if(Li(this))return-ji(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:ki+r)*e,e*=ki}return t},Bt.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(_i(this))return"0";if(Li(this))return"-"+ji(this).toString(t);for(var e=Ti(Math.pow(t,6)),n=this,r="";;){var i=Oi(n,e).g,s=((0<(n=Ri(n,i.R(e))).g.length?n.g[0]:n.h)>>>0).toString(t);if(_i(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},Bt.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},Bt.X=function(t){return Li(t=Ri(this,t))?-1:_i(t)?0:1},Bt.abs=function(){return Li(this)?ji(this):this},Bt.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(65535&this.D(i))+(65535&t.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new wi(n,-2147483648&n[n.length-1]?-1:0)},Bt.R=function(t){if(_i(this)||_i(t))return Bi;if(Li(this))return Li(t)?ji(this).R(ji(t)):ji(ji(this).R(t));if(Li(t))return ji(this.R(ji(t)));if(0>this.X(Di)&&0>t.X(Di))return Ti(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=t.D(i)>>>16,c=65535&t.D(i);n[2*r+2*i]+=o*c,Pi(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Pi(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Pi(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Pi(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new wi(n,0)},Bt.gb=function(t){return Oi(this,t).h},Bt.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new wi(n,this.h&t.h)},Bt.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new wi(n,this.h|t.h)},Bt.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new wi(n,this.h^t.h)},mi.prototype.createWebChannel=mi.prototype.g,Ai.prototype.send=Ai.prototype.u,Ai.prototype.open=Ai.prototype.m,Ai.prototype.close=Ai.prototype.close,In.NO_ERROR=0,In.TIMEOUT=8,In.HTTP_ERROR=6,wn.COMPLETE="complete",Tn.EventType=Bn,Bn.OPEN="a",Bn.CLOSE="b",Bn.ERROR="c",Bn.MESSAGE="d",Ve.prototype.listen=Ve.prototype.O,Nr.prototype.listenOnce=Nr.prototype.P,Nr.prototype.getLastError=Nr.prototype.Sa,Nr.prototype.getLastErrorCode=Nr.prototype.Ia,Nr.prototype.getStatus=Nr.prototype.da,Nr.prototype.getResponseJson=Nr.prototype.Wa,Nr.prototype.getResponseText=Nr.prototype.ja,Nr.prototype.send=Nr.prototype.ha,Nr.prototype.setWithCredentials=Nr.prototype.Oa,Ci.prototype.digest=Ci.prototype.l,Ci.prototype.reset=Ci.prototype.reset,Ci.prototype.update=Ci.prototype.j,wi.prototype.add=wi.prototype.add,wi.prototype.multiply=wi.prototype.R,wi.prototype.modulo=wi.prototype.gb,wi.prototype.compare=wi.prototype.X,wi.prototype.toNumber=wi.prototype.ea,wi.prototype.toString=wi.prototype.toString,wi.prototype.getBits=wi.prototype.D,wi.fromNumber=Ti,wi.fromString=function t(e,n){if(0==e.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==e.charAt(0))return ji(t(e.substring(1),n));if(0<=e.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=Ti(Math.pow(n,8)),i=Bi,s=0;s<e.length;s+=8){var o=Math.min(8,e.length-s),a=parseInt(e.substring(s,s+o),n);8>o?(o=Ti(Math.pow(n,o)),i=i.R(o).add(Ti(a))):i=(i=i.R(r)).add(Ti(a))}return i},Dt.createWebChannelTransport=function(){return new mi},Dt.getStatEventTarget=function(){return gn()},Dt.ErrorCode=In,Dt.EventType=wn,Dt.Event=pn,Dt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Dt.FetchXmlHttpFactory=Sr,Dt.WebChannel=Tn,Dt.XhrIo=Nr,Dt.Md5=Ci;var Hi=Dt.Integer=wi;const Ui="@firebase/firestore";class Vi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Vi.UNAUTHENTICATED=new Vi(null),Vi.GOOGLE_CREDENTIALS=new Vi("google-credentials-uid"),Vi.FIRST_PARTY=new Vi("first-party-uid"),Vi.MOCK_USER=new Vi("mock-user");let zi="9.21.0";const $i=new U("@firebase/firestore");function Wi(t,...e){if($i.logLevel<=P.DEBUG){const n=e.map(Xi);$i.debug(`Firestore (${zi}): ${t}`,...n)}}function Zi(t,...e){if($i.logLevel<=P.ERROR){const n=e.map(Xi);$i.error(`Firestore (${zi}): ${t}`,...n)}}function Xi(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function qi(t="Unexpected state"){const e=`FIRESTORE (${zi}) INTERNAL ASSERTION FAILED: `+t;throw Zi(e),new Error(e)}function Ki(t,e){t||qi()}const Yi="cancelled",Gi="invalid-argument",Ji="failed-precondition",Qi="unavailable";class ts extends x{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class es{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class ns{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class rs{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Vi.UNAUTHENTICATED)))}shutdown(){}}class is{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class ss{constructor(t){this.t=t,this.currentUser=Vi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const r=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let i=new es;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new es,t.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const e=i;t.enqueueRetryable((async()=>{await e.promise,await r(this.currentUser)}))},o=t=>{Wi("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Wi("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new es)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Wi("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Ki("string"==typeof e.accessToken),new ns(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ki(null===t||"string"==typeof t),new Vi(t)}}class os{constructor(t,e,n){this.h=t,this.l=e,this.m=n,this.type="FirstParty",this.user=Vi.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const t=this.p();return t&&this.g.set("Authorization",t),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class as{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new os(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(Vi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class cs{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ls{constructor(t){this.I=t,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(t,e){const n=t=>{null!=t.error&&Wi("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.T;return this.T=t.token,Wi("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const r=t=>{Wi("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.I.onInit((t=>r(t))),setTimeout((()=>{if(!this.appCheck){const t=this.I.getImmediate({optional:!0});t?r(t):Wi("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Ki("string"==typeof t.token),this.T=t.token,new cs(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function hs(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let e=0;e<t;e++)n[e]=Math.floor(256*Math.random());return n}class us{static A(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const r=hs(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length))}return n}}function ds(t,e){return t<e?-1:t>e?1:0}class ps{constructor(t,e,n){void 0===e?e=0:e>t.length&&qi(),void 0===n?n=t.length-e:n>t.length-e&&qi(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===ps.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof ps?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const n=t.get(r),i=e.get(r);if(n<i)return-1;if(n>i)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class fs extends ps{construct(t,e,n){return new fs(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new ts(Gi,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new fs(e)}static emptyPath(){return new fs([])}}class gs{constructor(t){this.path=t}static fromPath(t){return new gs(fs.fromString(t))}static fromName(t){return new gs(fs.fromString(t).popFirst(5))}static empty(){return new gs(fs.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===fs.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return fs.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new gs(new fs(t.slice()))}}function ms(t){return"IndexedDbTransactionError"===t.name}class As{constructor(t,e){this.comparator=t,this.root=e||bs.EMPTY}insert(t,e){return new As(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,bs.BLACK,null,null))}remove(t){return new As(this.comparator,this.root.remove(t,this.comparator).copy(null,null,bs.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new ys(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new ys(this.root,t,this.comparator,!1)}getReverseIterator(){return new ys(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new ys(this.root,t,this.comparator,!0)}}class ys{constructor(t,e,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!t.isEmpty();)if(i=e?n(t.key,e):1,e&&r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class bs{constructor(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:bs.RED,this.left=null!=r?r:bs.EMPTY,this.right=null!=i?i:bs.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,r,i){return new bs(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let r=this;const i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return bs.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===e(t,r.key)){if(r.right.isEmpty())return bs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,bs.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,bs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw qi();if(this.right.isRed())throw qi();const t=this.left.check();if(t!==this.right.check())throw qi();return t+(this.isRed()?0:1)}}bs.EMPTY=null,bs.RED=!0,bs.BLACK=!1,bs.EMPTY=new class{constructor(){this.size=0}get key(){throw qi()}get value(){throw qi()}get color(){throw qi()}get left(){throw qi()}get right(){throw qi()}copy(t,e,n,r,i){return this}insert(t,e,n){return new bs(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class vs{constructor(t){this.comparator=t,this.data=new As(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Cs(this.data.getIterator())}getIteratorFrom(t){return new Cs(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof vs))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,r=n.getNext().key;if(0!==this.comparator(t,r))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new vs(this.comparator);return e.data=t,e}}class Cs{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Is extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class ws{constructor(t){this.binaryString=t}static fromBase64String(t){const e=function(t){try{return atob(t)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new Is("Invalid base64 string: "+t):t}}(t);return new ws(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new ws(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return ds(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}function Es(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}ws.EMPTY_BYTE_STRING=new ws(""),new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);class xs{constructor(t,e,n,r,i,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Ts{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new Ts("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof Ts&&t.projectId===this.projectId&&t.database===this.database}}var ks,Bs;new As(gs.comparator),new As(gs.comparator),new As(gs.comparator),new vs(gs.comparator),new vs(ds),(Bs=ks||(ks={}))[Bs.OK=0]="OK",Bs[Bs.CANCELLED=1]="CANCELLED",Bs[Bs.UNKNOWN=2]="UNKNOWN",Bs[Bs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Bs[Bs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Bs[Bs.NOT_FOUND=5]="NOT_FOUND",Bs[Bs.ALREADY_EXISTS=6]="ALREADY_EXISTS",Bs[Bs.PERMISSION_DENIED=7]="PERMISSION_DENIED",Bs[Bs.UNAUTHENTICATED=16]="UNAUTHENTICATED",Bs[Bs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Bs[Bs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Bs[Bs.ABORTED=10]="ABORTED",Bs[Bs.OUT_OF_RANGE=11]="OUT_OF_RANGE",Bs[Bs.UNIMPLEMENTED=12]="UNIMPLEMENTED",Bs[Bs.INTERNAL=13]="INTERNAL",Bs[Bs.UNAVAILABLE=14]="UNAVAILABLE",Bs[Bs.DATA_LOSS=15]="DATA_LOSS",new Hi([4294967295,4294967295],0);class Ss extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ds{constructor(){}_e(t,e){this.we(t,e),e.me()}we(t,e){if("nullValue"in t)this.ge(e,5);else if("booleanValue"in t)this.ge(e,10),e.ye(t.booleanValue?1:0);else if("integerValue"in t)this.ge(e,15),e.ye(Es(t.integerValue));else if("doubleValue"in t){const n=Es(t.doubleValue);isNaN(n)?this.ge(e,13):(this.ge(e,15),function(t){return 0===t&&1/t==-1/0}(n)?e.ye(0):e.ye(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ge(e,20),"string"==typeof n?e.pe(n):(e.pe(`${n.seconds||""}`),e.ye(n.nanos||0))}else if("stringValue"in t)this.Ie(t.stringValue,e),this.Te(e);else if("bytesValue"in t)this.ge(e,30),e.Ee(function(t){return"string"==typeof t?ws.fromBase64String(t):ws.fromUint8Array(t)}(t.bytesValue)),this.Te(e);else if("referenceValue"in t)this.Ae(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ge(e,45),e.ye(n.latitude||0),e.ye(n.longitude||0)}else"mapValue"in t?function(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}(t)?this.ge(e,Number.MAX_SAFE_INTEGER):(this.Re(t.mapValue,e),this.Te(e)):"arrayValue"in t?(this.ve(t.arrayValue,e),this.Te(e)):qi()}Ie(t,e){this.ge(e,25),this.Pe(t,e)}Pe(t,e){e.pe(t)}Re(t,e){const n=t.fields||{};this.ge(e,55);for(const t of Object.keys(n))this.Ie(t,e),this.we(n[t],e)}ve(t,e){const n=t.values||[];this.ge(e,50);for(const t of n)this.we(t,e)}Ae(t,e){this.ge(e,37),gs.fromName(t).path.forEach((t=>{this.ge(e,60),this.Pe(t,e)}))}ge(t,e){t.ye(e)}Te(t){t.ye(2)}}Ds.be=new Ds,new Uint8Array(0);class _s{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new _s(t,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Ls(){return"undefined"!=typeof document?document:null}_s.DEFAULT_COLLECTION_PERCENTILE=10,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_s.DEFAULT=new _s(41943040,_s.DEFAULT_COLLECTION_PERCENTILE,_s.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_s.DISABLED=new _s(-1,0,0);class js{constructor(t,e,n=1e3,r=1.5,i=6e4){this.si=t,this.timerId=e,this.vo=n,this.Po=r,this.bo=i,this.Vo=0,this.So=null,this.Do=Date.now(),this.reset()}reset(){this.Vo=0}Co(){this.Vo=this.bo}xo(t){this.cancel();const e=Math.floor(this.Vo+this.No()),n=Math.max(0,Date.now()-this.Do),r=Math.max(0,e-n);r>0&&Wi("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Vo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.So=this.si.enqueueAfterDelay(this.timerId,r,(()=>(this.Do=Date.now(),t()))),this.Vo*=this.Po,this.Vo<this.vo&&(this.Vo=this.vo),this.Vo>this.bo&&(this.Vo=this.bo)}ko(){null!==this.So&&(this.So.skipDelay(),this.So=null)}cancel(){null!==this.So&&(this.So.cancel(),this.So=null)}No(){return(Math.random()-.5)*this.Vo}}class Rs{constructor(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new es,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,r,i){const s=Date.now()+n,o=new Rs(t,e,s,r,i);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ts(Yi,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class Ps{constructor(t,e,n,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=Vi.UNAUTHENTICATED,this.clientId=us.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Wi("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Wi("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new ts(Ji,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new es;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=function(t,e){if(Zi("AsyncQueue",`${e}: ${t}`),ms(t))return new ts(Qi,`${e}: ${t}`);throw t}(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}const Ns=new Map;function Os(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ts(Gi,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":qi()}(t);throw new ts(Gi,`Expected type '${e.name}', but it was: ${n}`)}}return t}class Ms{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new ts(Gi,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.cache=t.localCache,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new ts(Gi,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}(function(t,e,n,r){if(!0===e&&!0===r)throw new ts(Gi,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")})(0,t.experimentalForceLongPolling,0,t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling||void 0===t.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!1:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Fs{constructor(t,e,n,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ms({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new ts(Ji,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new ts(Ji,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ms(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new rs;switch(t.type){case"firstParty":return new as(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new ts(Gi,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=Ns.get(t);e&&(Wi("ComponentProvider","Removing Datastore"),Ns.delete(t),e.terminate())}(this),Promise.resolve()}}function Hs(t,e,n,r={}){var i;const s=(t=Os(t,Fs))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==e&&function(t,...e){if($i.logLevel<=P.WARN){const n=e.map(Xi);$i.warn(`Firestore (${zi}): ${t}`,...n)}}("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},s),{host:`${e}:${n}`,ssl:!1})),r.mockUserToken){let e,n;if("string"==typeof r.mockUserToken)e=r.mockUserToken,n=Vi.MOCK_USER;else{e=function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[I(JSON.stringify({alg:"none",type:"JWT"})),I(JSON.stringify(s)),""].join(".")}(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ts(Gi,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Vi(s)}t._authCredentials=new is(new ns(e,n))}}class Us{constructor(){this.Kc=Promise.resolve(),this.Gc=[],this.Qc=!1,this.jc=[],this.zc=null,this.Wc=!1,this.Hc=!1,this.Jc=[],this.Lo=new js(this,"async_queue_retry"),this.Yc=()=>{const t=Ls();t&&Wi("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Lo.ko()};const t=Ls();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Yc)}get isShuttingDown(){return this.Qc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Xc(),this.Zc(t)}enterRestrictedMode(t){if(!this.Qc){this.Qc=!0,this.Hc=t||!1;const e=Ls();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Yc)}}enqueue(t){if(this.Xc(),this.Qc)return new Promise((()=>{}));const e=new es;return this.Zc((()=>this.Qc&&this.Hc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Gc.push(t),this.ta())))}async ta(){if(0!==this.Gc.length){try{await this.Gc[0](),this.Gc.shift(),this.Lo.reset()}catch(t){if(!ms(t))throw t;Wi("AsyncQueue","Operation failed with retryable error: "+t)}this.Gc.length>0&&this.Lo.xo((()=>this.ta()))}}Zc(t){const e=this.Kc.then((()=>(this.Wc=!0,t().catch((t=>{this.zc=t,this.Wc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Zi("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Wc=!1,t))))));return this.Kc=e,e}enqueueAfterDelay(t,e,n){this.Xc(),this.Jc.indexOf(t)>-1&&(e=0);const r=Rs.createAndSchedule(this,t,e,n,(t=>this.ea(t)));return this.jc.push(r),r}Xc(){this.zc&&qi()}verifyOperationInProgress(){}async na(){let t;do{t=this.Kc,await t}while(t!==this.Kc)}sa(t){for(const e of this.jc)if(e.timerId===t)return!0;return!1}ia(t){return this.na().then((()=>{this.jc.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.jc)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.na()}))}ra(t){this.Jc.push(t)}ea(t){const e=this.jc.indexOf(t);this.jc.splice(e,1)}}class Vs extends Fs{constructor(t,e,n,r){super(t,e,n,r),this.type="firestore",this._queue=new Us,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||function(t){var e,n,r;const i=t._freezeSettings(),s=function(t,e,n,r){return new xs(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new Ps(t._authCredentials,t._appCheckCredentials,t._queue,s),(null===(n=i.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}(this),this._firestoreClient.terminate()}}new RegExp("[~\\*/\\[\\]]"),function(t,e=!0){zi="9.21.0",pt(new D("firestore",((t,{instanceIdentifier:n,options:r})=>{const i=t.getProvider("app").getImmediate(),s=new Vs(new ss(t.getProvider("auth-internal")),new ls(t.getProvider("app-check-internal")),function(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new ts(Gi,'"projectId" not provided in firebase.initializeApp.');return new Ts(t.options.projectId,e)}(i,n),i);return r=Object.assign({useFetchStreams:e},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),At(Ui,"3.11.0",t),At(Ui,"3.11.0","esm2017")}(),console.log(kt),function(t,e){const n="string"==typeof t?t:"(default)",r=function(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}("object"==typeof t?t:function(t=ct){const e=ht.get(t);if(!e&&t===ct)return mt();if(!e)throw ft.create("no-app",{appName:t});return e}(),"firestore").getImmediate({identifier:n});if(!r._initialized){const t=(t=>{const e=(t=>{var e,n;return null===(n=null===(e=w())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]})(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return"["===e[0]?[e.substring(1,n-1),r]:[e.substring(0,n),r]})("firestore");t&&Hs(r,...t)}}(mt(kt));const zs=(()=>{const e=JSON.parse(localStorage.getItem("projects"))||[];return t.subscribe("ProjectChanged",(()=>{localStorage.setItem("projects",JSON.stringify(e))})),{getProjects:async()=>e,getProjectById:async t=>e.find((e=>e.id===t)),addProject:async t=>{const n=r(e),i=new y(n,t.name);return e.push(i),i},deleteProject:async t=>{e.splice(s(e,t),1)}}})(),$s=zs,Ws=async e=>{const n=new y("",e),r=await $s.addProject(n);return t.publish("ProjectChanged"),r},Zs=async()=>await $s.getProjects(),Xs=async t=>await $s.getProjectById(t);(async()=>{const t=await Zs();console.log(t),0===t.length&&Ws("Default")})();var qs=n(379),Ks=n.n(qs),Ys=n(795),Gs=n.n(Ys),Js=n(569),Qs=n.n(Js),to=n(565),eo=n.n(to),no=n(216),ro=n.n(no),io=n(589),so=n.n(io),oo=n(563),ao={};ao.styleTagTransform=so(),ao.setAttributes=eo(),ao.insert=Qs().bind(null,"head"),ao.domAPI=Gs(),ao.insertStyleElement=ro(),Ks()(oo.Z,ao),oo.Z&&oo.Z.locals&&oo.Z.locals;var co=n(586),lo=n.n(co),ho=n(110),uo={};uo.styleTagTransform=so(),uo.setAttributes=eo(),uo.insert=Qs().bind(null,"head"),uo.domAPI=Gs(),uo.insertStyleElement=ro(),Ks()(ho.Z,uo),ho.Z&&ho.Z.locals&&ho.Z.locals;class po{constructor(t,e){return this.checked=t,this.callback=e,this.checkboxDiv=document.createElement("div"),this.checkboxDiv.addEventListener("click",this.onClick.bind(this)),this.checkboxDiv.classList.add("checkbox"),this.updateCheckMark(),this.checkboxDiv}toggle(){this.checked?this.checked=!1:this.checked=!0,this.updateCheckMark()}updateCheckMark(){if(this.checked){const t=document.createElement("div");t.innerHTML=lo(),this.checkboxDiv.appendChild(t.firstChild)}else this.checkboxDiv.innerHTML=""}onClick(){this.toggle(),this.callback()}}function fo(t,e){for(var n=t<0?"-":"",r=Math.abs(t).toString();r.length<e;)r="0"+r;return n+r}function go(t,e){var n,r;o(1,arguments);var i=c(t);if(isNaN(i.getTime()))throw new RangeError("Invalid time value");var s=String(null!==(n=null==e?void 0:e.format)&&void 0!==n?n:"extended"),a=String(null!==(r=null==e?void 0:e.representation)&&void 0!==r?r:"complete");if("extended"!==s&&"basic"!==s)throw new RangeError("format must be 'extended' or 'basic'");if("date"!==a&&"time"!==a&&"complete"!==a)throw new RangeError("representation must be 'date', 'time', or 'complete'");var l="",h="",u="extended"===s?"-":"",d="extended"===s?":":"";if("time"!==a){var p=fo(i.getDate(),2),f=fo(i.getMonth()+1,2),g=fo(i.getFullYear(),4);l="".concat(g).concat(u).concat(f).concat(u).concat(p)}if("date"!==a){var m=i.getTimezoneOffset();if(0!==m){var A=Math.abs(m),y=fo(Math.floor(A/60),2),b=fo(A%60,2),v=m<0?"+":"-";h="".concat(v).concat(y,":").concat(b)}else h="Z";var C=fo(i.getHours(),2),I=fo(i.getMinutes(),2),w=fo(i.getSeconds(),2),E=""===l?"":"T",x=[C,I,w].join(d);l="".concat(l).concat(E).concat(x).concat(h)}return l}const mo=new class{async render(n){if(this.todoItem=await async function(t){return await d.getTodoItemById(t)}(n),!this.todoItem)return;const r=await Xs(this.todoItem.projectId),s=document.createElement("div");s.classList.add("todo-item-container");const o=document.createElement("h2");o.textContent=this.todoItem.title;const a=document.createElement("div");a.classList.add("todoItemContent");const c=document.createElement("span");c.textContent="Project: ",a.appendChild(c);const l=document.createElement("a");l.href="#",l.textContent=r.name,l.addEventListener("click",(t=>{t.preventDefault(),i("ProjectDetail",r.id)})),c.appendChild(l);const h=document.createElement("select");h.name="project";const u=await Zs();for(let t of u){const e=document.createElement("option");e.name="project",e.value=t.id,e.text=t.name,h.appendChild(e),t.id===this.todoItem.projectId&&(e.selected=!0)}h.addEventListener("change",(t=>{this.todoItem.projectId=Number(t.target.value),this.onItemChange()})),a.appendChild(h);const p=document.createElement("label");p.setAttribute("for","priority"),p.textContent="Priority",a.appendChild(p);const f=document.createElement("select");f.required=!0,f.name="priority",f.id="priority";for(const t of Object.keys(e.priorities)){const n=Number(t),r=document.createElement("option");r.name="priority",r.value=n,r.text=e.priorities[n],n===this.todoItem.priority&&(r.selected=!0),f.appendChild(r)}f.addEventListener("change",(t=>{this.todoItem.priority=Number(t.target.value),this.onItemChange()})),a.appendChild(f);const g=document.createElement("label");g.setAttribute("for","description"),g.textContent="Description";const m=document.createElement("input");m.value=this.todoItem.description,m.name="description",m.addEventListener("change",(t=>{this.todoItem.description=t.target.value,this.onItemChange()})),a.appendChild(g),a.appendChild(m);const A=document.createElement("label");A.setAttribute("for","dueDate"),A.textContent="Due Date",a.appendChild(A);const y=document.createElement("input");y.type="date",y.name="dueDate",y.value=go(this.todoItem.dueDate,{representation:"date"}),y.addEventListener("change",(t=>{this.todoItem.dueDate=new Date(t.target.value),this.onItemChange()})),a.appendChild(y);const b=document.createElement("span");b.textContent="Is completed";const v=new po(this.todoItem.isComplete,(async()=>{this.todoItem.isComplete=!this.todoItem.isComplete,await this.onItemChange()}));a.appendChild(b),a.appendChild(v);const C=document.createElement("button");return C.textContent="Delete",C.classList.add("delete-todoitem-button"),C.addEventListener("click",(async e=>{await async function(t){await d.deleteTodoItem(t)}(this.todoItem.id),t.publish("changePage",{page:"ProjectDetail",data:r.id})})),a.appendChild(C),s.appendChild(o),s.appendChild(a),s}async onItemChange(){await A(this.todoItem),i("TodoItemDetail",this.todoItem.id)}};var Ao=n(454),yo={};yo.styleTagTransform=so(),yo.setAttributes=eo(),yo.insert=Qs().bind(null,"head"),yo.domAPI=Gs(),yo.insertStyleElement=ro(),Ks()(Ao.Z,yo),Ao.Z&&Ao.Z.locals&&Ao.Z.locals;var bo=n(697),vo=n.n(bo),Co=n(168),Io=n.n(Co);class wo{links=[{name:"Add Todo Item",link:"AddTodoItem"},{name:"Add Project",link:"AddProject"}];render(){const t=document.createElement("div");t.className="add-container";const e=document.createElement("div");e.className="icon-container";const n=document.createElement("i");n.innerHTML=vo(),n.className="add-icon";const r=document.createElement("i");r.innerHTML=Io(),r.className="chevron-icon",e.appendChild(n),e.appendChild(r),t.appendChild(e);const s=document.createElement("div");s.className="add-dropdown",s.style.display="none";const o=document.createElement("ul");o.className="add-dropdown-list";for(let t of this.links){const e=document.createElement("li"),n=document.createElement("a");n.href="",n.text=t.name,n.addEventListener("click",(e=>{e.preventDefault(),i(t.link),s.style.display="none"})),e.appendChild(n),o.appendChild(e)}return s.appendChild(o),document.addEventListener("click",(e=>{t.contains(e.target)||"none"===s.style.display||(s.style.display="none")})),e.addEventListener("click",(t=>{"none"===s.style.display?s.style.display="block":s.style.display="none"})),t.appendChild(s),t}}var Eo=n(718),xo=n.n(Eo),To=n(9),ko={};ko.styleTagTransform=so(),ko.setAttributes=eo(),ko.insert=Qs().bind(null,"head"),ko.domAPI=Gs(),ko.insertStyleElement=ro(),Ks()(To.Z,ko),To.Z&&To.Z.locals&&To.Z.locals;const Bo=new class{render(){const t=document.createElement("header"),e=document.createElement("div");e.className="logo-container";const n=document.createElement("i");n.className="logo-icon",n.innerHTML=xo(),e.appendChild(n);const r=document.createElement("span");r.textContent="Odin Todo-List",r.className="logo-text",e.appendChild(r),e.addEventListener("click",(t=>{i("TodoItemList",{title:"All items",callback:f})})),t.appendChild(e);const s=document.createElement("div");s.classList.add("buttons-container");const o=new wo;return s.appendChild(o.render()),t.appendChild(s),t}onHeaderLinkClick(e,n){e.preventDefault(),t.publish("changePage",{page:n.page})}},So=new class{async getTodoItemsForProject(t){return(await f()).filter((e=>e.projectId===t))}};var Do=n(464),_o={};_o.styleTagTransform=so(),_o.setAttributes=eo(),_o.insert=Qs().bind(null,"head"),_o.domAPI=Gs(),_o.insertStyleElement=ro(),Ks()(Do.Z,_o),Do.Z&&Do.Z.locals&&Do.Z.locals;var Lo=n(938),jo={};jo.styleTagTransform=so(),jo.setAttributes=eo(),jo.insert=Qs().bind(null,"head"),jo.domAPI=Gs(),jo.insertStyleElement=ro(),Ks()(Lo.Z,jo),Lo.Z&&Lo.Z.locals&&Lo.Z.locals;class Ro{constructor(t,e,n,r){this.title=t,this.callback=e,this.icon=n,this.projectId=r}async render(){const e=document.createElement("li");e.className="sidebar-link-item";const n=document.createElement("a");n.href="#";const r=document.createElement("span");if(r.textContent=this.title,this.icon){const t=document.createElement("i");t.innerHTML=this.icon,n.appendChild(t)}const s=document.createElement("span");s.className="sidebar-link-item-number";const o=await this.callback();return s.textContent=o.filter((t=>!t.isComplete)).length,t.subscribe("TodoItemsChanged",(async()=>{const t=await this.callback();s.textContent=t.filter((t=>!t.isComplete)).length})),n.append(r,s),e.appendChild(n),e.addEventListener("click",(t=>{t.preventDefault(),this.projectId?i("ProjectDetail",this.projectId):i("TodoItemList",{title:this.title,callback:this.callback})})),e}}var Po=n(27),No=n.n(Po),Oo=n(428),Mo=n.n(Oo),Fo=n(646),Ho=n.n(Fo);const Uo=new class{mainLinks=[{title:"All items",callback:f,icon:No()},{title:"Today",callback:g,icon:Mo()},{title:"Upcoming",callback:m,icon:Ho()}];async render(){const e=document.createElement("div");e.className="sidebar";const n=document.createElement("ul");n.className="sidebar-link-list";for(let t of this.mainLinks){const e=await new Ro(t.title,t.callback,t.icon||null).render();n.appendChild(e)}const r=document.createElement("ul");return r.className="sidebar-link-list",this.createProjectList(r),t.subscribe("ProjectChanged",(()=>{r.innerHTML="",this.createProjectList(r)})),e.appendChild(n),e.appendChild(r),e}createProjectList(t){const e=document.createElement("li");e.classList.add("sidebar-link-list-header","sidebar-link-item");const n=document.createElement("a");n.href="#",n.text="Projects",e.appendChild(n),t.appendChild(e),this.addProjectLinks(t)}async addProjectLinks(t){const e=await Zs();console.log(e);for(let n of e){const e=await new Ro(n.name,(()=>So.getTodoItemsForProject(n.id)),null,n.id).render();t.appendChild(e)}}};var Vo=n(411),zo={};function $o(t,e){o(2,arguments);var n=c(t),r=c(e);return n.getTime()<r.getTime()}zo.styleTagTransform=so(),zo.setAttributes=eo(),zo.insert=Qs().bind(null,"head"),zo.domAPI=Gs(),zo.insertStyleElement=ro(),Ks()(Vo.Z,zo),Vo.Z&&Vo.Z.locals&&Vo.Z.locals;const Wo=class{constructor(t){this.todoItems=t}render(){if(this.todoItems)return this.todoItemsList=document.createElement("ul"),this.todoItemsList.className="todo-items-list",this.renderListItems(),this.todoItemsList}renderListItems(){this.todoItems.sort(((t,e)=>{if(t.isComplete===e.isComplete&&!1===t.isComplete){if(t.priority!==e.priority)return t.priority-e.priority;if($o(t.dueDate,e.dueDate))return 1}else if(t.isComplete===e.isComplete&&!0===t.isComplete){if($o(t.dueDate,e.dueDate))return 1}else if(t.isComplete&&!e.isComplete)return 1}));for(let t of this.todoItems){const n=document.createElement("li");t.isComplete&&n.classList.add("checked");const r=new po(t.isComplete,(()=>{t.isComplete=!t.isComplete,A(t),this.todoItemsList.innerHTML="",this.renderListItems()}));r.classList.add(`${e.priorities[t.priority].toLowerCase()}`),n.appendChild(r);const s=document.createElement("div");s.className="todo-items-list-item-content";const o=document.createElement("span");o.textContent=t.title,s.appendChild(o);const a=document.createElement("span");a.textContent=go(t.dueDate,{representation:"date"}),s.appendChild(a),n.addEventListener("click",(e=>{(e.target===n||s.contains(e.target))&&i("TodoItemDetail",t.id)})),n.appendChild(s),this.todoItemsList.appendChild(n)}}};var Zo=n(780),Xo={};Xo.styleTagTransform=so(),Xo.setAttributes=eo(),Xo.insert=Qs().bind(null,"head"),Xo.domAPI=Gs(),Xo.insertStyleElement=ro(),Ks()(Zo.Z,Xo),Zo.Z&&Zo.Z.locals&&Zo.Z.locals;const qo=new class{async render(e){const n=await Xs(e),r=await So.getTodoItemsForProject(n.id),s=document.createElement("div");s.classList.add("project-detail");const o=document.createElement("h2");if(o.textContent=n.name||"Project Details",s.appendChild(o),0===r.length){const t=document.createElement("p");t.textContent="There are currently no items in this project.",s.appendChild(t)}else{const t=new Wo(r);s.appendChild(t.render())}const a=document.createElement("button");return a.textContent="Delete Project",a.classList.add("delete-project-button"),("Default"===n.name||await Zs().length<=1)&&(a.disabled=!0),a.addEventListener("click",(async e=>{await(async e=>{await $s.deleteProject(e),t.publish("ProjectChanged")})(n.id),i("TodoItemList",{title:"All items",callback:f})})),s.appendChild(a),s}};var Ko=n(528),Yo={};Yo.styleTagTransform=so(),Yo.setAttributes=eo(),Yo.insert=Qs().bind(null,"head"),Yo.domAPI=Gs(),Yo.insertStyleElement=ro(),Ks()(Ko.Z,Yo),Ko.Z&&Ko.Z.locals&&Ko.Z.locals;const Go=new class{async render(){const t=await Zs(),n=document.createElement("div"),r=document.createElement("h2");r.textContent="Add Todo Item";const i=document.createElement("form");i.addEventListener("submit",this.onFormSubmit);const s=document.createElement("label");s.setAttribute("for","title"),s.textContent="Title",i.appendChild(s);const o=document.createElement("input");o.required=!0,o.name="title",o.type="text",o.id="title",i.appendChild(o);const a=document.createElement("label");a.setAttribute("for","priority"),a.textContent="Priority",i.appendChild(a);const c=document.createElement("select");c.required=!0,c.name="priority",c.id="priority";for(let t of Object.keys(e.priorities)){const n=document.createElement("option");n.name="priority",n.value=t,n.text=e.priorities[t],c.appendChild(n)}i.appendChild(c);const l=document.createElement("label");l.setAttribute("for","description"),l.textContent="Description",i.appendChild(l);const h=document.createElement("textarea");h.required=!0,h.name="description",h.id="description",i.appendChild(h);const u=document.createElement("label");u.setAttribute("for","dueDate"),u.textContent="Due Date",i.appendChild(u);const d=document.createElement("input");d.required=!0,d.type="date",d.name="dueDate",d.id="dueDate",i.appendChild(d);const p=document.createElement("label");p.setAttribute("for","project"),p.textContent="Project";const f=document.createElement("select");f.required=!0,f.name="project",f.id="project";for(let e of t){const t=document.createElement("option");t.value=e.id,t.textContent=e.name,f.appendChild(t)}i.appendChild(f);const g=document.createElement("button");return g.type="submit",g.textContent="Add",i.appendChild(g),n.appendChild(r),n.appendChild(i),n}async onFormSubmit(t){t.preventDefault();const e=t.target;if(!e.checkValidity())return void e.reportValidity();let n=new FormData(e);await p(n.get("title"),n.get("priority"),n.get("description"),n.get("dueDate"),Number(n.get("project")))&&e.reset()}},Jo=new class{async render(){const t=document.createElement("div"),e=document.createElement("h2");e.textContent="Add Project";const n=document.createElement("form");n.addEventListener("submit",this.onFormSubmit);const r=document.createElement("label");r.setAttribute("for","name"),r.textContent="Project name",n.appendChild(r);const i=document.createElement("input");i.type="text",i.name="name",i.id="name",i.required=!0,n.appendChild(i);const s=document.createElement("button");return s.textContent="Add",n.appendChild(s),t.appendChild(e),t.appendChild(n),t}async onFormSubmit(t){t.preventDefault();const e=t.target;if(!e.checkValidity())return void e.reportValidity();const n=new FormData(e),r=await Ws(n.get("name"));r&&i("ProjectDetail",r.id)}},Qo=new class{async render({title:t,callback:e}){this.todoItems=await e();const n=document.createElement("div"),r=document.createElement("h2");r.textContent=t,n.appendChild(r);const i=new Wo(this.todoItems).render();return n.appendChild(i),n}};var ta=n(426),ea={};ea.styleTagTransform=so(),ea.setAttributes=eo(),ea.insert=Qs().bind(null,"head"),ea.domAPI=Gs(),ea.insertStyleElement=ro(),Ks()(ta.Z,ea),ta.Z&&ta.Z.locals&&ta.Z.locals,(async()=>{0===f().length&&(p("Test",3,"Test Description","2022-12-29"),p("Test2",3,"Test Description 2","2022-12-30"));const e={TodoItemDetail:mo,ProjectDetail:qo,AddTodoItem:Go,AddProject:Jo,TodoItemList:Qo};t.subscribe("changePage",i),document.body.appendChild(Bo.render());const n=await Uo.render();document.body.appendChild(n);const r=document.createElement("div");async function i(t){if(!t.page||!e[t.page])return;const n=await e[t.page].render(t.data);r.innerHTML="",r.appendChild(n)}r.classList.add("main-content"),document.body.appendChild(r),await i({page:"TodoItemList",data:{title:"All items",callback:f}}),mt(kt)})()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MTJDLEVBQUsrRyxNQUMxQixPQUdKLE1BQU1oRSxRQUFnQjJ6QyxFQUFNMTJDLEVBQUsrRyxNQUFNc3JDLE9BQU9yeUMsRUFBS0EsTUFDbkQ2MkMsRUFBWW5JLFVBQVksR0FDeEJtSSxFQUFZL3pDLFlBQVlDLEVBQzVCLENBWEE4ekMsRUFBWXZJLFVBQVVuNkIsSUFBSSxnQkFDMUI5UixTQUFTa3hCLEtBQUt6d0IsWUFBWSt6QyxTQVlwQkYsRUFBVyxDQUNiNXZDLEtBQU0sZUFDTi9HLEtBQU0sQ0FBQ21HLE1BQU0sWUFBYUwsU0FBU3lELEtBRzNCb1MsR0FBYyxHQUM3QixFQXZDRCIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvY29tcG9uZW50cy9BZGRDb21wb25lbnQuY3NzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvY29tcG9uZW50cy9DaGVja2JveC5jc3MiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9jb21wb25lbnRzL1NpZGViYXJMaW5rSXRlbS5jc3MiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9jb21wb25lbnRzL1RvZG9JdGVtc0xpc3QuY3NzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9MYXlvdXQvaGVhZGVyLmNzcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvTGF5b3V0L3NpZGViYXIuY3NzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3REZXRhaWwuY3NzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9BZGRUb2RvSXRlbS5jc3MiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtRGV0YWlsLmNzcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL3N0eWxlLmNzcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0QnlTZWxlY3Rvci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0U3R5bGVFbGVtZW50LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXMuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL2NhbGVuZGFyLWJsYW5rLnN2ZyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL2NhbGVuZGFyLWNsb2NrLnN2ZyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL2NoZWNrLnN2ZyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL2NoZXZyb24tZG93bi5zdmciLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL2Fzc2V0cy9pY29ucy9jbGlwYm9hcmQtbGlzdC1vdXRsaW5lLnN2ZyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL2xpc3QtYm94LnN2ZyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vYXNzZXRzL2ljb25zL3BsdXMuc3ZnIiwid2VicGFjazovL29kaW4tdG9kb2xpc3Qvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC93ZWJwYWNrL3J1bnRpbWUvY29tcGF0IGdldCBkZWZhdWx0IGV4cG9ydCIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0L3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0L3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL29kaW4tdG9kb2xpc3Qvd2VicGFjay9ydW50aW1lL25vbmNlIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9QdWJTdWIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy91dGlsLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL3RvRGF0ZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9zdGFydE9mRGF5L2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzU2FtZURheS9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW1SZXBvc2l0b3J5TG9jYWwuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc1RvZGF5L2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2lzRnV0dXJlL2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvdXRpbC9kaXN0L2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvY29tcG9uZW50L2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvbG9nZ2VyL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9pZGIvYnVpbGQvd3JhcC1pZGItdmFsdWUuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9pZGIvYnVpbGQvaW5kZXguanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvYXBwL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9maXJlYmFzZS9hcHAvZGlzdC9lc20vaW5kZXguZXNtLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9maXJlYmFzZV9jb25maWcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2Uvd2ViY2hhbm5lbC13cmFwcGVyL2Rpc3QvZXNtL2luZGV4LmVzbTIwMTcuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL25vZGVfbW9kdWxlcy9AZmlyZWJhc2UvZmlyZXN0b3JlL2Rpc3QvaW5kZXguZXNtMjAxNy5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0UmVwb3NpdG9yeS5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0UmVwb3NpdG9yeUxvY2FsLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3RDb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbURldGFpbC5jc3M/MzcxZCIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2NvbXBvbmVudHMvQ2hlY2tib3guY3NzP2M5MjgiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9jb21wb25lbnRzL0NoZWNrYm94LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL19saWIvYWRkTGVhZGluZ1plcm9zL2luZGV4LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9ub2RlX21vZHVsZXMvZGF0ZS1mbnMvZXNtL2Zvcm1hdElTTy9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vVG9kb0l0ZW1EZXRhaWwuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9jb21wb25lbnRzL0FkZENvbXBvbmVudC5jc3M/YzFiNyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2NvbXBvbmVudHMvQWRkQ29tcG9uZW50LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9MYXlvdXQvaGVhZGVyLmNzcz80OTc4Iiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9MYXlvdXQvaGVhZGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0VG9kb0l0ZW1NZWRpYXRvci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvTGF5b3V0L3NpZGViYXIuY3NzPzQ1YTMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9jb21wb25lbnRzL1NpZGViYXJMaW5rSXRlbS5jc3M/YjhiNiIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2NvbXBvbmVudHMvU2lkZWJhckxpbmtJdGVtLmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9MYXlvdXQvc2lkZWJhci5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2NvbXBvbmVudHMvVG9kb0l0ZW1zTGlzdC5jc3M/MzQ3MyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vbm9kZV9tb2R1bGVzL2RhdGUtZm5zL2VzbS9pc0JlZm9yZS9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2NvbXBvbmVudHMvVG9kb0l0ZW1zTGlzdC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9Qcm9qZWN0RGV0YWlsLmNzcz9hNzFkIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3REZXRhaWwuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL0FkZFRvZG9JdGVtLmNzcz9lOGI3Iiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9BZGRUb2RvSXRlbS5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL21vZHVsZXMvUHJvamVjdC9BZGRQcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kb2xpc3QvLi9zcmMvbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbUxpc3QuanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvbGlzdC8uL3NyYy9zdHlsZS5jc3M/NzE2MyIsIndlYnBhY2s6Ly9vZGluLXRvZG9saXN0Ly4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEltcG9ydHNcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fIGZyb20gXCIuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvc291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18pO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwiLmFkZC1jb250YWluZXIge1xcclxcbiAgICBwb3NpdGlvbjogcmVsYXRpdmU7XFxyXFxufVxcclxcblxcclxcbi5pY29uLWNvbnRhaW5lciB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIG1pbi1jb250ZW50O1xcclxcbn1cXHJcXG5cXHJcXG4uYWRkLWljb24ge1xcclxcbiAgICBoZWlnaHQ6IDIwcHg7XFxyXFxuICAgIHdpZHRoOiAyMHB4O1xcclxcbiAgICBhbGlnbi1zZWxmOiBjZW50ZXI7XFxyXFxuICAgIGZpbGw6ICMzMzM7XFxyXFxufVxcclxcblxcclxcbi5pY29uLWNvbnRhaW5lcjpob3ZlciB7XFxyXFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXHJcXG59XFxyXFxuXFxyXFxuLmNoZXZyb24taWNvbiB7XFxyXFxuICAgIGhlaWdodDogMTRweDtcXHJcXG4gICAgd2lkdGg6IDE0cHg7XFxyXFxuICAgIGFsaWduLXNlbGY6IGVuZDtcXHJcXG4gICAgZmlsbDogIzMzMztcXHJcXG59XFxyXFxuXFxyXFxuLmFkZC1kcm9wZG93biB7XFxyXFxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcXHJcXG4gICAgdG9wOiAxMDAlO1xcclxcbiAgICByaWdodDogMjUlO1xcclxcbiAgICB3aWR0aDogbWF4LWNvbnRlbnQ7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDA7XFxyXFxufVxcclxcblxcclxcbi5hZGQtZHJvcGRvd24tbGlzdCB7XFxyXFxuICAgIGxpc3Qtc3R5bGU6IG5vbmU7XFxyXFxuICAgIGRpc3BsYXk6IGZsZXg7XFxyXFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxyXFxuICAgIHBhZGRpbmc6IDA7XFxyXFxuICAgIG1hcmdpbjogMDtcXHJcXG4gICAgZmxleDogMTtcXHJcXG59XFxyXFxuXFxyXFxuLmFkZC1kcm9wZG93bi1saXN0IGxpIHtcXHJcXG4gICAgcGFkZGluZzogMTBweCAyMHB4O1xcclxcbiAgICBmb250LXNpemU6IDE0cHg7XFxyXFxufVxcclxcblxcclxcbi5hZGQtZHJvcGRvd24tbGlzdCBsaTpob3ZlciB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7XFxyXFxufVxcclxcblxcclxcbi5hZGQtZHJvcGRvd24tbGlzdCBhIHtcXHJcXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xcclxcbiAgICBjb2xvcjogIzMzMztcXHJcXG59XCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL2NvbXBvbmVudHMvQWRkQ29tcG9uZW50LmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTtJQUNJLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLGFBQWE7SUFDYixzQ0FBc0M7QUFDMUM7O0FBRUE7SUFDSSxZQUFZO0lBQ1osV0FBVztJQUNYLGtCQUFrQjtJQUNsQixVQUFVO0FBQ2Q7O0FBRUE7SUFDSSxlQUFlO0FBQ25COztBQUVBO0lBQ0ksWUFBWTtJQUNaLFdBQVc7SUFDWCxlQUFlO0lBQ2YsVUFBVTtBQUNkOztBQUVBO0lBQ0ksa0JBQWtCO0lBQ2xCLFNBQVM7SUFDVCxVQUFVO0lBQ1Ysa0JBQWtCO0lBQ2xCLHNCQUFzQjtJQUN0QixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxnQkFBZ0I7SUFDaEIsYUFBYTtJQUNiLHNCQUFzQjtJQUN0QixVQUFVO0lBQ1YsU0FBUztJQUNULE9BQU87QUFDWDs7QUFFQTtJQUNJLGtCQUFrQjtJQUNsQixlQUFlO0FBQ25COztBQUVBO0lBQ0ksc0JBQXNCO0FBQzFCOztBQUVBO0lBQ0kscUJBQXFCO0lBQ3JCLFdBQVc7QUFDZlwiLFwic291cmNlc0NvbnRlbnRcIjpbXCIuYWRkLWNvbnRhaW5lciB7XFxyXFxuICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcXHJcXG59XFxyXFxuXFxyXFxuLmljb24tY29udGFpbmVyIHtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxZnIgbWluLWNvbnRlbnQ7XFxyXFxufVxcclxcblxcclxcbi5hZGQtaWNvbiB7XFxyXFxuICAgIGhlaWdodDogMjBweDtcXHJcXG4gICAgd2lkdGg6IDIwcHg7XFxyXFxuICAgIGFsaWduLXNlbGY6IGNlbnRlcjtcXHJcXG4gICAgZmlsbDogIzMzMztcXHJcXG59XFxyXFxuXFxyXFxuLmljb24tY29udGFpbmVyOmhvdmVyIHtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbn1cXHJcXG5cXHJcXG4uY2hldnJvbi1pY29uIHtcXHJcXG4gICAgaGVpZ2h0OiAxNHB4O1xcclxcbiAgICB3aWR0aDogMTRweDtcXHJcXG4gICAgYWxpZ24tc2VsZjogZW5kO1xcclxcbiAgICBmaWxsOiAjMzMzO1xcclxcbn1cXHJcXG5cXHJcXG4uYWRkLWRyb3Bkb3duIHtcXHJcXG4gICAgcG9zaXRpb246IGFic29sdXRlO1xcclxcbiAgICB0b3A6IDEwMCU7XFxyXFxuICAgIHJpZ2h0OiAyNSU7XFxyXFxuICAgIHdpZHRoOiBtYXgtY29udGVudDtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzAwMDtcXHJcXG59XFxyXFxuXFxyXFxuLmFkZC1kcm9wZG93bi1saXN0IHtcXHJcXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcXHJcXG4gICAgZGlzcGxheTogZmxleDtcXHJcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXHJcXG4gICAgcGFkZGluZzogMDtcXHJcXG4gICAgbWFyZ2luOiAwO1xcclxcbiAgICBmbGV4OiAxO1xcclxcbn1cXHJcXG5cXHJcXG4uYWRkLWRyb3Bkb3duLWxpc3QgbGkge1xcclxcbiAgICBwYWRkaW5nOiAxMHB4IDIwcHg7XFxyXFxuICAgIGZvbnQtc2l6ZTogMTRweDtcXHJcXG59XFxyXFxuXFxyXFxuLmFkZC1kcm9wZG93bi1saXN0IGxpOmhvdmVyIHtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTtcXHJcXG59XFxyXFxuXFxyXFxuLmFkZC1kcm9wZG93bi1saXN0IGEge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMzMzO1xcclxcbn1cIl0sXCJzb3VyY2VSb290XCI6XCJcIn1dKTtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuIiwiLy8gSW1wb3J0c1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18gZnJvbSBcIi4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9zb3VyY2VNYXBzLmpzXCI7XG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fIGZyb20gXCIuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCI7XG52YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyk7XG4vLyBNb2R1bGVcbl9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pZCwgXCIuY2hlY2tib3gge1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzO1xcclxcbiAgICB3aWR0aDogMjVweDtcXHJcXG4gICAgaGVpZ2h0OiAyNXB4O1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xcclxcbn1cXHJcXG5cXHJcXG4uY2hlY2tib3guY3JpdGljYWwge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjUzLCAyNDYsIDI0Nik7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyNTUsIDU4LCA1OCk7XFxyXFxufVxcclxcblxcclxcbi5jaGVja2JveC5pbXBvcnRhbnQge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjUzLCAyNTAsIDI0NSk7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyNTUsIDE4MiwgMjUpO1xcclxcbn1cIiwgXCJcIix7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCJ3ZWJwYWNrOi8vLi9zcmMvY29tcG9uZW50cy9DaGVja2JveC5jc3NcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIkFBQUE7SUFDSSxzQkFBc0I7SUFDdEIsV0FBVztJQUNYLFlBQVk7SUFDWixzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSxvQ0FBb0M7SUFDcEMsa0NBQWtDO0FBQ3RDOztBQUVBO0lBQ0ksb0NBQW9DO0lBQ3BDLG1DQUFtQztBQUN2Q1wiLFwic291cmNlc0NvbnRlbnRcIjpbXCIuY2hlY2tib3gge1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjMzMzO1xcclxcbiAgICB3aWR0aDogMjVweDtcXHJcXG4gICAgaGVpZ2h0OiAyNXB4O1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xcclxcbn1cXHJcXG5cXHJcXG4uY2hlY2tib3guY3JpdGljYWwge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjUzLCAyNDYsIDI0Nik7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyNTUsIDU4LCA1OCk7XFxyXFxufVxcclxcblxcclxcbi5jaGVja2JveC5pbXBvcnRhbnQge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjUzLCAyNTAsIDI0NSk7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkIHJnYigyNTUsIDE4MiwgMjUpO1xcclxcbn1cIl0sXCJzb3VyY2VSb290XCI6XCJcIn1dKTtcbi8vIEV4cG9ydHNcbmV4cG9ydCBkZWZhdWx0IF9fX0NTU19MT0FERVJfRVhQT1JUX19fO1xuIiwiLy8gSW1wb3J0c1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18gZnJvbSBcIi4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9zb3VyY2VNYXBzLmpzXCI7XG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fIGZyb20gXCIuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvYXBpLmpzXCI7XG52YXIgX19fQ1NTX0xPQURFUl9FWFBPUlRfX18gPSBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18oX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyk7XG4vLyBNb2R1bGVcbl9fX0NTU19MT0FERVJfRVhQT1JUX19fLnB1c2goW21vZHVsZS5pZCwgXCIuc2lkZWJhci1saW5rLWl0ZW0gPiBhIHtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW4tY29udGVudCAxZnIgMWZyO1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMDAwO1xcclxcbiAgICBwYWRkaW5nOiA1cHg7XFxyXFxuICAgIGZvbnQtc2l6ZTogMTRweDtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgZ2FwOiA1cHg7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstaXRlbSA+IGE6aG92ZXIge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstbGlzdC1oZWFkZXIgPiBhIHtcXHJcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstaXRlbS1udW1iZXIge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGVkZWRlO1xcclxcbiAgICBwYWRkaW5nOiAycHggNnB4O1xcclxcbiAgICBib3JkZXItcmFkaXVzOiA0MCU7XFxyXFxuICAgIGp1c3RpZnktc2VsZjogZW5kO1xcclxcbiAgICBncmlkLWNvbHVtbjogMztcXHJcXG59XFxyXFxuXFxyXFxuLnNpZGViYXItbGluay1pdGVtIGkge1xcclxcbiAgICBoZWlnaHQ6IDE4cHg7XFxyXFxuICAgIHdpZHRoOiAxOHB4O1xcclxcbn1cXHJcXG5cXHJcXG4uc2lkZWJhci1saW5rLWl0ZW0gaSA+IHN2ZyB7XFxyXFxuICAgIGZpbGw6ICMzMzM7XFxyXFxufVwiLCBcIlwiLHtcInZlcnNpb25cIjozLFwic291cmNlc1wiOltcIndlYnBhY2s6Ly8uL3NyYy9jb21wb25lbnRzL1NpZGViYXJMaW5rSXRlbS5jc3NcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIkFBQUE7SUFDSSxhQUFhO0lBQ2IsMENBQTBDO0lBQzFDLHFCQUFxQjtJQUNyQixXQUFXO0lBQ1gsWUFBWTtJQUNaLGVBQWU7SUFDZixtQkFBbUI7SUFDbkIsUUFBUTtBQUNaOztBQUVBO0lBQ0kscUJBQXFCO0lBQ3JCLHNCQUFzQjtBQUMxQjs7QUFFQTtJQUNJLGlCQUFpQjtBQUNyQjs7QUFFQTtJQUNJLHlCQUF5QjtJQUN6QixnQkFBZ0I7SUFDaEIsa0JBQWtCO0lBQ2xCLGlCQUFpQjtJQUNqQixjQUFjO0FBQ2xCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLFdBQVc7QUFDZjs7QUFFQTtJQUNJLFVBQVU7QUFDZFwiLFwic291cmNlc0NvbnRlbnRcIjpbXCIuc2lkZWJhci1saW5rLWl0ZW0gPiBhIHtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW4tY29udGVudCAxZnIgMWZyO1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMDAwO1xcclxcbiAgICBwYWRkaW5nOiA1cHg7XFxyXFxuICAgIGZvbnQtc2l6ZTogMTRweDtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgZ2FwOiA1cHg7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstaXRlbSA+IGE6aG92ZXIge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstbGlzdC1oZWFkZXIgPiBhIHtcXHJcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstaXRlbS1udW1iZXIge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGVkZWRlO1xcclxcbiAgICBwYWRkaW5nOiAycHggNnB4O1xcclxcbiAgICBib3JkZXItcmFkaXVzOiA0MCU7XFxyXFxuICAgIGp1c3RpZnktc2VsZjogZW5kO1xcclxcbiAgICBncmlkLWNvbHVtbjogMztcXHJcXG59XFxyXFxuXFxyXFxuLnNpZGViYXItbGluay1pdGVtIGkge1xcclxcbiAgICBoZWlnaHQ6IDE4cHg7XFxyXFxuICAgIHdpZHRoOiAxOHB4O1xcclxcbn1cXHJcXG5cXHJcXG4uc2lkZWJhci1saW5rLWl0ZW0gaSA+IHN2ZyB7XFxyXFxuICAgIGZpbGw6ICMzMzM7XFxyXFxufVwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanNcIjtcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIjtcbnZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fKTtcbi8vIE1vZHVsZVxuX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmlkLCBcIi50b2RvLWl0ZW1zLWxpc3Qge1xcclxcbiAgICBsaXN0LXN0eWxlOiBub25lO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0IGxpIHtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW4tY29udGVudCAxZnI7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtcm93czogMWZyIDFmcjtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgZ2FwOiAxMHB4O1xcclxcbiAgICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2NjYztcXHJcXG4gICAgcGFkZGluZzogMTBweDtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0IGxpLmNoZWNrZWQge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlO1xcclxcbiAgICBjb2xvcjogIzU1NTtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbXMtbGlzdCBsaS5jaGVja2VkIC5jaGVja2JveHtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2VlZTtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzc3NztcXHJcXG4gICAgZmlsbDogIzc3NztcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbXMtbGlzdCBsaTpsYXN0LWNoaWxkIHtcXHJcXG4gICAgYm9yZGVyLWJvdHRvbTogbm9uZTtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbXMtbGlzdCAuY2hlY2tib3gge1xcclxcbiAgICBncmlkLXJvdzogMSAvIHNwYW4gMjtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbXMtbGlzdC1pdGVtLWNvbnRlbnQge1xcclxcbiAgICBncmlkLXJvdzogMSAvIHNwYW4gMjtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiAxZnIgMWZyO1xcclxcbn1cXHJcXG5cXHJcXG5cXHJcXG5cIiwgXCJcIix7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCJ3ZWJwYWNrOi8vLi9zcmMvY29tcG9uZW50cy9Ub2RvSXRlbXNMaXN0LmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTtJQUNJLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLGFBQWE7SUFDYixzQ0FBc0M7SUFDdEMsMkJBQTJCO0lBQzNCLG1CQUFtQjtJQUNuQixTQUFTO0lBQ1QsNkJBQTZCO0lBQzdCLGFBQWE7SUFDYixlQUFlO0FBQ25COztBQUVBO0lBQ0ksc0JBQXNCO0lBQ3RCLFdBQVc7QUFDZjs7QUFFQTtJQUNJLHNCQUFzQjtJQUN0QixzQkFBc0I7SUFDdEIsVUFBVTtBQUNkOztBQUVBO0lBQ0ksbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksb0JBQW9CO0FBQ3hCOztBQUVBO0lBQ0ksb0JBQW9CO0lBQ3BCLGFBQWE7SUFDYiwyQkFBMkI7QUFDL0JcIixcInNvdXJjZXNDb250ZW50XCI6W1wiLnRvZG8taXRlbXMtbGlzdCB7XFxyXFxuICAgIGxpc3Qtc3R5bGU6IG5vbmU7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW1zLWxpc3QgbGkge1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IG1pbi1jb250ZW50IDFmcjtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiAxZnIgMWZyO1xcclxcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcclxcbiAgICBnYXA6IDEwcHg7XFxyXFxuICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjY2NjO1xcclxcbiAgICBwYWRkaW5nOiAxMHB4O1xcclxcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW1zLWxpc3QgbGkuY2hlY2tlZCB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNlZWU7XFxyXFxuICAgIGNvbG9yOiAjNTU1O1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0IGxpLmNoZWNrZWQgLmNoZWNrYm94e1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlO1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjNzc3O1xcclxcbiAgICBmaWxsOiAjNzc3O1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0IGxpOmxhc3QtY2hpbGQge1xcclxcbiAgICBib3JkZXItYm90dG9tOiBub25lO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0IC5jaGVja2JveCB7XFxyXFxuICAgIGdyaWQtcm93OiAxIC8gc3BhbiAyO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtcy1saXN0LWl0ZW0tY29udGVudCB7XFxyXFxuICAgIGdyaWQtcm93OiAxIC8gc3BhbiAyO1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLXJvd3M6IDFmciAxZnI7XFxyXFxufVxcclxcblxcclxcblxcclxcblwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanNcIjtcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIjtcbnZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fKTtcbi8vIE1vZHVsZVxuX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmlkLCBcImhlYWRlciB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0ZDODYyMTtcXHJcXG4gICAgZ3JpZC1yb3c6IDE7XFxyXFxuICAgIGdyaWQtY29sdW1uOiAxIC8gc3BhbiAyO1xcclxcbn1cXHJcXG5cXHJcXG4uYnV0dG9ucy1jb250YWluZXIge1xcclxcbiAgICBncmlkLWNvbHVtbjogMjtcXHJcXG4gICAgZ3JpZC1yb3c6IDE7XFxyXFxuICAgIGRpc3BsYXk6IGZsZXg7XFxyXFxuICAgIG1hcmdpbi1yaWdodDogNHJlbTtcXHJcXG4gICAgZ2FwOiAyNXB4O1xcclxcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcclxcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGVuZDtcXHJcXG59XFxyXFxuXFxyXFxuLmJ1dHRvbnMtY29udGFpbmVyIGJ1dHRvbiB7XFxyXFxuICAgIHBhZGRpbmc6IDEwcHggMzBweDtcXHJcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxyXFxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcXHJcXG4gICAgY29sb3I6ICMzMzM7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxyXFxufVxcclxcblxcclxcbi5hZGQtdG9kby1idXR0b24ge1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjMDA5OWZmO1xcclxcbn1cXHJcXG5cXHJcXG4uYnV0dG9ucy1jb250YWluZXIgYnV0dG9uOmhvdmVyIHtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlO1xcclxcbn1cXHJcXG5cXHJcXG4uYWRkLXByb2plY3QtYnV0dG9uIHtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzJlZWM1NztcXHJcXG59XFxyXFxuXFxyXFxubmF2IHtcXHJcXG4gICAganVzdGlmeS1zZWxmOiBzdGFydDtcXHJcXG4gICAgZ3JpZC1jb2x1bW46IDE7XFxyXFxuICAgIGdyaWQtcm93OiAxO1xcclxcbiAgICBtYXJnaW4tbGVmdDogMnJlbTtcXHJcXG59XFxyXFxuXFxyXFxubmF2IHVsIHtcXHJcXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcXHJcXG59XFxyXFxuXFxyXFxubmF2IHVsIGxpIGEge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMzMzO1xcclxcbn1cXHJcXG5cXHJcXG4ubG9nby1jb250YWluZXIge1xcclxcbiAgICBkaXNwbGF5OiBmbGV4O1xcclxcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcclxcbiAgICBnYXA6IDVweDtcXHJcXG4gICAgbWFyZ2luLWxlZnQ6IDIwcHg7XFxyXFxufVxcclxcblxcclxcbi5sb2dvLWNvbnRhaW5lcjpob3ZlciB7XFxyXFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXHJcXG59XFxyXFxuXFxyXFxuLmxvZ28tdGV4dCB7XFxyXFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcclxcbiAgICBmb250LXNpemU6IDE4cHg7XFxyXFxuICAgIGNvbG9yOiAjMjIyO1xcclxcbn1cXHJcXG5cXHJcXG4ubG9nby1pY29uIHtcXHJcXG4gICAgd2lkdGg6IDMycHg7XFxyXFxuICAgIGhlaWdodDogMzJweDtcXHJcXG4gICAgZmlsbDogIzIyMjtcXHJcXG59XCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL21vZHVsZXMvTGF5b3V0L2hlYWRlci5jc3NcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIkFBQUE7SUFDSSxhQUFhO0lBQ2IsOEJBQThCO0lBQzlCLG1CQUFtQjtJQUNuQix5QkFBeUI7SUFDekIsV0FBVztJQUNYLHVCQUF1QjtBQUMzQjs7QUFFQTtJQUNJLGNBQWM7SUFDZCxXQUFXO0lBQ1gsYUFBYTtJQUNiLGtCQUFrQjtJQUNsQixTQUFTO0lBQ1QsbUJBQW1CO0lBQ25CLG9CQUFvQjtBQUN4Qjs7QUFFQTtJQUNJLGtCQUFrQjtJQUNsQixpQkFBaUI7SUFDakIsa0JBQWtCO0lBQ2xCLFdBQVc7SUFDWCxzQkFBc0I7QUFDMUI7O0FBRUE7SUFDSSx5QkFBeUI7QUFDN0I7O0FBRUE7SUFDSSxlQUFlO0lBQ2Ysc0JBQXNCO0FBQzFCOztBQUVBO0lBQ0kseUJBQXlCO0FBQzdCOztBQUVBO0lBQ0ksbUJBQW1CO0lBQ25CLGNBQWM7SUFDZCxXQUFXO0lBQ1gsaUJBQWlCO0FBQ3JCOztBQUVBO0lBQ0ksZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0kscUJBQXFCO0lBQ3JCLFdBQVc7QUFDZjs7QUFFQTtJQUNJLGFBQWE7SUFDYixtQkFBbUI7SUFDbkIsUUFBUTtJQUNSLGlCQUFpQjtBQUNyQjs7QUFFQTtJQUNJLGVBQWU7QUFDbkI7O0FBRUE7SUFDSSxpQkFBaUI7SUFDakIsZUFBZTtJQUNmLFdBQVc7QUFDZjs7QUFFQTtJQUNJLFdBQVc7SUFDWCxZQUFZO0lBQ1osVUFBVTtBQUNkXCIsXCJzb3VyY2VzQ29udGVudFwiOltcImhlYWRlciB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogMWZyIDFmcjtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0ZDODYyMTtcXHJcXG4gICAgZ3JpZC1yb3c6IDE7XFxyXFxuICAgIGdyaWQtY29sdW1uOiAxIC8gc3BhbiAyO1xcclxcbn1cXHJcXG5cXHJcXG4uYnV0dG9ucy1jb250YWluZXIge1xcclxcbiAgICBncmlkLWNvbHVtbjogMjtcXHJcXG4gICAgZ3JpZC1yb3c6IDE7XFxyXFxuICAgIGRpc3BsYXk6IGZsZXg7XFxyXFxuICAgIG1hcmdpbi1yaWdodDogNHJlbTtcXHJcXG4gICAgZ2FwOiAyNXB4O1xcclxcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcclxcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGVuZDtcXHJcXG59XFxyXFxuXFxyXFxuLmJ1dHRvbnMtY29udGFpbmVyIGJ1dHRvbiB7XFxyXFxuICAgIHBhZGRpbmc6IDEwcHggMzBweDtcXHJcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxyXFxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcXHJcXG4gICAgY29sb3I6ICMzMzM7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7XFxyXFxufVxcclxcblxcclxcbi5hZGQtdG9kby1idXR0b24ge1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCAjMDA5OWZmO1xcclxcbn1cXHJcXG5cXHJcXG4uYnV0dG9ucy1jb250YWluZXIgYnV0dG9uOmhvdmVyIHtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZWVlO1xcclxcbn1cXHJcXG5cXHJcXG4uYWRkLXByb2plY3QtYnV0dG9uIHtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgIzJlZWM1NztcXHJcXG59XFxyXFxuXFxyXFxubmF2IHtcXHJcXG4gICAganVzdGlmeS1zZWxmOiBzdGFydDtcXHJcXG4gICAgZ3JpZC1jb2x1bW46IDE7XFxyXFxuICAgIGdyaWQtcm93OiAxO1xcclxcbiAgICBtYXJnaW4tbGVmdDogMnJlbTtcXHJcXG59XFxyXFxuXFxyXFxubmF2IHVsIHtcXHJcXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcXHJcXG59XFxyXFxuXFxyXFxubmF2IHVsIGxpIGEge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMzMzO1xcclxcbn1cXHJcXG5cXHJcXG4ubG9nby1jb250YWluZXIge1xcclxcbiAgICBkaXNwbGF5OiBmbGV4O1xcclxcbiAgICBhbGlnbi1pdGVtczogY2VudGVyO1xcclxcbiAgICBnYXA6IDVweDtcXHJcXG4gICAgbWFyZ2luLWxlZnQ6IDIwcHg7XFxyXFxufVxcclxcblxcclxcbi5sb2dvLWNvbnRhaW5lcjpob3ZlciB7XFxyXFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXHJcXG59XFxyXFxuXFxyXFxuLmxvZ28tdGV4dCB7XFxyXFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcclxcbiAgICBmb250LXNpemU6IDE4cHg7XFxyXFxuICAgIGNvbG9yOiAjMjIyO1xcclxcbn1cXHJcXG5cXHJcXG4ubG9nby1pY29uIHtcXHJcXG4gICAgd2lkdGg6IDMycHg7XFxyXFxuICAgIGhlaWdodDogMzJweDtcXHJcXG4gICAgZmlsbDogIzIyMjtcXHJcXG59XCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG4vLyBFeHBvcnRzXG5leHBvcnQgZGVmYXVsdCBfX19DU1NfTE9BREVSX0VYUE9SVF9fXztcbiIsIi8vIEltcG9ydHNcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fIGZyb20gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvc291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18pO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwiLnNpZGViYXIge1xcclxcbiAgICBncmlkLWNvbHVtbjogMTtcXHJcXG4gICAgZ3JpZC1yb3c6IDI7XFxyXFxuXFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNGQUY5RjY7XFxyXFxuICAgIHBhZGRpbmc6IDEwcHggMjBweCAxMHB4IDEwcHg7XFxyXFxuICAgIGRpc3BsYXk6IGZsZXg7XFxyXFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxyXFxuICAgIGdhcDogMzBweDtcXHJcXG59XFxyXFxuXFxyXFxuLnNpZGViYXItbGluay1saXN0IHtcXHJcXG4gICAgZGlzcGxheTogZmxleDtcXHJcXG4gICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcXHJcXG4gICAgbGlzdC1zdHlsZTogbm9uZTtcXHJcXG59XFxyXFxuXFxyXFxuXCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL21vZHVsZXMvTGF5b3V0L3NpZGViYXIuY3NzXCJdLFwibmFtZXNcIjpbXSxcIm1hcHBpbmdzXCI6XCJBQUFBO0lBQ0ksY0FBYztJQUNkLFdBQVc7O0lBRVgseUJBQXlCO0lBQ3pCLDRCQUE0QjtJQUM1QixhQUFhO0lBQ2Isc0JBQXNCO0lBQ3RCLFNBQVM7QUFDYjs7QUFFQTtJQUNJLGFBQWE7SUFDYixzQkFBc0I7SUFDdEIsZ0JBQWdCO0FBQ3BCXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi5zaWRlYmFyIHtcXHJcXG4gICAgZ3JpZC1jb2x1bW46IDE7XFxyXFxuICAgIGdyaWQtcm93OiAyO1xcclxcblxcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjRkFGOUY2O1xcclxcbiAgICBwYWRkaW5nOiAxMHB4IDIwcHggMTBweCAxMHB4O1xcclxcbiAgICBkaXNwbGF5OiBmbGV4O1xcclxcbiAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xcclxcbiAgICBnYXA6IDMwcHg7XFxyXFxufVxcclxcblxcclxcbi5zaWRlYmFyLWxpbmstbGlzdCB7XFxyXFxuICAgIGRpc3BsYXk6IGZsZXg7XFxyXFxuICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XFxyXFxuICAgIGxpc3Qtc3R5bGU6IG5vbmU7XFxyXFxufVxcclxcblxcclxcblwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanNcIjtcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIjtcbnZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fKTtcbi8vIE1vZHVsZVxuX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmlkLCBcIlxcclxcbi50b2RvLWl0ZW1zLWNvbnRhaW5lciB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdhcDogMjVweDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW5tYXgoMzAwcHgsIG1pbi1jb250ZW50KTtcXHJcXG59XFxyXFxuXFxyXFxuXFxyXFxuXFxyXFxuLnRvZG8taXRlbSB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtcm93czogMWZyIDFmcjtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiBtaW5tYXgoMjAwcHgsIDMwMHB4KSBtaW5tYXgoMjAwcHgsIDMwMHB4KTtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgI2NjYztcXHJcXG4gICAgYm9yZGVyLWxlZnQ6IDhweCBzb2xpZCByZ2IoNjgsIDEyNywgMjU1KTtcXHJcXG5cXHJcXG4gICAgYm9yZGVyLXJhZGl1czogNHB4O1xcclxcbiAgICBwYWRkaW5nOiA1cHggMTBweDtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI0ZBRjlGNjtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbTpob3ZlciB7XFxyXFxuICAgIGJveC1zaGFkb3c6IDAgMnB4IDVweCAwIHJnYmEoMCwgMCwgMCwgMC4xNik7XFxyXFxuICAgIGN1cnNvcjogcG9pbnRlcjtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbSBoMyB7XFxyXFxuICAgIG1hcmdpbjogMDtcXHJcXG4gICAgcGFkZGluZzogMDtcXHJcXG4gICAgYWxpZ24tc2VsZjogZW5kO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtIGgzIGEge1xcclxcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XFxyXFxuICAgIGNvbG9yOiAjMDAwO1xcclxcbn1cXHJcXG5cXHJcXG4uY2hlY2tCb3hDb250YWluZXIge1xcclxcbiAgICBqdXN0aWZ5LXNlbGY6IGVuZDtcXHJcXG4gICAgZ3JpZC1yb3c6IDEgLyBzcGFuIDI7XFxyXFxuICAgIGdyaWQtY29sdW1uOiAyO1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLXJvd3M6IDFmciAxZnI7XFxyXFxuICAgIGp1c3RpZnktaXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcXHJcXG4gICAgcGFkZGluZzogMHB4IDEwcHg7XFxyXFxufVxcclxcblxcclxcbi5jaGVja0JveENvbnRhaW5lciBzcGFuIHtcXHJcXG4gICAgZm9udC1zaXplOiAxMnB4O1xcclxcbn1cXHJcXG5cXHJcXG4ucHJpb3JpdHktaGlnaCB7XFxyXFxuICAgIGJvcmRlci1sZWZ0OiA4cHggc29saWQgcmdiKDI1NSwgODcsIDU4KTtcXHJcXG59XFxyXFxuXFxyXFxuLnByaW9yaXR5LW1lZGl1bSB7XFxyXFxuICAgIGJvcmRlci1sZWZ0OiA4cHggc29saWQgcmdiKDI1NSwgMjAyLCA1OCk7XFxyXFxufVxcclxcblxcclxcbi5wcmlvcml0eS1sb3cge1xcclxcbiAgICBib3JkZXI6IDFweCBzb2xpZCByZ2IoMTQwLCAyNTMsIDg4KTtcXHJcXG4gICAgYm9yZGVyLWxlZnQ6IDhweCBzb2xpZCByZ2IoMTQwLCAyNTMsIDg4KTtcXHJcXG59XFxyXFxuXFxyXFxuLmNoZWNrYm94OmhvdmVyIHtcXHJcXG4gICAgY3Vyc29yOmRlZmF1bHQ7XFxyXFxufVxcclxcblxcclxcbi5kZWxldGUtcHJvamVjdC1idXR0b24ge1xcclxcbiAgICBib3JkZXI6IDA7XFxyXFxuICAgIHBhZGRpbmc6IDhweCAzMHB4O1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjU1LCA2NiwgNjYpO1xcclxcbiAgICBjb2xvcjogd2hpdGU7XFxyXFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcclxcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxyXFxuICAgIGp1c3RpZnktc2VsZjogc3RhcnQ7XFxyXFxufVxcclxcblxcclxcbi5kZWxldGUtcHJvamVjdC1idXR0b246ZGlzYWJsZWQge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjYmJiO1xcclxcbiAgICBjdXJzb3I6IG5vdC1hbGxvd2VkO1xcclxcbn1cIiwgXCJcIix7XCJ2ZXJzaW9uXCI6MyxcInNvdXJjZXNcIjpbXCJ3ZWJwYWNrOi8vLi9zcmMvbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3REZXRhaWwuY3NzXCJdLFwibmFtZXNcIjpbXSxcIm1hcHBpbmdzXCI6XCI7QUFDQTtJQUNJLGFBQWE7SUFDYixTQUFTO0lBQ1QsaURBQWlEO0FBQ3JEOzs7O0FBSUE7SUFDSSxhQUFhO0lBQ2IsMkJBQTJCO0lBQzNCLGdFQUFnRTtJQUNoRSxtQkFBbUI7SUFDbkIsc0JBQXNCO0lBQ3RCLHdDQUF3Qzs7SUFFeEMsa0JBQWtCO0lBQ2xCLGlCQUFpQjtJQUNqQix5QkFBeUI7QUFDN0I7O0FBRUE7SUFDSSwyQ0FBMkM7SUFDM0MsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLFNBQVM7SUFDVCxVQUFVO0lBQ1YsZUFBZTtBQUNuQjs7QUFFQTtJQUNJLHFCQUFxQjtJQUNyQixXQUFXO0FBQ2Y7O0FBRUE7SUFDSSxpQkFBaUI7SUFDakIsb0JBQW9CO0lBQ3BCLGNBQWM7SUFDZCxhQUFhO0lBQ2IsMkJBQTJCO0lBQzNCLHFCQUFxQjtJQUNyQixtQkFBbUI7SUFDbkIsaUJBQWlCO0FBQ3JCOztBQUVBO0lBQ0ksZUFBZTtBQUNuQjs7QUFFQTtJQUNJLHVDQUF1QztBQUMzQzs7QUFFQTtJQUNJLHdDQUF3QztBQUM1Qzs7QUFFQTtJQUNJLG1DQUFtQztJQUNuQyx3Q0FBd0M7QUFDNUM7O0FBRUE7SUFDSSxjQUFjO0FBQ2xCOztBQUVBO0lBQ0ksU0FBUztJQUNULGlCQUFpQjtJQUNqQixrQ0FBa0M7SUFDbEMsWUFBWTtJQUNaLGlCQUFpQjtJQUNqQixlQUFlO0lBQ2YsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksc0JBQXNCO0lBQ3RCLG1CQUFtQjtBQUN2QlwiLFwic291cmNlc0NvbnRlbnRcIjpbXCJcXHJcXG4udG9kby1pdGVtcy1jb250YWluZXIge1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBnYXA6IDI1cHg7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWlubWF4KDMwMHB4LCBtaW4tY29udGVudCk7XFxyXFxufVxcclxcblxcclxcblxcclxcblxcclxcbi50b2RvLWl0ZW0ge1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLXJvd3M6IDFmciAxZnI7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWlubWF4KDIwMHB4LCAzMDBweCkgbWlubWF4KDIwMHB4LCAzMDBweCk7XFxyXFxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxyXFxuICAgIGJvcmRlcjogMXB4IHNvbGlkICNjY2M7XFxyXFxuICAgIGJvcmRlci1sZWZ0OiA4cHggc29saWQgcmdiKDY4LCAxMjcsIDI1NSk7XFxyXFxuXFxyXFxuICAgIGJvcmRlci1yYWRpdXM6IDRweDtcXHJcXG4gICAgcGFkZGluZzogNXB4IDEwcHg7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNGQUY5RjY7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW06aG92ZXIge1xcclxcbiAgICBib3gtc2hhZG93OiAwIDJweCA1cHggMCByZ2JhKDAsIDAsIDAsIDAuMTYpO1xcclxcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW0gaDMge1xcclxcbiAgICBtYXJnaW46IDA7XFxyXFxuICAgIHBhZGRpbmc6IDA7XFxyXFxuICAgIGFsaWduLXNlbGY6IGVuZDtcXHJcXG59XFxyXFxuXFxyXFxuLnRvZG8taXRlbSBoMyBhIHtcXHJcXG4gICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xcclxcbiAgICBjb2xvcjogIzAwMDtcXHJcXG59XFxyXFxuXFxyXFxuLmNoZWNrQm94Q29udGFpbmVyIHtcXHJcXG4gICAganVzdGlmeS1zZWxmOiBlbmQ7XFxyXFxuICAgIGdyaWQtcm93OiAxIC8gc3BhbiAyO1xcclxcbiAgICBncmlkLWNvbHVtbjogMjtcXHJcXG4gICAgZGlzcGxheTogZ3JpZDtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiAxZnIgMWZyO1xcclxcbiAgICBqdXN0aWZ5LWl0ZW1zOiBjZW50ZXI7XFxyXFxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XFxyXFxuICAgIHBhZGRpbmc6IDBweCAxMHB4O1xcclxcbn1cXHJcXG5cXHJcXG4uY2hlY2tCb3hDb250YWluZXIgc3BhbiB7XFxyXFxuICAgIGZvbnQtc2l6ZTogMTJweDtcXHJcXG59XFxyXFxuXFxyXFxuLnByaW9yaXR5LWhpZ2gge1xcclxcbiAgICBib3JkZXItbGVmdDogOHB4IHNvbGlkIHJnYigyNTUsIDg3LCA1OCk7XFxyXFxufVxcclxcblxcclxcbi5wcmlvcml0eS1tZWRpdW0ge1xcclxcbiAgICBib3JkZXItbGVmdDogOHB4IHNvbGlkIHJnYigyNTUsIDIwMiwgNTgpO1xcclxcbn1cXHJcXG5cXHJcXG4ucHJpb3JpdHktbG93IHtcXHJcXG4gICAgYm9yZGVyOiAxcHggc29saWQgcmdiKDE0MCwgMjUzLCA4OCk7XFxyXFxuICAgIGJvcmRlci1sZWZ0OiA4cHggc29saWQgcmdiKDE0MCwgMjUzLCA4OCk7XFxyXFxufVxcclxcblxcclxcbi5jaGVja2JveDpob3ZlciB7XFxyXFxuICAgIGN1cnNvcjpkZWZhdWx0O1xcclxcbn1cXHJcXG5cXHJcXG4uZGVsZXRlLXByb2plY3QtYnV0dG9uIHtcXHJcXG4gICAgYm9yZGVyOiAwO1xcclxcbiAgICBwYWRkaW5nOiA4cHggMzBweDtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDI1NSwgNjYsIDY2KTtcXHJcXG4gICAgY29sb3I6IHdoaXRlO1xcclxcbiAgICBmb250LXdlaWdodDogYm9sZDtcXHJcXG4gICAgY3Vyc29yOiBwb2ludGVyO1xcclxcbiAgICBqdXN0aWZ5LXNlbGY6IHN0YXJ0O1xcclxcbn1cXHJcXG5cXHJcXG4uZGVsZXRlLXByb2plY3QtYnV0dG9uOmRpc2FibGVkIHtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogI2JiYjtcXHJcXG4gICAgY3Vyc29yOiBub3QtYWxsb3dlZDtcXHJcXG59XCJdLFwic291cmNlUm9vdFwiOlwiXCJ9XSk7XG4vLyBFeHBvcnRzXG5leHBvcnQgZGVmYXVsdCBfX19DU1NfTE9BREVSX0VYUE9SVF9fXztcbiIsIi8vIEltcG9ydHNcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fIGZyb20gXCIuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L3J1bnRpbWUvc291cmNlTWFwcy5qc1wiO1xuaW1wb3J0IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL2FwaS5qc1wiO1xudmFyIF9fX0NTU19MT0FERVJfRVhQT1JUX19fID0gX19fQ1NTX0xPQURFUl9BUElfSU1QT1JUX19fKF9fX0NTU19MT0FERVJfQVBJX1NPVVJDRU1BUF9JTVBPUlRfX18pO1xuLy8gTW9kdWxlXG5fX19DU1NfTE9BREVSX0VYUE9SVF9fXy5wdXNoKFttb2R1bGUuaWQsIFwiZm9ybSB7XFxyXFxuICAgIGRpc3BsYXk6IGdyaWQ7XFxyXFxuICAgIGdyaWQtdGVtcGxhdGUtY29sdW1uczogbWlubWF4KDMwJSwgNDAwcHgpO1xcclxcbiAgICBqdXN0aWZ5LWl0ZW1zOiBzdGFydDtcXHJcXG4gICAgZ2FwOiAxMHB4O1xcclxcbiAgICBwYWRkaW5nOiAyMHB4O1xcclxcbn1cXHJcXG5cXHJcXG5mb3JtIGlucHV0W3R5cGU9XFxcInRleHRcXFwiXSwgdGV4dGFyZWEge1xcclxcbiAgICBqdXN0aWZ5LXNlbGY6IHN0cmV0Y2g7XFxyXFxufVxcclxcblxcclxcbmZvcm0gYnV0dG9uIHtcXHJcXG4gICAgYm9yZGVyOiAwO1xcclxcbiAgICBwYWRkaW5nOiA4cHggMzBweDtcXHJcXG4gICAgYmFja2dyb3VuZC1jb2xvcjogcmdiKDAsIDE0MCwgMjU1KTtcXHJcXG4gICAgY29sb3I6IHdoaXRlO1xcclxcbiAgICBmb250LXdlaWdodDogYm9sZDtcXHJcXG59XCIsIFwiXCIse1widmVyc2lvblwiOjMsXCJzb3VyY2VzXCI6W1wid2VicGFjazovLy4vc3JjL21vZHVsZXMvVG9kb0l0ZW0vQWRkVG9kb0l0ZW0uY3NzXCJdLFwibmFtZXNcIjpbXSxcIm1hcHBpbmdzXCI6XCJBQUFBO0lBQ0ksYUFBYTtJQUNiLHlDQUF5QztJQUN6QyxvQkFBb0I7SUFDcEIsU0FBUztJQUNULGFBQWE7QUFDakI7O0FBRUE7SUFDSSxxQkFBcUI7QUFDekI7O0FBRUE7SUFDSSxTQUFTO0lBQ1QsaUJBQWlCO0lBQ2pCLGtDQUFrQztJQUNsQyxZQUFZO0lBQ1osaUJBQWlCO0FBQ3JCXCIsXCJzb3VyY2VzQ29udGVudFwiOltcImZvcm0ge1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IG1pbm1heCgzMCUsIDQwMHB4KTtcXHJcXG4gICAganVzdGlmeS1pdGVtczogc3RhcnQ7XFxyXFxuICAgIGdhcDogMTBweDtcXHJcXG4gICAgcGFkZGluZzogMjBweDtcXHJcXG59XFxyXFxuXFxyXFxuZm9ybSBpbnB1dFt0eXBlPVxcXCJ0ZXh0XFxcIl0sIHRleHRhcmVhIHtcXHJcXG4gICAganVzdGlmeS1zZWxmOiBzdHJldGNoO1xcclxcbn1cXHJcXG5cXHJcXG5mb3JtIGJ1dHRvbiB7XFxyXFxuICAgIGJvcmRlcjogMDtcXHJcXG4gICAgcGFkZGluZzogOHB4IDMwcHg7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigwLCAxNDAsIDI1NSk7XFxyXFxuICAgIGNvbG9yOiB3aGl0ZTtcXHJcXG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XFxyXFxufVwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanNcIjtcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIjtcbnZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fKTtcbi8vIE1vZHVsZVxuX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmlkLCBcIi50b2RvSXRlbUNvbnRlbnQge1xcclxcbiAgICB3aWR0aDogMzAlO1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDJmciAzZnI7XFxyXFxuICAgIGp1c3RpZnktaXRlbXM6IHN0YXJ0O1xcclxcbiAgICBnYXA6IDEwcHg7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW0tY29udGFpbmVyIGgyIHtcXHJcXG4gICAgbWFyZ2luOiAwO1xcclxcbiAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtLWNvbnRhaW5lciB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNGQUY5RjY7XFxyXFxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcXHJcXG4gICAgcGFkZGluZzogMXJlbTtcXHJcXG4gICAgYm94LXNoYWRvdzogMnB4IDJweCA1cHggcmdiYSgwLDAsMCwwLjE3KTtcXHJcXG59XFxyXFxuXFxyXFxuLnByb2plY3Qgc3BhbiB7XFxyXFxuICAgIGdyaWQtY29sdW1uOiAxO1xcclxcblxcclxcbn1cXHJcXG5cXHJcXG4ucHJvamVjdCBzZWxlY3Qge1xcclxcbiAgICBncmlkLWNvbHVtbjogMjtcXHJcXG59XFxyXFxuXFxyXFxuLmRlbGV0ZS10b2RvaXRlbS1idXR0b24ge1xcclxcbiAgICBib3JkZXI6IDA7XFxyXFxuICAgIHBhZGRpbmc6IDhweCAzMHB4O1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjU1LCA2NiwgNjYpO1xcclxcbiAgICBjb2xvcjogd2hpdGU7XFxyXFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcclxcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxyXFxufVxcclxcblxcclxcbi5kZWxldGUtdG9kb2l0ZW0tYnV0dG9uIGJ1dHRvbjpob3ZlciB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDg3LCA4Nyk7XFxyXFxufVwiLCBcIlwiLHtcInZlcnNpb25cIjozLFwic291cmNlc1wiOltcIndlYnBhY2s6Ly8uL3NyYy9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtRGV0YWlsLmNzc1wiXSxcIm5hbWVzXCI6W10sXCJtYXBwaW5nc1wiOlwiQUFBQTtJQUNJLFVBQVU7SUFDVixhQUFhO0lBQ2IsOEJBQThCO0lBQzlCLG9CQUFvQjtJQUNwQixTQUFTO0FBQ2I7O0FBRUE7SUFDSSxTQUFTO0lBQ1QsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0kseUJBQXlCO0lBQ3pCLGtCQUFrQjtJQUNsQixhQUFhO0lBQ2Isd0NBQXdDO0FBQzVDOztBQUVBO0lBQ0ksY0FBYzs7QUFFbEI7O0FBRUE7SUFDSSxjQUFjO0FBQ2xCOztBQUVBO0lBQ0ksU0FBUztJQUNULGlCQUFpQjtJQUNqQixrQ0FBa0M7SUFDbEMsWUFBWTtJQUNaLGlCQUFpQjtJQUNqQixlQUFlO0FBQ25COztBQUVBO0lBQ0ksa0NBQWtDO0FBQ3RDXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIi50b2RvSXRlbUNvbnRlbnQge1xcclxcbiAgICB3aWR0aDogMzAlO1xcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDJmciAzZnI7XFxyXFxuICAgIGp1c3RpZnktaXRlbXM6IHN0YXJ0O1xcclxcbiAgICBnYXA6IDEwcHg7XFxyXFxufVxcclxcblxcclxcbi50b2RvLWl0ZW0tY29udGFpbmVyIGgyIHtcXHJcXG4gICAgbWFyZ2luOiAwO1xcclxcbiAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xcclxcbn1cXHJcXG5cXHJcXG4udG9kby1pdGVtLWNvbnRhaW5lciB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6ICNGQUY5RjY7XFxyXFxuICAgIGJvcmRlci1yYWRpdXM6IDhweDtcXHJcXG4gICAgcGFkZGluZzogMXJlbTtcXHJcXG4gICAgYm94LXNoYWRvdzogMnB4IDJweCA1cHggcmdiYSgwLDAsMCwwLjE3KTtcXHJcXG59XFxyXFxuXFxyXFxuLnByb2plY3Qgc3BhbiB7XFxyXFxuICAgIGdyaWQtY29sdW1uOiAxO1xcclxcblxcclxcbn1cXHJcXG5cXHJcXG4ucHJvamVjdCBzZWxlY3Qge1xcclxcbiAgICBncmlkLWNvbHVtbjogMjtcXHJcXG59XFxyXFxuXFxyXFxuLmRlbGV0ZS10b2RvaXRlbS1idXR0b24ge1xcclxcbiAgICBib3JkZXI6IDA7XFxyXFxuICAgIHBhZGRpbmc6IDhweCAzMHB4O1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2IoMjU1LCA2NiwgNjYpO1xcclxcbiAgICBjb2xvcjogd2hpdGU7XFxyXFxuICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xcclxcbiAgICBjdXJzb3I6IHBvaW50ZXI7XFxyXFxufVxcclxcblxcclxcbi5kZWxldGUtdG9kb2l0ZW0tYnV0dG9uIGJ1dHRvbjpob3ZlciB7XFxyXFxuICAgIGJhY2tncm91bmQtY29sb3I6IHJnYigyNTUsIDg3LCA4Nyk7XFxyXFxufVwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCIvLyBJbXBvcnRzXG5pbXBvcnQgX19fQ1NTX0xPQURFUl9BUElfU09VUkNFTUFQX0lNUE9SVF9fXyBmcm9tIFwiLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9ydW50aW1lL3NvdXJjZU1hcHMuanNcIjtcbmltcG9ydCBfX19DU1NfTE9BREVSX0FQSV9JTVBPUlRfX18gZnJvbSBcIi4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvcnVudGltZS9hcGkuanNcIjtcbnZhciBfX19DU1NfTE9BREVSX0VYUE9SVF9fXyA9IF9fX0NTU19MT0FERVJfQVBJX0lNUE9SVF9fXyhfX19DU1NfTE9BREVSX0FQSV9TT1VSQ0VNQVBfSU1QT1JUX19fKTtcbi8vIE1vZHVsZVxuX19fQ1NTX0xPQURFUl9FWFBPUlRfX18ucHVzaChbbW9kdWxlLmlkLCBcIioge1xcclxcbiAgICBmb250LWZhbWlseTogJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWY7XFxyXFxufVxcclxcblxcclxcbmJvZHkge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xcclxcbiAgICBtYXJnaW46IDA7XFxyXFxuICAgIHBhZGRpbmc6IDA7XFxyXFxuICAgIHdpZHRoOiAxMDAlO1xcclxcbiAgICBoZWlnaHQ6IDEwMHZoO1xcclxcblxcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDMwMHB4IDFmcjtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiA2MHB4IDFmcjtcXHJcXG59XFxyXFxuXFxyXFxuLm1haW4tY29udGVudCB7XFxyXFxuICAgIHBhZGRpbmc6IDIwcHggNDBweDtcXHJcXG4gICAgZ3JpZC1jb2x1bW46IDI7XFxyXFxufVwiLCBcIlwiLHtcInZlcnNpb25cIjozLFwic291cmNlc1wiOltcIndlYnBhY2s6Ly8uL3NyYy9zdHlsZS5jc3NcIl0sXCJuYW1lc1wiOltdLFwibWFwcGluZ3NcIjpcIkFBQUE7SUFDSSw2Q0FBNkM7QUFDakQ7O0FBRUE7SUFDSSxzQkFBc0I7SUFDdEIsU0FBUztJQUNULFVBQVU7SUFDVixXQUFXO0lBQ1gsYUFBYTs7SUFFYixhQUFhO0lBQ2IsZ0NBQWdDO0lBQ2hDLDRCQUE0QjtBQUNoQzs7QUFFQTtJQUNJLGtCQUFrQjtJQUNsQixjQUFjO0FBQ2xCXCIsXCJzb3VyY2VzQ29udGVudFwiOltcIioge1xcclxcbiAgICBmb250LWZhbWlseTogJ0hlbHZldGljYScsICdBcmlhbCcsIHNhbnMtc2VyaWY7XFxyXFxufVxcclxcblxcclxcbmJvZHkge1xcclxcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmO1xcclxcbiAgICBtYXJnaW46IDA7XFxyXFxuICAgIHBhZGRpbmc6IDA7XFxyXFxuICAgIHdpZHRoOiAxMDAlO1xcclxcbiAgICBoZWlnaHQ6IDEwMHZoO1xcclxcblxcclxcbiAgICBkaXNwbGF5OiBncmlkO1xcclxcbiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDMwMHB4IDFmcjtcXHJcXG4gICAgZ3JpZC10ZW1wbGF0ZS1yb3dzOiA2MHB4IDFmcjtcXHJcXG59XFxyXFxuXFxyXFxuLm1haW4tY29udGVudCB7XFxyXFxuICAgIHBhZGRpbmc6IDIwcHggNDBweDtcXHJcXG4gICAgZ3JpZC1jb2x1bW46IDI7XFxyXFxufVwiXSxcInNvdXJjZVJvb3RcIjpcIlwifV0pO1xuLy8gRXhwb3J0c1xuZXhwb3J0IGRlZmF1bHQgX19fQ1NTX0xPQURFUl9FWFBPUlRfX187XG4iLCJcInVzZSBzdHJpY3RcIjtcblxuLypcbiAgTUlUIExpY2Vuc2UgaHR0cDovL3d3dy5vcGVuc291cmNlLm9yZy9saWNlbnNlcy9taXQtbGljZW5zZS5waHBcbiAgQXV0aG9yIFRvYmlhcyBLb3BwZXJzIEBzb2tyYVxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNzc1dpdGhNYXBwaW5nVG9TdHJpbmcpIHtcbiAgdmFyIGxpc3QgPSBbXTtcblxuICAvLyByZXR1cm4gdGhlIGxpc3Qgb2YgbW9kdWxlcyBhcyBjc3Mgc3RyaW5nXG4gIGxpc3QudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHZhciBjb250ZW50ID0gXCJcIjtcbiAgICAgIHZhciBuZWVkTGF5ZXIgPSB0eXBlb2YgaXRlbVs1XSAhPT0gXCJ1bmRlZmluZWRcIjtcbiAgICAgIGlmIChpdGVtWzRdKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJAc3VwcG9ydHMgKFwiLmNvbmNhdChpdGVtWzRdLCBcIikge1wiKTtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJAbWVkaWEgXCIuY29uY2F0KGl0ZW1bMl0sIFwiIHtcIik7XG4gICAgICB9XG4gICAgICBpZiAobmVlZExheWVyKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJAbGF5ZXJcIi5jb25jYXQoaXRlbVs1XS5sZW5ndGggPiAwID8gXCIgXCIuY29uY2F0KGl0ZW1bNV0pIDogXCJcIiwgXCIge1wiKTtcbiAgICAgIH1cbiAgICAgIGNvbnRlbnQgKz0gY3NzV2l0aE1hcHBpbmdUb1N0cmluZyhpdGVtKTtcbiAgICAgIGlmIChuZWVkTGF5ZXIpIHtcbiAgICAgICAgY29udGVudCArPSBcIn1cIjtcbiAgICAgIH1cbiAgICAgIGlmIChpdGVtWzJdKSB7XG4gICAgICAgIGNvbnRlbnQgKz0gXCJ9XCI7XG4gICAgICB9XG4gICAgICBpZiAoaXRlbVs0XSkge1xuICAgICAgICBjb250ZW50ICs9IFwifVwiO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfSkuam9pbihcIlwiKTtcbiAgfTtcblxuICAvLyBpbXBvcnQgYSBsaXN0IG9mIG1vZHVsZXMgaW50byB0aGUgbGlzdFxuICBsaXN0LmkgPSBmdW5jdGlvbiBpKG1vZHVsZXMsIG1lZGlhLCBkZWR1cGUsIHN1cHBvcnRzLCBsYXllcikge1xuICAgIGlmICh0eXBlb2YgbW9kdWxlcyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgbW9kdWxlcyA9IFtbbnVsbCwgbW9kdWxlcywgdW5kZWZpbmVkXV07XG4gICAgfVxuICAgIHZhciBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzID0ge307XG4gICAgaWYgKGRlZHVwZSkge1xuICAgICAgZm9yICh2YXIgayA9IDA7IGsgPCB0aGlzLmxlbmd0aDsgaysrKSB7XG4gICAgICAgIHZhciBpZCA9IHRoaXNba11bMF07XG4gICAgICAgIGlmIChpZCAhPSBudWxsKSB7XG4gICAgICAgICAgYWxyZWFkeUltcG9ydGVkTW9kdWxlc1tpZF0gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGZvciAodmFyIF9rID0gMDsgX2sgPCBtb2R1bGVzLmxlbmd0aDsgX2srKykge1xuICAgICAgdmFyIGl0ZW0gPSBbXS5jb25jYXQobW9kdWxlc1tfa10pO1xuICAgICAgaWYgKGRlZHVwZSAmJiBhbHJlYWR5SW1wb3J0ZWRNb2R1bGVzW2l0ZW1bMF1dKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKHR5cGVvZiBsYXllciAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICBpZiAodHlwZW9mIGl0ZW1bNV0gPT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICBpdGVtWzVdID0gbGF5ZXI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbVsxXSA9IFwiQGxheWVyXCIuY29uY2F0KGl0ZW1bNV0ubGVuZ3RoID4gMCA/IFwiIFwiLmNvbmNhdChpdGVtWzVdKSA6IFwiXCIsIFwiIHtcIikuY29uY2F0KGl0ZW1bMV0sIFwifVwiKTtcbiAgICAgICAgICBpdGVtWzVdID0gbGF5ZXI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChtZWRpYSkge1xuICAgICAgICBpZiAoIWl0ZW1bMl0pIHtcbiAgICAgICAgICBpdGVtWzJdID0gbWVkaWE7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaXRlbVsxXSA9IFwiQG1lZGlhIFwiLmNvbmNhdChpdGVtWzJdLCBcIiB7XCIpLmNvbmNhdChpdGVtWzFdLCBcIn1cIik7XG4gICAgICAgICAgaXRlbVsyXSA9IG1lZGlhO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAoc3VwcG9ydHMpIHtcbiAgICAgICAgaWYgKCFpdGVtWzRdKSB7XG4gICAgICAgICAgaXRlbVs0XSA9IFwiXCIuY29uY2F0KHN1cHBvcnRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpdGVtWzFdID0gXCJAc3VwcG9ydHMgKFwiLmNvbmNhdChpdGVtWzRdLCBcIikge1wiKS5jb25jYXQoaXRlbVsxXSwgXCJ9XCIpO1xuICAgICAgICAgIGl0ZW1bNF0gPSBzdXBwb3J0cztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGlzdC5wdXNoKGl0ZW0pO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIGxpc3Q7XG59OyIsIlwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChpdGVtKSB7XG4gIHZhciBjb250ZW50ID0gaXRlbVsxXTtcbiAgdmFyIGNzc01hcHBpbmcgPSBpdGVtWzNdO1xuICBpZiAoIWNzc01hcHBpbmcpIHtcbiAgICByZXR1cm4gY29udGVudDtcbiAgfVxuICBpZiAodHlwZW9mIGJ0b2EgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIHZhciBiYXNlNjQgPSBidG9hKHVuZXNjYXBlKGVuY29kZVVSSUNvbXBvbmVudChKU09OLnN0cmluZ2lmeShjc3NNYXBwaW5nKSkpKTtcbiAgICB2YXIgZGF0YSA9IFwic291cmNlTWFwcGluZ1VSTD1kYXRhOmFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtODtiYXNlNjQsXCIuY29uY2F0KGJhc2U2NCk7XG4gICAgdmFyIHNvdXJjZU1hcHBpbmcgPSBcIi8qIyBcIi5jb25jYXQoZGF0YSwgXCIgKi9cIik7XG4gICAgcmV0dXJuIFtjb250ZW50XS5jb25jYXQoW3NvdXJjZU1hcHBpbmddKS5qb2luKFwiXFxuXCIpO1xuICB9XG4gIHJldHVybiBbY29udGVudF0uam9pbihcIlxcblwiKTtcbn07IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBzdHlsZXNJbkRPTSA9IFtdO1xuXG5mdW5jdGlvbiBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKSB7XG4gIHZhciByZXN1bHQgPSAtMTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlc0luRE9NLmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHN0eWxlc0luRE9NW2ldLmlkZW50aWZpZXIgPT09IGlkZW50aWZpZXIpIHtcbiAgICAgIHJlc3VsdCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICByZXR1cm4gcmVzdWx0O1xufVxuXG5mdW5jdGlvbiBtb2R1bGVzVG9Eb20obGlzdCwgb3B0aW9ucykge1xuICB2YXIgaWRDb3VudE1hcCA9IHt9O1xuICB2YXIgaWRlbnRpZmllcnMgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgaXRlbSA9IGxpc3RbaV07XG4gICAgdmFyIGlkID0gb3B0aW9ucy5iYXNlID8gaXRlbVswXSArIG9wdGlvbnMuYmFzZSA6IGl0ZW1bMF07XG4gICAgdmFyIGNvdW50ID0gaWRDb3VudE1hcFtpZF0gfHwgMDtcbiAgICB2YXIgaWRlbnRpZmllciA9IFwiXCIuY29uY2F0KGlkLCBcIiBcIikuY29uY2F0KGNvdW50KTtcbiAgICBpZENvdW50TWFwW2lkXSA9IGNvdW50ICsgMTtcbiAgICB2YXIgaW5kZXhCeUlkZW50aWZpZXIgPSBnZXRJbmRleEJ5SWRlbnRpZmllcihpZGVudGlmaWVyKTtcbiAgICB2YXIgb2JqID0ge1xuICAgICAgY3NzOiBpdGVtWzFdLFxuICAgICAgbWVkaWE6IGl0ZW1bMl0sXG4gICAgICBzb3VyY2VNYXA6IGl0ZW1bM10sXG4gICAgICBzdXBwb3J0czogaXRlbVs0XSxcbiAgICAgIGxheWVyOiBpdGVtWzVdXG4gICAgfTtcblxuICAgIGlmIChpbmRleEJ5SWRlbnRpZmllciAhPT0gLTEpIHtcbiAgICAgIHN0eWxlc0luRE9NW2luZGV4QnlJZGVudGlmaWVyXS5yZWZlcmVuY2VzKys7XG4gICAgICBzdHlsZXNJbkRPTVtpbmRleEJ5SWRlbnRpZmllcl0udXBkYXRlcihvYmopO1xuICAgIH0gZWxzZSB7XG4gICAgICB2YXIgdXBkYXRlciA9IGFkZEVsZW1lbnRTdHlsZShvYmosIG9wdGlvbnMpO1xuICAgICAgb3B0aW9ucy5ieUluZGV4ID0gaTtcbiAgICAgIHN0eWxlc0luRE9NLnNwbGljZShpLCAwLCB7XG4gICAgICAgIGlkZW50aWZpZXI6IGlkZW50aWZpZXIsXG4gICAgICAgIHVwZGF0ZXI6IHVwZGF0ZXIsXG4gICAgICAgIHJlZmVyZW5jZXM6IDFcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlkZW50aWZpZXJzLnB1c2goaWRlbnRpZmllcik7XG4gIH1cblxuICByZXR1cm4gaWRlbnRpZmllcnM7XG59XG5cbmZ1bmN0aW9uIGFkZEVsZW1lbnRTdHlsZShvYmosIG9wdGlvbnMpIHtcbiAgdmFyIGFwaSA9IG9wdGlvbnMuZG9tQVBJKG9wdGlvbnMpO1xuICBhcGkudXBkYXRlKG9iaik7XG5cbiAgdmFyIHVwZGF0ZXIgPSBmdW5jdGlvbiB1cGRhdGVyKG5ld09iaikge1xuICAgIGlmIChuZXdPYmopIHtcbiAgICAgIGlmIChuZXdPYmouY3NzID09PSBvYmouY3NzICYmIG5ld09iai5tZWRpYSA9PT0gb2JqLm1lZGlhICYmIG5ld09iai5zb3VyY2VNYXAgPT09IG9iai5zb3VyY2VNYXAgJiYgbmV3T2JqLnN1cHBvcnRzID09PSBvYmouc3VwcG9ydHMgJiYgbmV3T2JqLmxheWVyID09PSBvYmoubGF5ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBhcGkudXBkYXRlKG9iaiA9IG5ld09iaik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFwaS5yZW1vdmUoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHVwZGF0ZXI7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGxpc3QsIG9wdGlvbnMpIHtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGxpc3QgPSBsaXN0IHx8IFtdO1xuICB2YXIgbGFzdElkZW50aWZpZXJzID0gbW9kdWxlc1RvRG9tKGxpc3QsIG9wdGlvbnMpO1xuICByZXR1cm4gZnVuY3Rpb24gdXBkYXRlKG5ld0xpc3QpIHtcbiAgICBuZXdMaXN0ID0gbmV3TGlzdCB8fCBbXTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGFzdElkZW50aWZpZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB2YXIgaWRlbnRpZmllciA9IGxhc3RJZGVudGlmaWVyc1tpXTtcbiAgICAgIHZhciBpbmRleCA9IGdldEluZGV4QnlJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xuICAgICAgc3R5bGVzSW5ET01baW5kZXhdLnJlZmVyZW5jZXMtLTtcbiAgICB9XG5cbiAgICB2YXIgbmV3TGFzdElkZW50aWZpZXJzID0gbW9kdWxlc1RvRG9tKG5ld0xpc3QsIG9wdGlvbnMpO1xuXG4gICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGxhc3RJZGVudGlmaWVycy5sZW5ndGg7IF9pKyspIHtcbiAgICAgIHZhciBfaWRlbnRpZmllciA9IGxhc3RJZGVudGlmaWVyc1tfaV07XG5cbiAgICAgIHZhciBfaW5kZXggPSBnZXRJbmRleEJ5SWRlbnRpZmllcihfaWRlbnRpZmllcik7XG5cbiAgICAgIGlmIChzdHlsZXNJbkRPTVtfaW5kZXhdLnJlZmVyZW5jZXMgPT09IDApIHtcbiAgICAgICAgc3R5bGVzSW5ET01bX2luZGV4XS51cGRhdGVyKCk7XG5cbiAgICAgICAgc3R5bGVzSW5ET00uc3BsaWNlKF9pbmRleCwgMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgbGFzdElkZW50aWZpZXJzID0gbmV3TGFzdElkZW50aWZpZXJzO1xuICB9O1xufTsiLCJcInVzZSBzdHJpY3RcIjtcblxudmFyIG1lbW8gPSB7fTtcbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICAqL1xuXG5mdW5jdGlvbiBnZXRUYXJnZXQodGFyZ2V0KSB7XG4gIGlmICh0eXBlb2YgbWVtb1t0YXJnZXRdID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgdmFyIHN0eWxlVGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0YXJnZXQpOyAvLyBTcGVjaWFsIGNhc2UgdG8gcmV0dXJuIGhlYWQgb2YgaWZyYW1lIGluc3RlYWQgb2YgaWZyYW1lIGl0c2VsZlxuXG4gICAgaWYgKHdpbmRvdy5IVE1MSUZyYW1lRWxlbWVudCAmJiBzdHlsZVRhcmdldCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MSUZyYW1lRWxlbWVudCkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbiBpZiBhY2Nlc3MgdG8gaWZyYW1lIGlzIGJsb2NrZWRcbiAgICAgICAgLy8gZHVlIHRvIGNyb3NzLW9yaWdpbiByZXN0cmljdGlvbnNcbiAgICAgICAgc3R5bGVUYXJnZXQgPSBzdHlsZVRhcmdldC5jb250ZW50RG9jdW1lbnQuaGVhZDtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gaXN0YW5idWwgaWdub3JlIG5leHRcbiAgICAgICAgc3R5bGVUYXJnZXQgPSBudWxsO1xuICAgICAgfVxuICAgIH1cblxuICAgIG1lbW9bdGFyZ2V0XSA9IHN0eWxlVGFyZ2V0O1xuICB9XG5cbiAgcmV0dXJuIG1lbW9bdGFyZ2V0XTtcbn1cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICAqL1xuXG5cbmZ1bmN0aW9uIGluc2VydEJ5U2VsZWN0b3IoaW5zZXJ0LCBzdHlsZSkge1xuICB2YXIgdGFyZ2V0ID0gZ2V0VGFyZ2V0KGluc2VydCk7XG5cbiAgaWYgKCF0YXJnZXQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBmaW5kIGEgc3R5bGUgdGFyZ2V0LiBUaGlzIHByb2JhYmx5IG1lYW5zIHRoYXQgdGhlIHZhbHVlIGZvciB0aGUgJ2luc2VydCcgcGFyYW1ldGVyIGlzIGludmFsaWQuXCIpO1xuICB9XG5cbiAgdGFyZ2V0LmFwcGVuZENoaWxkKHN0eWxlKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBpbnNlcnRCeVNlbGVjdG9yOyIsIlwidXNlIHN0cmljdFwiO1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAgKi9cbmZ1bmN0aW9uIGluc2VydFN0eWxlRWxlbWVudChvcHRpb25zKSB7XG4gIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO1xuICBvcHRpb25zLnNldEF0dHJpYnV0ZXMoZWxlbWVudCwgb3B0aW9ucy5hdHRyaWJ1dGVzKTtcbiAgb3B0aW9ucy5pbnNlcnQoZWxlbWVudCwgb3B0aW9ucy5vcHRpb25zKTtcbiAgcmV0dXJuIGVsZW1lbnQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gaW5zZXJ0U3R5bGVFbGVtZW50OyIsIlwidXNlIHN0cmljdFwiO1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAgKi9cbmZ1bmN0aW9uIHNldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcyhzdHlsZUVsZW1lbnQpIHtcbiAgdmFyIG5vbmNlID0gdHlwZW9mIF9fd2VicGFja19ub25jZV9fICE9PSBcInVuZGVmaW5lZFwiID8gX193ZWJwYWNrX25vbmNlX18gOiBudWxsO1xuXG4gIGlmIChub25jZSkge1xuICAgIHN0eWxlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJub25jZVwiLCBub25jZSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBzZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXM7IiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICAqL1xuZnVuY3Rpb24gYXBwbHkoc3R5bGVFbGVtZW50LCBvcHRpb25zLCBvYmopIHtcbiAgdmFyIGNzcyA9IFwiXCI7XG5cbiAgaWYgKG9iai5zdXBwb3J0cykge1xuICAgIGNzcyArPSBcIkBzdXBwb3J0cyAoXCIuY29uY2F0KG9iai5zdXBwb3J0cywgXCIpIHtcIik7XG4gIH1cblxuICBpZiAob2JqLm1lZGlhKSB7XG4gICAgY3NzICs9IFwiQG1lZGlhIFwiLmNvbmNhdChvYmoubWVkaWEsIFwiIHtcIik7XG4gIH1cblxuICB2YXIgbmVlZExheWVyID0gdHlwZW9mIG9iai5sYXllciAhPT0gXCJ1bmRlZmluZWRcIjtcblxuICBpZiAobmVlZExheWVyKSB7XG4gICAgY3NzICs9IFwiQGxheWVyXCIuY29uY2F0KG9iai5sYXllci5sZW5ndGggPiAwID8gXCIgXCIuY29uY2F0KG9iai5sYXllcikgOiBcIlwiLCBcIiB7XCIpO1xuICB9XG5cbiAgY3NzICs9IG9iai5jc3M7XG5cbiAgaWYgKG5lZWRMYXllcikge1xuICAgIGNzcyArPSBcIn1cIjtcbiAgfVxuXG4gIGlmIChvYmoubWVkaWEpIHtcbiAgICBjc3MgKz0gXCJ9XCI7XG4gIH1cblxuICBpZiAob2JqLnN1cHBvcnRzKSB7XG4gICAgY3NzICs9IFwifVwiO1xuICB9XG5cbiAgdmFyIHNvdXJjZU1hcCA9IG9iai5zb3VyY2VNYXA7XG5cbiAgaWYgKHNvdXJjZU1hcCAmJiB0eXBlb2YgYnRvYSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGNzcyArPSBcIlxcbi8qIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGE6YXBwbGljYXRpb24vanNvbjtiYXNlNjQsXCIuY29uY2F0KGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KEpTT04uc3RyaW5naWZ5KHNvdXJjZU1hcCkpKSksIFwiICovXCIpO1xuICB9IC8vIEZvciBvbGQgSUVcblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgICovXG5cblxuICBvcHRpb25zLnN0eWxlVGFnVHJhbnNmb3JtKGNzcywgc3R5bGVFbGVtZW50LCBvcHRpb25zLm9wdGlvbnMpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGVFbGVtZW50KSB7XG4gIC8vIGlzdGFuYnVsIGlnbm9yZSBpZlxuICBpZiAoc3R5bGVFbGVtZW50LnBhcmVudE5vZGUgPT09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBzdHlsZUVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChzdHlsZUVsZW1lbnQpO1xufVxuLyogaXN0YW5idWwgaWdub3JlIG5leHQgICovXG5cblxuZnVuY3Rpb24gZG9tQVBJKG9wdGlvbnMpIHtcbiAgdmFyIHN0eWxlRWxlbWVudCA9IG9wdGlvbnMuaW5zZXJ0U3R5bGVFbGVtZW50KG9wdGlvbnMpO1xuICByZXR1cm4ge1xuICAgIHVwZGF0ZTogZnVuY3Rpb24gdXBkYXRlKG9iaikge1xuICAgICAgYXBwbHkoc3R5bGVFbGVtZW50LCBvcHRpb25zLCBvYmopO1xuICAgIH0sXG4gICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG4gICAgICByZW1vdmVTdHlsZUVsZW1lbnQoc3R5bGVFbGVtZW50KTtcbiAgICB9XG4gIH07XG59XG5cbm1vZHVsZS5leHBvcnRzID0gZG9tQVBJOyIsIlwidXNlIHN0cmljdFwiO1xuXG4vKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAgKi9cbmZ1bmN0aW9uIHN0eWxlVGFnVHJhbnNmb3JtKGNzcywgc3R5bGVFbGVtZW50KSB7XG4gIGlmIChzdHlsZUVsZW1lbnQuc3R5bGVTaGVldCkge1xuICAgIHN0eWxlRWxlbWVudC5zdHlsZVNoZWV0LmNzc1RleHQgPSBjc3M7XG4gIH0gZWxzZSB7XG4gICAgd2hpbGUgKHN0eWxlRWxlbWVudC5maXJzdENoaWxkKSB7XG4gICAgICBzdHlsZUVsZW1lbnQucmVtb3ZlQ2hpbGQoc3R5bGVFbGVtZW50LmZpcnN0Q2hpbGQpO1xuICAgIH1cblxuICAgIHN0eWxlRWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShjc3MpKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHN0eWxlVGFnVHJhbnNmb3JtOyIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgdmlld0JveD1cXFwiMCAwIDI0IDI0XFxcIj48cGF0aCBkPVxcXCJNMTksMTlINVY4SDE5TTE2LDFWM0g4VjFINlYzSDVDMy44OSwzIDMsMy44OSAzLDVWMTlBMiwyIDAgMCwwIDUsMjFIMTlBMiwyIDAgMCwwIDIxLDE5VjVDMjEsMy44OSAyMC4xLDMgMTksM0gxOFYxXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAyNCAyNFxcXCI+PHBhdGggZD1cXFwiTTE1LDEzSDE2LjVWMTUuODJMMTguOTQsMTcuMjNMMTguMTksMTguNTNMMTUsMTYuNjlWMTNNMTksOEg1VjE5SDkuNjdDOS4yNCwxOC4wOSA5LDE3LjA3IDksMTZBNyw3IDAgMCwxIDE2LDlDMTcuMDcsOSAxOC4wOSw5LjI0IDE5LDkuNjdWOE01LDIxQzMuODksMjEgMywyMC4xIDMsMTlWNUMzLDMuODkgMy44OSwzIDUsM0g2VjFIOFYzSDE2VjFIMThWM0gxOUEyLDIgMCAwLDEgMjEsNVYxMS4xQzIyLjI0LDEyLjM2IDIzLDE0LjA5IDIzLDE2QTcsNyAwIDAsMSAxNiwyM0MxNC4wOSwyMyAxMi4zNiwyMi4yNCAxMS4xLDIxSDVNMTYsMTEuMTVBNC44NSw0Ljg1IDAgMCwwIDExLjE1LDE2QzExLjE1LDE4LjY4IDEzLjMyLDIwLjg1IDE2LDIwLjg1QTQuODUsNC44NSAwIDAsMCAyMC44NSwxNkMyMC44NSwxMy4zMiAxOC42OCwxMS4xNSAxNiwxMS4xNVpcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIm1vZHVsZS5leHBvcnRzID0gXCI8c3ZnIHhtbG5zPVxcXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1xcXCIgdmlld0JveD1cXFwiMCAwIDI0IDI0XFxcIj48cGF0aCBkPVxcXCJNMjEsN0w5LDE5TDMuNSwxMy41TDQuOTEsMTIuMDlMOSwxNi4xN0wxOS41OSw1LjU5TDIxLDdaXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAyNCAyNFxcXCI+PHBhdGggZD1cXFwiTTcuNDEsOC41OEwxMiwxMy4xN0wxNi41OSw4LjU4TDE4LDEwTDEyLDE2TDYsMTBMNy40MSw4LjU4WlxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMjQgMjRcXFwiPjxwYXRoIGQ9XFxcIk0xOSAzSDE0LjgyQzE0LjQgMS44NCAxMy4zIDEgMTIgMVM5LjYgMS44NCA5LjE4IDNINUMzLjkgMyAzIDMuOSAzIDVWMTlDMyAyMC4xIDMuOSAyMSA1IDIxSDE5QzIwLjEgMjEgMjEgMjAuMSAyMSAxOVY1QzIxIDMuOSAyMC4xIDMgMTkgM00xMiAzQzEyLjU1IDMgMTMgMy40NSAxMyA0UzEyLjU1IDUgMTIgNSAxMSA0LjU1IDExIDQgMTEuNDUgMyAxMiAzTTcgN0gxN1Y1SDE5VjE5SDVWNUg3VjdNMTIgMTdWMTVIMTdWMTdIMTJNMTIgMTFWOUgxN1YxMUgxMk04IDEyVjlIN1Y4SDlWMTJIOE05LjI1IDE0QzkuNjYgMTQgMTAgMTQuMzQgMTAgMTQuNzVDMTAgMTQuOTUgOS45MiAxNS4xNCA5Ljc5IDE1LjI3TDguMTIgMTdIMTBWMThIN1YxNy4wOEw5IDE1SDdWMTRIOS4yNVxcXCI+PC9wYXRoPjwvc3ZnPlwiIiwibW9kdWxlLmV4cG9ydHMgPSBcIjxzdmcgeG1sbnM9XFxcImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXFxcIiB2aWV3Qm94PVxcXCIwIDAgMjQgMjRcXFwiPjxwYXRoIGQ9XFxcIk0xOSAzSDVDMy45IDMgMyAzLjkgMyA1VjE5QzMgMjAuMSAzLjkgMjEgNSAyMUgxOUMyMC4xIDIxIDIxIDIwLjEgMjEgMTlWNUMyMSAzLjkgMjAuMSAzIDE5IDNNNyA3SDlWOUg3VjdNNyAxMUg5VjEzSDdWMTFNNyAxNUg5VjE3SDdWMTVNMTcgMTdIMTFWMTVIMTdWMTdNMTcgMTNIMTFWMTFIMTdWMTNNMTcgOUgxMVY3SDE3VjlaXFxcIj48L3BhdGg+PC9zdmc+XCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPHN2ZyB4bWxucz1cXFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcXFwiIHZpZXdCb3g9XFxcIjAgMCAyNCAyNFxcXCI+PHBhdGggZD1cXFwiTTE5LDEzSDEzVjE5SDExVjEzSDVWMTFIMTFWNUgxM1YxMUgxOVYxM1pcXFwiPjwvcGF0aD48L3N2Zz5cIiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0aWQ6IG1vZHVsZUlkLFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuX193ZWJwYWNrX3JlcXVpcmVfXy5uID0gKG1vZHVsZSkgPT4ge1xuXHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cblx0XHQoKSA9PiAobW9kdWxlWydkZWZhdWx0J10pIDpcblx0XHQoKSA9PiAobW9kdWxlKTtcblx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgeyBhOiBnZXR0ZXIgfSk7XG5cdHJldHVybiBnZXR0ZXI7XG59OyIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIl9fd2VicGFja19yZXF1aXJlX18ubmMgPSB1bmRlZmluZWQ7IiwiY2xhc3MgUHViU3ViIHtcclxuICAgIGV2ZW50cyA9IHt9O1xyXG5cclxuICAgIHB1Ymxpc2goZXZlbnQsIGRhdGEpIHtcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzW2V2ZW50XSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBsaXN0ZW5lciBvZiB0aGlzLmV2ZW50c1tldmVudF0pIHtcclxuICAgICAgICAgICAgbGlzdGVuZXIoZGF0YSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHN1YnNjcmliZShldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzW2V2ZW50XSkge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0gPSBbXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50XS5wdXNoKGNhbGxiYWNrKTtcclxuICAgIH1cclxuXHJcbiAgICB1bnN1YnNjcmliZShldmVudCwgY2FsbGJhY2spIHtcclxuICAgICAgICBpZiAoIXRoaXMuZXZlbnRzW2V2ZW50XSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0ucmVtb3ZlKFxyXG4gICAgICAgICAgICB0aGlzLmV2ZW50c1tldmVudF0uZmluZChsaXN0ZW5lciA9PiBsaXN0ZW5lciA9PT0gY2FsbGJhY2spXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IFB1YlN1YigpOyIsImV4cG9ydCBjbGFzcyBUb2RvSXRlbSB7XHJcbiAgICBjb25zdHJ1Y3RvcihpZCwgdGl0bGUsIHByaW9yaXR5LCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgaXNDb21wbGV0ZSwgcHJvamVjdElkKSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLnByaW9yaXR5ID0gcHJpb3JpdHksXHJcbiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xyXG4gICAgICAgIHRoaXMuZHVlRGF0ZSA9IGR1ZURhdGU7XHJcbiAgICAgICAgdGhpcy5pc0NvbXBsZXRlID0gaXNDb21wbGV0ZSB8fCBmYWxzZTtcclxuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHByb2plY3RJZDtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgcHJpb3JpdGllcyA9IHtcclxuICAgICAgICAxOiBcIkNyaXRpY2FsXCIsXHJcbiAgICAgICAgMjogXCJJbXBvcnRhbnRcIixcclxuICAgICAgICAzOiBcIkRlZmF1bHRcIlxyXG4gICAgfVxyXG59IiwiaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi9QdWJTdWJcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBnZXROZXh0SWQoYXJyKSB7XHJcbiAgICBpZiAoYXJyLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiAxO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFyci5yZWR1Y2UoKHByZXZpb3VzLCBpdGVtKSA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV4dCA9IHByZXZpb3VzLmlkIDwgaXRlbS5pZCA/IGl0ZW0gOiBwcmV2aW91c1xyXG4gICAgICAgIHJldHVybiBuZXh0O1xyXG4gICAgfSkuaWQgKyAxO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gcHVibGlzaExpbmsocGFnZSwgZGF0YSkge1xyXG4gICAgUHViU3ViLnB1Ymxpc2goJ2NoYW5nZVBhZ2UnLCB7XHJcbiAgICAgICAgcGFnZSxcclxuICAgICAgICBkYXRhXHJcbiAgICB9KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGdldEluZGV4RnJvbUlkKGFyciwgaWQpIHtcclxuICAgIHJldHVybiBhcnIuZmluZEluZGV4KGl0ZW0gPT4gaXRlbS5pZCA9PT0gaWQpO1xyXG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gcmVxdWlyZWRBcmdzKHJlcXVpcmVkLCBhcmdzKSB7XG4gIGlmIChhcmdzLmxlbmd0aCA8IHJlcXVpcmVkKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihyZXF1aXJlZCArICcgYXJndW1lbnQnICsgKHJlcXVpcmVkID4gMSA/ICdzJyA6ICcnKSArICcgcmVxdWlyZWQsIGJ1dCBvbmx5ICcgKyBhcmdzLmxlbmd0aCArICcgcHJlc2VudCcpO1xuICB9XG59IiwiZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZiA9IGZ1bmN0aW9uIF90eXBlb2Yob2JqKSB7IHJldHVybiB0eXBlb2Ygb2JqOyB9OyB9IGVsc2UgeyBfdHlwZW9mID0gZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07IH0gcmV0dXJuIF90eXBlb2Yob2JqKTsgfVxuXG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSB0b0RhdGVcbiAqIEBjYXRlZ29yeSBDb21tb24gSGVscGVyc1xuICogQHN1bW1hcnkgQ29udmVydCB0aGUgZ2l2ZW4gYXJndW1lbnQgdG8gYW4gaW5zdGFuY2Ugb2YgRGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIENvbnZlcnQgdGhlIGdpdmVuIGFyZ3VtZW50IHRvIGFuIGluc3RhbmNlIG9mIERhdGUuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIGFuIGluc3RhbmNlIG9mIERhdGUsIHRoZSBmdW5jdGlvbiByZXR1cm5zIGl0cyBjbG9uZS5cbiAqXG4gKiBJZiB0aGUgYXJndW1lbnQgaXMgYSBudW1iZXIsIGl0IGlzIHRyZWF0ZWQgYXMgYSB0aW1lc3RhbXAuXG4gKlxuICogSWYgdGhlIGFyZ3VtZW50IGlzIG5vbmUgb2YgdGhlIGFib3ZlLCB0aGUgZnVuY3Rpb24gcmV0dXJucyBJbnZhbGlkIERhdGUuXG4gKlxuICogKipOb3RlKio6ICphbGwqIERhdGUgYXJndW1lbnRzIHBhc3NlZCB0byBhbnkgKmRhdGUtZm5zKiBmdW5jdGlvbiBpcyBwcm9jZXNzZWQgYnkgYHRvRGF0ZWAuXG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gYXJndW1lbnQgLSB0aGUgdmFsdWUgdG8gY29udmVydFxuICogQHJldHVybnMge0RhdGV9IHRoZSBwYXJzZWQgZGF0ZSBpbiB0aGUgbG9jYWwgdGltZSB6b25lXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDEgYXJndW1lbnQgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQ2xvbmUgdGhlIGRhdGU6XG4gKiBjb25zdCByZXN1bHQgPSB0b0RhdGUobmV3IERhdGUoMjAxNCwgMSwgMTEsIDExLCAzMCwgMzApKVxuICogLy89PiBUdWUgRmViIDExIDIwMTQgMTE6MzA6MzBcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQ29udmVydCB0aGUgdGltZXN0YW1wIHRvIGRhdGU6XG4gKiBjb25zdCByZXN1bHQgPSB0b0RhdGUoMTM5MjA5ODQzMDAwMClcbiAqIC8vPT4gVHVlIEZlYiAxMSAyMDE0IDExOjMwOjMwXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdG9EYXRlKGFyZ3VtZW50KSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICB2YXIgYXJnU3RyID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGFyZ3VtZW50KTsgLy8gQ2xvbmUgdGhlIGRhdGVcblxuICBpZiAoYXJndW1lbnQgaW5zdGFuY2VvZiBEYXRlIHx8IF90eXBlb2YoYXJndW1lbnQpID09PSAnb2JqZWN0JyAmJiBhcmdTdHIgPT09ICdbb2JqZWN0IERhdGVdJykge1xuICAgIC8vIFByZXZlbnQgdGhlIGRhdGUgdG8gbG9zZSB0aGUgbWlsbGlzZWNvbmRzIHdoZW4gcGFzc2VkIHRvIG5ldyBEYXRlKCkgaW4gSUUxMFxuICAgIHJldHVybiBuZXcgRGF0ZShhcmd1bWVudC5nZXRUaW1lKCkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBhcmd1bWVudCA9PT0gJ251bWJlcicgfHwgYXJnU3RyID09PSAnW29iamVjdCBOdW1iZXJdJykge1xuICAgIHJldHVybiBuZXcgRGF0ZShhcmd1bWVudCk7XG4gIH0gZWxzZSB7XG4gICAgaWYgKCh0eXBlb2YgYXJndW1lbnQgPT09ICdzdHJpbmcnIHx8IGFyZ1N0ciA9PT0gJ1tvYmplY3QgU3RyaW5nXScpICYmIHR5cGVvZiBjb25zb2xlICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUud2FybihcIlN0YXJ0aW5nIHdpdGggdjIuMC4wLWJldGEuMSBkYXRlLWZucyBkb2Vzbid0IGFjY2VwdCBzdHJpbmdzIGFzIGRhdGUgYXJndW1lbnRzLiBQbGVhc2UgdXNlIGBwYXJzZUlTT2AgdG8gcGFyc2Ugc3RyaW5ncy4gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZGF0ZS1mbnMvZGF0ZS1mbnMvYmxvYi9tYXN0ZXIvZG9jcy91cGdyYWRlR3VpZGUubWQjc3RyaW5nLWFyZ3VtZW50c1wiKTsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcblxuICAgICAgY29uc29sZS53YXJuKG5ldyBFcnJvcigpLnN0YWNrKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IERhdGUoTmFOKTtcbiAgfVxufSIsImltcG9ydCB0b0RhdGUgZnJvbSBcIi4uL3RvRGF0ZS9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcbi8qKlxuICogQG5hbWUgc3RhcnRPZkRheVxuICogQGNhdGVnb3J5IERheSBIZWxwZXJzXG4gKiBAc3VtbWFyeSBSZXR1cm4gdGhlIHN0YXJ0IG9mIGEgZGF5IGZvciB0aGUgZ2l2ZW4gZGF0ZS5cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFJldHVybiB0aGUgc3RhcnQgb2YgYSBkYXkgZm9yIHRoZSBnaXZlbiBkYXRlLlxuICogVGhlIHJlc3VsdCB3aWxsIGJlIGluIHRoZSBsb2NhbCB0aW1lem9uZS5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIG9yaWdpbmFsIGRhdGVcbiAqIEByZXR1cm5zIHtEYXRlfSB0aGUgc3RhcnQgb2YgYSBkYXlcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBUaGUgc3RhcnQgb2YgYSBkYXkgZm9yIDIgU2VwdGVtYmVyIDIwMTQgMTE6NTU6MDA6XG4gKiBjb25zdCByZXN1bHQgPSBzdGFydE9mRGF5KG5ldyBEYXRlKDIwMTQsIDgsIDIsIDExLCA1NSwgMCkpXG4gKiAvLz0+IFR1ZSBTZXAgMDIgMjAxNCAwMDowMDowMFxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHN0YXJ0T2ZEYXkoZGlydHlEYXRlKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICBkYXRlLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICByZXR1cm4gZGF0ZTtcbn0iLCJpbXBvcnQgc3RhcnRPZkRheSBmcm9tIFwiLi4vc3RhcnRPZkRheS9pbmRleC5qc1wiO1xuaW1wb3J0IHJlcXVpcmVkQXJncyBmcm9tIFwiLi4vX2xpYi9yZXF1aXJlZEFyZ3MvaW5kZXguanNcIjtcbi8qKlxuICogQG5hbWUgaXNTYW1lRGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IEFyZSB0aGUgZ2l2ZW4gZGF0ZXMgaW4gdGhlIHNhbWUgZGF5IChhbmQgeWVhciBhbmQgbW9udGgpP1xuICpcbiAqIEBkZXNjcmlwdGlvblxuICogQXJlIHRoZSBnaXZlbiBkYXRlcyBpbiB0aGUgc2FtZSBkYXkgKGFuZCB5ZWFyIGFuZCBtb250aCk/XG4gKlxuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZUxlZnQgLSB0aGUgZmlyc3QgZGF0ZSB0byBjaGVja1xuICogQHBhcmFtIHtEYXRlfE51bWJlcn0gZGF0ZVJpZ2h0IC0gdGhlIHNlY29uZCBkYXRlIHRvIGNoZWNrXG4gKiBAcmV0dXJucyB7Qm9vbGVhbn0gdGhlIGRhdGVzIGFyZSBpbiB0aGUgc2FtZSBkYXkgKGFuZCB5ZWFyIGFuZCBtb250aClcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMiBhcmd1bWVudHMgcmVxdWlyZWRcbiAqXG4gKiBAZXhhbXBsZVxuICogLy8gQXJlIDQgU2VwdGVtYmVyIDA2OjAwOjAwIGFuZCA0IFNlcHRlbWJlciAxODowMDowMCBpbiB0aGUgc2FtZSBkYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVEYXkobmV3IERhdGUoMjAxNCwgOCwgNCwgNiwgMCksIG5ldyBEYXRlKDIwMTQsIDgsIDQsIDE4LCAwKSlcbiAqIC8vPT4gdHJ1ZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgNCBTZXB0ZW1iZXIgYW5kIDQgT2N0b2JlciBpbiB0aGUgc2FtZSBkYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1NhbWVEYXkobmV3IERhdGUoMjAxNCwgOCwgNCksIG5ldyBEYXRlKDIwMTQsIDksIDQpKVxuICogLy89PiBmYWxzZVxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBBcmUgNCBTZXB0ZW1iZXIsIDIwMTQgYW5kIDQgU2VwdGVtYmVyLCAyMDE1IGluIHRoZSBzYW1lIGRheT9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzU2FtZURheShuZXcgRGF0ZSgyMDE0LCA4LCA0KSwgbmV3IERhdGUoMjAxNSwgOCwgNCkpXG4gKiAvLz0+IGZhbHNlXG4gKi9cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTYW1lRGF5KGRpcnR5RGF0ZUxlZnQsIGRpcnR5RGF0ZVJpZ2h0KSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZUxlZnRTdGFydE9mRGF5ID0gc3RhcnRPZkRheShkaXJ0eURhdGVMZWZ0KTtcbiAgdmFyIGRhdGVSaWdodFN0YXJ0T2ZEYXkgPSBzdGFydE9mRGF5KGRpcnR5RGF0ZVJpZ2h0KTtcbiAgcmV0dXJuIGRhdGVMZWZ0U3RhcnRPZkRheS5nZXRUaW1lKCkgPT09IGRhdGVSaWdodFN0YXJ0T2ZEYXkuZ2V0VGltZSgpO1xufSIsImltcG9ydCB7IFRvZG9JdGVtIH0gZnJvbSBcIi4vVG9kb0l0ZW1cIjtcclxuaW1wb3J0IHsgZ2V0TmV4dElkLCBnZXRJbmRleEZyb21JZCB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCBQdWJTdWIgZnJvbSBcIi4uL1B1YlN1YlwiO1xyXG5cclxuY29uc3QgVG9kb0l0ZW1SZXBvc2l0b3J5TG9jYWwgPSAoKCkgPT4ge1xyXG4gICAgZnVuY3Rpb24gbG9hZFRvZG9JdGVtcygpIHtcclxuICAgICAgICBjb25zdCB0ZW1wVG9kb0l0ZW1zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9kb0l0ZW1zJykpO1xyXG4gICAgICAgIGlmICghdGVtcFRvZG9JdGVtcykge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IG5ld1RvZG9JdGVtcyA9IHRlbXBUb2RvSXRlbXMubWFwKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBuZXdJdGVtID0gbmV3IFRvZG9JdGVtKFxyXG4gICAgICAgICAgICAgICAgaXRlbS5pZCxcclxuICAgICAgICAgICAgICAgIGl0ZW0udGl0bGUsXHJcbiAgICAgICAgICAgICAgICBpdGVtLnByaW9yaXR5LFxyXG4gICAgICAgICAgICAgICAgaXRlbS5kZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgICAgIG5ldyBEYXRlKGl0ZW0uZHVlRGF0ZSksXHJcbiAgICAgICAgICAgICAgICBpdGVtLmlzQ29tcGxldGUsXHJcbiAgICAgICAgICAgICAgICBOdW1iZXIoaXRlbS5wcm9qZWN0SWQpXHJcbiAgICAgICAgICAgIClcclxuICAgICAgICAgICAgcmV0dXJuIG5ld0l0ZW07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1RvZG9JdGVtcztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCB0b2RvSXRlbXMgPSBsb2FkVG9kb0l0ZW1zKCkgfHwgW107XHJcblxyXG4gICAgYXN5bmMgZnVuY3Rpb24gYWRkVG9kb0l0ZW0odGl0bGUsIHByaW9yaXR5LCBkZXNjcmlwdGlvbiwgZHVlRGF0ZSwgcHJvamVjdElkKSB7XHJcbiAgICAgICAgY29uc3QgbmV3SWQgPSBnZXROZXh0SWQodG9kb0l0ZW1zKTtcclxuICAgICAgICBpZiAoIXRpdGxlIHx8ICFwcmlvcml0eSB8fCAhZGVzY3JpcHRpb24gfHwgIWR1ZURhdGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghTnVtYmVyKHByaW9yaXR5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZHVlRGF0ZSA9IG5ldyBEYXRlKGR1ZURhdGUpO1xyXG4gICAgICAgIGNvbnN0IG5ld1RvZG9JdGVtID0gbmV3IFRvZG9JdGVtKG5ld0lkLCB0aXRsZSwgTnVtYmVyKHByaW9yaXR5KSwgZGVzY3JpcHRpb24sIGR1ZURhdGUsIGZhbHNlLCBwcm9qZWN0SWQgfHwgMSk7XHJcbiAgICAgICAgdG9kb0l0ZW1zLnB1c2gobmV3VG9kb0l0ZW0pO1xyXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdUb2RvSXRlbXNDaGFuZ2VkJyk7XHJcbiAgICAgICAgcmV0dXJuIG5ld1RvZG9JdGVtO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGZ1bmN0aW9uIGdldFRvZG9JdGVtcygpIHtcclxuICAgICAgICByZXR1cm4gdG9kb0l0ZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGZ1bmN0aW9uIGdldFRvZG9JdGVtQnlJZChpZCkge1xyXG4gICAgICAgIHJldHVybiB0b2RvSXRlbXMuZmluZChpdGVtID0+IGl0ZW0uaWQgPT09IGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBmdW5jdGlvbiBkZWxldGVUb2RvSXRlbShpZCkge1xyXG4gICAgICAgIHRvZG9JdGVtcy5zcGxpY2UoZ2V0SW5kZXhGcm9tSWQodG9kb0l0ZW1zLCBpZCksIDEpO1xyXG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdUb2RvSXRlbXNDaGFuZ2VkJyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVG9kb0l0ZW0oaXRlbSkge1xyXG4gICAgICAgIGNvbnN0IG9sZEl0ZW0gPSBnZXRUb2RvSXRlbUJ5SWQoaXRlbS5pZCk7XHJcbiAgICAgICAgaWYgKCFvbGRJdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRvZG9JdGVtc1tnZXRJbmRleEZyb21JZCh0b2RvSXRlbXMsIGl0ZW0uaWQpXSA9IGl0ZW07XHJcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ1RvZG9JdGVtc0NoYW5nZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICBQdWJTdWIuc3Vic2NyaWJlKCdUb2RvSXRlbXNDaGFuZ2VkJywgKCkgPT4ge1xyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2RvSXRlbXMnLCBKU09OLnN0cmluZ2lmeSh0b2RvSXRlbXMpKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0VG9kb0l0ZW1zLFxyXG4gICAgICAgIGdldFRvZG9JdGVtQnlJZCxcclxuICAgICAgICBhZGRUb2RvSXRlbSxcclxuICAgICAgICBkZWxldGVUb2RvSXRlbSxcclxuICAgICAgICB1cGRhdGVUb2RvSXRlbVxyXG4gICAgfVxyXG59KSgpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgVG9kb0l0ZW1SZXBvc2l0b3J5TG9jYWw7IiwiaW1wb3J0IHsgVG9kb0l0ZW0gfSBmcm9tIFwiLi9Ub2RvSXRlbVwiO1xyXG5pbXBvcnQgeyBnZXROZXh0SWQsIGdldEluZGV4RnJvbUlkIH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuaW1wb3J0IGlzRnV0dXJlIGZyb20gXCJkYXRlLWZucy9pc0Z1dHVyZVwiO1xyXG5pbXBvcnQgaXNUb2RheSBmcm9tIFwiZGF0ZS1mbnMvaXNUb2RheVwiO1xyXG5pbXBvcnQgUHViU3ViIGZyb20gXCIuLi9QdWJTdWJcIjtcclxuaW1wb3J0IFRvZG9JdGVtUmVwb3NpdG9yeUxvY2FsIGZyb20gXCIuL1RvZG9JdGVtUmVwb3NpdG9yeUxvY2FsXCI7XHJcblxyXG5jb25zdCByZXBvc2l0b3J5ID0gVG9kb0l0ZW1SZXBvc2l0b3J5TG9jYWw7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBhZGRUb2RvSXRlbSh0aXRsZSwgcHJpb3JpdHksIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcm9qZWN0SWQpIHtcclxuICAgIGNvbnN0IG5ld1RvZG9JdGVtID0gYXdhaXQgcmVwb3NpdG9yeS5hZGRUb2RvSXRlbSh0aXRsZSwgcHJpb3JpdHksIGRlc2NyaXB0aW9uLCBkdWVEYXRlLCBwcm9qZWN0SWQpO1xyXG4gICAgcmV0dXJuIG5ld1RvZG9JdGVtO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBnZXRUb2RvSXRlbXMoKSB7XHJcbiAgICByZXR1cm4gYXdhaXQgcmVwb3NpdG9yeS5nZXRUb2RvSXRlbXMoKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0VG9kb0l0ZW1zVG9kYXkoKSB7XHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHJlcG9zaXRvcnkuZ2V0VG9kb0l0ZW1zKCk7XHJcbiAgICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgIHJldHVybiBpc1RvZGF5KGl0ZW0uZHVlRGF0ZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZ2V0VG9kb0l0ZW1zVXBjb21pbmcoKSB7XHJcbiAgICBjb25zdCBpdGVtcyA9IGF3YWl0IHJlcG9zaXRvcnkuZ2V0VG9kb0l0ZW1zKCk7XHJcbiAgICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4ge1xyXG4gICAgICAgIHJldHVybiBpc0Z1dHVyZShpdGVtLmR1ZURhdGUpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGdldFRvZG9JdGVtQnlJZChpZCkge1xyXG4gICAgcmV0dXJuIGF3YWl0IHJlcG9zaXRvcnkuZ2V0VG9kb0l0ZW1CeUlkKGlkKTtcclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gZGVsZXRlVG9kb0l0ZW0oaWQpIHtcclxuICAgIGF3YWl0IHJlcG9zaXRvcnkuZGVsZXRlVG9kb0l0ZW0oaWQpO1xyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiB1cGRhdGVUb2RvSXRlbShpdGVtKSB7XHJcbiAgICBhd2FpdCByZXBvc2l0b3J5LnVwZGF0ZVRvZG9JdGVtKGl0ZW0pO1xyXG59XHJcblxyXG5leHBvcnQgeyBhZGRUb2RvSXRlbSwgZ2V0VG9kb0l0ZW1zLCBnZXRUb2RvSXRlbUJ5SWQsIGRlbGV0ZVRvZG9JdGVtLCB1cGRhdGVUb2RvSXRlbSwgZ2V0VG9kb0l0ZW1zVG9kYXksIGdldFRvZG9JdGVtc1VwY29taW5nIH07IiwiaW1wb3J0IGlzU2FtZURheSBmcm9tIFwiLi4vaXNTYW1lRGF5L2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc1RvZGF5XG4gKiBAY2F0ZWdvcnkgRGF5IEhlbHBlcnNcbiAqIEBzdW1tYXJ5IElzIHRoZSBnaXZlbiBkYXRlIHRvZGF5P1xuICogQHB1cmUgZmFsc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBnaXZlbiBkYXRlIHRvZGF5P1xuICpcbiAqID4g4pqg77iPIFBsZWFzZSBub3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBpcyBub3QgcHJlc2VudCBpbiB0aGUgRlAgc3VibW9kdWxlIGFzXG4gKiA+IGl0IHVzZXMgYERhdGUubm93KClgIGludGVybmFsbHkgaGVuY2UgaW1wdXJlIGFuZCBjYW4ndCBiZSBzYWZlbHkgY3VycmllZC5cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdG8gY2hlY2tcbiAqIEByZXR1cm5zIHtCb29sZWFufSB0aGUgZGF0ZSBpcyB0b2RheVxuICogQHRocm93cyB7VHlwZUVycm9yfSAxIGFyZ3VtZW50IHJlcXVpcmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElmIHRvZGF5IGlzIDYgT2N0b2JlciAyMDE0LCBpcyA2IE9jdG9iZXIgMTQ6MDA6MDAgdG9kYXk/XG4gKiBjb25zdCByZXN1bHQgPSBpc1RvZGF5KG5ldyBEYXRlKDIwMTQsIDksIDYsIDE0LCAwKSlcbiAqIC8vPT4gdHJ1ZVxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzVG9kYXkoZGlydHlEYXRlKSB7XG4gIHJlcXVpcmVkQXJncygxLCBhcmd1bWVudHMpO1xuICByZXR1cm4gaXNTYW1lRGF5KGRpcnR5RGF0ZSwgRGF0ZS5ub3coKSk7XG59IiwiaW1wb3J0IHRvRGF0ZSBmcm9tIFwiLi4vdG9EYXRlL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBpc0Z1dHVyZVxuICogQGNhdGVnb3J5IENvbW1vbiBIZWxwZXJzXG4gKiBAc3VtbWFyeSBJcyB0aGUgZ2l2ZW4gZGF0ZSBpbiB0aGUgZnV0dXJlP1xuICogQHB1cmUgZmFsc2VcbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBnaXZlbiBkYXRlIGluIHRoZSBmdXR1cmU/XG4gKlxuICogPiDimqDvuI8gUGxlYXNlIG5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIGlzIG5vdCBwcmVzZW50IGluIHRoZSBGUCBzdWJtb2R1bGUgYXNcbiAqID4gaXQgdXNlcyBgRGF0ZS5ub3coKWAgaW50ZXJuYWxseSBoZW5jZSBpbXB1cmUgYW5kIGNhbid0IGJlIHNhZmVseSBjdXJyaWVkLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgZGF0ZSB0byBjaGVja1xuICogQHJldHVybnMge0Jvb2xlYW59IHRoZSBkYXRlIGlzIGluIHRoZSBmdXR1cmVcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBJZiB0b2RheSBpcyA2IE9jdG9iZXIgMjAxNCwgaXMgMzEgRGVjZW1iZXIgMjAxNCBpbiB0aGUgZnV0dXJlP1xuICogY29uc3QgcmVzdWx0ID0gaXNGdXR1cmUobmV3IERhdGUoMjAxNCwgMTEsIDMxKSlcbiAqIC8vPT4gdHJ1ZVxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzRnV0dXJlKGRpcnR5RGF0ZSkge1xuICByZXF1aXJlZEFyZ3MoMSwgYXJndW1lbnRzKTtcbiAgcmV0dXJuIHRvRGF0ZShkaXJ0eURhdGUpLmdldFRpbWUoKSA+IERhdGUubm93KCk7XG59IiwiZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG4gICAgY29uc3RydWN0b3IoaWQsIG5hbWUpIHtcclxuICAgICAgICB0aGlzLmlkID0gaWQgfHwgJyc7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IFByb2plY3RDb252ZXJ0ZXIgPSB7XHJcbiAgICAgICAgdG9GaXJlc3RvcmU6IChwcm9qZWN0KSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBwcm9qZWN0Lm5hbWVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIGZyb21GaXJlc3RvcmU6IChzbmFwc2hvdCwgb3B0aW9ucykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRhID0gc25hcHNob3QuZGF0YShvcHRpb25zKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9qZWN0KHNuYXBzaG90LmlkLCBkYXRhLm5hbWUpO1xyXG4gICAgICAgIH1cclxufTsiLCIvKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogQGZpbGVvdmVydmlldyBGaXJlYmFzZSBjb25zdGFudHMuICBTb21lIG9mIHRoZXNlIChAZGVmaW5lcykgY2FuIGJlIG92ZXJyaWRkZW4gYXQgY29tcGlsZS10aW1lLlxyXG4gKi9cclxuY29uc3QgQ09OU1RBTlRTID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIGNsaWVudCBOb2RlLmpzIFNESy5cclxuICAgICAqL1xyXG4gICAgTk9ERV9DTElFTlQ6IGZhbHNlLFxyXG4gICAgLyoqXHJcbiAgICAgKiBAZGVmaW5lIHtib29sZWFufSBXaGV0aGVyIHRoaXMgaXMgdGhlIEFkbWluIE5vZGUuanMgU0RLLlxyXG4gICAgICovXHJcbiAgICBOT0RFX0FETUlOOiBmYWxzZSxcclxuICAgIC8qKlxyXG4gICAgICogRmlyZWJhc2UgU0RLIFZlcnNpb25cclxuICAgICAqL1xyXG4gICAgU0RLX1ZFUlNJT046ICcke0pTQ09SRV9WRVJTSU9OfSdcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRocm93cyBhbiBlcnJvciBpZiB0aGUgcHJvdmlkZWQgYXNzZXJ0aW9uIGlzIGZhbHN5XHJcbiAqL1xyXG5jb25zdCBhc3NlcnQgPSBmdW5jdGlvbiAoYXNzZXJ0aW9uLCBtZXNzYWdlKSB7XHJcbiAgICBpZiAoIWFzc2VydGlvbikge1xyXG4gICAgICAgIHRocm93IGFzc2VydGlvbkVycm9yKG1lc3NhZ2UpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogUmV0dXJucyBhbiBFcnJvciBvYmplY3Qgc3VpdGFibGUgZm9yIHRocm93aW5nLlxyXG4gKi9cclxuY29uc3QgYXNzZXJ0aW9uRXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSkge1xyXG4gICAgcmV0dXJuIG5ldyBFcnJvcignRmlyZWJhc2UgRGF0YWJhc2UgKCcgK1xyXG4gICAgICAgIENPTlNUQU5UUy5TREtfVkVSU0lPTiArXHJcbiAgICAgICAgJykgSU5URVJOQUwgQVNTRVJUIEZBSUxFRDogJyArXHJcbiAgICAgICAgbWVzc2FnZSk7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IHN0cmluZ1RvQnl0ZUFycmF5JDEgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBsZXQgcCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgaWYgKGMgPCAxMjgpIHtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSBjO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjIDwgMjA0OCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDYpIHwgMTkyO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjICYgNjMpIHwgMTI4O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgoYyAmIDB4ZmMwMCkgPT09IDB4ZDgwMCAmJlxyXG4gICAgICAgICAgICBpICsgMSA8IHN0ci5sZW5ndGggJiZcclxuICAgICAgICAgICAgKHN0ci5jaGFyQ29kZUF0KGkgKyAxKSAmIDB4ZmMwMCkgPT09IDB4ZGMwMCkge1xyXG4gICAgICAgICAgICAvLyBTdXJyb2dhdGUgUGFpclxyXG4gICAgICAgICAgICBjID0gMHgxMDAwMCArICgoYyAmIDB4MDNmZikgPDwgMTApICsgKHN0ci5jaGFyQ29kZUF0KCsraSkgJiAweDAzZmYpO1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gMTIpIHwgMjI0O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59O1xyXG4vKipcclxuICogVHVybnMgYW4gYXJyYXkgb2YgbnVtYmVycyBpbnRvIHRoZSBzdHJpbmcgZ2l2ZW4gYnkgdGhlIGNvbmNhdGVuYXRpb24gb2YgdGhlXHJcbiAqIGNoYXJhY3RlcnMgdG8gd2hpY2ggdGhlIG51bWJlcnMgY29ycmVzcG9uZC5cclxuICogQHBhcmFtIGJ5dGVzIEFycmF5IG9mIG51bWJlcnMgcmVwcmVzZW50aW5nIGNoYXJhY3RlcnMuXHJcbiAqIEByZXR1cm4gU3RyaW5naWZpY2F0aW9uIG9mIHRoZSBhcnJheS5cclxuICovXHJcbmNvbnN0IGJ5dGVBcnJheVRvU3RyaW5nID0gZnVuY3Rpb24gKGJ5dGVzKSB7XHJcbiAgICAvLyBUT0RPKHVzZXIpOiBVc2UgbmF0aXZlIGltcGxlbWVudGF0aW9ucyBpZi93aGVuIGF2YWlsYWJsZVxyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBsZXQgcG9zID0gMCwgYyA9IDA7XHJcbiAgICB3aGlsZSAocG9zIDwgYnl0ZXMubGVuZ3RoKSB7XHJcbiAgICAgICAgY29uc3QgYzEgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgaWYgKGMxIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZShjMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMTkxICYmIGMxIDwgMjI0KSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBvdXRbYysrXSA9IFN0cmluZy5mcm9tQ2hhckNvZGUoKChjMSAmIDMxKSA8PCA2KSB8IChjMiAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMxID4gMjM5ICYmIGMxIDwgMzY1KSB7XHJcbiAgICAgICAgICAgIC8vIFN1cnJvZ2F0ZSBQYWlyXHJcbiAgICAgICAgICAgIGNvbnN0IGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBjb25zdCBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgY29uc3QgYzQgPSBieXRlc1twb3MrK107XHJcbiAgICAgICAgICAgIGNvbnN0IHUgPSAoKChjMSAmIDcpIDw8IDE4KSB8ICgoYzIgJiA2MykgPDwgMTIpIHwgKChjMyAmIDYzKSA8PCA2KSB8IChjNCAmIDYzKSkgLVxyXG4gICAgICAgICAgICAgICAgMHgxMDAwMDtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4ZDgwMCArICh1ID4+IDEwKSk7XHJcbiAgICAgICAgICAgIG91dFtjKytdID0gU3RyaW5nLmZyb21DaGFyQ29kZSgweGRjMDAgKyAodSAmIDEwMjMpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGMyID0gYnl0ZXNbcG9zKytdO1xyXG4gICAgICAgICAgICBjb25zdCBjMyA9IGJ5dGVzW3BvcysrXTtcclxuICAgICAgICAgICAgb3V0W2MrK10gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKCgoYzEgJiAxNSkgPDwgMTIpIHwgKChjMiAmIDYzKSA8PCA2KSB8IChjMyAmIDYzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIG91dC5qb2luKCcnKTtcclxufTtcclxuLy8gV2UgZGVmaW5lIGl0IGFzIGFuIG9iamVjdCBsaXRlcmFsIGluc3RlYWQgb2YgYSBjbGFzcyBiZWNhdXNlIGEgY2xhc3MgY29tcGlsZWQgZG93biB0byBlczUgY2FuJ3RcclxuLy8gYmUgdHJlZXNoYWtlZC4gaHR0cHM6Ly9naXRodWIuY29tL3JvbGx1cC9yb2xsdXAvaXNzdWVzLzE2OTFcclxuLy8gU3RhdGljIGxvb2t1cCBtYXBzLCBsYXppbHkgcG9wdWxhdGVkIGJ5IGluaXRfKClcclxuY29uc3QgYmFzZTY0ID0ge1xyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGJ5dGVzIHRvIGNoYXJhY3RlcnMuXHJcbiAgICAgKi9cclxuICAgIGJ5dGVUb0NoYXJNYXBfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXHJcbiAgICAgKi9cclxuICAgIGNoYXJUb0J5dGVNYXBfOiBudWxsLFxyXG4gICAgLyoqXHJcbiAgICAgKiBNYXBzIGJ5dGVzIHRvIHdlYnNhZmUgY2hhcmFjdGVycy5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGJ5dGVUb0NoYXJNYXBXZWJTYWZlXzogbnVsbCxcclxuICAgIC8qKlxyXG4gICAgICogTWFwcyB3ZWJzYWZlIGNoYXJhY3RlcnMgdG8gYnl0ZXMuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBjaGFyVG9CeXRlTWFwV2ViU2FmZV86IG51bGwsXHJcbiAgICAvKipcclxuICAgICAqIE91ciBkZWZhdWx0IGFscGhhYmV0LCBzaGFyZWQgYmV0d2VlblxyXG4gICAgICogRU5DT0RFRF9WQUxTIGFuZCBFTkNPREVEX1ZBTFNfV0VCU0FGRVxyXG4gICAgICovXHJcbiAgICBFTkNPREVEX1ZBTFNfQkFTRTogJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaJyArICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eicgKyAnMDEyMzQ1Njc4OScsXHJcbiAgICAvKipcclxuICAgICAqIE91ciBkZWZhdWx0IGFscGhhYmV0LiBWYWx1ZSA2NCAoPSkgaXMgc3BlY2lhbDsgaXQgbWVhbnMgXCJub3RoaW5nLlwiXHJcbiAgICAgKi9cclxuICAgIGdldCBFTkNPREVEX1ZBTFMoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UgKyAnKy89JztcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIE91ciB3ZWJzYWZlIGFscGhhYmV0LlxyXG4gICAgICovXHJcbiAgICBnZXQgRU5DT0RFRF9WQUxTX1dFQlNBRkUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UgKyAnLV8uJztcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIFdoZXRoZXIgdGhpcyBicm93c2VyIHN1cHBvcnRzIHRoZSBhdG9iIGFuZCBidG9hIGZ1bmN0aW9ucy4gVGhpcyBleHRlbnNpb25cclxuICAgICAqIHN0YXJ0ZWQgYXQgTW96aWxsYSBidXQgaXMgbm93IGltcGxlbWVudGVkIGJ5IG1hbnkgYnJvd3NlcnMuIFdlIHVzZSB0aGVcclxuICAgICAqIEFTU1VNRV8qIHZhcmlhYmxlcyB0byBhdm9pZCBwdWxsaW5nIGluIHRoZSBmdWxsIHVzZXJhZ2VudCBkZXRlY3Rpb24gbGlicmFyeVxyXG4gICAgICogYnV0IHN0aWxsIGFsbG93aW5nIHRoZSBzdGFuZGFyZCBwZXItYnJvd3NlciBjb21waWxhdGlvbnMuXHJcbiAgICAgKlxyXG4gICAgICovXHJcbiAgICBIQVNfTkFUSVZFX1NVUFBPUlQ6IHR5cGVvZiBhdG9iID09PSAnZnVuY3Rpb24nLFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZW5jb2RlIGFuIGFycmF5IG9mIGJ5dGVzLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpbnB1dCBBbiBhcnJheSBvZiBieXRlcyAobnVtYmVycyB3aXRoXHJcbiAgICAgKiAgICAgdmFsdWUgaW4gWzAsIDI1NV0pIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIEJvb2xlYW4gaW5kaWNhdGluZyB3ZSBzaG91bGQgdXNlIHRoZVxyXG4gICAgICogICAgIGFsdGVybmF0aXZlIGFscGhhYmV0LlxyXG4gICAgICogQHJldHVybiBUaGUgYmFzZTY0IGVuY29kZWQgc3RyaW5nLlxyXG4gICAgICovXHJcbiAgICBlbmNvZGVCeXRlQXJyYXkoaW5wdXQsIHdlYlNhZmUpIHtcclxuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkoaW5wdXQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdlbmNvZGVCeXRlQXJyYXkgdGFrZXMgYW4gYXJyYXkgYXMgYSBwYXJhbWV0ZXInKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbml0XygpO1xyXG4gICAgICAgIGNvbnN0IGJ5dGVUb0NoYXJNYXAgPSB3ZWJTYWZlXHJcbiAgICAgICAgICAgID8gdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9cclxuICAgICAgICAgICAgOiB0aGlzLmJ5dGVUb0NoYXJNYXBfO1xyXG4gICAgICAgIGNvbnN0IG91dHB1dCA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXQubGVuZ3RoOyBpICs9IDMpIHtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTEgPSBpbnB1dFtpXTtcclxuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUyID0gaSArIDEgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUyID0gaGF2ZUJ5dGUyID8gaW5wdXRbaSArIDFdIDogMDtcclxuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUzID0gaSArIDIgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUzID0gaGF2ZUJ5dGUzID8gaW5wdXRbaSArIDJdIDogMDtcclxuICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTEgPSBieXRlMSA+PiAyO1xyXG4gICAgICAgICAgICBjb25zdCBvdXRCeXRlMiA9ICgoYnl0ZTEgJiAweDAzKSA8PCA0KSB8IChieXRlMiA+PiA0KTtcclxuICAgICAgICAgICAgbGV0IG91dEJ5dGUzID0gKChieXRlMiAmIDB4MGYpIDw8IDIpIHwgKGJ5dGUzID4+IDYpO1xyXG4gICAgICAgICAgICBsZXQgb3V0Qnl0ZTQgPSBieXRlMyAmIDB4M2Y7XHJcbiAgICAgICAgICAgIGlmICghaGF2ZUJ5dGUzKSB7XHJcbiAgICAgICAgICAgICAgICBvdXRCeXRlNCA9IDY0O1xyXG4gICAgICAgICAgICAgICAgaWYgKCFoYXZlQnl0ZTIpIHtcclxuICAgICAgICAgICAgICAgICAgICBvdXRCeXRlMyA9IDY0O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTFdLCBieXRlVG9DaGFyTWFwW291dEJ5dGUyXSwgYnl0ZVRvQ2hhck1hcFtvdXRCeXRlM10sIGJ5dGVUb0NoYXJNYXBbb3V0Qnl0ZTRdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dC5qb2luKCcnKTtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIEJhc2U2NC1lbmNvZGUgYSBzdHJpbmcuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIGlucHV0IEEgc3RyaW5nIHRvIGVuY29kZS5cclxuICAgICAqIEBwYXJhbSB3ZWJTYWZlIElmIHRydWUsIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIFRoZSBiYXNlNjQgZW5jb2RlZCBzdHJpbmcuXHJcbiAgICAgKi9cclxuICAgIGVuY29kZVN0cmluZyhpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIC8vIFNob3J0Y3V0IGZvciBNb3ppbGxhIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50XHJcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxyXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhd2ViU2FmZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYnRvYShpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmVuY29kZUJ5dGVBcnJheShzdHJpbmdUb0J5dGVBcnJheSQxKGlucHV0KSwgd2ViU2FmZSk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBpbnB1dCB0byBkZWNvZGUuXHJcbiAgICAgKiBAcGFyYW0gd2ViU2FmZSBUcnVlIGlmIHdlIHNob3VsZCB1c2UgdGhlXHJcbiAgICAgKiAgICAgYWx0ZXJuYXRpdmUgYWxwaGFiZXQuXHJcbiAgICAgKiBAcmV0dXJuIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIGRlY29kZWQgdmFsdWUuXHJcbiAgICAgKi9cclxuICAgIGRlY29kZVN0cmluZyhpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIC8vIFNob3J0Y3V0IGZvciBNb3ppbGxhIGJyb3dzZXJzIHRoYXQgaW1wbGVtZW50XHJcbiAgICAgICAgLy8gYSBuYXRpdmUgYmFzZTY0IGVuY29kZXIgaW4gdGhlIGZvcm0gb2YgXCJidG9hL2F0b2JcIlxyXG4gICAgICAgIGlmICh0aGlzLkhBU19OQVRJVkVfU1VQUE9SVCAmJiAhd2ViU2FmZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXRvYihpbnB1dCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBieXRlQXJyYXlUb1N0cmluZyh0aGlzLmRlY29kZVN0cmluZ1RvQnl0ZUFycmF5KGlucHV0LCB3ZWJTYWZlKSk7XHJcbiAgICB9LFxyXG4gICAgLyoqXHJcbiAgICAgKiBCYXNlNjQtZGVjb2RlIGEgc3RyaW5nLlxyXG4gICAgICpcclxuICAgICAqIEluIGJhc2UtNjQgZGVjb2RpbmcsIGdyb3VwcyBvZiBmb3VyIGNoYXJhY3RlcnMgYXJlIGNvbnZlcnRlZCBpbnRvIHRocmVlXHJcbiAgICAgKiBieXRlcy4gIElmIHRoZSBlbmNvZGVyIGRpZCBub3QgYXBwbHkgcGFkZGluZywgdGhlIGlucHV0IGxlbmd0aCBtYXkgbm90XHJcbiAgICAgKiBiZSBhIG11bHRpcGxlIG9mIDQuXHJcbiAgICAgKlxyXG4gICAgICogSW4gdGhpcyBjYXNlLCB0aGUgbGFzdCBncm91cCB3aWxsIGhhdmUgZmV3ZXIgdGhhbiA0IGNoYXJhY3RlcnMsIGFuZFxyXG4gICAgICogcGFkZGluZyB3aWxsIGJlIGluZmVycmVkLiAgSWYgdGhlIGdyb3VwIGhhcyBvbmUgb3IgdHdvIGNoYXJhY3RlcnMsIGl0IGRlY29kZXNcclxuICAgICAqIHRvIG9uZSBieXRlLiAgSWYgdGhlIGdyb3VwIGhhcyB0aHJlZSBjaGFyYWN0ZXJzLCBpdCBkZWNvZGVzIHRvIHR3byBieXRlcy5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaW5wdXQgSW5wdXQgdG8gZGVjb2RlLlxyXG4gICAgICogQHBhcmFtIHdlYlNhZmUgVHJ1ZSBpZiB3ZSBzaG91bGQgdXNlIHRoZSB3ZWItc2FmZSBhbHBoYWJldC5cclxuICAgICAqIEByZXR1cm4gYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSBkZWNvZGVkIHZhbHVlLlxyXG4gICAgICovXHJcbiAgICBkZWNvZGVTdHJpbmdUb0J5dGVBcnJheShpbnB1dCwgd2ViU2FmZSkge1xyXG4gICAgICAgIHRoaXMuaW5pdF8oKTtcclxuICAgICAgICBjb25zdCBjaGFyVG9CeXRlTWFwID0gd2ViU2FmZVxyXG4gICAgICAgICAgICA/IHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfXHJcbiAgICAgICAgICAgIDogdGhpcy5jaGFyVG9CeXRlTWFwXztcclxuICAgICAgICBjb25zdCBvdXRwdXQgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDspIHtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTEgPSBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKyspXTtcclxuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGUyID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTIgPSBoYXZlQnl0ZTIgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiAwO1xyXG4gICAgICAgICAgICArK2k7XHJcbiAgICAgICAgICAgIGNvbnN0IGhhdmVCeXRlMyA9IGkgPCBpbnB1dC5sZW5ndGg7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ5dGUzID0gaGF2ZUJ5dGUzID8gY2hhclRvQnl0ZU1hcFtpbnB1dC5jaGFyQXQoaSldIDogNjQ7XHJcbiAgICAgICAgICAgICsraTtcclxuICAgICAgICAgICAgY29uc3QgaGF2ZUJ5dGU0ID0gaSA8IGlucHV0Lmxlbmd0aDtcclxuICAgICAgICAgICAgY29uc3QgYnl0ZTQgPSBoYXZlQnl0ZTQgPyBjaGFyVG9CeXRlTWFwW2lucHV0LmNoYXJBdChpKV0gOiA2NDtcclxuICAgICAgICAgICAgKytpO1xyXG4gICAgICAgICAgICBpZiAoYnl0ZTEgPT0gbnVsbCB8fCBieXRlMiA9PSBudWxsIHx8IGJ5dGUzID09IG51bGwgfHwgYnl0ZTQgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IERlY29kZUJhc2U2NFN0cmluZ0Vycm9yKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTEgPSAoYnl0ZTEgPDwgMikgfCAoYnl0ZTIgPj4gNCk7XHJcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKG91dEJ5dGUxKTtcclxuICAgICAgICAgICAgaWYgKGJ5dGUzICE9PSA2NCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTIgPSAoKGJ5dGUyIDw8IDQpICYgMHhmMCkgfCAoYnl0ZTMgPj4gMik7XHJcbiAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMik7XHJcbiAgICAgICAgICAgICAgICBpZiAoYnl0ZTQgIT09IDY0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0Qnl0ZTMgPSAoKGJ5dGUzIDw8IDYpICYgMHhjMCkgfCBieXRlNDtcclxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChvdXRCeXRlMyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcclxuICAgIH0sXHJcbiAgICAvKipcclxuICAgICAqIExhenkgc3RhdGljIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uLiBDYWxsZWQgYmVmb3JlXHJcbiAgICAgKiBhY2Nlc3NpbmcgYW55IG9mIHRoZSBzdGF0aWMgbWFwIHZhcmlhYmxlcy5cclxuICAgICAqIEBwcml2YXRlXHJcbiAgICAgKi9cclxuICAgIGluaXRfKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5ieXRlVG9DaGFyTWFwXykge1xyXG4gICAgICAgICAgICB0aGlzLmJ5dGVUb0NoYXJNYXBfID0ge307XHJcbiAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwV2ViU2FmZV8gPSB7fTtcclxuICAgICAgICAgICAgLy8gV2Ugd2FudCBxdWljayBtYXBwaW5ncyBiYWNrIGFuZCBmb3J0aCwgc28gd2UgcHJlY29tcHV0ZSB0d28gbWFwcy5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLkVOQ09ERURfVkFMUy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwX1tpXSA9IHRoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcF9bdGhpcy5ieXRlVG9DaGFyTWFwX1tpXV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ieXRlVG9DaGFyTWFwV2ViU2FmZV9baV0gPSB0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuYnl0ZVRvQ2hhck1hcFdlYlNhZmVfW2ldXSA9IGk7XHJcbiAgICAgICAgICAgICAgICAvLyBCZSBmb3JnaXZpbmcgd2hlbiBkZWNvZGluZyBhbmQgY29ycmVjdGx5IGRlY29kZSBib3RoIGVuY29kaW5ncy5cclxuICAgICAgICAgICAgICAgIGlmIChpID49IHRoaXMuRU5DT0RFRF9WQUxTX0JBU0UubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFyVG9CeXRlTWFwX1t0aGlzLkVOQ09ERURfVkFMU19XRUJTQUZFLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhclRvQnl0ZU1hcFdlYlNhZmVfW3RoaXMuRU5DT0RFRF9WQUxTLmNoYXJBdChpKV0gPSBpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogQW4gZXJyb3IgZW5jb3VudGVyZWQgd2hpbGUgZGVjb2RpbmcgYmFzZTY0IHN0cmluZy5cclxuICovXHJcbmNsYXNzIERlY29kZUJhc2U2NFN0cmluZ0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKTtcclxuICAgICAgICB0aGlzLm5hbWUgPSAnRGVjb2RlQmFzZTY0U3RyaW5nRXJyb3InO1xyXG4gICAgfVxyXG59XHJcbi8qKlxyXG4gKiBVUkwtc2FmZSBiYXNlNjQgZW5jb2RpbmdcclxuICovXHJcbmNvbnN0IGJhc2U2NEVuY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIGNvbnN0IHV0ZjhCeXRlcyA9IHN0cmluZ1RvQnl0ZUFycmF5JDEoc3RyKTtcclxuICAgIHJldHVybiBiYXNlNjQuZW5jb2RlQnl0ZUFycmF5KHV0ZjhCeXRlcywgdHJ1ZSk7XHJcbn07XHJcbi8qKlxyXG4gKiBVUkwtc2FmZSBiYXNlNjQgZW5jb2RpbmcgKHdpdGhvdXQgXCIuXCIgcGFkZGluZyBpbiB0aGUgZW5kKS5cclxuICogZS5nLiBVc2VkIGluIEpTT04gV2ViIFRva2VuIChKV1QpIHBhcnRzLlxyXG4gKi9cclxuY29uc3QgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcgPSBmdW5jdGlvbiAoc3RyKSB7XHJcbiAgICAvLyBVc2UgYmFzZTY0dXJsIGVuY29kaW5nIGFuZCByZW1vdmUgcGFkZGluZyBpbiB0aGUgZW5kIChkb3QgY2hhcmFjdGVycykuXHJcbiAgICByZXR1cm4gYmFzZTY0RW5jb2RlKHN0cikucmVwbGFjZSgvXFwuL2csICcnKTtcclxufTtcclxuLyoqXHJcbiAqIFVSTC1zYWZlIGJhc2U2NCBkZWNvZGluZ1xyXG4gKlxyXG4gKiBOT1RFOiBETyBOT1QgdXNlIHRoZSBnbG9iYWwgYXRvYigpIGZ1bmN0aW9uIC0gaXQgZG9lcyBOT1Qgc3VwcG9ydCB0aGVcclxuICogYmFzZTY0VXJsIHZhcmlhbnQgZW5jb2RpbmcuXHJcbiAqXHJcbiAqIEBwYXJhbSBzdHIgVG8gYmUgZGVjb2RlZFxyXG4gKiBAcmV0dXJuIERlY29kZWQgcmVzdWx0LCBpZiBwb3NzaWJsZVxyXG4gKi9cclxuY29uc3QgYmFzZTY0RGVjb2RlID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICByZXR1cm4gYmFzZTY0LmRlY29kZVN0cmluZyhzdHIsIHRydWUpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdiYXNlNjREZWNvZGUgZmFpbGVkOiAnLCBlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRG8gYSBkZWVwLWNvcHkgb2YgYmFzaWMgSmF2YVNjcmlwdCBPYmplY3RzIG9yIEFycmF5cy5cclxuICovXHJcbmZ1bmN0aW9uIGRlZXBDb3B5KHZhbHVlKSB7XHJcbiAgICByZXR1cm4gZGVlcEV4dGVuZCh1bmRlZmluZWQsIHZhbHVlKTtcclxufVxyXG4vKipcclxuICogQ29weSBwcm9wZXJ0aWVzIGZyb20gc291cmNlIHRvIHRhcmdldCAocmVjdXJzaXZlbHkgYWxsb3dzIGV4dGVuc2lvblxyXG4gKiBvZiBPYmplY3RzIGFuZCBBcnJheXMpLiAgU2NhbGFyIHZhbHVlcyBpbiB0aGUgdGFyZ2V0IGFyZSBvdmVyLXdyaXR0ZW4uXHJcbiAqIElmIHRhcmdldCBpcyB1bmRlZmluZWQsIGFuIG9iamVjdCBvZiB0aGUgYXBwcm9wcmlhdGUgdHlwZSB3aWxsIGJlIGNyZWF0ZWRcclxuICogKGFuZCByZXR1cm5lZCkuXHJcbiAqXHJcbiAqIFdlIHJlY3Vyc2l2ZWx5IGNvcHkgYWxsIGNoaWxkIHByb3BlcnRpZXMgb2YgcGxhaW4gT2JqZWN0cyBpbiB0aGUgc291cmNlLSBzb1xyXG4gKiB0aGF0IG5hbWVzcGFjZS0gbGlrZSBkaWN0aW9uYXJpZXMgYXJlIG1lcmdlZC5cclxuICpcclxuICogTm90ZSB0aGF0IHRoZSB0YXJnZXQgY2FuIGJlIGEgZnVuY3Rpb24sIGluIHdoaWNoIGNhc2UgdGhlIHByb3BlcnRpZXMgaW5cclxuICogdGhlIHNvdXJjZSBPYmplY3QgYXJlIGNvcGllZCBvbnRvIGl0IGFzIHN0YXRpYyBwcm9wZXJ0aWVzIG9mIHRoZSBGdW5jdGlvbi5cclxuICpcclxuICogTm90ZTogd2UgZG9uJ3QgbWVyZ2UgX19wcm90b19fIHRvIHByZXZlbnQgcHJvdG90eXBlIHBvbGx1dGlvblxyXG4gKi9cclxuZnVuY3Rpb24gZGVlcEV4dGVuZCh0YXJnZXQsIHNvdXJjZSkge1xyXG4gICAgaWYgKCEoc291cmNlIGluc3RhbmNlb2YgT2JqZWN0KSkge1xyXG4gICAgICAgIHJldHVybiBzb3VyY2U7XHJcbiAgICB9XHJcbiAgICBzd2l0Y2ggKHNvdXJjZS5jb25zdHJ1Y3Rvcikge1xyXG4gICAgICAgIGNhc2UgRGF0ZTpcclxuICAgICAgICAgICAgLy8gVHJlYXQgRGF0ZXMgbGlrZSBzY2FsYXJzOyBpZiB0aGUgdGFyZ2V0IGRhdGUgb2JqZWN0IGhhZCBhbnkgY2hpbGRcclxuICAgICAgICAgICAgLy8gcHJvcGVydGllcyAtIHRoZXkgd2lsbCBiZSBsb3N0IVxyXG4gICAgICAgICAgICBjb25zdCBkYXRlVmFsdWUgPSBzb3VyY2U7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgRGF0ZShkYXRlVmFsdWUuZ2V0VGltZSgpKTtcclxuICAgICAgICBjYXNlIE9iamVjdDpcclxuICAgICAgICAgICAgaWYgKHRhcmdldCA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQgPSB7fTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgICAgICBjYXNlIEFycmF5OlxyXG4gICAgICAgICAgICAvLyBBbHdheXMgY29weSB0aGUgYXJyYXkgc291cmNlIGFuZCBvdmVyd3JpdGUgdGhlIHRhcmdldC5cclxuICAgICAgICAgICAgdGFyZ2V0ID0gW107XHJcbiAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIC8vIE5vdCBhIHBsYWluIE9iamVjdCAtIHRyZWF0IGl0IGFzIGEgc2NhbGFyLlxyXG4gICAgICAgICAgICByZXR1cm4gc291cmNlO1xyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBwcm9wIGluIHNvdXJjZSkge1xyXG4gICAgICAgIC8vIHVzZSBpc1ZhbGlkS2V5IHRvIGd1YXJkIGFnYWluc3QgcHJvdG90eXBlIHBvbGx1dGlvbi4gU2VlIGh0dHBzOi8vc255ay5pby92dWxuL1NOWUstSlMtTE9EQVNILTQ1MDIwMlxyXG4gICAgICAgIGlmICghc291cmNlLmhhc093blByb3BlcnR5KHByb3ApIHx8ICFpc1ZhbGlkS2V5KHByb3ApKSB7XHJcbiAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0YXJnZXRbcHJvcF0gPSBkZWVwRXh0ZW5kKHRhcmdldFtwcm9wXSwgc291cmNlW3Byb3BdKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0YXJnZXQ7XHJcbn1cclxuZnVuY3Rpb24gaXNWYWxpZEtleShrZXkpIHtcclxuICAgIHJldHVybiBrZXkgIT09ICdfX3Byb3RvX18nO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBQb2x5ZmlsbCBmb3IgYGdsb2JhbFRoaXNgIG9iamVjdC5cclxuICogQHJldHVybnMgdGhlIGBnbG9iYWxUaGlzYCBvYmplY3QgZm9yIHRoZSBnaXZlbiBlbnZpcm9ubWVudC5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0R2xvYmFsKCkge1xyXG4gICAgaWYgKHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBzZWxmO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdztcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiBnbG9iYWw7XHJcbiAgICB9XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBsb2NhdGUgZ2xvYmFsIG9iamVjdC4nKTtcclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBnZXREZWZhdWx0c0Zyb21HbG9iYWwgPSAoKSA9PiBnZXRHbG9iYWwoKS5fX0ZJUkVCQVNFX0RFRkFVTFRTX187XHJcbi8qKlxyXG4gKiBBdHRlbXB0IHRvIHJlYWQgZGVmYXVsdHMgZnJvbSBhIEpTT04gc3RyaW5nIHByb3ZpZGVkIHRvXHJcbiAqIHByb2Nlc3MoLillbnYoLilfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb3IgYSBKU09OIGZpbGUgd2hvc2UgcGF0aCBpcyBpblxyXG4gKiBwcm9jZXNzKC4pZW52KC4pX19GSVJFQkFTRV9ERUZBVUxUU19QQVRIX19cclxuICogVGhlIGRvdHMgYXJlIGluIHBhcmVucyBiZWNhdXNlIGNlcnRhaW4gY29tcGlsZXJzIChWaXRlPykgY2Fubm90XHJcbiAqIGhhbmRsZSBzZWVpbmcgdGhhdCB2YXJpYWJsZSBpbiBjb21tZW50cy5cclxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1qcy1zZGsvaXNzdWVzLzY4MzhcclxuICovXHJcbmNvbnN0IGdldERlZmF1bHRzRnJvbUVudlZhcmlhYmxlID0gKCkgPT4ge1xyXG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzID09PSAndW5kZWZpbmVkJyB8fCB0eXBlb2YgcHJvY2Vzcy5lbnYgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGVmYXVsdHNKc29uU3RyaW5nID0gcHJvY2Vzcy5lbnYuX19GSVJFQkFTRV9ERUZBVUxUU19fO1xyXG4gICAgaWYgKGRlZmF1bHRzSnNvblN0cmluZykge1xyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKGRlZmF1bHRzSnNvblN0cmluZyk7XHJcbiAgICB9XHJcbn07XHJcbmNvbnN0IGdldERlZmF1bHRzRnJvbUNvb2tpZSA9ICgpID0+IHtcclxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgPT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgbGV0IG1hdGNoO1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBtYXRjaCA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaCgvX19GSVJFQkFTRV9ERUZBVUxUU19fPShbXjtdKykvKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgLy8gU29tZSBlbnZpcm9ubWVudHMgc3VjaCBhcyBBbmd1bGFyIFVuaXZlcnNhbCBTU1IgaGF2ZSBhXHJcbiAgICAgICAgLy8gYGRvY3VtZW50YCBvYmplY3QgYnV0IGVycm9yIG9uIGFjY2Vzc2luZyBgZG9jdW1lbnQuY29va2llYC5cclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBjb25zdCBkZWNvZGVkID0gbWF0Y2ggJiYgYmFzZTY0RGVjb2RlKG1hdGNoWzFdKTtcclxuICAgIHJldHVybiBkZWNvZGVkICYmIEpTT04ucGFyc2UoZGVjb2RlZCk7XHJcbn07XHJcbi8qKlxyXG4gKiBHZXQgdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QuIEl0IGNoZWNrcyBpbiBvcmRlcjpcclxuICogKDEpIGlmIHN1Y2ggYW4gb2JqZWN0IGV4aXN0cyBhcyBhIHByb3BlcnR5IG9mIGBnbG9iYWxUaGlzYFxyXG4gKiAoMikgaWYgc3VjaCBhbiBvYmplY3Qgd2FzIHByb3ZpZGVkIG9uIGEgc2hlbGwgZW52aXJvbm1lbnQgdmFyaWFibGVcclxuICogKDMpIGlmIHN1Y2ggYW4gb2JqZWN0IGV4aXN0cyBpbiBhIGNvb2tpZVxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBnZXREZWZhdWx0cyA9ICgpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIChnZXREZWZhdWx0c0Zyb21HbG9iYWwoKSB8fFxyXG4gICAgICAgICAgICBnZXREZWZhdWx0c0Zyb21FbnZWYXJpYWJsZSgpIHx8XHJcbiAgICAgICAgICAgIGdldERlZmF1bHRzRnJvbUNvb2tpZSgpKTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2F0Y2gtYWxsIGZvciBiZWluZyB1bmFibGUgdG8gZ2V0IF9fRklSRUJBU0VfREVGQVVMVFNfXyBkdWVcclxuICAgICAgICAgKiB0byBhbnkgZW52aXJvbm1lbnQgY2FzZSB3ZSBoYXZlIG5vdCBhY2NvdW50ZWQgZm9yLiBMb2cgdG9cclxuICAgICAgICAgKiBpbmZvIGluc3RlYWQgb2Ygc3dhbGxvd2luZyBzbyB3ZSBjYW4gZmluZCB0aGVzZSB1bmtub3duIGNhc2VzXHJcbiAgICAgICAgICogYW5kIGFkZCBwYXRocyBmb3IgdGhlbSBpZiBuZWVkZWQuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgY29uc29sZS5pbmZvKGBVbmFibGUgdG8gZ2V0IF9fRklSRUJBU0VfREVGQVVMVFNfXyBkdWUgdG86ICR7ZX1gKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbn07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGVtdWxhdG9yIGhvc3Qgc3RvcmVkIGluIHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0XHJcbiAqIGZvciB0aGUgZ2l2ZW4gcHJvZHVjdC5cclxuICogQHJldHVybnMgYSBVUkwgaG9zdCBmb3JtYXR0ZWQgbGlrZSBgMTI3LjAuMC4xOjk5OTlgIG9yIGBbOjoxXTo0MDAwYCBpZiBhdmFpbGFibGVcclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCA9IChwcm9kdWN0TmFtZSkgPT4geyB2YXIgX2EsIF9iOyByZXR1cm4gKF9iID0gKF9hID0gZ2V0RGVmYXVsdHMoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmVtdWxhdG9ySG9zdHMpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYltwcm9kdWN0TmFtZV07IH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGVtdWxhdG9yIGhvc3RuYW1lIGFuZCBwb3J0IHN0b3JlZCBpbiB0aGUgX19GSVJFQkFTRV9ERUZBVUxUU19fIG9iamVjdFxyXG4gKiBmb3IgdGhlIGdpdmVuIHByb2R1Y3QuXHJcbiAqIEByZXR1cm5zIGEgcGFpciBvZiBob3N0bmFtZSBhbmQgcG9ydCBsaWtlIGBbXCI6OjFcIiwgNDAwMF1gIGlmIGF2YWlsYWJsZVxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQgPSAocHJvZHVjdE5hbWUpID0+IHtcclxuICAgIGNvbnN0IGhvc3QgPSBnZXREZWZhdWx0RW11bGF0b3JIb3N0KHByb2R1Y3ROYW1lKTtcclxuICAgIGlmICghaG9zdCkge1xyXG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgICBjb25zdCBzZXBhcmF0b3JJbmRleCA9IGhvc3QubGFzdEluZGV4T2YoJzonKTsgLy8gRmluZGluZyB0aGUgbGFzdCBzaW5jZSBJUHY2IGFkZHIgYWxzbyBoYXMgY29sb25zLlxyXG4gICAgaWYgKHNlcGFyYXRvckluZGV4IDw9IDAgfHwgc2VwYXJhdG9ySW5kZXggKyAxID09PSBob3N0Lmxlbmd0aCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBob3N0ICR7aG9zdH0gd2l0aCBubyBzZXBhcmF0ZSBob3N0bmFtZSBhbmQgcG9ydCFgKTtcclxuICAgIH1cclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHNcclxuICAgIGNvbnN0IHBvcnQgPSBwYXJzZUludChob3N0LnN1YnN0cmluZyhzZXBhcmF0b3JJbmRleCArIDEpLCAxMCk7XHJcbiAgICBpZiAoaG9zdFswXSA9PT0gJ1snKSB7XHJcbiAgICAgICAgLy8gQnJhY2tldC1xdW90ZWQgYFtpcHY2YWRkcl06cG9ydGAgPT4gcmV0dXJuIFwiaXB2NmFkZHJcIiAod2l0aG91dCBicmFja2V0cykuXHJcbiAgICAgICAgcmV0dXJuIFtob3N0LnN1YnN0cmluZygxLCBzZXBhcmF0b3JJbmRleCAtIDEpLCBwb3J0XTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiBbaG9zdC5zdWJzdHJpbmcoMCwgc2VwYXJhdG9ySW5kZXgpLCBwb3J0XTtcclxuICAgIH1cclxufTtcclxuLyoqXHJcbiAqIFJldHVybnMgRmlyZWJhc2UgYXBwIGNvbmZpZyBzdG9yZWQgaW4gdGhlIF9fRklSRUJBU0VfREVGQVVMVFNfXyBvYmplY3QuXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmNvbnN0IGdldERlZmF1bHRBcHBDb25maWcgPSAoKSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IGdldERlZmF1bHRzKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jb25maWc7IH07XHJcbi8qKlxyXG4gKiBSZXR1cm5zIGFuIGV4cGVyaW1lbnRhbCBzZXR0aW5nIG9uIHRoZSBfX0ZJUkVCQVNFX0RFRkFVTFRTX18gb2JqZWN0IChwcm9wZXJ0aWVzXHJcbiAqIHByZWZpeGVkIGJ5IFwiX1wiKVxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBnZXRFeHBlcmltZW50YWxTZXR0aW5nID0gKG5hbWUpID0+IHsgdmFyIF9hOyByZXR1cm4gKF9hID0gZ2V0RGVmYXVsdHMoKSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hW2BfJHtuYW1lfWBdOyB9O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBEZWZlcnJlZCB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICB0aGlzLnJlamVjdCA9ICgpID0+IHsgfTtcclxuICAgICAgICB0aGlzLnJlc29sdmUgPSAoKSA9PiB7IH07XHJcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICB0aGlzLnJlamVjdCA9IHJlamVjdDtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogT3VyIEFQSSBpbnRlcm5hbHMgYXJlIG5vdCBwcm9taXNlaWZpZWQgYW5kIGNhbm5vdCBiZWNhdXNlIG91ciBjYWxsYmFjayBBUElzIGhhdmUgc3VidGxlIGV4cGVjdGF0aW9ucyBhcm91bmRcclxuICAgICAqIGludm9raW5nIHByb21pc2VzIGlubGluZSwgd2hpY2ggUHJvbWlzZXMgYXJlIGZvcmJpZGRlbiB0byBkby4gVGhpcyBtZXRob2QgYWNjZXB0cyBhbiBvcHRpb25hbCBub2RlLXN0eWxlIGNhbGxiYWNrXHJcbiAgICAgKiBhbmQgcmV0dXJucyBhIG5vZGUtc3R5bGUgY2FsbGJhY2sgd2hpY2ggd2lsbCByZXNvbHZlIG9yIHJlamVjdCB0aGUgRGVmZXJyZWQncyBwcm9taXNlLlxyXG4gICAgICovXHJcbiAgICB3cmFwQ2FsbGJhY2soY2FsbGJhY2spIHtcclxuICAgICAgICByZXR1cm4gKGVycm9yLCB2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVqZWN0KGVycm9yKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucmVzb2x2ZSh2YWx1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayA9PT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgLy8gQXR0YWNoaW5nIG5vb3AgaGFuZGxlciBqdXN0IGluIGNhc2UgZGV2ZWxvcGVyIHdhc24ndCBleHBlY3RpbmdcclxuICAgICAgICAgICAgICAgIC8vIHByb21pc2VzXHJcbiAgICAgICAgICAgICAgICB0aGlzLnByb21pc2UuY2F0Y2goKCkgPT4geyB9KTtcclxuICAgICAgICAgICAgICAgIC8vIFNvbWUgb2Ygb3VyIGNhbGxiYWNrcyBkb24ndCBleHBlY3QgYSB2YWx1ZSBhbmQgb3VyIG93biB0ZXN0c1xyXG4gICAgICAgICAgICAgICAgLy8gYXNzZXJ0IHRoYXQgdGhlIHBhcmFtZXRlciBsZW5ndGggaXMgMVxyXG4gICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKGVycm9yLCB2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZU1vY2tVc2VyVG9rZW4odG9rZW4sIHByb2plY3RJZCkge1xyXG4gICAgaWYgKHRva2VuLnVpZCkge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIFwidWlkXCIgZmllbGQgaXMgbm8gbG9uZ2VyIHN1cHBvcnRlZCBieSBtb2NrVXNlclRva2VuLiBQbGVhc2UgdXNlIFwic3ViXCIgaW5zdGVhZCBmb3IgRmlyZWJhc2UgQXV0aCBVc2VyIElELicpO1xyXG4gICAgfVxyXG4gICAgLy8gVW5zZWN1cmVkIEpXVHMgdXNlIFwibm9uZVwiIGFzIHRoZSBhbGdvcml0aG0uXHJcbiAgICBjb25zdCBoZWFkZXIgPSB7XHJcbiAgICAgICAgYWxnOiAnbm9uZScsXHJcbiAgICAgICAgdHlwZTogJ0pXVCdcclxuICAgIH07XHJcbiAgICBjb25zdCBwcm9qZWN0ID0gcHJvamVjdElkIHx8ICdkZW1vLXByb2plY3QnO1xyXG4gICAgY29uc3QgaWF0ID0gdG9rZW4uaWF0IHx8IDA7XHJcbiAgICBjb25zdCBzdWIgPSB0b2tlbi5zdWIgfHwgdG9rZW4udXNlcl9pZDtcclxuICAgIGlmICghc3ViKSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwibW9ja1VzZXJUb2tlbiBtdXN0IGNvbnRhaW4gJ3N1Yicgb3IgJ3VzZXJfaWQnIGZpZWxkIVwiKTtcclxuICAgIH1cclxuICAgIGNvbnN0IHBheWxvYWQgPSBPYmplY3QuYXNzaWduKHsgXHJcbiAgICAgICAgLy8gU2V0IGFsbCByZXF1aXJlZCBmaWVsZHMgdG8gZGVjZW50IGRlZmF1bHRzXHJcbiAgICAgICAgaXNzOiBgaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tLyR7cHJvamVjdH1gLCBhdWQ6IHByb2plY3QsIGlhdCwgZXhwOiBpYXQgKyAzNjAwLCBhdXRoX3RpbWU6IGlhdCwgc3ViLCB1c2VyX2lkOiBzdWIsIGZpcmViYXNlOiB7XHJcbiAgICAgICAgICAgIHNpZ25faW5fcHJvdmlkZXI6ICdjdXN0b20nLFxyXG4gICAgICAgICAgICBpZGVudGl0aWVzOiB7fVxyXG4gICAgICAgIH0gfSwgdG9rZW4pO1xyXG4gICAgLy8gVW5zZWN1cmVkIEpXVHMgdXNlIHRoZSBlbXB0eSBzdHJpbmcgYXMgYSBzaWduYXR1cmUuXHJcbiAgICBjb25zdCBzaWduYXR1cmUgPSAnJztcclxuICAgIHJldHVybiBbXHJcbiAgICAgICAgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkoaGVhZGVyKSksXHJcbiAgICAgICAgYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkpLFxyXG4gICAgICAgIHNpZ25hdHVyZVxyXG4gICAgXS5qb2luKCcuJyk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJldHVybnMgbmF2aWdhdG9yLnVzZXJBZ2VudCBzdHJpbmcgb3IgJycgaWYgaXQncyBub3QgZGVmaW5lZC5cclxuICogQHJldHVybiB1c2VyIGFnZW50IHN0cmluZ1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0VUEoKSB7XHJcbiAgICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiZcclxuICAgICAgICB0eXBlb2YgbmF2aWdhdG9yWyd1c2VyQWdlbnQnXSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICByZXR1cm4gbmF2aWdhdG9yWyd1c2VyQWdlbnQnXTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHJldHVybiAnJztcclxuICAgIH1cclxufVxyXG4vKipcclxuICogRGV0ZWN0IENvcmRvdmEgLyBQaG9uZUdhcCAvIElvbmljIGZyYW1ld29ya3Mgb24gYSBtb2JpbGUgZGV2aWNlLlxyXG4gKlxyXG4gKiBEZWxpYmVyYXRlbHkgZG9lcyBub3QgcmVseSBvbiBjaGVja2luZyBgZmlsZTovL2AgVVJMcyAoYXMgdGhpcyBmYWlscyBQaG9uZUdhcFxyXG4gKiBpbiB0aGUgUmlwcGxlIGVtdWxhdG9yKSBub3IgQ29yZG92YSBgb25EZXZpY2VSZWFkeWAsIHdoaWNoIHdvdWxkIG5vcm1hbGx5XHJcbiAqIHdhaXQgZm9yIGEgY2FsbGJhY2suXHJcbiAqL1xyXG5mdW5jdGlvbiBpc01vYmlsZUNvcmRvdmEoKSB7XHJcbiAgICByZXR1cm4gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXHJcbiAgICAgICAgLy8gQHRzLWlnbm9yZSBTZXR0aW5nIHVwIGFuIGJyb2FkbHkgYXBwbGljYWJsZSBpbmRleCBzaWduYXR1cmUgZm9yIFdpbmRvd1xyXG4gICAgICAgIC8vIGp1c3QgdG8gZGVhbCB3aXRoIHRoaXMgY2FzZSB3b3VsZCBwcm9iYWJseSBiZSBhIGJhZCBpZGVhLlxyXG4gICAgICAgICEhKHdpbmRvd1snY29yZG92YSddIHx8IHdpbmRvd1sncGhvbmVnYXAnXSB8fCB3aW5kb3dbJ1Bob25lR2FwJ10pICYmXHJcbiAgICAgICAgL2lvc3xpcGhvbmV8aXBvZHxpcGFkfGFuZHJvaWR8YmxhY2tiZXJyeXxpZW1vYmlsZS9pLnRlc3QoZ2V0VUEoKSkpO1xyXG59XHJcbi8qKlxyXG4gKiBEZXRlY3QgTm9kZS5qcy5cclxuICpcclxuICogQHJldHVybiB0cnVlIGlmIE5vZGUuanMgZW52aXJvbm1lbnQgaXMgZGV0ZWN0ZWQgb3Igc3BlY2lmaWVkLlxyXG4gKi9cclxuLy8gTm9kZSBkZXRlY3Rpb24gbG9naWMgZnJvbTogaHR0cHM6Ly9naXRodWIuY29tL2lsaWFrYW4vZGV0ZWN0LW5vZGUvXHJcbmZ1bmN0aW9uIGlzTm9kZSgpIHtcclxuICAgIHZhciBfYTtcclxuICAgIGNvbnN0IGZvcmNlRW52aXJvbm1lbnQgPSAoX2EgPSBnZXREZWZhdWx0cygpKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZm9yY2VFbnZpcm9ubWVudDtcclxuICAgIGlmIChmb3JjZUVudmlyb25tZW50ID09PSAnbm9kZScpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKGZvcmNlRW52aXJvbm1lbnQgPT09ICdicm93c2VyJykge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIChPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoZ2xvYmFsLnByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXScpO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIERldGVjdCBCcm93c2VyIEVudmlyb25tZW50XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0Jyb3dzZXIoKSB7XHJcbiAgICByZXR1cm4gdHlwZW9mIHNlbGYgPT09ICdvYmplY3QnICYmIHNlbGYuc2VsZiA9PT0gc2VsZjtcclxufVxyXG5mdW5jdGlvbiBpc0Jyb3dzZXJFeHRlbnNpb24oKSB7XHJcbiAgICBjb25zdCBydW50aW1lID0gdHlwZW9mIGNocm9tZSA9PT0gJ29iamVjdCdcclxuICAgICAgICA/IGNocm9tZS5ydW50aW1lXHJcbiAgICAgICAgOiB0eXBlb2YgYnJvd3NlciA9PT0gJ29iamVjdCdcclxuICAgICAgICAgICAgPyBicm93c2VyLnJ1bnRpbWVcclxuICAgICAgICAgICAgOiB1bmRlZmluZWQ7XHJcbiAgICByZXR1cm4gdHlwZW9mIHJ1bnRpbWUgPT09ICdvYmplY3QnICYmIHJ1bnRpbWUuaWQgIT09IHVuZGVmaW5lZDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IFJlYWN0IE5hdGl2ZS5cclxuICpcclxuICogQHJldHVybiB0cnVlIGlmIFJlYWN0TmF0aXZlIGVudmlyb25tZW50IGlzIGRldGVjdGVkLlxyXG4gKi9cclxuZnVuY3Rpb24gaXNSZWFjdE5hdGl2ZSgpIHtcclxuICAgIHJldHVybiAodHlwZW9mIG5hdmlnYXRvciA9PT0gJ29iamVjdCcgJiYgbmF2aWdhdG9yWydwcm9kdWN0J10gPT09ICdSZWFjdE5hdGl2ZScpO1xyXG59XHJcbi8qKiBEZXRlY3RzIEVsZWN0cm9uIGFwcHMuICovXHJcbmZ1bmN0aW9uIGlzRWxlY3Ryb24oKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdFbGVjdHJvbi8nKSA+PSAwO1xyXG59XHJcbi8qKiBEZXRlY3RzIEludGVybmV0IEV4cGxvcmVyLiAqL1xyXG5mdW5jdGlvbiBpc0lFKCkge1xyXG4gICAgY29uc3QgdWEgPSBnZXRVQSgpO1xyXG4gICAgcmV0dXJuIHVhLmluZGV4T2YoJ01TSUUgJykgPj0gMCB8fCB1YS5pbmRleE9mKCdUcmlkZW50LycpID49IDA7XHJcbn1cclxuLyoqIERldGVjdHMgVW5pdmVyc2FsIFdpbmRvd3MgUGxhdGZvcm0gYXBwcy4gKi9cclxuZnVuY3Rpb24gaXNVV1AoKSB7XHJcbiAgICByZXR1cm4gZ2V0VUEoKS5pbmRleE9mKCdNU0FwcEhvc3QvJykgPj0gMDtcclxufVxyXG4vKipcclxuICogRGV0ZWN0IHdoZXRoZXIgdGhlIGN1cnJlbnQgU0RLIGJ1aWxkIGlzIHRoZSBOb2RlIHZlcnNpb24uXHJcbiAqXHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpdCdzIHRoZSBOb2RlIFNESyBidWlsZC5cclxuICovXHJcbmZ1bmN0aW9uIGlzTm9kZVNkaygpIHtcclxuICAgIHJldHVybiBDT05TVEFOVFMuTk9ERV9DTElFTlQgPT09IHRydWUgfHwgQ09OU1RBTlRTLk5PREVfQURNSU4gPT09IHRydWU7XHJcbn1cclxuLyoqIFJldHVybnMgdHJ1ZSBpZiB3ZSBhcmUgcnVubmluZyBpbiBTYWZhcmkuICovXHJcbmZ1bmN0aW9uIGlzU2FmYXJpKCkge1xyXG4gICAgcmV0dXJuICghaXNOb2RlKCkgJiZcclxuICAgICAgICBuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdTYWZhcmknKSAmJlxyXG4gICAgICAgICFuYXZpZ2F0b3IudXNlckFnZW50LmluY2x1ZGVzKCdDaHJvbWUnKSk7XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqIEByZXR1cm4gdHJ1ZSBpZiBpbmRleGVkREIgaXMgc3VwcG9ydGVkIGJ5IGN1cnJlbnQgYnJvd3Nlci9zZXJ2aWNlIHdvcmtlciBjb250ZXh0XHJcbiAqL1xyXG5mdW5jdGlvbiBpc0luZGV4ZWREQkF2YWlsYWJsZSgpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBpbmRleGVkREIgPT09ICdvYmplY3QnO1xyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqIFRoaXMgbWV0aG9kIHZhbGlkYXRlcyBicm93c2VyL3N3IGNvbnRleHQgZm9yIGluZGV4ZWREQiBieSBvcGVuaW5nIGEgZHVtbXkgaW5kZXhlZERCIGRhdGFiYXNlIGFuZCByZWplY3RcclxuICogaWYgZXJyb3JzIG9jY3VyIGR1cmluZyB0aGUgZGF0YWJhc2Ugb3BlbiBvcGVyYXRpb24uXHJcbiAqXHJcbiAqIEB0aHJvd3MgZXhjZXB0aW9uIGlmIGN1cnJlbnQgYnJvd3Nlci9zdyBjb250ZXh0IGNhbid0IHJ1biBpZGIub3BlbiAoZXg6IFNhZmFyaSBpZnJhbWUsIEZpcmVmb3hcclxuICogcHJpdmF0ZSBicm93c2luZylcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlSW5kZXhlZERCT3BlbmFibGUoKSB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGxldCBwcmVFeGlzdCA9IHRydWU7XHJcbiAgICAgICAgICAgIGNvbnN0IERCX0NIRUNLX05BTUUgPSAndmFsaWRhdGUtYnJvd3Nlci1jb250ZXh0LWZvci1pbmRleGVkZGItYW5hbHl0aWNzLW1vZHVsZSc7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlcXVlc3QgPSBzZWxmLmluZGV4ZWREQi5vcGVuKERCX0NIRUNLX05BTUUpO1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlcXVlc3QucmVzdWx0LmNsb3NlKCk7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWxldGUgZGF0YWJhc2Ugb25seSB3aGVuIGl0IGRvZXNuJ3QgcHJlLWV4aXN0XHJcbiAgICAgICAgICAgICAgICBpZiAoIXByZUV4aXN0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pbmRleGVkREIuZGVsZXRlRGF0YWJhc2UoREJfQ0hFQ0tfTkFNRSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHByZUV4aXN0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJlcXVlc3Qub25lcnJvciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHZhciBfYTtcclxuICAgICAgICAgICAgICAgIHJlamVjdCgoKF9hID0gcmVxdWVzdC5lcnJvcikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm1lc3NhZ2UpIHx8ICcnKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIFRoaXMgbWV0aG9kIGNoZWNrcyB3aGV0aGVyIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICogQHJldHVybiB0cnVlIGlmIGNvb2tpZSBpcyBlbmFibGVkIHdpdGhpbiBjdXJyZW50IGJyb3dzZXJcclxuICovXHJcbmZ1bmN0aW9uIGFyZUNvb2tpZXNFbmFibGVkKCkge1xyXG4gICAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgPT09ICd1bmRlZmluZWQnIHx8ICFuYXZpZ2F0b3IuY29va2llRW5hYmxlZCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIHJldHVybiB0cnVlO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBAZmlsZW92ZXJ2aWV3IFN0YW5kYXJkaXplZCBGaXJlYmFzZSBFcnJvci5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqXHJcbiAqICAgLy8gVHlwZXNjcmlwdCBzdHJpbmcgbGl0ZXJhbHMgZm9yIHR5cGUtc2FmZSBjb2Rlc1xyXG4gKiAgIHR5cGUgRXJyID1cclxuICogICAgICd1bmtub3duJyB8XHJcbiAqICAgICAnb2JqZWN0LW5vdC1mb3VuZCdcclxuICogICAgIDtcclxuICpcclxuICogICAvLyBDbG9zdXJlIGVudW0gZm9yIHR5cGUtc2FmZSBlcnJvciBjb2Rlc1xyXG4gKiAgIC8vIGF0LWVudW0ge3N0cmluZ31cclxuICogICB2YXIgRXJyID0ge1xyXG4gKiAgICAgVU5LTk9XTjogJ3Vua25vd24nLFxyXG4gKiAgICAgT0JKRUNUX05PVF9GT1VORDogJ29iamVjdC1ub3QtZm91bmQnLFxyXG4gKiAgIH1cclxuICpcclxuICogICBsZXQgZXJyb3JzOiBNYXA8RXJyLCBzdHJpbmc+ID0ge1xyXG4gKiAgICAgJ2dlbmVyaWMtZXJyb3InOiBcIlVua25vd24gZXJyb3JcIixcclxuICogICAgICdmaWxlLW5vdC1mb3VuZCc6IFwiQ291bGQgbm90IGZpbmQgZmlsZTogeyRmaWxlfVwiLFxyXG4gKiAgIH07XHJcbiAqXHJcbiAqICAgLy8gVHlwZS1zYWZlIGZ1bmN0aW9uIC0gbXVzdCBwYXNzIGEgdmFsaWQgZXJyb3IgY29kZSBhcyBwYXJhbS5cclxuICogICBsZXQgZXJyb3IgPSBuZXcgRXJyb3JGYWN0b3J5PEVycj4oJ3NlcnZpY2UnLCAnU2VydmljZScsIGVycm9ycyk7XHJcbiAqXHJcbiAqICAgLi4uXHJcbiAqICAgdGhyb3cgZXJyb3IuY3JlYXRlKEVyci5HRU5FUklDKTtcclxuICogICAuLi5cclxuICogICB0aHJvdyBlcnJvci5jcmVhdGUoRXJyLkZJTEVfTk9UX0ZPVU5ELCB7J2ZpbGUnOiBmaWxlTmFtZX0pO1xyXG4gKiAgIC4uLlxyXG4gKiAgIC8vIFNlcnZpY2U6IENvdWxkIG5vdCBmaWxlIGZpbGU6IGZvby50eHQgKHNlcnZpY2UvZmlsZS1ub3QtZm91bmQpLlxyXG4gKlxyXG4gKiAgIGNhdGNoIChlKSB7XHJcbiAqICAgICBhc3NlcnQoZS5tZXNzYWdlID09PSBcIkNvdWxkIG5vdCBmaW5kIGZpbGU6IGZvby50eHQuXCIpO1xyXG4gKiAgICAgaWYgKChlIGFzIEZpcmViYXNlRXJyb3IpPy5jb2RlID09PSAnc2VydmljZS9maWxlLW5vdC1mb3VuZCcpIHtcclxuICogICAgICAgY29uc29sZS5sb2coXCJDb3VsZCBub3QgcmVhZCBmaWxlOiBcIiArIGVbJ2ZpbGUnXSk7XHJcbiAqICAgICB9XHJcbiAqICAgfVxyXG4gKi9cclxuY29uc3QgRVJST1JfTkFNRSA9ICdGaXJlYmFzZUVycm9yJztcclxuLy8gQmFzZWQgb24gY29kZSBmcm9tOlxyXG4vLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9FcnJvciNDdXN0b21fRXJyb3JfVHlwZXNcclxuY2xhc3MgRmlyZWJhc2VFcnJvciBleHRlbmRzIEVycm9yIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgLyoqIFRoZSBlcnJvciBjb2RlIGZvciB0aGlzIGVycm9yLiAqL1xyXG4gICAgY29kZSwgbWVzc2FnZSwgXHJcbiAgICAvKiogQ3VzdG9tIGRhdGEgZm9yIHRoaXMgZXJyb3IuICovXHJcbiAgICBjdXN0b21EYXRhKSB7XHJcbiAgICAgICAgc3VwZXIobWVzc2FnZSk7XHJcbiAgICAgICAgdGhpcy5jb2RlID0gY29kZTtcclxuICAgICAgICB0aGlzLmN1c3RvbURhdGEgPSBjdXN0b21EYXRhO1xyXG4gICAgICAgIC8qKiBUaGUgY3VzdG9tIG5hbWUgZm9yIGFsbCBGaXJlYmFzZUVycm9ycy4gKi9cclxuICAgICAgICB0aGlzLm5hbWUgPSBFUlJPUl9OQU1FO1xyXG4gICAgICAgIC8vIEZpeCBGb3IgRVM1XHJcbiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL01pY3Jvc29mdC9UeXBlU2NyaXB0LXdpa2kvYmxvYi9tYXN0ZXIvQnJlYWtpbmctQ2hhbmdlcy5tZCNleHRlbmRpbmctYnVpbHQtaW5zLWxpa2UtZXJyb3ItYXJyYXktYW5kLW1hcC1tYXktbm8tbG9uZ2VyLXdvcmtcclxuICAgICAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgRmlyZWJhc2VFcnJvci5wcm90b3R5cGUpO1xyXG4gICAgICAgIC8vIE1haW50YWlucyBwcm9wZXIgc3RhY2sgdHJhY2UgZm9yIHdoZXJlIG91ciBlcnJvciB3YXMgdGhyb3duLlxyXG4gICAgICAgIC8vIE9ubHkgYXZhaWxhYmxlIG9uIFY4LlxyXG4gICAgICAgIGlmIChFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSkge1xyXG4gICAgICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCBFcnJvckZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmNsYXNzIEVycm9yRmFjdG9yeSB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXJ2aWNlLCBzZXJ2aWNlTmFtZSwgZXJyb3JzKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlID0gc2VydmljZTtcclxuICAgICAgICB0aGlzLnNlcnZpY2VOYW1lID0gc2VydmljZU5hbWU7XHJcbiAgICAgICAgdGhpcy5lcnJvcnMgPSBlcnJvcnM7XHJcbiAgICB9XHJcbiAgICBjcmVhdGUoY29kZSwgLi4uZGF0YSkge1xyXG4gICAgICAgIGNvbnN0IGN1c3RvbURhdGEgPSBkYXRhWzBdIHx8IHt9O1xyXG4gICAgICAgIGNvbnN0IGZ1bGxDb2RlID0gYCR7dGhpcy5zZXJ2aWNlfS8ke2NvZGV9YDtcclxuICAgICAgICBjb25zdCB0ZW1wbGF0ZSA9IHRoaXMuZXJyb3JzW2NvZGVdO1xyXG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSB0ZW1wbGF0ZSA/IHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgY3VzdG9tRGF0YSkgOiAnRXJyb3InO1xyXG4gICAgICAgIC8vIFNlcnZpY2UgTmFtZTogRXJyb3IgbWVzc2FnZSAoc2VydmljZS9jb2RlKS5cclxuICAgICAgICBjb25zdCBmdWxsTWVzc2FnZSA9IGAke3RoaXMuc2VydmljZU5hbWV9OiAke21lc3NhZ2V9ICgke2Z1bGxDb2RlfSkuYDtcclxuICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBGaXJlYmFzZUVycm9yKGZ1bGxDb2RlLCBmdWxsTWVzc2FnZSwgY3VzdG9tRGF0YSk7XHJcbiAgICAgICAgcmV0dXJuIGVycm9yO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlcGxhY2VUZW1wbGF0ZSh0ZW1wbGF0ZSwgZGF0YSkge1xyXG4gICAgcmV0dXJuIHRlbXBsYXRlLnJlcGxhY2UoUEFUVEVSTiwgKF8sIGtleSkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtrZXldO1xyXG4gICAgICAgIHJldHVybiB2YWx1ZSAhPSBudWxsID8gU3RyaW5nKHZhbHVlKSA6IGA8JHtrZXl9Pz5gO1xyXG4gICAgfSk7XHJcbn1cclxuY29uc3QgUEFUVEVSTiA9IC9cXHtcXCQoW159XSspfS9nO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vKipcclxuICogRXZhbHVhdGVzIGEgSlNPTiBzdHJpbmcgaW50byBhIGphdmFzY3JpcHQgb2JqZWN0LlxyXG4gKlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyIEEgc3RyaW5nIGNvbnRhaW5pbmcgSlNPTi5cclxuICogQHJldHVybiB7Kn0gVGhlIGphdmFzY3JpcHQgb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgc3BlY2lmaWVkIEpTT04uXHJcbiAqL1xyXG5mdW5jdGlvbiBqc29uRXZhbChzdHIpIHtcclxuICAgIHJldHVybiBKU09OLnBhcnNlKHN0cik7XHJcbn1cclxuLyoqXHJcbiAqIFJldHVybnMgSlNPTiByZXByZXNlbnRpbmcgYSBqYXZhc2NyaXB0IG9iamVjdC5cclxuICogQHBhcmFtIHsqfSBkYXRhIEphdmFzY3JpcHQgb2JqZWN0IHRvIGJlIHN0cmluZ2lmaWVkLlxyXG4gKiBAcmV0dXJuIHtzdHJpbmd9IFRoZSBKU09OIGNvbnRlbnRzIG9mIHRoZSBvYmplY3QuXHJcbiAqL1xyXG5mdW5jdGlvbiBzdHJpbmdpZnkoZGF0YSkge1xyXG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gaW50byBjb25zdGl0dWVudCBwYXJ0cy5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiB3aXRoIGludmFsaWQgLyBpbmNvbXBsZXRlIGNsYWltcyBpZiB0aGVyZSdzIG5vIG5hdGl2ZSBiYXNlNjQgZGVjb2Rpbmcgc3VwcG9ydC5cclxuICogLSBEb2Vzbid0IGNoZWNrIGlmIHRoZSB0b2tlbiBpcyBhY3R1YWxseSB2YWxpZC5cclxuICovXHJcbmNvbnN0IGRlY29kZSA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgbGV0IGhlYWRlciA9IHt9LCBjbGFpbXMgPSB7fSwgZGF0YSA9IHt9LCBzaWduYXR1cmUgPSAnJztcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgcGFydHMgPSB0b2tlbi5zcGxpdCgnLicpO1xyXG4gICAgICAgIGhlYWRlciA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1swXSkgfHwgJycpO1xyXG4gICAgICAgIGNsYWltcyA9IGpzb25FdmFsKGJhc2U2NERlY29kZShwYXJ0c1sxXSkgfHwgJycpO1xyXG4gICAgICAgIHNpZ25hdHVyZSA9IHBhcnRzWzJdO1xyXG4gICAgICAgIGRhdGEgPSBjbGFpbXNbJ2QnXSB8fCB7fTtcclxuICAgICAgICBkZWxldGUgY2xhaW1zWydkJ107XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkgeyB9XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGhlYWRlcixcclxuICAgICAgICBjbGFpbXMsXHJcbiAgICAgICAgZGF0YSxcclxuICAgICAgICBzaWduYXR1cmVcclxuICAgIH07XHJcbn07XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgRmlyZWJhc2UgYXV0aC4gdG9rZW4gYW5kIGNoZWNrcyB0aGUgdmFsaWRpdHkgb2YgaXRzIHRpbWUtYmFzZWQgY2xhaW1zLiBXaWxsIHJldHVybiB0cnVlIGlmIHRoZVxyXG4gKiB0b2tlbiBpcyB3aXRoaW4gdGhlIHRpbWUgd2luZG93IGF1dGhvcml6ZWQgYnkgdGhlICduYmYnIChub3QtYmVmb3JlKSBhbmQgJ2lhdCcgKGlzc3VlZC1hdCkgY2xhaW1zLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIGEgZmFsc2UgbmVnYXRpdmUgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc1ZhbGlkVGltZXN0YW1wID0gZnVuY3Rpb24gKHRva2VuKSB7XHJcbiAgICBjb25zdCBjbGFpbXMgPSBkZWNvZGUodG9rZW4pLmNsYWltcztcclxuICAgIGNvbnN0IG5vdyA9IE1hdGguZmxvb3IobmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwKTtcclxuICAgIGxldCB2YWxpZFNpbmNlID0gMCwgdmFsaWRVbnRpbCA9IDA7XHJcbiAgICBpZiAodHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcpIHtcclxuICAgICAgICBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCduYmYnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWyduYmYnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoY2xhaW1zLmhhc093blByb3BlcnR5KCdpYXQnKSkge1xyXG4gICAgICAgICAgICB2YWxpZFNpbmNlID0gY2xhaW1zWydpYXQnXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnZXhwJykpIHtcclxuICAgICAgICAgICAgdmFsaWRVbnRpbCA9IGNsYWltc1snZXhwJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAvLyB0b2tlbiB3aWxsIGV4cGlyZSBhZnRlciAyNGggYnkgZGVmYXVsdFxyXG4gICAgICAgICAgICB2YWxpZFVudGlsID0gdmFsaWRTaW5jZSArIDg2NDAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiAoISFub3cgJiZcclxuICAgICAgICAhIXZhbGlkU2luY2UgJiZcclxuICAgICAgICAhIXZhbGlkVW50aWwgJiZcclxuICAgICAgICBub3cgPj0gdmFsaWRTaW5jZSAmJlxyXG4gICAgICAgIG5vdyA8PSB2YWxpZFVudGlsKTtcclxufTtcclxuLyoqXHJcbiAqIERlY29kZXMgYSBGaXJlYmFzZSBhdXRoLiB0b2tlbiBhbmQgcmV0dXJucyBpdHMgaXNzdWVkIGF0IHRpbWUgaWYgdmFsaWQsIG51bGwgb3RoZXJ3aXNlLlxyXG4gKlxyXG4gKiBOb3RlczpcclxuICogLSBNYXkgcmV0dXJuIG51bGwgaWYgdGhlcmUncyBubyBuYXRpdmUgYmFzZTY0IGRlY29kaW5nIHN1cHBvcnQuXHJcbiAqIC0gRG9lc24ndCBjaGVjayBpZiB0aGUgdG9rZW4gaXMgYWN0dWFsbHkgdmFsaWQuXHJcbiAqL1xyXG5jb25zdCBpc3N1ZWRBdFRpbWUgPSBmdW5jdGlvbiAodG9rZW4pIHtcclxuICAgIGNvbnN0IGNsYWltcyA9IGRlY29kZSh0b2tlbikuY2xhaW1zO1xyXG4gICAgaWYgKHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0JykpIHtcclxuICAgICAgICByZXR1cm4gY2xhaW1zWydpYXQnXTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG59O1xyXG4vKipcclxuICogRGVjb2RlcyBhIEZpcmViYXNlIGF1dGguIHRva2VuIGFuZCBjaGVja3MgdGhlIHZhbGlkaXR5IG9mIGl0cyBmb3JtYXQuIEV4cGVjdHMgYSB2YWxpZCBpc3N1ZWQtYXQgdGltZS5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxuY29uc3QgaXNWYWxpZEZvcm1hdCA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgY29uc3QgZGVjb2RlZCA9IGRlY29kZSh0b2tlbiksIGNsYWltcyA9IGRlY29kZWQuY2xhaW1zO1xyXG4gICAgcmV0dXJuICEhY2xhaW1zICYmIHR5cGVvZiBjbGFpbXMgPT09ICdvYmplY3QnICYmIGNsYWltcy5oYXNPd25Qcm9wZXJ0eSgnaWF0Jyk7XHJcbn07XHJcbi8qKlxyXG4gKiBBdHRlbXB0cyB0byBwZWVyIGludG8gYW4gYXV0aCB0b2tlbiBhbmQgZGV0ZXJtaW5lIGlmIGl0J3MgYW4gYWRtaW4gYXV0aCB0b2tlbiBieSBsb29raW5nIGF0IHRoZSBjbGFpbXMgcG9ydGlvbi5cclxuICpcclxuICogTm90ZXM6XHJcbiAqIC0gTWF5IHJldHVybiBhIGZhbHNlIG5lZ2F0aXZlIGlmIHRoZXJlJ3Mgbm8gbmF0aXZlIGJhc2U2NCBkZWNvZGluZyBzdXBwb3J0LlxyXG4gKiAtIERvZXNuJ3QgY2hlY2sgaWYgdGhlIHRva2VuIGlzIGFjdHVhbGx5IHZhbGlkLlxyXG4gKi9cclxuY29uc3QgaXNBZG1pbiA9IGZ1bmN0aW9uICh0b2tlbikge1xyXG4gICAgY29uc3QgY2xhaW1zID0gZGVjb2RlKHRva2VuKS5jbGFpbXM7XHJcbiAgICByZXR1cm4gdHlwZW9mIGNsYWltcyA9PT0gJ29iamVjdCcgJiYgY2xhaW1zWydhZG1pbiddID09PSB0cnVlO1xyXG59O1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBjb250YWlucyhvYmosIGtleSkge1xyXG4gICAgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSk7XHJcbn1cclxuZnVuY3Rpb24gc2FmZUdldChvYmosIGtleSkge1xyXG4gICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICByZXR1cm4gb2JqW2tleV07XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIGlzRW1wdHkob2JqKSB7XHJcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcclxuICAgICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gbWFwKG9iaiwgZm4sIGNvbnRleHRPYmopIHtcclxuICAgIGNvbnN0IHJlcyA9IHt9O1xyXG4gICAgZm9yIChjb25zdCBrZXkgaW4gb2JqKSB7XHJcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcclxuICAgICAgICAgICAgcmVzW2tleV0gPSBmbi5jYWxsKGNvbnRleHRPYmosIG9ialtrZXldLCBrZXksIG9iaik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlcztcclxufVxyXG4vKipcclxuICogRGVlcCBlcXVhbCB0d28gb2JqZWN0cy4gU3VwcG9ydCBBcnJheXMgYW5kIE9iamVjdHMuXHJcbiAqL1xyXG5mdW5jdGlvbiBkZWVwRXF1YWwoYSwgYikge1xyXG4gICAgaWYgKGEgPT09IGIpIHtcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIGNvbnN0IGFLZXlzID0gT2JqZWN0LmtleXMoYSk7XHJcbiAgICBjb25zdCBiS2V5cyA9IE9iamVjdC5rZXlzKGIpO1xyXG4gICAgZm9yIChjb25zdCBrIG9mIGFLZXlzKSB7XHJcbiAgICAgICAgaWYgKCFiS2V5cy5pbmNsdWRlcyhrKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGFQcm9wID0gYVtrXTtcclxuICAgICAgICBjb25zdCBiUHJvcCA9IGJba107XHJcbiAgICAgICAgaWYgKGlzT2JqZWN0KGFQcm9wKSAmJiBpc09iamVjdChiUHJvcCkpIHtcclxuICAgICAgICAgICAgaWYgKCFkZWVwRXF1YWwoYVByb3AsIGJQcm9wKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGFQcm9wICE9PSBiUHJvcCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZm9yIChjb25zdCBrIG9mIGJLZXlzKSB7XHJcbiAgICAgICAgaWYgKCFhS2V5cy5pbmNsdWRlcyhrKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuZnVuY3Rpb24gaXNPYmplY3QodGhpbmcpIHtcclxuICAgIHJldHVybiB0aGluZyAhPT0gbnVsbCAmJiB0eXBlb2YgdGhpbmcgPT09ICdvYmplY3QnO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBSZWplY3RzIGlmIHRoZSBnaXZlbiBwcm9taXNlIGRvZXNuJ3QgcmVzb2x2ZSBpbiB0aW1lSW5NUyBtaWxsaXNlY29uZHMuXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuZnVuY3Rpb24gcHJvbWlzZVdpdGhUaW1lb3V0KHByb21pc2UsIHRpbWVJbk1TID0gMjAwMCkge1xyXG4gICAgY29uc3QgZGVmZXJyZWRQcm9taXNlID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IGRlZmVycmVkUHJvbWlzZS5yZWplY3QoJ3RpbWVvdXQhJyksIHRpbWVJbk1TKTtcclxuICAgIHByb21pc2UudGhlbihkZWZlcnJlZFByb21pc2UucmVzb2x2ZSwgZGVmZXJyZWRQcm9taXNlLnJlamVjdCk7XHJcbiAgICByZXR1cm4gZGVmZXJyZWRQcm9taXNlLnByb21pc2U7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFJldHVybnMgYSBxdWVyeXN0cmluZy1mb3JtYXR0ZWQgc3RyaW5nIChlLmcuICZhcmc9dmFsJmFyZzI9dmFsMikgZnJvbSBhXHJcbiAqIHBhcmFtcyBvYmplY3QgKGUuZy4ge2FyZzogJ3ZhbCcsIGFyZzI6ICd2YWwyJ30pXHJcbiAqIE5vdGU6IFlvdSBtdXN0IHByZXBlbmQgaXQgd2l0aCA/IHdoZW4gYWRkaW5nIGl0IHRvIGEgVVJMLlxyXG4gKi9cclxuZnVuY3Rpb24gcXVlcnlzdHJpbmcocXVlcnlzdHJpbmdQYXJhbXMpIHtcclxuICAgIGNvbnN0IHBhcmFtcyA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMocXVlcnlzdHJpbmdQYXJhbXMpKSB7XHJcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHZhbHVlLmZvckVhY2goYXJyYXlWYWwgPT4ge1xyXG4gICAgICAgICAgICAgICAgcGFyYW1zLnB1c2goZW5jb2RlVVJJQ29tcG9uZW50KGtleSkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyYXlWYWwpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwYXJhbXMucHVzaChlbmNvZGVVUklDb21wb25lbnQoa2V5KSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXMubGVuZ3RoID8gJyYnICsgcGFyYW1zLmpvaW4oJyYnKSA6ICcnO1xyXG59XHJcbi8qKlxyXG4gKiBEZWNvZGVzIGEgcXVlcnlzdHJpbmcgKGUuZy4gP2FyZz12YWwmYXJnMj12YWwyKSBpbnRvIGEgcGFyYW1zIG9iamVjdFxyXG4gKiAoZS5nLiB7YXJnOiAndmFsJywgYXJnMjogJ3ZhbDInfSlcclxuICovXHJcbmZ1bmN0aW9uIHF1ZXJ5c3RyaW5nRGVjb2RlKHF1ZXJ5c3RyaW5nKSB7XHJcbiAgICBjb25zdCBvYmogPSB7fTtcclxuICAgIGNvbnN0IHRva2VucyA9IHF1ZXJ5c3RyaW5nLnJlcGxhY2UoL15cXD8vLCAnJykuc3BsaXQoJyYnKTtcclxuICAgIHRva2Vucy5mb3JFYWNoKHRva2VuID0+IHtcclxuICAgICAgICBpZiAodG9rZW4pIHtcclxuICAgICAgICAgICAgY29uc3QgW2tleSwgdmFsdWVdID0gdG9rZW4uc3BsaXQoJz0nKTtcclxuICAgICAgICAgICAgb2JqW2RlY29kZVVSSUNvbXBvbmVudChrZXkpXSA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gb2JqO1xyXG59XHJcbi8qKlxyXG4gKiBFeHRyYWN0IHRoZSBxdWVyeSBzdHJpbmcgcGFydCBvZiBhIFVSTCwgaW5jbHVkaW5nIHRoZSBsZWFkaW5nIHF1ZXN0aW9uIG1hcmsgKGlmIHByZXNlbnQpLlxyXG4gKi9cclxuZnVuY3Rpb24gZXh0cmFjdFF1ZXJ5c3RyaW5nKHVybCkge1xyXG4gICAgY29uc3QgcXVlcnlTdGFydCA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICBpZiAoIXF1ZXJ5U3RhcnQpIHtcclxuICAgICAgICByZXR1cm4gJyc7XHJcbiAgICB9XHJcbiAgICBjb25zdCBmcmFnbWVudFN0YXJ0ID0gdXJsLmluZGV4T2YoJyMnLCBxdWVyeVN0YXJ0KTtcclxuICAgIHJldHVybiB1cmwuc3Vic3RyaW5nKHF1ZXJ5U3RhcnQsIGZyYWdtZW50U3RhcnQgPiAwID8gZnJhZ21lbnRTdGFydCA6IHVuZGVmaW5lZCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBmaWxlb3ZlcnZpZXcgU0hBLTEgY3J5cHRvZ3JhcGhpYyBoYXNoLlxyXG4gKiBWYXJpYWJsZSBuYW1lcyBmb2xsb3cgdGhlIG5vdGF0aW9uIGluIEZJUFMgUFVCIDE4MC0zOlxyXG4gKiBodHRwOi8vY3NyYy5uaXN0Lmdvdi9wdWJsaWNhdGlvbnMvZmlwcy9maXBzMTgwLTMvZmlwczE4MC0zX2ZpbmFsLnBkZi5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqICAgdmFyIHNoYTEgPSBuZXcgc2hhMSgpO1xyXG4gKiAgIHNoYTEudXBkYXRlKGJ5dGVzKTtcclxuICogICB2YXIgaGFzaCA9IHNoYTEuZGlnZXN0KCk7XHJcbiAqXHJcbiAqIFBlcmZvcm1hbmNlOlxyXG4gKiAgIENocm9tZSAyMzogICB+NDAwIE1iaXQvc1xyXG4gKiAgIEZpcmVmb3ggMTY6ICB+MjUwIE1iaXQvc1xyXG4gKlxyXG4gKi9cclxuLyoqXHJcbiAqIFNIQS0xIGNyeXB0b2dyYXBoaWMgaGFzaCBjb25zdHJ1Y3Rvci5cclxuICpcclxuICogVGhlIHByb3BlcnRpZXMgZGVjbGFyZWQgaGVyZSBhcmUgZGlzY3Vzc2VkIGluIHRoZSBhYm92ZSBhbGdvcml0aG0gZG9jdW1lbnQuXHJcbiAqIEBjb25zdHJ1Y3RvclxyXG4gKiBAZmluYWxcclxuICogQHN0cnVjdFxyXG4gKi9cclxuY2xhc3MgU2hhMSB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBIb2xkcyB0aGUgcHJldmlvdXMgdmFsdWVzIG9mIGFjY3VtdWxhdGVkIHZhcmlhYmxlcyBhLWUgaW4gdGhlIGNvbXByZXNzX1xyXG4gICAgICAgICAqIGZ1bmN0aW9uLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5jaGFpbl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBIGJ1ZmZlciBob2xkaW5nIHRoZSBwYXJ0aWFsbHkgY29tcHV0ZWQgaGFzaCByZXN1bHQuXHJcbiAgICAgICAgICogQHByaXZhdGVcclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmJ1Zl8gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBBbiBhcnJheSBvZiA4MCBieXRlcywgZWFjaCBhIHBhcnQgb2YgdGhlIG1lc3NhZ2UgdG8gYmUgaGFzaGVkLiAgUmVmZXJyZWQgdG9cclxuICAgICAgICAgKiBhcyB0aGUgbWVzc2FnZSBzY2hlZHVsZSBpbiB0aGUgZG9jcy5cclxuICAgICAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuV18gPSBbXTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDb250YWlucyBkYXRhIG5lZWRlZCB0byBwYWQgbWVzc2FnZXMgbGVzcyB0aGFuIDY0IGJ5dGVzLlxyXG4gICAgICAgICAqIEBwcml2YXRlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5wYWRfID0gW107XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQHByaXZhdGUge251bWJlcn1cclxuICAgICAgICAgKi9cclxuICAgICAgICB0aGlzLnRvdGFsXyA9IDA7XHJcbiAgICAgICAgdGhpcy5ibG9ja1NpemUgPSA1MTIgLyA4O1xyXG4gICAgICAgIHRoaXMucGFkX1swXSA9IDEyODtcclxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHRoaXMuYmxvY2tTaXplOyArK2kpIHtcclxuICAgICAgICAgICAgdGhpcy5wYWRfW2ldID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bMF0gPSAweDY3NDUyMzAxO1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzFdID0gMHhlZmNkYWI4OTtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9IDB4OThiYWRjZmU7XHJcbiAgICAgICAgdGhpcy5jaGFpbl9bM10gPSAweDEwMzI1NDc2O1xyXG4gICAgICAgIHRoaXMuY2hhaW5fWzRdID0gMHhjM2QyZTFmMDtcclxuICAgICAgICB0aGlzLmluYnVmXyA9IDA7XHJcbiAgICAgICAgdGhpcy50b3RhbF8gPSAwO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBJbnRlcm5hbCBjb21wcmVzcyBoZWxwZXIgZnVuY3Rpb24uXHJcbiAgICAgKiBAcGFyYW0gYnVmIEJsb2NrIHRvIGNvbXByZXNzLlxyXG4gICAgICogQHBhcmFtIG9mZnNldCBPZmZzZXQgb2YgdGhlIGJsb2NrIGluIHRoZSBidWZmZXIuXHJcbiAgICAgKiBAcHJpdmF0ZVxyXG4gICAgICovXHJcbiAgICBjb21wcmVzc18oYnVmLCBvZmZzZXQpIHtcclxuICAgICAgICBpZiAoIW9mZnNldCkge1xyXG4gICAgICAgICAgICBvZmZzZXQgPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBXID0gdGhpcy5XXztcclxuICAgICAgICAvLyBnZXQgMTYgYmlnIGVuZGlhbiB3b3Jkc1xyXG4gICAgICAgIGlmICh0eXBlb2YgYnVmID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIC8vIFRPRE8odXNlcik6IFtidWcgODE0MDEyMl0gUmVjZW50IHZlcnNpb25zIG9mIFNhZmFyaSBmb3IgTWFjIE9TIGFuZCBpT1NcclxuICAgICAgICAgICAgICAgIC8vIGhhdmUgYSBidWcgdGhhdCB0dXJucyB0aGUgcG9zdC1pbmNyZW1lbnQgKysgb3BlcmF0b3IgaW50byBwcmUtaW5jcmVtZW50XHJcbiAgICAgICAgICAgICAgICAvLyBkdXJpbmcgSklUIGNvbXBpbGF0aW9uLiAgV2UgaGF2ZSBjb2RlIHRoYXQgZGVwZW5kcyBoZWF2aWx5IG9uIFNIQS0xIGZvclxyXG4gICAgICAgICAgICAgICAgLy8gY29ycmVjdG5lc3MgYW5kIHdoaWNoIGlzIGFmZmVjdGVkIGJ5IHRoaXMgYnVnLCBzbyBJJ3ZlIHJlbW92ZWQgYWxsIHVzZXNcclxuICAgICAgICAgICAgICAgIC8vIG9mIHBvc3QtaW5jcmVtZW50ICsrIGluIHdoaWNoIHRoZSByZXN1bHQgdmFsdWUgaXMgdXNlZC4gIFdlIGNhbiByZXZlcnRcclxuICAgICAgICAgICAgICAgIC8vIHRoaXMgY2hhbmdlIG9uY2UgdGhlIFNhZmFyaSBidWdcclxuICAgICAgICAgICAgICAgIC8vIChodHRwczovL2J1Z3Mud2Via2l0Lm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTA5MDM2KSBoYXMgYmVlbiBmaXhlZCBhbmRcclxuICAgICAgICAgICAgICAgIC8vIG1vc3QgY2xpZW50cyBoYXZlIGJlZW4gdXBkYXRlZC5cclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQpIDw8IDI0KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWYuY2hhckNvZGVBdChvZmZzZXQgKyAxKSA8PCAxNikgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmLmNoYXJDb2RlQXQob2Zmc2V0ICsgMikgPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWYuY2hhckNvZGVBdChvZmZzZXQgKyAzKTtcclxuICAgICAgICAgICAgICAgIG9mZnNldCArPSA0O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDE2OyBpKyspIHtcclxuICAgICAgICAgICAgICAgIFdbaV0gPVxyXG4gICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0XSA8PCAyNCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAoYnVmW29mZnNldCArIDFdIDw8IDE2KSB8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIChidWZbb2Zmc2V0ICsgMl0gPDwgOCkgfFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWZbb2Zmc2V0ICsgM107XHJcbiAgICAgICAgICAgICAgICBvZmZzZXQgKz0gNDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBleHBhbmQgdG8gODAgd29yZHNcclxuICAgICAgICBmb3IgKGxldCBpID0gMTY7IGkgPCA4MDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSBXW2kgLSAzXSBeIFdbaSAtIDhdIF4gV1tpIC0gMTRdIF4gV1tpIC0gMTZdO1xyXG4gICAgICAgICAgICBXW2ldID0gKCh0IDw8IDEpIHwgKHQgPj4+IDMxKSkgJiAweGZmZmZmZmZmO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgYSA9IHRoaXMuY2hhaW5fWzBdO1xyXG4gICAgICAgIGxldCBiID0gdGhpcy5jaGFpbl9bMV07XHJcbiAgICAgICAgbGV0IGMgPSB0aGlzLmNoYWluX1syXTtcclxuICAgICAgICBsZXQgZCA9IHRoaXMuY2hhaW5fWzNdO1xyXG4gICAgICAgIGxldCBlID0gdGhpcy5jaGFpbl9bNF07XHJcbiAgICAgICAgbGV0IGYsIGs7XHJcbiAgICAgICAgLy8gVE9ETyh1c2VyKTogVHJ5IHRvIHVucm9sbCB0aGlzIGxvb3AgdG8gc3BlZWQgdXAgdGhlIGNvbXB1dGF0aW9uLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgODA7IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoaSA8IDQwKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA8IDIwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGQgXiAoYiAmIChjIF4gZCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweDVhODI3OTk5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZiA9IGIgXiBjIF4gZDtcclxuICAgICAgICAgICAgICAgICAgICBrID0gMHg2ZWQ5ZWJhMTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGlmIChpIDwgNjApIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gKGIgJiBjKSB8IChkICYgKGIgfCBjKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgayA9IDB4OGYxYmJjZGM7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBmID0gYiBeIGMgXiBkO1xyXG4gICAgICAgICAgICAgICAgICAgIGsgPSAweGNhNjJjMWQ2O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHQgPSAoKChhIDw8IDUpIHwgKGEgPj4+IDI3KSkgKyBmICsgZSArIGsgKyBXW2ldKSAmIDB4ZmZmZmZmZmY7XHJcbiAgICAgICAgICAgIGUgPSBkO1xyXG4gICAgICAgICAgICBkID0gYztcclxuICAgICAgICAgICAgYyA9ICgoYiA8PCAzMCkgfCAoYiA+Pj4gMikpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICAgICAgYiA9IGE7XHJcbiAgICAgICAgICAgIGEgPSB0O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoYWluX1swXSA9ICh0aGlzLmNoYWluX1swXSArIGEpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1sxXSA9ICh0aGlzLmNoYWluX1sxXSArIGIpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1syXSA9ICh0aGlzLmNoYWluX1syXSArIGMpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1szXSA9ICh0aGlzLmNoYWluX1szXSArIGQpICYgMHhmZmZmZmZmZjtcclxuICAgICAgICB0aGlzLmNoYWluX1s0XSA9ICh0aGlzLmNoYWluX1s0XSArIGUpICYgMHhmZmZmZmZmZjtcclxuICAgIH1cclxuICAgIHVwZGF0ZShieXRlcywgbGVuZ3RoKSB7XHJcbiAgICAgICAgLy8gVE9ETyhqb2hubGVueik6IHRpZ2h0ZW4gdGhlIGZ1bmN0aW9uIHNpZ25hdHVyZSBhbmQgcmVtb3ZlIHRoaXMgY2hlY2tcclxuICAgICAgICBpZiAoYnl0ZXMgPT0gbnVsbCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChsZW5ndGggPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBsZW5ndGggPSBieXRlcy5sZW5ndGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGxlbmd0aE1pbnVzQmxvY2sgPSBsZW5ndGggLSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgLy8gVXNpbmcgbG9jYWwgaW5zdGVhZCBvZiBtZW1iZXIgdmFyaWFibGVzIGdpdmVzIH41JSBzcGVlZHVwIG9uIEZpcmVmb3ggMTYuXHJcbiAgICAgICAgY29uc3QgYnVmID0gdGhpcy5idWZfO1xyXG4gICAgICAgIGxldCBpbmJ1ZiA9IHRoaXMuaW5idWZfO1xyXG4gICAgICAgIC8vIFRoZSBvdXRlciB3aGlsZSBsb29wIHNob3VsZCBleGVjdXRlIGF0IG1vc3QgdHdpY2UuXHJcbiAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgLy8gV2hlbiB3ZSBoYXZlIG5vIGRhdGEgaW4gdGhlIGJsb2NrIHRvIHRvcCB1cCwgd2UgY2FuIGRpcmVjdGx5IHByb2Nlc3MgdGhlXHJcbiAgICAgICAgICAgIC8vIGlucHV0IGJ1ZmZlciAoYXNzdW1pbmcgaXQgY29udGFpbnMgc3VmZmljaWVudCBkYXRhKS4gVGhpcyBnaXZlcyB+MjUlXHJcbiAgICAgICAgICAgIC8vIHNwZWVkdXAgb24gQ2hyb21lIDIzIGFuZCB+MTUlIHNwZWVkdXAgb24gRmlyZWZveCAxNiwgYnV0IHJlcXVpcmVzIHRoYXRcclxuICAgICAgICAgICAgLy8gdGhlIGRhdGEgaXMgcHJvdmlkZWQgaW4gbGFyZ2UgY2h1bmtzIChvciBpbiBtdWx0aXBsZXMgb2YgNjQgYnl0ZXMpLlxyXG4gICAgICAgICAgICBpZiAoaW5idWYgPT09IDApIHtcclxuICAgICAgICAgICAgICAgIHdoaWxlIChuIDw9IGxlbmd0aE1pbnVzQmxvY2spIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbXByZXNzXyhieXRlcywgbik7XHJcbiAgICAgICAgICAgICAgICAgICAgbiArPSB0aGlzLmJsb2NrU2l6ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHlwZW9mIGJ5dGVzID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICAgICAgd2hpbGUgKG4gPCBsZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBidWZbaW5idWZdID0gYnl0ZXMuY2hhckNvZGVBdChuKTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB3aGlsZSAobiA8IGxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1ZltpbmJ1Zl0gPSBieXRlc1tuXTtcclxuICAgICAgICAgICAgICAgICAgICArK2luYnVmO1xyXG4gICAgICAgICAgICAgICAgICAgICsrbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaW5idWYgPT09IHRoaXMuYmxvY2tTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcHJlc3NfKGJ1Zik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluYnVmID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSnVtcCB0byB0aGUgb3V0ZXIgbG9vcCBzbyB3ZSB1c2UgdGhlIGZ1bGwtYmxvY2sgb3B0aW1pemF0aW9uLlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbmJ1Zl8gPSBpbmJ1ZjtcclxuICAgICAgICB0aGlzLnRvdGFsXyArPSBsZW5ndGg7XHJcbiAgICB9XHJcbiAgICAvKiogQG92ZXJyaWRlICovXHJcbiAgICBkaWdlc3QoKSB7XHJcbiAgICAgICAgY29uc3QgZGlnZXN0ID0gW107XHJcbiAgICAgICAgbGV0IHRvdGFsQml0cyA9IHRoaXMudG90YWxfICogODtcclxuICAgICAgICAvLyBBZGQgcGFkIDB4ODAgMHgwMCouXHJcbiAgICAgICAgaWYgKHRoaXMuaW5idWZfIDwgNTYpIHtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGUodGhpcy5wYWRfLCA1NiAtIHRoaXMuaW5idWZfKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlKHRoaXMucGFkXywgdGhpcy5ibG9ja1NpemUgLSAodGhpcy5pbmJ1Zl8gLSA1NikpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBZGQgIyBiaXRzLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLmJsb2NrU2l6ZSAtIDE7IGkgPj0gNTY7IGktLSkge1xyXG4gICAgICAgICAgICB0aGlzLmJ1Zl9baV0gPSB0b3RhbEJpdHMgJiAyNTU7XHJcbiAgICAgICAgICAgIHRvdGFsQml0cyAvPSAyNTY7IC8vIERvbid0IHVzZSBiaXQtc2hpZnRpbmcgaGVyZSFcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wcmVzc18odGhpcy5idWZfKTtcclxuICAgICAgICBsZXQgbiA9IDA7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCA1OyBpKyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDI0OyBqID49IDA7IGogLT0gOCkge1xyXG4gICAgICAgICAgICAgICAgZGlnZXN0W25dID0gKHRoaXMuY2hhaW5fW2ldID4+IGopICYgMjU1O1xyXG4gICAgICAgICAgICAgICAgKytuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBkaWdlc3Q7XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEhlbHBlciB0byBtYWtlIGEgU3Vic2NyaWJlIGZ1bmN0aW9uIChqdXN0IGxpa2UgUHJvbWlzZSBoZWxwcyBtYWtlIGFcclxuICogVGhlbmFibGUpLlxyXG4gKlxyXG4gKiBAcGFyYW0gZXhlY3V0b3IgRnVuY3Rpb24gd2hpY2ggY2FuIG1ha2UgY2FsbHMgdG8gYSBzaW5nbGUgT2JzZXJ2ZXJcclxuICogICAgIGFzIGEgcHJveHkuXHJcbiAqIEBwYXJhbSBvbk5vT2JzZXJ2ZXJzIENhbGxiYWNrIHdoZW4gY291bnQgb2YgT2JzZXJ2ZXJzIGdvZXMgdG8gemVyby5cclxuICovXHJcbmZ1bmN0aW9uIGNyZWF0ZVN1YnNjcmliZShleGVjdXRvciwgb25Ob09ic2VydmVycykge1xyXG4gICAgY29uc3QgcHJveHkgPSBuZXcgT2JzZXJ2ZXJQcm94eShleGVjdXRvciwgb25Ob09ic2VydmVycyk7XHJcbiAgICByZXR1cm4gcHJveHkuc3Vic2NyaWJlLmJpbmQocHJveHkpO1xyXG59XHJcbi8qKlxyXG4gKiBJbXBsZW1lbnQgZmFuLW91dCBmb3IgYW55IG51bWJlciBvZiBPYnNlcnZlcnMgYXR0YWNoZWQgdmlhIGEgc3Vic2NyaWJlXHJcbiAqIGZ1bmN0aW9uLlxyXG4gKi9cclxuY2xhc3MgT2JzZXJ2ZXJQcm94eSB7XHJcbiAgICAvKipcclxuICAgICAqIEBwYXJhbSBleGVjdXRvciBGdW5jdGlvbiB3aGljaCBjYW4gbWFrZSBjYWxscyB0byBhIHNpbmdsZSBPYnNlcnZlclxyXG4gICAgICogICAgIGFzIGEgcHJveHkuXHJcbiAgICAgKiBAcGFyYW0gb25Ob09ic2VydmVycyBDYWxsYmFjayB3aGVuIGNvdW50IG9mIE9ic2VydmVycyBnb2VzIHRvIHplcm8uXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGV4ZWN1dG9yLCBvbk5vT2JzZXJ2ZXJzKSB7XHJcbiAgICAgICAgdGhpcy5vYnNlcnZlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLnVuc3Vic2NyaWJlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCA9IDA7XHJcbiAgICAgICAgLy8gTWljcm8tdGFzayBzY2hlZHVsaW5nIGJ5IGNhbGxpbmcgdGFzay50aGVuKCkuXHJcbiAgICAgICAgdGhpcy50YXNrID0gUHJvbWlzZS5yZXNvbHZlKCk7XHJcbiAgICAgICAgdGhpcy5maW5hbGl6ZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLm9uTm9PYnNlcnZlcnMgPSBvbk5vT2JzZXJ2ZXJzO1xyXG4gICAgICAgIC8vIENhbGwgdGhlIGV4ZWN1dG9yIGFzeW5jaHJvbm91c2x5IHNvIHN1YnNjcmliZXJzIHRoYXQgYXJlIGNhbGxlZFxyXG4gICAgICAgIC8vIHN5bmNocm9ub3VzbHkgYWZ0ZXIgdGhlIGNyZWF0aW9uIG9mIHRoZSBzdWJzY3JpYmUgZnVuY3Rpb25cclxuICAgICAgICAvLyBjYW4gc3RpbGwgcmVjZWl2ZSB0aGUgdmVyeSBmaXJzdCB2YWx1ZSBnZW5lcmF0ZWQgaW4gdGhlIGV4ZWN1dG9yLlxyXG4gICAgICAgIHRoaXMudGFza1xyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGV4ZWN1dG9yKHRoaXMpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaChlID0+IHtcclxuICAgICAgICAgICAgdGhpcy5lcnJvcihlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG5leHQodmFsdWUpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIubmV4dCh2YWx1ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBlcnJvcihlcnJvcikge1xyXG4gICAgICAgIHRoaXMuZm9yRWFjaE9ic2VydmVyKChvYnNlcnZlcikgPT4ge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5lcnJvcihlcnJvcik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jbG9zZShlcnJvcik7XHJcbiAgICB9XHJcbiAgICBjb21wbGV0ZSgpIHtcclxuICAgICAgICB0aGlzLmZvckVhY2hPYnNlcnZlcigob2JzZXJ2ZXIpID0+IHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuY29tcGxldGUoKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFN1YnNjcmliZSBmdW5jdGlvbiB0aGF0IGNhbiBiZSB1c2VkIHRvIGFkZCBhbiBPYnNlcnZlciB0byB0aGUgZmFuLW91dCBsaXN0LlxyXG4gICAgICpcclxuICAgICAqIC0gV2UgcmVxdWlyZSB0aGF0IG5vIGV2ZW50IGlzIHNlbnQgdG8gYSBzdWJzY3JpYmVyIHN5Y2hyb25vdXNseSB0byB0aGVpclxyXG4gICAgICogICBjYWxsIHRvIHN1YnNjcmliZSgpLlxyXG4gICAgICovXHJcbiAgICBzdWJzY3JpYmUobmV4dE9yT2JzZXJ2ZXIsIGVycm9yLCBjb21wbGV0ZSkge1xyXG4gICAgICAgIGxldCBvYnNlcnZlcjtcclxuICAgICAgICBpZiAobmV4dE9yT2JzZXJ2ZXIgPT09IHVuZGVmaW5lZCAmJlxyXG4gICAgICAgICAgICBlcnJvciA9PT0gdW5kZWZpbmVkICYmXHJcbiAgICAgICAgICAgIGNvbXBsZXRlID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNaXNzaW5nIE9ic2VydmVyLicpO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBBc3NlbWJsZSBhbiBPYnNlcnZlciBvYmplY3Qgd2hlbiBwYXNzZWQgYXMgY2FsbGJhY2sgZnVuY3Rpb25zLlxyXG4gICAgICAgIGlmIChpbXBsZW1lbnRzQW55TWV0aG9kcyhuZXh0T3JPYnNlcnZlciwgW1xyXG4gICAgICAgICAgICAnbmV4dCcsXHJcbiAgICAgICAgICAgICdlcnJvcicsXHJcbiAgICAgICAgICAgICdjb21wbGV0ZSdcclxuICAgICAgICBdKSkge1xyXG4gICAgICAgICAgICBvYnNlcnZlciA9IG5leHRPck9ic2VydmVyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIgPSB7XHJcbiAgICAgICAgICAgICAgICBuZXh0OiBuZXh0T3JPYnNlcnZlcixcclxuICAgICAgICAgICAgICAgIGVycm9yLFxyXG4gICAgICAgICAgICAgICAgY29tcGxldGVcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLm5leHQgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5uZXh0ID0gbm9vcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9ic2VydmVyLmVycm9yID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IgPSBub29wO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAob2JzZXJ2ZXIuY29tcGxldGUgPT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSA9IG5vb3A7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHVuc3ViID0gdGhpcy51bnN1YnNjcmliZU9uZS5iaW5kKHRoaXMsIHRoaXMub2JzZXJ2ZXJzLmxlbmd0aCk7XHJcbiAgICAgICAgLy8gQXR0ZW1wdCB0byBzdWJzY3JpYmUgdG8gYSB0ZXJtaW5hdGVkIE9ic2VydmFibGUgLSB3ZVxyXG4gICAgICAgIC8vIGp1c3QgcmVzcG9uZCB0byB0aGUgT2JzZXJ2ZXIgd2l0aCB0aGUgZmluYWwgZXJyb3Igb3IgY29tcGxldGVcclxuICAgICAgICAvLyBldmVudC5cclxuICAgICAgICBpZiAodGhpcy5maW5hbGl6ZWQpIHtcclxuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgICAgICB0aGlzLnRhc2sudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZpbmFsRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgb2JzZXJ2ZXIuZXJyb3IodGhpcy5maW5hbEVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9ic2VydmVyLmNvbXBsZXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBub3RoaW5nXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTtcclxuICAgICAgICByZXR1cm4gdW5zdWI7XHJcbiAgICB9XHJcbiAgICAvLyBVbnN1YnNjcmliZSBpcyBzeW5jaHJvbm91cyAtIHdlIGd1YXJhbnRlZSB0aGF0IG5vIGV2ZW50cyBhcmUgc2VudCB0b1xyXG4gICAgLy8gYW55IHVuc3Vic2NyaWJlZCBPYnNlcnZlci5cclxuICAgIHVuc3Vic2NyaWJlT25lKGkpIHtcclxuICAgICAgICBpZiAodGhpcy5vYnNlcnZlcnMgPT09IHVuZGVmaW5lZCB8fCB0aGlzLm9ic2VydmVyc1tpXSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGVsZXRlIHRoaXMub2JzZXJ2ZXJzW2ldO1xyXG4gICAgICAgIHRoaXMub2JzZXJ2ZXJDb3VudCAtPSAxO1xyXG4gICAgICAgIGlmICh0aGlzLm9ic2VydmVyQ291bnQgPT09IDAgJiYgdGhpcy5vbk5vT2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzKHRoaXMpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZvckVhY2hPYnNlcnZlcihmbikge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICAvLyBBbHJlYWR5IGNsb3NlZCBieSBwcmV2aW91cyBldmVudC4uLi5qdXN0IGVhdCB0aGUgYWRkaXRpb25hbCB2YWx1ZXMuXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gU2luY2Ugc2VuZE9uZSBjYWxscyBhc3luY2hyb25vdXNseSAtIHRoZXJlIGlzIG5vIGNoYW5jZSB0aGF0XHJcbiAgICAgICAgLy8gdGhpcy5vYnNlcnZlcnMgd2lsbCBiZWNvbWUgdW5kZWZpbmVkLlxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5vYnNlcnZlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgdGhpcy5zZW5kT25lKGksIGZuKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBDYWxsIHRoZSBPYnNlcnZlciB2aWEgb25lIG9mIGl0J3MgY2FsbGJhY2sgZnVuY3Rpb24uIFdlIGFyZSBjYXJlZnVsIHRvXHJcbiAgICAvLyBjb25maXJtIHRoYXQgdGhlIG9ic2VydmUgaGFzIG5vdCBiZWVuIHVuc3Vic2NyaWJlZCBzaW5jZSB0aGlzIGFzeW5jaHJvbm91c1xyXG4gICAgLy8gZnVuY3Rpb24gaGFkIGJlZW4gcXVldWVkLlxyXG4gICAgc2VuZE9uZShpLCBmbikge1xyXG4gICAgICAgIC8vIEV4ZWN1dGUgdGhlIGNhbGxiYWNrIGFzeW5jaHJvbm91c2x5XHJcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xyXG4gICAgICAgIHRoaXMudGFzay50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMub2JzZXJ2ZXJzICE9PSB1bmRlZmluZWQgJiYgdGhpcy5vYnNlcnZlcnNbaV0gIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBmbih0aGlzLm9ic2VydmVyc1tpXSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSBleGNlcHRpb25zIHJhaXNlZCBpbiBPYnNlcnZlcnMgb3IgbWlzc2luZyBtZXRob2RzIG9mIGFuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gT2JzZXJ2ZXIuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gTG9nIGVycm9yIHRvIGNvbnNvbGUuIGIvMzE0MDQ4MDZcclxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGNvbnNvbGUgIT09ICd1bmRlZmluZWQnICYmIGNvbnNvbGUuZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNsb3NlKGVycikge1xyXG4gICAgICAgIGlmICh0aGlzLmZpbmFsaXplZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZmluYWxpemVkID0gdHJ1ZTtcclxuICAgICAgICBpZiAoZXJyICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5maW5hbEVycm9yID0gZXJyO1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQcm94eSBpcyBubyBsb25nZXIgbmVlZGVkIC0gZ2FyYmFnZSBjb2xsZWN0IHJlZmVyZW5jZXNcclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWZsb2F0aW5nLXByb21pc2VzXHJcbiAgICAgICAgdGhpcy50YXNrLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLm9ic2VydmVycyA9IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgdGhpcy5vbk5vT2JzZXJ2ZXJzID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG59XHJcbi8qKiBUdXJuIHN5bmNocm9ub3VzIGZ1bmN0aW9uIGludG8gb25lIGNhbGxlZCBhc3luY2hyb25vdXNseS4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHlwZXNcclxuZnVuY3Rpb24gYXN5bmMoZm4sIG9uRXJyb3IpIHtcclxuICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xyXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSh0cnVlKVxyXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICAgICAgaWYgKG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIG9uRXJyb3IoZXJyb3IpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59XHJcbi8qKlxyXG4gKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgb2JqZWN0IHBhc3NlZCBpbiBpbXBsZW1lbnRzIGFueSBvZiB0aGUgbmFtZWQgbWV0aG9kcy5cclxuICovXHJcbmZ1bmN0aW9uIGltcGxlbWVudHNBbnlNZXRob2RzKG9iaiwgbWV0aG9kcykge1xyXG4gICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnIHx8IG9iaiA9PT0gbnVsbCkge1xyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIG1ldGhvZHMpIHtcclxuICAgICAgICBpZiAobWV0aG9kIGluIG9iaiAmJiB0eXBlb2Ygb2JqW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGZhbHNlO1xyXG59XHJcbmZ1bmN0aW9uIG5vb3AoKSB7XHJcbiAgICAvLyBkbyBub3RoaW5nXHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIENoZWNrIHRvIG1ha2Ugc3VyZSB0aGUgYXBwcm9wcmlhdGUgbnVtYmVyIG9mIGFyZ3VtZW50cyBhcmUgcHJvdmlkZWQgZm9yIGEgcHVibGljIGZ1bmN0aW9uLlxyXG4gKiBUaHJvd3MgYW4gZXJyb3IgaWYgaXQgZmFpbHMuXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIG1pbkNvdW50IFRoZSBtaW5pbXVtIG51bWJlciBvZiBhcmd1bWVudHMgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSBtYXhDb3VudCBUaGUgbWF4aW11bSBudW1iZXIgb2YgYXJndW1lbnQgdG8gYWxsb3cgZm9yIHRoZSBmdW5jdGlvbiBjYWxsXHJcbiAqIEBwYXJhbSBhcmdDb3VudCBUaGUgYWN0dWFsIG51bWJlciBvZiBhcmd1bWVudHMgcHJvdmlkZWQuXHJcbiAqL1xyXG5jb25zdCB2YWxpZGF0ZUFyZ0NvdW50ID0gZnVuY3Rpb24gKGZuTmFtZSwgbWluQ291bnQsIG1heENvdW50LCBhcmdDb3VudCkge1xyXG4gICAgbGV0IGFyZ0Vycm9yO1xyXG4gICAgaWYgKGFyZ0NvdW50IDwgbWluQ291bnQpIHtcclxuICAgICAgICBhcmdFcnJvciA9ICdhdCBsZWFzdCAnICsgbWluQ291bnQ7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmIChhcmdDb3VudCA+IG1heENvdW50KSB7XHJcbiAgICAgICAgYXJnRXJyb3IgPSBtYXhDb3VudCA9PT0gMCA/ICdub25lJyA6ICdubyBtb3JlIHRoYW4gJyArIG1heENvdW50O1xyXG4gICAgfVxyXG4gICAgaWYgKGFyZ0Vycm9yKSB7XHJcbiAgICAgICAgY29uc3QgZXJyb3IgPSBmbk5hbWUgK1xyXG4gICAgICAgICAgICAnIGZhaWxlZDogV2FzIGNhbGxlZCB3aXRoICcgK1xyXG4gICAgICAgICAgICBhcmdDb3VudCArXHJcbiAgICAgICAgICAgIChhcmdDb3VudCA9PT0gMSA/ICcgYXJndW1lbnQuJyA6ICcgYXJndW1lbnRzLicpICtcclxuICAgICAgICAgICAgJyBFeHBlY3RzICcgK1xyXG4gICAgICAgICAgICBhcmdFcnJvciArXHJcbiAgICAgICAgICAgICcuJztcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG59O1xyXG4vKipcclxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHRvIHByZWZpeCBhbiBlcnJvciBtZXNzYWdlIGFib3V0IGZhaWxlZCBhcmd1bWVudCB2YWxpZGF0aW9uXHJcbiAqXHJcbiAqIEBwYXJhbSBmbk5hbWUgVGhlIGZ1bmN0aW9uIG5hbWVcclxuICogQHBhcmFtIGFyZ05hbWUgVGhlIG5hbWUgb2YgdGhlIGFyZ3VtZW50XHJcbiAqIEByZXR1cm4gVGhlIHByZWZpeCB0byBhZGQgdG8gdGhlIGVycm9yIHRocm93biBmb3IgdmFsaWRhdGlvbi5cclxuICovXHJcbmZ1bmN0aW9uIGVycm9yUHJlZml4KGZuTmFtZSwgYXJnTmFtZSkge1xyXG4gICAgcmV0dXJuIGAke2ZuTmFtZX0gZmFpbGVkOiAke2FyZ05hbWV9IGFyZ3VtZW50IGA7XHJcbn1cclxuLyoqXHJcbiAqIEBwYXJhbSBmbk5hbWVcclxuICogQHBhcmFtIGFyZ3VtZW50TnVtYmVyXHJcbiAqIEBwYXJhbSBuYW1lc3BhY2VcclxuICogQHBhcmFtIG9wdGlvbmFsXHJcbiAqL1xyXG5mdW5jdGlvbiB2YWxpZGF0ZU5hbWVzcGFjZShmbk5hbWUsIG5hbWVzcGFjZSwgb3B0aW9uYWwpIHtcclxuICAgIGlmIChvcHRpb25hbCAmJiAhbmFtZXNwYWNlKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKHR5cGVvZiBuYW1lc3BhY2UgIT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgLy9UT0RPOiBJIHNob3VsZCBkbyBtb3JlIHZhbGlkYXRpb24gaGVyZS4gV2Ugb25seSBhbGxvdyBjZXJ0YWluIGNoYXJzIGluIG5hbWVzcGFjZXMuXHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yUHJlZml4KGZuTmFtZSwgJ25hbWVzcGFjZScpICsgJ211c3QgYmUgYSB2YWxpZCBmaXJlYmFzZSBuYW1lc3BhY2UuJyk7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gdmFsaWRhdGVDYWxsYmFjayhmbk5hbWUsIGFyZ3VtZW50TmFtZSwgXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXR5cGVzXHJcbmNhbGxiYWNrLCBvcHRpb25hbCkge1xyXG4gICAgaWYgKG9wdGlvbmFsICYmICFjYWxsYmFjaykge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2YgY2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi4nKTtcclxuICAgIH1cclxufVxyXG5mdW5jdGlvbiB2YWxpZGF0ZUNvbnRleHRPYmplY3QoZm5OYW1lLCBhcmd1bWVudE5hbWUsIGNvbnRleHQsIG9wdGlvbmFsKSB7XHJcbiAgICBpZiAob3B0aW9uYWwgJiYgIWNvbnRleHQpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGNvbnRleHQgIT09ICdvYmplY3QnIHx8IGNvbnRleHQgPT09IG51bGwpIHtcclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JQcmVmaXgoZm5OYW1lLCBhcmd1bWVudE5hbWUpICsgJ211c3QgYmUgYSB2YWxpZCBjb250ZXh0IG9iamVjdC4nKTtcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG4vLyBDb2RlIG9yaWdpbmFsbHkgY2FtZSBmcm9tIGdvb2cuY3J5cHQuc3RyaW5nVG9VdGY4Qnl0ZUFycmF5LCBidXQgZm9yIHNvbWUgcmVhc29uIHRoZXlcclxuLy8gYXV0b21hdGljYWxseSByZXBsYWNlZCAnXFxyXFxuJyB3aXRoICdcXG4nLCBhbmQgdGhleSBkaWRuJ3QgaGFuZGxlIHN1cnJvZ2F0ZSBwYWlycyxcclxuLy8gc28gaXQncyBiZWVuIG1vZGlmaWVkLlxyXG4vLyBOb3RlIHRoYXQgbm90IGFsbCBVbmljb2RlIGNoYXJhY3RlcnMgYXBwZWFyIGFzIHNpbmdsZSBjaGFyYWN0ZXJzIGluIEphdmFTY3JpcHQgc3RyaW5ncy5cclxuLy8gZnJvbUNoYXJDb2RlIHJldHVybnMgdGhlIFVURi0xNiBlbmNvZGluZyBvZiBhIGNoYXJhY3RlciAtIHNvIHNvbWUgVW5pY29kZSBjaGFyYWN0ZXJzXHJcbi8vIHVzZSAyIGNoYXJhY3RlcnMgaW4gSmF2YXNjcmlwdC4gIEFsbCA0LWJ5dGUgVVRGLTggY2hhcmFjdGVycyBiZWdpbiB3aXRoIGEgZmlyc3RcclxuLy8gY2hhcmFjdGVyIGluIHRoZSByYW5nZSAweEQ4MDAgLSAweERCRkYgKHRoZSBmaXJzdCBjaGFyYWN0ZXIgb2YgYSBzby1jYWxsZWQgc3Vycm9nYXRlXHJcbi8vIHBhaXIpLlxyXG4vLyBTZWUgaHR0cDovL3d3dy5lY21hLWludGVybmF0aW9uYWwub3JnL2VjbWEtMjYyLzUuMS8jc2VjLTE1LjEuM1xyXG4vKipcclxuICogQHBhcmFtIHtzdHJpbmd9IHN0clxyXG4gKiBAcmV0dXJuIHtBcnJheX1cclxuICovXHJcbmNvbnN0IHN0cmluZ1RvQnl0ZUFycmF5ID0gZnVuY3Rpb24gKHN0cikge1xyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBsZXQgcCA9IDA7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgIGxldCBjID0gc3RyLmNoYXJDb2RlQXQoaSk7XHJcbiAgICAgICAgLy8gSXMgdGhpcyB0aGUgbGVhZCBzdXJyb2dhdGUgaW4gYSBzdXJyb2dhdGUgcGFpcj9cclxuICAgICAgICBpZiAoYyA+PSAweGQ4MDAgJiYgYyA8PSAweGRiZmYpIHtcclxuICAgICAgICAgICAgY29uc3QgaGlnaCA9IGMgLSAweGQ4MDA7IC8vIHRoZSBoaWdoIDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGkrKztcclxuICAgICAgICAgICAgYXNzZXJ0KGkgPCBzdHIubGVuZ3RoLCAnU3Vycm9nYXRlIHBhaXIgbWlzc2luZyB0cmFpbCBzdXJyb2dhdGUuJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGxvdyA9IHN0ci5jaGFyQ29kZUF0KGkpIC0gMHhkYzAwOyAvLyB0aGUgbG93IDEwIGJpdHMuXHJcbiAgICAgICAgICAgIGMgPSAweDEwMDAwICsgKGhpZ2ggPDwgMTApICsgbG93O1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYyA8IDEyOCkge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IGM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCAyMDQ4KSB7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgPj4gNikgfCAxOTI7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGMgPCA2NTUzNikge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDEyKSB8IDIyNDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gNikgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgICAgIG91dFtwKytdID0gKGMgJiA2MykgfCAxMjg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9IChjID4+IDE4KSB8IDI0MDtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoKGMgPj4gMTIpICYgNjMpIHwgMTI4O1xyXG4gICAgICAgICAgICBvdXRbcCsrXSA9ICgoYyA+PiA2KSAmIDYzKSB8IDEyODtcclxuICAgICAgICAgICAgb3V0W3ArK10gPSAoYyAmIDYzKSB8IDEyODtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gb3V0O1xyXG59O1xyXG4vKipcclxuICogQ2FsY3VsYXRlIGxlbmd0aCB3aXRob3V0IGFjdHVhbGx5IGNvbnZlcnRpbmc7IHVzZWZ1bCBmb3IgZG9pbmcgY2hlYXBlciB2YWxpZGF0aW9uLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gc3RyXHJcbiAqIEByZXR1cm4ge251bWJlcn1cclxuICovXHJcbmNvbnN0IHN0cmluZ0xlbmd0aCA9IGZ1bmN0aW9uIChzdHIpIHtcclxuICAgIGxldCBwID0gMDtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgY29uc3QgYyA9IHN0ci5jaGFyQ29kZUF0KGkpO1xyXG4gICAgICAgIGlmIChjIDwgMTI4KSB7XHJcbiAgICAgICAgICAgIHArKztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoYyA8IDIwNDgpIHtcclxuICAgICAgICAgICAgcCArPSAyO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjID49IDB4ZDgwMCAmJiBjIDw9IDB4ZGJmZikge1xyXG4gICAgICAgICAgICAvLyBMZWFkIHN1cnJvZ2F0ZSBvZiBhIHN1cnJvZ2F0ZSBwYWlyLiAgVGhlIHBhaXIgdG9nZXRoZXIgd2lsbCB0YWtlIDQgYnl0ZXMgdG8gcmVwcmVzZW50LlxyXG4gICAgICAgICAgICBwICs9IDQ7XHJcbiAgICAgICAgICAgIGkrKzsgLy8gc2tpcCB0cmFpbCBzdXJyb2dhdGUuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBwICs9IDM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHA7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDb3BpZWQgZnJvbSBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMjExNzUyM1xyXG4gKiBHZW5lcmF0ZXMgYSBuZXcgdXVpZC5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuY29uc3QgdXVpZHY0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuICd4eHh4eHh4eC14eHh4LTR4eHgteXh4eC14eHh4eHh4eHh4eHgnLnJlcGxhY2UoL1t4eV0vZywgYyA9PiB7XHJcbiAgICAgICAgY29uc3QgciA9IChNYXRoLnJhbmRvbSgpICogMTYpIHwgMCwgdiA9IGMgPT09ICd4JyA/IHIgOiAociAmIDB4MykgfCAweDg7XHJcbiAgICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xyXG4gICAgfSk7XHJcbn07XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBUaGUgYW1vdW50IG9mIG1pbGxpc2Vjb25kcyB0byBleHBvbmVudGlhbGx5IGluY3JlYXNlLlxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9JTlRFUlZBTF9NSUxMSVMgPSAxMDAwO1xyXG4vKipcclxuICogVGhlIGZhY3RvciB0byBiYWNrb2ZmIGJ5LlxyXG4gKiBTaG91bGQgYmUgYSBudW1iZXIgZ3JlYXRlciB0aGFuIDEuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0JBQ0tPRkZfRkFDVE9SID0gMjtcclxuLyoqXHJcbiAqIFRoZSBtYXhpbXVtIG1pbGxpc2Vjb25kcyB0byBpbmNyZWFzZSB0by5cclxuICpcclxuICogPHA+VmlzaWJsZSBmb3IgdGVzdGluZ1xyXG4gKi9cclxuY29uc3QgTUFYX1ZBTFVFX01JTExJUyA9IDQgKiA2MCAqIDYwICogMTAwMDsgLy8gRm91ciBob3VycywgbGlrZSBpT1MgYW5kIEFuZHJvaWQuXHJcbi8qKlxyXG4gKiBUaGUgcGVyY2VudGFnZSBvZiBiYWNrb2ZmIHRpbWUgdG8gcmFuZG9taXplIGJ5LlxyXG4gKiBTZWVcclxuICogaHR0cDovL2dvL3NhZmUtY2xpZW50LWJlaGF2aW9yI3N0ZXAtMS1kZXRlcm1pbmUtdGhlLWFwcHJvcHJpYXRlLXJldHJ5LWludGVydmFsLXRvLWhhbmRsZS1zcGlrZS10cmFmZmljXHJcbiAqIGZvciBjb250ZXh0LlxyXG4gKlxyXG4gKiA8cD5WaXNpYmxlIGZvciB0ZXN0aW5nXHJcbiAqL1xyXG5jb25zdCBSQU5ET01fRkFDVE9SID0gMC41O1xyXG4vKipcclxuICogQmFzZWQgb24gdGhlIGJhY2tvZmYgbWV0aG9kIGZyb21cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9jbG9zdXJlLWxpYnJhcnkvYmxvYi9tYXN0ZXIvY2xvc3VyZS9nb29nL21hdGgvZXhwb25lbnRpYWxiYWNrb2ZmLmpzLlxyXG4gKiBFeHRyYWN0ZWQgaGVyZSBzbyB3ZSBkb24ndCBuZWVkIHRvIHBhc3MgbWV0YWRhdGEgYW5kIGEgc3RhdGVmdWwgRXhwb25lbnRpYWxCYWNrb2ZmIG9iamVjdCBhcm91bmQuXHJcbiAqL1xyXG5mdW5jdGlvbiBjYWxjdWxhdGVCYWNrb2ZmTWlsbGlzKGJhY2tvZmZDb3VudCwgaW50ZXJ2YWxNaWxsaXMgPSBERUZBVUxUX0lOVEVSVkFMX01JTExJUywgYmFja29mZkZhY3RvciA9IERFRkFVTFRfQkFDS09GRl9GQUNUT1IpIHtcclxuICAgIC8vIENhbGN1bGF0ZXMgYW4gZXhwb25lbnRpYWxseSBpbmNyZWFzaW5nIHZhbHVlLlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjYWxjdWxhdGVzIHZhbHVlIGZyb20gY291bnQgYW5kIGEgY29uc3RhbnQgaW50ZXJ2YWwsIHNvIHdlIG9ubHkgbmVlZCB0byBzYXZlIHZhbHVlXHJcbiAgICAvLyBhbmQgY291bnQgdG8gcmVzdG9yZSBzdGF0ZS5cclxuICAgIGNvbnN0IGN1cnJCYXNlVmFsdWUgPSBpbnRlcnZhbE1pbGxpcyAqIE1hdGgucG93KGJhY2tvZmZGYWN0b3IsIGJhY2tvZmZDb3VudCk7XHJcbiAgICAvLyBBIHJhbmRvbSBcImZ1enpcIiB0byBhdm9pZCB3YXZlcyBvZiByZXRyaWVzLlxyXG4gICAgLy8gRGV2aWF0aW9uOiByYW5kb21GYWN0b3IgaXMgcmVxdWlyZWQuXHJcbiAgICBjb25zdCByYW5kb21XYWl0ID0gTWF0aC5yb3VuZChcclxuICAgIC8vIEEgZnJhY3Rpb24gb2YgdGhlIGJhY2tvZmYgdmFsdWUgdG8gYWRkL3N1YnRyYWN0LlxyXG4gICAgLy8gRGV2aWF0aW9uOiBjaGFuZ2VzIG11bHRpcGxpY2F0aW9uIG9yZGVyIHRvIGltcHJvdmUgcmVhZGFiaWxpdHkuXHJcbiAgICBSQU5ET01fRkFDVE9SICpcclxuICAgICAgICBjdXJyQmFzZVZhbHVlICpcclxuICAgICAgICAvLyBBIHJhbmRvbSBmbG9hdCAocm91bmRlZCB0byBpbnQgYnkgTWF0aC5yb3VuZCBhYm92ZSkgaW4gdGhlIHJhbmdlIFstMSwgMV0uIERldGVybWluZXNcclxuICAgICAgICAvLyBpZiB3ZSBhZGQgb3Igc3VidHJhY3QuXHJcbiAgICAgICAgKE1hdGgucmFuZG9tKCkgLSAwLjUpICpcclxuICAgICAgICAyKTtcclxuICAgIC8vIExpbWl0cyBiYWNrb2ZmIHRvIG1heCB0byBhdm9pZCBlZmZlY3RpdmVseSBwZXJtYW5lbnQgYmFja29mZi5cclxuICAgIHJldHVybiBNYXRoLm1pbihNQVhfVkFMVUVfTUlMTElTLCBjdXJyQmFzZVZhbHVlICsgcmFuZG9tV2FpdCk7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGUgRW5nbGlzaCBvcmRpbmFsIGxldHRlcnMgYWZ0ZXIgYSBudW1iZXJcclxuICovXHJcbmZ1bmN0aW9uIG9yZGluYWwoaSkge1xyXG4gICAgaWYgKCFOdW1iZXIuaXNGaW5pdGUoaSkpIHtcclxuICAgICAgICByZXR1cm4gYCR7aX1gO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGkgKyBpbmRpY2F0b3IoaSk7XHJcbn1cclxuZnVuY3Rpb24gaW5kaWNhdG9yKGkpIHtcclxuICAgIGkgPSBNYXRoLmFicyhpKTtcclxuICAgIGNvbnN0IGNlbnQgPSBpICUgMTAwO1xyXG4gICAgaWYgKGNlbnQgPj0gMTAgJiYgY2VudCA8PSAyMCkge1xyXG4gICAgICAgIHJldHVybiAndGgnO1xyXG4gICAgfVxyXG4gICAgY29uc3QgZGVjID0gaSAlIDEwO1xyXG4gICAgaWYgKGRlYyA9PT0gMSkge1xyXG4gICAgICAgIHJldHVybiAnc3QnO1xyXG4gICAgfVxyXG4gICAgaWYgKGRlYyA9PT0gMikge1xyXG4gICAgICAgIHJldHVybiAnbmQnO1xyXG4gICAgfVxyXG4gICAgaWYgKGRlYyA9PT0gMykge1xyXG4gICAgICAgIHJldHVybiAncmQnO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuICd0aCc7XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuZnVuY3Rpb24gZ2V0TW9kdWxhckluc3RhbmNlKHNlcnZpY2UpIHtcclxuICAgIGlmIChzZXJ2aWNlICYmIHNlcnZpY2UuX2RlbGVnYXRlKSB7XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2UuX2RlbGVnYXRlO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgQ09OU1RBTlRTLCBEZWNvZGVCYXNlNjRTdHJpbmdFcnJvciwgRGVmZXJyZWQsIEVycm9yRmFjdG9yeSwgRmlyZWJhc2VFcnJvciwgTUFYX1ZBTFVFX01JTExJUywgUkFORE9NX0ZBQ1RPUiwgU2hhMSwgYXJlQ29va2llc0VuYWJsZWQsIGFzc2VydCwgYXNzZXJ0aW9uRXJyb3IsIGFzeW5jLCBiYXNlNjQsIGJhc2U2NERlY29kZSwgYmFzZTY0RW5jb2RlLCBiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZywgY2FsY3VsYXRlQmFja29mZk1pbGxpcywgY29udGFpbnMsIGNyZWF0ZU1vY2tVc2VyVG9rZW4sIGNyZWF0ZVN1YnNjcmliZSwgZGVjb2RlLCBkZWVwQ29weSwgZGVlcEVxdWFsLCBkZWVwRXh0ZW5kLCBlcnJvclByZWZpeCwgZXh0cmFjdFF1ZXJ5c3RyaW5nLCBnZXREZWZhdWx0QXBwQ29uZmlnLCBnZXREZWZhdWx0RW11bGF0b3JIb3N0LCBnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQsIGdldERlZmF1bHRzLCBnZXRFeHBlcmltZW50YWxTZXR0aW5nLCBnZXRHbG9iYWwsIGdldE1vZHVsYXJJbnN0YW5jZSwgZ2V0VUEsIGlzQWRtaW4sIGlzQnJvd3NlciwgaXNCcm93c2VyRXh0ZW5zaW9uLCBpc0VsZWN0cm9uLCBpc0VtcHR5LCBpc0lFLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgaXNNb2JpbGVDb3Jkb3ZhLCBpc05vZGUsIGlzTm9kZVNkaywgaXNSZWFjdE5hdGl2ZSwgaXNTYWZhcmksIGlzVVdQLCBpc1ZhbGlkRm9ybWF0LCBpc1ZhbGlkVGltZXN0YW1wLCBpc3N1ZWRBdFRpbWUsIGpzb25FdmFsLCBtYXAsIG9yZGluYWwsIHByb21pc2VXaXRoVGltZW91dCwgcXVlcnlzdHJpbmcsIHF1ZXJ5c3RyaW5nRGVjb2RlLCBzYWZlR2V0LCBzdHJpbmdMZW5ndGgsIHN0cmluZ1RvQnl0ZUFycmF5LCBzdHJpbmdpZnksIHV1aWR2NCwgdmFsaWRhdGVBcmdDb3VudCwgdmFsaWRhdGVDYWxsYmFjaywgdmFsaWRhdGVDb250ZXh0T2JqZWN0LCB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlLCB2YWxpZGF0ZU5hbWVzcGFjZSB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IERlZmVycmVkIH0gZnJvbSAnQGZpcmViYXNlL3V0aWwnO1xuXG4vKipcclxuICogQ29tcG9uZW50IGZvciBzZXJ2aWNlIG5hbWUgVCwgZS5nLiBgYXV0aGAsIGBhdXRoLWludGVybmFsYFxyXG4gKi9cclxuY2xhc3MgQ29tcG9uZW50IHtcclxuICAgIC8qKlxyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBuYW1lIFRoZSBwdWJsaWMgc2VydmljZSBuYW1lLCBlLmcuIGFwcCwgYXV0aCwgZmlyZXN0b3JlLCBkYXRhYmFzZVxyXG4gICAgICogQHBhcmFtIGluc3RhbmNlRmFjdG9yeSBTZXJ2aWNlIGZhY3RvcnkgcmVzcG9uc2libGUgZm9yIGNyZWF0aW5nIHRoZSBwdWJsaWMgaW50ZXJmYWNlXHJcbiAgICAgKiBAcGFyYW0gdHlwZSB3aGV0aGVyIHRoZSBzZXJ2aWNlIHByb3ZpZGVkIGJ5IHRoZSBjb21wb25lbnQgaXMgcHVibGljIG9yIHByaXZhdGVcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgaW5zdGFuY2VGYWN0b3J5LCB0eXBlKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlRmFjdG9yeSA9IGluc3RhbmNlRmFjdG9yeTtcclxuICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBmYWxzZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBQcm9wZXJ0aWVzIHRvIGJlIGFkZGVkIHRvIHRoZSBzZXJ2aWNlIG5hbWVzcGFjZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0ge307XHJcbiAgICAgICAgdGhpcy5pbnN0YW50aWF0aW9uTW9kZSA9IFwiTEFaWVwiIC8qIEluc3RhbnRpYXRpb25Nb2RlLkxBWlkgKi87XHJcbiAgICAgICAgdGhpcy5vbkluc3RhbmNlQ3JlYXRlZCA9IG51bGw7XHJcbiAgICB9XHJcbiAgICBzZXRJbnN0YW50aWF0aW9uTW9kZShtb2RlKSB7XHJcbiAgICAgICAgdGhpcy5pbnN0YW50aWF0aW9uTW9kZSA9IG1vZGU7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBzZXRNdWx0aXBsZUluc3RhbmNlcyhtdWx0aXBsZUluc3RhbmNlcykge1xyXG4gICAgICAgIHRoaXMubXVsdGlwbGVJbnN0YW5jZXMgPSBtdWx0aXBsZUluc3RhbmNlcztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuICAgIHNldFNlcnZpY2VQcm9wcyhwcm9wcykge1xyXG4gICAgICAgIHRoaXMuc2VydmljZVByb3BzID0gcHJvcHM7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcbiAgICBzZXRJbnN0YW5jZUNyZWF0ZWRDYWxsYmFjayhjYWxsYmFjaykge1xyXG4gICAgICAgIHRoaXMub25JbnN0YW5jZUNyZWF0ZWQgPSBjYWxsYmFjaztcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxufVxuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBERUZBVUxUX0VOVFJZX05BTUUgPSAnW0RFRkFVTFRdJztcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFByb3ZpZGVyIGZvciBpbnN0YW5jZSBmb3Igc2VydmljZSBuYW1lIFQsIGUuZy4gJ2F1dGgnLCAnYXV0aC1pbnRlcm5hbCdcclxuICogTmFtZVNlcnZpY2VNYXBwaW5nW1RdIGlzIGFuIGFsaWFzIGZvciB0aGUgdHlwZSBvZiB0aGUgaW5zdGFuY2VcclxuICovXHJcbmNsYXNzIFByb3ZpZGVyIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQgPSBuZXcgTWFwKCk7XHJcbiAgICAgICAgdGhpcy5pbnN0YW5jZXNPcHRpb25zID0gbmV3IE1hcCgpO1xyXG4gICAgICAgIHRoaXMub25Jbml0Q2FsbGJhY2tzID0gbmV3IE1hcCgpO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcGFyYW0gaWRlbnRpZmllciBBIHByb3ZpZGVyIGNhbiBwcm92aWRlIG11bGl0cGxlIGluc3RhbmNlcyBvZiBhIHNlcnZpY2VcclxuICAgICAqIGlmIHRoaXMuY29tcG9uZW50Lm11bHRpcGxlSW5zdGFuY2VzIGlzIHRydWUuXHJcbiAgICAgKi9cclxuICAgIGdldChpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgLy8gaWYgbXVsdGlwbGVJbnN0YW5jZXMgaXMgbm90IHN1cHBvcnRlZCwgdXNlIHRoZSBkZWZhdWx0IG5hbWVcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5oYXMobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRlZmVycmVkID0gbmV3IERlZmVycmVkKCk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBkZWZlcnJlZCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpIHx8XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3VsZEF1dG9Jbml0aWFsaXplKCkpIHtcclxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgdGhlIHNlcnZpY2UgaWYgaXQgY2FuIGJlIGF1dG8taW5pdGlhbGl6ZWRcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZWRJZGVudGlmaWVyXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyBnZXQoKSwgaXQgc2hvdWxkIG5vdCBjYXVzZVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGEgZmF0YWwgZXJyb3IuIFdlIGp1c3QgcmV0dXJuIHRoZSB1bnJlc29sdmVkIHByb21pc2UgaW4gdGhpcyBjYXNlLlxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmdldChub3JtYWxpemVkSWRlbnRpZmllcikucHJvbWlzZTtcclxuICAgIH1cclxuICAgIGdldEltbWVkaWF0ZShvcHRpb25zKSB7XHJcbiAgICAgICAgdmFyIF9hO1xyXG4gICAgICAgIC8vIGlmIG11bHRpcGxlSW5zdGFuY2VzIGlzIG5vdCBzdXBwb3J0ZWQsIHVzZSB0aGUgZGVmYXVsdCBuYW1lXHJcbiAgICAgICAgY29uc3Qgbm9ybWFsaXplZElkZW50aWZpZXIgPSB0aGlzLm5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMuaWRlbnRpZmllcik7XHJcbiAgICAgICAgY29uc3Qgb3B0aW9uYWwgPSAoX2EgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMub3B0aW9uYWwpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpIHx8XHJcbiAgICAgICAgICAgIHRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0T3JJbml0aWFsaXplU2VydmljZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllclxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25hbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgLy8gSW4gY2FzZSBhIGNvbXBvbmVudCBpcyBub3QgaW5pdGlhbGl6ZWQgYW5kIHNob3VsZC9jYW4gbm90IGJlIGF1dG8taW5pdGlhbGl6ZWQgYXQgdGhlIG1vbWVudCwgcmV0dXJuIG51bGwgaWYgdGhlIG9wdGlvbmFsIGZsYWcgaXMgc2V0LCBvciB0aHJvd1xyXG4gICAgICAgICAgICBpZiAob3B0aW9uYWwpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoYFNlcnZpY2UgJHt0aGlzLm5hbWV9IGlzIG5vdCBhdmFpbGFibGVgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdldENvbXBvbmVudCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb21wb25lbnQ7XHJcbiAgICB9XHJcbiAgICBzZXRDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICAgICAgaWYgKGNvbXBvbmVudC5uYW1lICE9PSB0aGlzLm5hbWUpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYE1pc21hdGNoaW5nIENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBmb3IgUHJvdmlkZXIgJHt0aGlzLm5hbWV9LmApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jb21wb25lbnQpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCBmb3IgJHt0aGlzLm5hbWV9IGhhcyBhbHJlYWR5IGJlZW4gcHJvdmlkZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jb21wb25lbnQgPSBjb21wb25lbnQ7XHJcbiAgICAgICAgLy8gcmV0dXJuIGVhcmx5IHdpdGhvdXQgYXR0ZW1wdGluZyB0byBpbml0aWFsaXplIHRoZSBjb21wb25lbnQgaWYgdGhlIGNvbXBvbmVudCByZXF1aXJlcyBleHBsaWNpdCBpbml0aWFsaXphdGlvbiAoY2FsbGluZyBgUHJvdmlkZXIuaW5pdGlhbGl6ZSgpYClcclxuICAgICAgICBpZiAoIXRoaXMuc2hvdWxkQXV0b0luaXRpYWxpemUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGlmIHRoZSBzZXJ2aWNlIGlzIGVhZ2VyLCBpbml0aWFsaXplIHRoZSBkZWZhdWx0IGluc3RhbmNlXHJcbiAgICAgICAgaWYgKGlzQ29tcG9uZW50RWFnZXIoY29tcG9uZW50KSkge1xyXG4gICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHsgaW5zdGFuY2VJZGVudGlmaWVyOiBERUZBVUxUX0VOVFJZX05BTUUgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcclxuICAgICAgICAgICAgICAgIC8vIHdoZW4gdGhlIGluc3RhbmNlIGZhY3RvcnkgZm9yIGFuIGVhZ2VyIENvbXBvbmVudCB0aHJvd3MgYW4gZXhjZXB0aW9uIGR1cmluZyB0aGUgZWFnZXJcclxuICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemF0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlIGEgZmF0YWwgZXJyb3IuXHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBJbnZlc3RpZ2F0ZSBpZiB3ZSBuZWVkIHRvIG1ha2UgaXQgY29uZmlndXJhYmxlLCBiZWNhdXNlIHNvbWUgY29tcG9uZW50IG1heSB3YW50IHRvIGNhdXNlXHJcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yIGluIHRoaXMgY2FzZT9cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDcmVhdGUgc2VydmljZSBpbnN0YW5jZXMgZm9yIHRoZSBwZW5kaW5nIHByb21pc2VzIGFuZCByZXNvbHZlIHRoZW1cclxuICAgICAgICAvLyBOT1RFOiBpZiB0aGlzLm11bHRpcGxlSW5zdGFuY2VzIGlzIGZhbHNlLCBvbmx5IHRoZSBkZWZhdWx0IGluc3RhbmNlIHdpbGwgYmUgY3JlYXRlZFxyXG4gICAgICAgIC8vIGFuZCBhbGwgcHJvbWlzZXMgd2l0aCByZXNvbHZlIHdpdGggaXQgcmVnYXJkbGVzcyBvZiB0aGUgaWRlbnRpZmllci5cclxuICAgICAgICBmb3IgKGNvbnN0IFtpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlRGVmZXJyZWRdIG9mIHRoaXMuaW5zdGFuY2VzRGVmZXJyZWQuZW50cmllcygpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIC8vIGBnZXRPckluaXRpYWxpemVTZXJ2aWNlKClgIHNob3VsZCBhbHdheXMgcmV0dXJuIGEgdmFsaWQgaW5zdGFuY2Ugc2luY2UgYSBjb21wb25lbnQgaXMgZ3VhcmFudGVlZC4gdXNlICEgdG8gbWFrZSB0eXBlc2NyaXB0IGhhcHB5LlxyXG4gICAgICAgICAgICAgICAgY29uc3QgaW5zdGFuY2UgPSB0aGlzLmdldE9ySW5pdGlhbGl6ZVNlcnZpY2Uoe1xyXG4gICAgICAgICAgICAgICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogbm9ybWFsaXplZElkZW50aWZpZXJcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VEZWZlcnJlZC5yZXNvbHZlKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gd2hlbiB0aGUgaW5zdGFuY2UgZmFjdG9yeSB0aHJvd3MgYW4gZXhjZXB0aW9uLCBpdCBzaG91bGQgbm90IGNhdXNlXHJcbiAgICAgICAgICAgICAgICAvLyBhIGZhdGFsIGVycm9yLiBXZSBqdXN0IGxlYXZlIHRoZSBwcm9taXNlIHVucmVzb2x2ZWQuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjbGVhckluc3RhbmNlKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc0RlZmVycmVkLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgICAgICB0aGlzLmluc3RhbmNlc09wdGlvbnMuZGVsZXRlKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIHRoaXMuaW5zdGFuY2VzLmRlbGV0ZShpZGVudGlmaWVyKTtcclxuICAgIH1cclxuICAgIC8vIGFwcC5kZWxldGUoKSB3aWxsIGNhbGwgdGhpcyBtZXRob2Qgb24gZXZlcnkgcHJvdmlkZXIgdG8gZGVsZXRlIHRoZSBzZXJ2aWNlc1xyXG4gICAgLy8gVE9ETzogc2hvdWxkIHdlIG1hcmsgdGhlIHByb3ZpZGVyIGFzIGRlbGV0ZWQ/XHJcbiAgICBhc3luYyBkZWxldGUoKSB7XHJcbiAgICAgICAgY29uc3Qgc2VydmljZXMgPSBBcnJheS5mcm9tKHRoaXMuaW5zdGFuY2VzLnZhbHVlcygpKTtcclxuICAgICAgICBhd2FpdCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgICAgIC4uLnNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ0lOVEVSTkFMJyBpbiBzZXJ2aWNlKSAvLyBsZWdhY3kgc2VydmljZXNcclxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XHJcbiAgICAgICAgICAgICAgICAubWFwKHNlcnZpY2UgPT4gc2VydmljZS5JTlRFUk5BTC5kZWxldGUoKSksXHJcbiAgICAgICAgICAgIC4uLnNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKHNlcnZpY2UgPT4gJ19kZWxldGUnIGluIHNlcnZpY2UpIC8vIG1vZHVsYXJpemVkIHNlcnZpY2VzXHJcbiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxyXG4gICAgICAgICAgICAgICAgLm1hcChzZXJ2aWNlID0+IHNlcnZpY2UuX2RlbGV0ZSgpKVxyXG4gICAgICAgIF0pO1xyXG4gICAgfVxyXG4gICAgaXNDb21wb25lbnRTZXQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY29tcG9uZW50ICE9IG51bGw7XHJcbiAgICB9XHJcbiAgICBpc0luaXRpYWxpemVkKGlkZW50aWZpZXIgPSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZXMuaGFzKGlkZW50aWZpZXIpO1xyXG4gICAgfVxyXG4gICAgZ2V0T3B0aW9ucyhpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5nZXQoaWRlbnRpZmllcikgfHwge307XHJcbiAgICB9XHJcbiAgICBpbml0aWFsaXplKG9wdHMgPSB7fSkge1xyXG4gICAgICAgIGNvbnN0IHsgb3B0aW9ucyA9IHt9IH0gPSBvcHRzO1xyXG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJZGVudGlmaWVyID0gdGhpcy5ub3JtYWxpemVJbnN0YW5jZUlkZW50aWZpZXIob3B0cy5pbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICh0aGlzLmlzSW5pdGlhbGl6ZWQobm9ybWFsaXplZElkZW50aWZpZXIpKSB7XHJcbiAgICAgICAgICAgIHRocm93IEVycm9yKGAke3RoaXMubmFtZX0oJHtub3JtYWxpemVkSWRlbnRpZmllcn0pIGhhcyBhbHJlYWR5IGJlZW4gaW5pdGlhbGl6ZWRgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmlzQ29tcG9uZW50U2V0KCkpIHtcclxuICAgICAgICAgICAgdGhyb3cgRXJyb3IoYENvbXBvbmVudCAke3RoaXMubmFtZX0gaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQgeWV0YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGluc3RhbmNlID0gdGhpcy5nZXRPckluaXRpYWxpemVTZXJ2aWNlKHtcclxuICAgICAgICAgICAgaW5zdGFuY2VJZGVudGlmaWVyOiBub3JtYWxpemVkSWRlbnRpZmllcixcclxuICAgICAgICAgICAgb3B0aW9uc1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIHJlc29sdmUgYW55IHBlbmRpbmcgcHJvbWlzZSB3YWl0aW5nIGZvciB0aGUgc2VydmljZSBpbnN0YW5jZVxyXG4gICAgICAgIGZvciAoY29uc3QgW2luc3RhbmNlSWRlbnRpZmllciwgaW5zdGFuY2VEZWZlcnJlZF0gb2YgdGhpcy5pbnN0YW5jZXNEZWZlcnJlZC5lbnRyaWVzKCkpIHtcclxuICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbiAgICAgICAgICAgIGlmIChub3JtYWxpemVkSWRlbnRpZmllciA9PT0gbm9ybWFsaXplZERlZmVycmVkSWRlbnRpZmllcikge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2VEZWZlcnJlZC5yZXNvbHZlKGluc3RhbmNlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2U7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgLSBhIGZ1bmN0aW9uIHRoYXQgd2lsbCBiZSBpbnZva2VkICBhZnRlciB0aGUgcHJvdmlkZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWQgYnkgY2FsbGluZyBwcm92aWRlci5pbml0aWFsaXplKCkuXHJcbiAgICAgKiBUaGUgZnVuY3Rpb24gaXMgaW52b2tlZCBTWU5DSFJPTk9VU0xZLCBzbyBpdCBzaG91bGQgbm90IGV4ZWN1dGUgYW55IGxvbmdydW5uaW5nIHRhc2tzIGluIG9yZGVyIHRvIG5vdCBibG9jayB0aGUgcHJvZ3JhbS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gaWRlbnRpZmllciBBbiBvcHRpb25hbCBpbnN0YW5jZSBpZGVudGlmaWVyXHJcbiAgICAgKiBAcmV0dXJucyBhIGZ1bmN0aW9uIHRvIHVucmVnaXN0ZXIgdGhlIGNhbGxiYWNrXHJcbiAgICAgKi9cclxuICAgIG9uSW5pdChjYWxsYmFjaywgaWRlbnRpZmllcikge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBjb25zdCBub3JtYWxpemVkSWRlbnRpZmllciA9IHRoaXMubm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyKGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ2FsbGJhY2tzID0gKF9hID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogbmV3IFNldCgpO1xyXG4gICAgICAgIGV4aXN0aW5nQ2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XHJcbiAgICAgICAgdGhpcy5vbkluaXRDYWxsYmFja3Muc2V0KG5vcm1hbGl6ZWRJZGVudGlmaWVyLCBleGlzdGluZ0NhbGxiYWNrcyk7XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdJbnN0YW5jZSA9IHRoaXMuaW5zdGFuY2VzLmdldChub3JtYWxpemVkSWRlbnRpZmllcik7XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nSW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgY2FsbGJhY2soZXhpc3RpbmdJbnN0YW5jZSwgbm9ybWFsaXplZElkZW50aWZpZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBleGlzdGluZ0NhbGxiYWNrcy5kZWxldGUoY2FsbGJhY2spO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIEludm9rZSBvbkluaXQgY2FsbGJhY2tzIHN5bmNocm9ub3VzbHlcclxuICAgICAqIEBwYXJhbSBpbnN0YW5jZSB0aGUgc2VydmljZSBpbnN0YW5jZWBcclxuICAgICAqL1xyXG4gICAgaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpZGVudGlmaWVyKSB7XHJcbiAgICAgICAgY29uc3QgY2FsbGJhY2tzID0gdGhpcy5vbkluaXRDYWxsYmFja3MuZ2V0KGlkZW50aWZpZXIpO1xyXG4gICAgICAgIGlmICghY2FsbGJhY2tzKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChjb25zdCBjYWxsYmFjayBvZiBjYWxsYmFja3MpIHtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKGluc3RhbmNlLCBpZGVudGlmaWVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXRjaCAoX2EpIHtcclxuICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5pdCBjYWxsYmFja1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgZ2V0T3JJbml0aWFsaXplU2VydmljZSh7IGluc3RhbmNlSWRlbnRpZmllciwgb3B0aW9ucyA9IHt9IH0pIHtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzLmluc3RhbmNlcy5nZXQoaW5zdGFuY2VJZGVudGlmaWVyKTtcclxuICAgICAgICBpZiAoIWluc3RhbmNlICYmIHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlID0gdGhpcy5jb21wb25lbnQuaW5zdGFuY2VGYWN0b3J5KHRoaXMuY29udGFpbmVyLCB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZUlkZW50aWZpZXI6IG5vcm1hbGl6ZUlkZW50aWZpZXJGb3JGYWN0b3J5KGluc3RhbmNlSWRlbnRpZmllciksXHJcbiAgICAgICAgICAgICAgICBvcHRpb25zXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7XHJcbiAgICAgICAgICAgIHRoaXMuaW5zdGFuY2VzT3B0aW9ucy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBvcHRpb25zKTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEludm9rZSBvbkluaXQgbGlzdGVuZXJzLlxyXG4gICAgICAgICAgICAgKiBOb3RlIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkIGlzIGRpZmZlcmVudCwgd2hpY2ggaXMgdXNlZCBieSB0aGUgY29tcG9uZW50IGNyZWF0b3IsXHJcbiAgICAgICAgICAgICAqIHdoaWxlIG9uSW5pdCBsaXN0ZW5lcnMgYXJlIHJlZ2lzdGVyZWQgYnkgY29uc3VtZXJzIG9mIHRoZSBwcm92aWRlci5cclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIHRoaXMuaW52b2tlT25Jbml0Q2FsbGJhY2tzKGluc3RhbmNlLCBpbnN0YW5jZUlkZW50aWZpZXIpO1xyXG4gICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICogT3JkZXIgaXMgaW1wb3J0YW50XHJcbiAgICAgICAgICAgICAqIG9uSW5zdGFuY2VDcmVhdGVkKCkgc2hvdWxkIGJlIGNhbGxlZCBhZnRlciB0aGlzLmluc3RhbmNlcy5zZXQoaW5zdGFuY2VJZGVudGlmaWVyLCBpbnN0YW5jZSk7IHdoaWNoXHJcbiAgICAgICAgICAgICAqIG1ha2VzIGBpc0luaXRpYWxpemVkKClgIHJldHVybiB0cnVlLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKSB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29tcG9uZW50Lm9uSW5zdGFuY2VDcmVhdGVkKHRoaXMuY29udGFpbmVyLCBpbnN0YW5jZUlkZW50aWZpZXIsIGluc3RhbmNlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChfYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZSBlcnJvcnMgaW4gdGhlIG9uSW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gaW5zdGFuY2UgfHwgbnVsbDtcclxuICAgIH1cclxuICAgIG5vcm1hbGl6ZUluc3RhbmNlSWRlbnRpZmllcihpZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY29tcG9uZW50KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5tdWx0aXBsZUluc3RhbmNlcyA/IGlkZW50aWZpZXIgOiBERUZBVUxUX0VOVFJZX05BTUU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4gaWRlbnRpZmllcjsgLy8gYXNzdW1lIG11bHRpcGxlIGluc3RhbmNlcyBhcmUgc3VwcG9ydGVkIGJlZm9yZSB0aGUgY29tcG9uZW50IGlzIHByb3ZpZGVkLlxyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHNob3VsZEF1dG9Jbml0aWFsaXplKCkge1xyXG4gICAgICAgIHJldHVybiAoISF0aGlzLmNvbXBvbmVudCAmJlxyXG4gICAgICAgICAgICB0aGlzLmNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSAhPT0gXCJFWFBMSUNJVFwiIC8qIEluc3RhbnRpYXRpb25Nb2RlLkVYUExJQ0lUICovKTtcclxuICAgIH1cclxufVxyXG4vLyB1bmRlZmluZWQgc2hvdWxkIGJlIHBhc3NlZCB0byB0aGUgc2VydmljZSBmYWN0b3J5IGZvciB0aGUgZGVmYXVsdCBpbnN0YW5jZVxyXG5mdW5jdGlvbiBub3JtYWxpemVJZGVudGlmaWVyRm9yRmFjdG9yeShpZGVudGlmaWVyKSB7XHJcbiAgICByZXR1cm4gaWRlbnRpZmllciA9PT0gREVGQVVMVF9FTlRSWV9OQU1FID8gdW5kZWZpbmVkIDogaWRlbnRpZmllcjtcclxufVxyXG5mdW5jdGlvbiBpc0NvbXBvbmVudEVhZ2VyKGNvbXBvbmVudCkge1xyXG4gICAgcmV0dXJuIGNvbXBvbmVudC5pbnN0YW50aWF0aW9uTW9kZSA9PT0gXCJFQUdFUlwiIC8qIEluc3RhbnRpYXRpb25Nb2RlLkVBR0VSICovO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbi8qKlxyXG4gKiBDb21wb25lbnRDb250YWluZXIgdGhhdCBwcm92aWRlcyBQcm92aWRlcnMgZm9yIHNlcnZpY2UgbmFtZSBULCBlLmcuIGBhdXRoYCwgYGF1dGgtaW50ZXJuYWxgXHJcbiAqL1xyXG5jbGFzcyBDb21wb25lbnRDb250YWluZXIge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSkge1xyXG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5wcm92aWRlcnMgPSBuZXcgTWFwKCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gY29tcG9uZW50IENvbXBvbmVudCBiZWluZyBhZGRlZFxyXG4gICAgICogQHBhcmFtIG92ZXJ3cml0ZSBXaGVuIGEgY29tcG9uZW50IHdpdGggdGhlIHNhbWUgbmFtZSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQsXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgdHJ1ZTogb3ZlcndyaXRlIHRoZSBleGlzdGluZyBjb21wb25lbnQgd2l0aCB0aGUgbmV3IGNvbXBvbmVudCBhbmQgY3JlYXRlIGEgbmV3XHJcbiAgICAgKiBwcm92aWRlciB3aXRoIHRoZSBuZXcgY29tcG9uZW50LiBJdCBjYW4gYmUgdXNlZnVsIGluIHRlc3RzIHdoZXJlIHlvdSB3YW50IHRvIHVzZSBkaWZmZXJlbnQgbW9ja3NcclxuICAgICAqIGZvciBkaWZmZXJlbnQgdGVzdHMuXHJcbiAgICAgKiBpZiBvdmVyd3JpdGUgaXMgZmFsc2U6IHRocm93IGFuIGV4Y2VwdGlvblxyXG4gICAgICovXHJcbiAgICBhZGRDb21wb25lbnQoY29tcG9uZW50KSB7XHJcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmdldFByb3ZpZGVyKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICBpZiAocHJvdmlkZXIuaXNDb21wb25lbnRTZXQoKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvbXBvbmVudCAke2NvbXBvbmVudC5uYW1lfSBoYXMgYWxyZWFkeSBiZWVuIHJlZ2lzdGVyZWQgd2l0aCAke3RoaXMubmFtZX1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcHJvdmlkZXIuc2V0Q29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICBhZGRPck92ZXJ3cml0ZUNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgICAgICBjb25zdCBwcm92aWRlciA9IHRoaXMuZ2V0UHJvdmlkZXIoY29tcG9uZW50Lm5hbWUpO1xyXG4gICAgICAgIGlmIChwcm92aWRlci5pc0NvbXBvbmVudFNldCgpKSB7XHJcbiAgICAgICAgICAgIC8vIGRlbGV0ZSB0aGUgZXhpc3RpbmcgcHJvdmlkZXIgZnJvbSB0aGUgY29udGFpbmVyLCBzbyB3ZSBjYW4gcmVnaXN0ZXIgdGhlIG5ldyBjb21wb25lbnRcclxuICAgICAgICAgICAgdGhpcy5wcm92aWRlcnMuZGVsZXRlKGNvbXBvbmVudC5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogZ2V0UHJvdmlkZXIgcHJvdmlkZXMgYSB0eXBlIHNhZmUgaW50ZXJmYWNlIHdoZXJlIGl0IGNhbiBvbmx5IGJlIGNhbGxlZCB3aXRoIGEgZmllbGQgbmFtZVxyXG4gICAgICogcHJlc2VudCBpbiBOYW1lU2VydmljZU1hcHBpbmcgaW50ZXJmYWNlLlxyXG4gICAgICpcclxuICAgICAqIEZpcmViYXNlIFNES3MgcHJvdmlkaW5nIHNlcnZpY2VzIHNob3VsZCBleHRlbmQgTmFtZVNlcnZpY2VNYXBwaW5nIGludGVyZmFjZSB0byByZWdpc3RlclxyXG4gICAgICogdGhlbXNlbHZlcy5cclxuICAgICAqL1xyXG4gICAgZ2V0UHJvdmlkZXIobmFtZSkge1xyXG4gICAgICAgIGlmICh0aGlzLnByb3ZpZGVycy5oYXMobmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvdmlkZXJzLmdldChuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gY3JlYXRlIGEgUHJvdmlkZXIgZm9yIGEgc2VydmljZSB0aGF0IGhhc24ndCByZWdpc3RlcmVkIHdpdGggRmlyZWJhc2VcclxuICAgICAgICBjb25zdCBwcm92aWRlciA9IG5ldyBQcm92aWRlcihuYW1lLCB0aGlzKTtcclxuICAgICAgICB0aGlzLnByb3ZpZGVycy5zZXQobmFtZSwgcHJvdmlkZXIpO1xyXG4gICAgICAgIHJldHVybiBwcm92aWRlcjtcclxuICAgIH1cclxuICAgIGdldFByb3ZpZGVycygpIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnByb3ZpZGVycy52YWx1ZXMoKSk7XHJcbiAgICB9XHJcbn1cblxuZXhwb3J0IHsgQ29tcG9uZW50LCBDb21wb25lbnRDb250YWluZXIsIFByb3ZpZGVyIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEEgY29udGFpbmVyIGZvciBhbGwgb2YgdGhlIExvZ2dlciBpbnN0YW5jZXNcclxuICovXHJcbmNvbnN0IGluc3RhbmNlcyA9IFtdO1xyXG4vKipcclxuICogVGhlIEpTIFNESyBzdXBwb3J0cyA1IGxvZyBsZXZlbHMgYW5kIGFsc28gYWxsb3dzIGEgdXNlciB0aGUgYWJpbGl0eSB0b1xyXG4gKiBzaWxlbmNlIHRoZSBsb2dzIGFsdG9nZXRoZXIuXHJcbiAqXHJcbiAqIFRoZSBvcmRlciBpcyBhIGZvbGxvd3M6XHJcbiAqIERFQlVHIDwgVkVSQk9TRSA8IElORk8gPCBXQVJOIDwgRVJST1JcclxuICpcclxuICogQWxsIG9mIHRoZSBsb2cgdHlwZXMgYWJvdmUgdGhlIGN1cnJlbnQgbG9nIGxldmVsIHdpbGwgYmUgY2FwdHVyZWQgKGkuZS4gaWZcclxuICogeW91IHNldCB0aGUgbG9nIGxldmVsIHRvIGBJTkZPYCwgZXJyb3JzIHdpbGwgc3RpbGwgYmUgbG9nZ2VkLCBidXQgYERFQlVHYCBhbmRcclxuICogYFZFUkJPU0VgIGxvZ3Mgd2lsbCBub3QpXHJcbiAqL1xyXG52YXIgTG9nTGV2ZWw7XHJcbihmdW5jdGlvbiAoTG9nTGV2ZWwpIHtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiREVCVUdcIl0gPSAwXSA9IFwiREVCVUdcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiVkVSQk9TRVwiXSA9IDFdID0gXCJWRVJCT1NFXCI7XHJcbiAgICBMb2dMZXZlbFtMb2dMZXZlbFtcIklORk9cIl0gPSAyXSA9IFwiSU5GT1wiO1xyXG4gICAgTG9nTGV2ZWxbTG9nTGV2ZWxbXCJXQVJOXCJdID0gM10gPSBcIldBUk5cIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiRVJST1JcIl0gPSA0XSA9IFwiRVJST1JcIjtcclxuICAgIExvZ0xldmVsW0xvZ0xldmVsW1wiU0lMRU5UXCJdID0gNV0gPSBcIlNJTEVOVFwiO1xyXG59KShMb2dMZXZlbCB8fCAoTG9nTGV2ZWwgPSB7fSkpO1xyXG5jb25zdCBsZXZlbFN0cmluZ1RvRW51bSA9IHtcclxuICAgICdkZWJ1Zyc6IExvZ0xldmVsLkRFQlVHLFxyXG4gICAgJ3ZlcmJvc2UnOiBMb2dMZXZlbC5WRVJCT1NFLFxyXG4gICAgJ2luZm8nOiBMb2dMZXZlbC5JTkZPLFxyXG4gICAgJ3dhcm4nOiBMb2dMZXZlbC5XQVJOLFxyXG4gICAgJ2Vycm9yJzogTG9nTGV2ZWwuRVJST1IsXHJcbiAgICAnc2lsZW50JzogTG9nTGV2ZWwuU0lMRU5UXHJcbn07XHJcbi8qKlxyXG4gKiBUaGUgZGVmYXVsdCBsb2cgbGV2ZWxcclxuICovXHJcbmNvbnN0IGRlZmF1bHRMb2dMZXZlbCA9IExvZ0xldmVsLklORk87XHJcbi8qKlxyXG4gKiBCeSBkZWZhdWx0LCBgY29uc29sZS5kZWJ1Z2AgaXMgbm90IGRpc3BsYXllZCBpbiB0aGUgZGV2ZWxvcGVyIGNvbnNvbGUgKGluXHJcbiAqIGNocm9tZSkuIFRvIGF2b2lkIGZvcmNpbmcgdXNlcnMgdG8gaGF2ZSB0byBvcHQtaW4gdG8gdGhlc2UgbG9ncyB0d2ljZVxyXG4gKiAoaS5lLiBvbmNlIGZvciBmaXJlYmFzZSwgYW5kIG9uY2UgaW4gdGhlIGNvbnNvbGUpLCB3ZSBhcmUgc2VuZGluZyBgREVCVUdgXHJcbiAqIGxvZ3MgdG8gdGhlIGBjb25zb2xlLmxvZ2AgZnVuY3Rpb24uXHJcbiAqL1xyXG5jb25zdCBDb25zb2xlTWV0aG9kID0ge1xyXG4gICAgW0xvZ0xldmVsLkRFQlVHXTogJ2xvZycsXHJcbiAgICBbTG9nTGV2ZWwuVkVSQk9TRV06ICdsb2cnLFxyXG4gICAgW0xvZ0xldmVsLklORk9dOiAnaW5mbycsXHJcbiAgICBbTG9nTGV2ZWwuV0FSTl06ICd3YXJuJyxcclxuICAgIFtMb2dMZXZlbC5FUlJPUl06ICdlcnJvcidcclxufTtcclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGxvZyBoYW5kbGVyIHdpbGwgZm9yd2FyZCBERUJVRywgVkVSQk9TRSwgSU5GTywgV0FSTiwgYW5kIEVSUk9SXHJcbiAqIG1lc3NhZ2VzIG9uIHRvIHRoZWlyIGNvcnJlc3BvbmRpbmcgY29uc29sZSBjb3VudGVycGFydHMgKGlmIHRoZSBsb2cgbWV0aG9kXHJcbiAqIGlzIHN1cHBvcnRlZCBieSB0aGUgY3VycmVudCBsb2cgbGV2ZWwpXHJcbiAqL1xyXG5jb25zdCBkZWZhdWx0TG9nSGFuZGxlciA9IChpbnN0YW5jZSwgbG9nVHlwZSwgLi4uYXJncykgPT4ge1xyXG4gICAgaWYgKGxvZ1R5cGUgPCBpbnN0YW5jZS5sb2dMZXZlbCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKTtcclxuICAgIGNvbnN0IG1ldGhvZCA9IENvbnNvbGVNZXRob2RbbG9nVHlwZV07XHJcbiAgICBpZiAobWV0aG9kKSB7XHJcbiAgICAgICAgY29uc29sZVttZXRob2RdKGBbJHtub3d9XSAgJHtpbnN0YW5jZS5uYW1lfTpgLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgQXR0ZW1wdGVkIHRvIGxvZyBhIG1lc3NhZ2Ugd2l0aCBhbiBpbnZhbGlkIGxvZ1R5cGUgKHZhbHVlOiAke2xvZ1R5cGV9KWApO1xyXG4gICAgfVxyXG59O1xyXG5jbGFzcyBMb2dnZXIge1xyXG4gICAgLyoqXHJcbiAgICAgKiBHaXZlcyB5b3UgYW4gaW5zdGFuY2Ugb2YgYSBMb2dnZXIgdG8gY2FwdHVyZSBtZXNzYWdlcyBhY2NvcmRpbmcgdG9cclxuICAgICAqIEZpcmViYXNlJ3MgbG9nZ2luZyBzY2hlbWUuXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtIG5hbWUgVGhlIG5hbWUgdGhhdCB0aGUgbG9ncyB3aWxsIGJlIGFzc29jaWF0ZWQgd2l0aFxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBUaGUgbG9nIGxldmVsIG9mIHRoZSBnaXZlbiBMb2dnZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSBkZWZhdWx0TG9nTGV2ZWw7XHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogVGhlIG1haW4gKGludGVybmFsKSBsb2cgaGFuZGxlciBmb3IgdGhlIExvZ2dlciBpbnN0YW5jZS5cclxuICAgICAgICAgKiBDYW4gYmUgc2V0IHRvIGEgbmV3IGZ1bmN0aW9uIGluIGludGVybmFsIHBhY2thZ2UgY29kZSBidXQgbm90IGJ5IHVzZXIuXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IGRlZmF1bHRMb2dIYW5kbGVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFRoZSBvcHRpb25hbCwgYWRkaXRpb25hbCwgdXNlci1kZWZpbmVkIGxvZyBoYW5kbGVyIGZvciB0aGUgTG9nZ2VyIGluc3RhbmNlLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyID0gbnVsbDtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDYXB0dXJlIHRoZSBjdXJyZW50IGluc3RhbmNlIGZvciBsYXRlciB1c2VcclxuICAgICAgICAgKi9cclxuICAgICAgICBpbnN0YW5jZXMucHVzaCh0aGlzKTtcclxuICAgIH1cclxuICAgIGdldCBsb2dMZXZlbCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbG9nTGV2ZWw7XHJcbiAgICB9XHJcbiAgICBzZXQgbG9nTGV2ZWwodmFsKSB7XHJcbiAgICAgICAgaWYgKCEodmFsIGluIExvZ0xldmVsKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBJbnZhbGlkIHZhbHVlIFwiJHt2YWx9XCIgYXNzaWduZWQgdG8gXFxgbG9nTGV2ZWxcXGBgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB2YWw7XHJcbiAgICB9XHJcbiAgICAvLyBXb3JrYXJvdW5kIGZvciBzZXR0ZXIvZ2V0dGVyIGhhdmluZyB0byBiZSB0aGUgc2FtZSB0eXBlLlxyXG4gICAgc2V0TG9nTGV2ZWwodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fbG9nTGV2ZWwgPSB0eXBlb2YgdmFsID09PSAnc3RyaW5nJyA/IGxldmVsU3RyaW5nVG9FbnVtW3ZhbF0gOiB2YWw7XHJcbiAgICB9XHJcbiAgICBnZXQgbG9nSGFuZGxlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fbG9nSGFuZGxlcjtcclxuICAgIH1cclxuICAgIHNldCBsb2dIYW5kbGVyKHZhbCkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgdmFsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1ZhbHVlIGFzc2lnbmVkIHRvIGBsb2dIYW5kbGVyYCBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlciA9IHZhbDtcclxuICAgIH1cclxuICAgIGdldCB1c2VyTG9nSGFuZGxlcigpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckxvZ0hhbmRsZXI7XHJcbiAgICB9XHJcbiAgICBzZXQgdXNlckxvZ0hhbmRsZXIodmFsKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgPSB2YWw7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIFRoZSBmdW5jdGlvbnMgYmVsb3cgYXJlIGFsbCBiYXNlZCBvbiB0aGUgYGNvbnNvbGVgIGludGVyZmFjZVxyXG4gICAgICovXHJcbiAgICBkZWJ1ZyguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuREVCVUcsIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuREVCVUcsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgbG9nKC4uLmFyZ3MpIHtcclxuICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlciAmJlxyXG4gICAgICAgICAgICB0aGlzLl91c2VyTG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5WRVJCT1NFLCAuLi5hcmdzKTtcclxuICAgICAgICB0aGlzLl9sb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLlZFUkJPU0UsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgaW5mbyguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuSU5GTywgLi4uYXJncyk7XHJcbiAgICAgICAgdGhpcy5fbG9nSGFuZGxlcih0aGlzLCBMb2dMZXZlbC5JTkZPLCAuLi5hcmdzKTtcclxuICAgIH1cclxuICAgIHdhcm4oLi4uYXJncykge1xyXG4gICAgICAgIHRoaXMuX3VzZXJMb2dIYW5kbGVyICYmIHRoaXMuX3VzZXJMb2dIYW5kbGVyKHRoaXMsIExvZ0xldmVsLldBUk4sIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuV0FSTiwgLi4uYXJncyk7XHJcbiAgICB9XHJcbiAgICBlcnJvciguLi5hcmdzKSB7XHJcbiAgICAgICAgdGhpcy5fdXNlckxvZ0hhbmRsZXIgJiYgdGhpcy5fdXNlckxvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuRVJST1IsIC4uLmFyZ3MpO1xyXG4gICAgICAgIHRoaXMuX2xvZ0hhbmRsZXIodGhpcywgTG9nTGV2ZWwuRVJST1IsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG59XHJcbmZ1bmN0aW9uIHNldExvZ0xldmVsKGxldmVsKSB7XHJcbiAgICBpbnN0YW5jZXMuZm9yRWFjaChpbnN0ID0+IHtcclxuICAgICAgICBpbnN0LnNldExvZ0xldmVsKGxldmVsKTtcclxuICAgIH0pO1xyXG59XHJcbmZ1bmN0aW9uIHNldFVzZXJMb2dIYW5kbGVyKGxvZ0NhbGxiYWNrLCBvcHRpb25zKSB7XHJcbiAgICBmb3IgKGNvbnN0IGluc3RhbmNlIG9mIGluc3RhbmNlcykge1xyXG4gICAgICAgIGxldCBjdXN0b21Mb2dMZXZlbCA9IG51bGw7XHJcbiAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5sZXZlbCkge1xyXG4gICAgICAgICAgICBjdXN0b21Mb2dMZXZlbCA9IGxldmVsU3RyaW5nVG9FbnVtW29wdGlvbnMubGV2ZWxdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAobG9nQ2FsbGJhY2sgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXNlckxvZ0hhbmRsZXIgPSBudWxsO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXNlckxvZ0hhbmRsZXIgPSAoaW5zdGFuY2UsIGxldmVsLCAuLi5hcmdzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlID0gYXJnc1xyXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoYXJnID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXJnID09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmc7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHR5cGVvZiBhcmcgPT09ICdudW1iZXInIHx8IHR5cGVvZiBhcmcgPT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXJnLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFyZyBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhcmcubWVzc2FnZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoaWdub3JlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoYXJnID0+IGFyZylcclxuICAgICAgICAgICAgICAgICAgICAuam9pbignICcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGxldmVsID49IChjdXN0b21Mb2dMZXZlbCAhPT0gbnVsbCAmJiBjdXN0b21Mb2dMZXZlbCAhPT0gdm9pZCAwID8gY3VzdG9tTG9nTGV2ZWwgOiBpbnN0YW5jZS5sb2dMZXZlbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsb2dDYWxsYmFjayh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBMb2dMZXZlbFtsZXZlbF0udG9Mb3dlckNhc2UoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXJncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogaW5zdGFuY2UubmFtZVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxuXG5leHBvcnQgeyBMb2dMZXZlbCwgTG9nZ2VyLCBzZXRMb2dMZXZlbCwgc2V0VXNlckxvZ0hhbmRsZXIgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJjb25zdCBpbnN0YW5jZU9mQW55ID0gKG9iamVjdCwgY29uc3RydWN0b3JzKSA9PiBjb25zdHJ1Y3RvcnMuc29tZSgoYykgPT4gb2JqZWN0IGluc3RhbmNlb2YgYyk7XG5cbmxldCBpZGJQcm94eWFibGVUeXBlcztcbmxldCBjdXJzb3JBZHZhbmNlTWV0aG9kcztcbi8vIFRoaXMgaXMgYSBmdW5jdGlvbiB0byBwcmV2ZW50IGl0IHRocm93aW5nIHVwIGluIG5vZGUgZW52aXJvbm1lbnRzLlxuZnVuY3Rpb24gZ2V0SWRiUHJveHlhYmxlVHlwZXMoKSB7XG4gICAgcmV0dXJuIChpZGJQcm94eWFibGVUeXBlcyB8fFxuICAgICAgICAoaWRiUHJveHlhYmxlVHlwZXMgPSBbXG4gICAgICAgICAgICBJREJEYXRhYmFzZSxcbiAgICAgICAgICAgIElEQk9iamVjdFN0b3JlLFxuICAgICAgICAgICAgSURCSW5kZXgsXG4gICAgICAgICAgICBJREJDdXJzb3IsXG4gICAgICAgICAgICBJREJUcmFuc2FjdGlvbixcbiAgICAgICAgXSkpO1xufVxuLy8gVGhpcyBpcyBhIGZ1bmN0aW9uIHRvIHByZXZlbnQgaXQgdGhyb3dpbmcgdXAgaW4gbm9kZSBlbnZpcm9ubWVudHMuXG5mdW5jdGlvbiBnZXRDdXJzb3JBZHZhbmNlTWV0aG9kcygpIHtcbiAgICByZXR1cm4gKGN1cnNvckFkdmFuY2VNZXRob2RzIHx8XG4gICAgICAgIChjdXJzb3JBZHZhbmNlTWV0aG9kcyA9IFtcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuYWR2YW5jZSxcbiAgICAgICAgICAgIElEQkN1cnNvci5wcm90b3R5cGUuY29udGludWUsXG4gICAgICAgICAgICBJREJDdXJzb3IucHJvdG90eXBlLmNvbnRpbnVlUHJpbWFyeUtleSxcbiAgICAgICAgXSkpO1xufVxuY29uc3QgY3Vyc29yUmVxdWVzdE1hcCA9IG5ldyBXZWFrTWFwKCk7XG5jb25zdCB0cmFuc2FjdGlvbkRvbmVNYXAgPSBuZXcgV2Vha01hcCgpO1xuY29uc3QgdHJhbnNhY3Rpb25TdG9yZU5hbWVzTWFwID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHRyYW5zZm9ybUNhY2hlID0gbmV3IFdlYWtNYXAoKTtcbmNvbnN0IHJldmVyc2VUcmFuc2Zvcm1DYWNoZSA9IG5ldyBXZWFrTWFwKCk7XG5mdW5jdGlvbiBwcm9taXNpZnlSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBjb25zdCBwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB1bmxpc3RlbiA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlcXVlc3QucmVtb3ZlRXZlbnRMaXN0ZW5lcignc3VjY2VzcycsIHN1Y2Nlc3MpO1xuICAgICAgICAgICAgcmVxdWVzdC5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgc3VjY2VzcyA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUod3JhcChyZXF1ZXN0LnJlc3VsdCkpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QocmVxdWVzdC5lcnJvcik7XG4gICAgICAgICAgICB1bmxpc3RlbigpO1xuICAgICAgICB9O1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Y2Nlc3MnLCBzdWNjZXNzKTtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsIGVycm9yKTtcbiAgICB9KTtcbiAgICBwcm9taXNlXG4gICAgICAgIC50aGVuKCh2YWx1ZSkgPT4ge1xuICAgICAgICAvLyBTaW5jZSBjdXJzb3JpbmcgcmV1c2VzIHRoZSBJREJSZXF1ZXN0ICgqc2lnaCopLCB3ZSBjYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsXG4gICAgICAgIC8vIChzZWUgd3JhcEZ1bmN0aW9uKS5cbiAgICAgICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCQ3Vyc29yKSB7XG4gICAgICAgICAgICBjdXJzb3JSZXF1ZXN0TWFwLnNldCh2YWx1ZSwgcmVxdWVzdCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQ2F0Y2hpbmcgdG8gYXZvaWQgXCJVbmNhdWdodCBQcm9taXNlIGV4Y2VwdGlvbnNcIlxuICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7IH0pO1xuICAgIC8vIFRoaXMgbWFwcGluZyBleGlzdHMgaW4gcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGJ1dCBkb2Vzbid0IGRvZXNuJ3QgZXhpc3QgaW4gdHJhbnNmb3JtQ2FjaGUuIFRoaXNcbiAgICAvLyBpcyBiZWNhdXNlIHdlIGNyZWF0ZSBtYW55IHByb21pc2VzIGZyb20gYSBzaW5nbGUgSURCUmVxdWVzdC5cbiAgICByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuc2V0KHByb21pc2UsIHJlcXVlc3QpO1xuICAgIHJldHVybiBwcm9taXNlO1xufVxuZnVuY3Rpb24gY2FjaGVEb25lUHJvbWlzZUZvclRyYW5zYWN0aW9uKHR4KSB7XG4gICAgLy8gRWFybHkgYmFpbCBpZiB3ZSd2ZSBhbHJlYWR5IGNyZWF0ZWQgYSBkb25lIHByb21pc2UgZm9yIHRoaXMgdHJhbnNhY3Rpb24uXG4gICAgaWYgKHRyYW5zYWN0aW9uRG9uZU1hcC5oYXModHgpKVxuICAgICAgICByZXR1cm47XG4gICAgY29uc3QgZG9uZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgdW5saXN0ZW4gPSAoKSA9PiB7XG4gICAgICAgICAgICB0eC5yZW1vdmVFdmVudExpc3RlbmVyKCdjb21wbGV0ZScsIGNvbXBsZXRlKTtcbiAgICAgICAgICAgIHR4LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICAgICAgdHgucmVtb3ZlRXZlbnRMaXN0ZW5lcignYWJvcnQnLCBlcnJvcik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGNvbXBsZXRlID0gKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZXJyb3IgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QodHguZXJyb3IgfHwgbmV3IERPTUV4Y2VwdGlvbignQWJvcnRFcnJvcicsICdBYm9ydEVycm9yJykpO1xuICAgICAgICAgICAgdW5saXN0ZW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgdHguYWRkRXZlbnRMaXN0ZW5lcignY29tcGxldGUnLCBjb21wbGV0ZSk7XG4gICAgICAgIHR4LmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZXJyb3IpO1xuICAgICAgICB0eC5hZGRFdmVudExpc3RlbmVyKCdhYm9ydCcsIGVycm9yKTtcbiAgICB9KTtcbiAgICAvLyBDYWNoZSBpdCBmb3IgbGF0ZXIgcmV0cmlldmFsLlxuICAgIHRyYW5zYWN0aW9uRG9uZU1hcC5zZXQodHgsIGRvbmUpO1xufVxubGV0IGlkYlByb3h5VHJhcHMgPSB7XG4gICAgZ2V0KHRhcmdldCwgcHJvcCwgcmVjZWl2ZXIpIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uKSB7XG4gICAgICAgICAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciB0cmFuc2FjdGlvbi5kb25lLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdkb25lJylcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNhY3Rpb25Eb25lTWFwLmdldCh0YXJnZXQpO1xuICAgICAgICAgICAgLy8gUG9seWZpbGwgZm9yIG9iamVjdFN0b3JlTmFtZXMgYmVjYXVzZSBvZiBFZGdlLlxuICAgICAgICAgICAgaWYgKHByb3AgPT09ICdvYmplY3RTdG9yZU5hbWVzJykge1xuICAgICAgICAgICAgICAgIHJldHVybiB0YXJnZXQub2JqZWN0U3RvcmVOYW1lcyB8fCB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuZ2V0KHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBNYWtlIHR4LnN0b3JlIHJldHVybiB0aGUgb25seSBzdG9yZSBpbiB0aGUgdHJhbnNhY3Rpb24sIG9yIHVuZGVmaW5lZCBpZiB0aGVyZSBhcmUgbWFueS5cbiAgICAgICAgICAgIGlmIChwcm9wID09PSAnc3RvcmUnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlY2VpdmVyLm9iamVjdFN0b3JlTmFtZXNbMV1cbiAgICAgICAgICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgICAgICAgICAgOiByZWNlaXZlci5vYmplY3RTdG9yZShyZWNlaXZlci5vYmplY3RTdG9yZU5hbWVzWzBdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvLyBFbHNlIHRyYW5zZm9ybSB3aGF0ZXZlciB3ZSBnZXQgYmFjay5cbiAgICAgICAgcmV0dXJuIHdyYXAodGFyZ2V0W3Byb3BdKTtcbiAgICB9LFxuICAgIHNldCh0YXJnZXQsIHByb3AsIHZhbHVlKSB7XG4gICAgICAgIHRhcmdldFtwcm9wXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGhhcyh0YXJnZXQsIHByb3ApIHtcbiAgICAgICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIElEQlRyYW5zYWN0aW9uICYmXG4gICAgICAgICAgICAocHJvcCA9PT0gJ2RvbmUnIHx8IHByb3AgPT09ICdzdG9yZScpKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcHJvcCBpbiB0YXJnZXQ7XG4gICAgfSxcbn07XG5mdW5jdGlvbiByZXBsYWNlVHJhcHMoY2FsbGJhY2spIHtcbiAgICBpZGJQcm94eVRyYXBzID0gY2FsbGJhY2soaWRiUHJveHlUcmFwcyk7XG59XG5mdW5jdGlvbiB3cmFwRnVuY3Rpb24oZnVuYykge1xuICAgIC8vIER1ZSB0byBleHBlY3RlZCBvYmplY3QgZXF1YWxpdHkgKHdoaWNoIGlzIGVuZm9yY2VkIGJ5IHRoZSBjYWNoaW5nIGluIGB3cmFwYCksIHdlXG4gICAgLy8gb25seSBjcmVhdGUgb25lIG5ldyBmdW5jIHBlciBmdW5jLlxuICAgIC8vIEVkZ2UgZG9lc24ndCBzdXBwb3J0IG9iamVjdFN0b3JlTmFtZXMgKGJvb28pLCBzbyB3ZSBwb2x5ZmlsbCBpdCBoZXJlLlxuICAgIGlmIChmdW5jID09PSBJREJEYXRhYmFzZS5wcm90b3R5cGUudHJhbnNhY3Rpb24gJiZcbiAgICAgICAgISgnb2JqZWN0U3RvcmVOYW1lcycgaW4gSURCVHJhbnNhY3Rpb24ucHJvdG90eXBlKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKHN0b3JlTmFtZXMsIC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHR4ID0gZnVuYy5jYWxsKHVud3JhcCh0aGlzKSwgc3RvcmVOYW1lcywgLi4uYXJncyk7XG4gICAgICAgICAgICB0cmFuc2FjdGlvblN0b3JlTmFtZXNNYXAuc2V0KHR4LCBzdG9yZU5hbWVzLnNvcnQgPyBzdG9yZU5hbWVzLnNvcnQoKSA6IFtzdG9yZU5hbWVzXSk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcCh0eCk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIC8vIEN1cnNvciBtZXRob2RzIGFyZSBzcGVjaWFsLCBhcyB0aGUgYmVoYXZpb3VyIGlzIGEgbGl0dGxlIG1vcmUgZGlmZmVyZW50IHRvIHN0YW5kYXJkIElEQi4gSW5cbiAgICAvLyBJREIsIHlvdSBhZHZhbmNlIHRoZSBjdXJzb3IgYW5kIHdhaXQgZm9yIGEgbmV3ICdzdWNjZXNzJyBvbiB0aGUgSURCUmVxdWVzdCB0aGF0IGdhdmUgeW91IHRoZVxuICAgIC8vIGN1cnNvci4gSXQncyBraW5kYSBsaWtlIGEgcHJvbWlzZSB0aGF0IGNhbiByZXNvbHZlIHdpdGggbWFueSB2YWx1ZXMuIFRoYXQgZG9lc24ndCBtYWtlIHNlbnNlXG4gICAgLy8gd2l0aCByZWFsIHByb21pc2VzLCBzbyBlYWNoIGFkdmFuY2UgbWV0aG9kcyByZXR1cm5zIGEgbmV3IHByb21pc2UgZm9yIHRoZSBjdXJzb3Igb2JqZWN0LCBvclxuICAgIC8vIHVuZGVmaW5lZCBpZiB0aGUgZW5kIG9mIHRoZSBjdXJzb3IgaGFzIGJlZW4gcmVhY2hlZC5cbiAgICBpZiAoZ2V0Q3Vyc29yQWR2YW5jZU1ldGhvZHMoKS5pbmNsdWRlcyhmdW5jKSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKC4uLmFyZ3MpIHtcbiAgICAgICAgICAgIC8vIENhbGxpbmcgdGhlIG9yaWdpbmFsIGZ1bmN0aW9uIHdpdGggdGhlIHByb3h5IGFzICd0aGlzJyBjYXVzZXMgSUxMRUdBTCBJTlZPQ0FUSU9OLCBzbyB3ZSB1c2VcbiAgICAgICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgICAgICBmdW5jLmFwcGx5KHVud3JhcCh0aGlzKSwgYXJncyk7XG4gICAgICAgICAgICByZXR1cm4gd3JhcChjdXJzb3JSZXF1ZXN0TWFwLmdldCh0aGlzKSk7XG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBmdW5jdGlvbiAoLi4uYXJncykge1xuICAgICAgICAvLyBDYWxsaW5nIHRoZSBvcmlnaW5hbCBmdW5jdGlvbiB3aXRoIHRoZSBwcm94eSBhcyAndGhpcycgY2F1c2VzIElMTEVHQUwgSU5WT0NBVElPTiwgc28gd2UgdXNlXG4gICAgICAgIC8vIHRoZSBvcmlnaW5hbCBvYmplY3QuXG4gICAgICAgIHJldHVybiB3cmFwKGZ1bmMuYXBwbHkodW53cmFwKHRoaXMpLCBhcmdzKSk7XG4gICAgfTtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKVxuICAgICAgICByZXR1cm4gd3JhcEZ1bmN0aW9uKHZhbHVlKTtcbiAgICAvLyBUaGlzIGRvZXNuJ3QgcmV0dXJuLCBpdCBqdXN0IGNyZWF0ZXMgYSAnZG9uZScgcHJvbWlzZSBmb3IgdGhlIHRyYW5zYWN0aW9uLFxuICAgIC8vIHdoaWNoIGlzIGxhdGVyIHJldHVybmVkIGZvciB0cmFuc2FjdGlvbi5kb25lIChzZWUgaWRiT2JqZWN0SGFuZGxlcikuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCVHJhbnNhY3Rpb24pXG4gICAgICAgIGNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbih2YWx1ZSk7XG4gICAgaWYgKGluc3RhbmNlT2ZBbnkodmFsdWUsIGdldElkYlByb3h5YWJsZVR5cGVzKCkpKVxuICAgICAgICByZXR1cm4gbmV3IFByb3h5KHZhbHVlLCBpZGJQcm94eVRyYXBzKTtcbiAgICAvLyBSZXR1cm4gdGhlIHNhbWUgdmFsdWUgYmFjayBpZiB3ZSdyZSBub3QgZ29pbmcgdG8gdHJhbnNmb3JtIGl0LlxuICAgIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIHdyYXAodmFsdWUpIHtcbiAgICAvLyBXZSBzb21ldGltZXMgZ2VuZXJhdGUgbXVsdGlwbGUgcHJvbWlzZXMgZnJvbSBhIHNpbmdsZSBJREJSZXF1ZXN0IChlZyB3aGVuIGN1cnNvcmluZyksIGJlY2F1c2VcbiAgICAvLyBJREIgaXMgd2VpcmQgYW5kIGEgc2luZ2xlIElEQlJlcXVlc3QgY2FuIHlpZWxkIG1hbnkgcmVzcG9uc2VzLCBzbyB0aGVzZSBjYW4ndCBiZSBjYWNoZWQuXG4gICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgSURCUmVxdWVzdClcbiAgICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3QodmFsdWUpO1xuICAgIC8vIElmIHdlJ3ZlIGFscmVhZHkgdHJhbnNmb3JtZWQgdGhpcyB2YWx1ZSBiZWZvcmUsIHJldXNlIHRoZSB0cmFuc2Zvcm1lZCB2YWx1ZS5cbiAgICAvLyBUaGlzIGlzIGZhc3RlciwgYnV0IGl0IGFsc28gcHJvdmlkZXMgb2JqZWN0IGVxdWFsaXR5LlxuICAgIGlmICh0cmFuc2Zvcm1DYWNoZS5oYXModmFsdWUpKVxuICAgICAgICByZXR1cm4gdHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcbiAgICBjb25zdCBuZXdWYWx1ZSA9IHRyYW5zZm9ybUNhY2hhYmxlVmFsdWUodmFsdWUpO1xuICAgIC8vIE5vdCBhbGwgdHlwZXMgYXJlIHRyYW5zZm9ybWVkLlxuICAgIC8vIFRoZXNlIG1heSBiZSBwcmltaXRpdmUgdHlwZXMsIHNvIHRoZXkgY2FuJ3QgYmUgV2Vha01hcCBrZXlzLlxuICAgIGlmIChuZXdWYWx1ZSAhPT0gdmFsdWUpIHtcbiAgICAgICAgdHJhbnNmb3JtQ2FjaGUuc2V0KHZhbHVlLCBuZXdWYWx1ZSk7XG4gICAgICAgIHJldmVyc2VUcmFuc2Zvcm1DYWNoZS5zZXQobmV3VmFsdWUsIHZhbHVlKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ld1ZhbHVlO1xufVxuY29uc3QgdW53cmFwID0gKHZhbHVlKSA9PiByZXZlcnNlVHJhbnNmb3JtQ2FjaGUuZ2V0KHZhbHVlKTtcblxuZXhwb3J0IHsgcmV2ZXJzZVRyYW5zZm9ybUNhY2hlIGFzIGEsIGluc3RhbmNlT2ZBbnkgYXMgaSwgcmVwbGFjZVRyYXBzIGFzIHIsIHVud3JhcCBhcyB1LCB3cmFwIGFzIHcgfTtcbiIsImltcG9ydCB7IHcgYXMgd3JhcCwgciBhcyByZXBsYWNlVHJhcHMgfSBmcm9tICcuL3dyYXAtaWRiLXZhbHVlLmpzJztcbmV4cG9ydCB7IHUgYXMgdW53cmFwLCB3IGFzIHdyYXAgfSBmcm9tICcuL3dyYXAtaWRiLXZhbHVlLmpzJztcblxuLyoqXG4gKiBPcGVuIGEgZGF0YWJhc2UuXG4gKlxuICogQHBhcmFtIG5hbWUgTmFtZSBvZiB0aGUgZGF0YWJhc2UuXG4gKiBAcGFyYW0gdmVyc2lvbiBTY2hlbWEgdmVyc2lvbi5cbiAqIEBwYXJhbSBjYWxsYmFja3MgQWRkaXRpb25hbCBjYWxsYmFja3MuXG4gKi9cbmZ1bmN0aW9uIG9wZW5EQihuYW1lLCB2ZXJzaW9uLCB7IGJsb2NrZWQsIHVwZ3JhZGUsIGJsb2NraW5nLCB0ZXJtaW5hdGVkIH0gPSB7fSkge1xuICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbihuYW1lLCB2ZXJzaW9uKTtcbiAgICBjb25zdCBvcGVuUHJvbWlzZSA9IHdyYXAocmVxdWVzdCk7XG4gICAgaWYgKHVwZ3JhZGUpIHtcbiAgICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCd1cGdyYWRlbmVlZGVkJywgKGV2ZW50KSA9PiB7XG4gICAgICAgICAgICB1cGdyYWRlKHdyYXAocmVxdWVzdC5yZXN1bHQpLCBldmVudC5vbGRWZXJzaW9uLCBldmVudC5uZXdWZXJzaW9uLCB3cmFwKHJlcXVlc3QudHJhbnNhY3Rpb24pLCBldmVudCk7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoYmxvY2tlZCkge1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Jsb2NrZWQnLCAoZXZlbnQpID0+IGJsb2NrZWQoXG4gICAgICAgIC8vIENhc3RpbmcgZHVlIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC1ET00tbGliLWdlbmVyYXRvci9wdWxsLzE0MDVcbiAgICAgICAgZXZlbnQub2xkVmVyc2lvbiwgZXZlbnQubmV3VmVyc2lvbiwgZXZlbnQpKTtcbiAgICB9XG4gICAgb3BlblByb21pc2VcbiAgICAgICAgLnRoZW4oKGRiKSA9PiB7XG4gICAgICAgIGlmICh0ZXJtaW5hdGVkKVxuICAgICAgICAgICAgZGIuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCAoKSA9PiB0ZXJtaW5hdGVkKCkpO1xuICAgICAgICBpZiAoYmxvY2tpbmcpIHtcbiAgICAgICAgICAgIGRiLmFkZEV2ZW50TGlzdGVuZXIoJ3ZlcnNpb25jaGFuZ2UnLCAoZXZlbnQpID0+IGJsb2NraW5nKGV2ZW50Lm9sZFZlcnNpb24sIGV2ZW50Lm5ld1ZlcnNpb24sIGV2ZW50KSk7XG4gICAgICAgIH1cbiAgICB9KVxuICAgICAgICAuY2F0Y2goKCkgPT4geyB9KTtcbiAgICByZXR1cm4gb3BlblByb21pc2U7XG59XG4vKipcbiAqIERlbGV0ZSBhIGRhdGFiYXNlLlxuICpcbiAqIEBwYXJhbSBuYW1lIE5hbWUgb2YgdGhlIGRhdGFiYXNlLlxuICovXG5mdW5jdGlvbiBkZWxldGVEQihuYW1lLCB7IGJsb2NrZWQgfSA9IHt9KSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5kZWxldGVEYXRhYmFzZShuYW1lKTtcbiAgICBpZiAoYmxvY2tlZCkge1xuICAgICAgICByZXF1ZXN0LmFkZEV2ZW50TGlzdGVuZXIoJ2Jsb2NrZWQnLCAoZXZlbnQpID0+IGJsb2NrZWQoXG4gICAgICAgIC8vIENhc3RpbmcgZHVlIHRvIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC1ET00tbGliLWdlbmVyYXRvci9wdWxsLzE0MDVcbiAgICAgICAgZXZlbnQub2xkVmVyc2lvbiwgZXZlbnQpKTtcbiAgICB9XG4gICAgcmV0dXJuIHdyYXAocmVxdWVzdCkudGhlbigoKSA9PiB1bmRlZmluZWQpO1xufVxuXG5jb25zdCByZWFkTWV0aG9kcyA9IFsnZ2V0JywgJ2dldEtleScsICdnZXRBbGwnLCAnZ2V0QWxsS2V5cycsICdjb3VudCddO1xuY29uc3Qgd3JpdGVNZXRob2RzID0gWydwdXQnLCAnYWRkJywgJ2RlbGV0ZScsICdjbGVhciddO1xuY29uc3QgY2FjaGVkTWV0aG9kcyA9IG5ldyBNYXAoKTtcbmZ1bmN0aW9uIGdldE1ldGhvZCh0YXJnZXQsIHByb3ApIHtcbiAgICBpZiAoISh0YXJnZXQgaW5zdGFuY2VvZiBJREJEYXRhYmFzZSAmJlxuICAgICAgICAhKHByb3AgaW4gdGFyZ2V0KSAmJlxuICAgICAgICB0eXBlb2YgcHJvcCA9PT0gJ3N0cmluZycpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGNhY2hlZE1ldGhvZHMuZ2V0KHByb3ApKVxuICAgICAgICByZXR1cm4gY2FjaGVkTWV0aG9kcy5nZXQocHJvcCk7XG4gICAgY29uc3QgdGFyZ2V0RnVuY05hbWUgPSBwcm9wLnJlcGxhY2UoL0Zyb21JbmRleCQvLCAnJyk7XG4gICAgY29uc3QgdXNlSW5kZXggPSBwcm9wICE9PSB0YXJnZXRGdW5jTmFtZTtcbiAgICBjb25zdCBpc1dyaXRlID0gd3JpdGVNZXRob2RzLmluY2x1ZGVzKHRhcmdldEZ1bmNOYW1lKTtcbiAgICBpZiAoXG4gICAgLy8gQmFpbCBpZiB0aGUgdGFyZ2V0IGRvZXNuJ3QgZXhpc3Qgb24gdGhlIHRhcmdldC4gRWcsIGdldEFsbCBpc24ndCBpbiBFZGdlLlxuICAgICEodGFyZ2V0RnVuY05hbWUgaW4gKHVzZUluZGV4ID8gSURCSW5kZXggOiBJREJPYmplY3RTdG9yZSkucHJvdG90eXBlKSB8fFxuICAgICAgICAhKGlzV3JpdGUgfHwgcmVhZE1ldGhvZHMuaW5jbHVkZXModGFyZ2V0RnVuY05hbWUpKSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IG1ldGhvZCA9IGFzeW5jIGZ1bmN0aW9uIChzdG9yZU5hbWUsIC4uLmFyZ3MpIHtcbiAgICAgICAgLy8gaXNXcml0ZSA/ICdyZWFkd3JpdGUnIDogdW5kZWZpbmVkIGd6aXBwcyBiZXR0ZXIsIGJ1dCBmYWlscyBpbiBFZGdlIDooXG4gICAgICAgIGNvbnN0IHR4ID0gdGhpcy50cmFuc2FjdGlvbihzdG9yZU5hbWUsIGlzV3JpdGUgPyAncmVhZHdyaXRlJyA6ICdyZWFkb25seScpO1xuICAgICAgICBsZXQgdGFyZ2V0ID0gdHguc3RvcmU7XG4gICAgICAgIGlmICh1c2VJbmRleClcbiAgICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5pbmRleChhcmdzLnNoaWZ0KCkpO1xuICAgICAgICAvLyBNdXN0IHJlamVjdCBpZiBvcCByZWplY3RzLlxuICAgICAgICAvLyBJZiBpdCdzIGEgd3JpdGUgb3BlcmF0aW9uLCBtdXN0IHJlamVjdCBpZiB0eC5kb25lIHJlamVjdHMuXG4gICAgICAgIC8vIE11c3QgcmVqZWN0IHdpdGggb3AgcmVqZWN0aW9uIGZpcnN0LlxuICAgICAgICAvLyBNdXN0IHJlc29sdmUgd2l0aCBvcCB2YWx1ZS5cbiAgICAgICAgLy8gTXVzdCBoYW5kbGUgYm90aCBwcm9taXNlcyAobm8gdW5oYW5kbGVkIHJlamVjdGlvbnMpXG4gICAgICAgIHJldHVybiAoYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgICAgICAgdGFyZ2V0W3RhcmdldEZ1bmNOYW1lXSguLi5hcmdzKSxcbiAgICAgICAgICAgIGlzV3JpdGUgJiYgdHguZG9uZSxcbiAgICAgICAgXSkpWzBdO1xuICAgIH07XG4gICAgY2FjaGVkTWV0aG9kcy5zZXQocHJvcCwgbWV0aG9kKTtcbiAgICByZXR1cm4gbWV0aG9kO1xufVxucmVwbGFjZVRyYXBzKChvbGRUcmFwcykgPT4gKHtcbiAgICAuLi5vbGRUcmFwcyxcbiAgICBnZXQ6ICh0YXJnZXQsIHByb3AsIHJlY2VpdmVyKSA9PiBnZXRNZXRob2QodGFyZ2V0LCBwcm9wKSB8fCBvbGRUcmFwcy5nZXQodGFyZ2V0LCBwcm9wLCByZWNlaXZlciksXG4gICAgaGFzOiAodGFyZ2V0LCBwcm9wKSA9PiAhIWdldE1ldGhvZCh0YXJnZXQsIHByb3ApIHx8IG9sZFRyYXBzLmhhcyh0YXJnZXQsIHByb3ApLFxufSkpO1xuXG5leHBvcnQgeyBkZWxldGVEQiwgb3BlbkRCIH07XG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIENvbXBvbmVudENvbnRhaW5lciB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBzZXRVc2VyTG9nSGFuZGxlciwgc2V0TG9nTGV2ZWwgYXMgc2V0TG9nTGV2ZWwkMSB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRXJyb3JGYWN0b3J5LCBnZXREZWZhdWx0QXBwQ29uZmlnLCBkZWVwRXF1YWwsIEZpcmViYXNlRXJyb3IsIGJhc2U2NHVybEVuY29kZVdpdGhvdXRQYWRkaW5nLCBpc0luZGV4ZWREQkF2YWlsYWJsZSwgdmFsaWRhdGVJbmRleGVkREJPcGVuYWJsZSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmV4cG9ydCB7IEZpcmViYXNlRXJyb3IgfSBmcm9tICdAZmlyZWJhc2UvdXRpbCc7XG5pbXBvcnQgeyBvcGVuREIgfSBmcm9tICdpZGInO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jbGFzcyBQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgfVxyXG4gICAgLy8gSW4gaW5pdGlhbCBpbXBsZW1lbnRhdGlvbiwgdGhpcyB3aWxsIGJlIGNhbGxlZCBieSBpbnN0YWxsYXRpb25zIG9uXHJcbiAgICAvLyBhdXRoIHRva2VuIHJlZnJlc2gsIGFuZCBpbnN0YWxsYXRpb25zIHdpbGwgc2VuZCB0aGlzIHN0cmluZy5cclxuICAgIGdldFBsYXRmb3JtSW5mb1N0cmluZygpIHtcclxuICAgICAgICBjb25zdCBwcm92aWRlcnMgPSB0aGlzLmNvbnRhaW5lci5nZXRQcm92aWRlcnMoKTtcclxuICAgICAgICAvLyBMb29wIHRocm91Z2ggcHJvdmlkZXJzIGFuZCBnZXQgbGlicmFyeS92ZXJzaW9uIHBhaXJzIGZyb20gYW55IHRoYXQgYXJlXHJcbiAgICAgICAgLy8gdmVyc2lvbiBjb21wb25lbnRzLlxyXG4gICAgICAgIHJldHVybiBwcm92aWRlcnNcclxuICAgICAgICAgICAgLm1hcChwcm92aWRlciA9PiB7XHJcbiAgICAgICAgICAgIGlmIChpc1ZlcnNpb25TZXJ2aWNlUHJvdmlkZXIocHJvdmlkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZXJ2aWNlID0gcHJvdmlkZXIuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7c2VydmljZS5saWJyYXJ5fS8ke3NlcnZpY2UudmVyc2lvbn1gO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAuZmlsdGVyKGxvZ1N0cmluZyA9PiBsb2dTdHJpbmcpXHJcbiAgICAgICAgICAgIC5qb2luKCcgJyk7XHJcbiAgICB9XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBwcm92aWRlciBjaGVjayBpZiB0aGlzIHByb3ZpZGVyIHByb3ZpZGVzIGEgVmVyc2lvblNlcnZpY2VcclxuICpcclxuICogTk9URTogVXNpbmcgUHJvdmlkZXI8J2FwcC12ZXJzaW9uJz4gaXMgYSBoYWNrIHRvIGluZGljYXRlIHRoYXQgdGhlIHByb3ZpZGVyXHJcbiAqIHByb3ZpZGVzIFZlcnNpb25TZXJ2aWNlLiBUaGUgcHJvdmlkZXIgaXMgbm90IG5lY2Vzc2FyaWx5IGEgJ2FwcC12ZXJzaW9uJ1xyXG4gKiBwcm92aWRlci5cclxuICovXHJcbmZ1bmN0aW9uIGlzVmVyc2lvblNlcnZpY2VQcm92aWRlcihwcm92aWRlcikge1xyXG4gICAgY29uc3QgY29tcG9uZW50ID0gcHJvdmlkZXIuZ2V0Q29tcG9uZW50KCk7XHJcbiAgICByZXR1cm4gKGNvbXBvbmVudCA9PT0gbnVsbCB8fCBjb21wb25lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNvbXBvbmVudC50eXBlKSA9PT0gXCJWRVJTSU9OXCIgLyogQ29tcG9uZW50VHlwZS5WRVJTSU9OICovO1xyXG59XG5cbmNvbnN0IG5hbWUkbyA9IFwiQGZpcmViYXNlL2FwcFwiO1xuY29uc3QgdmVyc2lvbiQxID0gXCIwLjkuOVwiO1xuXG4vKipcclxuICogQGxpY2Vuc2VcclxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5jb25zdCBsb2dnZXIgPSBuZXcgTG9nZ2VyKCdAZmlyZWJhc2UvYXBwJyk7XG5cbmNvbnN0IG5hbWUkbiA9IFwiQGZpcmViYXNlL2FwcC1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRtID0gXCJAZmlyZWJhc2UvYW5hbHl0aWNzLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGwgPSBcIkBmaXJlYmFzZS9hbmFseXRpY3NcIjtcblxuY29uc3QgbmFtZSRrID0gXCJAZmlyZWJhc2UvYXBwLWNoZWNrLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGogPSBcIkBmaXJlYmFzZS9hcHAtY2hlY2tcIjtcblxuY29uc3QgbmFtZSRpID0gXCJAZmlyZWJhc2UvYXV0aFwiO1xuXG5jb25zdCBuYW1lJGggPSBcIkBmaXJlYmFzZS9hdXRoLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGcgPSBcIkBmaXJlYmFzZS9kYXRhYmFzZVwiO1xuXG5jb25zdCBuYW1lJGYgPSBcIkBmaXJlYmFzZS9kYXRhYmFzZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRlID0gXCJAZmlyZWJhc2UvZnVuY3Rpb25zXCI7XG5cbmNvbnN0IG5hbWUkZCA9IFwiQGZpcmViYXNlL2Z1bmN0aW9ucy1jb21wYXRcIjtcblxuY29uc3QgbmFtZSRjID0gXCJAZmlyZWJhc2UvaW5zdGFsbGF0aW9uc1wiO1xuXG5jb25zdCBuYW1lJGIgPSBcIkBmaXJlYmFzZS9pbnN0YWxsYXRpb25zLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJGEgPSBcIkBmaXJlYmFzZS9tZXNzYWdpbmdcIjtcblxuY29uc3QgbmFtZSQ5ID0gXCJAZmlyZWJhc2UvbWVzc2FnaW5nLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDggPSBcIkBmaXJlYmFzZS9wZXJmb3JtYW5jZVwiO1xuXG5jb25zdCBuYW1lJDcgPSBcIkBmaXJlYmFzZS9wZXJmb3JtYW5jZS1jb21wYXRcIjtcblxuY29uc3QgbmFtZSQ2ID0gXCJAZmlyZWJhc2UvcmVtb3RlLWNvbmZpZ1wiO1xuXG5jb25zdCBuYW1lJDUgPSBcIkBmaXJlYmFzZS9yZW1vdGUtY29uZmlnLWNvbXBhdFwiO1xuXG5jb25zdCBuYW1lJDQgPSBcIkBmaXJlYmFzZS9zdG9yYWdlXCI7XG5cbmNvbnN0IG5hbWUkMyA9IFwiQGZpcmViYXNlL3N0b3JhZ2UtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUkMiA9IFwiQGZpcmViYXNlL2ZpcmVzdG9yZVwiO1xuXG5jb25zdCBuYW1lJDEgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmUtY29tcGF0XCI7XG5cbmNvbnN0IG5hbWUgPSBcImZpcmViYXNlXCI7XG5jb25zdCB2ZXJzaW9uID0gXCI5LjIxLjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBkZWZhdWx0IGFwcCBuYW1lXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgREVGQVVMVF9FTlRSWV9OQU1FID0gJ1tERUZBVUxUXSc7XHJcbmNvbnN0IFBMQVRGT1JNX0xPR19TVFJJTkcgPSB7XHJcbiAgICBbbmFtZSRvXTogJ2ZpcmUtY29yZScsXHJcbiAgICBbbmFtZSRuXTogJ2ZpcmUtY29yZS1jb21wYXQnLFxyXG4gICAgW25hbWUkbF06ICdmaXJlLWFuYWx5dGljcycsXHJcbiAgICBbbmFtZSRtXTogJ2ZpcmUtYW5hbHl0aWNzLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRqXTogJ2ZpcmUtYXBwLWNoZWNrJyxcclxuICAgIFtuYW1lJGtdOiAnZmlyZS1hcHAtY2hlY2stY29tcGF0JyxcclxuICAgIFtuYW1lJGldOiAnZmlyZS1hdXRoJyxcclxuICAgIFtuYW1lJGhdOiAnZmlyZS1hdXRoLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRnXTogJ2ZpcmUtcnRkYicsXHJcbiAgICBbbmFtZSRmXTogJ2ZpcmUtcnRkYi1jb21wYXQnLFxyXG4gICAgW25hbWUkZV06ICdmaXJlLWZuJyxcclxuICAgIFtuYW1lJGRdOiAnZmlyZS1mbi1jb21wYXQnLFxyXG4gICAgW25hbWUkY106ICdmaXJlLWlpZCcsXHJcbiAgICBbbmFtZSRiXTogJ2ZpcmUtaWlkLWNvbXBhdCcsXHJcbiAgICBbbmFtZSRhXTogJ2ZpcmUtZmNtJyxcclxuICAgIFtuYW1lJDldOiAnZmlyZS1mY20tY29tcGF0JyxcclxuICAgIFtuYW1lJDhdOiAnZmlyZS1wZXJmJyxcclxuICAgIFtuYW1lJDddOiAnZmlyZS1wZXJmLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ2XTogJ2ZpcmUtcmMnLFxyXG4gICAgW25hbWUkNV06ICdmaXJlLXJjLWNvbXBhdCcsXHJcbiAgICBbbmFtZSQ0XTogJ2ZpcmUtZ2NzJyxcclxuICAgIFtuYW1lJDNdOiAnZmlyZS1nY3MtY29tcGF0JyxcclxuICAgIFtuYW1lJDJdOiAnZmlyZS1mc3QnLFxyXG4gICAgW25hbWUkMV06ICdmaXJlLWZzdC1jb21wYXQnLFxyXG4gICAgJ2ZpcmUtanMnOiAnZmlyZS1qcycsXHJcbiAgICBbbmFtZV06ICdmaXJlLWpzLWFsbCdcclxufTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuY29uc3QgX2FwcHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBSZWdpc3RlcmVkIGNvbXBvbmVudHMuXHJcbiAqXHJcbiAqIEBpbnRlcm5hbFxyXG4gKi9cclxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcclxuY29uc3QgX2NvbXBvbmVudHMgPSBuZXcgTWFwKCk7XHJcbi8qKlxyXG4gKiBAcGFyYW0gY29tcG9uZW50IC0gdGhlIGNvbXBvbmVudCBiZWluZyBhZGRlZCB0byB0aGlzIGFwcCdzIGNvbnRhaW5lclxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgYXBwLmNvbnRhaW5lci5hZGRDb21wb25lbnQoY29tcG9uZW50KTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgbG9nZ2VyLmRlYnVnKGBDb21wb25lbnQgJHtjb21wb25lbnQubmFtZX0gZmFpbGVkIHRvIHJlZ2lzdGVyIHdpdGggRmlyZWJhc2VBcHAgJHthcHAubmFtZX1gLCBlKTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoYXBwLCBjb21wb25lbnQpIHtcclxuICAgIGFwcC5jb250YWluZXIuYWRkT3JPdmVyd3JpdGVDb21wb25lbnQoY29tcG9uZW50KTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGNvbXBvbmVudCAtIHRoZSBjb21wb25lbnQgdG8gcmVnaXN0ZXJcclxuICogQHJldHVybnMgd2hldGhlciBvciBub3QgdGhlIGNvbXBvbmVudCBpcyByZWdpc3RlcmVkIHN1Y2Nlc3NmdWxseVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9yZWdpc3RlckNvbXBvbmVudChjb21wb25lbnQpIHtcclxuICAgIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBjb21wb25lbnQubmFtZTtcclxuICAgIGlmIChfY29tcG9uZW50cy5oYXMoY29tcG9uZW50TmFtZSkpIHtcclxuICAgICAgICBsb2dnZXIuZGVidWcoYFRoZXJlIHdlcmUgbXVsdGlwbGUgYXR0ZW1wdHMgdG8gcmVnaXN0ZXIgY29tcG9uZW50ICR7Y29tcG9uZW50TmFtZX0uYCk7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgX2NvbXBvbmVudHMuc2V0KGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudCk7XHJcbiAgICAvLyBhZGQgdGhlIGNvbXBvbmVudCB0byBleGlzdGluZyBhcHAgaW5zdGFuY2VzXHJcbiAgICBmb3IgKGNvbnN0IGFwcCBvZiBfYXBwcy52YWx1ZXMoKSkge1xyXG4gICAgICAgIF9hZGRDb21wb25lbnQoYXBwLCBjb21wb25lbnQpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRydWU7XHJcbn1cclxuLyoqXHJcbiAqXHJcbiAqIEBwYXJhbSBhcHAgLSBGaXJlYmFzZUFwcCBpbnN0YW5jZVxyXG4gKiBAcGFyYW0gbmFtZSAtIHNlcnZpY2UgbmFtZVxyXG4gKlxyXG4gKiBAcmV0dXJucyB0aGUgcHJvdmlkZXIgZm9yIHRoZSBzZXJ2aWNlIHdpdGggdGhlIG1hdGNoaW5nIG5hbWVcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKSB7XHJcbiAgICBjb25zdCBoZWFydGJlYXRDb250cm9sbGVyID0gYXBwLmNvbnRhaW5lclxyXG4gICAgICAgIC5nZXRQcm92aWRlcignaGVhcnRiZWF0JylcclxuICAgICAgICAuZ2V0SW1tZWRpYXRlKHsgb3B0aW9uYWw6IHRydWUgfSk7XHJcbiAgICBpZiAoaGVhcnRiZWF0Q29udHJvbGxlcikge1xyXG4gICAgICAgIHZvaWQgaGVhcnRiZWF0Q29udHJvbGxlci50cmlnZ2VySGVhcnRiZWF0KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gYXBwLmNvbnRhaW5lci5nZXRQcm92aWRlcihuYW1lKTtcclxufVxyXG4vKipcclxuICpcclxuICogQHBhcmFtIGFwcCAtIEZpcmViYXNlQXBwIGluc3RhbmNlXHJcbiAqIEBwYXJhbSBuYW1lIC0gc2VydmljZSBuYW1lXHJcbiAqIEBwYXJhbSBpbnN0YW5jZUlkZW50aWZpZXIgLSBzZXJ2aWNlIGluc3RhbmNlIGlkZW50aWZpZXIgaW4gY2FzZSB0aGUgc2VydmljZSBzdXBwb3J0cyBtdWx0aXBsZSBpbnN0YW5jZXNcclxuICpcclxuICogQGludGVybmFsXHJcbiAqL1xyXG5mdW5jdGlvbiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKGFwcCwgbmFtZSwgaW5zdGFuY2VJZGVudGlmaWVyID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBfZ2V0UHJvdmlkZXIoYXBwLCBuYW1lKS5jbGVhckluc3RhbmNlKGluc3RhbmNlSWRlbnRpZmllcik7XHJcbn1cclxuLyoqXHJcbiAqIFRlc3Qgb25seVxyXG4gKlxyXG4gKiBAaW50ZXJuYWxcclxuICovXHJcbmZ1bmN0aW9uIF9jbGVhckNvbXBvbmVudHMoKSB7XHJcbiAgICBfY29tcG9uZW50cy5jbGVhcigpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IEVSUk9SUyA9IHtcclxuICAgIFtcIm5vLWFwcFwiIC8qIEFwcEVycm9yLk5PX0FQUCAqL106IFwiTm8gRmlyZWJhc2UgQXBwICd7JGFwcE5hbWV9JyBoYXMgYmVlbiBjcmVhdGVkIC0gXCIgK1xyXG4gICAgICAgICdjYWxsIEZpcmViYXNlIEFwcC5pbml0aWFsaXplQXBwKCknLFxyXG4gICAgW1wiYmFkLWFwcC1uYW1lXCIgLyogQXBwRXJyb3IuQkFEX0FQUF9OQU1FICovXTogXCJJbGxlZ2FsIEFwcCBuYW1lOiAneyRhcHBOYW1lfVwiLFxyXG4gICAgW1wiZHVwbGljYXRlLWFwcFwiIC8qIEFwcEVycm9yLkRVUExJQ0FURV9BUFAgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBleGlzdHMgd2l0aCBkaWZmZXJlbnQgb3B0aW9ucyBvciBjb25maWdcIixcclxuICAgIFtcImFwcC1kZWxldGVkXCIgLyogQXBwRXJyb3IuQVBQX0RFTEVURUQgKi9dOiBcIkZpcmViYXNlIEFwcCBuYW1lZCAneyRhcHBOYW1lfScgYWxyZWFkeSBkZWxldGVkXCIsXHJcbiAgICBbXCJuby1vcHRpb25zXCIgLyogQXBwRXJyb3IuTk9fT1BUSU9OUyAqL106ICdOZWVkIHRvIHByb3ZpZGUgb3B0aW9ucywgd2hlbiBub3QgYmVpbmcgZGVwbG95ZWQgdG8gaG9zdGluZyB2aWEgc291cmNlLicsXHJcbiAgICBbXCJpbnZhbGlkLWFwcC1hcmd1bWVudFwiIC8qIEFwcEVycm9yLklOVkFMSURfQVBQX0FSR1VNRU5UICovXTogJ2ZpcmViYXNlLnskYXBwTmFtZX0oKSB0YWtlcyBlaXRoZXIgbm8gYXJndW1lbnQgb3IgYSAnICtcclxuICAgICAgICAnRmlyZWJhc2UgQXBwIGluc3RhbmNlLicsXHJcbiAgICBbXCJpbnZhbGlkLWxvZy1hcmd1bWVudFwiIC8qIEFwcEVycm9yLklOVkFMSURfTE9HX0FSR1VNRU5UICovXTogJ0ZpcnN0IGFyZ3VtZW50IHRvIGBvbkxvZ2AgbXVzdCBiZSBudWxsIG9yIGEgZnVuY3Rpb24uJyxcclxuICAgIFtcImlkYi1vcGVuXCIgLyogQXBwRXJyb3IuSURCX09QRU4gKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gb3BlbmluZyBJbmRleGVkREIuIE9yaWdpbmFsIGVycm9yOiB7JG9yaWdpbmFsRXJyb3JNZXNzYWdlfS4nLFxyXG4gICAgW1wiaWRiLWdldFwiIC8qIEFwcEVycm9yLklEQl9HRVQgKi9dOiAnRXJyb3IgdGhyb3duIHdoZW4gcmVhZGluZyBmcm9tIEluZGV4ZWREQi4gT3JpZ2luYWwgZXJyb3I6IHskb3JpZ2luYWxFcnJvck1lc3NhZ2V9LicsXHJcbiAgICBbXCJpZGItc2V0XCIgLyogQXBwRXJyb3IuSURCX1dSSVRFICovXTogJ0Vycm9yIHRocm93biB3aGVuIHdyaXRpbmcgdG8gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJyxcclxuICAgIFtcImlkYi1kZWxldGVcIiAvKiBBcHBFcnJvci5JREJfREVMRVRFICovXTogJ0Vycm9yIHRocm93biB3aGVuIGRlbGV0aW5nIGZyb20gSW5kZXhlZERCLiBPcmlnaW5hbCBlcnJvcjogeyRvcmlnaW5hbEVycm9yTWVzc2FnZX0uJ1xyXG59O1xyXG5jb25zdCBFUlJPUl9GQUNUT1JZID0gbmV3IEVycm9yRmFjdG9yeSgnYXBwJywgJ0ZpcmViYXNlJywgRVJST1JTKTtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuY2xhc3MgRmlyZWJhc2VBcHBJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMuX2NvbmZpZyA9IE9iamVjdC5hc3NpZ24oe30sIGNvbmZpZyk7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGNvbmZpZy5uYW1lO1xyXG4gICAgICAgIHRoaXMuX2F1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCA9XHJcbiAgICAgICAgICAgIGNvbmZpZy5hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQ7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFkZENvbXBvbmVudChuZXcgQ29tcG9uZW50KCdhcHAnLCAoKSA9PiB0aGlzLCBcIlBVQkxJQ1wiIC8qIENvbXBvbmVudFR5cGUuUFVCTElDICovKSk7XHJcbiAgICB9XHJcbiAgICBnZXQgYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkKCkge1xyXG4gICAgICAgIHRoaXMuY2hlY2tEZXN0cm95ZWQoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkO1xyXG4gICAgfVxyXG4gICAgc2V0IGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZCh2YWwpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgdGhpcy5fYXV0b21hdGljRGF0YUNvbGxlY3Rpb25FbmFibGVkID0gdmFsO1xyXG4gICAgfVxyXG4gICAgZ2V0IG5hbWUoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9uYW1lO1xyXG4gICAgfVxyXG4gICAgZ2V0IG9wdGlvbnMoKSB7XHJcbiAgICAgICAgdGhpcy5jaGVja0Rlc3Ryb3llZCgpO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9vcHRpb25zO1xyXG4gICAgfVxyXG4gICAgZ2V0IGNvbmZpZygpIHtcclxuICAgICAgICB0aGlzLmNoZWNrRGVzdHJveWVkKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbmZpZztcclxuICAgIH1cclxuICAgIGdldCBjb250YWluZXIoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnRhaW5lcjtcclxuICAgIH1cclxuICAgIGdldCBpc0RlbGV0ZWQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lzRGVsZXRlZDtcclxuICAgIH1cclxuICAgIHNldCBpc0RlbGV0ZWQodmFsKSB7XHJcbiAgICAgICAgdGhpcy5faXNEZWxldGVkID0gdmFsO1xyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIHdpbGwgdGhyb3cgYW4gRXJyb3IgaWYgdGhlIEFwcCBoYXMgYWxyZWFkeSBiZWVuIGRlbGV0ZWQgLVxyXG4gICAgICogdXNlIGJlZm9yZSBwZXJmb3JtaW5nIEFQSSBhY3Rpb25zIG9uIHRoZSBBcHAuXHJcbiAgICAgKi9cclxuICAgIGNoZWNrRGVzdHJveWVkKCkge1xyXG4gICAgICAgIGlmICh0aGlzLmlzRGVsZXRlZCkge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImFwcC1kZWxldGVkXCIgLyogQXBwRXJyb3IuQVBQX0RFTEVURUQgKi8sIHsgYXBwTmFtZTogdGhpcy5fbmFtZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuLyoqXHJcbiAqIFRoZSBjdXJyZW50IFNESyB2ZXJzaW9uLlxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5jb25zdCBTREtfVkVSU0lPTiA9IHZlcnNpb247XHJcbmZ1bmN0aW9uIGluaXRpYWxpemVBcHAoX29wdGlvbnMsIHJhd0NvbmZpZyA9IHt9KSB7XHJcbiAgICBsZXQgb3B0aW9ucyA9IF9vcHRpb25zO1xyXG4gICAgaWYgKHR5cGVvZiByYXdDb25maWcgIT09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgY29uc3QgbmFtZSA9IHJhd0NvbmZpZztcclxuICAgICAgICByYXdDb25maWcgPSB7IG5hbWUgfTtcclxuICAgIH1cclxuICAgIGNvbnN0IGNvbmZpZyA9IE9iamVjdC5hc3NpZ24oeyBuYW1lOiBERUZBVUxUX0VOVFJZX05BTUUsIGF1dG9tYXRpY0RhdGFDb2xsZWN0aW9uRW5hYmxlZDogZmFsc2UgfSwgcmF3Q29uZmlnKTtcclxuICAgIGNvbnN0IG5hbWUgPSBjb25maWcubmFtZTtcclxuICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycgfHwgIW5hbWUpIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImJhZC1hcHAtbmFtZVwiIC8qIEFwcEVycm9yLkJBRF9BUFBfTkFNRSAqLywge1xyXG4gICAgICAgICAgICBhcHBOYW1lOiBTdHJpbmcobmFtZSlcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIG9wdGlvbnMgfHwgKG9wdGlvbnMgPSBnZXREZWZhdWx0QXBwQ29uZmlnKCkpO1xyXG4gICAgaWYgKCFvcHRpb25zKSB7XHJcbiAgICAgICAgdGhyb3cgRVJST1JfRkFDVE9SWS5jcmVhdGUoXCJuby1vcHRpb25zXCIgLyogQXBwRXJyb3IuTk9fT1BUSU9OUyAqLyk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBleGlzdGluZ0FwcCA9IF9hcHBzLmdldChuYW1lKTtcclxuICAgIGlmIChleGlzdGluZ0FwcCkge1xyXG4gICAgICAgIC8vIHJldHVybiB0aGUgZXhpc3RpbmcgYXBwIGlmIG9wdGlvbnMgYW5kIGNvbmZpZyBkZWVwIGVxdWFsIHRoZSBvbmVzIGluIHRoZSBleGlzdGluZyBhcHAuXHJcbiAgICAgICAgaWYgKGRlZXBFcXVhbChvcHRpb25zLCBleGlzdGluZ0FwcC5vcHRpb25zKSAmJlxyXG4gICAgICAgICAgICBkZWVwRXF1YWwoY29uZmlnLCBleGlzdGluZ0FwcC5jb25maWcpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBleGlzdGluZ0FwcDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRocm93IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiZHVwbGljYXRlLWFwcFwiIC8qIEFwcEVycm9yLkRVUExJQ0FURV9BUFAgKi8sIHsgYXBwTmFtZTogbmFtZSB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBjb25zdCBjb250YWluZXIgPSBuZXcgQ29tcG9uZW50Q29udGFpbmVyKG5hbWUpO1xyXG4gICAgZm9yIChjb25zdCBjb21wb25lbnQgb2YgX2NvbXBvbmVudHMudmFsdWVzKCkpIHtcclxuICAgICAgICBjb250YWluZXIuYWRkQ29tcG9uZW50KGNvbXBvbmVudCk7XHJcbiAgICB9XHJcbiAgICBjb25zdCBuZXdBcHAgPSBuZXcgRmlyZWJhc2VBcHBJbXBsKG9wdGlvbnMsIGNvbmZpZywgY29udGFpbmVyKTtcclxuICAgIF9hcHBzLnNldChuYW1lLCBuZXdBcHApO1xyXG4gICAgcmV0dXJuIG5ld0FwcDtcclxufVxyXG4vKipcclxuICogUmV0cmlldmVzIGEge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9IGluc3RhbmNlLlxyXG4gKlxyXG4gKiBXaGVuIGNhbGxlZCB3aXRoIG5vIGFyZ3VtZW50cywgdGhlIGRlZmF1bHQgYXBwIGlzIHJldHVybmVkLiBXaGVuIGFuIGFwcCBuYW1lXHJcbiAqIGlzIHByb3ZpZGVkLCB0aGUgYXBwIGNvcnJlc3BvbmRpbmcgdG8gdGhhdCBuYW1lIGlzIHJldHVybmVkLlxyXG4gKlxyXG4gKiBBbiBleGNlcHRpb24gaXMgdGhyb3duIGlmIHRoZSBhcHAgYmVpbmcgcmV0cmlldmVkIGhhcyBub3QgeWV0IGJlZW5cclxuICogaW5pdGlhbGl6ZWQuXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gUmV0dXJuIHRoZSBkZWZhdWx0IGFwcFxyXG4gKiBjb25zdCBhcHAgPSBnZXRBcHAoKTtcclxuICogYGBgXHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYGphdmFzY3JpcHRcclxuICogLy8gUmV0dXJuIGEgbmFtZWQgYXBwXHJcbiAqIGNvbnN0IG90aGVyQXBwID0gZ2V0QXBwKFwib3RoZXJBcHBcIik7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcGFyYW0gbmFtZSAtIE9wdGlvbmFsIG5hbWUgb2YgdGhlIGFwcCB0byByZXR1cm4uIElmIG5vIG5hbWUgaXNcclxuICogICBwcm92aWRlZCwgdGhlIGRlZmF1bHQgaXMgYFwiW0RFRkFVTFRdXCJgLlxyXG4gKlxyXG4gKiBAcmV0dXJucyBUaGUgYXBwIGNvcnJlc3BvbmRpbmcgdG8gdGhlIHByb3ZpZGVkIGFwcCBuYW1lLlxyXG4gKiAgIElmIG5vIGFwcCBuYW1lIGlzIHByb3ZpZGVkLCB0aGUgZGVmYXVsdCBhcHAgaXMgcmV0dXJuZWQuXHJcbiAqXHJcbiAqIEBwdWJsaWNcclxuICovXHJcbmZ1bmN0aW9uIGdldEFwcChuYW1lID0gREVGQVVMVF9FTlRSWV9OQU1FKSB7XHJcbiAgICBjb25zdCBhcHAgPSBfYXBwcy5nZXQobmFtZSk7XHJcbiAgICBpZiAoIWFwcCAmJiBuYW1lID09PSBERUZBVUxUX0VOVFJZX05BTUUpIHtcclxuICAgICAgICByZXR1cm4gaW5pdGlhbGl6ZUFwcCgpO1xyXG4gICAgfVxyXG4gICAgaWYgKCFhcHApIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcIm5vLWFwcFwiIC8qIEFwcEVycm9yLk5PX0FQUCAqLywgeyBhcHBOYW1lOiBuYW1lIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGFwcDtcclxufVxyXG4vKipcclxuICogQSAocmVhZC1vbmx5KSBhcnJheSBvZiBhbGwgaW5pdGlhbGl6ZWQgYXBwcy5cclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gZ2V0QXBwcygpIHtcclxuICAgIHJldHVybiBBcnJheS5mcm9tKF9hcHBzLnZhbHVlcygpKTtcclxufVxyXG4vKipcclxuICogUmVuZGVycyB0aGlzIGFwcCB1bnVzYWJsZSBhbmQgZnJlZXMgdGhlIHJlc291cmNlcyBvZiBhbGwgYXNzb2NpYXRlZFxyXG4gKiBzZXJ2aWNlcy5cclxuICpcclxuICogQGV4YW1wbGVcclxuICogYGBgamF2YXNjcmlwdFxyXG4gKiBkZWxldGVBcHAoYXBwKVxyXG4gKiAgIC50aGVuKGZ1bmN0aW9uKCkge1xyXG4gKiAgICAgY29uc29sZS5sb2coXCJBcHAgZGVsZXRlZCBzdWNjZXNzZnVsbHlcIik7XHJcbiAqICAgfSlcclxuICogICAuY2F0Y2goZnVuY3Rpb24oZXJyb3IpIHtcclxuICogICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgZGVsZXRpbmcgYXBwOlwiLCBlcnJvcik7XHJcbiAqICAgfSk7XHJcbiAqIGBgYFxyXG4gKlxyXG4gKiBAcHVibGljXHJcbiAqL1xyXG5hc3luYyBmdW5jdGlvbiBkZWxldGVBcHAoYXBwKSB7XHJcbiAgICBjb25zdCBuYW1lID0gYXBwLm5hbWU7XHJcbiAgICBpZiAoX2FwcHMuaGFzKG5hbWUpKSB7XHJcbiAgICAgICAgX2FwcHMuZGVsZXRlKG5hbWUpO1xyXG4gICAgICAgIGF3YWl0IFByb21pc2UuYWxsKGFwcC5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVycygpXHJcbiAgICAgICAgICAgIC5tYXAocHJvdmlkZXIgPT4gcHJvdmlkZXIuZGVsZXRlKCkpKTtcclxuICAgICAgICBhcHAuaXNEZWxldGVkID0gdHJ1ZTtcclxuICAgIH1cclxufVxyXG4vKipcclxuICogUmVnaXN0ZXJzIGEgbGlicmFyeSdzIG5hbWUgYW5kIHZlcnNpb24gZm9yIHBsYXRmb3JtIGxvZ2dpbmcgcHVycG9zZXMuXHJcbiAqIEBwYXJhbSBsaWJyYXJ5IC0gTmFtZSBvZiAxcCBvciAzcCBsaWJyYXJ5IChlLmcuIGZpcmVzdG9yZSwgYW5ndWxhcmZpcmUpXHJcbiAqIEBwYXJhbSB2ZXJzaW9uIC0gQ3VycmVudCB2ZXJzaW9uIG9mIHRoYXQgbGlicmFyeS5cclxuICogQHBhcmFtIHZhcmlhbnQgLSBCdW5kbGUgdmFyaWFudCwgZS5nLiwgbm9kZSwgcm4sIGV0Yy5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gcmVnaXN0ZXJWZXJzaW9uKGxpYnJhcnlLZXlPck5hbWUsIHZlcnNpb24sIHZhcmlhbnQpIHtcclxuICAgIHZhciBfYTtcclxuICAgIC8vIFRPRE86IFdlIGNhbiB1c2UgdGhpcyBjaGVjayB0byB3aGl0ZWxpc3Qgc3RyaW5ncyB3aGVuL2lmIHdlIHNldCB1cFxyXG4gICAgLy8gYSBnb29kIHdoaXRlbGlzdCBzeXN0ZW0uXHJcbiAgICBsZXQgbGlicmFyeSA9IChfYSA9IFBMQVRGT1JNX0xPR19TVFJJTkdbbGlicmFyeUtleU9yTmFtZV0pICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxpYnJhcnlLZXlPck5hbWU7XHJcbiAgICBpZiAodmFyaWFudCkge1xyXG4gICAgICAgIGxpYnJhcnkgKz0gYC0ke3ZhcmlhbnR9YDtcclxuICAgIH1cclxuICAgIGNvbnN0IGxpYnJhcnlNaXNtYXRjaCA9IGxpYnJhcnkubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGNvbnN0IHZlcnNpb25NaXNtYXRjaCA9IHZlcnNpb24ubWF0Y2goL1xcc3xcXC8vKTtcclxuICAgIGlmIChsaWJyYXJ5TWlzbWF0Y2ggfHwgdmVyc2lvbk1pc21hdGNoKSB7XHJcbiAgICAgICAgY29uc3Qgd2FybmluZyA9IFtcclxuICAgICAgICAgICAgYFVuYWJsZSB0byByZWdpc3RlciBsaWJyYXJ5IFwiJHtsaWJyYXJ5fVwiIHdpdGggdmVyc2lvbiBcIiR7dmVyc2lvbn1cIjpgXHJcbiAgICAgICAgXTtcclxuICAgICAgICBpZiAobGlicmFyeU1pc21hdGNoKSB7XHJcbiAgICAgICAgICAgIHdhcm5pbmcucHVzaChgbGlicmFyeSBuYW1lIFwiJHtsaWJyYXJ5fVwiIGNvbnRhaW5zIGlsbGVnYWwgY2hhcmFjdGVycyAod2hpdGVzcGFjZSBvciBcIi9cIilgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGxpYnJhcnlNaXNtYXRjaCAmJiB2ZXJzaW9uTWlzbWF0Y2gpIHtcclxuICAgICAgICAgICAgd2FybmluZy5wdXNoKCdhbmQnKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHZlcnNpb25NaXNtYXRjaCkge1xyXG4gICAgICAgICAgICB3YXJuaW5nLnB1c2goYHZlcnNpb24gbmFtZSBcIiR7dmVyc2lvbn1cIiBjb250YWlucyBpbGxlZ2FsIGNoYXJhY3RlcnMgKHdoaXRlc3BhY2Ugb3IgXCIvXCIpYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxvZ2dlci53YXJuKHdhcm5pbmcuam9pbignICcpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBfcmVnaXN0ZXJDb21wb25lbnQobmV3IENvbXBvbmVudChgJHtsaWJyYXJ5fS12ZXJzaW9uYCwgKCkgPT4gKHsgbGlicmFyeSwgdmVyc2lvbiB9KSwgXCJWRVJTSU9OXCIgLyogQ29tcG9uZW50VHlwZS5WRVJTSU9OICovKSk7XHJcbn1cclxuLyoqXHJcbiAqIFNldHMgbG9nIGhhbmRsZXIgZm9yIGFsbCBGaXJlYmFzZSBTREtzLlxyXG4gKiBAcGFyYW0gbG9nQ2FsbGJhY2sgLSBBbiBvcHRpb25hbCBjdXN0b20gbG9nIGhhbmRsZXIgdGhhdCBleGVjdXRlcyB1c2VyIGNvZGUgd2hlbmV2ZXJcclxuICogdGhlIEZpcmViYXNlIFNESyBtYWtlcyBhIGxvZ2dpbmcgY2FsbC5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gb25Mb2cobG9nQ2FsbGJhY2ssIG9wdGlvbnMpIHtcclxuICAgIGlmIChsb2dDYWxsYmFjayAhPT0gbnVsbCAmJiB0eXBlb2YgbG9nQ2FsbGJhY2sgIT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImludmFsaWQtbG9nLWFyZ3VtZW50XCIgLyogQXBwRXJyb3IuSU5WQUxJRF9MT0dfQVJHVU1FTlQgKi8pO1xyXG4gICAgfVxyXG4gICAgc2V0VXNlckxvZ0hhbmRsZXIobG9nQ2FsbGJhY2ssIG9wdGlvbnMpO1xyXG59XHJcbi8qKlxyXG4gKiBTZXRzIGxvZyBsZXZlbCBmb3IgYWxsIEZpcmViYXNlIFNES3MuXHJcbiAqXHJcbiAqIEFsbCBvZiB0aGUgbG9nIHR5cGVzIGFib3ZlIHRoZSBjdXJyZW50IGxvZyBsZXZlbCBhcmUgY2FwdHVyZWQgKGkuZS4gaWZcclxuICogeW91IHNldCB0aGUgbG9nIGxldmVsIHRvIGBpbmZvYCwgZXJyb3JzIGFyZSBsb2dnZWQsIGJ1dCBgZGVidWdgIGFuZFxyXG4gKiBgdmVyYm9zZWAgbG9ncyBhcmUgbm90KS5cclxuICpcclxuICogQHB1YmxpY1xyXG4gKi9cclxuZnVuY3Rpb24gc2V0TG9nTGV2ZWwobG9nTGV2ZWwpIHtcclxuICAgIHNldExvZ0xldmVsJDEobG9nTGV2ZWwpO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IERCX05BTUUgPSAnZmlyZWJhc2UtaGVhcnRiZWF0LWRhdGFiYXNlJztcclxuY29uc3QgREJfVkVSU0lPTiA9IDE7XHJcbmNvbnN0IFNUT1JFX05BTUUgPSAnZmlyZWJhc2UtaGVhcnRiZWF0LXN0b3JlJztcclxubGV0IGRiUHJvbWlzZSA9IG51bGw7XHJcbmZ1bmN0aW9uIGdldERiUHJvbWlzZSgpIHtcclxuICAgIGlmICghZGJQcm9taXNlKSB7XHJcbiAgICAgICAgZGJQcm9taXNlID0gb3BlbkRCKERCX05BTUUsIERCX1ZFUlNJT04sIHtcclxuICAgICAgICAgICAgdXBncmFkZTogKGRiLCBvbGRWZXJzaW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAvLyBXZSBkb24ndCB1c2UgJ2JyZWFrJyBpbiB0aGlzIHN3aXRjaCBzdGF0ZW1lbnQsIHRoZSBmYWxsLXRocm91Z2hcclxuICAgICAgICAgICAgICAgIC8vIGJlaGF2aW9yIGlzIHdoYXQgd2Ugd2FudCwgYmVjYXVzZSBpZiB0aGVyZSBhcmUgbXVsdGlwbGUgdmVyc2lvbnMgYmV0d2VlblxyXG4gICAgICAgICAgICAgICAgLy8gdGhlIG9sZCB2ZXJzaW9uIGFuZCB0aGUgY3VycmVudCB2ZXJzaW9uLCB3ZSB3YW50IEFMTCB0aGUgbWlncmF0aW9uc1xyXG4gICAgICAgICAgICAgICAgLy8gdGhhdCBjb3JyZXNwb25kIHRvIHRob3NlIHZlcnNpb25zIHRvIHJ1biwgbm90IG9ubHkgdGhlIGxhc3Qgb25lLlxyXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlZmF1bHQtY2FzZVxyXG4gICAgICAgICAgICAgICAgc3dpdGNoIChvbGRWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkYi5jcmVhdGVPYmplY3RTdG9yZShTVE9SRV9OQU1FKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGUgPT4ge1xyXG4gICAgICAgICAgICB0aHJvdyBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImlkYi1vcGVuXCIgLyogQXBwRXJyb3IuSURCX09QRU4gKi8sIHtcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRXJyb3JNZXNzYWdlOiBlLm1lc3NhZ2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gZGJQcm9taXNlO1xyXG59XHJcbmFzeW5jIGZ1bmN0aW9uIHJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQihhcHApIHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgZGIgPSBhd2FpdCBnZXREYlByb21pc2UoKTtcclxuICAgICAgICByZXR1cm4gZGJcclxuICAgICAgICAgICAgLnRyYW5zYWN0aW9uKFNUT1JFX05BTUUpXHJcbiAgICAgICAgICAgIC5vYmplY3RTdG9yZShTVE9SRV9OQU1FKVxyXG4gICAgICAgICAgICAuZ2V0KGNvbXB1dGVLZXkoYXBwKSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZSkge1xyXG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgRmlyZWJhc2VFcnJvcikge1xyXG4gICAgICAgICAgICBsb2dnZXIud2FybihlLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3QgaWRiR2V0RXJyb3IgPSBFUlJPUl9GQUNUT1JZLmNyZWF0ZShcImlkYi1nZXRcIiAvKiBBcHBFcnJvci5JREJfR0VUICovLCB7XHJcbiAgICAgICAgICAgICAgICBvcmlnaW5hbEVycm9yTWVzc2FnZTogZSA9PT0gbnVsbCB8fCBlID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlLm1lc3NhZ2VcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKGlkYkdldEVycm9yLm1lc3NhZ2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5hc3luYyBmdW5jdGlvbiB3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQihhcHAsIGhlYXJ0YmVhdE9iamVjdCkge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCBkYiA9IGF3YWl0IGdldERiUHJvbWlzZSgpO1xyXG4gICAgICAgIGNvbnN0IHR4ID0gZGIudHJhbnNhY3Rpb24oU1RPUkVfTkFNRSwgJ3JlYWR3cml0ZScpO1xyXG4gICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHgub2JqZWN0U3RvcmUoU1RPUkVfTkFNRSk7XHJcbiAgICAgICAgYXdhaXQgb2JqZWN0U3RvcmUucHV0KGhlYXJ0YmVhdE9iamVjdCwgY29tcHV0ZUtleShhcHApKTtcclxuICAgICAgICByZXR1cm4gdHguZG9uZTtcclxuICAgIH1cclxuICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBGaXJlYmFzZUVycm9yKSB7XHJcbiAgICAgICAgICAgIGxvZ2dlci53YXJuKGUubWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBpZGJHZXRFcnJvciA9IEVSUk9SX0ZBQ1RPUlkuY3JlYXRlKFwiaWRiLXNldFwiIC8qIEFwcEVycm9yLklEQl9XUklURSAqLywge1xyXG4gICAgICAgICAgICAgICAgb3JpZ2luYWxFcnJvck1lc3NhZ2U6IGUgPT09IG51bGwgfHwgZSA9PT0gdm9pZCAwID8gdm9pZCAwIDogZS5tZXNzYWdlXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBsb2dnZXIud2FybihpZGJHZXRFcnJvci5tZXNzYWdlKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gY29tcHV0ZUtleShhcHApIHtcclxuICAgIHJldHVybiBgJHthcHAubmFtZX0hJHthcHAub3B0aW9ucy5hcHBJZH1gO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmNvbnN0IE1BWF9IRUFERVJfQllURVMgPSAxMDI0O1xyXG4vLyAzMCBkYXlzXHJcbmNvbnN0IFNUT1JFRF9IRUFSVEJFQVRfUkVURU5USU9OX01BWF9NSUxMSVMgPSAzMCAqIDI0ICogNjAgKiA2MCAqIDEwMDA7XHJcbmNsYXNzIEhlYXJ0YmVhdFNlcnZpY2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lcikge1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEluLW1lbW9yeSBjYWNoZSBmb3IgaGVhcnRiZWF0cywgdXNlZCBieSBnZXRIZWFydGJlYXRzSGVhZGVyKCkgdG8gZ2VuZXJhdGVcclxuICAgICAgICAgKiB0aGUgaGVhZGVyIHN0cmluZy5cclxuICAgICAgICAgKiBTdG9yZXMgb25lIHJlY29yZCBwZXIgZGF0ZS4gVGhpcyB3aWxsIGJlIGNvbnNvbGlkYXRlZCBpbnRvIHRoZSBzdGFuZGFyZFxyXG4gICAgICAgICAqIGZvcm1hdCBvZiBvbmUgcmVjb3JkIHBlciB1c2VyIGFnZW50IHN0cmluZyBiZWZvcmUgYmVpbmcgc2VudCBhcyBhIGhlYWRlci5cclxuICAgICAgICAgKiBQb3B1bGF0ZWQgZnJvbSBpbmRleGVkREIgd2hlbiB0aGUgY29udHJvbGxlciBpcyBpbnN0YW50aWF0ZWQgYW5kIHNob3VsZFxyXG4gICAgICAgICAqIGJlIGtlcHQgaW4gc3luYyB3aXRoIGluZGV4ZWREQi5cclxuICAgICAgICAgKiBMZWF2ZSBwdWJsaWMgZm9yIGVhc2llciB0ZXN0aW5nLlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9IG51bGw7XHJcbiAgICAgICAgY29uc3QgYXBwID0gdGhpcy5jb250YWluZXIuZ2V0UHJvdmlkZXIoJ2FwcCcpLmdldEltbWVkaWF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX3N0b3JhZ2UgPSBuZXcgSGVhcnRiZWF0U3RvcmFnZUltcGwoYXBwKTtcclxuICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGVQcm9taXNlID0gdGhpcy5fc3RvcmFnZS5yZWFkKCkudGhlbihyZXN1bHQgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUgPSByZXN1bHQ7XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIENhbGxlZCB0byByZXBvcnQgYSBoZWFydGJlYXQuIFRoZSBmdW5jdGlvbiB3aWxsIGdlbmVyYXRlXHJcbiAgICAgKiBhIEhlYXJ0YmVhdHNCeVVzZXJBZ2VudCBvYmplY3QsIHVwZGF0ZSBoZWFydGJlYXRzQ2FjaGUsIGFuZCBwZXJzaXN0IGl0XHJcbiAgICAgKiB0byBJbmRleGVkREIuXHJcbiAgICAgKiBOb3RlIHRoYXQgd2Ugb25seSBzdG9yZSBvbmUgaGVhcnRiZWF0IHBlciBkYXkuIFNvIGlmIGEgaGVhcnRiZWF0IGZvciB0b2RheSBpc1xyXG4gICAgICogYWxyZWFkeSBsb2dnZWQsIHN1YnNlcXVlbnQgY2FsbHMgdG8gdGhpcyBmdW5jdGlvbiBpbiB0aGUgc2FtZSBkYXkgd2lsbCBiZSBpZ25vcmVkLlxyXG4gICAgICovXHJcbiAgICBhc3luYyB0cmlnZ2VySGVhcnRiZWF0KCkge1xyXG4gICAgICAgIGNvbnN0IHBsYXRmb3JtTG9nZ2VyID0gdGhpcy5jb250YWluZXJcclxuICAgICAgICAgICAgLmdldFByb3ZpZGVyKCdwbGF0Zm9ybS1sb2dnZXInKVxyXG4gICAgICAgICAgICAuZ2V0SW1tZWRpYXRlKCk7XHJcbiAgICAgICAgLy8gVGhpcyBpcyB0aGUgXCJGaXJlYmFzZSB1c2VyIGFnZW50XCIgc3RyaW5nIGZyb20gdGhlIHBsYXRmb3JtIGxvZ2dlclxyXG4gICAgICAgIC8vIHNlcnZpY2UsIG5vdCB0aGUgYnJvd3NlciB1c2VyIGFnZW50LlxyXG4gICAgICAgIGNvbnN0IGFnZW50ID0gcGxhdGZvcm1Mb2dnZXIuZ2V0UGxhdGZvcm1JbmZvU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IGdldFVUQ0RhdGVTdHJpbmcoKTtcclxuICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSA9IGF3YWl0IHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIERvIG5vdCBzdG9yZSBhIGhlYXJ0YmVhdCBpZiBvbmUgaXMgYWxyZWFkeSBzdG9yZWQgZm9yIHRoaXMgZGF5XHJcbiAgICAgICAgLy8gb3IgaWYgYSBoZWFkZXIgaGFzIGFscmVhZHkgYmVlbiBzZW50IHRvZGF5LlxyXG4gICAgICAgIGlmICh0aGlzLl9oZWFydGJlYXRzQ2FjaGUubGFzdFNlbnRIZWFydGJlYXREYXRlID09PSBkYXRlIHx8XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLnNvbWUoc2luZ2xlRGF0ZUhlYXJ0YmVhdCA9PiBzaW5nbGVEYXRlSGVhcnRiZWF0LmRhdGUgPT09IGRhdGUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFRoZXJlIGlzIG5vIGVudHJ5IGZvciB0aGlzIGRhdGUuIENyZWF0ZSBvbmUuXHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLnB1c2goeyBkYXRlLCBhZ2VudCB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gUmVtb3ZlIGVudHJpZXMgb2xkZXIgdGhhbiAzMCBkYXlzLlxyXG4gICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzID0gdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMuZmlsdGVyKHNpbmdsZURhdGVIZWFydGJlYXQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBoYlRpbWVzdGFtcCA9IG5ldyBEYXRlKHNpbmdsZURhdGVIZWFydGJlYXQuZGF0ZSkudmFsdWVPZigpO1xyXG4gICAgICAgICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICByZXR1cm4gbm93IC0gaGJUaW1lc3RhbXAgPD0gU1RPUkVEX0hFQVJUQkVBVF9SRVRFTlRJT05fTUFYX01JTExJUztcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdGhpcy5fc3RvcmFnZS5vdmVyd3JpdGUodGhpcy5faGVhcnRiZWF0c0NhY2hlKTtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmV0dXJucyBhIGJhc2U2NCBlbmNvZGVkIHN0cmluZyB3aGljaCBjYW4gYmUgYXR0YWNoZWQgdG8gdGhlIGhlYXJ0YmVhdC1zcGVjaWZpYyBoZWFkZXIgZGlyZWN0bHkuXHJcbiAgICAgKiBJdCBhbHNvIGNsZWFycyBhbGwgaGVhcnRiZWF0cyBmcm9tIG1lbW9yeSBhcyB3ZWxsIGFzIGluIEluZGV4ZWREQi5cclxuICAgICAqXHJcbiAgICAgKiBOT1RFOiBDb25zdW1pbmcgcHJvZHVjdCBTREtzIHNob3VsZCBub3Qgc2VuZCB0aGUgaGVhZGVyIGlmIHRoaXMgbWV0aG9kXHJcbiAgICAgKiByZXR1cm5zIGFuIGVtcHR5IHN0cmluZy5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgZ2V0SGVhcnRiZWF0c0hlYWRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuX2hlYXJ0YmVhdHNDYWNoZVByb21pc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIElmIGl0J3Mgc3RpbGwgbnVsbCBvciB0aGUgYXJyYXkgaXMgZW1wdHksIHRoZXJlIGlzIG5vIGRhdGEgdG8gc2VuZC5cclxuICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0c0NhY2hlID09PSBudWxsIHx8XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXJ0YmVhdHNDYWNoZS5oZWFydGJlYXRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRhdGUgPSBnZXRVVENEYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgLy8gRXh0cmFjdCBhcyBtYW55IGhlYXJ0YmVhdHMgZnJvbSB0aGUgY2FjaGUgYXMgd2lsbCBmaXQgdW5kZXIgdGhlIHNpemUgbGltaXQuXHJcbiAgICAgICAgY29uc3QgeyBoZWFydGJlYXRzVG9TZW5kLCB1bnNlbnRFbnRyaWVzIH0gPSBleHRyYWN0SGVhcnRiZWF0c0ZvckhlYWRlcih0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cyk7XHJcbiAgICAgICAgY29uc3QgaGVhZGVyU3RyaW5nID0gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoSlNPTi5zdHJpbmdpZnkoeyB2ZXJzaW9uOiAyLCBoZWFydGJlYXRzOiBoZWFydGJlYXRzVG9TZW5kIH0pKTtcclxuICAgICAgICAvLyBTdG9yZSBsYXN0IHNlbnQgZGF0ZSB0byBwcmV2ZW50IGFub3RoZXIgYmVpbmcgbG9nZ2VkL3NlbnQgZm9yIHRoZSBzYW1lIGRheS5cclxuICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUubGFzdFNlbnRIZWFydGJlYXREYXRlID0gZGF0ZTtcclxuICAgICAgICBpZiAodW5zZW50RW50cmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIC8vIFN0b3JlIGFueSB1bnNlbnQgZW50cmllcyBpZiB0aGV5IGV4aXN0LlxyXG4gICAgICAgICAgICB0aGlzLl9oZWFydGJlYXRzQ2FjaGUuaGVhcnRiZWF0cyA9IHVuc2VudEVudHJpZXM7XHJcbiAgICAgICAgICAgIC8vIFRoaXMgc2VlbXMgbW9yZSBsaWtlbHkgdGhhbiBlbXB0eWluZyB0aGUgYXJyYXkgKGJlbG93KSB0byBsZWFkIHRvIHNvbWUgb2RkIHN0YXRlXHJcbiAgICAgICAgICAgIC8vIHNpbmNlIHRoZSBjYWNoZSBpc24ndCBlbXB0eSBhbmQgdGhpcyB3aWxsIGJlIGNhbGxlZCBhZ2FpbiBvbiB0aGUgbmV4dCByZXF1ZXN0LFxyXG4gICAgICAgICAgICAvLyBhbmQgaXMgcHJvYmFibHkgc2FmZXN0IGlmIHdlIGF3YWl0IGl0LlxyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLl9zdG9yYWdlLm92ZXJ3cml0ZSh0aGlzLl9oZWFydGJlYXRzQ2FjaGUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5faGVhcnRiZWF0c0NhY2hlLmhlYXJ0YmVhdHMgPSBbXTtcclxuICAgICAgICAgICAgLy8gRG8gbm90IHdhaXQgZm9yIHRoaXMsIHRvIHJlZHVjZSBsYXRlbmN5LlxyXG4gICAgICAgICAgICB2b2lkIHRoaXMuX3N0b3JhZ2Uub3ZlcndyaXRlKHRoaXMuX2hlYXJ0YmVhdHNDYWNoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBoZWFkZXJTdHJpbmc7XHJcbiAgICB9XHJcbn1cclxuZnVuY3Rpb24gZ2V0VVRDRGF0ZVN0cmluZygpIHtcclxuICAgIGNvbnN0IHRvZGF5ID0gbmV3IERhdGUoKTtcclxuICAgIC8vIFJldHVybnMgZGF0ZSBmb3JtYXQgJ1lZWVktTU0tREQnXHJcbiAgICByZXR1cm4gdG9kYXkudG9JU09TdHJpbmcoKS5zdWJzdHJpbmcoMCwgMTApO1xyXG59XHJcbmZ1bmN0aW9uIGV4dHJhY3RIZWFydGJlYXRzRm9ySGVhZGVyKGhlYXJ0YmVhdHNDYWNoZSwgbWF4U2l6ZSA9IE1BWF9IRUFERVJfQllURVMpIHtcclxuICAgIC8vIEhlYXJ0YmVhdHMgZ3JvdXBlZCBieSB1c2VyIGFnZW50IGluIHRoZSBzdGFuZGFyZCBmb3JtYXQgdG8gYmUgc2VudCBpblxyXG4gICAgLy8gdGhlIGhlYWRlci5cclxuICAgIGNvbnN0IGhlYXJ0YmVhdHNUb1NlbmQgPSBbXTtcclxuICAgIC8vIFNpbmdsZSBkYXRlIGZvcm1hdCBoZWFydGJlYXRzIHRoYXQgYXJlIG5vdCBzZW50LlxyXG4gICAgbGV0IHVuc2VudEVudHJpZXMgPSBoZWFydGJlYXRzQ2FjaGUuc2xpY2UoKTtcclxuICAgIGZvciAoY29uc3Qgc2luZ2xlRGF0ZUhlYXJ0YmVhdCBvZiBoZWFydGJlYXRzQ2FjaGUpIHtcclxuICAgICAgICAvLyBMb29rIGZvciBhbiBleGlzdGluZyBlbnRyeSB3aXRoIHRoZSBzYW1lIHVzZXIgYWdlbnQuXHJcbiAgICAgICAgY29uc3QgaGVhcnRiZWF0RW50cnkgPSBoZWFydGJlYXRzVG9TZW5kLmZpbmQoaGIgPT4gaGIuYWdlbnQgPT09IHNpbmdsZURhdGVIZWFydGJlYXQuYWdlbnQpO1xyXG4gICAgICAgIGlmICghaGVhcnRiZWF0RW50cnkpIHtcclxuICAgICAgICAgICAgLy8gSWYgbm8gZW50cnkgZm9yIHRoaXMgdXNlciBhZ2VudCBleGlzdHMsIGNyZWF0ZSBvbmUuXHJcbiAgICAgICAgICAgIGhlYXJ0YmVhdHNUb1NlbmQucHVzaCh7XHJcbiAgICAgICAgICAgICAgICBhZ2VudDogc2luZ2xlRGF0ZUhlYXJ0YmVhdC5hZ2VudCxcclxuICAgICAgICAgICAgICAgIGRhdGVzOiBbc2luZ2xlRGF0ZUhlYXJ0YmVhdC5kYXRlXVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKGNvdW50Qnl0ZXMoaGVhcnRiZWF0c1RvU2VuZCkgPiBtYXhTaXplKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiB0aGUgaGVhZGVyIHdvdWxkIGV4Y2VlZCBtYXggc2l6ZSwgcmVtb3ZlIHRoZSBhZGRlZCBoZWFydGJlYXRcclxuICAgICAgICAgICAgICAgIC8vIGVudHJ5IGFuZCBzdG9wIGFkZGluZyB0byB0aGUgaGVhZGVyLlxyXG4gICAgICAgICAgICAgICAgaGVhcnRiZWF0c1RvU2VuZC5wb3AoKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBoZWFydGJlYXRFbnRyeS5kYXRlcy5wdXNoKHNpbmdsZURhdGVIZWFydGJlYXQuZGF0ZSk7XHJcbiAgICAgICAgICAgIC8vIElmIHRoZSBoZWFkZXIgd291bGQgZXhjZWVkIG1heCBzaXplLCByZW1vdmUgdGhlIGFkZGVkIGRhdGVcclxuICAgICAgICAgICAgLy8gYW5kIHN0b3AgYWRkaW5nIHRvIHRoZSBoZWFkZXIuXHJcbiAgICAgICAgICAgIGlmIChjb3VudEJ5dGVzKGhlYXJ0YmVhdHNUb1NlbmQpID4gbWF4U2l6ZSkge1xyXG4gICAgICAgICAgICAgICAgaGVhcnRiZWF0RW50cnkuZGF0ZXMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBQb3AgdW5zZW50IGVudHJ5IGZyb20gcXVldWUuIChTa2lwcGVkIGlmIGFkZGluZyB0aGUgZW50cnkgZXhjZWVkZWRcclxuICAgICAgICAvLyBxdW90YSBhbmQgdGhlIGxvb3AgYnJlYWtzIGVhcmx5LilcclxuICAgICAgICB1bnNlbnRFbnRyaWVzID0gdW5zZW50RW50cmllcy5zbGljZSgxKTtcclxuICAgIH1cclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgaGVhcnRiZWF0c1RvU2VuZCxcclxuICAgICAgICB1bnNlbnRFbnRyaWVzXHJcbiAgICB9O1xyXG59XHJcbmNsYXNzIEhlYXJ0YmVhdFN0b3JhZ2VJbXBsIHtcclxuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xyXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xyXG4gICAgICAgIHRoaXMuX2NhblVzZUluZGV4ZWREQlByb21pc2UgPSB0aGlzLnJ1bkluZGV4ZWREQkVudmlyb25tZW50Q2hlY2soKTtcclxuICAgIH1cclxuICAgIGFzeW5jIHJ1bkluZGV4ZWREQkVudmlyb25tZW50Q2hlY2soKSB7XHJcbiAgICAgICAgaWYgKCFpc0luZGV4ZWREQkF2YWlsYWJsZSgpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWxpZGF0ZUluZGV4ZWREQk9wZW5hYmxlKClcclxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHRydWUpXHJcbiAgICAgICAgICAgICAgICAuY2F0Y2goKCkgPT4gZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogUmVhZCBhbGwgaGVhcnRiZWF0cy5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgcmVhZCgpIHtcclxuICAgICAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xyXG4gICAgICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IGhlYXJ0YmVhdHM6IFtdIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBpZGJIZWFydGJlYXRPYmplY3QgPSBhd2FpdCByZWFkSGVhcnRiZWF0c0Zyb21JbmRleGVkREIodGhpcy5hcHApO1xyXG4gICAgICAgICAgICByZXR1cm4gaWRiSGVhcnRiZWF0T2JqZWN0IHx8IHsgaGVhcnRiZWF0czogW10gfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICAvLyBvdmVyd3JpdGUgdGhlIHN0b3JhZ2Ugd2l0aCB0aGUgcHJvdmlkZWQgaGVhcnRiZWF0c1xyXG4gICAgYXN5bmMgb3ZlcndyaXRlKGhlYXJ0YmVhdHNPYmplY3QpIHtcclxuICAgICAgICB2YXIgX2E7XHJcbiAgICAgICAgY29uc3QgY2FuVXNlSW5kZXhlZERCID0gYXdhaXQgdGhpcy5fY2FuVXNlSW5kZXhlZERCUHJvbWlzZTtcclxuICAgICAgICBpZiAoIWNhblVzZUluZGV4ZWREQikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zdCBleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QgPSBhd2FpdCB0aGlzLnJlYWQoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHdyaXRlSGVhcnRiZWF0c1RvSW5kZXhlZERCKHRoaXMuYXBwLCB7XHJcbiAgICAgICAgICAgICAgICBsYXN0U2VudEhlYXJ0YmVhdERhdGU6IChfYSA9IGhlYXJ0YmVhdHNPYmplY3QubGFzdFNlbnRIZWFydGJlYXREYXRlKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QubGFzdFNlbnRIZWFydGJlYXREYXRlLFxyXG4gICAgICAgICAgICAgICAgaGVhcnRiZWF0czogaGVhcnRiZWF0c09iamVjdC5oZWFydGJlYXRzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIC8vIGFkZCBoZWFydGJlYXRzXHJcbiAgICBhc3luYyBhZGQoaGVhcnRiZWF0c09iamVjdCkge1xyXG4gICAgICAgIHZhciBfYTtcclxuICAgICAgICBjb25zdCBjYW5Vc2VJbmRleGVkREIgPSBhd2FpdCB0aGlzLl9jYW5Vc2VJbmRleGVkREJQcm9taXNlO1xyXG4gICAgICAgIGlmICghY2FuVXNlSW5kZXhlZERCKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdCA9IGF3YWl0IHRoaXMucmVhZCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gd3JpdGVIZWFydGJlYXRzVG9JbmRleGVkREIodGhpcy5hcHAsIHtcclxuICAgICAgICAgICAgICAgIGxhc3RTZW50SGVhcnRiZWF0RGF0ZTogKF9hID0gaGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGV4aXN0aW5nSGVhcnRiZWF0c09iamVjdC5sYXN0U2VudEhlYXJ0YmVhdERhdGUsXHJcbiAgICAgICAgICAgICAgICBoZWFydGJlYXRzOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgLi4uZXhpc3RpbmdIZWFydGJlYXRzT2JqZWN0LmhlYXJ0YmVhdHMsXHJcbiAgICAgICAgICAgICAgICAgICAgLi4uaGVhcnRiZWF0c09iamVjdC5oZWFydGJlYXRzXHJcbiAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG4vKipcclxuICogQ2FsY3VsYXRlIGJ5dGVzIG9mIGEgSGVhcnRiZWF0c0J5VXNlckFnZW50IGFycmF5IGFmdGVyIGJlaW5nIHdyYXBwZWRcclxuICogaW4gYSBwbGF0Zm9ybSBsb2dnaW5nIGhlYWRlciBKU09OIG9iamVjdCwgc3RyaW5naWZpZWQsIGFuZCBjb252ZXJ0ZWRcclxuICogdG8gYmFzZSA2NC5cclxuICovXHJcbmZ1bmN0aW9uIGNvdW50Qnl0ZXMoaGVhcnRiZWF0c0NhY2hlKSB7XHJcbiAgICAvLyBiYXNlNjQgaGFzIGEgcmVzdHJpY3RlZCBzZXQgb2YgY2hhcmFjdGVycywgYWxsIG9mIHdoaWNoIHNob3VsZCBiZSAxIGJ5dGUuXHJcbiAgICByZXR1cm4gYmFzZTY0dXJsRW5jb2RlV2l0aG91dFBhZGRpbmcoXHJcbiAgICAvLyBoZWFydGJlYXRzQ2FjaGUgd3JhcHBlciBwcm9wZXJ0aWVzXHJcbiAgICBKU09OLnN0cmluZ2lmeSh7IHZlcnNpb246IDIsIGhlYXJ0YmVhdHM6IGhlYXJ0YmVhdHNDYWNoZSB9KSkubGVuZ3RoO1xyXG59XG5cbi8qKlxyXG4gKiBAbGljZW5zZVxyXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXHJcbiAqXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XHJcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cclxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XHJcbiAqXHJcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXHJcbiAqXHJcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcclxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxyXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cclxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxyXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cclxuICovXHJcbmZ1bmN0aW9uIHJlZ2lzdGVyQ29yZUNvbXBvbmVudHModmFyaWFudCkge1xyXG4gICAgX3JlZ2lzdGVyQ29tcG9uZW50KG5ldyBDb21wb25lbnQoJ3BsYXRmb3JtLWxvZ2dlcicsIGNvbnRhaW5lciA9PiBuZXcgUGxhdGZvcm1Mb2dnZXJTZXJ2aWNlSW1wbChjb250YWluZXIpLCBcIlBSSVZBVEVcIiAvKiBDb21wb25lbnRUeXBlLlBSSVZBVEUgKi8pKTtcclxuICAgIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KCdoZWFydGJlYXQnLCBjb250YWluZXIgPT4gbmV3IEhlYXJ0YmVhdFNlcnZpY2VJbXBsKGNvbnRhaW5lciksIFwiUFJJVkFURVwiIC8qIENvbXBvbmVudFR5cGUuUFJJVkFURSAqLykpO1xyXG4gICAgLy8gUmVnaXN0ZXIgYGFwcGAgcGFja2FnZS5cclxuICAgIHJlZ2lzdGVyVmVyc2lvbihuYW1lJG8sIHZlcnNpb24kMSwgdmFyaWFudCk7XHJcbiAgICAvLyBCVUlMRF9UQVJHRVQgd2lsbCBiZSByZXBsYWNlZCBieSB2YWx1ZXMgbGlrZSBlc201LCBlc20yMDE3LCBjanM1LCBldGMgZHVyaW5nIHRoZSBjb21waWxhdGlvblxyXG4gICAgcmVnaXN0ZXJWZXJzaW9uKG5hbWUkbywgdmVyc2lvbiQxLCAnZXNtMjAxNycpO1xyXG4gICAgLy8gUmVnaXN0ZXIgcGxhdGZvcm0gU0RLIGlkZW50aWZpZXIgKG5vIHZlcnNpb24pLlxyXG4gICAgcmVnaXN0ZXJWZXJzaW9uKCdmaXJlLWpzJywgJycpO1xyXG59XG5cbi8qKlxyXG4gKiBGaXJlYmFzZSBBcHBcclxuICpcclxuICogQHJlbWFya3MgVGhpcyBwYWNrYWdlIGNvb3JkaW5hdGVzIHRoZSBjb21tdW5pY2F0aW9uIGJldHdlZW4gdGhlIGRpZmZlcmVudCBGaXJlYmFzZSBjb21wb25lbnRzXHJcbiAqIEBwYWNrYWdlRG9jdW1lbnRhdGlvblxyXG4gKi9cclxucmVnaXN0ZXJDb3JlQ29tcG9uZW50cygnJyk7XG5cbmV4cG9ydCB7IFNES19WRVJTSU9OLCBERUZBVUxUX0VOVFJZX05BTUUgYXMgX0RFRkFVTFRfRU5UUllfTkFNRSwgX2FkZENvbXBvbmVudCwgX2FkZE9yT3ZlcndyaXRlQ29tcG9uZW50LCBfYXBwcywgX2NsZWFyQ29tcG9uZW50cywgX2NvbXBvbmVudHMsIF9nZXRQcm92aWRlciwgX3JlZ2lzdGVyQ29tcG9uZW50LCBfcmVtb3ZlU2VydmljZUluc3RhbmNlLCBkZWxldGVBcHAsIGdldEFwcCwgZ2V0QXBwcywgaW5pdGlhbGl6ZUFwcCwgb25Mb2csIHJlZ2lzdGVyVmVyc2lvbiwgc2V0TG9nTGV2ZWwgfTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbTIwMTcuanMubWFwXG4iLCJpbXBvcnQgeyByZWdpc3RlclZlcnNpb24gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmV4cG9ydCAqIGZyb20gJ0BmaXJlYmFzZS9hcHAnO1xuXG52YXIgbmFtZSA9IFwiZmlyZWJhc2VcIjtcbnZhciB2ZXJzaW9uID0gXCI5LjIxLjBcIjtcblxuLyoqXHJcbiAqIEBsaWNlbnNlXHJcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxucmVnaXN0ZXJWZXJzaW9uKG5hbWUsIHZlcnNpb24sICdhcHAnKTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4LmVzbS5qcy5tYXBcbiIsImNvbnN0IGZpcmViYXNlQ29uZmlnID0ge1xyXG4gICAgYXBpS2V5OiBcIkFJemFTeURBdE1xMndDb1ZqTFR4OFAzM3lmdGMtSEtrV041X29TTVwiLFxyXG4gICAgYXV0aERvbWFpbjogXCJ0b2RvbGlzdC0xNTIzOS5maXJlYmFzZWFwcC5jb21cIixcclxuICAgIHByb2plY3RJZDogXCJ0b2RvbGlzdC0xNTIzOVwiLFxyXG4gICAgc3RvcmFnZUJ1Y2tldDogXCJ0b2RvbGlzdC0xNTIzOS5hcHBzcG90LmNvbVwiLFxyXG4gICAgbWVzc2FnaW5nU2VuZGVySWQ6IFwiOTkyMzgzNTI4MTc2XCIsXHJcbiAgICBhcHBJZDogXCIxOjk5MjM4MzUyODE3Njp3ZWI6MWMwZjVlZjk1YTdjMmU4NGZhZTYzNVwiXHJcbiAgfTtcclxuICBcclxuICBleHBvcnQgZGVmYXVsdCBmaXJlYmFzZUNvbmZpZztcclxuICAiLCJ2YXIgY29tbW9uanNHbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbCA6IHR5cGVvZiBzZWxmICE9PSAndW5kZWZpbmVkJyA/IHNlbGYgOiB7fTtcblxudmFyIGVzbSA9IHt9O1xuXG4vKlxuXG4gQ29weXJpZ2h0IFRoZSBDbG9zdXJlIExpYnJhcnkgQXV0aG9ycy5cbiBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogQXBhY2hlLTIuMFxuKi9cblxudmFyIGssZ29vZz1nb29nfHx7fSxsPWNvbW1vbmpzR2xvYmFsfHxzZWxmO2Z1bmN0aW9uIGFhKCl7fWZ1bmN0aW9uIGJhKGEpe3ZhciBiPXR5cGVvZiBhO2I9XCJvYmplY3RcIiE9Yj9iOmE/QXJyYXkuaXNBcnJheShhKT9cImFycmF5XCI6YjpcIm51bGxcIjtyZXR1cm4gXCJhcnJheVwiPT1ifHxcIm9iamVjdFwiPT1iJiZcIm51bWJlclwiPT10eXBlb2YgYS5sZW5ndGh9ZnVuY3Rpb24gcChhKXt2YXIgYj10eXBlb2YgYTtyZXR1cm4gXCJvYmplY3RcIj09YiYmbnVsbCE9YXx8XCJmdW5jdGlvblwiPT1ifWZ1bmN0aW9uIGNhKGEpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxkYSkmJmFbZGFdfHwoYVtkYV09KytlYSl9dmFyIGRhPVwiY2xvc3VyZV91aWRfXCIrKDFFOSpNYXRoLnJhbmRvbSgpPj4+MCksZWE9MDtmdW5jdGlvbiBmYShhLGIsYyl7cmV0dXJuIGEuY2FsbC5hcHBseShhLmJpbmQsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIGhhKGEsYixjKXtpZighYSl0aHJvdyBFcnJvcigpO2lmKDI8YXJndW1lbnRzLmxlbmd0aCl7dmFyIGQ9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDIpO3JldHVybiBmdW5jdGlvbigpe3ZhciBlPUFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7QXJyYXkucHJvdG90eXBlLnVuc2hpZnQuYXBwbHkoZSxkKTtyZXR1cm4gYS5hcHBseShiLGUpfX1yZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYS5hcHBseShiLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIHEoYSxiLGMpe0Z1bmN0aW9uLnByb3RvdHlwZS5iaW5kJiYtMSE9RnVuY3Rpb24ucHJvdG90eXBlLmJpbmQudG9TdHJpbmcoKS5pbmRleE9mKFwibmF0aXZlIGNvZGVcIik/cT1mYTpxPWhhO3JldHVybiBxLmFwcGx5KG51bGwsYXJndW1lbnRzKX1cbmZ1bmN0aW9uIGphKGEsYil7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLDEpO3JldHVybiBmdW5jdGlvbigpe3ZhciBkPWMuc2xpY2UoKTtkLnB1c2guYXBwbHkoZCxhcmd1bWVudHMpO3JldHVybiBhLmFwcGx5KHRoaXMsZCl9fWZ1bmN0aW9uIHIoYSxiKXtmdW5jdGlvbiBjKCl7fWMucHJvdG90eXBlPWIucHJvdG90eXBlO2EuJD1iLnByb3RvdHlwZTthLnByb3RvdHlwZT1uZXcgYzthLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcj1hO2EuYWM9ZnVuY3Rpb24oZCxlLGYpe2Zvcih2YXIgaD1BcnJheShhcmd1bWVudHMubGVuZ3RoLTIpLG09MjttPGFyZ3VtZW50cy5sZW5ndGg7bSsrKWhbbS0yXT1hcmd1bWVudHNbbV07cmV0dXJuIGIucHJvdG90eXBlW2VdLmFwcGx5KGQsaCl9O31mdW5jdGlvbiB2KCl7dGhpcy5zPXRoaXMuczt0aGlzLm89dGhpcy5vO312YXIga2E9MDt2LnByb3RvdHlwZS5zPSExO3YucHJvdG90eXBlLnJhPWZ1bmN0aW9uKCl7aWYoIXRoaXMucyYmKHRoaXMucz0hMCx0aGlzLk4oKSwwIT1rYSkpe2NhKHRoaXMpO319O3YucHJvdG90eXBlLk49ZnVuY3Rpb24oKXtpZih0aGlzLm8pZm9yKDt0aGlzLm8ubGVuZ3RoOyl0aGlzLm8uc2hpZnQoKSgpO307Y29uc3QgbWE9QXJyYXkucHJvdG90eXBlLmluZGV4T2Y/ZnVuY3Rpb24oYSxiKXtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmluZGV4T2YuY2FsbChhLGIsdm9pZCAwKX06ZnVuY3Rpb24oYSxiKXtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpcmV0dXJuIFwic3RyaW5nXCIhPT10eXBlb2YgYnx8MSE9Yi5sZW5ndGg/LTE6YS5pbmRleE9mKGIsMCk7Zm9yKGxldCBjPTA7YzxhLmxlbmd0aDtjKyspaWYoYyBpbiBhJiZhW2NdPT09YilyZXR1cm4gYztyZXR1cm4gLTF9O2Z1bmN0aW9uIG5hKGEpe2NvbnN0IGI9YS5sZW5ndGg7aWYoMDxiKXtjb25zdCBjPUFycmF5KGIpO2ZvcihsZXQgZD0wO2Q8YjtkKyspY1tkXT1hW2RdO3JldHVybiBjfXJldHVybiBbXX1cbmZ1bmN0aW9uIG9hKGEsYil7Zm9yKGxldCBjPTE7Yzxhcmd1bWVudHMubGVuZ3RoO2MrKyl7Y29uc3QgZD1hcmd1bWVudHNbY107aWYoYmEoZCkpe2NvbnN0IGU9YS5sZW5ndGh8fDAsZj1kLmxlbmd0aHx8MDthLmxlbmd0aD1lK2Y7Zm9yKGxldCBoPTA7aDxmO2grKylhW2UraF09ZFtoXTt9ZWxzZSBhLnB1c2goZCk7fX1mdW5jdGlvbiB3KGEsYil7dGhpcy50eXBlPWE7dGhpcy5nPXRoaXMudGFyZ2V0PWI7dGhpcy5kZWZhdWx0UHJldmVudGVkPSExO313LnByb3RvdHlwZS5oPWZ1bmN0aW9uKCl7dGhpcy5kZWZhdWx0UHJldmVudGVkPSEwO307dmFyIHBhPWZ1bmN0aW9uKCl7aWYoIWwuYWRkRXZlbnRMaXN0ZW5lcnx8IU9iamVjdC5kZWZpbmVQcm9wZXJ0eSlyZXR1cm4gITE7dmFyIGE9ITEsYj1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJwYXNzaXZlXCIse2dldDpmdW5jdGlvbigpe2E9ITA7fX0pO3RyeXtsLmFkZEV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsYWEsYiksbC5yZW1vdmVFdmVudExpc3RlbmVyKFwidGVzdFwiLGFhLGIpO31jYXRjaChjKXt9cmV0dXJuIGF9KCk7ZnVuY3Rpb24gcWEoYSl7cmV0dXJuIC9eW1xcc1xceGEwXSokLy50ZXN0KGEpfXZhciByYT1TdHJpbmcucHJvdG90eXBlLnRyaW0/ZnVuY3Rpb24oYSl7cmV0dXJuIGEudHJpbSgpfTpmdW5jdGlvbihhKXtyZXR1cm4gL15bXFxzXFx4YTBdKihbXFxzXFxTXSo/KVtcXHNcXHhhMF0qJC8uZXhlYyhhKVsxXX07ZnVuY3Rpb24gc2EoYSxiKXtyZXR1cm4gYTxiPy0xOmE+Yj8xOjB9ZnVuY3Rpb24gdGEoKXt2YXIgYT1sLm5hdmlnYXRvcjtyZXR1cm4gYSYmKGE9YS51c2VyQWdlbnQpP2E6XCJcIn1mdW5jdGlvbiB4KGEpe3JldHVybiAtMSE9dGEoKS5pbmRleE9mKGEpfWZ1bmN0aW9uIHVhKGEpe3VhW1wiIFwiXShhKTtyZXR1cm4gYX11YVtcIiBcIl09YWE7ZnVuY3Rpb24gdmEoYSxiLGMpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYSxiKT9hW2JdOmFbYl09YyhiKX12YXIgd2E9eChcIk9wZXJhXCIpLHk9eChcIlRyaWRlbnRcIil8fHgoXCJNU0lFXCIpLHhhPXgoXCJFZGdlXCIpLHlhPXhhfHx5LHphPXgoXCJHZWNrb1wiKSYmISgtMSE9dGEoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJ3ZWJraXRcIikmJiF4KFwiRWRnZVwiKSkmJiEoeChcIlRyaWRlbnRcIil8fHgoXCJNU0lFXCIpKSYmIXgoXCJFZGdlXCIpLEFhPS0xIT10YSgpLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcIndlYmtpdFwiKSYmIXgoXCJFZGdlXCIpO2Z1bmN0aW9uIEJhKCl7dmFyIGE9bC5kb2N1bWVudDtyZXR1cm4gYT9hLmRvY3VtZW50TW9kZTp2b2lkIDB9dmFyIENhO1xuYTp7dmFyIERhPVwiXCIsRWE9ZnVuY3Rpb24oKXt2YXIgYT10YSgpO2lmKHphKXJldHVybiAvcnY6KFteXFwpO10rKShcXCl8OykvLmV4ZWMoYSk7aWYoeGEpcmV0dXJuIC9FZGdlXFwvKFtcXGRcXC5dKykvLmV4ZWMoYSk7aWYoeSlyZXR1cm4gL1xcYig/Ok1TSUV8cnYpWzogXShbXlxcKTtdKykoXFwpfDspLy5leGVjKGEpO2lmKEFhKXJldHVybiAvV2ViS2l0XFwvKFxcUyspLy5leGVjKGEpO2lmKHdhKXJldHVybiAvKD86VmVyc2lvbilbIFxcL10/KFxcUyspLy5leGVjKGEpfSgpO0VhJiYoRGE9RWE/RWFbMV06XCJcIik7aWYoeSl7dmFyIEZhPUJhKCk7aWYobnVsbCE9RmEmJkZhPnBhcnNlRmxvYXQoRGEpKXtDYT1TdHJpbmcoRmEpO2JyZWFrIGF9fUNhPURhO312YXIgR2E9e307XG5mdW5jdGlvbiBIYSgpe3JldHVybiB2YShHYSw5LGZ1bmN0aW9uKCl7bGV0IGE9MDtjb25zdCBiPXJhKFN0cmluZyhDYSkpLnNwbGl0KFwiLlwiKSxjPXJhKFwiOVwiKS5zcGxpdChcIi5cIiksZD1NYXRoLm1heChiLmxlbmd0aCxjLmxlbmd0aCk7Zm9yKGxldCBoPTA7MD09YSYmaDxkO2grKyl7dmFyIGU9YltoXXx8XCJcIixmPWNbaF18fFwiXCI7ZG97ZT0vKFxcZCopKFxcRCopKC4qKS8uZXhlYyhlKXx8W1wiXCIsXCJcIixcIlwiLFwiXCJdO2Y9LyhcXGQqKShcXEQqKSguKikvLmV4ZWMoZil8fFtcIlwiLFwiXCIsXCJcIixcIlwiXTtpZigwPT1lWzBdLmxlbmd0aCYmMD09ZlswXS5sZW5ndGgpYnJlYWs7YT1zYSgwPT1lWzFdLmxlbmd0aD8wOnBhcnNlSW50KGVbMV0sMTApLDA9PWZbMV0ubGVuZ3RoPzA6cGFyc2VJbnQoZlsxXSwxMCkpfHxzYSgwPT1lWzJdLmxlbmd0aCwwPT1mWzJdLmxlbmd0aCl8fHNhKGVbMl0sZlsyXSk7ZT1lWzNdO2Y9ZlszXTt9d2hpbGUoMD09YSl9cmV0dXJuIDA8PWF9KX12YXIgSWE7XG5pZihsLmRvY3VtZW50JiZ5KXt2YXIgSmE9QmEoKTtJYT1KYT9KYTpwYXJzZUludChDYSwxMCl8fHZvaWQgMDt9ZWxzZSBJYT12b2lkIDA7dmFyIEthPUlhO2Z1bmN0aW9uIHooYSxiKXt3LmNhbGwodGhpcyxhP2EudHlwZTpcIlwiKTt0aGlzLnJlbGF0ZWRUYXJnZXQ9dGhpcy5nPXRoaXMudGFyZ2V0PW51bGw7dGhpcy5idXR0b249dGhpcy5zY3JlZW5ZPXRoaXMuc2NyZWVuWD10aGlzLmNsaWVudFk9dGhpcy5jbGllbnRYPTA7dGhpcy5rZXk9XCJcIjt0aGlzLm1ldGFLZXk9dGhpcy5zaGlmdEtleT10aGlzLmFsdEtleT10aGlzLmN0cmxLZXk9ITE7dGhpcy5zdGF0ZT1udWxsO3RoaXMucG9pbnRlcklkPTA7dGhpcy5wb2ludGVyVHlwZT1cIlwiO3RoaXMuaT1udWxsO2lmKGEpe3ZhciBjPXRoaXMudHlwZT1hLnR5cGUsZD1hLmNoYW5nZWRUb3VjaGVzJiZhLmNoYW5nZWRUb3VjaGVzLmxlbmd0aD9hLmNoYW5nZWRUb3VjaGVzWzBdOm51bGw7dGhpcy50YXJnZXQ9YS50YXJnZXR8fGEuc3JjRWxlbWVudDt0aGlzLmc9YjtpZihiPWEucmVsYXRlZFRhcmdldCl7aWYoemEpe2E6e3RyeXt1YShiLm5vZGVOYW1lKTt2YXIgZT0hMDticmVhayBhfWNhdGNoKGYpe31lPVxuITE7fWV8fChiPW51bGwpO319ZWxzZSBcIm1vdXNlb3ZlclwiPT1jP2I9YS5mcm9tRWxlbWVudDpcIm1vdXNlb3V0XCI9PWMmJihiPWEudG9FbGVtZW50KTt0aGlzLnJlbGF0ZWRUYXJnZXQ9YjtkPyh0aGlzLmNsaWVudFg9dm9pZCAwIT09ZC5jbGllbnRYP2QuY2xpZW50WDpkLnBhZ2VYLHRoaXMuY2xpZW50WT12b2lkIDAhPT1kLmNsaWVudFk/ZC5jbGllbnRZOmQucGFnZVksdGhpcy5zY3JlZW5YPWQuc2NyZWVuWHx8MCx0aGlzLnNjcmVlblk9ZC5zY3JlZW5ZfHwwKToodGhpcy5jbGllbnRYPXZvaWQgMCE9PWEuY2xpZW50WD9hLmNsaWVudFg6YS5wYWdlWCx0aGlzLmNsaWVudFk9dm9pZCAwIT09YS5jbGllbnRZP2EuY2xpZW50WTphLnBhZ2VZLHRoaXMuc2NyZWVuWD1hLnNjcmVlblh8fDAsdGhpcy5zY3JlZW5ZPWEuc2NyZWVuWXx8MCk7dGhpcy5idXR0b249YS5idXR0b247dGhpcy5rZXk9YS5rZXl8fFwiXCI7dGhpcy5jdHJsS2V5PWEuY3RybEtleTt0aGlzLmFsdEtleT1hLmFsdEtleTt0aGlzLnNoaWZ0S2V5PVxuYS5zaGlmdEtleTt0aGlzLm1ldGFLZXk9YS5tZXRhS2V5O3RoaXMucG9pbnRlcklkPWEucG9pbnRlcklkfHwwO3RoaXMucG9pbnRlclR5cGU9XCJzdHJpbmdcIj09PXR5cGVvZiBhLnBvaW50ZXJUeXBlP2EucG9pbnRlclR5cGU6TmFbYS5wb2ludGVyVHlwZV18fFwiXCI7dGhpcy5zdGF0ZT1hLnN0YXRlO3RoaXMuaT1hO2EuZGVmYXVsdFByZXZlbnRlZCYmei4kLmguY2FsbCh0aGlzKTt9fXIoeix3KTt2YXIgTmE9ezI6XCJ0b3VjaFwiLDM6XCJwZW5cIiw0OlwibW91c2VcIn07ei5wcm90b3R5cGUuaD1mdW5jdGlvbigpe3ouJC5oLmNhbGwodGhpcyk7dmFyIGE9dGhpcy5pO2EucHJldmVudERlZmF1bHQ/YS5wcmV2ZW50RGVmYXVsdCgpOmEucmV0dXJuVmFsdWU9ITE7fTt2YXIgQT1cImNsb3N1cmVfbGlzdGVuYWJsZV9cIisoMUU2Kk1hdGgucmFuZG9tKCl8MCk7dmFyIE9hPTA7ZnVuY3Rpb24gUGEoYSxiLGMsZCxlKXt0aGlzLmxpc3RlbmVyPWE7dGhpcy5wcm94eT1udWxsO3RoaXMuc3JjPWI7dGhpcy50eXBlPWM7dGhpcy5jYXB0dXJlPSEhZDt0aGlzLmxhPWU7dGhpcy5rZXk9KytPYTt0aGlzLmZhPXRoaXMuaWE9ITE7fWZ1bmN0aW9uIFFhKGEpe2EuZmE9ITA7YS5saXN0ZW5lcj1udWxsO2EucHJveHk9bnVsbDthLnNyYz1udWxsO2EubGE9bnVsbDt9ZnVuY3Rpb24gUmEoYSxiLGMpe2Zvcihjb25zdCBkIGluIGEpYi5jYWxsKGMsYVtkXSxkLGEpO31mdW5jdGlvbiBTYShhKXtjb25zdCBiPXt9O2Zvcihjb25zdCBjIGluIGEpYltjXT1hW2NdO3JldHVybiBifWNvbnN0IFRhPVwiY29uc3RydWN0b3IgaGFzT3duUHJvcGVydHkgaXNQcm90b3R5cGVPZiBwcm9wZXJ0eUlzRW51bWVyYWJsZSB0b0xvY2FsZVN0cmluZyB0b1N0cmluZyB2YWx1ZU9mXCIuc3BsaXQoXCIgXCIpO2Z1bmN0aW9uIFVhKGEsYil7bGV0IGMsZDtmb3IobGV0IGU9MTtlPGFyZ3VtZW50cy5sZW5ndGg7ZSsrKXtkPWFyZ3VtZW50c1tlXTtmb3IoYyBpbiBkKWFbY109ZFtjXTtmb3IobGV0IGY9MDtmPFRhLmxlbmd0aDtmKyspYz1UYVtmXSxPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoZCxjKSYmKGFbY109ZFtjXSk7fX1mdW5jdGlvbiBWYShhKXt0aGlzLnNyYz1hO3RoaXMuZz17fTt0aGlzLmg9MDt9VmEucHJvdG90eXBlLmFkZD1mdW5jdGlvbihhLGIsYyxkLGUpe3ZhciBmPWEudG9TdHJpbmcoKTthPXRoaXMuZ1tmXTthfHwoYT10aGlzLmdbZl09W10sdGhpcy5oKyspO3ZhciBoPVdhKGEsYixkLGUpOy0xPGg/KGI9YVtoXSxjfHwoYi5pYT0hMSkpOihiPW5ldyBQYShiLHRoaXMuc3JjLGYsISFkLGUpLGIuaWE9YyxhLnB1c2goYikpO3JldHVybiBifTtmdW5jdGlvbiBYYShhLGIpe3ZhciBjPWIudHlwZTtpZihjIGluIGEuZyl7dmFyIGQ9YS5nW2NdLGU9bWEoZCxiKSxmOyhmPTA8PWUpJiZBcnJheS5wcm90b3R5cGUuc3BsaWNlLmNhbGwoZCxlLDEpO2YmJihRYShiKSwwPT1hLmdbY10ubGVuZ3RoJiYoZGVsZXRlIGEuZ1tjXSxhLmgtLSkpO319XG5mdW5jdGlvbiBXYShhLGIsYyxkKXtmb3IodmFyIGU9MDtlPGEubGVuZ3RoOysrZSl7dmFyIGY9YVtlXTtpZighZi5mYSYmZi5saXN0ZW5lcj09YiYmZi5jYXB0dXJlPT0hIWMmJmYubGE9PWQpcmV0dXJuIGV9cmV0dXJuIC0xfXZhciBZYT1cImNsb3N1cmVfbG1fXCIrKDFFNipNYXRoLnJhbmRvbSgpfDApLFphPXt9O2Z1bmN0aW9uIGFiKGEsYixjLGQsZSl7aWYoZCYmZC5vbmNlKXJldHVybiBiYihhLGIsYyxkLGUpO2lmKEFycmF5LmlzQXJyYXkoYikpe2Zvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKWFiKGEsYltmXSxjLGQsZSk7cmV0dXJuIG51bGx9Yz1jYihjKTtyZXR1cm4gYSYmYVtBXT9hLk8oYixjLHAoZCk/ISFkLmNhcHR1cmU6ISFkLGUpOmRiKGEsYixjLCExLGQsZSl9XG5mdW5jdGlvbiBkYihhLGIsYyxkLGUsZil7aWYoIWIpdGhyb3cgRXJyb3IoXCJJbnZhbGlkIGV2ZW50IHR5cGVcIik7dmFyIGg9cChlKT8hIWUuY2FwdHVyZTohIWUsbT1lYihhKTttfHwoYVtZYV09bT1uZXcgVmEoYSkpO2M9bS5hZGQoYixjLGQsaCxmKTtpZihjLnByb3h5KXJldHVybiBjO2Q9ZmIoKTtjLnByb3h5PWQ7ZC5zcmM9YTtkLmxpc3RlbmVyPWM7aWYoYS5hZGRFdmVudExpc3RlbmVyKXBhfHwoZT1oKSx2b2lkIDA9PT1lJiYoZT0hMSksYS5hZGRFdmVudExpc3RlbmVyKGIudG9TdHJpbmcoKSxkLGUpO2Vsc2UgaWYoYS5hdHRhY2hFdmVudClhLmF0dGFjaEV2ZW50KGdiKGIudG9TdHJpbmcoKSksZCk7ZWxzZSBpZihhLmFkZExpc3RlbmVyJiZhLnJlbW92ZUxpc3RlbmVyKWEuYWRkTGlzdGVuZXIoZCk7ZWxzZSB0aHJvdyBFcnJvcihcImFkZEV2ZW50TGlzdGVuZXIgYW5kIGF0dGFjaEV2ZW50IGFyZSB1bmF2YWlsYWJsZS5cIik7cmV0dXJuIGN9XG5mdW5jdGlvbiBmYigpe2Z1bmN0aW9uIGEoYyl7cmV0dXJuIGIuY2FsbChhLnNyYyxhLmxpc3RlbmVyLGMpfWNvbnN0IGI9aGI7cmV0dXJuIGF9ZnVuY3Rpb24gYmIoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKXtmb3IodmFyIGY9MDtmPGIubGVuZ3RoO2YrKyliYihhLGJbZl0sYyxkLGUpO3JldHVybiBudWxsfWM9Y2IoYyk7cmV0dXJuIGEmJmFbQV0/YS5QKGIsYyxwKGQpPyEhZC5jYXB0dXJlOiEhZCxlKTpkYihhLGIsYywhMCxkLGUpfVxuZnVuY3Rpb24gaWIoYSxiLGMsZCxlKXtpZihBcnJheS5pc0FycmF5KGIpKWZvcih2YXIgZj0wO2Y8Yi5sZW5ndGg7ZisrKWliKGEsYltmXSxjLGQsZSk7ZWxzZSAoZD1wKGQpPyEhZC5jYXB0dXJlOiEhZCxjPWNiKGMpLGEmJmFbQV0pPyhhPWEuaSxiPVN0cmluZyhiKS50b1N0cmluZygpLGIgaW4gYS5nJiYoZj1hLmdbYl0sYz1XYShmLGMsZCxlKSwtMTxjJiYoUWEoZltjXSksQXJyYXkucHJvdG90eXBlLnNwbGljZS5jYWxsKGYsYywxKSwwPT1mLmxlbmd0aCYmKGRlbGV0ZSBhLmdbYl0sYS5oLS0pKSkpOmEmJihhPWViKGEpKSYmKGI9YS5nW2IudG9TdHJpbmcoKV0sYT0tMSxiJiYoYT1XYShiLGMsZCxlKSksKGM9LTE8YT9iW2FdOm51bGwpJiZqYihjKSk7fVxuZnVuY3Rpb24gamIoYSl7aWYoXCJudW1iZXJcIiE9PXR5cGVvZiBhJiZhJiYhYS5mYSl7dmFyIGI9YS5zcmM7aWYoYiYmYltBXSlYYShiLmksYSk7ZWxzZSB7dmFyIGM9YS50eXBlLGQ9YS5wcm94eTtiLnJlbW92ZUV2ZW50TGlzdGVuZXI/Yi5yZW1vdmVFdmVudExpc3RlbmVyKGMsZCxhLmNhcHR1cmUpOmIuZGV0YWNoRXZlbnQ/Yi5kZXRhY2hFdmVudChnYihjKSxkKTpiLmFkZExpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyJiZiLnJlbW92ZUxpc3RlbmVyKGQpOyhjPWViKGIpKT8oWGEoYyxhKSwwPT1jLmgmJihjLnNyYz1udWxsLGJbWWFdPW51bGwpKTpRYShhKTt9fX1mdW5jdGlvbiBnYihhKXtyZXR1cm4gYSBpbiBaYT9aYVthXTpaYVthXT1cIm9uXCIrYX1mdW5jdGlvbiBoYihhLGIpe2lmKGEuZmEpYT0hMDtlbHNlIHtiPW5ldyB6KGIsdGhpcyk7dmFyIGM9YS5saXN0ZW5lcixkPWEubGF8fGEuc3JjO2EuaWEmJmpiKGEpO2E9Yy5jYWxsKGQsYik7fXJldHVybiBhfVxuZnVuY3Rpb24gZWIoYSl7YT1hW1lhXTtyZXR1cm4gYSBpbnN0YW5jZW9mIFZhP2E6bnVsbH12YXIga2I9XCJfX2Nsb3N1cmVfZXZlbnRzX2ZuX1wiKygxRTkqTWF0aC5yYW5kb20oKT4+PjApO2Z1bmN0aW9uIGNiKGEpe2lmKFwiZnVuY3Rpb25cIj09PXR5cGVvZiBhKXJldHVybiBhO2Fba2JdfHwoYVtrYl09ZnVuY3Rpb24oYil7cmV0dXJuIGEuaGFuZGxlRXZlbnQoYil9KTtyZXR1cm4gYVtrYl19ZnVuY3Rpb24gQigpe3YuY2FsbCh0aGlzKTt0aGlzLmk9bmV3IFZhKHRoaXMpO3RoaXMuUz10aGlzO3RoaXMuSj1udWxsO31yKEIsdik7Qi5wcm90b3R5cGVbQV09ITA7Qi5wcm90b3R5cGUucmVtb3ZlRXZlbnRMaXN0ZW5lcj1mdW5jdGlvbihhLGIsYyxkKXtpYih0aGlzLGEsYixjLGQpO307XG5mdW5jdGlvbiBDKGEsYil7dmFyIGMsZD1hLko7aWYoZClmb3IoYz1bXTtkO2Q9ZC5KKWMucHVzaChkKTthPWEuUztkPWIudHlwZXx8YjtpZihcInN0cmluZ1wiPT09dHlwZW9mIGIpYj1uZXcgdyhiLGEpO2Vsc2UgaWYoYiBpbnN0YW5jZW9mIHcpYi50YXJnZXQ9Yi50YXJnZXR8fGE7ZWxzZSB7dmFyIGU9YjtiPW5ldyB3KGQsYSk7VWEoYixlKTt9ZT0hMDtpZihjKWZvcih2YXIgZj1jLmxlbmd0aC0xOzA8PWY7Zi0tKXt2YXIgaD1iLmc9Y1tmXTtlPWxiKGgsZCwhMCxiKSYmZTt9aD1iLmc9YTtlPWxiKGgsZCwhMCxiKSYmZTtlPWxiKGgsZCwhMSxiKSYmZTtpZihjKWZvcihmPTA7ZjxjLmxlbmd0aDtmKyspaD1iLmc9Y1tmXSxlPWxiKGgsZCwhMSxiKSYmZTt9XG5CLnByb3RvdHlwZS5OPWZ1bmN0aW9uKCl7Qi4kLk4uY2FsbCh0aGlzKTtpZih0aGlzLmkpe3ZhciBhPXRoaXMuaSxjO2ZvcihjIGluIGEuZyl7Zm9yKHZhciBkPWEuZ1tjXSxlPTA7ZTxkLmxlbmd0aDtlKyspUWEoZFtlXSk7ZGVsZXRlIGEuZ1tjXTthLmgtLTt9fXRoaXMuSj1udWxsO307Qi5wcm90b3R5cGUuTz1mdW5jdGlvbihhLGIsYyxkKXtyZXR1cm4gdGhpcy5pLmFkZChTdHJpbmcoYSksYiwhMSxjLGQpfTtCLnByb3RvdHlwZS5QPWZ1bmN0aW9uKGEsYixjLGQpe3JldHVybiB0aGlzLmkuYWRkKFN0cmluZyhhKSxiLCEwLGMsZCl9O1xuZnVuY3Rpb24gbGIoYSxiLGMsZCl7Yj1hLmkuZ1tTdHJpbmcoYildO2lmKCFiKXJldHVybiAhMDtiPWIuY29uY2F0KCk7Zm9yKHZhciBlPSEwLGY9MDtmPGIubGVuZ3RoOysrZil7dmFyIGg9YltmXTtpZihoJiYhaC5mYSYmaC5jYXB0dXJlPT1jKXt2YXIgbT1oLmxpc3RlbmVyLHQ9aC5sYXx8aC5zcmM7aC5pYSYmWGEoYS5pLGgpO2U9ITEhPT1tLmNhbGwodCxkKSYmZTt9fXJldHVybiBlJiYhZC5kZWZhdWx0UHJldmVudGVkfXZhciBtYj1sLkpTT04uc3RyaW5naWZ5O2Z1bmN0aW9uIG5iKCl7dmFyIGE9b2I7bGV0IGI9bnVsbDthLmcmJihiPWEuZyxhLmc9YS5nLm5leHQsYS5nfHwoYS5oPW51bGwpLGIubmV4dD1udWxsKTtyZXR1cm4gYn1jbGFzcyBwYntjb25zdHJ1Y3Rvcigpe3RoaXMuaD10aGlzLmc9bnVsbDt9YWRkKGEsYil7Y29uc3QgYz1xYi5nZXQoKTtjLnNldChhLGIpO3RoaXMuaD90aGlzLmgubmV4dD1jOnRoaXMuZz1jO3RoaXMuaD1jO319dmFyIHFiPW5ldyBjbGFzc3tjb25zdHJ1Y3RvcihhLGIpe3RoaXMuaT1hO3RoaXMuaj1iO3RoaXMuaD0wO3RoaXMuZz1udWxsO31nZXQoKXtsZXQgYTswPHRoaXMuaD8odGhpcy5oLS0sYT10aGlzLmcsdGhpcy5nPWEubmV4dCxhLm5leHQ9bnVsbCk6YT10aGlzLmkoKTtyZXR1cm4gYX19KCgpPT5uZXcgcmIsYT0+YS5yZXNldCgpKTtcbmNsYXNzIHJie2NvbnN0cnVjdG9yKCl7dGhpcy5uZXh0PXRoaXMuZz10aGlzLmg9bnVsbDt9c2V0KGEsYil7dGhpcy5oPWE7dGhpcy5nPWI7dGhpcy5uZXh0PW51bGw7fXJlc2V0KCl7dGhpcy5uZXh0PXRoaXMuZz10aGlzLmg9bnVsbDt9fWZ1bmN0aW9uIHNiKGEpe2wuc2V0VGltZW91dCgoKT0+e3Rocm93IGE7fSwwKTt9ZnVuY3Rpb24gdGIoYSxiKXt1Ynx8dmIoKTt3Ynx8KHViKCksd2I9ITApO29iLmFkZChhLGIpO312YXIgdWI7ZnVuY3Rpb24gdmIoKXt2YXIgYT1sLlByb21pc2UucmVzb2x2ZSh2b2lkIDApO3ViPWZ1bmN0aW9uKCl7YS50aGVuKHhiKTt9O312YXIgd2I9ITEsb2I9bmV3IHBiO2Z1bmN0aW9uIHhiKCl7Zm9yKHZhciBhO2E9bmIoKTspe3RyeXthLmguY2FsbChhLmcpO31jYXRjaChjKXtzYihjKTt9dmFyIGI9cWI7Yi5qKGEpOzEwMD5iLmgmJihiLmgrKyxhLm5leHQ9Yi5nLGIuZz1hKTt9d2I9ITE7fWZ1bmN0aW9uIHliKGEsYil7Qi5jYWxsKHRoaXMpO3RoaXMuaD1hfHwxO3RoaXMuZz1ifHxsO3RoaXMuaj1xKHRoaXMucWIsdGhpcyk7dGhpcy5sPURhdGUubm93KCk7fXIoeWIsQik7az15Yi5wcm90b3R5cGU7ay5nYT0hMTtrLlQ9bnVsbDtrLnFiPWZ1bmN0aW9uKCl7aWYodGhpcy5nYSl7dmFyIGE9RGF0ZS5ub3coKS10aGlzLmw7MDxhJiZhPC44KnRoaXMuaD90aGlzLlQ9dGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLHRoaXMuaC1hKToodGhpcy5UJiYodGhpcy5nLmNsZWFyVGltZW91dCh0aGlzLlQpLHRoaXMuVD1udWxsKSxDKHRoaXMsXCJ0aWNrXCIpLHRoaXMuZ2EmJih6Yih0aGlzKSx0aGlzLnN0YXJ0KCkpKTt9fTtrLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5nYT0hMDt0aGlzLlR8fCh0aGlzLlQ9dGhpcy5nLnNldFRpbWVvdXQodGhpcy5qLHRoaXMuaCksdGhpcy5sPURhdGUubm93KCkpO307XG5mdW5jdGlvbiB6YihhKXthLmdhPSExO2EuVCYmKGEuZy5jbGVhclRpbWVvdXQoYS5UKSxhLlQ9bnVsbCk7fWsuTj1mdW5jdGlvbigpe3liLiQuTi5jYWxsKHRoaXMpO3piKHRoaXMpO2RlbGV0ZSB0aGlzLmc7fTtmdW5jdGlvbiBBYihhLGIsYyl7aWYoXCJmdW5jdGlvblwiPT09dHlwZW9mIGEpYyYmKGE9cShhLGMpKTtlbHNlIGlmKGEmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuaGFuZGxlRXZlbnQpYT1xKGEuaGFuZGxlRXZlbnQsYSk7ZWxzZSB0aHJvdyBFcnJvcihcIkludmFsaWQgbGlzdGVuZXIgYXJndW1lbnRcIik7cmV0dXJuIDIxNDc0ODM2NDc8TnVtYmVyKGIpPy0xOmwuc2V0VGltZW91dChhLGJ8fDApfWZ1bmN0aW9uIEJiKGEpe2EuZz1BYigoKT0+e2EuZz1udWxsO2EuaSYmKGEuaT0hMSxCYihhKSk7fSxhLmopO2NvbnN0IGI9YS5oO2EuaD1udWxsO2EubS5hcHBseShudWxsLGIpO31jbGFzcyBDYiBleHRlbmRzIHZ7Y29uc3RydWN0b3IoYSxiKXtzdXBlcigpO3RoaXMubT1hO3RoaXMuaj1iO3RoaXMuaD1udWxsO3RoaXMuaT0hMTt0aGlzLmc9bnVsbDt9bChhKXt0aGlzLmg9YXJndW1lbnRzO3RoaXMuZz90aGlzLmk9ITA6QmIodGhpcyk7fU4oKXtzdXBlci5OKCk7dGhpcy5nJiYobC5jbGVhclRpbWVvdXQodGhpcy5nKSx0aGlzLmc9bnVsbCx0aGlzLmk9ITEsdGhpcy5oPW51bGwpO319ZnVuY3Rpb24gRGIoYSl7di5jYWxsKHRoaXMpO3RoaXMuaD1hO3RoaXMuZz17fTt9cihEYix2KTt2YXIgRWI9W107ZnVuY3Rpb24gR2IoYSxiLGMsZCl7QXJyYXkuaXNBcnJheShjKXx8KGMmJihFYlswXT1jLnRvU3RyaW5nKCkpLGM9RWIpO2Zvcih2YXIgZT0wO2U8Yy5sZW5ndGg7ZSsrKXt2YXIgZj1hYihiLGNbZV0sZHx8YS5oYW5kbGVFdmVudCwhMSxhLmh8fGEpO2lmKCFmKWJyZWFrO2EuZ1tmLmtleV09Zjt9fWZ1bmN0aW9uIEhiKGEpe1JhKGEuZyxmdW5jdGlvbihiLGMpe3RoaXMuZy5oYXNPd25Qcm9wZXJ0eShjKSYmamIoYik7fSxhKTthLmc9e307fURiLnByb3RvdHlwZS5OPWZ1bmN0aW9uKCl7RGIuJC5OLmNhbGwodGhpcyk7SGIodGhpcyk7fTtEYi5wcm90b3R5cGUuaGFuZGxlRXZlbnQ9ZnVuY3Rpb24oKXt0aHJvdyBFcnJvcihcIkV2ZW50SGFuZGxlci5oYW5kbGVFdmVudCBub3QgaW1wbGVtZW50ZWRcIik7fTtmdW5jdGlvbiBJYigpe3RoaXMuZz0hMDt9SWIucHJvdG90eXBlLkVhPWZ1bmN0aW9uKCl7dGhpcy5nPSExO307ZnVuY3Rpb24gSmIoYSxiLGMsZCxlLGYpe2EuaW5mbyhmdW5jdGlvbigpe2lmKGEuZylpZihmKXt2YXIgaD1cIlwiO2Zvcih2YXIgbT1mLnNwbGl0KFwiJlwiKSx0PTA7dDxtLmxlbmd0aDt0Kyspe3ZhciBuPW1bdF0uc3BsaXQoXCI9XCIpO2lmKDE8bi5sZW5ndGgpe3ZhciB1PW5bMF07bj1uWzFdO3ZhciBMPXUuc3BsaXQoXCJfXCIpO2g9Mjw9TC5sZW5ndGgmJlwidHlwZVwiPT1MWzFdP2grKHUrXCI9XCIrbitcIiZcIik6aCsodStcIj1yZWRhY3RlZCZcIik7fX19ZWxzZSBoPW51bGw7ZWxzZSBoPWY7cmV0dXJuIFwiWE1MSFRUUCBSRVEgKFwiK2QrXCIpIFthdHRlbXB0IFwiK2UrXCJdOiBcIitiK1wiXFxuXCIrYytcIlxcblwiK2h9KTt9XG5mdW5jdGlvbiBLYihhLGIsYyxkLGUsZixoKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJYTUxIVFRQIFJFU1AgKFwiK2QrXCIpIFsgYXR0ZW1wdCBcIitlK1wiXTogXCIrYitcIlxcblwiK2MrXCJcXG5cIitmK1wiIFwiK2h9KTt9ZnVuY3Rpb24gRChhLGIsYyxkKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJYTUxIVFRQIFRFWFQgKFwiK2IrXCIpOiBcIitMYihhLGMpKyhkP1wiIFwiK2Q6XCJcIil9KTt9ZnVuY3Rpb24gTWIoYSxiKXthLmluZm8oZnVuY3Rpb24oKXtyZXR1cm4gXCJUSU1FT1VUOiBcIitifSk7fUliLnByb3RvdHlwZS5pbmZvPWZ1bmN0aW9uKCl7fTtcbmZ1bmN0aW9uIExiKGEsYil7aWYoIWEuZylyZXR1cm4gYjtpZighYilyZXR1cm4gbnVsbDt0cnl7dmFyIGM9SlNPTi5wYXJzZShiKTtpZihjKWZvcihhPTA7YTxjLmxlbmd0aDthKyspaWYoQXJyYXkuaXNBcnJheShjW2FdKSl7dmFyIGQ9Y1thXTtpZighKDI+ZC5sZW5ndGgpKXt2YXIgZT1kWzFdO2lmKEFycmF5LmlzQXJyYXkoZSkmJiEoMT5lLmxlbmd0aCkpe3ZhciBmPWVbMF07aWYoXCJub29wXCIhPWYmJlwic3RvcFwiIT1mJiZcImNsb3NlXCIhPWYpZm9yKHZhciBoPTE7aDxlLmxlbmd0aDtoKyspZVtoXT1cIlwiO319fXJldHVybiBtYihjKX1jYXRjaChtKXtyZXR1cm4gYn19dmFyIEU9e30sTmI9bnVsbDtmdW5jdGlvbiBPYigpe3JldHVybiBOYj1OYnx8bmV3IEJ9RS5UYT1cInNlcnZlcnJlYWNoYWJpbGl0eVwiO2Z1bmN0aW9uIFBiKGEpe3cuY2FsbCh0aGlzLEUuVGEsYSk7fXIoUGIsdyk7ZnVuY3Rpb24gUWIoYSl7Y29uc3QgYj1PYigpO0MoYixuZXcgUGIoYikpO31FLlNUQVRfRVZFTlQ9XCJzdGF0ZXZlbnRcIjtmdW5jdGlvbiBSYihhLGIpe3cuY2FsbCh0aGlzLEUuU1RBVF9FVkVOVCxhKTt0aGlzLnN0YXQ9Yjt9cihSYix3KTtmdW5jdGlvbiBGKGEpe2NvbnN0IGI9T2IoKTtDKGIsbmV3IFJiKGIsYSkpO31FLlVhPVwidGltaW5nZXZlbnRcIjtmdW5jdGlvbiBTYihhLGIpe3cuY2FsbCh0aGlzLEUuVWEsYSk7dGhpcy5zaXplPWI7fXIoU2Isdyk7XG5mdW5jdGlvbiBUYihhLGIpe2lmKFwiZnVuY3Rpb25cIiE9PXR5cGVvZiBhKXRocm93IEVycm9yKFwiRm4gbXVzdCBub3QgYmUgbnVsbCBhbmQgbXVzdCBiZSBhIGZ1bmN0aW9uXCIpO3JldHVybiBsLnNldFRpbWVvdXQoZnVuY3Rpb24oKXthKCk7fSxiKX12YXIgVWI9e05PX0VSUk9SOjAscmI6MSxFYjoyLERiOjMseWI6NCxDYjo1LEZiOjYsUWE6NyxUSU1FT1VUOjgsSWI6OX07dmFyIFZiPXt3YjpcImNvbXBsZXRlXCIsU2I6XCJzdWNjZXNzXCIsUmE6XCJlcnJvclwiLFFhOlwiYWJvcnRcIixLYjpcInJlYWR5XCIsTGI6XCJyZWFkeXN0YXRlY2hhbmdlXCIsVElNRU9VVDpcInRpbWVvdXRcIixHYjpcImluY3JlbWVudGFsZGF0YVwiLEpiOlwicHJvZ3Jlc3NcIix6YjpcImRvd25sb2FkcHJvZ3Jlc3NcIiwkYjpcInVwbG9hZHByb2dyZXNzXCJ9O2Z1bmN0aW9uIFdiKCl7fVdiLnByb3RvdHlwZS5oPW51bGw7ZnVuY3Rpb24gWGIoYSl7cmV0dXJuIGEuaHx8KGEuaD1hLmkoKSl9ZnVuY3Rpb24gWWIoKXt9dmFyIFpiPXtPUEVOOlwiYVwiLHZiOlwiYlwiLFJhOlwiY1wiLEhiOlwiZFwifTtmdW5jdGlvbiAkYigpe3cuY2FsbCh0aGlzLFwiZFwiKTt9cigkYix3KTtmdW5jdGlvbiBhYygpe3cuY2FsbCh0aGlzLFwiY1wiKTt9cihhYyx3KTt2YXIgYmM7ZnVuY3Rpb24gY2MoKXt9cihjYyxXYik7Y2MucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0fTtjYy5wcm90b3R5cGUuaT1mdW5jdGlvbigpe3JldHVybiB7fX07YmM9bmV3IGNjO2Z1bmN0aW9uIGRjKGEsYixjLGQpe3RoaXMubD1hO3RoaXMuaj1iO3RoaXMubT1jO3RoaXMuVz1kfHwxO3RoaXMuVT1uZXcgRGIodGhpcyk7dGhpcy5QPWVjO2E9eWE/MTI1OnZvaWQgMDt0aGlzLlY9bmV3IHliKGEpO3RoaXMuST1udWxsO3RoaXMuaT0hMTt0aGlzLnM9dGhpcy5BPXRoaXMudj10aGlzLkw9dGhpcy5HPXRoaXMuWT10aGlzLkI9bnVsbDt0aGlzLkY9W107dGhpcy5nPW51bGw7dGhpcy5DPTA7dGhpcy5vPXRoaXMudT1udWxsO3RoaXMuYWE9LTE7dGhpcy5KPSExO3RoaXMuTz0wO3RoaXMuTT1udWxsO3RoaXMuY2E9dGhpcy5LPXRoaXMuYmE9dGhpcy5TPSExO3RoaXMuaD1uZXcgZmM7fWZ1bmN0aW9uIGZjKCl7dGhpcy5pPW51bGw7dGhpcy5nPVwiXCI7dGhpcy5oPSExO312YXIgZWM9NDVFMyxnYz17fSxoYz17fTtrPWRjLnByb3RvdHlwZTtrLnNldFRpbWVvdXQ9ZnVuY3Rpb24oYSl7dGhpcy5QPWE7fTtcbmZ1bmN0aW9uIGljKGEsYixjKXthLkw9MTthLnY9amMoRyhiKSk7YS5zPWM7YS5TPSEwO2tjKGEsbnVsbCk7fWZ1bmN0aW9uIGtjKGEsYil7YS5HPURhdGUubm93KCk7bGMoYSk7YS5BPUcoYS52KTt2YXIgYz1hLkEsZD1hLlc7QXJyYXkuaXNBcnJheShkKXx8KGQ9W1N0cmluZyhkKV0pO21jKGMuaSxcInRcIixkKTthLkM9MDtjPWEubC5JO2EuaD1uZXcgZmM7YS5nPW5jKGEubCxjP2I6bnVsbCwhYS5zKTswPGEuTyYmKGEuTT1uZXcgQ2IocShhLlBhLGEsYS5nKSxhLk8pKTtHYihhLlUsYS5nLFwicmVhZHlzdGF0ZWNoYW5nZVwiLGEubmIpO2I9YS5JP1NhKGEuSSk6e307YS5zPyhhLnV8fChhLnU9XCJQT1NUXCIpLGJbXCJDb250ZW50LVR5cGVcIl09XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIixhLmcuaGEoYS5BLGEudSxhLnMsYikpOihhLnU9XCJHRVRcIixhLmcuaGEoYS5BLGEudSxudWxsLGIpKTtRYigpO0piKGEuaixhLnUsYS5BLGEubSxhLlcsYS5zKTt9XG5rLm5iPWZ1bmN0aW9uKGEpe2E9YS50YXJnZXQ7Y29uc3QgYj10aGlzLk07YiYmMz09SChhKT9iLmwoKTp0aGlzLlBhKGEpO307XG5rLlBhPWZ1bmN0aW9uKGEpe3RyeXtpZihhPT10aGlzLmcpYTp7Y29uc3QgdT1IKHRoaXMuZyk7dmFyIGI9dGhpcy5nLklhKCk7Y29uc3QgTD10aGlzLmcuZGEoKTtpZighKDM+dSkmJigzIT11fHx5YXx8dGhpcy5nJiYodGhpcy5oLmh8fHRoaXMuZy5qYSgpfHxvYyh0aGlzLmcpKSkpe3RoaXMuSnx8NCE9dXx8Nz09Ynx8KDg9PWJ8fDA+PUw/UWIoMyk6UWIoMikpO3BjKHRoaXMpO3ZhciBjPXRoaXMuZy5kYSgpO3RoaXMuYWE9YztiOmlmKHFjKHRoaXMpKXt2YXIgZD1vYyh0aGlzLmcpO2E9XCJcIjt2YXIgZT1kLmxlbmd0aCxmPTQ9PUgodGhpcy5nKTtpZighdGhpcy5oLmkpe2lmKFwidW5kZWZpbmVkXCI9PT10eXBlb2YgVGV4dERlY29kZXIpe0kodGhpcyk7cmModGhpcyk7dmFyIGg9XCJcIjticmVhayBifXRoaXMuaC5pPW5ldyBsLlRleHREZWNvZGVyO31mb3IoYj0wO2I8ZTtiKyspdGhpcy5oLmg9ITAsYSs9dGhpcy5oLmkuZGVjb2RlKGRbYl0se3N0cmVhbTpmJiZiPT1lLTF9KTtkLnNwbGljZSgwLFxuZSk7dGhpcy5oLmcrPWE7dGhpcy5DPTA7aD10aGlzLmguZzt9ZWxzZSBoPXRoaXMuZy5qYSgpO3RoaXMuaT0yMDA9PWM7S2IodGhpcy5qLHRoaXMudSx0aGlzLkEsdGhpcy5tLHRoaXMuVyx1LGMpO2lmKHRoaXMuaSl7aWYodGhpcy5iYSYmIXRoaXMuSyl7Yjp7aWYodGhpcy5nKXt2YXIgbSx0PXRoaXMuZztpZigobT10Lmc/dC5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLUluaXRpYWwtUmVzcG9uc2VcIik6bnVsbCkmJiFxYShtKSl7dmFyIG49bTticmVhayBifX1uPW51bGw7fWlmKGM9bilEKHRoaXMuaix0aGlzLm0sYyxcIkluaXRpYWwgaGFuZHNoYWtlIHJlc3BvbnNlIHZpYSBYLUhUVFAtSW5pdGlhbC1SZXNwb25zZVwiKSx0aGlzLks9ITAsc2ModGhpcyxjKTtlbHNlIHt0aGlzLmk9ITE7dGhpcy5vPTM7RigxMik7SSh0aGlzKTtyYyh0aGlzKTticmVhayBhfX10aGlzLlM/KHRjKHRoaXMsdSxoKSx5YSYmdGhpcy5pJiYzPT11JiYoR2IodGhpcy5VLHRoaXMuVixcInRpY2tcIix0aGlzLm1iKSxcbnRoaXMuVi5zdGFydCgpKSk6KEQodGhpcy5qLHRoaXMubSxoLG51bGwpLHNjKHRoaXMsaCkpOzQ9PXUmJkkodGhpcyk7dGhpcy5pJiYhdGhpcy5KJiYoND09dT91Yyh0aGlzLmwsdGhpcyk6KHRoaXMuaT0hMSxsYyh0aGlzKSkpO31lbHNlIDQwMD09YyYmMDxoLmluZGV4T2YoXCJVbmtub3duIFNJRFwiKT8odGhpcy5vPTMsRigxMikpOih0aGlzLm89MCxGKDEzKSksSSh0aGlzKSxyYyh0aGlzKTt9fX1jYXRjaCh1KXt9ZmluYWxseXt9fTtmdW5jdGlvbiBxYyhhKXtyZXR1cm4gYS5nP1wiR0VUXCI9PWEudSYmMiE9YS5MJiZhLmwuSGE6ITF9XG5mdW5jdGlvbiB0YyhhLGIsYyl7bGV0IGQ9ITAsZTtmb3IoOyFhLkomJmEuQzxjLmxlbmd0aDspaWYoZT12YyhhLGMpLGU9PWhjKXs0PT1iJiYoYS5vPTQsRigxNCksZD0hMSk7RChhLmosYS5tLG51bGwsXCJbSW5jb21wbGV0ZSBSZXNwb25zZV1cIik7YnJlYWt9ZWxzZSBpZihlPT1nYyl7YS5vPTQ7RigxNSk7RChhLmosYS5tLGMsXCJbSW52YWxpZCBDaHVua11cIik7ZD0hMTticmVha31lbHNlIEQoYS5qLGEubSxlLG51bGwpLHNjKGEsZSk7cWMoYSkmJmUhPWhjJiZlIT1nYyYmKGEuaC5nPVwiXCIsYS5DPTApOzQhPWJ8fDAhPWMubGVuZ3RofHxhLmguaHx8KGEubz0xLEYoMTYpLGQ9ITEpO2EuaT1hLmkmJmQ7ZD8wPGMubGVuZ3RoJiYhYS5jYSYmKGEuY2E9ITAsYj1hLmwsYi5nPT1hJiZiLmNhJiYhYi5MJiYoYi5qLmluZm8oXCJHcmVhdCwgbm8gYnVmZmVyaW5nIHByb3h5IGRldGVjdGVkLiBCeXRlcyByZWNlaXZlZDogXCIrYy5sZW5ndGgpLHdjKGIpLGIuTD0hMCxGKDExKSkpOihEKGEuaixhLm0sXG5jLFwiW0ludmFsaWQgQ2h1bmtlZCBSZXNwb25zZV1cIiksSShhKSxyYyhhKSk7fWsubWI9ZnVuY3Rpb24oKXtpZih0aGlzLmcpe3ZhciBhPUgodGhpcy5nKSxiPXRoaXMuZy5qYSgpO3RoaXMuQzxiLmxlbmd0aCYmKHBjKHRoaXMpLHRjKHRoaXMsYSxiKSx0aGlzLmkmJjQhPWEmJmxjKHRoaXMpKTt9fTtmdW5jdGlvbiB2YyhhLGIpe3ZhciBjPWEuQyxkPWIuaW5kZXhPZihcIlxcblwiLGMpO2lmKC0xPT1kKXJldHVybiBoYztjPU51bWJlcihiLnN1YnN0cmluZyhjLGQpKTtpZihpc05hTihjKSlyZXR1cm4gZ2M7ZCs9MTtpZihkK2M+Yi5sZW5ndGgpcmV0dXJuIGhjO2I9Yi5zdWJzdHIoZCxjKTthLkM9ZCtjO3JldHVybiBifWsuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5KPSEwO0kodGhpcyk7fTtmdW5jdGlvbiBsYyhhKXthLlk9RGF0ZS5ub3coKSthLlA7eGMoYSxhLlApO31cbmZ1bmN0aW9uIHhjKGEsYil7aWYobnVsbCE9YS5CKXRocm93IEVycm9yKFwiV2F0Y2hEb2cgdGltZXIgbm90IG51bGxcIik7YS5CPVRiKHEoYS5sYixhKSxiKTt9ZnVuY3Rpb24gcGMoYSl7YS5CJiYobC5jbGVhclRpbWVvdXQoYS5CKSxhLkI9bnVsbCk7fWsubGI9ZnVuY3Rpb24oKXt0aGlzLkI9bnVsbDtjb25zdCBhPURhdGUubm93KCk7MDw9YS10aGlzLlk/KE1iKHRoaXMuaix0aGlzLkEpLDIhPXRoaXMuTCYmKFFiKCksRigxNykpLEkodGhpcyksdGhpcy5vPTIscmModGhpcykpOnhjKHRoaXMsdGhpcy5ZLWEpO307ZnVuY3Rpb24gcmMoYSl7MD09YS5sLkh8fGEuSnx8dWMoYS5sLGEpO31mdW5jdGlvbiBJKGEpe3BjKGEpO3ZhciBiPWEuTTtiJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBiLnJhJiZiLnJhKCk7YS5NPW51bGw7emIoYS5WKTtIYihhLlUpO2EuZyYmKGI9YS5nLGEuZz1udWxsLGIuYWJvcnQoKSxiLnJhKCkpO31cbmZ1bmN0aW9uIHNjKGEsYil7dHJ5e3ZhciBjPWEubDtpZigwIT1jLkgmJihjLmc9PWF8fHljKGMuaCxhKSkpaWYoIWEuSyYmeWMoYy5oLGEpJiYzPT1jLkgpe3RyeXt2YXIgZD1jLkphLmcucGFyc2UoYik7fWNhdGNoKG4pe2Q9bnVsbDt9aWYoQXJyYXkuaXNBcnJheShkKSYmMz09ZC5sZW5ndGgpe3ZhciBlPWQ7aWYoMD09ZVswXSlhOntpZighYy51KXtpZihjLmcpaWYoYy5nLkcrM0UzPGEuRyl6YyhjKSxBYyhjKTtlbHNlIGJyZWFrIGE7QmMoYyk7RigxOCk7fX1lbHNlIGMuRmE9ZVsxXSwwPGMuRmEtYy5WJiYzNzUwMD5lWzJdJiZjLk0mJjA9PWMuQSYmIWMudiYmKGMudj1UYihxKGMuaWIsYyksNkUzKSk7aWYoMT49Q2MoYy5oKSYmYy5uYSl7dHJ5e2MubmEoKTt9Y2F0Y2gobil7fWMubmE9dm9pZCAwO319ZWxzZSBKKGMsMTEpO31lbHNlIGlmKChhLkt8fGMuZz09YSkmJnpjKGMpLCFxYShiKSlmb3IoZT1jLkphLmcucGFyc2UoYiksYj0wO2I8ZS5sZW5ndGg7YisrKXtsZXQgbj1lW2JdO2MuVj1cbm5bMF07bj1uWzFdO2lmKDI9PWMuSClpZihcImNcIj09blswXSl7Yy5KPW5bMV07Yy5vYT1uWzJdO2NvbnN0IHU9blszXTtudWxsIT11JiYoYy5xYT11LGMuai5pbmZvKFwiVkVSPVwiK2MucWEpKTtjb25zdCBMPW5bNF07bnVsbCE9TCYmKGMuR2E9TCxjLmouaW5mbyhcIlNWRVI9XCIrYy5HYSkpO2NvbnN0IExhPW5bNV07bnVsbCE9TGEmJlwibnVtYmVyXCI9PT10eXBlb2YgTGEmJjA8TGEmJihkPTEuNSpMYSxjLks9ZCxjLmouaW5mbyhcImJhY2tDaGFubmVsUmVxdWVzdFRpbWVvdXRNc189XCIrZCkpO2Q9Yztjb25zdCBpYT1hLmc7aWYoaWEpe2NvbnN0IE1hPWlhLmc/aWEuZy5nZXRSZXNwb25zZUhlYWRlcihcIlgtQ2xpZW50LVdpcmUtUHJvdG9jb2xcIik6bnVsbDtpZihNYSl7dmFyIGY9ZC5oO2YuZ3x8LTE9PU1hLmluZGV4T2YoXCJzcGR5XCIpJiYtMT09TWEuaW5kZXhPZihcInF1aWNcIikmJi0xPT1NYS5pbmRleE9mKFwiaDJcIil8fChmLmo9Zi5sLGYuZz1uZXcgU2V0LGYuaCYmKERjKGYsZi5oKSxmLmg9bnVsbCkpO31pZihkLkYpe2NvbnN0IEZiPVxuaWEuZz9pYS5nLmdldFJlc3BvbnNlSGVhZGVyKFwiWC1IVFRQLVNlc3Npb24tSWRcIik6bnVsbDtGYiYmKGQuRGE9RmIsSyhkLkcsZC5GLEZiKSk7fX1jLkg9MztjLmwmJmMubC5CYSgpO2MuY2EmJihjLlM9RGF0ZS5ub3coKS1hLkcsYy5qLmluZm8oXCJIYW5kc2hha2UgUlRUOiBcIitjLlMrXCJtc1wiKSk7ZD1jO3ZhciBoPWE7ZC53YT1FYyhkLGQuST9kLm9hOm51bGwsZC5ZKTtpZihoLkspe0ZjKGQuaCxoKTt2YXIgbT1oLHQ9ZC5LO3QmJm0uc2V0VGltZW91dCh0KTttLkImJihwYyhtKSxsYyhtKSk7ZC5nPWg7fWVsc2UgR2MoZCk7MDxjLmkubGVuZ3RoJiZIYyhjKTt9ZWxzZSBcInN0b3BcIiE9blswXSYmXCJjbG9zZVwiIT1uWzBdfHxKKGMsNyk7ZWxzZSAzPT1jLkgmJihcInN0b3BcIj09blswXXx8XCJjbG9zZVwiPT1uWzBdP1wic3RvcFwiPT1uWzBdP0ooYyw3KTpJYyhjKTpcIm5vb3BcIiE9blswXSYmYy5sJiZjLmwuQWEobiksYy5BPTApO31RYig0KTt9Y2F0Y2gobil7fX1mdW5jdGlvbiBKYyhhKXtpZihhLlomJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuWilyZXR1cm4gYS5aKCk7aWYoXCJ1bmRlZmluZWRcIiE9PXR5cGVvZiBNYXAmJmEgaW5zdGFuY2VvZiBNYXB8fFwidW5kZWZpbmVkXCIhPT10eXBlb2YgU2V0JiZhIGluc3RhbmNlb2YgU2V0KXJldHVybiBBcnJheS5mcm9tKGEudmFsdWVzKCkpO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlyZXR1cm4gYS5zcGxpdChcIlwiKTtpZihiYShhKSl7Zm9yKHZhciBiPVtdLGM9YS5sZW5ndGgsZD0wO2Q8YztkKyspYi5wdXNoKGFbZF0pO3JldHVybiBifWI9W107Yz0wO2ZvcihkIGluIGEpYltjKytdPWFbZF07cmV0dXJuIGJ9XG5mdW5jdGlvbiBLYyhhKXtpZihhLnNhJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBhLnNhKXJldHVybiBhLnNhKCk7aWYoIWEuWnx8XCJmdW5jdGlvblwiIT10eXBlb2YgYS5aKXtpZihcInVuZGVmaW5lZFwiIT09dHlwZW9mIE1hcCYmYSBpbnN0YW5jZW9mIE1hcClyZXR1cm4gQXJyYXkuZnJvbShhLmtleXMoKSk7aWYoIShcInVuZGVmaW5lZFwiIT09dHlwZW9mIFNldCYmYSBpbnN0YW5jZW9mIFNldCkpe2lmKGJhKGEpfHxcInN0cmluZ1wiPT09dHlwZW9mIGEpe3ZhciBiPVtdO2E9YS5sZW5ndGg7Zm9yKHZhciBjPTA7YzxhO2MrKyliLnB1c2goYyk7cmV0dXJuIGJ9Yj1bXTtjPTA7Zm9yKGNvbnN0IGQgaW4gYSliW2MrK109ZDtyZXR1cm4gYn19fVxuZnVuY3Rpb24gTGMoYSxiKXtpZihhLmZvckVhY2gmJlwiZnVuY3Rpb25cIj09dHlwZW9mIGEuZm9yRWFjaClhLmZvckVhY2goYix2b2lkIDApO2Vsc2UgaWYoYmEoYSl8fFwic3RyaW5nXCI9PT10eXBlb2YgYSlBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGEsYix2b2lkIDApO2Vsc2UgZm9yKHZhciBjPUtjKGEpLGQ9SmMoYSksZT1kLmxlbmd0aCxmPTA7ZjxlO2YrKyliLmNhbGwodm9pZCAwLGRbZl0sYyYmY1tmXSxhKTt9dmFyIE1jPVJlZ0V4cChcIl4oPzooW146Lz8jLl0rKTopPyg/Oi8vKD86KFteXFxcXFxcXFwvPyNdKilAKT8oW15cXFxcXFxcXC8/I10qPykoPzo6KFswLTldKykpPyg/PVtcXFxcXFxcXC8/I118JCkpPyhbXj8jXSspPyg/OlxcXFw/KFteI10qKSk/KD86IyhbXFxcXHNcXFxcU10qKSk/JFwiKTtmdW5jdGlvbiBOYyhhLGIpe2lmKGEpe2E9YS5zcGxpdChcIiZcIik7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10uaW5kZXhPZihcIj1cIiksZT1udWxsO2lmKDA8PWQpe3ZhciBmPWFbY10uc3Vic3RyaW5nKDAsZCk7ZT1hW2NdLnN1YnN0cmluZyhkKzEpO31lbHNlIGY9YVtjXTtiKGYsZT9kZWNvZGVVUklDb21wb25lbnQoZS5yZXBsYWNlKC9cXCsvZyxcIiBcIikpOlwiXCIpO319fWZ1bmN0aW9uIE0oYSxiKXt0aGlzLmc9dGhpcy5zPXRoaXMuaj1cIlwiO3RoaXMubT1udWxsO3RoaXMubz10aGlzLmw9XCJcIjt0aGlzLmg9ITE7aWYoYSBpbnN0YW5jZW9mIE0pe3RoaXMuaD12b2lkIDAhPT1iP2I6YS5oO09jKHRoaXMsYS5qKTt0aGlzLnM9YS5zO3RoaXMuZz1hLmc7UGModGhpcyxhLm0pO3RoaXMubD1hLmw7Yj1hLmk7dmFyIGM9bmV3IFFjO2MuaT1iLmk7Yi5nJiYoYy5nPW5ldyBNYXAoYi5nKSxjLmg9Yi5oKTtSYyh0aGlzLGMpO3RoaXMubz1hLm87fWVsc2UgYSYmKGM9U3RyaW5nKGEpLm1hdGNoKE1jKSk/KHRoaXMuaD0hIWIsT2ModGhpcyxjWzFdfHxcIlwiLCEwKSx0aGlzLnM9U2MoY1syXXx8XCJcIiksdGhpcy5nPVNjKGNbM118fFwiXCIsITApLFBjKHRoaXMsY1s0XSksdGhpcy5sPVNjKGNbNV18fFwiXCIsITApLFJjKHRoaXMsY1s2XXx8XCJcIiwhMCksdGhpcy5vPVNjKGNbN118fFwiXCIpKToodGhpcy5oPSEhYix0aGlzLmk9bmV3IFFjKG51bGwsdGhpcy5oKSk7fVxuTS5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXt2YXIgYT1bXSxiPXRoaXMuajtiJiZhLnB1c2goVGMoYixVYywhMCksXCI6XCIpO3ZhciBjPXRoaXMuZztpZihjfHxcImZpbGVcIj09YilhLnB1c2goXCIvL1wiKSwoYj10aGlzLnMpJiZhLnB1c2goVGMoYixVYywhMCksXCJAXCIpLGEucHVzaChlbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGMpKS5yZXBsYWNlKC8lMjUoWzAtOWEtZkEtRl17Mn0pL2csXCIlJDFcIikpLGM9dGhpcy5tLG51bGwhPWMmJmEucHVzaChcIjpcIixTdHJpbmcoYykpO2lmKGM9dGhpcy5sKXRoaXMuZyYmXCIvXCIhPWMuY2hhckF0KDApJiZhLnB1c2goXCIvXCIpLGEucHVzaChUYyhjLFwiL1wiPT1jLmNoYXJBdCgwKT9WYzpXYywhMCkpOyhjPXRoaXMuaS50b1N0cmluZygpKSYmYS5wdXNoKFwiP1wiLGMpOyhjPXRoaXMubykmJmEucHVzaChcIiNcIixUYyhjLFhjKSk7cmV0dXJuIGEuam9pbihcIlwiKX07ZnVuY3Rpb24gRyhhKXtyZXR1cm4gbmV3IE0oYSl9XG5mdW5jdGlvbiBPYyhhLGIsYyl7YS5qPWM/U2MoYiwhMCk6YjthLmomJihhLmo9YS5qLnJlcGxhY2UoLzokLyxcIlwiKSk7fWZ1bmN0aW9uIFBjKGEsYil7aWYoYil7Yj1OdW1iZXIoYik7aWYoaXNOYU4oYil8fDA+Yil0aHJvdyBFcnJvcihcIkJhZCBwb3J0IG51bWJlciBcIitiKTthLm09Yjt9ZWxzZSBhLm09bnVsbDt9ZnVuY3Rpb24gUmMoYSxiLGMpe2IgaW5zdGFuY2VvZiBRYz8oYS5pPWIsWWMoYS5pLGEuaCkpOihjfHwoYj1UYyhiLFpjKSksYS5pPW5ldyBRYyhiLGEuaCkpO31mdW5jdGlvbiBLKGEsYixjKXthLmkuc2V0KGIsYyk7fWZ1bmN0aW9uIGpjKGEpe0soYSxcInp4XCIsTWF0aC5mbG9vcigyMTQ3NDgzNjQ4Kk1hdGgucmFuZG9tKCkpLnRvU3RyaW5nKDM2KStNYXRoLmFicyhNYXRoLmZsb29yKDIxNDc0ODM2NDgqTWF0aC5yYW5kb20oKSleRGF0ZS5ub3coKSkudG9TdHJpbmcoMzYpKTtyZXR1cm4gYX1cbmZ1bmN0aW9uIFNjKGEsYil7cmV0dXJuIGE/Yj9kZWNvZGVVUkkoYS5yZXBsYWNlKC8lMjUvZyxcIiUyNTI1XCIpKTpkZWNvZGVVUklDb21wb25lbnQoYSk6XCJcIn1mdW5jdGlvbiBUYyhhLGIsYyl7cmV0dXJuIFwic3RyaW5nXCI9PT10eXBlb2YgYT8oYT1lbmNvZGVVUkkoYSkucmVwbGFjZShiLCRjKSxjJiYoYT1hLnJlcGxhY2UoLyUyNShbMC05YS1mQS1GXXsyfSkvZyxcIiUkMVwiKSksYSk6bnVsbH1mdW5jdGlvbiAkYyhhKXthPWEuY2hhckNvZGVBdCgwKTtyZXR1cm4gXCIlXCIrKGE+PjQmMTUpLnRvU3RyaW5nKDE2KSsoYSYxNSkudG9TdHJpbmcoMTYpfXZhciBVYz0vWyNcXC9cXD9AXS9nLFdjPS9bI1xcPzpdL2csVmM9L1sjXFw/XS9nLFpjPS9bI1xcP0BdL2csWGM9LyMvZztmdW5jdGlvbiBRYyhhLGIpe3RoaXMuaD10aGlzLmc9bnVsbDt0aGlzLmk9YXx8bnVsbDt0aGlzLmo9ISFiO31cbmZ1bmN0aW9uIE4oYSl7YS5nfHwoYS5nPW5ldyBNYXAsYS5oPTAsYS5pJiZOYyhhLmksZnVuY3Rpb24oYixjKXthLmFkZChkZWNvZGVVUklDb21wb25lbnQoYi5yZXBsYWNlKC9cXCsvZyxcIiBcIikpLGMpO30pKTt9az1RYy5wcm90b3R5cGU7ay5hZGQ9ZnVuY3Rpb24oYSxiKXtOKHRoaXMpO3RoaXMuaT1udWxsO2E9Tyh0aGlzLGEpO3ZhciBjPXRoaXMuZy5nZXQoYSk7Y3x8dGhpcy5nLnNldChhLGM9W10pO2MucHVzaChiKTt0aGlzLmgrPTE7cmV0dXJuIHRoaXN9O2Z1bmN0aW9uIGFkKGEsYil7TihhKTtiPU8oYSxiKTthLmcuaGFzKGIpJiYoYS5pPW51bGwsYS5oLT1hLmcuZ2V0KGIpLmxlbmd0aCxhLmcuZGVsZXRlKGIpKTt9ZnVuY3Rpb24gYmQoYSxiKXtOKGEpO2I9TyhhLGIpO3JldHVybiBhLmcuaGFzKGIpfVxuay5mb3JFYWNoPWZ1bmN0aW9uKGEsYil7Tih0aGlzKTt0aGlzLmcuZm9yRWFjaChmdW5jdGlvbihjLGQpe2MuZm9yRWFjaChmdW5jdGlvbihlKXthLmNhbGwoYixlLGQsdGhpcyk7fSx0aGlzKTt9LHRoaXMpO307ay5zYT1mdW5jdGlvbigpe04odGhpcyk7Y29uc3QgYT1BcnJheS5mcm9tKHRoaXMuZy52YWx1ZXMoKSksYj1BcnJheS5mcm9tKHRoaXMuZy5rZXlzKCkpLGM9W107Zm9yKGxldCBkPTA7ZDxiLmxlbmd0aDtkKyspe2NvbnN0IGU9YVtkXTtmb3IobGV0IGY9MDtmPGUubGVuZ3RoO2YrKyljLnB1c2goYltkXSk7fXJldHVybiBjfTtrLlo9ZnVuY3Rpb24oYSl7Tih0aGlzKTtsZXQgYj1bXTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGEpYmQodGhpcyxhKSYmKGI9Yi5jb25jYXQodGhpcy5nLmdldChPKHRoaXMsYSkpKSk7ZWxzZSB7YT1BcnJheS5mcm9tKHRoaXMuZy52YWx1ZXMoKSk7Zm9yKGxldCBjPTA7YzxhLmxlbmd0aDtjKyspYj1iLmNvbmNhdChhW2NdKTt9cmV0dXJuIGJ9O1xuay5zZXQ9ZnVuY3Rpb24oYSxiKXtOKHRoaXMpO3RoaXMuaT1udWxsO2E9Tyh0aGlzLGEpO2JkKHRoaXMsYSkmJih0aGlzLmgtPXRoaXMuZy5nZXQoYSkubGVuZ3RoKTt0aGlzLmcuc2V0KGEsW2JdKTt0aGlzLmgrPTE7cmV0dXJuIHRoaXN9O2suZ2V0PWZ1bmN0aW9uKGEsYil7aWYoIWEpcmV0dXJuIGI7YT10aGlzLlooYSk7cmV0dXJuIDA8YS5sZW5ndGg/U3RyaW5nKGFbMF0pOmJ9O2Z1bmN0aW9uIG1jKGEsYixjKXthZChhLGIpOzA8Yy5sZW5ndGgmJihhLmk9bnVsbCxhLmcuc2V0KE8oYSxiKSxuYShjKSksYS5oKz1jLmxlbmd0aCk7fVxuay50b1N0cmluZz1mdW5jdGlvbigpe2lmKHRoaXMuaSlyZXR1cm4gdGhpcy5pO2lmKCF0aGlzLmcpcmV0dXJuIFwiXCI7Y29uc3QgYT1bXSxiPUFycmF5LmZyb20odGhpcy5nLmtleXMoKSk7Zm9yKHZhciBjPTA7YzxiLmxlbmd0aDtjKyspe3ZhciBkPWJbY107Y29uc3QgZj1lbmNvZGVVUklDb21wb25lbnQoU3RyaW5nKGQpKSxoPXRoaXMuWihkKTtmb3IoZD0wO2Q8aC5sZW5ndGg7ZCsrKXt2YXIgZT1mO1wiXCIhPT1oW2RdJiYoZSs9XCI9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhoW2RdKSkpO2EucHVzaChlKTt9fXJldHVybiB0aGlzLmk9YS5qb2luKFwiJlwiKX07ZnVuY3Rpb24gTyhhLGIpe2I9U3RyaW5nKGIpO2EuaiYmKGI9Yi50b0xvd2VyQ2FzZSgpKTtyZXR1cm4gYn1cbmZ1bmN0aW9uIFljKGEsYil7YiYmIWEuaiYmKE4oYSksYS5pPW51bGwsYS5nLmZvckVhY2goZnVuY3Rpb24oYyxkKXt2YXIgZT1kLnRvTG93ZXJDYXNlKCk7ZCE9ZSYmKGFkKHRoaXMsZCksbWModGhpcyxlLGMpKTt9LGEpKTthLmo9Yjt9dmFyIGNkPWNsYXNze2NvbnN0cnVjdG9yKGEsYil7dGhpcy5oPWE7dGhpcy5nPWI7fX07ZnVuY3Rpb24gZGQoYSl7dGhpcy5sPWF8fGVkO2wuUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nPyhhPWwucGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZShcIm5hdmlnYXRpb25cIiksYT0wPGEubGVuZ3RoJiYoXCJocVwiPT1hWzBdLm5leHRIb3BQcm90b2NvbHx8XCJoMlwiPT1hWzBdLm5leHRIb3BQcm90b2NvbCkpOmE9ISEobC5nJiZsLmcuS2EmJmwuZy5LYSgpJiZsLmcuS2EoKS5lYyk7dGhpcy5qPWE/dGhpcy5sOjE7dGhpcy5nPW51bGw7MTx0aGlzLmomJih0aGlzLmc9bmV3IFNldCk7dGhpcy5oPW51bGw7dGhpcy5pPVtdO312YXIgZWQ9MTA7ZnVuY3Rpb24gZmQoYSl7cmV0dXJuIGEuaD8hMDphLmc/YS5nLnNpemU+PWEuajohMX1mdW5jdGlvbiBDYyhhKXtyZXR1cm4gYS5oPzE6YS5nP2EuZy5zaXplOjB9ZnVuY3Rpb24geWMoYSxiKXtyZXR1cm4gYS5oP2EuaD09YjphLmc/YS5nLmhhcyhiKTohMX1mdW5jdGlvbiBEYyhhLGIpe2EuZz9hLmcuYWRkKGIpOmEuaD1iO31cbmZ1bmN0aW9uIEZjKGEsYil7YS5oJiZhLmg9PWI/YS5oPW51bGw6YS5nJiZhLmcuaGFzKGIpJiZhLmcuZGVsZXRlKGIpO31kZC5wcm90b3R5cGUuY2FuY2VsPWZ1bmN0aW9uKCl7dGhpcy5pPWdkKHRoaXMpO2lmKHRoaXMuaCl0aGlzLmguY2FuY2VsKCksdGhpcy5oPW51bGw7ZWxzZSBpZih0aGlzLmcmJjAhPT10aGlzLmcuc2l6ZSl7Zm9yKGNvbnN0IGEgb2YgdGhpcy5nLnZhbHVlcygpKWEuY2FuY2VsKCk7dGhpcy5nLmNsZWFyKCk7fX07ZnVuY3Rpb24gZ2QoYSl7aWYobnVsbCE9YS5oKXJldHVybiBhLmkuY29uY2F0KGEuaC5GKTtpZihudWxsIT1hLmcmJjAhPT1hLmcuc2l6ZSl7bGV0IGI9YS5pO2Zvcihjb25zdCBjIG9mIGEuZy52YWx1ZXMoKSliPWIuY29uY2F0KGMuRik7cmV0dXJuIGJ9cmV0dXJuIG5hKGEuaSl9ZnVuY3Rpb24gaGQoKXt9aGQucHJvdG90eXBlLnN0cmluZ2lmeT1mdW5jdGlvbihhKXtyZXR1cm4gbC5KU09OLnN0cmluZ2lmeShhLHZvaWQgMCl9O2hkLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbihhKXtyZXR1cm4gbC5KU09OLnBhcnNlKGEsdm9pZCAwKX07ZnVuY3Rpb24gaWQoKXt0aGlzLmc9bmV3IGhkO31mdW5jdGlvbiBqZChhLGIsYyl7Y29uc3QgZD1jfHxcIlwiO3RyeXtMYyhhLGZ1bmN0aW9uKGUsZil7bGV0IGg9ZTtwKGUpJiYoaD1tYihlKSk7Yi5wdXNoKGQrZitcIj1cIitlbmNvZGVVUklDb21wb25lbnQoaCkpO30pO31jYXRjaChlKXt0aHJvdyBiLnB1c2goZCtcInR5cGU9XCIrZW5jb2RlVVJJQ29tcG9uZW50KFwiX2JhZG1hcFwiKSksZTt9fWZ1bmN0aW9uIGtkKGEsYil7Y29uc3QgYz1uZXcgSWI7aWYobC5JbWFnZSl7Y29uc3QgZD1uZXcgSW1hZ2U7ZC5vbmxvYWQ9amEobGQsYyxkLFwiVGVzdExvYWRJbWFnZTogbG9hZGVkXCIsITAsYik7ZC5vbmVycm9yPWphKGxkLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGVycm9yXCIsITEsYik7ZC5vbmFib3J0PWphKGxkLGMsZCxcIlRlc3RMb2FkSW1hZ2U6IGFib3J0XCIsITEsYik7ZC5vbnRpbWVvdXQ9amEobGQsYyxkLFwiVGVzdExvYWRJbWFnZTogdGltZW91dFwiLCExLGIpO2wuc2V0VGltZW91dChmdW5jdGlvbigpe2lmKGQub250aW1lb3V0KWQub250aW1lb3V0KCk7fSwxRTQpO2Quc3JjPWE7fWVsc2UgYighMSk7fWZ1bmN0aW9uIGxkKGEsYixjLGQsZSl7dHJ5e2Iub25sb2FkPW51bGwsYi5vbmVycm9yPW51bGwsYi5vbmFib3J0PW51bGwsYi5vbnRpbWVvdXQ9bnVsbCxlKGQpO31jYXRjaChmKXt9fWZ1bmN0aW9uIG1kKGEpe3RoaXMubD1hLmZjfHxudWxsO3RoaXMuaj1hLm9ifHwhMTt9cihtZCxXYik7bWQucHJvdG90eXBlLmc9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IG5kKHRoaXMubCx0aGlzLmopfTttZC5wcm90b3R5cGUuaT1mdW5jdGlvbihhKXtyZXR1cm4gZnVuY3Rpb24oKXtyZXR1cm4gYX19KHt9KTtmdW5jdGlvbiBuZChhLGIpe0IuY2FsbCh0aGlzKTt0aGlzLkY9YTt0aGlzLnU9Yjt0aGlzLm09dm9pZCAwO3RoaXMucmVhZHlTdGF0ZT1vZDt0aGlzLnN0YXR1cz0wO3RoaXMucmVzcG9uc2VUeXBlPXRoaXMucmVzcG9uc2VUZXh0PXRoaXMucmVzcG9uc2U9dGhpcy5zdGF0dXNUZXh0PVwiXCI7dGhpcy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt0aGlzLnY9bmV3IEhlYWRlcnM7dGhpcy5oPW51bGw7dGhpcy5DPVwiR0VUXCI7dGhpcy5CPVwiXCI7dGhpcy5nPSExO3RoaXMuQT10aGlzLmo9dGhpcy5sPW51bGw7fXIobmQsQik7dmFyIG9kPTA7az1uZC5wcm90b3R5cGU7XG5rLm9wZW49ZnVuY3Rpb24oYSxiKXtpZih0aGlzLnJlYWR5U3RhdGUhPW9kKXRocm93IHRoaXMuYWJvcnQoKSxFcnJvcihcIkVycm9yIHJlb3BlbmluZyBhIGNvbm5lY3Rpb25cIik7dGhpcy5DPWE7dGhpcy5CPWI7dGhpcy5yZWFkeVN0YXRlPTE7cGQodGhpcyk7fTtrLnNlbmQ9ZnVuY3Rpb24oYSl7aWYoMSE9dGhpcy5yZWFkeVN0YXRlKXRocm93IHRoaXMuYWJvcnQoKSxFcnJvcihcIm5lZWQgdG8gY2FsbCBvcGVuKCkgZmlyc3QuIFwiKTt0aGlzLmc9ITA7Y29uc3QgYj17aGVhZGVyczp0aGlzLnYsbWV0aG9kOnRoaXMuQyxjcmVkZW50aWFsczp0aGlzLm0sY2FjaGU6dm9pZCAwfTthJiYoYi5ib2R5PWEpOyh0aGlzLkZ8fGwpLmZldGNoKG5ldyBSZXF1ZXN0KHRoaXMuQixiKSkudGhlbih0aGlzLiRhLmJpbmQodGhpcyksdGhpcy5rYS5iaW5kKHRoaXMpKTt9O1xuay5hYm9ydD1mdW5jdGlvbigpe3RoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQ9XCJcIjt0aGlzLnY9bmV3IEhlYWRlcnM7dGhpcy5zdGF0dXM9MDt0aGlzLmomJnRoaXMuai5jYW5jZWwoXCJSZXF1ZXN0IHdhcyBhYm9ydGVkLlwiKS5jYXRjaCgoKT0+e30pOzE8PXRoaXMucmVhZHlTdGF0ZSYmdGhpcy5nJiY0IT10aGlzLnJlYWR5U3RhdGUmJih0aGlzLmc9ITEscWQodGhpcykpO3RoaXMucmVhZHlTdGF0ZT1vZDt9O1xuay4kYT1mdW5jdGlvbihhKXtpZih0aGlzLmcmJih0aGlzLmw9YSx0aGlzLmh8fCh0aGlzLnN0YXR1cz10aGlzLmwuc3RhdHVzLHRoaXMuc3RhdHVzVGV4dD10aGlzLmwuc3RhdHVzVGV4dCx0aGlzLmg9YS5oZWFkZXJzLHRoaXMucmVhZHlTdGF0ZT0yLHBkKHRoaXMpKSx0aGlzLmcmJih0aGlzLnJlYWR5U3RhdGU9MyxwZCh0aGlzKSx0aGlzLmcpKSlpZihcImFycmF5YnVmZmVyXCI9PT10aGlzLnJlc3BvbnNlVHlwZSlhLmFycmF5QnVmZmVyKCkudGhlbih0aGlzLllhLmJpbmQodGhpcyksdGhpcy5rYS5iaW5kKHRoaXMpKTtlbHNlIGlmKFwidW5kZWZpbmVkXCIhPT10eXBlb2YgbC5SZWFkYWJsZVN0cmVhbSYmXCJib2R5XCJpbiBhKXt0aGlzLmo9YS5ib2R5LmdldFJlYWRlcigpO2lmKHRoaXMudSl7aWYodGhpcy5yZXNwb25zZVR5cGUpdGhyb3cgRXJyb3IoJ3Jlc3BvbnNlVHlwZSBtdXN0IGJlIGVtcHR5IGZvciBcInN0cmVhbUJpbmFyeUNodW5rc1wiIG1vZGUgcmVzcG9uc2VzLicpO3RoaXMucmVzcG9uc2U9XG5bXTt9ZWxzZSB0aGlzLnJlc3BvbnNlPXRoaXMucmVzcG9uc2VUZXh0PVwiXCIsdGhpcy5BPW5ldyBUZXh0RGVjb2RlcjtyZCh0aGlzKTt9ZWxzZSBhLnRleHQoKS50aGVuKHRoaXMuWmEuYmluZCh0aGlzKSx0aGlzLmthLmJpbmQodGhpcykpO307ZnVuY3Rpb24gcmQoYSl7YS5qLnJlYWQoKS50aGVuKGEuWGEuYmluZChhKSkuY2F0Y2goYS5rYS5iaW5kKGEpKTt9ay5YYT1mdW5jdGlvbihhKXtpZih0aGlzLmcpe2lmKHRoaXMudSYmYS52YWx1ZSl0aGlzLnJlc3BvbnNlLnB1c2goYS52YWx1ZSk7ZWxzZSBpZighdGhpcy51KXt2YXIgYj1hLnZhbHVlP2EudmFsdWU6bmV3IFVpbnQ4QXJyYXkoMCk7aWYoYj10aGlzLkEuZGVjb2RlKGIse3N0cmVhbTohYS5kb25lfSkpdGhpcy5yZXNwb25zZT10aGlzLnJlc3BvbnNlVGV4dCs9Yjt9YS5kb25lP3FkKHRoaXMpOnBkKHRoaXMpOzM9PXRoaXMucmVhZHlTdGF0ZSYmcmQodGhpcyk7fX07XG5rLlphPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9dGhpcy5yZXNwb25zZVRleHQ9YSxxZCh0aGlzKSk7fTtrLllhPWZ1bmN0aW9uKGEpe3RoaXMuZyYmKHRoaXMucmVzcG9uc2U9YSxxZCh0aGlzKSk7fTtrLmthPWZ1bmN0aW9uKCl7dGhpcy5nJiZxZCh0aGlzKTt9O2Z1bmN0aW9uIHFkKGEpe2EucmVhZHlTdGF0ZT00O2EubD1udWxsO2Euaj1udWxsO2EuQT1udWxsO3BkKGEpO31rLnNldFJlcXVlc3RIZWFkZXI9ZnVuY3Rpb24oYSxiKXt0aGlzLnYuYXBwZW5kKGEsYik7fTtrLmdldFJlc3BvbnNlSGVhZGVyPWZ1bmN0aW9uKGEpe3JldHVybiB0aGlzLmg/dGhpcy5oLmdldChhLnRvTG93ZXJDYXNlKCkpfHxcIlwiOlwiXCJ9O1xuay5nZXRBbGxSZXNwb25zZUhlYWRlcnM9ZnVuY3Rpb24oKXtpZighdGhpcy5oKXJldHVybiBcIlwiO2NvbnN0IGE9W10sYj10aGlzLmguZW50cmllcygpO2Zvcih2YXIgYz1iLm5leHQoKTshYy5kb25lOyljPWMudmFsdWUsYS5wdXNoKGNbMF0rXCI6IFwiK2NbMV0pLGM9Yi5uZXh0KCk7cmV0dXJuIGEuam9pbihcIlxcclxcblwiKX07ZnVuY3Rpb24gcGQoYSl7YS5vbnJlYWR5c3RhdGVjaGFuZ2UmJmEub25yZWFkeXN0YXRlY2hhbmdlLmNhbGwoYSk7fU9iamVjdC5kZWZpbmVQcm9wZXJ0eShuZC5wcm90b3R5cGUsXCJ3aXRoQ3JlZGVudGlhbHNcIix7Z2V0OmZ1bmN0aW9uKCl7cmV0dXJuIFwiaW5jbHVkZVwiPT09dGhpcy5tfSxzZXQ6ZnVuY3Rpb24oYSl7dGhpcy5tPWE/XCJpbmNsdWRlXCI6XCJzYW1lLW9yaWdpblwiO319KTt2YXIgc2Q9bC5KU09OLnBhcnNlO2Z1bmN0aW9uIFAoYSl7Qi5jYWxsKHRoaXMpO3RoaXMuaGVhZGVycz1uZXcgTWFwO3RoaXMudT1hfHxudWxsO3RoaXMuaD0hMTt0aGlzLkM9dGhpcy5nPW51bGw7dGhpcy5JPVwiXCI7dGhpcy5tPTA7dGhpcy5qPVwiXCI7dGhpcy5sPXRoaXMuRz10aGlzLnY9dGhpcy5GPSExO3RoaXMuQj0wO3RoaXMuQT1udWxsO3RoaXMuSz10ZDt0aGlzLkw9dGhpcy5NPSExO31yKFAsQik7dmFyIHRkPVwiXCIsdWQ9L15odHRwcz8kL2ksdmQ9W1wiUE9TVFwiLFwiUFVUXCJdO2s9UC5wcm90b3R5cGU7ay5PYT1mdW5jdGlvbihhKXt0aGlzLk09YTt9O1xuay5oYT1mdW5jdGlvbihhLGIsYyxkKXtpZih0aGlzLmcpdGhyb3cgRXJyb3IoXCJbZ29vZy5uZXQuWGhySW9dIE9iamVjdCBpcyBhY3RpdmUgd2l0aCBhbm90aGVyIHJlcXVlc3Q9XCIrdGhpcy5JK1wiOyBuZXdVcmk9XCIrYSk7Yj1iP2IudG9VcHBlckNhc2UoKTpcIkdFVFwiO3RoaXMuST1hO3RoaXMuaj1cIlwiO3RoaXMubT0wO3RoaXMuRj0hMTt0aGlzLmg9ITA7dGhpcy5nPXRoaXMudT90aGlzLnUuZygpOmJjLmcoKTt0aGlzLkM9dGhpcy51P1hiKHRoaXMudSk6WGIoYmMpO3RoaXMuZy5vbnJlYWR5c3RhdGVjaGFuZ2U9cSh0aGlzLkxhLHRoaXMpO3RyeXt0aGlzLkc9ITAsdGhpcy5nLm9wZW4oYixTdHJpbmcoYSksITApLHRoaXMuRz0hMTt9Y2F0Y2goZil7d2QodGhpcyxmKTtyZXR1cm59YT1jfHxcIlwiO2M9bmV3IE1hcCh0aGlzLmhlYWRlcnMpO2lmKGQpaWYoT2JqZWN0LmdldFByb3RvdHlwZU9mKGQpPT09T2JqZWN0LnByb3RvdHlwZSlmb3IodmFyIGUgaW4gZCljLnNldChlLGRbZV0pO2Vsc2UgaWYoXCJmdW5jdGlvblwiPT09XG50eXBlb2YgZC5rZXlzJiZcImZ1bmN0aW9uXCI9PT10eXBlb2YgZC5nZXQpZm9yKGNvbnN0IGYgb2YgZC5rZXlzKCkpYy5zZXQoZixkLmdldChmKSk7ZWxzZSB0aHJvdyBFcnJvcihcIlVua25vd24gaW5wdXQgdHlwZSBmb3Igb3B0X2hlYWRlcnM6IFwiK1N0cmluZyhkKSk7ZD1BcnJheS5mcm9tKGMua2V5cygpKS5maW5kKGY9PlwiY29udGVudC10eXBlXCI9PWYudG9Mb3dlckNhc2UoKSk7ZT1sLkZvcm1EYXRhJiZhIGluc3RhbmNlb2YgbC5Gb3JtRGF0YTshKDA8PW1hKHZkLGIpKXx8ZHx8ZXx8Yy5zZXQoXCJDb250ZW50LVR5cGVcIixcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04XCIpO2Zvcihjb25zdCBbZixoXW9mIGMpdGhpcy5nLnNldFJlcXVlc3RIZWFkZXIoZixoKTt0aGlzLksmJih0aGlzLmcucmVzcG9uc2VUeXBlPXRoaXMuSyk7XCJ3aXRoQ3JlZGVudGlhbHNcImluIHRoaXMuZyYmdGhpcy5nLndpdGhDcmVkZW50aWFscyE9PXRoaXMuTSYmKHRoaXMuZy53aXRoQ3JlZGVudGlhbHM9XG50aGlzLk0pO3RyeXt4ZCh0aGlzKSwwPHRoaXMuQiYmKCh0aGlzLkw9eWQodGhpcy5nKSk/KHRoaXMuZy50aW1lb3V0PXRoaXMuQix0aGlzLmcub250aW1lb3V0PXEodGhpcy51YSx0aGlzKSk6dGhpcy5BPUFiKHRoaXMudWEsdGhpcy5CLHRoaXMpKSx0aGlzLnY9ITAsdGhpcy5nLnNlbmQoYSksdGhpcy52PSExO31jYXRjaChmKXt3ZCh0aGlzLGYpO319O2Z1bmN0aW9uIHlkKGEpe3JldHVybiB5JiZIYSgpJiZcIm51bWJlclwiPT09dHlwZW9mIGEudGltZW91dCYmdm9pZCAwIT09YS5vbnRpbWVvdXR9ay51YT1mdW5jdGlvbigpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiZ0aGlzLmcmJih0aGlzLmo9XCJUaW1lZCBvdXQgYWZ0ZXIgXCIrdGhpcy5CK1wibXMsIGFib3J0aW5nXCIsdGhpcy5tPTgsQyh0aGlzLFwidGltZW91dFwiKSx0aGlzLmFib3J0KDgpKTt9O1xuZnVuY3Rpb24gd2QoYSxiKXthLmg9ITE7YS5nJiYoYS5sPSEwLGEuZy5hYm9ydCgpLGEubD0hMSk7YS5qPWI7YS5tPTU7emQoYSk7QWQoYSk7fWZ1bmN0aW9uIHpkKGEpe2EuRnx8KGEuRj0hMCxDKGEsXCJjb21wbGV0ZVwiKSxDKGEsXCJlcnJvclwiKSk7fWsuYWJvcnQ9ZnVuY3Rpb24oYSl7dGhpcy5nJiZ0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSx0aGlzLm09YXx8NyxDKHRoaXMsXCJjb21wbGV0ZVwiKSxDKHRoaXMsXCJhYm9ydFwiKSxBZCh0aGlzKSk7fTtrLk49ZnVuY3Rpb24oKXt0aGlzLmcmJih0aGlzLmgmJih0aGlzLmg9ITEsdGhpcy5sPSEwLHRoaXMuZy5hYm9ydCgpLHRoaXMubD0hMSksQWQodGhpcywhMCkpO1AuJC5OLmNhbGwodGhpcyk7fTtrLkxhPWZ1bmN0aW9uKCl7dGhpcy5zfHwodGhpcy5HfHx0aGlzLnZ8fHRoaXMubD9CZCh0aGlzKTp0aGlzLmtiKCkpO307ay5rYj1mdW5jdGlvbigpe0JkKHRoaXMpO307XG5mdW5jdGlvbiBCZChhKXtpZihhLmgmJlwidW5kZWZpbmVkXCIhPXR5cGVvZiBnb29nJiYoIWEuQ1sxXXx8NCE9SChhKXx8MiE9YS5kYSgpKSlpZihhLnYmJjQ9PUgoYSkpQWIoYS5MYSwwLGEpO2Vsc2UgaWYoQyhhLFwicmVhZHlzdGF0ZWNoYW5nZVwiKSw0PT1IKGEpKXthLmg9ITE7dHJ5e2NvbnN0IG09YS5kYSgpO2E6c3dpdGNoKG0pe2Nhc2UgMjAwOmNhc2UgMjAxOmNhc2UgMjAyOmNhc2UgMjA0OmNhc2UgMjA2OmNhc2UgMzA0OmNhc2UgMTIyMzp2YXIgYj0hMDticmVhayBhO2RlZmF1bHQ6Yj0hMTt9dmFyIGM7aWYoIShjPWIpKXt2YXIgZDtpZihkPTA9PT1tKXt2YXIgZT1TdHJpbmcoYS5JKS5tYXRjaChNYylbMV18fG51bGw7aWYoIWUmJmwuc2VsZiYmbC5zZWxmLmxvY2F0aW9uKXt2YXIgZj1sLnNlbGYubG9jYXRpb24ucHJvdG9jb2w7ZT1mLnN1YnN0cigwLGYubGVuZ3RoLTEpO31kPSF1ZC50ZXN0KGU/ZS50b0xvd2VyQ2FzZSgpOlwiXCIpO31jPWQ7fWlmKGMpQyhhLFwiY29tcGxldGVcIiksQyhhLFxuXCJzdWNjZXNzXCIpO2Vsc2Uge2EubT02O3RyeXt2YXIgaD0yPEgoYSk/YS5nLnN0YXR1c1RleHQ6XCJcIjt9Y2F0Y2godCl7aD1cIlwiO31hLmo9aCtcIiBbXCIrYS5kYSgpK1wiXVwiO3pkKGEpO319ZmluYWxseXtBZChhKTt9fX1mdW5jdGlvbiBBZChhLGIpe2lmKGEuZyl7eGQoYSk7Y29uc3QgYz1hLmcsZD1hLkNbMF0/YWE6bnVsbDthLmc9bnVsbDthLkM9bnVsbDtifHxDKGEsXCJyZWFkeVwiKTt0cnl7Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9ZDt9Y2F0Y2goZSl7fX19ZnVuY3Rpb24geGQoYSl7YS5nJiZhLkwmJihhLmcub250aW1lb3V0PW51bGwpO2EuQSYmKGwuY2xlYXJUaW1lb3V0KGEuQSksYS5BPW51bGwpO31mdW5jdGlvbiBIKGEpe3JldHVybiBhLmc/YS5nLnJlYWR5U3RhdGU6MH1rLmRhPWZ1bmN0aW9uKCl7dHJ5e3JldHVybiAyPEgodGhpcyk/dGhpcy5nLnN0YXR1czotMX1jYXRjaChhKXtyZXR1cm4gLTF9fTtcbmsuamE9ZnVuY3Rpb24oKXt0cnl7cmV0dXJuIHRoaXMuZz90aGlzLmcucmVzcG9uc2VUZXh0OlwiXCJ9Y2F0Y2goYSl7cmV0dXJuIFwiXCJ9fTtrLldhPWZ1bmN0aW9uKGEpe2lmKHRoaXMuZyl7dmFyIGI9dGhpcy5nLnJlc3BvbnNlVGV4dDthJiYwPT1iLmluZGV4T2YoYSkmJihiPWIuc3Vic3RyaW5nKGEubGVuZ3RoKSk7cmV0dXJuIHNkKGIpfX07ZnVuY3Rpb24gb2MoYSl7dHJ5e2lmKCFhLmcpcmV0dXJuIG51bGw7aWYoXCJyZXNwb25zZVwiaW4gYS5nKXJldHVybiBhLmcucmVzcG9uc2U7c3dpdGNoKGEuSyl7Y2FzZSB0ZDpjYXNlIFwidGV4dFwiOnJldHVybiBhLmcucmVzcG9uc2VUZXh0O2Nhc2UgXCJhcnJheWJ1ZmZlclwiOmlmKFwibW96UmVzcG9uc2VBcnJheUJ1ZmZlclwiaW4gYS5nKXJldHVybiBhLmcubW96UmVzcG9uc2VBcnJheUJ1ZmZlcn1yZXR1cm4gbnVsbH1jYXRjaChiKXtyZXR1cm4gbnVsbH19ay5JYT1mdW5jdGlvbigpe3JldHVybiB0aGlzLm19O1xuay5TYT1mdW5jdGlvbigpe3JldHVybiBcInN0cmluZ1wiPT09dHlwZW9mIHRoaXMuaj90aGlzLmo6U3RyaW5nKHRoaXMuail9O2Z1bmN0aW9uIENkKGEpe2xldCBiPVwiXCI7UmEoYSxmdW5jdGlvbihjLGQpe2IrPWQ7Yis9XCI6XCI7Yis9YztiKz1cIlxcclxcblwiO30pO3JldHVybiBifWZ1bmN0aW9uIERkKGEsYixjKXthOntmb3IoZCBpbiBjKXt2YXIgZD0hMTticmVhayBhfWQ9ITA7fWR8fChjPUNkKGMpLFwic3RyaW5nXCI9PT10eXBlb2YgYT8obnVsbCE9YyYmZW5jb2RlVVJJQ29tcG9uZW50KFN0cmluZyhjKSkpOksoYSxiLGMpKTt9ZnVuY3Rpb24gRWQoYSxiLGMpe3JldHVybiBjJiZjLmludGVybmFsQ2hhbm5lbFBhcmFtcz9jLmludGVybmFsQ2hhbm5lbFBhcmFtc1thXXx8YjpifVxuZnVuY3Rpb24gRmQoYSl7dGhpcy5HYT0wO3RoaXMuaT1bXTt0aGlzLmo9bmV3IEliO3RoaXMub2E9dGhpcy53YT10aGlzLkc9dGhpcy5ZPXRoaXMuZz10aGlzLkRhPXRoaXMuRj10aGlzLm1hPXRoaXMubz10aGlzLlU9dGhpcy5zPW51bGw7dGhpcy5mYj10aGlzLlc9MDt0aGlzLmNiPUVkKFwiZmFpbEZhc3RcIiwhMSxhKTt0aGlzLk09dGhpcy52PXRoaXMudT10aGlzLm09dGhpcy5sPW51bGw7dGhpcy5hYT0hMDt0aGlzLnRhPXRoaXMuRmE9dGhpcy5WPS0xO3RoaXMuYmE9dGhpcy5BPXRoaXMuQz0wO3RoaXMuYWI9RWQoXCJiYXNlUmV0cnlEZWxheU1zXCIsNUUzLGEpO3RoaXMuaGI9RWQoXCJyZXRyeURlbGF5U2VlZE1zXCIsMUU0LGEpO3RoaXMuZWI9RWQoXCJmb3J3YXJkQ2hhbm5lbE1heFJldHJpZXNcIiwyLGEpO3RoaXMueGE9RWQoXCJmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXNcIiwyRTQsYSk7dGhpcy52YT1hJiZhLnhtbEh0dHBGYWN0b3J5fHx2b2lkIDA7dGhpcy5IYT1hJiZhLmRjfHxcbiExO3RoaXMuSz12b2lkIDA7dGhpcy5JPWEmJmEuc3VwcG9ydHNDcm9zc0RvbWFpblhocnx8ITE7dGhpcy5KPVwiXCI7dGhpcy5oPW5ldyBkZChhJiZhLmNvbmN1cnJlbnRSZXF1ZXN0TGltaXQpO3RoaXMuSmE9bmV3IGlkO3RoaXMuUD1hJiZhLmZhc3RIYW5kc2hha2V8fCExO3RoaXMuTz1hJiZhLmVuY29kZUluaXRNZXNzYWdlSGVhZGVyc3x8ITE7dGhpcy5QJiZ0aGlzLk8mJih0aGlzLk89ITEpO3RoaXMuYmI9YSYmYS5iY3x8ITE7YSYmYS5FYSYmdGhpcy5qLkVhKCk7YSYmYS5mb3JjZUxvbmdQb2xsaW5nJiYodGhpcy5hYT0hMSk7dGhpcy5jYT0hdGhpcy5QJiZ0aGlzLmFhJiZhJiZhLmRldGVjdEJ1ZmZlcmluZ1Byb3h5fHwhMTt0aGlzLm5hPXZvaWQgMDt0aGlzLlM9MDt0aGlzLkw9ITE7dGhpcy5wYT10aGlzLkI9bnVsbDt9az1GZC5wcm90b3R5cGU7ay5xYT04O2suSD0xO1xuZnVuY3Rpb24gSWMoYSl7R2QoYSk7aWYoMz09YS5IKXt2YXIgYj1hLlcrKyxjPUcoYS5HKTtLKGMsXCJTSURcIixhLkopO0soYyxcIlJJRFwiLGIpO0soYyxcIlRZUEVcIixcInRlcm1pbmF0ZVwiKTtIZChhLGMpO2I9bmV3IGRjKGEsYS5qLGIsdm9pZCAwKTtiLkw9MjtiLnY9amMoRyhjKSk7Yz0hMTtsLm5hdmlnYXRvciYmbC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbiYmKGM9bC5uYXZpZ2F0b3Iuc2VuZEJlYWNvbihiLnYudG9TdHJpbmcoKSxcIlwiKSk7IWMmJmwuSW1hZ2UmJigobmV3IEltYWdlKS5zcmM9Yi52LGM9ITApO2N8fChiLmc9bmMoYi5sLG51bGwpLGIuZy5oYShiLnYpKTtiLkc9RGF0ZS5ub3coKTtsYyhiKTt9SWQoYSk7fWZ1bmN0aW9uIEFjKGEpe2EuZyYmKHdjKGEpLGEuZy5jYW5jZWwoKSxhLmc9bnVsbCk7fVxuZnVuY3Rpb24gR2QoYSl7QWMoYSk7YS51JiYobC5jbGVhclRpbWVvdXQoYS51KSxhLnU9bnVsbCk7emMoYSk7YS5oLmNhbmNlbCgpO2EubSYmKFwibnVtYmVyXCI9PT10eXBlb2YgYS5tJiZsLmNsZWFyVGltZW91dChhLm0pLGEubT1udWxsKTt9ZnVuY3Rpb24gSGMoYSl7ZmQoYS5oKXx8YS5tfHwoYS5tPSEwLHRiKGEuTmEsYSksYS5DPTApO31mdW5jdGlvbiBKZChhLGIpe2lmKENjKGEuaCk+PWEuaC5qLShhLm0/MTowKSlyZXR1cm4gITE7aWYoYS5tKXJldHVybiBhLmk9Yi5GLmNvbmNhdChhLmkpLCEwO2lmKDE9PWEuSHx8Mj09YS5IfHxhLkM+PShhLmNiPzA6YS5lYikpcmV0dXJuICExO2EubT1UYihxKGEuTmEsYSxiKSxLZChhLGEuQykpO2EuQysrO3JldHVybiAhMH1cbmsuTmE9ZnVuY3Rpb24oYSl7aWYodGhpcy5tKWlmKHRoaXMubT1udWxsLDE9PXRoaXMuSCl7aWYoIWEpe3RoaXMuVz1NYXRoLmZsb29yKDFFNSpNYXRoLnJhbmRvbSgpKTthPXRoaXMuVysrO2NvbnN0IGU9bmV3IGRjKHRoaXMsdGhpcy5qLGEsdm9pZCAwKTtsZXQgZj10aGlzLnM7dGhpcy5VJiYoZj8oZj1TYShmKSxVYShmLHRoaXMuVSkpOmY9dGhpcy5VKTtudWxsIT09dGhpcy5vfHx0aGlzLk98fChlLkk9ZixmPW51bGwpO2lmKHRoaXMuUClhOnt2YXIgYj0wO2Zvcih2YXIgYz0wO2M8dGhpcy5pLmxlbmd0aDtjKyspe2I6e3ZhciBkPXRoaXMuaVtjXTtpZihcIl9fZGF0YV9fXCJpbiBkLmcmJihkPWQuZy5fX2RhdGFfXyxcInN0cmluZ1wiPT09dHlwZW9mIGQpKXtkPWQubGVuZ3RoO2JyZWFrIGJ9ZD12b2lkIDA7fWlmKHZvaWQgMD09PWQpYnJlYWs7Yis9ZDtpZig0MDk2PGIpe2I9YzticmVhayBhfWlmKDQwOTY9PT1ifHxjPT09dGhpcy5pLmxlbmd0aC0xKXtiPWMrMTticmVhayBhfX1iPTFFMzt9ZWxzZSBiPVxuMUUzO2I9TGQodGhpcyxlLGIpO2M9Ryh0aGlzLkcpO0soYyxcIlJJRFwiLGEpO0soYyxcIkNWRVJcIiwyMik7dGhpcy5GJiZLKGMsXCJYLUhUVFAtU2Vzc2lvbi1JZFwiLHRoaXMuRik7SGQodGhpcyxjKTtmJiYodGhpcy5PP2I9XCJoZWFkZXJzPVwiK2VuY29kZVVSSUNvbXBvbmVudChTdHJpbmcoQ2QoZikpKStcIiZcIitiOnRoaXMubyYmRGQoYyx0aGlzLm8sZikpO0RjKHRoaXMuaCxlKTt0aGlzLmJiJiZLKGMsXCJUWVBFXCIsXCJpbml0XCIpO3RoaXMuUD8oSyhjLFwiJHJlcVwiLGIpLEsoYyxcIlNJRFwiLFwibnVsbFwiKSxlLmJhPSEwLGljKGUsYyxudWxsKSk6aWMoZSxjLGIpO3RoaXMuSD0yO319ZWxzZSAzPT10aGlzLkgmJihhP01kKHRoaXMsYSk6MD09dGhpcy5pLmxlbmd0aHx8ZmQodGhpcy5oKXx8TWQodGhpcykpO307XG5mdW5jdGlvbiBNZChhLGIpe3ZhciBjO2I/Yz1iLm06Yz1hLlcrKztjb25zdCBkPUcoYS5HKTtLKGQsXCJTSURcIixhLkopO0soZCxcIlJJRFwiLGMpO0soZCxcIkFJRFwiLGEuVik7SGQoYSxkKTthLm8mJmEucyYmRGQoZCxhLm8sYS5zKTtjPW5ldyBkYyhhLGEuaixjLGEuQysxKTtudWxsPT09YS5vJiYoYy5JPWEucyk7YiYmKGEuaT1iLkYuY29uY2F0KGEuaSkpO2I9TGQoYSxjLDFFMyk7Yy5zZXRUaW1lb3V0KE1hdGgucm91bmQoLjUqYS54YSkrTWF0aC5yb3VuZCguNSphLnhhKk1hdGgucmFuZG9tKCkpKTtEYyhhLmgsYyk7aWMoYyxkLGIpO31mdW5jdGlvbiBIZChhLGIpe2EubWEmJlJhKGEubWEsZnVuY3Rpb24oYyxkKXtLKGIsZCxjKTt9KTthLmwmJkxjKHt9LGZ1bmN0aW9uKGMsZCl7SyhiLGQsYyk7fSk7fVxuZnVuY3Rpb24gTGQoYSxiLGMpe2M9TWF0aC5taW4oYS5pLmxlbmd0aCxjKTt2YXIgZD1hLmw/cShhLmwuVmEsYS5sLGEpOm51bGw7YTp7dmFyIGU9YS5pO2xldCBmPS0xO2Zvcig7Oyl7Y29uc3QgaD1bXCJjb3VudD1cIitjXTstMT09Zj8wPGM/KGY9ZVswXS5oLGgucHVzaChcIm9mcz1cIitmKSk6Zj0wOmgucHVzaChcIm9mcz1cIitmKTtsZXQgbT0hMDtmb3IobGV0IHQ9MDt0PGM7dCsrKXtsZXQgbj1lW3RdLmg7Y29uc3QgdT1lW3RdLmc7bi09ZjtpZigwPm4pZj1NYXRoLm1heCgwLGVbdF0uaC0xMDApLG09ITE7ZWxzZSB0cnl7amQodSxoLFwicmVxXCIrbitcIl9cIik7fWNhdGNoKEwpe2QmJmQodSk7fX1pZihtKXtkPWguam9pbihcIiZcIik7YnJlYWsgYX19fWE9YS5pLnNwbGljZSgwLGMpO2IuRj1hO3JldHVybiBkfWZ1bmN0aW9uIEdjKGEpe2EuZ3x8YS51fHwoYS5iYT0xLHRiKGEuTWEsYSksYS5BPTApO31cbmZ1bmN0aW9uIEJjKGEpe2lmKGEuZ3x8YS51fHwzPD1hLkEpcmV0dXJuICExO2EuYmErKzthLnU9VGIocShhLk1hLGEpLEtkKGEsYS5BKSk7YS5BKys7cmV0dXJuICEwfWsuTWE9ZnVuY3Rpb24oKXt0aGlzLnU9bnVsbDtOZCh0aGlzKTtpZih0aGlzLmNhJiYhKHRoaXMuTHx8bnVsbD09dGhpcy5nfHwwPj10aGlzLlMpKXt2YXIgYT0yKnRoaXMuUzt0aGlzLmouaW5mbyhcIkJQIGRldGVjdGlvbiB0aW1lciBlbmFibGVkOiBcIithKTt0aGlzLkI9VGIocSh0aGlzLmpiLHRoaXMpLGEpO319O2suamI9ZnVuY3Rpb24oKXt0aGlzLkImJih0aGlzLkI9bnVsbCx0aGlzLmouaW5mbyhcIkJQIGRldGVjdGlvbiB0aW1lb3V0IHJlYWNoZWQuXCIpLHRoaXMuai5pbmZvKFwiQnVmZmVyaW5nIHByb3h5IGRldGVjdGVkIGFuZCBzd2l0Y2ggdG8gbG9uZy1wb2xsaW5nIVwiKSx0aGlzLk09ITEsdGhpcy5MPSEwLEYoMTApLEFjKHRoaXMpLE5kKHRoaXMpKTt9O1xuZnVuY3Rpb24gd2MoYSl7bnVsbCE9YS5CJiYobC5jbGVhclRpbWVvdXQoYS5CKSxhLkI9bnVsbCk7fWZ1bmN0aW9uIE5kKGEpe2EuZz1uZXcgZGMoYSxhLmosXCJycGNcIixhLmJhKTtudWxsPT09YS5vJiYoYS5nLkk9YS5zKTthLmcuTz0wO3ZhciBiPUcoYS53YSk7SyhiLFwiUklEXCIsXCJycGNcIik7SyhiLFwiU0lEXCIsYS5KKTtLKGIsXCJDSVwiLGEuTT9cIjBcIjpcIjFcIik7SyhiLFwiQUlEXCIsYS5WKTtLKGIsXCJUWVBFXCIsXCJ4bWxodHRwXCIpO0hkKGEsYik7YS5vJiZhLnMmJkRkKGIsYS5vLGEucyk7YS5LJiZhLmcuc2V0VGltZW91dChhLkspO3ZhciBjPWEuZzthPWEub2E7Yy5MPTE7Yy52PWpjKEcoYikpO2Mucz1udWxsO2MuUz0hMDtrYyhjLGEpO31rLmliPWZ1bmN0aW9uKCl7bnVsbCE9dGhpcy52JiYodGhpcy52PW51bGwsQWModGhpcyksQmModGhpcyksRigxOSkpO307ZnVuY3Rpb24gemMoYSl7bnVsbCE9YS52JiYobC5jbGVhclRpbWVvdXQoYS52KSxhLnY9bnVsbCk7fVxuZnVuY3Rpb24gdWMoYSxiKXt2YXIgYz1udWxsO2lmKGEuZz09Yil7emMoYSk7d2MoYSk7YS5nPW51bGw7dmFyIGQ9Mjt9ZWxzZSBpZih5YyhhLmgsYikpYz1iLkYsRmMoYS5oLGIpLGQ9MTtlbHNlIHJldHVybjtpZigwIT1hLkgpaWYoYS50YT1iLmFhLGIuaSlpZigxPT1kKXtjPWIucz9iLnMubGVuZ3RoOjA7Yj1EYXRlLm5vdygpLWIuRzt2YXIgZT1hLkM7ZD1PYigpO0MoZCxuZXcgU2IoZCxjKSk7SGMoYSk7fWVsc2UgR2MoYSk7ZWxzZSBpZihlPWIubywzPT1lfHwwPT1lJiYwPGEudGF8fCEoMT09ZCYmSmQoYSxiKXx8Mj09ZCYmQmMoYSkpKXN3aXRjaChjJiYwPGMubGVuZ3RoJiYoYj1hLmgsYi5pPWIuaS5jb25jYXQoYykpLGUpe2Nhc2UgMTpKKGEsNSk7YnJlYWs7Y2FzZSA0OkooYSwxMCk7YnJlYWs7Y2FzZSAzOkooYSw2KTticmVhaztkZWZhdWx0OkooYSwyKTt9fVxuZnVuY3Rpb24gS2QoYSxiKXtsZXQgYz1hLmFiK01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSphLmhiKTthLmx8fChjKj0yKTtyZXR1cm4gYypifWZ1bmN0aW9uIEooYSxiKXthLmouaW5mbyhcIkVycm9yIGNvZGUgXCIrYik7aWYoMj09Yil7dmFyIGM9bnVsbDthLmwmJihjPW51bGwpO3ZhciBkPXEoYS5wYixhKTtjfHwoYz1uZXcgTShcIi8vd3d3Lmdvb2dsZS5jb20vaW1hZ2VzL2NsZWFyZG90LmdpZlwiKSxsLmxvY2F0aW9uJiZcImh0dHBcIj09bC5sb2NhdGlvbi5wcm90b2NvbHx8T2MoYyxcImh0dHBzXCIpLGpjKGMpKTtrZChjLnRvU3RyaW5nKCksZCk7fWVsc2UgRigyKTthLkg9MDthLmwmJmEubC56YShiKTtJZChhKTtHZChhKTt9ay5wYj1mdW5jdGlvbihhKXthPyh0aGlzLmouaW5mbyhcIlN1Y2Nlc3NmdWxseSBwaW5nZWQgZ29vZ2xlLmNvbVwiKSxGKDIpKToodGhpcy5qLmluZm8oXCJGYWlsZWQgdG8gcGluZyBnb29nbGUuY29tXCIpLEYoMSkpO307XG5mdW5jdGlvbiBJZChhKXthLkg9MDthLnBhPVtdO2lmKGEubCl7Y29uc3QgYj1nZChhLmgpO2lmKDAhPWIubGVuZ3RofHwwIT1hLmkubGVuZ3RoKW9hKGEucGEsYiksb2EoYS5wYSxhLmkpLGEuaC5pLmxlbmd0aD0wLG5hKGEuaSksYS5pLmxlbmd0aD0wO2EubC55YSgpO319ZnVuY3Rpb24gRWMoYSxiLGMpe3ZhciBkPWMgaW5zdGFuY2VvZiBNP0coYyk6bmV3IE0oYyx2b2lkIDApO2lmKFwiXCIhPWQuZyliJiYoZC5nPWIrXCIuXCIrZC5nKSxQYyhkLGQubSk7ZWxzZSB7dmFyIGU9bC5sb2NhdGlvbjtkPWUucHJvdG9jb2w7Yj1iP2IrXCIuXCIrZS5ob3N0bmFtZTplLmhvc3RuYW1lO2U9K2UucG9ydDt2YXIgZj1uZXcgTShudWxsLHZvaWQgMCk7ZCYmT2MoZixkKTtiJiYoZi5nPWIpO2UmJlBjKGYsZSk7YyYmKGYubD1jKTtkPWY7fWM9YS5GO2I9YS5EYTtjJiZiJiZLKGQsYyxiKTtLKGQsXCJWRVJcIixhLnFhKTtIZChhLGQpO3JldHVybiBkfVxuZnVuY3Rpb24gbmMoYSxiLGMpe2lmKGImJiFhLkkpdGhyb3cgRXJyb3IoXCJDYW4ndCBjcmVhdGUgc2Vjb25kYXJ5IGRvbWFpbiBjYXBhYmxlIFhocklvIG9iamVjdC5cIik7Yj1jJiZhLkhhJiYhYS52YT9uZXcgUChuZXcgbWQoe29iOiEwfSkpOm5ldyBQKGEudmEpO2IuT2EoYS5JKTtyZXR1cm4gYn1mdW5jdGlvbiBPZCgpe31rPU9kLnByb3RvdHlwZTtrLkJhPWZ1bmN0aW9uKCl7fTtrLkFhPWZ1bmN0aW9uKCl7fTtrLnphPWZ1bmN0aW9uKCl7fTtrLnlhPWZ1bmN0aW9uKCl7fTtrLlZhPWZ1bmN0aW9uKCl7fTtmdW5jdGlvbiBQZCgpe2lmKHkmJiEoMTA8PU51bWJlcihLYSkpKXRocm93IEVycm9yKFwiRW52aXJvbm1lbnRhbCBlcnJvcjogbm8gYXZhaWxhYmxlIHRyYW5zcG9ydC5cIik7fVBkLnByb3RvdHlwZS5nPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBRKGEsYil9O1xuZnVuY3Rpb24gUShhLGIpe0IuY2FsbCh0aGlzKTt0aGlzLmc9bmV3IEZkKGIpO3RoaXMubD1hO3RoaXMuaD1iJiZiLm1lc3NhZ2VVcmxQYXJhbXN8fG51bGw7YT1iJiZiLm1lc3NhZ2VIZWFkZXJzfHxudWxsO2ImJmIuY2xpZW50UHJvdG9jb2xIZWFkZXJSZXF1aXJlZCYmKGE/YVtcIlgtQ2xpZW50LVByb3RvY29sXCJdPVwid2ViY2hhbm5lbFwiOmE9e1wiWC1DbGllbnQtUHJvdG9jb2xcIjpcIndlYmNoYW5uZWxcIn0pO3RoaXMuZy5zPWE7YT1iJiZiLmluaXRNZXNzYWdlSGVhZGVyc3x8bnVsbDtiJiZiLm1lc3NhZ2VDb250ZW50VHlwZSYmKGE/YVtcIlgtV2ViQ2hhbm5lbC1Db250ZW50LVR5cGVcIl09Yi5tZXNzYWdlQ29udGVudFR5cGU6YT17XCJYLVdlYkNoYW5uZWwtQ29udGVudC1UeXBlXCI6Yi5tZXNzYWdlQ29udGVudFR5cGV9KTtiJiZiLkNhJiYoYT9hW1wiWC1XZWJDaGFubmVsLUNsaWVudC1Qcm9maWxlXCJdPWIuQ2E6YT17XCJYLVdlYkNoYW5uZWwtQ2xpZW50LVByb2ZpbGVcIjpiLkNhfSk7dGhpcy5nLlU9XG5hOyhhPWImJmIuY2MpJiYhcWEoYSkmJih0aGlzLmcubz1hKTt0aGlzLkE9YiYmYi5zdXBwb3J0c0Nyb3NzRG9tYWluWGhyfHwhMTt0aGlzLnY9YiYmYi5zZW5kUmF3SnNvbnx8ITE7KGI9YiYmYi5odHRwU2Vzc2lvbklkUGFyYW0pJiYhcWEoYikmJih0aGlzLmcuRj1iLGE9dGhpcy5oLG51bGwhPT1hJiZiIGluIGEmJihhPXRoaXMuaCxiIGluIGEmJmRlbGV0ZSBhW2JdKSk7dGhpcy5qPW5ldyBSKHRoaXMpO31yKFEsQik7US5wcm90b3R5cGUubT1mdW5jdGlvbigpe3RoaXMuZy5sPXRoaXMuajt0aGlzLkEmJih0aGlzLmcuST0hMCk7dmFyIGE9dGhpcy5nLGI9dGhpcy5sLGM9dGhpcy5ofHx2b2lkIDA7RigwKTthLlk9YjthLm1hPWN8fHt9O2EuTT1hLmFhO2EuRz1FYyhhLG51bGwsYS5ZKTtIYyhhKTt9O1EucHJvdG90eXBlLmNsb3NlPWZ1bmN0aW9uKCl7SWModGhpcy5nKTt9O1xuUS5wcm90b3R5cGUudT1mdW5jdGlvbihhKXt2YXIgYj10aGlzLmc7aWYoXCJzdHJpbmdcIj09PXR5cGVvZiBhKXt2YXIgYz17fTtjLl9fZGF0YV9fPWE7YT1jO31lbHNlIHRoaXMudiYmKGM9e30sYy5fX2RhdGFfXz1tYihhKSxhPWMpO2IuaS5wdXNoKG5ldyBjZChiLmZiKyssYSkpOzM9PWIuSCYmSGMoYik7fTtRLnByb3RvdHlwZS5OPWZ1bmN0aW9uKCl7dGhpcy5nLmw9bnVsbDtkZWxldGUgdGhpcy5qO0ljKHRoaXMuZyk7ZGVsZXRlIHRoaXMuZztRLiQuTi5jYWxsKHRoaXMpO307ZnVuY3Rpb24gUWQoYSl7JGIuY2FsbCh0aGlzKTt2YXIgYj1hLl9fc21fXztpZihiKXthOntmb3IoY29uc3QgYyBpbiBiKXthPWM7YnJlYWsgYX1hPXZvaWQgMDt9aWYodGhpcy5pPWEpYT10aGlzLmksYj1udWxsIT09YiYmYSBpbiBiP2JbYV06dm9pZCAwO3RoaXMuZGF0YT1iO31lbHNlIHRoaXMuZGF0YT1hO31yKFFkLCRiKTtmdW5jdGlvbiBSZCgpe2FjLmNhbGwodGhpcyk7dGhpcy5zdGF0dXM9MTt9cihSZCxhYyk7XG5mdW5jdGlvbiBSKGEpe3RoaXMuZz1hO31yKFIsT2QpO1IucHJvdG90eXBlLkJhPWZ1bmN0aW9uKCl7Qyh0aGlzLmcsXCJhXCIpO307Ui5wcm90b3R5cGUuQWE9ZnVuY3Rpb24oYSl7Qyh0aGlzLmcsbmV3IFFkKGEpKTt9O1IucHJvdG90eXBlLnphPWZ1bmN0aW9uKGEpe0ModGhpcy5nLG5ldyBSZCgpKTt9O1IucHJvdG90eXBlLnlhPWZ1bmN0aW9uKCl7Qyh0aGlzLmcsXCJiXCIpO307ZnVuY3Rpb24gU2QoKXt0aGlzLmJsb2NrU2l6ZT0tMTt9ZnVuY3Rpb24gUygpe3RoaXMuYmxvY2tTaXplPS0xO3RoaXMuYmxvY2tTaXplPTY0O3RoaXMuZz1BcnJheSg0KTt0aGlzLm09QXJyYXkodGhpcy5ibG9ja1NpemUpO3RoaXMuaT10aGlzLmg9MDt0aGlzLnJlc2V0KCk7fXIoUyxTZCk7Uy5wcm90b3R5cGUucmVzZXQ9ZnVuY3Rpb24oKXt0aGlzLmdbMF09MTczMjU4NDE5Mzt0aGlzLmdbMV09NDAyMzIzMzQxNzt0aGlzLmdbMl09MjU2MjM4MzEwMjt0aGlzLmdbM109MjcxNzMzODc4O3RoaXMuaT10aGlzLmg9MDt9O1xuZnVuY3Rpb24gVGQoYSxiLGMpe2N8fChjPTApO3ZhciBkPUFycmF5KDE2KTtpZihcInN0cmluZ1wiPT09dHlwZW9mIGIpZm9yKHZhciBlPTA7MTY+ZTsrK2UpZFtlXT1iLmNoYXJDb2RlQXQoYysrKXxiLmNoYXJDb2RlQXQoYysrKTw8OHxiLmNoYXJDb2RlQXQoYysrKTw8MTZ8Yi5jaGFyQ29kZUF0KGMrKyk8PDI0O2Vsc2UgZm9yKGU9MDsxNj5lOysrZSlkW2VdPWJbYysrXXxiW2MrK108PDh8YltjKytdPDwxNnxiW2MrK108PDI0O2I9YS5nWzBdO2M9YS5nWzFdO2U9YS5nWzJdO3ZhciBmPWEuZ1szXTt2YXIgaD1iKyhmXmMmKGVeZikpK2RbMF0rMzYxNDA5MDM2MCY0Mjk0OTY3Mjk1O2I9YysoaDw8NyY0Mjk0OTY3Mjk1fGg+Pj4yNSk7aD1mKyhlXmImKGNeZSkpK2RbMV0rMzkwNTQwMjcxMCY0Mjk0OTY3Mjk1O2Y9YisoaDw8MTImNDI5NDk2NzI5NXxoPj4+MjApO2g9ZSsoY15mJihiXmMpKStkWzJdKzYwNjEwNTgxOSY0Mjk0OTY3Mjk1O2U9ZisoaDw8MTcmNDI5NDk2NzI5NXxoPj4+MTUpO1xuaD1jKyhiXmUmKGZeYikpK2RbM10rMzI1MDQ0MTk2NiY0Mjk0OTY3Mjk1O2M9ZSsoaDw8MjImNDI5NDk2NzI5NXxoPj4+MTApO2g9YisoZl5jJihlXmYpKStkWzRdKzQxMTg1NDgzOTkmNDI5NDk2NzI5NTtiPWMrKGg8PDcmNDI5NDk2NzI5NXxoPj4+MjUpO2g9ZisoZV5iJihjXmUpKStkWzVdKzEyMDAwODA0MjYmNDI5NDk2NzI5NTtmPWIrKGg8PDEyJjQyOTQ5NjcyOTV8aD4+PjIwKTtoPWUrKGNeZiYoYl5jKSkrZFs2XSsyODIxNzM1OTU1JjQyOTQ5NjcyOTU7ZT1mKyhoPDwxNyY0Mjk0OTY3Mjk1fGg+Pj4xNSk7aD1jKyhiXmUmKGZeYikpK2RbN10rNDI0OTI2MTMxMyY0Mjk0OTY3Mjk1O2M9ZSsoaDw8MjImNDI5NDk2NzI5NXxoPj4+MTApO2g9YisoZl5jJihlXmYpKStkWzhdKzE3NzAwMzU0MTYmNDI5NDk2NzI5NTtiPWMrKGg8PDcmNDI5NDk2NzI5NXxoPj4+MjUpO2g9ZisoZV5iJihjXmUpKStkWzldKzIzMzY1NTI4NzkmNDI5NDk2NzI5NTtmPWIrKGg8PDEyJjQyOTQ5NjcyOTV8XG5oPj4+MjApO2g9ZSsoY15mJihiXmMpKStkWzEwXSs0Mjk0OTI1MjMzJjQyOTQ5NjcyOTU7ZT1mKyhoPDwxNyY0Mjk0OTY3Mjk1fGg+Pj4xNSk7aD1jKyhiXmUmKGZeYikpK2RbMTFdKzIzMDQ1NjMxMzQmNDI5NDk2NzI5NTtjPWUrKGg8PDIyJjQyOTQ5NjcyOTV8aD4+PjEwKTtoPWIrKGZeYyYoZV5mKSkrZFsxMl0rMTgwNDYwMzY4MiY0Mjk0OTY3Mjk1O2I9YysoaDw8NyY0Mjk0OTY3Mjk1fGg+Pj4yNSk7aD1mKyhlXmImKGNeZSkpK2RbMTNdKzQyNTQ2MjYxOTUmNDI5NDk2NzI5NTtmPWIrKGg8PDEyJjQyOTQ5NjcyOTV8aD4+PjIwKTtoPWUrKGNeZiYoYl5jKSkrZFsxNF0rMjc5Mjk2NTAwNiY0Mjk0OTY3Mjk1O2U9ZisoaDw8MTcmNDI5NDk2NzI5NXxoPj4+MTUpO2g9YysoYl5lJihmXmIpKStkWzE1XSsxMjM2NTM1MzI5JjQyOTQ5NjcyOTU7Yz1lKyhoPDwyMiY0Mjk0OTY3Mjk1fGg+Pj4xMCk7aD1iKyhlXmYmKGNeZSkpK2RbMV0rNDEyOTE3MDc4NiY0Mjk0OTY3Mjk1O2I9YysoaDw8XG41JjQyOTQ5NjcyOTV8aD4+PjI3KTtoPWYrKGNeZSYoYl5jKSkrZFs2XSszMjI1NDY1NjY0JjQyOTQ5NjcyOTU7Zj1iKyhoPDw5JjQyOTQ5NjcyOTV8aD4+PjIzKTtoPWUrKGJeYyYoZl5iKSkrZFsxMV0rNjQzNzE3NzEzJjQyOTQ5NjcyOTU7ZT1mKyhoPDwxNCY0Mjk0OTY3Mjk1fGg+Pj4xOCk7aD1jKyhmXmImKGVeZikpK2RbMF0rMzkyMTA2OTk5NCY0Mjk0OTY3Mjk1O2M9ZSsoaDw8MjAmNDI5NDk2NzI5NXxoPj4+MTIpO2g9YisoZV5mJihjXmUpKStkWzVdKzM1OTM0MDg2MDUmNDI5NDk2NzI5NTtiPWMrKGg8PDUmNDI5NDk2NzI5NXxoPj4+MjcpO2g9ZisoY15lJihiXmMpKStkWzEwXSszODAxNjA4MyY0Mjk0OTY3Mjk1O2Y9YisoaDw8OSY0Mjk0OTY3Mjk1fGg+Pj4yMyk7aD1lKyhiXmMmKGZeYikpK2RbMTVdKzM2MzQ0ODg5NjEmNDI5NDk2NzI5NTtlPWYrKGg8PDE0JjQyOTQ5NjcyOTV8aD4+PjE4KTtoPWMrKGZeYiYoZV5mKSkrZFs0XSszODg5NDI5NDQ4JjQyOTQ5NjcyOTU7Yz1cbmUrKGg8PDIwJjQyOTQ5NjcyOTV8aD4+PjEyKTtoPWIrKGVeZiYoY15lKSkrZFs5XSs1Njg0NDY0MzgmNDI5NDk2NzI5NTtiPWMrKGg8PDUmNDI5NDk2NzI5NXxoPj4+MjcpO2g9ZisoY15lJihiXmMpKStkWzE0XSszMjc1MTYzNjA2JjQyOTQ5NjcyOTU7Zj1iKyhoPDw5JjQyOTQ5NjcyOTV8aD4+PjIzKTtoPWUrKGJeYyYoZl5iKSkrZFszXSs0MTA3NjAzMzM1JjQyOTQ5NjcyOTU7ZT1mKyhoPDwxNCY0Mjk0OTY3Mjk1fGg+Pj4xOCk7aD1jKyhmXmImKGVeZikpK2RbOF0rMTE2MzUzMTUwMSY0Mjk0OTY3Mjk1O2M9ZSsoaDw8MjAmNDI5NDk2NzI5NXxoPj4+MTIpO2g9YisoZV5mJihjXmUpKStkWzEzXSsyODUwMjg1ODI5JjQyOTQ5NjcyOTU7Yj1jKyhoPDw1JjQyOTQ5NjcyOTV8aD4+PjI3KTtoPWYrKGNeZSYoYl5jKSkrZFsyXSs0MjQzNTYzNTEyJjQyOTQ5NjcyOTU7Zj1iKyhoPDw5JjQyOTQ5NjcyOTV8aD4+PjIzKTtoPWUrKGJeYyYoZl5iKSkrZFs3XSsxNzM1MzI4NDczJjQyOTQ5NjcyOTU7XG5lPWYrKGg8PDE0JjQyOTQ5NjcyOTV8aD4+PjE4KTtoPWMrKGZeYiYoZV5mKSkrZFsxMl0rMjM2ODM1OTU2MiY0Mjk0OTY3Mjk1O2M9ZSsoaDw8MjAmNDI5NDk2NzI5NXxoPj4+MTIpO2g9YisoY15lXmYpK2RbNV0rNDI5NDU4ODczOCY0Mjk0OTY3Mjk1O2I9YysoaDw8NCY0Mjk0OTY3Mjk1fGg+Pj4yOCk7aD1mKyhiXmNeZSkrZFs4XSsyMjcyMzkyODMzJjQyOTQ5NjcyOTU7Zj1iKyhoPDwxMSY0Mjk0OTY3Mjk1fGg+Pj4yMSk7aD1lKyhmXmJeYykrZFsxMV0rMTgzOTAzMDU2MiY0Mjk0OTY3Mjk1O2U9ZisoaDw8MTYmNDI5NDk2NzI5NXxoPj4+MTYpO2g9YysoZV5mXmIpK2RbMTRdKzQyNTk2NTc3NDAmNDI5NDk2NzI5NTtjPWUrKGg8PDIzJjQyOTQ5NjcyOTV8aD4+PjkpO2g9YisoY15lXmYpK2RbMV0rMjc2Mzk3NTIzNiY0Mjk0OTY3Mjk1O2I9YysoaDw8NCY0Mjk0OTY3Mjk1fGg+Pj4yOCk7aD1mKyhiXmNeZSkrZFs0XSsxMjcyODkzMzUzJjQyOTQ5NjcyOTU7Zj1iKyhoPDwxMSY0Mjk0OTY3Mjk1fFxuaD4+PjIxKTtoPWUrKGZeYl5jKStkWzddKzQxMzk0Njk2NjQmNDI5NDk2NzI5NTtlPWYrKGg8PDE2JjQyOTQ5NjcyOTV8aD4+PjE2KTtoPWMrKGVeZl5iKStkWzEwXSszMjAwMjM2NjU2JjQyOTQ5NjcyOTU7Yz1lKyhoPDwyMyY0Mjk0OTY3Mjk1fGg+Pj45KTtoPWIrKGNeZV5mKStkWzEzXSs2ODEyNzkxNzQmNDI5NDk2NzI5NTtiPWMrKGg8PDQmNDI5NDk2NzI5NXxoPj4+MjgpO2g9ZisoYl5jXmUpK2RbMF0rMzkzNjQzMDA3NCY0Mjk0OTY3Mjk1O2Y9YisoaDw8MTEmNDI5NDk2NzI5NXxoPj4+MjEpO2g9ZSsoZl5iXmMpK2RbM10rMzU3MjQ0NTMxNyY0Mjk0OTY3Mjk1O2U9ZisoaDw8MTYmNDI5NDk2NzI5NXxoPj4+MTYpO2g9YysoZV5mXmIpK2RbNl0rNzYwMjkxODkmNDI5NDk2NzI5NTtjPWUrKGg8PDIzJjQyOTQ5NjcyOTV8aD4+PjkpO2g9YisoY15lXmYpK2RbOV0rMzY1NDYwMjgwOSY0Mjk0OTY3Mjk1O2I9YysoaDw8NCY0Mjk0OTY3Mjk1fGg+Pj4yOCk7aD1mKyhiXmNeZSkrZFsxMl0rXG4zODczMTUxNDYxJjQyOTQ5NjcyOTU7Zj1iKyhoPDwxMSY0Mjk0OTY3Mjk1fGg+Pj4yMSk7aD1lKyhmXmJeYykrZFsxNV0rNTMwNzQyNTIwJjQyOTQ5NjcyOTU7ZT1mKyhoPDwxNiY0Mjk0OTY3Mjk1fGg+Pj4xNik7aD1jKyhlXmZeYikrZFsyXSszMjk5NjI4NjQ1JjQyOTQ5NjcyOTU7Yz1lKyhoPDwyMyY0Mjk0OTY3Mjk1fGg+Pj45KTtoPWIrKGVeKGN8fmYpKStkWzBdKzQwOTYzMzY0NTImNDI5NDk2NzI5NTtiPWMrKGg8PDYmNDI5NDk2NzI5NXxoPj4+MjYpO2g9ZisoY14oYnx+ZSkpK2RbN10rMTEyNjg5MTQxNSY0Mjk0OTY3Mjk1O2Y9YisoaDw8MTAmNDI5NDk2NzI5NXxoPj4+MjIpO2g9ZSsoYl4oZnx+YykpK2RbMTRdKzI4Nzg2MTIzOTEmNDI5NDk2NzI5NTtlPWYrKGg8PDE1JjQyOTQ5NjcyOTV8aD4+PjE3KTtoPWMrKGZeKGV8fmIpKStkWzVdKzQyMzc1MzMyNDEmNDI5NDk2NzI5NTtjPWUrKGg8PDIxJjQyOTQ5NjcyOTV8aD4+PjExKTtoPWIrKGVeKGN8fmYpKStkWzEyXSsxNzAwNDg1NTcxJlxuNDI5NDk2NzI5NTtiPWMrKGg8PDYmNDI5NDk2NzI5NXxoPj4+MjYpO2g9ZisoY14oYnx+ZSkpK2RbM10rMjM5OTk4MDY5MCY0Mjk0OTY3Mjk1O2Y9YisoaDw8MTAmNDI5NDk2NzI5NXxoPj4+MjIpO2g9ZSsoYl4oZnx+YykpK2RbMTBdKzQyOTM5MTU3NzMmNDI5NDk2NzI5NTtlPWYrKGg8PDE1JjQyOTQ5NjcyOTV8aD4+PjE3KTtoPWMrKGZeKGV8fmIpKStkWzFdKzIyNDAwNDQ0OTcmNDI5NDk2NzI5NTtjPWUrKGg8PDIxJjQyOTQ5NjcyOTV8aD4+PjExKTtoPWIrKGVeKGN8fmYpKStkWzhdKzE4NzMzMTMzNTkmNDI5NDk2NzI5NTtiPWMrKGg8PDYmNDI5NDk2NzI5NXxoPj4+MjYpO2g9ZisoY14oYnx+ZSkpK2RbMTVdKzQyNjQzNTU1NTImNDI5NDk2NzI5NTtmPWIrKGg8PDEwJjQyOTQ5NjcyOTV8aD4+PjIyKTtoPWUrKGJeKGZ8fmMpKStkWzZdKzI3MzQ3Njg5MTYmNDI5NDk2NzI5NTtlPWYrKGg8PDE1JjQyOTQ5NjcyOTV8aD4+PjE3KTtoPWMrKGZeKGV8fmIpKStkWzEzXSsxMzA5MTUxNjQ5JlxuNDI5NDk2NzI5NTtjPWUrKGg8PDIxJjQyOTQ5NjcyOTV8aD4+PjExKTtoPWIrKGVeKGN8fmYpKStkWzRdKzQxNDk0NDQyMjYmNDI5NDk2NzI5NTtiPWMrKGg8PDYmNDI5NDk2NzI5NXxoPj4+MjYpO2g9ZisoY14oYnx+ZSkpK2RbMTFdKzMxNzQ3NTY5MTcmNDI5NDk2NzI5NTtmPWIrKGg8PDEwJjQyOTQ5NjcyOTV8aD4+PjIyKTtoPWUrKGJeKGZ8fmMpKStkWzJdKzcxODc4NzI1OSY0Mjk0OTY3Mjk1O2U9ZisoaDw8MTUmNDI5NDk2NzI5NXxoPj4+MTcpO2g9YysoZl4oZXx+YikpK2RbOV0rMzk1MTQ4MTc0NSY0Mjk0OTY3Mjk1O2EuZ1swXT1hLmdbMF0rYiY0Mjk0OTY3Mjk1O2EuZ1sxXT1hLmdbMV0rKGUrKGg8PDIxJjQyOTQ5NjcyOTV8aD4+PjExKSkmNDI5NDk2NzI5NTthLmdbMl09YS5nWzJdK2UmNDI5NDk2NzI5NTthLmdbM109YS5nWzNdK2YmNDI5NDk2NzI5NTt9XG5TLnByb3RvdHlwZS5qPWZ1bmN0aW9uKGEsYil7dm9pZCAwPT09YiYmKGI9YS5sZW5ndGgpO2Zvcih2YXIgYz1iLXRoaXMuYmxvY2tTaXplLGQ9dGhpcy5tLGU9dGhpcy5oLGY9MDtmPGI7KXtpZigwPT1lKWZvcig7Zjw9YzspVGQodGhpcyxhLGYpLGYrPXRoaXMuYmxvY2tTaXplO2lmKFwic3RyaW5nXCI9PT10eXBlb2YgYSlmb3IoO2Y8Yjspe2lmKGRbZSsrXT1hLmNoYXJDb2RlQXQoZisrKSxlPT10aGlzLmJsb2NrU2l6ZSl7VGQodGhpcyxkKTtlPTA7YnJlYWt9fWVsc2UgZm9yKDtmPGI7KWlmKGRbZSsrXT1hW2YrK10sZT09dGhpcy5ibG9ja1NpemUpe1RkKHRoaXMsZCk7ZT0wO2JyZWFrfX10aGlzLmg9ZTt0aGlzLmkrPWI7fTtcblMucHJvdG90eXBlLmw9ZnVuY3Rpb24oKXt2YXIgYT1BcnJheSgoNTY+dGhpcy5oP3RoaXMuYmxvY2tTaXplOjIqdGhpcy5ibG9ja1NpemUpLXRoaXMuaCk7YVswXT0xMjg7Zm9yKHZhciBiPTE7YjxhLmxlbmd0aC04OysrYilhW2JdPTA7dmFyIGM9OCp0aGlzLmk7Zm9yKGI9YS5sZW5ndGgtODtiPGEubGVuZ3RoOysrYilhW2JdPWMmMjU1LGMvPTI1Njt0aGlzLmooYSk7YT1BcnJheSgxNik7Zm9yKGI9Yz0wOzQ+YjsrK2IpZm9yKHZhciBkPTA7MzI+ZDtkKz04KWFbYysrXT10aGlzLmdbYl0+Pj5kJjI1NTtyZXR1cm4gYX07ZnVuY3Rpb24gVChhLGIpe3RoaXMuaD1iO2Zvcih2YXIgYz1bXSxkPSEwLGU9YS5sZW5ndGgtMTswPD1lO2UtLSl7dmFyIGY9YVtlXXwwO2QmJmY9PWJ8fChjW2VdPWYsZD0hMSk7fXRoaXMuZz1jO312YXIgVWQ9e307ZnVuY3Rpb24gVmQoYSl7cmV0dXJuIC0xMjg8PWEmJjEyOD5hP3ZhKFVkLGEsZnVuY3Rpb24oYil7cmV0dXJuIG5ldyBUKFtifDBdLDA+Yj8tMTowKX0pOm5ldyBUKFthfDBdLDA+YT8tMTowKX1mdW5jdGlvbiBVKGEpe2lmKGlzTmFOKGEpfHwhaXNGaW5pdGUoYSkpcmV0dXJuIFY7aWYoMD5hKXJldHVybiBXKFUoLWEpKTtmb3IodmFyIGI9W10sYz0xLGQ9MDthPj1jO2QrKyliW2RdPWEvY3wwLGMqPVdkO3JldHVybiBuZXcgVChiLDApfVxuZnVuY3Rpb24gWGQoYSxiKXtpZigwPT1hLmxlbmd0aCl0aHJvdyBFcnJvcihcIm51bWJlciBmb3JtYXQgZXJyb3I6IGVtcHR5IHN0cmluZ1wiKTtiPWJ8fDEwO2lmKDI+Ynx8MzY8Yil0aHJvdyBFcnJvcihcInJhZGl4IG91dCBvZiByYW5nZTogXCIrYik7aWYoXCItXCI9PWEuY2hhckF0KDApKXJldHVybiBXKFhkKGEuc3Vic3RyaW5nKDEpLGIpKTtpZigwPD1hLmluZGV4T2YoXCItXCIpKXRocm93IEVycm9yKCdudW1iZXIgZm9ybWF0IGVycm9yOiBpbnRlcmlvciBcIi1cIiBjaGFyYWN0ZXInKTtmb3IodmFyIGM9VShNYXRoLnBvdyhiLDgpKSxkPVYsZT0wO2U8YS5sZW5ndGg7ZSs9OCl7dmFyIGY9TWF0aC5taW4oOCxhLmxlbmd0aC1lKSxoPXBhcnNlSW50KGEuc3Vic3RyaW5nKGUsZStmKSxiKTs4PmY/KGY9VShNYXRoLnBvdyhiLGYpKSxkPWQuUihmKS5hZGQoVShoKSkpOihkPWQuUihjKSxkPWQuYWRkKFUoaCkpKTt9cmV0dXJuIGR9XG52YXIgV2Q9NDI5NDk2NzI5NixWPVZkKDApLFlkPVZkKDEpLFpkPVZkKDE2Nzc3MjE2KTtrPVQucHJvdG90eXBlO2suZWE9ZnVuY3Rpb24oKXtpZihYKHRoaXMpKXJldHVybiAtVyh0aGlzKS5lYSgpO2Zvcih2YXIgYT0wLGI9MSxjPTA7Yzx0aGlzLmcubGVuZ3RoO2MrKyl7dmFyIGQ9dGhpcy5EKGMpO2ErPSgwPD1kP2Q6V2QrZCkqYjtiKj1XZDt9cmV0dXJuIGF9O1xuay50b1N0cmluZz1mdW5jdGlvbihhKXthPWF8fDEwO2lmKDI+YXx8MzY8YSl0aHJvdyBFcnJvcihcInJhZGl4IG91dCBvZiByYW5nZTogXCIrYSk7aWYoWSh0aGlzKSlyZXR1cm4gXCIwXCI7aWYoWCh0aGlzKSlyZXR1cm4gXCItXCIrVyh0aGlzKS50b1N0cmluZyhhKTtmb3IodmFyIGI9VShNYXRoLnBvdyhhLDYpKSxjPXRoaXMsZD1cIlwiOzspe3ZhciBlPSRkKGMsYikuZztjPWFlKGMsZS5SKGIpKTt2YXIgZj0oKDA8Yy5nLmxlbmd0aD9jLmdbMF06Yy5oKT4+PjApLnRvU3RyaW5nKGEpO2M9ZTtpZihZKGMpKXJldHVybiBmK2Q7Zm9yKDs2PmYubGVuZ3RoOylmPVwiMFwiK2Y7ZD1mK2Q7fX07ay5EPWZ1bmN0aW9uKGEpe3JldHVybiAwPmE/MDphPHRoaXMuZy5sZW5ndGg/dGhpcy5nW2FdOnRoaXMuaH07ZnVuY3Rpb24gWShhKXtpZigwIT1hLmgpcmV0dXJuICExO2Zvcih2YXIgYj0wO2I8YS5nLmxlbmd0aDtiKyspaWYoMCE9YS5nW2JdKXJldHVybiAhMTtyZXR1cm4gITB9XG5mdW5jdGlvbiBYKGEpe3JldHVybiAtMT09YS5ofWsuWD1mdW5jdGlvbihhKXthPWFlKHRoaXMsYSk7cmV0dXJuIFgoYSk/LTE6WShhKT8wOjF9O2Z1bmN0aW9uIFcoYSl7Zm9yKHZhciBiPWEuZy5sZW5ndGgsYz1bXSxkPTA7ZDxiO2QrKyljW2RdPX5hLmdbZF07cmV0dXJuIChuZXcgVChjLH5hLmgpKS5hZGQoWWQpfWsuYWJzPWZ1bmN0aW9uKCl7cmV0dXJuIFgodGhpcyk/Vyh0aGlzKTp0aGlzfTtrLmFkZD1mdW5jdGlvbihhKXtmb3IodmFyIGI9TWF0aC5tYXgodGhpcy5nLmxlbmd0aCxhLmcubGVuZ3RoKSxjPVtdLGQ9MCxlPTA7ZTw9YjtlKyspe3ZhciBmPWQrKHRoaXMuRChlKSY2NTUzNSkrKGEuRChlKSY2NTUzNSksaD0oZj4+PjE2KSsodGhpcy5EKGUpPj4+MTYpKyhhLkQoZSk+Pj4xNik7ZD1oPj4+MTY7ZiY9NjU1MzU7aCY9NjU1MzU7Y1tlXT1oPDwxNnxmO31yZXR1cm4gbmV3IFQoYyxjW2MubGVuZ3RoLTFdJi0yMTQ3NDgzNjQ4Py0xOjApfTtcbmZ1bmN0aW9uIGFlKGEsYil7cmV0dXJuIGEuYWRkKFcoYikpfVxuay5SPWZ1bmN0aW9uKGEpe2lmKFkodGhpcyl8fFkoYSkpcmV0dXJuIFY7aWYoWCh0aGlzKSlyZXR1cm4gWChhKT9XKHRoaXMpLlIoVyhhKSk6VyhXKHRoaXMpLlIoYSkpO2lmKFgoYSkpcmV0dXJuIFcodGhpcy5SKFcoYSkpKTtpZigwPnRoaXMuWChaZCkmJjA+YS5YKFpkKSlyZXR1cm4gVSh0aGlzLmVhKCkqYS5lYSgpKTtmb3IodmFyIGI9dGhpcy5nLmxlbmd0aCthLmcubGVuZ3RoLGM9W10sZD0wO2Q8MipiO2QrKyljW2RdPTA7Zm9yKGQ9MDtkPHRoaXMuZy5sZW5ndGg7ZCsrKWZvcih2YXIgZT0wO2U8YS5nLmxlbmd0aDtlKyspe3ZhciBmPXRoaXMuRChkKT4+PjE2LGg9dGhpcy5EKGQpJjY1NTM1LG09YS5EKGUpPj4+MTYsdD1hLkQoZSkmNjU1MzU7Y1syKmQrMiplXSs9aCp0O2JlKGMsMipkKzIqZSk7Y1syKmQrMiplKzFdKz1mKnQ7YmUoYywyKmQrMiplKzEpO2NbMipkKzIqZSsxXSs9aCptO2JlKGMsMipkKzIqZSsxKTtjWzIqZCsyKmUrMl0rPWYqbTtiZShjLDIqZCsyKmUrMik7fWZvcihkPVxuMDtkPGI7ZCsrKWNbZF09Y1syKmQrMV08PDE2fGNbMipkXTtmb3IoZD1iO2Q8MipiO2QrKyljW2RdPTA7cmV0dXJuIG5ldyBUKGMsMCl9O2Z1bmN0aW9uIGJlKGEsYil7Zm9yKDsoYVtiXSY2NTUzNSkhPWFbYl07KWFbYisxXSs9YVtiXT4+PjE2LGFbYl0mPTY1NTM1LGIrKzt9ZnVuY3Rpb24gY2UoYSxiKXt0aGlzLmc9YTt0aGlzLmg9Yjt9XG5mdW5jdGlvbiAkZChhLGIpe2lmKFkoYikpdGhyb3cgRXJyb3IoXCJkaXZpc2lvbiBieSB6ZXJvXCIpO2lmKFkoYSkpcmV0dXJuIG5ldyBjZShWLFYpO2lmKFgoYSkpcmV0dXJuIGI9JGQoVyhhKSxiKSxuZXcgY2UoVyhiLmcpLFcoYi5oKSk7aWYoWChiKSlyZXR1cm4gYj0kZChhLFcoYikpLG5ldyBjZShXKGIuZyksYi5oKTtpZigzMDxhLmcubGVuZ3RoKXtpZihYKGEpfHxYKGIpKXRocm93IEVycm9yKFwic2xvd0RpdmlkZV8gb25seSB3b3JrcyB3aXRoIHBvc2l0aXZlIGludGVnZXJzLlwiKTtmb3IodmFyIGM9WWQsZD1iOzA+PWQuWChhKTspYz1kZShjKSxkPWRlKGQpO3ZhciBlPVooYywxKSxmPVooZCwxKTtkPVooZCwyKTtmb3IoYz1aKGMsMik7IVkoZCk7KXt2YXIgaD1mLmFkZChkKTswPj1oLlgoYSkmJihlPWUuYWRkKGMpLGY9aCk7ZD1aKGQsMSk7Yz1aKGMsMSk7fWI9YWUoYSxlLlIoYikpO3JldHVybiBuZXcgY2UoZSxiKX1mb3IoZT1WOzA8PWEuWChiKTspe2M9TWF0aC5tYXgoMSxNYXRoLmZsb29yKGEuZWEoKS9cbmIuZWEoKSkpO2Q9TWF0aC5jZWlsKE1hdGgubG9nKGMpL01hdGguTE4yKTtkPTQ4Pj1kPzE6TWF0aC5wb3coMixkLTQ4KTtmPVUoYyk7Zm9yKGg9Zi5SKGIpO1goaCl8fDA8aC5YKGEpOyljLT1kLGY9VShjKSxoPWYuUihiKTtZKGYpJiYoZj1ZZCk7ZT1lLmFkZChmKTthPWFlKGEsaCk7fXJldHVybiBuZXcgY2UoZSxhKX1rLmdiPWZ1bmN0aW9uKGEpe3JldHVybiAkZCh0aGlzLGEpLmh9O2suYW5kPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGEuZy5sZW5ndGgpLGM9W10sZD0wO2Q8YjtkKyspY1tkXT10aGlzLkQoZCkmYS5EKGQpO3JldHVybiBuZXcgVChjLHRoaXMuaCZhLmgpfTtrLm9yPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGEuZy5sZW5ndGgpLGM9W10sZD0wO2Q8YjtkKyspY1tkXT10aGlzLkQoZCl8YS5EKGQpO3JldHVybiBuZXcgVChjLHRoaXMuaHxhLmgpfTtcbmsueG9yPWZ1bmN0aW9uKGEpe2Zvcih2YXIgYj1NYXRoLm1heCh0aGlzLmcubGVuZ3RoLGEuZy5sZW5ndGgpLGM9W10sZD0wO2Q8YjtkKyspY1tkXT10aGlzLkQoZCleYS5EKGQpO3JldHVybiBuZXcgVChjLHRoaXMuaF5hLmgpfTtmdW5jdGlvbiBkZShhKXtmb3IodmFyIGI9YS5nLmxlbmd0aCsxLGM9W10sZD0wO2Q8YjtkKyspY1tkXT1hLkQoZCk8PDF8YS5EKGQtMSk+Pj4zMTtyZXR1cm4gbmV3IFQoYyxhLmgpfWZ1bmN0aW9uIFooYSxiKXt2YXIgYz1iPj41O2IlPTMyO2Zvcih2YXIgZD1hLmcubGVuZ3RoLWMsZT1bXSxmPTA7ZjxkO2YrKyllW2ZdPTA8Yj9hLkQoZitjKT4+PmJ8YS5EKGYrYysxKTw8MzItYjphLkQoZitjKTtyZXR1cm4gbmV3IFQoZSxhLmgpfVBkLnByb3RvdHlwZS5jcmVhdGVXZWJDaGFubmVsPVBkLnByb3RvdHlwZS5nO1EucHJvdG90eXBlLnNlbmQ9US5wcm90b3R5cGUudTtRLnByb3RvdHlwZS5vcGVuPVEucHJvdG90eXBlLm07US5wcm90b3R5cGUuY2xvc2U9US5wcm90b3R5cGUuY2xvc2U7VWIuTk9fRVJST1I9MDtVYi5USU1FT1VUPTg7VWIuSFRUUF9FUlJPUj02O1ZiLkNPTVBMRVRFPVwiY29tcGxldGVcIjtZYi5FdmVudFR5cGU9WmI7WmIuT1BFTj1cImFcIjtaYi5DTE9TRT1cImJcIjtaYi5FUlJPUj1cImNcIjtaYi5NRVNTQUdFPVwiZFwiO0IucHJvdG90eXBlLmxpc3Rlbj1CLnByb3RvdHlwZS5PO1AucHJvdG90eXBlLmxpc3Rlbk9uY2U9UC5wcm90b3R5cGUuUDtQLnByb3RvdHlwZS5nZXRMYXN0RXJyb3I9UC5wcm90b3R5cGUuU2E7UC5wcm90b3R5cGUuZ2V0TGFzdEVycm9yQ29kZT1QLnByb3RvdHlwZS5JYTtQLnByb3RvdHlwZS5nZXRTdGF0dXM9UC5wcm90b3R5cGUuZGE7UC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VKc29uPVAucHJvdG90eXBlLldhO1xuUC5wcm90b3R5cGUuZ2V0UmVzcG9uc2VUZXh0PVAucHJvdG90eXBlLmphO1AucHJvdG90eXBlLnNlbmQ9UC5wcm90b3R5cGUuaGE7UC5wcm90b3R5cGUuc2V0V2l0aENyZWRlbnRpYWxzPVAucHJvdG90eXBlLk9hO1MucHJvdG90eXBlLmRpZ2VzdD1TLnByb3RvdHlwZS5sO1MucHJvdG90eXBlLnJlc2V0PVMucHJvdG90eXBlLnJlc2V0O1MucHJvdG90eXBlLnVwZGF0ZT1TLnByb3RvdHlwZS5qO1QucHJvdG90eXBlLmFkZD1ULnByb3RvdHlwZS5hZGQ7VC5wcm90b3R5cGUubXVsdGlwbHk9VC5wcm90b3R5cGUuUjtULnByb3RvdHlwZS5tb2R1bG89VC5wcm90b3R5cGUuZ2I7VC5wcm90b3R5cGUuY29tcGFyZT1ULnByb3RvdHlwZS5YO1QucHJvdG90eXBlLnRvTnVtYmVyPVQucHJvdG90eXBlLmVhO1QucHJvdG90eXBlLnRvU3RyaW5nPVQucHJvdG90eXBlLnRvU3RyaW5nO1QucHJvdG90eXBlLmdldEJpdHM9VC5wcm90b3R5cGUuRDtULmZyb21OdW1iZXI9VTtULmZyb21TdHJpbmc9WGQ7XG52YXIgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCA9IGVzbS5jcmVhdGVXZWJDaGFubmVsVHJhbnNwb3J0PWZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBQZH07dmFyIGdldFN0YXRFdmVudFRhcmdldCA9IGVzbS5nZXRTdGF0RXZlbnRUYXJnZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gT2IoKX07dmFyIEVycm9yQ29kZSA9IGVzbS5FcnJvckNvZGU9VWI7dmFyIEV2ZW50VHlwZSA9IGVzbS5FdmVudFR5cGU9VmI7dmFyIEV2ZW50ID0gZXNtLkV2ZW50PUU7dmFyIFN0YXQgPSBlc20uU3RhdD17eGI6MCxBYjoxLEJiOjIsVWI6MyxaYjo0LFdiOjUsWGI6NixWYjo3LFRiOjgsWWI6OSxQUk9YWToxMCxOT1BST1hZOjExLFJiOjEyLE5iOjEzLE9iOjE0LE1iOjE1LFBiOjE2LFFiOjE3LHRiOjE4LHNiOjE5LHViOjIwfTt2YXIgRmV0Y2hYbWxIdHRwRmFjdG9yeSA9IGVzbS5GZXRjaFhtbEh0dHBGYWN0b3J5PW1kO3ZhciBXZWJDaGFubmVsID0gZXNtLldlYkNoYW5uZWw9WWI7dmFyIFhocklvID0gZXNtLlhocklvPVA7dmFyIE1kNSA9IGVzbS5NZDU9Uzt2YXIgSW50ZWdlciA9IGVzbS5JbnRlZ2VyPVQ7XG5cbmV4cG9ydCB7IEVycm9yQ29kZSwgRXZlbnQsIEV2ZW50VHlwZSwgRmV0Y2hYbWxIdHRwRmFjdG9yeSwgSW50ZWdlciwgTWQ1LCBTdGF0LCBXZWJDaGFubmVsLCBYaHJJbywgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgZXNtIGFzIGRlZmF1bHQsIGdldFN0YXRFdmVudFRhcmdldCB9O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguZXNtMjAxNy5qcy5tYXBcbiIsImltcG9ydCB7IF9yZWdpc3RlckNvbXBvbmVudCwgcmVnaXN0ZXJWZXJzaW9uLCBfZ2V0UHJvdmlkZXIsIGdldEFwcCwgX3JlbW92ZVNlcnZpY2VJbnN0YW5jZSwgU0RLX1ZFUlNJT04gfSBmcm9tICdAZmlyZWJhc2UvYXBwJztcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJ0BmaXJlYmFzZS9jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9nZ2VyLCBMb2dMZXZlbCB9IGZyb20gJ0BmaXJlYmFzZS9sb2dnZXInO1xuaW1wb3J0IHsgRmlyZWJhc2VFcnJvciwgY3JlYXRlTW9ja1VzZXJUb2tlbiwgZ2V0TW9kdWxhckluc3RhbmNlLCBkZWVwRXF1YWwsIGdldERlZmF1bHRFbXVsYXRvckhvc3RuYW1lQW5kUG9ydCwgZ2V0VUEsIGlzSW5kZXhlZERCQXZhaWxhYmxlLCBpc1NhZmFyaSB9IGZyb20gJ0BmaXJlYmFzZS91dGlsJztcbmltcG9ydCB7IEludGVnZXIsIFhocklvLCBFdmVudFR5cGUsIEVycm9yQ29kZSwgY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCwgZ2V0U3RhdEV2ZW50VGFyZ2V0LCBGZXRjaFhtbEh0dHBGYWN0b3J5LCBXZWJDaGFubmVsLCBFdmVudCwgU3RhdCwgTWQ1IH0gZnJvbSAnQGZpcmViYXNlL3dlYmNoYW5uZWwtd3JhcHBlcic7XG5cbmNvbnN0IGIgPSBcIkBmaXJlYmFzZS9maXJlc3RvcmVcIjtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogU2ltcGxlIHdyYXBwZXIgYXJvdW5kIGEgbnVsbGFibGUgVUlELiBNb3N0bHkgZXhpc3RzIHRvIG1ha2UgY29kZSBtb3JlXG4gKiByZWFkYWJsZS5cbiAqL1xuY2xhc3MgViB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnVpZCA9IHQ7XG4gICAgfVxuICAgIGlzQXV0aGVudGljYXRlZCgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy51aWQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBrZXkgcmVwcmVzZW50aW5nIHRoaXMgdXNlciwgc3VpdGFibGUgZm9yIGluY2x1c2lvbiBpbiBhXG4gICAgICogZGljdGlvbmFyeS5cbiAgICAgKi8gICAgdG9LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzQXV0aGVudGljYXRlZCgpID8gXCJ1aWQ6XCIgKyB0aGlzLnVpZCA6IFwiYW5vbnltb3VzLXVzZXJcIjtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0LnVpZCA9PT0gdGhpcy51aWQ7XG4gICAgfVxufVxuXG4vKiogQSB1c2VyIHdpdGggYSBudWxsIFVJRC4gKi8gVi5VTkFVVEhFTlRJQ0FURUQgPSBuZXcgVihudWxsKSwgXG4vLyBUT0RPKG1pa2VsZWhlbik6IExvb2sgaW50byBnZXR0aW5nIGEgcHJvcGVyIHVpZC1lcXVpdmFsZW50IGZvclxuLy8gbm9uLUZpcmViYXNlQXV0aCBwcm92aWRlcnMuXG5WLkdPT0dMRV9DUkVERU5USUFMUyA9IG5ldyBWKFwiZ29vZ2xlLWNyZWRlbnRpYWxzLXVpZFwiKSwgVi5GSVJTVF9QQVJUWSA9IG5ldyBWKFwiZmlyc3QtcGFydHktdWlkXCIpLCBcblYuTU9DS19VU0VSID0gbmV3IFYoXCJtb2NrLXVzZXJcIik7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5sZXQgUyA9IFwiOS4yMS4wXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5jb25zdCBEID0gbmV3IExvZ2dlcihcIkBmaXJlYmFzZS9maXJlc3RvcmVcIik7XG5cbi8vIEhlbHBlciBtZXRob2RzIGFyZSBuZWVkZWQgYmVjYXVzZSB2YXJpYWJsZXMgY2FuJ3QgYmUgZXhwb3J0ZWQgYXMgcmVhZC93cml0ZVxuZnVuY3Rpb24gQygpIHtcbiAgICByZXR1cm4gRC5sb2dMZXZlbDtcbn1cblxuLyoqXG4gKiBTZXRzIHRoZSB2ZXJib3NpdHkgb2YgQ2xvdWQgRmlyZXN0b3JlIGxvZ3MgKGRlYnVnLCBlcnJvciwgb3Igc2lsZW50KS5cbiAqXG4gKiBAcGFyYW0gbG9nTGV2ZWwgLSBUaGUgdmVyYm9zaXR5IHlvdSBzZXQgZm9yIGFjdGl2aXR5IGFuZCBlcnJvciBsb2dnaW5nLiBDYW5cbiAqICAgYmUgYW55IG9mIHRoZSBmb2xsb3dpbmcgdmFsdWVzOlxuICpcbiAqICAgPHVsPlxuICogICAgIDxsaT5gZGVidWdgIGZvciB0aGUgbW9zdCB2ZXJib3NlIGxvZ2dpbmcgbGV2ZWwsIHByaW1hcmlseSBmb3JcbiAqICAgICBkZWJ1Z2dpbmcuPC9saT5cbiAqICAgICA8bGk+YGVycm9yYCB0byBsb2cgZXJyb3JzIG9ubHkuPC9saT5cbiAqICAgICA8bGk+PGNvZGU+YHNpbGVudGAgdG8gdHVybiBvZmYgbG9nZ2luZy48L2xpPlxuICogICA8L3VsPlxuICovIGZ1bmN0aW9uIHgodCkge1xuICAgIEQuc2V0TG9nTGV2ZWwodCk7XG59XG5cbmZ1bmN0aW9uIE4odCwgLi4uZSkge1xuICAgIGlmIChELmxvZ0xldmVsIDw9IExvZ0xldmVsLkRFQlVHKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLm1hcChPKTtcbiAgICAgICAgRC5kZWJ1ZyhgRmlyZXN0b3JlICgke1N9KTogJHt0fWAsIC4uLm4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gayh0LCAuLi5lKSB7XG4gICAgaWYgKEQubG9nTGV2ZWwgPD0gTG9nTGV2ZWwuRVJST1IpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKE8pO1xuICAgICAgICBELmVycm9yKGBGaXJlc3RvcmUgKCR7U30pOiAke3R9YCwgLi4ubik7XG4gICAgfVxufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIE0odCwgLi4uZSkge1xuICAgIGlmIChELmxvZ0xldmVsIDw9IExvZ0xldmVsLldBUk4pIHtcbiAgICAgICAgY29uc3QgbiA9IGUubWFwKE8pO1xuICAgICAgICBELndhcm4oYEZpcmVzdG9yZSAoJHtTfSk6ICR7dH1gLCAuLi5uKTtcbiAgICB9XG59XG5cbi8qKlxuICogQ29udmVydHMgYW4gYWRkaXRpb25hbCBsb2cgcGFyYW1ldGVyIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIE8odCkge1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gdDtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZSA9IHQsIEpTT04uc3RyaW5naWZ5KGUpO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gQ29udmVydGluZyB0byBKU09OIGZhaWxlZCwganVzdCBsb2cgdGhlIG9iamVjdCBkaXJlY3RseVxuICAgICAgICByZXR1cm4gdDtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvKiogRm9ybWF0cyBhbiBvYmplY3QgYXMgYSBKU09OIHN0cmluZywgc3VpdGFibGUgZm9yIGxvZ2dpbmcuICovXG4gICAgdmFyIGU7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFVuY29uZGl0aW9uYWxseSBmYWlscywgdGhyb3dpbmcgYW4gRXJyb3Igd2l0aCB0aGUgZ2l2ZW4gbWVzc2FnZS5cbiAqIE1lc3NhZ2VzIGFyZSBzdHJpcHBlZCBpbiBwcm9kdWN0aW9uIGJ1aWxkcy5cbiAqXG4gKiBSZXR1cm5zIGBuZXZlcmAgYW5kIGNhbiBiZSB1c2VkIGluIGV4cHJlc3Npb25zOlxuICogQGV4YW1wbGVcbiAqIGxldCBmdXR1cmVWYXIgPSBmYWlsKCdub3QgaW1wbGVtZW50ZWQgeWV0Jyk7XG4gKi8gZnVuY3Rpb24gJCh0ID0gXCJVbmV4cGVjdGVkIHN0YXRlXCIpIHtcbiAgICAvLyBMb2cgdGhlIGZhaWx1cmUgaW4gYWRkaXRpb24gdG8gdGhyb3cgYW4gZXhjZXB0aW9uLCBqdXN0IGluIGNhc2UgdGhlXG4gICAgLy8gZXhjZXB0aW9uIGlzIHN3YWxsb3dlZC5cbiAgICBjb25zdCBlID0gYEZJUkVTVE9SRSAoJHtTfSkgSU5URVJOQUwgQVNTRVJUSU9OIEZBSUxFRDogYCArIHQ7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgdXNlIEZpcmVzdG9yZUVycm9yIGhlcmUgYmVjYXVzZSB0aGVzZSBhcmUgaW50ZXJuYWwgZmFpbHVyZXNcbiAgICAvLyB0aGF0IGNhbm5vdCBiZSBoYW5kbGVkIGJ5IHRoZSB1c2VyLiAoQWxzbyBpdCB3b3VsZCBjcmVhdGUgYSBjaXJjdWxhclxuICAgIC8vIGRlcGVuZGVuY3kgYmV0d2VlbiB0aGUgZXJyb3IgYW5kIGFzc2VydCBtb2R1bGVzIHdoaWNoIGRvZXNuJ3Qgd29yay4pXG4gICAgdGhyb3cgayhlKSwgbmV3IEVycm9yKGUpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogTWVzc2FnZXMgYXJlIHN0cmlwcGVkIGluIHByb2R1Y3Rpb24gYnVpbGRzLlxuICovIGZ1bmN0aW9uIEYodCwgZSkge1xuICAgIHQgfHwgJCgpO1xufVxuXG4vKipcbiAqIEZhaWxzIGlmIHRoZSBnaXZlbiBhc3NlcnRpb24gY29uZGl0aW9uIGlzIGZhbHNlLCB0aHJvd2luZyBhbiBFcnJvciB3aXRoIHRoZVxuICogZ2l2ZW4gbWVzc2FnZSBpZiBpdCBkaWQuXG4gKlxuICogVGhlIGNvZGUgb2YgY2FsbHNpdGVzIGludm9raW5nIHRoaXMgZnVuY3Rpb24gYXJlIHN0cmlwcGVkIG91dCBpbiBwcm9kdWN0aW9uXG4gKiBidWlsZHMuIEFueSBzaWRlLWVmZmVjdHMgb2YgY29kZSB3aXRoaW4gdGhlIGRlYnVnQXNzZXJ0KCkgaW52b2NhdGlvbiB3aWxsIG5vdFxuICogaGFwcGVuIGluIHRoaXMgY2FzZS5cbiAqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBCKHQsIGUpIHtcbiAgICB0IHx8ICQoKTtcbn1cblxuLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAuIEluIG5vbi1wcm9kdWN0aW9uIGJ1aWxkcywgdmVyaWZpZXMgdGhhdCBgb2JqYCBpcyBhblxuICogaW5zdGFuY2Ugb2YgYFRgIGJlZm9yZSBjYXN0aW5nLlxuICovIGZ1bmN0aW9uIEwodCwgXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuZSkge1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBxID0ge1xuICAgIC8vIENhdXNlcyBhcmUgY29waWVkIGZyb206XG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAgICAvKiogTm90IGFuIGVycm9yOyByZXR1cm5lZCBvbiBzdWNjZXNzLiAqL1xuICAgIE9LOiBcIm9rXCIsXG4gICAgLyoqIFRoZSBvcGVyYXRpb24gd2FzIGNhbmNlbGxlZCAodHlwaWNhbGx5IGJ5IHRoZSBjYWxsZXIpLiAqL1xuICAgIENBTkNFTExFRDogXCJjYW5jZWxsZWRcIixcbiAgICAvKiogVW5rbm93biBlcnJvciBvciBhbiBlcnJvciBmcm9tIGEgZGlmZmVyZW50IGVycm9yIGRvbWFpbi4gKi9cbiAgICBVTktOT1dOOiBcInVua25vd25cIixcbiAgICAvKipcbiAgICAgKiBDbGllbnQgc3BlY2lmaWVkIGFuIGludmFsaWQgYXJndW1lbnQuIE5vdGUgdGhhdCB0aGlzIGRpZmZlcnMgZnJvbVxuICAgICAqIEZBSUxFRF9QUkVDT05ESVRJT04uIElOVkFMSURfQVJHVU1FTlQgaW5kaWNhdGVzIGFyZ3VtZW50cyB0aGF0IGFyZVxuICAgICAqIHByb2JsZW1hdGljIHJlZ2FyZGxlc3Mgb2YgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0gKGUuZy4sIGEgbWFsZm9ybWVkIGZpbGVcbiAgICAgKiBuYW1lKS5cbiAgICAgKi9cbiAgICBJTlZBTElEX0FSR1VNRU5UOiBcImludmFsaWQtYXJndW1lbnRcIixcbiAgICAvKipcbiAgICAgKiBEZWFkbGluZSBleHBpcmVkIGJlZm9yZSBvcGVyYXRpb24gY291bGQgY29tcGxldGUuIEZvciBvcGVyYXRpb25zIHRoYXRcbiAgICAgKiBjaGFuZ2UgdGhlIHN0YXRlIG9mIHRoZSBzeXN0ZW0sIHRoaXMgZXJyb3IgbWF5IGJlIHJldHVybmVkIGV2ZW4gaWYgdGhlXG4gICAgICogb3BlcmF0aW9uIGhhcyBjb21wbGV0ZWQgc3VjY2Vzc2Z1bGx5LiBGb3IgZXhhbXBsZSwgYSBzdWNjZXNzZnVsIHJlc3BvbnNlXG4gICAgICogZnJvbSBhIHNlcnZlciBjb3VsZCBoYXZlIGJlZW4gZGVsYXllZCBsb25nIGVub3VnaCBmb3IgdGhlIGRlYWRsaW5lIHRvXG4gICAgICogZXhwaXJlLlxuICAgICAqL1xuICAgIERFQURMSU5FX0VYQ0VFREVEOiBcImRlYWRsaW5lLWV4Y2VlZGVkXCIsXG4gICAgLyoqIFNvbWUgcmVxdWVzdGVkIGVudGl0eSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIHdhcyBub3QgZm91bmQuICovXG4gICAgTk9UX0ZPVU5EOiBcIm5vdC1mb3VuZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgZW50aXR5IHRoYXQgd2UgYXR0ZW1wdGVkIHRvIGNyZWF0ZSAoZS5nLiwgZmlsZSBvciBkaXJlY3RvcnkpIGFscmVhZHlcbiAgICAgKiBleGlzdHMuXG4gICAgICovXG4gICAgQUxSRUFEWV9FWElTVFM6IFwiYWxyZWFkeS1leGlzdHNcIixcbiAgICAvKipcbiAgICAgKiBUaGUgY2FsbGVyIGRvZXMgbm90IGhhdmUgcGVybWlzc2lvbiB0byBleGVjdXRlIHRoZSBzcGVjaWZpZWQgb3BlcmF0aW9uLlxuICAgICAqIFBFUk1JU1NJT05fREVOSUVEIG11c3Qgbm90IGJlIHVzZWQgZm9yIHJlamVjdGlvbnMgY2F1c2VkIGJ5IGV4aGF1c3RpbmdcbiAgICAgKiBzb21lIHJlc291cmNlICh1c2UgUkVTT1VSQ0VfRVhIQVVTVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICogUEVSTUlTU0lPTl9ERU5JRUQgbXVzdCBub3QgYmUgdXNlZCBpZiB0aGUgY2FsbGVyIGNhbiBub3QgYmUgaWRlbnRpZmllZFxuICAgICAqICh1c2UgVU5BVVRIRU5USUNBVEVEIGluc3RlYWQgZm9yIHRob3NlIGVycm9ycykuXG4gICAgICovXG4gICAgUEVSTUlTU0lPTl9ERU5JRUQ6IFwicGVybWlzc2lvbi1kZW5pZWRcIixcbiAgICAvKipcbiAgICAgKiBUaGUgcmVxdWVzdCBkb2VzIG5vdCBoYXZlIHZhbGlkIGF1dGhlbnRpY2F0aW9uIGNyZWRlbnRpYWxzIGZvciB0aGVcbiAgICAgKiBvcGVyYXRpb24uXG4gICAgICovXG4gICAgVU5BVVRIRU5USUNBVEVEOiBcInVuYXV0aGVudGljYXRlZFwiLFxuICAgIC8qKlxuICAgICAqIFNvbWUgcmVzb3VyY2UgaGFzIGJlZW4gZXhoYXVzdGVkLCBwZXJoYXBzIGEgcGVyLXVzZXIgcXVvdGEsIG9yIHBlcmhhcHMgdGhlXG4gICAgICogZW50aXJlIGZpbGUgc3lzdGVtIGlzIG91dCBvZiBzcGFjZS5cbiAgICAgKi9cbiAgICBSRVNPVVJDRV9FWEhBVVNURUQ6IFwicmVzb3VyY2UtZXhoYXVzdGVkXCIsXG4gICAgLyoqXG4gICAgICogT3BlcmF0aW9uIHdhcyByZWplY3RlZCBiZWNhdXNlIHRoZSBzeXN0ZW0gaXMgbm90IGluIGEgc3RhdGUgcmVxdWlyZWQgZm9yXG4gICAgICogdGhlIG9wZXJhdGlvbidzIGV4ZWN1dGlvbi4gRm9yIGV4YW1wbGUsIGRpcmVjdG9yeSB0byBiZSBkZWxldGVkIG1heSBiZVxuICAgICAqIG5vbi1lbXB0eSwgYW4gcm1kaXIgb3BlcmF0aW9uIGlzIGFwcGxpZWQgdG8gYSBub24tZGlyZWN0b3J5LCBldGMuXG4gICAgICpcbiAgICAgKiBBIGxpdG11cyB0ZXN0IHRoYXQgbWF5IGhlbHAgYSBzZXJ2aWNlIGltcGxlbWVudG9yIGluIGRlY2lkaW5nXG4gICAgICogYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OLCBBQk9SVEVELCBhbmQgVU5BVkFJTEFCTEU6XG4gICAgICogIChhKSBVc2UgVU5BVkFJTEFCTEUgaWYgdGhlIGNsaWVudCBjYW4gcmV0cnkganVzdCB0aGUgZmFpbGluZyBjYWxsLlxuICAgICAqICAoYikgVXNlIEFCT1JURUQgaWYgdGhlIGNsaWVudCBzaG91bGQgcmV0cnkgYXQgYSBoaWdoZXItbGV2ZWxcbiAgICAgKiAgICAgIChlLmcuLCByZXN0YXJ0aW5nIGEgcmVhZC1tb2RpZnktd3JpdGUgc2VxdWVuY2UpLlxuICAgICAqICAoYykgVXNlIEZBSUxFRF9QUkVDT05ESVRJT04gaWYgdGhlIGNsaWVudCBzaG91bGQgbm90IHJldHJ5IHVudGlsXG4gICAgICogICAgICB0aGUgc3lzdGVtIHN0YXRlIGhhcyBiZWVuIGV4cGxpY2l0bHkgZml4ZWQuIEUuZy4sIGlmIGFuIFwicm1kaXJcIlxuICAgICAqICAgICAgZmFpbHMgYmVjYXVzZSB0aGUgZGlyZWN0b3J5IGlzIG5vbi1lbXB0eSwgRkFJTEVEX1BSRUNPTkRJVElPTlxuICAgICAqICAgICAgc2hvdWxkIGJlIHJldHVybmVkIHNpbmNlIHRoZSBjbGllbnQgc2hvdWxkIG5vdCByZXRyeSB1bmxlc3NcbiAgICAgKiAgICAgIHRoZXkgaGF2ZSBmaXJzdCBmaXhlZCB1cCB0aGUgZGlyZWN0b3J5IGJ5IGRlbGV0aW5nIGZpbGVzIGZyb20gaXQuXG4gICAgICogIChkKSBVc2UgRkFJTEVEX1BSRUNPTkRJVElPTiBpZiB0aGUgY2xpZW50IHBlcmZvcm1zIGNvbmRpdGlvbmFsXG4gICAgICogICAgICBSRVNUIEdldC9VcGRhdGUvRGVsZXRlIG9uIGEgcmVzb3VyY2UgYW5kIHRoZSByZXNvdXJjZSBvbiB0aGVcbiAgICAgKiAgICAgIHNlcnZlciBkb2VzIG5vdCBtYXRjaCB0aGUgY29uZGl0aW9uLiBFLmcuLCBjb25mbGljdGluZ1xuICAgICAqICAgICAgcmVhZC1tb2RpZnktd3JpdGUgb24gdGhlIHNhbWUgcmVzb3VyY2UuXG4gICAgICovXG4gICAgRkFJTEVEX1BSRUNPTkRJVElPTjogXCJmYWlsZWQtcHJlY29uZGl0aW9uXCIsXG4gICAgLyoqXG4gICAgICogVGhlIG9wZXJhdGlvbiB3YXMgYWJvcnRlZCwgdHlwaWNhbGx5IGR1ZSB0byBhIGNvbmN1cnJlbmN5IGlzc3VlIGxpa2VcbiAgICAgKiBzZXF1ZW5jZXIgY2hlY2sgZmFpbHVyZXMsIHRyYW5zYWN0aW9uIGFib3J0cywgZXRjLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIEFCT1JURUQ6IFwiYWJvcnRlZFwiLFxuICAgIC8qKlxuICAgICAqIE9wZXJhdGlvbiB3YXMgYXR0ZW1wdGVkIHBhc3QgdGhlIHZhbGlkIHJhbmdlLiBFLmcuLCBzZWVraW5nIG9yIHJlYWRpbmdcbiAgICAgKiBwYXN0IGVuZCBvZiBmaWxlLlxuICAgICAqXG4gICAgICogVW5saWtlIElOVkFMSURfQVJHVU1FTlQsIHRoaXMgZXJyb3IgaW5kaWNhdGVzIGEgcHJvYmxlbSB0aGF0IG1heSBiZSBmaXhlZFxuICAgICAqIGlmIHRoZSBzeXN0ZW0gc3RhdGUgY2hhbmdlcy4gRm9yIGV4YW1wbGUsIGEgMzItYml0IGZpbGUgc3lzdGVtIHdpbGxcbiAgICAgKiBnZW5lcmF0ZSBJTlZBTElEX0FSR1VNRU5UIGlmIGFza2VkIHRvIHJlYWQgYXQgYW4gb2Zmc2V0IHRoYXQgaXMgbm90IGluIHRoZVxuICAgICAqIHJhbmdlIFswLDJeMzItMV0sIGJ1dCBpdCB3aWxsIGdlbmVyYXRlIE9VVF9PRl9SQU5HRSBpZiBhc2tlZCB0byByZWFkIGZyb21cbiAgICAgKiBhbiBvZmZzZXQgcGFzdCB0aGUgY3VycmVudCBmaWxlIHNpemUuXG4gICAgICpcbiAgICAgKiBUaGVyZSBpcyBhIGZhaXIgYml0IG9mIG92ZXJsYXAgYmV0d2VlbiBGQUlMRURfUFJFQ09ORElUSU9OIGFuZFxuICAgICAqIE9VVF9PRl9SQU5HRS4gV2UgcmVjb21tZW5kIHVzaW5nIE9VVF9PRl9SQU5HRSAodGhlIG1vcmUgc3BlY2lmaWMgZXJyb3IpXG4gICAgICogd2hlbiBpdCBhcHBsaWVzIHNvIHRoYXQgY2FsbGVycyB3aG8gYXJlIGl0ZXJhdGluZyB0aHJvdWdoIGEgc3BhY2UgY2FuXG4gICAgICogZWFzaWx5IGxvb2sgZm9yIGFuIE9VVF9PRl9SQU5HRSBlcnJvciB0byBkZXRlY3Qgd2hlbiB0aGV5IGFyZSBkb25lLlxuICAgICAqL1xuICAgIE9VVF9PRl9SQU5HRTogXCJvdXQtb2YtcmFuZ2VcIixcbiAgICAvKiogT3BlcmF0aW9uIGlzIG5vdCBpbXBsZW1lbnRlZCBvciBub3Qgc3VwcG9ydGVkL2VuYWJsZWQgaW4gdGhpcyBzZXJ2aWNlLiAqL1xuICAgIFVOSU1QTEVNRU5URUQ6IFwidW5pbXBsZW1lbnRlZFwiLFxuICAgIC8qKlxuICAgICAqIEludGVybmFsIGVycm9ycy4gTWVhbnMgc29tZSBpbnZhcmlhbnRzIGV4cGVjdGVkIGJ5IHVuZGVybHlpbmcgU3lzdGVtIGhhc1xuICAgICAqIGJlZW4gYnJva2VuLiBJZiB5b3Ugc2VlIG9uZSBvZiB0aGVzZSBlcnJvcnMsIFNvbWV0aGluZyBpcyB2ZXJ5IGJyb2tlbi5cbiAgICAgKi9cbiAgICBJTlRFUk5BTDogXCJpbnRlcm5hbFwiLFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXJ2aWNlIGlzIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gVGhpcyBpcyBhIG1vc3QgbGlrZWx5IGEgdHJhbnNpZW50XG4gICAgICogY29uZGl0aW9uIGFuZCBtYXkgYmUgY29ycmVjdGVkIGJ5IHJldHJ5aW5nIHdpdGggYSBiYWNrb2ZmLlxuICAgICAqXG4gICAgICogU2VlIGxpdG11cyB0ZXN0IGFib3ZlIGZvciBkZWNpZGluZyBiZXR3ZWVuIEZBSUxFRF9QUkVDT05ESVRJT04sIEFCT1JURUQsXG4gICAgICogYW5kIFVOQVZBSUxBQkxFLlxuICAgICAqL1xuICAgIFVOQVZBSUxBQkxFOiBcInVuYXZhaWxhYmxlXCIsXG4gICAgLyoqIFVucmVjb3ZlcmFibGUgZGF0YSBsb3NzIG9yIGNvcnJ1cHRpb24uICovXG4gICAgREFUQV9MT1NTOiBcImRhdGEtbG9zc1wiXG59O1xuXG4vKiogQW4gZXJyb3IgcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgb3BlcmF0aW9uLiAqLyBjbGFzcyBVIGV4dGVuZHMgRmlyZWJhc2VFcnJvciB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgYmFja2VuZCBlcnJvciBjb2RlIGFzc29jaWF0ZWQgd2l0aCB0aGlzIGVycm9yLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIEEgY3VzdG9tIGVycm9yIGRlc2NyaXB0aW9uLlxuICAgICAqL1xuICAgIGUpIHtcbiAgICAgICAgc3VwZXIodCwgZSksIHRoaXMuY29kZSA9IHQsIHRoaXMubWVzc2FnZSA9IGUsIFxuICAgICAgICAvLyBIQUNLOiBXZSB3cml0ZSBhIHRvU3RyaW5nIHByb3BlcnR5IGRpcmVjdGx5IGJlY2F1c2UgRXJyb3IgaXMgbm90IGEgcmVhbFxuICAgICAgICAvLyBjbGFzcyBhbmQgc28gaW5oZXJpdGFuY2UgZG9lcyBub3Qgd29yayBjb3JyZWN0bHkuIFdlIGNvdWxkIGFsdGVybmF0aXZlbHlcbiAgICAgICAgLy8gZG8gdGhlIHNhbWUgXCJiYWNrLWRvb3IgaW5oZXJpdGFuY2VcIiB0cmljayB0aGF0IEZpcmViYXNlRXJyb3IgZG9lcy5cbiAgICAgICAgdGhpcy50b1N0cmluZyA9ICgpID0+IGAke3RoaXMubmFtZX06IFtjb2RlPSR7dGhpcy5jb2RlfV06ICR7dGhpcy5tZXNzYWdlfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBLIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IFByb21pc2UoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlc29sdmUgPSB0LCB0aGlzLnJlamVjdCA9IGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIEcge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51c2VyID0gZSwgdGhpcy50eXBlID0gXCJPQXV0aFwiLCB0aGlzLmhlYWRlcnMgPSBuZXcgTWFwLCB0aGlzLmhlYWRlcnMuc2V0KFwiQXV0aG9yaXphdGlvblwiLCBgQmVhcmVyICR7dH1gKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHlpZWxkcyBhbiBlbXB0eSB0b2tlbi5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIFEge1xuICAgIGdldFRva2VuKCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgLy8gRmlyZSB3aXRoIGluaXRpYWwgdXNlci5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKFYuVU5BVVRIRU5USUNBVEVEKSkpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG59XG5cbi8qKlxuICogQSBDcmVkZW50aWFsc1Byb3ZpZGVyIHRoYXQgYWx3YXlzIHJldHVybnMgYSBjb25zdGFudCB0b2tlbi4gVXNlZCBmb3JcbiAqIGVtdWxhdG9yIHRva2VuIG1vY2tpbmcuXG4gKi8gY2xhc3MgaiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnRva2VuID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTdG9yZXMgdGhlIGxpc3RlbmVyIHJlZ2lzdGVyZWQgd2l0aCBzZXRDaGFuZ2VMaXN0ZW5lcigpXG4gICAgICAgICAqIFRoaXMgaXNuJ3QgYWN0dWFsbHkgbmVjZXNzYXJ5IHNpbmNlIHRoZSBVSUQgbmV2ZXIgY2hhbmdlcywgYnV0IHdlIHVzZSB0aGlzXG4gICAgICAgICAqIHRvIHZlcmlmeSB0aGUgbGlzdGVuIGNvbnRyYWN0IGlzIGFkaGVyZWQgdG8gaW4gdGVzdHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodGhpcy50b2tlbik7XG4gICAgfVxuICAgIGludmFsaWRhdGVUb2tlbigpIHt9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gZSwgXG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVzZXIuXG4gICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gZSh0aGlzLnRva2VuLnVzZXIpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICB0aGlzLmNoYW5nZUxpc3RlbmVyID0gbnVsbDtcbiAgICB9XG59XG5cbmNsYXNzIHoge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy50ID0gdCwgXG4gICAgICAgIC8qKiBUcmFja3MgdGhlIGN1cnJlbnQgVXNlci4gKi9cbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IFYuVU5BVVRIRU5USUNBVEVELCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIENvdW50ZXIgdXNlZCB0byBkZXRlY3QgaWYgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgYSBnZXRUb2tlbiByZXF1ZXN0IHdhc1xuICAgICAgICAgKiBvdXRzdGFuZGluZy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuaSA9IDAsIHRoaXMuZm9yY2VSZWZyZXNoID0gITEsIHRoaXMuYXV0aCA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSB0aGlzLmk7XG4gICAgICAgIC8vIEEgY2hhbmdlIGxpc3RlbmVyIHRoYXQgcHJldmVudHMgZG91YmxlLWZpcmluZyBmb3IgdGhlIHNhbWUgdG9rZW4gY2hhbmdlLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB0ID0+IHRoaXMuaSAhPT0gbiA/IChuID0gdGhpcy5pLCBlKHQpKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgICAgICAvLyBBIHByb21pc2UgdGhhdCBjYW4gYmUgd2FpdGVkIG9uIHRvIGJsb2NrIG9uIHRoZSBuZXh0IHRva2VuIGNoYW5nZS5cbiAgICAgICAgLy8gVGhpcyBwcm9taXNlIGlzIHJlLWNyZWF0ZWQgYWZ0ZXIgZWFjaCBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgbGV0IGkgPSBuZXcgSztcbiAgICAgICAgdGhpcy5vID0gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5pKyssIHRoaXMuY3VycmVudFVzZXIgPSB0aGlzLnUoKSwgaS5yZXNvbHZlKCksIGkgPSBuZXcgSywgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBzKHRoaXMuY3VycmVudFVzZXIpKSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHIgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gaTtcbiAgICAgICAgICAgIHQuZW5xdWV1ZVJldHJ5YWJsZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IGUucHJvbWlzZSwgYXdhaXQgcyh0aGlzLmN1cnJlbnRVc2VyKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSwgbyA9IHQgPT4ge1xuICAgICAgICAgICAgTihcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJBdXRoIGRldGVjdGVkXCIpLCB0aGlzLmF1dGggPSB0LCB0aGlzLmF1dGguYWRkQXV0aFRva2VuTGlzdGVuZXIodGhpcy5vKSwgXG4gICAgICAgICAgICByKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMudC5vbkluaXQoKHQgPT4gbyh0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEF1dGggcmlnaHQgYWZ0ZXIgRmlyZXN0b3JlLCBzbyB3ZSBnaXZlIGl0XG4gICAgICAgIC8vIGEgY2hhbmNlIHRvIHJlZ2lzdGVyIGl0c2VsZiB3aXRoIHRoZSBjb21wb25lbnQgZnJhbWV3b3JrIGJlZm9yZSB3ZVxuICAgICAgICAvLyBkZXRlcm1pbmUgd2hldGhlciB0byBzdGFydCB1cCBpbiB1bmF1dGhlbnRpY2F0ZWQgbW9kZS5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmF1dGgpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy50LmdldEltbWVkaWF0ZSh7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbmFsOiAhMFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHQgPyBvKHQpIDogKFxuICAgICAgICAgICAgICAgIC8vIElmIGF1dGggaXMgc3RpbGwgbm90IGF2YWlsYWJsZSwgcHJvY2VlZCB3aXRoIGBudWxsYCB1c2VyXG4gICAgICAgICAgICAgICAgTihcIkZpcmViYXNlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXJcIiwgXCJBdXRoIG5vdCB5ZXQgZGV0ZWN0ZWRcIiksIGkucmVzb2x2ZSgpLCBpID0gbmV3IEspO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgMCksIHIoKTtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIC8vIFRha2Ugbm90ZSBvZiB0aGUgY3VycmVudCB2YWx1ZSBvZiB0aGUgdG9rZW5Db3VudGVyIHNvIHRoYXQgdGhpcyBtZXRob2RcbiAgICAgICAgLy8gY2FuIGZhaWwgKHdpdGggYW4gQUJPUlRFRCBlcnJvcikgaWYgdGhlcmUgaXMgYSB0b2tlbiBjaGFuZ2Ugd2hpbGUgdGhlXG4gICAgICAgIC8vIHJlcXVlc3QgaXMgb3V0c3RhbmRpbmcuXG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmksIGUgPSB0aGlzLmZvcmNlUmVmcmVzaDtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yY2VSZWZyZXNoID0gITEsIHRoaXMuYXV0aCA/IHRoaXMuYXV0aC5nZXRUb2tlbihlKS50aGVuKChlID0+IFxuICAgICAgICAvLyBDYW5jZWwgdGhlIHJlcXVlc3Qgc2luY2UgdGhlIHRva2VuIGNoYW5nZWQgd2hpbGUgdGhlIHJlcXVlc3Qgd2FzXG4gICAgICAgIC8vIG91dHN0YW5kaW5nIHNvIHRoZSByZXNwb25zZSBpcyBwb3RlbnRpYWxseSBmb3IgYSBwcmV2aW91cyB1c2VyICh3aGljaFxuICAgICAgICAvLyB1c2VyLCB3ZSBjYW4ndCBiZSBzdXJlKS5cbiAgICAgICAgdGhpcy5pICE9PSB0ID8gKE4oXCJGaXJlYmFzZUF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyXCIsIFwiZ2V0VG9rZW4gYWJvcnRlZCBkdWUgdG8gdG9rZW4gY2hhbmdlLlwiKSwgXG4gICAgICAgIHRoaXMuZ2V0VG9rZW4oKSkgOiBlID8gKEYoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS5hY2Nlc3NUb2tlbiksIG5ldyBHKGUuYWNjZXNzVG9rZW4sIHRoaXMuY3VycmVudFVzZXIpKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hdXRoICYmIHRoaXMuYXV0aC5yZW1vdmVBdXRoVG9rZW5MaXN0ZW5lcih0aGlzLm8pO1xuICAgIH1cbiAgICAvLyBBdXRoLmdldFVpZCgpIGNhbiByZXR1cm4gbnVsbCBldmVuIHdpdGggYSB1c2VyIGxvZ2dlZCBpbi4gSXQgaXMgYmVjYXVzZVxuICAgIC8vIGdldFVpZCgpIGlzIHN5bmNocm9ub3VzLCBidXQgdGhlIGF1dGggY29kZSBwb3B1bGF0aW5nIFVpZCBpcyBhc3luY2hyb25vdXMuXG4gICAgLy8gVGhpcyBtZXRob2Qgc2hvdWxkIG9ubHkgYmUgY2FsbGVkIGluIHRoZSBBdXRoVG9rZW5MaXN0ZW5lciBjYWxsYmFja1xuICAgIC8vIHRvIGd1YXJhbnRlZSB0byBnZXQgdGhlIGFjdHVhbCB1c2VyLlxuICAgIHUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmF1dGggJiYgdGhpcy5hdXRoLmdldFVpZCgpO1xuICAgICAgICByZXR1cm4gRihudWxsID09PSB0IHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpLCBuZXcgVih0KTtcbiAgICB9XG59XG5cbi8qXG4gKiBGaXJzdFBhcnR5VG9rZW4gcHJvdmlkZXMgYSBmcmVzaCB0b2tlbiBlYWNoIHRpbWUgaXRzIHZhbHVlXG4gKiBpcyByZXF1ZXN0ZWQsIGJlY2F1c2UgaWYgdGhlIHRva2VuIGlzIHRvbyBvbGQsIHJlcXVlc3RzIHdpbGwgYmUgcmVqZWN0ZWQuXG4gKiBUZWNobmljYWxseSB0aGlzIG1heSBubyBsb25nZXIgYmUgbmVjZXNzYXJ5IHNpbmNlIHRoZSBTREsgc2hvdWxkIGdyYWNlZnVsbHlcbiAqIHJlY292ZXIgZnJvbSB1bmF1dGhlbnRpY2F0ZWQgZXJyb3JzIChzZWUgYi8zMzE0NzgxOCBmb3IgY29udGV4dCksIGJ1dCBpdCdzXG4gKiBzYWZlciB0byBrZWVwIHRoZSBpbXBsZW1lbnRhdGlvbiBhcy1pcy5cbiAqLyBjbGFzcyBXIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuaCA9IHQsIHRoaXMubCA9IGUsIHRoaXMubSA9IG4sIHRoaXMudHlwZSA9IFwiRmlyc3RQYXJ0eVwiLCB0aGlzLnVzZXIgPSBWLkZJUlNUX1BBUlRZLCBcbiAgICAgICAgdGhpcy5nID0gbmV3IE1hcDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyBhbiBhdXRob3JpemF0aW9uIHRva2VuLCB1c2luZyBhIHByb3ZpZGVkIGZhY3RvcnkgZnVuY3Rpb24sIG9yIHJldHVyblxuICAgICAqIG51bGwuXG4gICAgICovICAgIHAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm0gPyB0aGlzLm0oKSA6IG51bGw7XG4gICAgfVxuICAgIGdldCBoZWFkZXJzKCkge1xuICAgICAgICB0aGlzLmcuc2V0KFwiWC1Hb29nLUF1dGhVc2VyXCIsIHRoaXMuaCk7XG4gICAgICAgIC8vIFVzZSBhcnJheSBub3RhdGlvbiB0byBwcmV2ZW50IG1pbmlmaWNhdGlvblxuICAgICAgICBjb25zdCB0ID0gdGhpcy5wKCk7XG4gICAgICAgIHJldHVybiB0ICYmIHRoaXMuZy5zZXQoXCJBdXRob3JpemF0aW9uXCIsIHQpLCB0aGlzLmwgJiYgdGhpcy5nLnNldChcIlgtR29vZy1JYW0tQXV0aG9yaXphdGlvbi1Ub2tlblwiLCB0aGlzLmwpLCBcbiAgICAgICAgdGhpcy5nO1xuICAgIH1cbn1cblxuLypcbiAqIFByb3ZpZGVzIHVzZXIgY3JlZGVudGlhbHMgcmVxdWlyZWQgZm9yIHRoZSBGaXJlc3RvcmUgSmF2YVNjcmlwdCBTREtcbiAqIHRvIGF1dGhlbnRpY2F0ZSB0aGUgdXNlciwgdXNpbmcgdGVjaG5pcXVlIHRoYXQgaXMgb25seSBhdmFpbGFibGVcbiAqIHRvIGFwcGxpY2F0aW9ucyBob3N0ZWQgYnkgR29vZ2xlLlxuICovIGNsYXNzIEgge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5oID0gdCwgdGhpcy5sID0gZSwgdGhpcy5tID0gbjtcbiAgICB9XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IFcodGhpcy5oLCB0aGlzLmwsIHRoaXMubSkpO1xuICAgIH1cbiAgICBzdGFydCh0LCBlKSB7XG4gICAgICAgIC8vIEZpcmUgd2l0aCBpbml0aWFsIHVpZC5cbiAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBlKFYuRklSU1RfUEFSVFkpKSk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge31cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxufVxuXG5jbGFzcyBKIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0LCB0aGlzLnR5cGUgPSBcIkFwcENoZWNrXCIsIHRoaXMuaGVhZGVycyA9IG5ldyBNYXAsIHQgJiYgdC5sZW5ndGggPiAwICYmIHRoaXMuaGVhZGVycy5zZXQoXCJ4LWZpcmViYXNlLWFwcGNoZWNrXCIsIHRoaXMudmFsdWUpO1xuICAgIH1cbn1cblxuY2xhc3MgWSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLkkgPSB0LCB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmFwcENoZWNrID0gbnVsbCwgdGhpcy5UID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdCA9PiB7XG4gICAgICAgICAgICBudWxsICE9IHQuZXJyb3IgJiYgTihcIkZpcmViYXNlQXBwQ2hlY2tUb2tlblByb3ZpZGVyXCIsIGBFcnJvciBnZXR0aW5nIEFwcCBDaGVjayB0b2tlbjsgdXNpbmcgcGxhY2Vob2xkZXIgdG9rZW4gaW5zdGVhZC4gRXJyb3I6ICR7dC5lcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudG9rZW4gIT09IHRoaXMuVDtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLlQgPSB0LnRva2VuLCBOKFwiRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXJcIiwgYFJlY2VpdmVkICR7biA/IFwibmV3XCIgOiBcImV4aXN0aW5nXCJ9IHRva2VuLmApLCBcbiAgICAgICAgICAgIG4gPyBlKHQudG9rZW4pIDogUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubyA9IGUgPT4ge1xuICAgICAgICAgICAgdC5lbnF1ZXVlUmV0cnlhYmxlKCgoKSA9PiBuKGUpKSk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHMgPSB0ID0+IHtcbiAgICAgICAgICAgIE4oXCJGaXJlYmFzZUFwcENoZWNrVG9rZW5Qcm92aWRlclwiLCBcIkFwcENoZWNrIGRldGVjdGVkXCIpLCB0aGlzLmFwcENoZWNrID0gdCwgdGhpcy5hcHBDaGVjay5hZGRUb2tlbkxpc3RlbmVyKHRoaXMubyk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuSS5vbkluaXQoKHQgPT4gcyh0KSkpLCBcbiAgICAgICAgLy8gT3VyIHVzZXJzIGNhbiBpbml0aWFsaXplIEFwcENoZWNrIGFmdGVyIEZpcmVzdG9yZSwgc28gd2UgZ2l2ZSBpdFxuICAgICAgICAvLyBhIGNoYW5jZSB0byByZWdpc3RlciBpdHNlbGYgd2l0aCB0aGUgY29tcG9uZW50IGZyYW1ld29yay5cbiAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFwcENoZWNrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuSS5nZXRJbW1lZGlhdGUoe1xuICAgICAgICAgICAgICAgICAgICBvcHRpb25hbDogITBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0ID8gcyh0KSA6IFxuICAgICAgICAgICAgICAgIC8vIElmIEFwcENoZWNrIGlzIHN0aWxsIG5vdCBhdmFpbGFibGUsIHByb2NlZWQgd2l0aG91dCBpdC5cbiAgICAgICAgICAgICAgICBOKFwiRmlyZWJhc2VBcHBDaGVja1Rva2VuUHJvdmlkZXJcIiwgXCJBcHBDaGVjayBub3QgeWV0IGRldGVjdGVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgMCk7XG4gICAgfVxuICAgIGdldFRva2VuKCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5mb3JjZVJlZnJlc2g7XG4gICAgICAgIHJldHVybiB0aGlzLmZvcmNlUmVmcmVzaCA9ICExLCB0aGlzLmFwcENoZWNrID8gdGhpcy5hcHBDaGVjay5nZXRUb2tlbih0KS50aGVuKCh0ID0+IHQgPyAoRihcInN0cmluZ1wiID09IHR5cGVvZiB0LnRva2VuKSwgXG4gICAgICAgIHRoaXMuVCA9IHQudG9rZW4sIG5ldyBKKHQudG9rZW4pKSA6IG51bGwpKSA6IFByb21pc2UucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgaW52YWxpZGF0ZVRva2VuKCkge1xuICAgICAgICB0aGlzLmZvcmNlUmVmcmVzaCA9ICEwO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgdGhpcy5hcHBDaGVjayAmJiB0aGlzLmFwcENoZWNrLnJlbW92ZVRva2VuTGlzdGVuZXIodGhpcy5vKTtcbiAgICB9XG59XG5cbi8qKlxuICogQW4gQXBwQ2hlY2sgdG9rZW4gcHJvdmlkZXIgdGhhdCBhbHdheXMgeWllbGRzIGFuIGVtcHR5IHRva2VuLlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgWCB7XG4gICAgZ2V0VG9rZW4oKSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEooXCJcIikpO1xuICAgIH1cbiAgICBpbnZhbGlkYXRlVG9rZW4oKSB7fVxuICAgIHN0YXJ0KHQsIGUpIHt9XG4gICAgc2h1dGRvd24oKSB7fVxufVxuXG4vKipcbiAqIEJ1aWxkcyBhIENyZWRlbnRpYWxzUHJvdmlkZXIgZGVwZW5kaW5nIG9uIHRoZSB0eXBlIG9mXG4gKiB0aGUgY3JlZGVudGlhbHMgcGFzc2VkIGluLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBHZW5lcmF0ZXMgYG5CeXRlc2Agb2YgcmFuZG9tIGJ5dGVzLlxuICpcbiAqIElmIGBuQnl0ZXMgPCAwYCAsIGFuIGVycm9yIHdpbGwgYmUgdGhyb3duLlxuICovXG5mdW5jdGlvbiBaKHQpIHtcbiAgICAvLyBQb2x5ZmlsbHMgZm9yIElFIGFuZCBXZWJXb3JrZXIgYnkgdXNpbmcgYHNlbGZgIGFuZCBgbXNDcnlwdG9gIHdoZW4gYGNyeXB0b2AgaXMgbm90IGF2YWlsYWJsZS5cbiAgICBjb25zdCBlID0gXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBzZWxmICYmIChzZWxmLmNyeXB0byB8fCBzZWxmLm1zQ3J5cHRvKSwgbiA9IG5ldyBVaW50OEFycmF5KHQpO1xuICAgIGlmIChlICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZS5nZXRSYW5kb21WYWx1ZXMpIGUuZ2V0UmFuZG9tVmFsdWVzKG4pOyBlbHNlIFxuICAgIC8vIEZhbGxzIGJhY2sgdG8gTWF0aC5yYW5kb21cbiAgICBmb3IgKGxldCBlID0gMDsgZSA8IHQ7IGUrKykgbltlXSA9IE1hdGguZmxvb3IoMjU2ICogTWF0aC5yYW5kb20oKSk7XG4gICAgcmV0dXJuIG47XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIHR0IHtcbiAgICBzdGF0aWMgQSgpIHtcbiAgICAgICAgLy8gQWxwaGFudW1lcmljIGNoYXJhY3RlcnNcbiAgICAgICAgY29uc3QgdCA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODlcIiwgZSA9IE1hdGguZmxvb3IoMjU2IC8gdC5sZW5ndGgpICogdC5sZW5ndGg7XG4gICAgICAgIC8vIFRoZSBsYXJnZXN0IGJ5dGUgdmFsdWUgdGhhdCBpcyBhIG11bHRpcGxlIG9mIGBjaGFyLmxlbmd0aGAuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSBcIlwiO1xuICAgICAgICBmb3IgKDtuLmxlbmd0aCA8IDIwOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBaKDQwKTtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcy5sZW5ndGg7ICsraSkgXG4gICAgICAgICAgICAvLyBPbmx5IGFjY2VwdCB2YWx1ZXMgdGhhdCBhcmUgWzAsIG1heE11bHRpcGxlKSwgdGhpcyBlbnN1cmVzIHRoZXkgY2FuXG4gICAgICAgICAgICAvLyBiZSBldmVubHkgbWFwcGVkIHRvIGluZGljZXMgb2YgYGNoYXJzYCB2aWEgYSBtb2R1bG8gb3BlcmF0aW9uLlxuICAgICAgICAgICAgbi5sZW5ndGggPCAyMCAmJiBzW2ldIDwgZSAmJiAobiArPSB0LmNoYXJBdChzW2ldICUgdC5sZW5ndGgpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbjtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGV0KHQsIGUpIHtcbiAgICByZXR1cm4gdCA8IGUgPyAtMSA6IHQgPiBlID8gMSA6IDA7XG59XG5cbi8qKiBIZWxwZXIgdG8gY29tcGFyZSBhcnJheXMgdXNpbmcgaXNFcXVhbCgpLiAqLyBmdW5jdGlvbiBudCh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHQubGVuZ3RoID09PSBlLmxlbmd0aCAmJiB0LmV2ZXJ5KCgodCwgcykgPT4gbih0LCBlW3NdKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltbWVkaWF0ZSBsZXhpY29ncmFwaGljYWxseS1mb2xsb3dpbmcgc3RyaW5nLiBUaGlzIGlzIHVzZWZ1bCB0b1xuICogY29uc3RydWN0IGFuIGluY2x1c2l2ZSByYW5nZSBmb3IgaW5kZXhlZGRiIGl0ZXJhdG9ycy5cbiAqLyBmdW5jdGlvbiBzdCh0KSB7XG4gICAgLy8gUmV0dXJuIHRoZSBpbnB1dCBzdHJpbmcsIHdpdGggYW4gYWRkaXRpb25hbCBOVUwgYnl0ZSBhcHBlbmRlZC5cbiAgICByZXR1cm4gdCArIFwiXFwwXCI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBUaGUgZWFybGllc3QgZGF0ZSBzdXBwb3J0ZWQgYnkgRmlyZXN0b3JlIHRpbWVzdGFtcHMgKDAwMDEtMDEtMDFUMDA6MDA6MDBaKS5cbi8qKlxuICogQSBgVGltZXN0YW1wYCByZXByZXNlbnRzIGEgcG9pbnQgaW4gdGltZSBpbmRlcGVuZGVudCBvZiBhbnkgdGltZSB6b25lIG9yXG4gKiBjYWxlbmRhciwgcmVwcmVzZW50ZWQgYXMgc2Vjb25kcyBhbmQgZnJhY3Rpb25zIG9mIHNlY29uZHMgYXQgbmFub3NlY29uZFxuICogcmVzb2x1dGlvbiBpbiBVVEMgRXBvY2ggdGltZS5cbiAqXG4gKiBJdCBpcyBlbmNvZGVkIHVzaW5nIHRoZSBQcm9sZXB0aWMgR3JlZ29yaWFuIENhbGVuZGFyIHdoaWNoIGV4dGVuZHMgdGhlXG4gKiBHcmVnb3JpYW4gY2FsZW5kYXIgYmFja3dhcmRzIHRvIHllYXIgb25lLiBJdCBpcyBlbmNvZGVkIGFzc3VtaW5nIGFsbCBtaW51dGVzXG4gKiBhcmUgNjAgc2Vjb25kcyBsb25nLCBpLmUuIGxlYXAgc2Vjb25kcyBhcmUgXCJzbWVhcmVkXCIgc28gdGhhdCBubyBsZWFwIHNlY29uZFxuICogdGFibGUgaXMgbmVlZGVkIGZvciBpbnRlcnByZXRhdGlvbi4gUmFuZ2UgaXMgZnJvbSAwMDAxLTAxLTAxVDAwOjAwOjAwWiB0b1xuICogOTk5OS0xMi0zMVQyMzo1OTo1OS45OTk5OTk5OTlaLlxuICpcbiAqIEZvciBleGFtcGxlcyBhbmQgZnVydGhlciBzcGVjaWZpY2F0aW9ucywgcmVmZXIgdG8gdGhlXG4gKiB7QGxpbmsgaHR0cHM6Ly9naXRodWIuY29tL2dvb2dsZS9wcm90b2J1Zi9ibG9iL21hc3Rlci9zcmMvZ29vZ2xlL3Byb3RvYnVmL3RpbWVzdGFtcC5wcm90byB8IFRpbWVzdGFtcCBkZWZpbml0aW9ufS5cbiAqL1xuY2xhc3MgaXQge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGltZXN0YW1wLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlY29uZHMgLSBUaGUgbnVtYmVyIG9mIHNlY29uZHMgb2YgVVRDIHRpbWUgc2luY2UgVW5peCBlcG9jaFxuICAgICAqICAgICAxOTcwLTAxLTAxVDAwOjAwOjAwWi4gTXVzdCBiZSBmcm9tIDAwMDEtMDEtMDFUMDA6MDA6MDBaIHRvXG4gICAgICogICAgIDk5OTktMTItMzFUMjM6NTk6NTlaIGluY2x1c2l2ZS5cbiAgICAgKiBAcGFyYW0gbmFub3NlY29uZHMgLSBUaGUgbm9uLW5lZ2F0aXZlIGZyYWN0aW9ucyBvZiBhIHNlY29uZCBhdCBuYW5vc2Vjb25kXG4gICAgICogICAgIHJlc29sdXRpb24uIE5lZ2F0aXZlIHNlY29uZCB2YWx1ZXMgd2l0aCBmcmFjdGlvbnMgbXVzdCBzdGlsbCBoYXZlXG4gICAgICogICAgIG5vbi1uZWdhdGl2ZSBuYW5vc2Vjb25kcyB2YWx1ZXMgdGhhdCBjb3VudCBmb3J3YXJkIGluIHRpbWUuIE11c3QgYmVcbiAgICAgKiAgICAgZnJvbSAwIHRvIDk5OSw5OTksOTk5IGluY2x1c2l2ZS5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbnVtYmVyIG9mIHNlY29uZHMgb2YgVVRDIHRpbWUgc2luY2UgVW5peCBlcG9jaCAxOTcwLTAxLTAxVDAwOjAwOjAwWi5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgZnJhY3Rpb25zIG9mIGEgc2Vjb25kIGF0IG5hbm9zZWNvbmQgcmVzb2x1dGlvbi4qXG4gICAgICovXG4gICAgZSkge1xuICAgICAgICBpZiAodGhpcy5zZWNvbmRzID0gdCwgdGhpcy5uYW5vc2Vjb25kcyA9IGUsIGUgPCAwKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIG5hbm9zZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyBlKTtcbiAgICAgICAgaWYgKGUgPj0gMWU5KSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIG5hbm9zZWNvbmRzIG91dCBvZiByYW5nZTogXCIgKyBlKTtcbiAgICAgICAgaWYgKHQgPCAtNjIxMzU1OTY4MDApIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJUaW1lc3RhbXAgc2Vjb25kcyBvdXQgb2YgcmFuZ2U6IFwiICsgdCk7XG4gICAgICAgIC8vIFRoaXMgd2lsbCBicmVhayBpbiB0aGUgeWVhciAxMCwwMDAuXG4gICAgICAgICAgICAgICAgaWYgKHQgPj0gMjUzNDAyMzAwODAwKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiVGltZXN0YW1wIHNlY29uZHMgb3V0IG9mIHJhbmdlOiBcIiArIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcCB3aXRoIHRoZSBjdXJyZW50IGRhdGUsIHdpdGggbWlsbGlzZWNvbmQgcHJlY2lzaW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMgYSBuZXcgdGltZXN0YW1wIHJlcHJlc2VudGluZyB0aGUgY3VycmVudCBkYXRlLlxuICAgICAqLyAgICBzdGF0aWMgbm93KCkge1xuICAgICAgICByZXR1cm4gaXQuZnJvbU1pbGxpcyhEYXRlLm5vdygpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0aW1lc3RhbXAgZnJvbSB0aGUgZ2l2ZW4gZGF0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkYXRlIC0gVGhlIGRhdGUgdG8gaW5pdGlhbGl6ZSB0aGUgYFRpbWVzdGFtcGAgZnJvbS5cbiAgICAgKiBAcmV0dXJucyBBIG5ldyBgVGltZXN0YW1wYCByZXByZXNlbnRpbmcgdGhlIHNhbWUgcG9pbnQgaW4gdGltZSBhcyB0aGUgZ2l2ZW5cbiAgICAgKiAgICAgZGF0ZS5cbiAgICAgKi8gICAgc3RhdGljIGZyb21EYXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIGl0LmZyb21NaWxsaXModC5nZXRUaW1lKCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IHRpbWVzdGFtcCBmcm9tIHRoZSBnaXZlbiBudW1iZXIgb2YgbWlsbGlzZWNvbmRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIG1pbGxpc2Vjb25kcyAtIE51bWJlciBvZiBtaWxsaXNlY29uZHMgc2luY2UgVW5peCBlcG9jaFxuICAgICAqICAgICAxOTcwLTAxLTAxVDAwOjAwOjAwWi5cbiAgICAgKiBAcmV0dXJucyBBIG5ldyBgVGltZXN0YW1wYCByZXByZXNlbnRpbmcgdGhlIHNhbWUgcG9pbnQgaW4gdGltZSBhcyB0aGUgZ2l2ZW5cbiAgICAgKiAgICAgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcy5cbiAgICAgKi8gICAgc3RhdGljIGZyb21NaWxsaXModCkge1xuICAgICAgICBjb25zdCBlID0gTWF0aC5mbG9vcih0IC8gMWUzKSwgbiA9IE1hdGguZmxvb3IoMWU2ICogKHQgLSAxZTMgKiBlKSk7XG4gICAgICAgIHJldHVybiBuZXcgaXQoZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIGEgYFRpbWVzdGFtcGAgdG8gYSBKYXZhU2NyaXB0IGBEYXRlYCBvYmplY3QuIFRoaXMgY29udmVyc2lvblxuICAgICAqIGNhdXNlcyBhIGxvc3Mgb2YgcHJlY2lzaW9uIHNpbmNlIGBEYXRlYCBvYmplY3RzIG9ubHkgc3VwcG9ydCBtaWxsaXNlY29uZFxuICAgICAqIHByZWNpc2lvbi5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEphdmFTY3JpcHQgYERhdGVgIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIHNhbWUgcG9pbnQgaW4gdGltZSBhc1xuICAgICAqICAgICB0aGlzIGBUaW1lc3RhbXBgLCB3aXRoIG1pbGxpc2Vjb25kIHByZWNpc2lvbi5cbiAgICAgKi8gICAgdG9EYXRlKCkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUodGhpcy50b01pbGxpcygpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgYSBgVGltZXN0YW1wYCB0byBhIG51bWVyaWMgdGltZXN0YW1wIChpbiBtaWxsaXNlY29uZHMgc2luY2VcbiAgICAgKiBlcG9jaCkuIFRoaXMgb3BlcmF0aW9uIGNhdXNlcyBhIGxvc3Mgb2YgcHJlY2lzaW9uLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIHBvaW50IGluIHRpbWUgY29ycmVzcG9uZGluZyB0byB0aGlzIHRpbWVzdGFtcCwgcmVwcmVzZW50ZWQgYXNcbiAgICAgKiAgICAgdGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgc2luY2UgVW5peCBlcG9jaCAxOTcwLTAxLTAxVDAwOjAwOjAwWi5cbiAgICAgKi8gICAgdG9NaWxsaXMoKSB7XG4gICAgICAgIHJldHVybiAxZTMgKiB0aGlzLnNlY29uZHMgKyB0aGlzLm5hbm9zZWNvbmRzIC8gMWU2O1xuICAgIH1cbiAgICBfY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2Vjb25kcyA9PT0gdC5zZWNvbmRzID8gZXQodGhpcy5uYW5vc2Vjb25kcywgdC5uYW5vc2Vjb25kcykgOiBldCh0aGlzLnNlY29uZHMsIHQuc2Vjb25kcyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBUaW1lc3RhbXBgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYFRpbWVzdGFtcGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgVGltZXN0YW1wYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHQuc2Vjb25kcyA9PT0gdGhpcy5zZWNvbmRzICYmIHQubmFub3NlY29uZHMgPT09IHRoaXMubmFub3NlY29uZHM7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgdGV4dHVhbCByZXByZXNlbnRhdGlvbiBvZiB0aGlzIGBUaW1lc3RhbXBgLiAqLyAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiVGltZXN0YW1wKHNlY29uZHM9XCIgKyB0aGlzLnNlY29uZHMgKyBcIiwgbmFub3NlY29uZHM9XCIgKyB0aGlzLm5hbm9zZWNvbmRzICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgVGltZXN0YW1wYC4gKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2Vjb25kczogdGhpcy5zZWNvbmRzLFxuICAgICAgICAgICAgbmFub3NlY29uZHM6IHRoaXMubmFub3NlY29uZHNcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29udmVydHMgdGhpcyBvYmplY3QgdG8gYSBwcmltaXRpdmUgc3RyaW5nLCB3aGljaCBhbGxvd3MgYFRpbWVzdGFtcGAgb2JqZWN0c1xuICAgICAqIHRvIGJlIGNvbXBhcmVkIHVzaW5nIHRoZSBgPmAsIGA8PWAsIGA+PWAgYW5kIGA+YCBvcGVyYXRvcnMuXG4gICAgICovICAgIHZhbHVlT2YoKSB7XG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIHJldHVybnMgYSBzdHJpbmcgb2YgdGhlIGZvcm0gPHNlY29uZHM+LjxuYW5vc2Vjb25kcz4gd2hlcmVcbiAgICAgICAgLy8gPHNlY29uZHM+IGlzIHRyYW5zbGF0ZWQgdG8gaGF2ZSBhIG5vbi1uZWdhdGl2ZSB2YWx1ZSBhbmQgYm90aCA8c2Vjb25kcz5cbiAgICAgICAgLy8gYW5kIDxuYW5vc2Vjb25kcz4gYXJlIGxlZnQtcGFkZGVkIHdpdGggemVyb2VzIHRvIGJlIGEgY29uc2lzdGVudCBsZW5ndGguXG4gICAgICAgIC8vIFN0cmluZ3Mgd2l0aCB0aGlzIGZvcm1hdCB0aGVuIGhhdmUgYSBsZXhpb2dyYXBoaWNhbCBvcmRlcmluZyB0aGF0IG1hdGNoZXNcbiAgICAgICAgLy8gdGhlIGV4cGVjdGVkIG9yZGVyaW5nLiBUaGUgPHNlY29uZHM+IHRyYW5zbGF0aW9uIGlzIGRvbmUgdG8gYXZvaWQgaGF2aW5nXG4gICAgICAgIC8vIGEgbGVhZGluZyBuZWdhdGl2ZSBzaWduIChpLmUuIGEgbGVhZGluZyAnLScgY2hhcmFjdGVyKSBpbiBpdHMgc3RyaW5nXG4gICAgICAgIC8vIHJlcHJlc2VudGF0aW9uLCB3aGljaCB3b3VsZCBhZmZlY3QgaXRzIGxleGlvZ3JhcGhpY2FsIG9yZGVyaW5nLlxuICAgICAgICBjb25zdCB0ID0gdGhpcy5zZWNvbmRzIC0gLTYyMTM1NTk2ODAwO1xuICAgICAgICAvLyBOb3RlOiBVcCB0byAxMiBkZWNpbWFsIGRpZ2l0cyBhcmUgcmVxdWlyZWQgdG8gcmVwcmVzZW50IGFsbCB2YWxpZFxuICAgICAgICAvLyAnc2Vjb25kcycgdmFsdWVzLlxuICAgICAgICAgICAgICAgIHJldHVybiBTdHJpbmcodCkucGFkU3RhcnQoMTIsIFwiMFwiKSArIFwiLlwiICsgU3RyaW5nKHRoaXMubmFub3NlY29uZHMpLnBhZFN0YXJ0KDksIFwiMFwiKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgdmVyc2lvbiBvZiBhIGRvY3VtZW50IGluIEZpcmVzdG9yZS4gVGhpcyBjb3JyZXNwb25kcyB0byB0aGUgdmVyc2lvblxuICogdGltZXN0YW1wLCBzdWNoIGFzIHVwZGF0ZV90aW1lIG9yIHJlYWRfdGltZS5cbiAqLyBjbGFzcyBydCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tVGltZXN0YW1wKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBydCh0KTtcbiAgICB9XG4gICAgc3RhdGljIG1pbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBydChuZXcgaXQoMCwgMCkpO1xuICAgIH1cbiAgICBzdGF0aWMgbWF4KCkge1xuICAgICAgICByZXR1cm4gbmV3IHJ0KG5ldyBpdCgyNTM0MDIzMDA3OTksIDk5OTk5OTk5OSkpO1xuICAgIH1cbiAgICBjb21wYXJlVG8odCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuX2NvbXBhcmVUbyh0LnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy50aW1lc3RhbXAuaXNFcXVhbCh0LnRpbWVzdGFtcCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgbnVtYmVyIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB2ZXJzaW9uIGZvciB1c2UgaW4gc3BlYyB0ZXN0cy4gKi8gICAgdG9NaWNyb3NlY29uZHMoKSB7XG4gICAgICAgIC8vIENvbnZlcnQgdG8gbWljcm9zZWNvbmRzLlxuICAgICAgICByZXR1cm4gMWU2ICogdGhpcy50aW1lc3RhbXAuc2Vjb25kcyArIHRoaXMudGltZXN0YW1wLm5hbm9zZWNvbmRzIC8gMWUzO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIFwiU25hcHNob3RWZXJzaW9uKFwiICsgdGhpcy50aW1lc3RhbXAudG9TdHJpbmcoKSArIFwiKVwiO1xuICAgIH1cbiAgICB0b1RpbWVzdGFtcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGF0aCByZXByZXNlbnRzIGFuIG9yZGVyZWQgc2VxdWVuY2Ugb2Ygc3RyaW5nIHNlZ21lbnRzLlxuICovXG5jbGFzcyBvdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB2b2lkIDAgPT09IGUgPyBlID0gMCA6IGUgPiB0Lmxlbmd0aCAmJiAkKCksIHZvaWQgMCA9PT0gbiA/IG4gPSB0Lmxlbmd0aCAtIGUgOiBuID4gdC5sZW5ndGggLSBlICYmICQoKSwgXG4gICAgICAgIHRoaXMuc2VnbWVudHMgPSB0LCB0aGlzLm9mZnNldCA9IGUsIHRoaXMubGVuID0gbjtcbiAgICB9XG4gICAgZ2V0IGxlbmd0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVuO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IG90LmNvbXBhcmF0b3IodGhpcywgdCk7XG4gICAgfVxuICAgIGNoaWxkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuc2VnbWVudHMuc2xpY2UodGhpcy5vZmZzZXQsIHRoaXMubGltaXQoKSk7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2Ygb3QgPyB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5wdXNoKHQpO1xuICAgICAgICB9KSkgOiBlLnB1c2godCksIHRoaXMuY29uc3RydWN0KGUpO1xuICAgIH1cbiAgICAvKiogVGhlIGluZGV4IG9mIG9uZSBwYXN0IHRoZSBsYXN0IHNlZ21lbnQgb2YgdGhlIHBhdGguICovICAgIGxpbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmxlbmd0aDtcbiAgICB9XG4gICAgcG9wRmlyc3QodCkge1xuICAgICAgICByZXR1cm4gdCA9IHZvaWQgMCA9PT0gdCA/IDEgOiB0LCB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCArIHQsIHRoaXMubGVuZ3RoIC0gdCk7XG4gICAgfVxuICAgIHBvcExhc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdCh0aGlzLnNlZ21lbnRzLCB0aGlzLm9mZnNldCwgdGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZmlyc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZWdtZW50c1t0aGlzLm9mZnNldF07XG4gICAgfVxuICAgIGxhc3RTZWdtZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXQodGhpcy5sZW5ndGggLSAxKTtcbiAgICB9XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc2VnbWVudHNbdGhpcy5vZmZzZXQgKyB0XTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMubGVuZ3RoO1xuICAgIH1cbiAgICBpc1ByZWZpeE9mKHQpIHtcbiAgICAgICAgaWYgKHQubGVuZ3RoIDwgdGhpcy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgZSA9IDA7IGUgPCB0aGlzLmxlbmd0aDsgZSsrKSBpZiAodGhpcy5nZXQoZSkgIT09IHQuZ2V0KGUpKSByZXR1cm4gITE7XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgaXNJbW1lZGlhdGVQYXJlbnRPZih0KSB7XG4gICAgICAgIGlmICh0aGlzLmxlbmd0aCArIDEgIT09IHQubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgICAgIGZvciAobGV0IGUgPSAwOyBlIDwgdGhpcy5sZW5ndGg7IGUrKykgaWYgKHRoaXMuZ2V0KGUpICE9PSB0LmdldChlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBmb3IgKGxldCBlID0gdGhpcy5vZmZzZXQsIG4gPSB0aGlzLmxpbWl0KCk7IGUgPCBuOyBlKyspIHQodGhpcy5zZWdtZW50c1tlXSk7XG4gICAgfVxuICAgIHRvQXJyYXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNlZ21lbnRzLnNsaWNlKHRoaXMub2Zmc2V0LCB0aGlzLmxpbWl0KCkpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBNYXRoLm1pbih0Lmxlbmd0aCwgZS5sZW5ndGgpO1xuICAgICAgICBmb3IgKGxldCBzID0gMDsgcyA8IG47IHMrKykge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuZ2V0KHMpLCBpID0gZS5nZXQocyk7XG4gICAgICAgICAgICBpZiAobiA8IGkpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGlmIChuID4gaSkgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQubGVuZ3RoIDwgZS5sZW5ndGggPyAtMSA6IHQubGVuZ3RoID4gZS5sZW5ndGggPyAxIDogMDtcbiAgICB9XG59XG5cbi8qKlxuICogQSBzbGFzaC1zZXBhcmF0ZWQgcGF0aCBmb3IgbmF2aWdhdGluZyByZXNvdXJjZXMgKGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMpXG4gKiB3aXRoaW4gRmlyZXN0b3JlLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIHV0IGV4dGVuZHMgb3Qge1xuICAgIGNvbnN0cnVjdCh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQodCwgZSwgbik7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgLy8gTk9URTogVGhlIGNsaWVudCBpcyBpZ25vcmFudCBvZiBhbnkgcGF0aCBzZWdtZW50cyBjb250YWluaW5nIGVzY2FwZVxuICAgICAgICAvLyBzZXF1ZW5jZXMgKGUuZy4gX19pZDEyM19fKSBhbmQganVzdCBwYXNzZXMgdGhlbSB0aHJvdWdoIHJhdyAodGhleSBleGlzdFxuICAgICAgICAvLyBmb3IgbGVnYWN5IHJlYXNvbnMgYW5kIHNob3VsZCBub3QgYmUgdXNlZCBmcmVxdWVudGx5KS5cbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLmpvaW4oXCIvXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSByZXNvdXJjZSBwYXRoIGZyb20gdGhlIGdpdmVuIHNsYXNoLWRlbGltaXRlZCBzdHJpbmcuIElmIG11bHRpcGxlXG4gICAgICogYXJndW1lbnRzIGFyZSBwcm92aWRlZCwgYWxsIGNvbXBvbmVudHMgYXJlIGNvbWJpbmVkLiBMZWFkaW5nIGFuZCB0cmFpbGluZ1xuICAgICAqIHNsYXNoZXMgZnJvbSBhbGwgY29tcG9uZW50cyBhcmUgaWdub3JlZC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21TdHJpbmcoLi4udCkge1xuICAgICAgICAvLyBOT1RFOiBUaGUgY2xpZW50IGlzIGlnbm9yYW50IG9mIGFueSBwYXRoIHNlZ21lbnRzIGNvbnRhaW5pbmcgZXNjYXBlXG4gICAgICAgIC8vIHNlcXVlbmNlcyAoZS5nLiBfX2lkMTIzX18pIGFuZCBqdXN0IHBhc3NlcyB0aGVtIHRocm91Z2ggcmF3ICh0aGV5IGV4aXN0XG4gICAgICAgIC8vIGZvciBsZWdhY3kgcmVhc29ucyBhbmQgc2hvdWxkIG5vdCBiZSB1c2VkIGZyZXF1ZW50bHkpLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSB7XG4gICAgICAgICAgICBpZiAobi5pbmRleE9mKFwiLy9cIikgPj0gMCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBzZWdtZW50ICgke259KS4gUGF0aHMgbXVzdCBub3QgY29udGFpbiAvLyBpbiB0aGVtLmApO1xuICAgICAgICAgICAgLy8gU3RyaXAgbGVhZGluZyBhbmQgdHJhbGluZyBzbGFzaGVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wdXNoKC4uLm4uc3BsaXQoXCIvXCIpLmZpbHRlcigodCA9PiB0Lmxlbmd0aCA+IDApKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyB1dChlKTtcbiAgICB9XG4gICAgc3RhdGljIGVtcHR5UGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1dChbXSk7XG4gICAgfVxufVxuXG5jb25zdCBjdCA9IC9eW19hLXpBLVpdW19hLXpBLVowLTldKiQvO1xuXG4vKipcbiAqIEEgZG90LXNlcGFyYXRlZCBwYXRoIGZvciBuYXZpZ2F0aW5nIHN1Yi1vYmplY3RzIHdpdGhpbiBhIGRvY3VtZW50LlxuICogQGludGVybmFsXG4gKi8gY2xhc3MgYXQgZXh0ZW5kcyBvdCB7XG4gICAgY29uc3RydWN0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhdCh0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBzdHJpbmcgY291bGQgYmUgdXNlZCBhcyBhIHNlZ21lbnQgaW4gYSBmaWVsZCBwYXRoXG4gICAgICogd2l0aG91dCBlc2NhcGluZy5cbiAgICAgKi8gICAgc3RhdGljIGlzVmFsaWRJZGVudGlmaWVyKHQpIHtcbiAgICAgICAgcmV0dXJuIGN0LnRlc3QodCk7XG4gICAgfVxuICAgIGNhbm9uaWNhbFN0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudG9BcnJheSgpLm1hcCgodCA9PiAodCA9IHQucmVwbGFjZSgvXFxcXC9nLCBcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL2AvZywgXCJcXFxcYFwiKSwgXG4gICAgICAgIGF0LmlzVmFsaWRJZGVudGlmaWVyKHQpIHx8ICh0ID0gXCJgXCIgKyB0ICsgXCJgXCIpLCB0KSkpLmpvaW4oXCIuXCIpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpZWxkIHJlZmVyZW5jZXMgdGhlIGtleSBvZiBhIGRvY3VtZW50LlxuICAgICAqLyAgICBpc0tleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gMSA9PT0gdGhpcy5sZW5ndGggJiYgXCJfX25hbWVfX1wiID09PSB0aGlzLmdldCgwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGZpZWxkIGRlc2lnbmF0aW5nIHRoZSBrZXkgb2YgYSBkb2N1bWVudC5cbiAgICAgKi8gICAgc3RhdGljIGtleUZpZWxkKCkge1xuICAgICAgICByZXR1cm4gbmV3IGF0KFsgXCJfX25hbWVfX1wiIF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBmaWVsZCBzdHJpbmcgZnJvbSB0aGUgZ2l2ZW4gc2VydmVyLWZvcm1hdHRlZCBzdHJpbmcuXG4gICAgICpcbiAgICAgKiAtIFNwbGl0dGluZyB0aGUgZW1wdHkgc3RyaW5nIGlzIG5vdCBhbGxvd2VkIChmb3Igbm93IGF0IGxlYXN0KS5cbiAgICAgKiAtIEVtcHR5IHNlZ21lbnRzIHdpdGhpbiB0aGUgc3RyaW5nIChlLmcuIGlmIHRoZXJlIGFyZSB0d28gY29uc2VjdXRpdmVcbiAgICAgKiAgIHNlcGFyYXRvcnMpIGFyZSBub3QgYWxsb3dlZC5cbiAgICAgKlxuICAgICAqIFRPRE8oYi8zNzI0NDE1Nyk6IHdlIHNob3VsZCBtYWtlIHRoaXMgbW9yZSBzdHJpY3QuIFJpZ2h0IG5vdywgaXQgYWxsb3dzXG4gICAgICogbm9uLWlkZW50aWZpZXIgcGF0aCBjb21wb25lbnRzLCBldmVuIGlmIHRoZXkgYXJlbid0IGVzY2FwZWQuXG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VydmVyRm9ybWF0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICBsZXQgbiA9IFwiXCIsIHMgPSAwO1xuICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKDAgPT09IG4ubGVuZ3RoKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIGZpZWxkIHBhdGggKCR7dH0pLiBQYXRocyBtdXN0IG5vdCBiZSBlbXB0eSwgYmVnaW4gd2l0aCAnLicsIGVuZCB3aXRoICcuJywgb3IgY29udGFpbiAnLi4nYCk7XG4gICAgICAgICAgICBlLnB1c2gobiksIG4gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBsZXQgciA9ICExO1xuICAgICAgICBmb3IgKDtzIDwgdC5sZW5ndGg7ICkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRbc107XG4gICAgICAgICAgICBpZiAoXCJcXFxcXCIgPT09IGUpIHtcbiAgICAgICAgICAgICAgICBpZiAocyArIDEgPT09IHQubGVuZ3RoKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgdHJhaWxpbmcgZXNjYXBlIGNoYXJhY3RlcjogXCIgKyB0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdFtzICsgMV07XG4gICAgICAgICAgICAgICAgaWYgKFwiXFxcXFwiICE9PSBlICYmIFwiLlwiICE9PSBlICYmIFwiYFwiICE9PSBlKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiUGF0aCBoYXMgaW52YWxpZCBlc2NhcGUgc2VxdWVuY2U6IFwiICsgdCk7XG4gICAgICAgICAgICAgICAgbiArPSBlLCBzICs9IDI7XG4gICAgICAgICAgICB9IGVsc2UgXCJgXCIgPT09IGUgPyAociA9ICFyLCBzKyspIDogXCIuXCIgIT09IGUgfHwgciA/IChuICs9IGUsIHMrKykgOiAoaSgpLCBzKyspO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpKCksIHIpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJVbnRlcm1pbmF0ZWQgYCBpbiBwYXRoOiBcIiArIHQpO1xuICAgICAgICByZXR1cm4gbmV3IGF0KGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHlQYXRoKCkge1xuICAgICAgICByZXR1cm4gbmV3IGF0KFtdKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIGh0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGF0aCA9IHQ7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tUGF0aCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaHQodXQuZnJvbVN0cmluZyh0KSk7XG4gICAgfVxuICAgIHN0YXRpYyBmcm9tTmFtZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgaHQodXQuZnJvbVN0cmluZyh0KS5wb3BGaXJzdCg1KSk7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBodCh1dC5lbXB0eVBhdGgoKSk7XG4gICAgfVxuICAgIGdldCBjb2xsZWN0aW9uR3JvdXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhdGgucG9wTGFzdCgpLmxhc3RTZWdtZW50KCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGRvY3VtZW50IGlzIGluIHRoZSBzcGVjaWZpZWQgY29sbGVjdGlvbklkLiAqLyAgICBoYXNDb2xsZWN0aW9uSWQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmxlbmd0aCA+PSAyICYmIHRoaXMucGF0aC5nZXQodGhpcy5wYXRoLmxlbmd0aCAtIDIpID09PSB0O1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBncm91cCAoaS5lLiB0aGUgbmFtZSBvZiB0aGUgcGFyZW50IGNvbGxlY3Rpb24pIGZvciB0aGlzIGtleS4gKi8gICAgZ2V0Q29sbGVjdGlvbkdyb3VwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLmdldCh0aGlzLnBhdGgubGVuZ3RoIC0gMik7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRoZSBmdWxseSBxdWFsaWZpZWQgcGF0aCB0byB0aGUgcGFyZW50IGNvbGxlY3Rpb24uICovICAgIGdldENvbGxlY3Rpb25QYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYXRoLnBvcExhc3QoKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0ICYmIDAgPT09IHV0LmNvbXBhcmF0b3IodGhpcy5wYXRoLCB0LnBhdGgpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGF0aC50b1N0cmluZygpO1xuICAgIH1cbiAgICBzdGF0aWMgY29tcGFyYXRvcih0LCBlKSB7XG4gICAgICAgIHJldHVybiB1dC5jb21wYXJhdG9yKHQucGF0aCwgZS5wYXRoKTtcbiAgICB9XG4gICAgc3RhdGljIGlzRG9jdW1lbnRLZXkodCkge1xuICAgICAgICByZXR1cm4gdC5sZW5ndGggJSAyID09IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYW5kIHJldHVybnMgYSBuZXcgZG9jdW1lbnQga2V5IHdpdGggdGhlIGdpdmVuIHNlZ21lbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHNlZ21lbnRzIC0gVGhlIHNlZ21lbnRzIG9mIHRoZSBwYXRoIHRvIHRoZSBkb2N1bWVudFxuICAgICAqIEByZXR1cm5zIEEgbmV3IGluc3RhbmNlIG9mIERvY3VtZW50S2V5XG4gICAgICovICAgIHN0YXRpYyBmcm9tU2VnbWVudHModCkge1xuICAgICAgICByZXR1cm4gbmV3IGh0KG5ldyB1dCh0LnNsaWNlKCkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBpbml0aWFsIG11dGF0aW9uIGJhdGNoIGlkIGZvciBlYWNoIGluZGV4LiBHZXRzIHVwZGF0ZWQgZHVyaW5nIGluZGV4XG4gKiBiYWNrZmlsbC5cbiAqL1xuLyoqXG4gKiBBbiBpbmRleCBkZWZpbml0aW9uIGZvciBmaWVsZCBpbmRleGVzIGluIEZpcmVzdG9yZS5cbiAqXG4gKiBFdmVyeSBpbmRleCBpcyBhc3NvY2lhdGVkIHdpdGggYSBjb2xsZWN0aW9uLiBUaGUgZGVmaW5pdGlvbiBjb250YWlucyBhIGxpc3RcbiAqIG9mIGZpZWxkcyBhbmQgdGhlaXIgaW5kZXgga2luZCAod2hpY2ggY2FuIGJlIGBBU0NFTkRJTkdgLCBgREVTQ0VORElOR2Agb3JcbiAqIGBDT05UQUlOU2AgZm9yIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBxdWVyaWVzKS5cbiAqXG4gKiBVbmxpa2UgdGhlIGJhY2tlbmQsIHRoZSBTREsgZG9lcyBub3QgZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGNvbGxlY3Rpb24gb3JcbiAqIGNvbGxlY3Rpb24gZ3JvdXAtc2NvcGVkIGluZGljZXMuIEV2ZXJ5IGluZGV4IGNhbiBiZSB1c2VkIGZvciBib3RoIHNpbmdsZVxuICogY29sbGVjdGlvbiBhbmQgY29sbGVjdGlvbiBncm91cCBxdWVyaWVzLlxuICovXG5jbGFzcyBsdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGluZGV4IElELiBSZXR1cm5zIC0xIGlmIHRoZSBpbmRleCBJRCBpcyBub3QgYXZhaWxhYmxlIChlLmcuIHRoZSBpbmRleFxuICAgICAqIGhhcyBub3QgeWV0IGJlZW4gcGVyc2lzdGVkKS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIGNvbGxlY3Rpb24gSUQgdGhpcyBpbmRleCBhcHBsaWVzIHRvLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUgZmllbGQgc2VnbWVudHMgZm9yIHRoaXMgaW5kZXguICovXG4gICAgbiwgXG4gICAgLyoqIFNob3dzIGhvdyB1cC10by1kYXRlIHRoZSBpbmRleCBpcyBmb3IgdGhlIGN1cnJlbnQgdXNlci4gKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuaW5kZXhJZCA9IHQsIHRoaXMuY29sbGVjdGlvbkdyb3VwID0gZSwgdGhpcy5maWVsZHMgPSBuLCB0aGlzLmluZGV4U3RhdGUgPSBzO1xuICAgIH1cbn1cblxuLyoqIEFuIElEIGZvciBhbiBpbmRleCB0aGF0IGhhcyBub3QgeWV0IGJlZW4gYWRkZWQgdG8gcGVyc2lzdGVuY2UuICAqL1xuLyoqIFJldHVybnMgdGhlIEFycmF5Q29udGFpbnMvQXJyYXlDb250YWluc0FueSBzZWdtZW50IGZvciB0aGlzIGluZGV4LiAqL1xuZnVuY3Rpb24gZnQodCkge1xuICAgIHJldHVybiB0LmZpZWxkcy5maW5kKCh0ID0+IDIgLyogSW5kZXhLaW5kLkNPTlRBSU5TICovID09PSB0LmtpbmQpKTtcbn1cblxuLyoqIFJldHVybnMgYWxsIGRpcmVjdGlvbmFsIChhc2NlbmRpbmcvZGVzY2VuZGluZykgc2VnbWVudHMgZm9yIHRoaXMgaW5kZXguICovIGZ1bmN0aW9uIGR0KHQpIHtcbiAgICByZXR1cm4gdC5maWVsZHMuZmlsdGVyKCh0ID0+IDIgLyogSW5kZXhLaW5kLkNPTlRBSU5TICovICE9PSB0LmtpbmQpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBvcmRlciBvZiB0aGUgZG9jdW1lbnQga2V5IGNvbXBvbmVudCBmb3IgdGhlIGdpdmVuIGluZGV4LlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgaW4gdGhlIFdlYiBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24uXG4gKi9cbi8qKlxuICogQ29tcGFyZXMgaW5kZXhlcyBieSBjb2xsZWN0aW9uIGdyb3VwIGFuZCBzZWdtZW50cy4gSWdub3JlcyB1cGRhdGUgdGltZSBhbmRcbiAqIGluZGV4IElELlxuICovXG5mdW5jdGlvbiBfdCh0LCBlKSB7XG4gICAgbGV0IG4gPSBldCh0LmNvbGxlY3Rpb25Hcm91cCwgZS5jb2xsZWN0aW9uR3JvdXApO1xuICAgIGlmICgwICE9PSBuKSByZXR1cm4gbjtcbiAgICBmb3IgKGxldCBzID0gMDsgcyA8IE1hdGgubWluKHQuZmllbGRzLmxlbmd0aCwgZS5maWVsZHMubGVuZ3RoKTsgKytzKSBpZiAobiA9IG10KHQuZmllbGRzW3NdLCBlLmZpZWxkc1tzXSksIFxuICAgIDAgIT09IG4pIHJldHVybiBuO1xuICAgIHJldHVybiBldCh0LmZpZWxkcy5sZW5ndGgsIGUuZmllbGRzLmxlbmd0aCk7XG59XG5cbi8qKiBSZXR1cm5zIGEgZGVidWcgcmVwcmVzZW50YXRpb24gb2YgdGhlIGZpZWxkIGluZGV4ICovIGx0LlVOS05PV05fSUQgPSAtMTtcblxuLyoqIEFuIGluZGV4IGNvbXBvbmVudCBjb25zaXN0aW5nIG9mIGZpZWxkIHBhdGggYW5kIGluZGV4IHR5cGUuICAqL1xuY2xhc3Mgd3Qge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgZmllbGQgcGF0aCBvZiB0aGUgY29tcG9uZW50LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgZmllbGRzIHNvcnRpbmcgb3JkZXIuICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLmZpZWxkUGF0aCA9IHQsIHRoaXMua2luZCA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBtdCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGF0LmNvbXBhcmF0b3IodC5maWVsZFBhdGgsIGUuZmllbGRQYXRoKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiBldCh0LmtpbmQsIGUua2luZCk7XG59XG5cbi8qKlxuICogU3RvcmVzIHRoZSBcImhpZ2ggd2F0ZXIgbWFya1wiIHRoYXQgaW5kaWNhdGVzIGhvdyB1cGRhdGVkIHRoZSBJbmRleCBpcyBmb3IgdGhlXG4gKiBjdXJyZW50IHVzZXIuXG4gKi8gY2xhc3MgZ3Qge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEluZGljYXRlcyB3aGVuIHRoZSBpbmRleCB3YXMgbGFzdCB1cGRhdGVkIChyZWxhdGl2ZSB0byBvdGhlciBpbmRleGVzKS5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKiogVGhlIHRoZSBsYXRlc3QgaW5kZXhlZCByZWFkIHRpbWUsIGRvY3VtZW50IGFuZCBiYXRjaCBpZC4gKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMuc2VxdWVuY2VOdW1iZXIgPSB0LCB0aGlzLm9mZnNldCA9IGU7XG4gICAgfVxuICAgIC8qKiBUaGUgc3RhdGUgb2YgYW4gaW5kZXggdGhhdCBoYXMgbm90IHlldCBiZWVuIGJhY2tmaWxsZWQuICovICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBndCgwLCBJdC5taW4oKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gb2Zmc2V0IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzIHdpdGggYSByZWFkIHRpbWUgaGlnaGVyIHRoYW5cbiAqIGByZWFkVGltZWAuXG4gKi8gZnVuY3Rpb24geXQodCwgZSkge1xuICAgIC8vIFdlIHdhbnQgdG8gY3JlYXRlIGFuIG9mZnNldCB0aGF0IG1hdGNoZXMgYWxsIGRvY3VtZW50cyB3aXRoIGEgcmVhZCB0aW1lXG4gICAgLy8gZ3JlYXRlciB0aGFuIHRoZSBwcm92aWRlZCByZWFkIHRpbWUuIFRvIGRvIHNvLCB3ZSB0ZWNobmljYWxseSBuZWVkIHRvXG4gICAgLy8gY3JlYXRlIGFuIG9mZnNldCBmb3IgYChyZWFkVGltZSwgTUFYX0RPQ1VNRU5UX0tFWSlgLiBXaGlsZSB3ZSBjb3VsZCB1c2VcbiAgICAvLyBVbmljb2RlIGNvZGVwb2ludHMgdG8gZ2VuZXJhdGUgTUFYX0RPQ1VNRU5UX0tFWSwgaXQgaXMgbXVjaCBlYXNpZXIgdG8gdXNlXG4gICAgLy8gYChyZWFkVGltZSArIDEsIERvY3VtZW50S2V5LmVtcHR5KCkpYCBzaW5jZSBgPiBEb2N1bWVudEtleS5lbXB0eSgpYCBtYXRjaGVzXG4gICAgLy8gYWxsIHZhbGlkIGRvY3VtZW50IElEcy5cbiAgICBjb25zdCBuID0gdC50b1RpbWVzdGFtcCgpLnNlY29uZHMsIHMgPSB0LnRvVGltZXN0YW1wKCkubmFub3NlY29uZHMgKyAxLCBpID0gcnQuZnJvbVRpbWVzdGFtcCgxZTkgPT09IHMgPyBuZXcgaXQobiArIDEsIDApIDogbmV3IGl0KG4sIHMpKTtcbiAgICByZXR1cm4gbmV3IEl0KGksIGh0LmVtcHR5KCksIGUpO1xufVxuXG4vKiogQ3JlYXRlcyBhIG5ldyBvZmZzZXQgYmFzZWQgb24gdGhlIHByb3ZpZGVkIGRvY3VtZW50LiAqLyBmdW5jdGlvbiBwdCh0KSB7XG4gICAgcmV0dXJuIG5ldyBJdCh0LnJlYWRUaW1lLCB0LmtleSwgLTEpO1xufVxuXG4vKipcbiAqIFN0b3JlcyB0aGUgbGF0ZXN0IHJlYWQgdGltZSwgZG9jdW1lbnQgYW5kIGJhdGNoIElEIHRoYXQgd2VyZSBwcm9jZXNzZWQgZm9yIGFuXG4gKiBpbmRleC5cbiAqLyBjbGFzcyBJdCB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqXG4gICAgICogVGhlIGxhdGVzdCByZWFkIHRpbWUgdmVyc2lvbiB0aGF0IGhhcyBiZWVuIGluZGV4ZWQgYnkgRmlyZXN0b3JlIGZvciB0aGlzXG4gICAgICogZmllbGQgaW5kZXguXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIGtleSBvZiB0aGUgbGFzdCBkb2N1bWVudCB0aGF0IHdhcyBpbmRleGVkIGZvciB0aGlzIHF1ZXJ5LiBVc2VcbiAgICAgKiBgRG9jdW1lbnRLZXkuZW1wdHkoKWAgaWYgbm8gZG9jdW1lbnQgaGFzIGJlZW4gaW5kZXhlZC5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKlxuICAgICAqIFRoZSBsYXJnZXN0IG11dGF0aW9uIGJhdGNoIGlkIHRoYXQncyBiZWVuIHByb2Nlc3NlZCBieSBGaXJlc3RvcmUuXG4gICAgICovXG4gICAgbikge1xuICAgICAgICB0aGlzLnJlYWRUaW1lID0gdCwgdGhpcy5kb2N1bWVudEtleSA9IGUsIHRoaXMubGFyZ2VzdEJhdGNoSWQgPSBuO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhbiBvZmZzZXQgdGhhdCBzb3J0cyBiZWZvcmUgYWxsIHJlZ3VsYXIgb2Zmc2V0cy4gKi8gICAgc3RhdGljIG1pbigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJdChydC5taW4oKSwgaHQuZW1wdHkoKSwgLTEpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhbiBvZmZzZXQgdGhhdCBzb3J0cyBhZnRlciBhbGwgcmVndWxhciBvZmZzZXRzLiAqLyAgICBzdGF0aWMgbWF4KCkge1xuICAgICAgICByZXR1cm4gbmV3IEl0KHJ0Lm1heCgpLCBodC5lbXB0eSgpLCAtMSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBUdCh0LCBlKSB7XG4gICAgbGV0IG4gPSB0LnJlYWRUaW1lLmNvbXBhcmVUbyhlLnJlYWRUaW1lKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiAobiA9IGh0LmNvbXBhcmF0b3IodC5kb2N1bWVudEtleSwgZS5kb2N1bWVudEtleSksIDAgIT09IG4gPyBuIDogZXQodC5sYXJnZXN0QmF0Y2hJZCwgZS5sYXJnZXN0QmF0Y2hJZCkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBFdCA9IFwiVGhlIGN1cnJlbnQgdGFiIGlzIG5vdCBpbiB0aGUgcmVxdWlyZWQgc3RhdGUgdG8gcGVyZm9ybSB0aGlzIG9wZXJhdGlvbi4gSXQgbWlnaHQgYmUgbmVjZXNzYXJ5IHRvIHJlZnJlc2ggdGhlIGJyb3dzZXIgdGFiLlwiO1xuXG4vKipcbiAqIEEgYmFzZSBjbGFzcyByZXByZXNlbnRpbmcgYSBwZXJzaXN0ZW5jZSB0cmFuc2FjdGlvbiwgZW5jYXBzdWxhdGluZyBib3RoIHRoZVxuICogdHJhbnNhY3Rpb24ncyBzZXF1ZW5jZSBudW1iZXJzIGFzIHdlbGwgYXMgYSBsaXN0IG9mIG9uQ29tbWl0dGVkIGxpc3RlbmVycy5cbiAqXG4gKiBXaGVuIHlvdSBjYWxsIFBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKCksIGl0IHdpbGwgY3JlYXRlIGEgdHJhbnNhY3Rpb24gYW5kXG4gKiBwYXNzIGl0IHRvIHlvdXIgY2FsbGJhY2suIFlvdSB0aGVuIHBhc3MgaXQgdG8gYW55IG1ldGhvZCB0aGF0IG9wZXJhdGVzXG4gKiBvbiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBBdCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMgPSBbXTtcbiAgICB9XG4gICAgYWRkT25Db21taXR0ZWRMaXN0ZW5lcih0KSB7XG4gICAgICAgIHRoaXMub25Db21taXR0ZWRMaXN0ZW5lcnMucHVzaCh0KTtcbiAgICB9XG4gICAgcmFpc2VPbkNvbW1pdHRlZEV2ZW50KCkge1xuICAgICAgICB0aGlzLm9uQ29tbWl0dGVkTGlzdGVuZXJzLmZvckVhY2goKHQgPT4gdCgpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBWZXJpZmllcyB0aGUgZXJyb3IgdGhyb3duIGJ5IGEgTG9jYWxTdG9yZSBvcGVyYXRpb24uIElmIGEgTG9jYWxTdG9yZVxuICogb3BlcmF0aW9uIGZhaWxzIGJlY2F1c2UgdGhlIHByaW1hcnkgbGVhc2UgaGFzIGJlZW4gdGFrZW4gYnkgYW5vdGhlciBjbGllbnQsXG4gKiB3ZSBpZ25vcmUgdGhlIGVycm9yICh0aGUgcGVyc2lzdGVuY2UgbGF5ZXIgd2lsbCBpbW1lZGlhdGVseSBjYWxsXG4gKiBgYXBwbHlQcmltYXJ5TGVhc2VgIHRvIHByb3BhZ2F0ZSB0aGUgcHJpbWFyeSBzdGF0ZSBjaGFuZ2UpLiBBbGwgb3RoZXIgZXJyb3JzXG4gKiBhcmUgcmUtdGhyb3duLlxuICpcbiAqIEBwYXJhbSBlcnIgLSBBbiBlcnJvciByZXR1cm5lZCBieSBhIExvY2FsU3RvcmUgb3BlcmF0aW9uLlxuICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgYWZ0ZXIgd2UgcmVjb3ZlcmVkLCBvciB0aGUgb3JpZ2luYWwgZXJyb3IuXG4gKi8gYXN5bmMgZnVuY3Rpb24gUnQodCkge1xuICAgIGlmICh0LmNvZGUgIT09IHEuRkFJTEVEX1BSRUNPTkRJVElPTiB8fCB0Lm1lc3NhZ2UgIT09IEV0KSB0aHJvdyB0O1xuICAgIE4oXCJMb2NhbFN0b3JlXCIsIFwiVW5leHBlY3RlZGx5IGxvc3QgcHJpbWFyeSBsZWFzZVwiKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUGVyc2lzdGVuY2VQcm9taXNlIGlzIGVzc2VudGlhbGx5IGEgcmUtaW1wbGVtZW50YXRpb24gb2YgUHJvbWlzZSBleGNlcHRcbiAqIGl0IGhhcyBhIC5uZXh0KCkgbWV0aG9kIGluc3RlYWQgb2YgLnRoZW4oKSBhbmQgLm5leHQoKSBhbmQgLmNhdGNoKCkgY2FsbGJhY2tzXG4gKiBhcmUgZXhlY3V0ZWQgc3luY2hyb25vdXNseSB3aGVuIGEgUGVyc2lzdGVuY2VQcm9taXNlIHJlc29sdmVzIHJhdGhlciB0aGFuXG4gKiBhc3luY2hyb25vdXNseSAoUHJvbWlzZSBpbXBsZW1lbnRhdGlvbnMgdXNlIHNldEltbWVkaWF0ZSgpIG9yIHNpbWlsYXIpLlxuICpcbiAqIFRoaXMgaXMgbmVjZXNzYXJ5IHRvIGludGVyb3BlcmF0ZSB3aXRoIEluZGV4ZWREQiB3aGljaCB3aWxsIGF1dG9tYXRpY2FsbHlcbiAqIGNvbW1pdCB0cmFuc2FjdGlvbnMgaWYgY29udHJvbCBpcyByZXR1cm5lZCB0byB0aGUgZXZlbnQgbG9vcCB3aXRob3V0XG4gKiBzeW5jaHJvbm91c2x5IGluaXRpYXRpbmcgYW5vdGhlciBvcGVyYXRpb24gb24gdGhlIHRyYW5zYWN0aW9uLlxuICpcbiAqIE5PVEU6IC50aGVuKCkgYW5kIC5jYXRjaCgpIG9ubHkgYWxsb3cgYSBzaW5nbGUgY29uc3VtZXIsIHVubGlrZSBub3JtYWxcbiAqIFByb21pc2VzLlxuICovIGNsYXNzIHZ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIC8vIE5PVEU6IG5leHQvY2F0Y2hDYWxsYmFjayB3aWxsIGFsd2F5cyBwb2ludCB0byBvdXIgb3duIHdyYXBwZXIgZnVuY3Rpb25zLFxuICAgICAgICAvLyBub3QgdGhlIHVzZXIncyByYXcgbmV4dCgpIG9yIGNhdGNoKCkgY2FsbGJhY2tzLlxuICAgICAgICB0aGlzLm5leHRDYWxsYmFjayA9IG51bGwsIHRoaXMuY2F0Y2hDYWxsYmFjayA9IG51bGwsIFxuICAgICAgICAvLyBXaGVuIHRoZSBvcGVyYXRpb24gcmVzb2x2ZXMsIHdlJ2xsIHNldCByZXN1bHQgb3IgZXJyb3IgYW5kIG1hcmsgaXNEb25lLlxuICAgICAgICB0aGlzLnJlc3VsdCA9IHZvaWQgMCwgdGhpcy5lcnJvciA9IHZvaWQgMCwgdGhpcy5pc0RvbmUgPSAhMSwgXG4gICAgICAgIC8vIFNldCB0byB0cnVlIHdoZW4gLnRoZW4oKSBvciAuY2F0Y2goKSBhcmUgY2FsbGVkIGFuZCBwcmV2ZW50cyBhZGRpdGlvbmFsXG4gICAgICAgIC8vIGNoYWluaW5nLlxuICAgICAgICB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMSwgdCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLnJlc3VsdCA9IHQsIHRoaXMubmV4dENhbGxiYWNrICYmIFxuICAgICAgICAgICAgLy8gdmFsdWUgc2hvdWxkIGJlIGRlZmluZWQgdW5sZXNzIFQgaXMgVm9pZCwgYnV0IHdlIGNhbid0IGV4cHJlc3NcbiAgICAgICAgICAgIC8vIHRoYXQgaW4gdGhlIHR5cGUgc3lzdGVtLlxuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sodCk7XG4gICAgICAgIH0pLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmlzRG9uZSA9ICEwLCB0aGlzLmVycm9yID0gdCwgdGhpcy5jYXRjaENhbGxiYWNrICYmIHRoaXMuY2F0Y2hDYWxsYmFjayh0KTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBjYXRjaCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5leHQodm9pZCAwLCB0KTtcbiAgICB9XG4gICAgbmV4dCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgJiYgJCgpLCB0aGlzLmNhbGxiYWNrQXR0YWNoZWQgPSAhMCwgdGhpcy5pc0RvbmUgPyB0aGlzLmVycm9yID8gdGhpcy53cmFwRmFpbHVyZShlLCB0aGlzLmVycm9yKSA6IHRoaXMud3JhcFN1Y2Nlc3ModCwgdGhpcy5yZXN1bHQpIDogbmV3IHZ0KCgobiwgcykgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0Q2FsbGJhY2sgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBTdWNjZXNzKHQsIGUpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9LCB0aGlzLmNhdGNoQ2FsbGJhY2sgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLndyYXBGYWlsdXJlKGUsIHQpLm5leHQobiwgcyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHRvUHJvbWlzZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5uZXh0KHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHdyYXBVc2VyRnVuY3Rpb24odCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQoKTtcbiAgICAgICAgICAgIHJldHVybiBlIGluc3RhbmNlb2YgdnQgPyBlIDogdnQucmVzb2x2ZShlKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgcmV0dXJuIHZ0LnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB3cmFwU3VjY2Vzcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiB2dC5yZXNvbHZlKGUpO1xuICAgIH1cbiAgICB3cmFwRmFpbHVyZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0ID8gdGhpcy53cmFwVXNlckZ1bmN0aW9uKCgoKSA9PiB0KGUpKSkgOiB2dC5yZWplY3QoZSk7XG4gICAgfVxuICAgIHN0YXRpYyByZXNvbHZlKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB2dCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGUodCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc3RhdGljIHJlamVjdCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdnQoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBuKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHN0YXRpYyB3YWl0Rm9yKFxuICAgIC8vIEFjY2VwdCBhbGwgUHJvbWlzZSB0eXBlcyBpbiB3YWl0Rm9yKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdnQoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICBsZXQgcyA9IDAsIGkgPSAwLCByID0gITE7XG4gICAgICAgICAgICB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgICAgICsrcywgdC5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICsraSwgciAmJiBpID09PSBzICYmIGUoKTtcbiAgICAgICAgICAgICAgICB9KSwgKHQgPT4gbih0KSkpO1xuICAgICAgICAgICAgfSkpLCByID0gITAsIGkgPT09IHMgJiYgZSgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdpdmVuIGFuIGFycmF5IG9mIHByZWRpY2F0ZSBmdW5jdGlvbnMgdGhhdCBhc3luY2hyb25vdXNseSBldmFsdWF0ZSB0byBhXG4gICAgICogYm9vbGVhbiwgaW1wbGVtZW50cyBhIHNob3J0LWNpcmN1aXRpbmcgYG9yYCBiZXR3ZWVuIHRoZSByZXN1bHRzLiBQcmVkaWNhdGVzXG4gICAgICogd2lsbCBiZSBldmFsdWF0ZWQgdW50aWwgb25lIG9mIHRoZW0gcmV0dXJucyBgdHJ1ZWAsIHRoZW4gc3RvcC4gVGhlIGZpbmFsXG4gICAgICogcmVzdWx0IHdpbGwgYmUgd2hldGhlciBhbnkgb2YgdGhlbSByZXR1cm5lZCBgdHJ1ZWAuXG4gICAgICovICAgIHN0YXRpYyBvcih0KSB7XG4gICAgICAgIGxldCBlID0gdnQucmVzb2x2ZSghMSk7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSBlID0gZS5uZXh0KCh0ID0+IHQgPyB2dC5yZXNvbHZlKHQpIDogbigpKSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBzdGF0aWMgZm9yRWFjaCh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4ucHVzaChlLmNhbGwodGhpcywgdCwgcykpO1xuICAgICAgICB9KSksIHRoaXMud2FpdEZvcihuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29uY3VycmVudGx5IG1hcCBhbGwgYXJyYXkgZWxlbWVudHMgdGhyb3VnaCBhc3luY2hyb25vdXMgZnVuY3Rpb24uXG4gICAgICovICAgIHN0YXRpYyBtYXBBcnJheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgdnQoKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdC5sZW5ndGgsIHIgPSBuZXcgQXJyYXkoaSk7XG4gICAgICAgICAgICBsZXQgbyA9IDA7XG4gICAgICAgICAgICBmb3IgKGxldCB1ID0gMDsgdSA8IGk7IHUrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGMgPSB1O1xuICAgICAgICAgICAgICAgIGUodFtjXSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJbY10gPSB0LCArK28sIG8gPT09IGkgJiYgbihyKTtcbiAgICAgICAgICAgICAgICB9KSwgKHQgPT4gcyh0KSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFuIGFsdGVybmF0aXZlIHRvIHJlY3Vyc2l2ZSBQZXJzaXN0ZW5jZVByb21pc2UgY2FsbHMsIHRoYXQgYXZvaWRzXG4gICAgICogcG90ZW50aWFsIG1lbW9yeSBwcm9ibGVtcyBmcm9tIHVuYm91bmRlZCBjaGFpbnMgb2YgcHJvbWlzZXMuXG4gICAgICpcbiAgICAgKiBUaGUgYGFjdGlvbmAgd2lsbCBiZSBjYWxsZWQgcmVwZWF0ZWRseSB3aGlsZSBgY29uZGl0aW9uYCBpcyB0cnVlLlxuICAgICAqLyAgICBzdGF0aWMgZG9XaGlsZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgdnQoKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICEwID09PSB0KCkgPyBlKCkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpKCk7XG4gICAgICAgICAgICAgICAgfSksIHMpIDogbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGkoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIFJlZmVyZW5jZXMgdG8gYHdpbmRvd2AgYXJlIGd1YXJkZWQgYnkgU2ltcGxlRGIuaXNBdmFpbGFibGUoKVxuLyogZXNsaW50LWRpc2FibGUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzICovXG4vKipcbiAqIFdyYXBzIGFuIElEQlRyYW5zYWN0aW9uIGFuZCBleHBvc2VzIGEgc3RvcmUoKSBtZXRob2QgdG8gZ2V0IGEgaGFuZGxlIHRvIGFcbiAqIHNwZWNpZmljIG9iamVjdCBzdG9yZS5cbiAqL1xuY2xhc3MgUHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5hY3Rpb24gPSB0LCB0aGlzLnRyYW5zYWN0aW9uID0gZSwgdGhpcy5hYm9ydGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBgUHJvbWlzZWAgdGhhdCByZXNvbHZlcyB3aXRoIHRoZSByZXN1bHQgb2YgdGhlIEluZGV4ZWREYiB0cmFuc2FjdGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuUiA9IG5ldyBLLCB0aGlzLnRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLlIucmVzb2x2ZSgpO1xuICAgICAgICB9LCB0aGlzLnRyYW5zYWN0aW9uLm9uYWJvcnQgPSAoKSA9PiB7XG4gICAgICAgICAgICBlLmVycm9yID8gdGhpcy5SLnJlamVjdChuZXcgU3QodCwgZS5lcnJvcikpIDogdGhpcy5SLnJlc29sdmUoKTtcbiAgICAgICAgfSwgdGhpcy50cmFuc2FjdGlvbi5vbmVycm9yID0gZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0ga3QoZS50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgdGhpcy5SLnJlamVjdChuZXcgU3QodCwgbikpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICBzdGF0aWMgb3Blbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFB0KGUsIHQudHJhbnNhY3Rpb24ocywgbikpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgU3QoZSwgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHYoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlIucHJvbWlzZTtcbiAgICB9XG4gICAgYWJvcnQodCkge1xuICAgICAgICB0ICYmIHRoaXMuUi5yZWplY3QodCksIHRoaXMuYWJvcnRlZCB8fCAoTihcIlNpbXBsZURiXCIsIFwiQWJvcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQgPyB0Lm1lc3NhZ2UgOiBcIkNsaWVudC1pbml0aWF0ZWQgYWJvcnRcIiksIFxuICAgICAgICB0aGlzLmFib3J0ZWQgPSAhMCwgdGhpcy50cmFuc2FjdGlvbi5hYm9ydCgpKTtcbiAgICB9XG4gICAgUCgpIHtcbiAgICAgICAgLy8gSWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgVjMgSW5kZXhlZERCLCB3ZSBpbnZva2UgY29tbWl0KCkgZXhwbGljaXRseSB0b1xuICAgICAgICAvLyBzcGVlZCB1cCBpbmRleCBEQiBwcm9jZXNzaW5nIGlmIHRoZSBldmVudCBsb29wIHJlbWFpbnMgYmxvY2tzLlxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueVxuICAgICAgICBjb25zdCB0ID0gdGhpcy50cmFuc2FjdGlvbjtcbiAgICAgICAgdGhpcy5hYm9ydGVkIHx8IFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgdC5jb21taXQgfHwgdC5jb21taXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFNpbXBsZURiU3RvcmU8S2V5VHlwZSwgVmFsdWVUeXBlPiBmb3IgdGhlIHNwZWNpZmllZCBzdG9yZS4gQWxsXG4gICAgICogb3BlcmF0aW9ucyBwZXJmb3JtZWQgb24gdGhlIFNpbXBsZURiU3RvcmUgaGFwcGVuIHdpdGhpbiB0aGUgY29udGV4dCBvZiB0aGlzXG4gICAgICogdHJhbnNhY3Rpb24gYW5kIGl0IGNhbm5vdCBiZSB1c2VkIGFueW1vcmUgb25jZSB0aGUgdHJhbnNhY3Rpb24gaXNcbiAgICAgKiBjb21wbGV0ZWQuXG4gICAgICpcbiAgICAgKiBOb3RlIHRoYXQgd2UgY2FuJ3QgYWN0dWFsbHkgZW5mb3JjZSB0aGF0IHRoZSBLZXlUeXBlIGFuZCBWYWx1ZVR5cGUgYXJlXG4gICAgICogY29ycmVjdCwgYnV0IHRoZXkgYWxsb3cgdHlwZSBzYWZldHkgdGhyb3VnaCB0aGUgcmVzdCBvZiB0aGUgY29uc3VtaW5nIGNvZGUuXG4gICAgICovICAgIHN0b3JlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMudHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUodCk7XG4gICAgICAgIHJldHVybiBuZXcgQ3QoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGEgd3JhcHBlciBhcm91bmQgSW5kZXhlZERiIHdpdGggYSBzaW1wbGlmaWVkIGludGVyZmFjZSB0aGF0IHVzZXNcbiAqIFByb21pc2UtbGlrZSByZXR1cm4gdmFsdWVzIHRvIGNoYWluIG9wZXJhdGlvbnMuIFJlYWwgcHJvbWlzZXMgY2Fubm90IGJlIHVzZWRcbiAqIHNpbmNlIC50aGVuKCkgY29udGludWF0aW9ucyBhcmUgZXhlY3V0ZWQgYXN5bmNocm9ub3VzbHkgKGUuZy4gdmlhXG4gKiAuc2V0SW1tZWRpYXRlKSwgd2hpY2ggd291bGQgY2F1c2UgSW5kZXhlZERCIHRvIGVuZCB0aGUgdHJhbnNhY3Rpb24uXG4gKiBTZWUgUGVyc2lzdGVuY2VQcm9taXNlIGZvciBtb3JlIGRldGFpbHMuXG4gKi8gY2xhc3MgYnQge1xuICAgIC8qXG4gICAgICogQ3JlYXRlcyBhIG5ldyBTaW1wbGVEYiB3cmFwcGVyIGZvciBJbmRleGVkRGIgZGF0YWJhc2UgYG5hbWVgLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGB2ZXJzaW9uYCBtdXN0IG5vdCBiZSBhIGRvd25ncmFkZS4gSW5kZXhlZERCIGRvZXMgbm90IHN1cHBvcnRcbiAgICAgKiBkb3duZ3JhZGluZyB0aGUgc2NoZW1hIHZlcnNpb24uIFdlIGN1cnJlbnRseSBkbyBub3Qgc3VwcG9ydCBhbnkgd2F5IHRvIGRvXG4gICAgICogdmVyc2lvbmluZyBvdXRzaWRlIG9mIEluZGV4ZWREQidzIHZlcnNpb25pbmcgbWVjaGFuaXNtLCBhcyBvbmx5XG4gICAgICogdmVyc2lvbi11cGdyYWRlIHRyYW5zYWN0aW9ucyBhcmUgYWxsb3dlZCB0byBkbyB0aGluZ3MgbGlrZSBjcmVhdGVcbiAgICAgKiBvYmplY3RzdG9yZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLm5hbWUgPSB0LCB0aGlzLnZlcnNpb24gPSBlLCB0aGlzLlYgPSBuO1xuICAgICAgICAvLyBOT1RFOiBBY2NvcmRpbmcgdG8gaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTE5NzA1MCwgdGhlXG4gICAgICAgIC8vIGJ1ZyB3ZSdyZSBjaGVja2luZyBmb3Igc2hvdWxkIGV4aXN0IGluIGlPUyA+PSAxMi4yIGFuZCA8IDEzLCBidXQgZm9yXG4gICAgICAgIC8vIHdoYXRldmVyIHJlYXNvbiBpdCdzIG11Y2ggaGFyZGVyIHRvIGhpdCBhZnRlciAxMi4yIHNvIHdlIG9ubHkgcHJvYWN0aXZlbHlcbiAgICAgICAgLy8gbG9nIG9uIDEyLjIuXG4gICAgICAgIDEyLjIgPT09IGJ0LlMoZ2V0VUEoKSkgJiYgayhcIkZpcmVzdG9yZSBwZXJzaXN0ZW5jZSBzdWZmZXJzIGZyb20gYSBidWcgaW4gaU9TIDEyLjIgU2FmYXJpIHRoYXQgbWF5IGNhdXNlIHlvdXIgYXBwIHRvIHN0b3Agd29ya2luZy4gU2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcS81NjQ5NjI5Ni8xMTA5MTUgZm9yIGRldGFpbHMgYW5kIGEgcG90ZW50aWFsIHdvcmthcm91bmQuXCIpO1xuICAgIH1cbiAgICAvKiogRGVsZXRlcyB0aGUgc3BlY2lmaWVkIGRhdGFiYXNlLiAqLyAgICBzdGF0aWMgZGVsZXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIE4oXCJTaW1wbGVEYlwiLCBcIlJlbW92aW5nIGRhdGFiYXNlOlwiLCB0KSwgeHQod2luZG93LmluZGV4ZWREQi5kZWxldGVEYXRhYmFzZSh0KSkudG9Qcm9taXNlKCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgSW5kZXhlZERCIGlzIGF2YWlsYWJsZSBpbiB0aGUgY3VycmVudCBlbnZpcm9ubWVudC4gKi8gICAgc3RhdGljIEQoKSB7XG4gICAgICAgIGlmICghaXNJbmRleGVkREJBdmFpbGFibGUoKSkgcmV0dXJuICExO1xuICAgICAgICBpZiAoYnQuQygpKSByZXR1cm4gITA7XG4gICAgICAgIC8vIFdlIGV4dGVuc2l2ZWx5IHVzZSBpbmRleGVkIGFycmF5IHZhbHVlcyBhbmQgY29tcG91bmQga2V5cyxcbiAgICAgICAgLy8gd2hpY2ggSUUgYW5kIEVkZ2UgZG8gbm90IHN1cHBvcnQuIEhvd2V2ZXIsIHRoZXkgc3RpbGwgaGF2ZSBpbmRleGVkREJcbiAgICAgICAgLy8gZGVmaW5lZCBvbiB0aGUgd2luZG93LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIGZvciB0aGVtIGhlcmUgYW5kIG1ha2Ugc3VyZVxuICAgICAgICAvLyB0byByZXR1cm4gdGhhdCBwZXJzaXN0ZW5jZSBpcyBub3QgZW5hYmxlZCBmb3IgdGhvc2UgYnJvd3NlcnMuXG4gICAgICAgIC8vIEZvciB0cmFja2luZyBzdXBwb3J0IG9mIHRoaXMgZmVhdHVyZSwgc2VlIGhlcmU6XG4gICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1pY3Jvc29mdC5jb20vZW4tdXMvbWljcm9zb2Z0LWVkZ2UvcGxhdGZvcm0vc3RhdHVzL2luZGV4ZWRkYmFycmF5c2FuZG11bHRpZW50cnlzdXBwb3J0L1xuICAgICAgICAvLyBDaGVjayB0aGUgVUEgc3RyaW5nIHRvIGZpbmQgb3V0IHRoZSBicm93c2VyLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBnZXRVQSgpLCBlID0gYnQuUyh0KSwgbiA9IDAgPCBlICYmIGUgPCAxMCwgcyA9IGJ0Lk4odCksIGkgPSAwIDwgcyAmJiBzIDwgNC41O1xuICAgICAgICAvLyBJRSAxMFxuICAgICAgICAvLyB1YSA9ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgTVNJRSAxMC4wOyBXaW5kb3dzIE5UIDYuMjsgVHJpZGVudC82LjApJztcbiAgICAgICAgLy8gSUUgMTFcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4zOyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbyc7XG4gICAgICAgIC8vIEVkZ2VcbiAgICAgICAgLy8gdWEgPSAnTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsXG4gICAgICAgIC8vIGxpa2UgR2Vja28pIENocm9tZS8zOS4wLjIxNzEuNzEgU2FmYXJpLzUzNy4zNiBFZGdlLzEyLjAnO1xuICAgICAgICAvLyBpT1MgU2FmYXJpOiBEaXNhYmxlIGZvciB1c2VycyBydW5uaW5nIGlPUyB2ZXJzaW9uIDwgMTAuXG4gICAgICAgICAgICAgICAgcmV0dXJuICEodC5pbmRleE9mKFwiTVNJRSBcIikgPiAwIHx8IHQuaW5kZXhPZihcIlRyaWRlbnQvXCIpID4gMCB8fCB0LmluZGV4T2YoXCJFZGdlL1wiKSA+IDAgfHwgbiB8fCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0cnVlIGlmIHRoZSBiYWNraW5nIEluZGV4ZWREQiBzdG9yZSBpcyB0aGUgTm9kZSBJbmRleGVkREJTaGltXG4gICAgICogKHNlZSBodHRwczovL2dpdGh1Yi5jb20vYXhlbWNsaW9uL0luZGV4ZWREQlNoaW0pLlxuICAgICAqLyAgICBzdGF0aWMgQygpIHtcbiAgICAgICAgdmFyIHQ7XG4gICAgICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBwcm9jZXNzICYmIFwiWUVTXCIgPT09IChudWxsID09PSAodCA9IHByb2Nlc3MuZW52KSB8fCB2b2lkIDAgPT09IHQgPyB2b2lkIDAgOiB0LmspO1xuICAgIH1cbiAgICAvKiogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZnJvbSBhIHRyYW5zYWN0aW9uLiAqLyAgICBzdGF0aWMgTSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0LnN0b3JlKGUpO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIGlPUyB2ZXJzaW9uLiBSZXR1cm5zIC0xIGlmIG5vdCBmb3VuZC4gKi9cbiAgICBzdGF0aWMgUyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0Lm1hdGNoKC9pKD86cGhvbmV8cGFkfHBvZCkgb3MgKFtcXGRfXSspL2kpLCBuID0gZSA/IGVbMV0uc3BsaXQoXCJfXCIpLnNsaWNlKDAsIDIpLmpvaW4oXCIuXCIpIDogXCItMVwiO1xuICAgICAgICByZXR1cm4gTnVtYmVyKG4pO1xuICAgIH1cbiAgICAvLyB2aXNpYmxlIGZvciB0ZXN0aW5nXG4gICAgLyoqIFBhcnNlIFVzZXIgQWdlbnQgdG8gZGV0ZXJtaW5lIEFuZHJvaWQgdmVyc2lvbi4gUmV0dXJucyAtMSBpZiBub3QgZm91bmQuICovXG4gICAgc3RhdGljIE4odCkge1xuICAgICAgICBjb25zdCBlID0gdC5tYXRjaCgvQW5kcm9pZCAoW1xcZC5dKykvaSksIG4gPSBlID8gZVsxXS5zcGxpdChcIi5cIikuc2xpY2UoMCwgMikuam9pbihcIi5cIikgOiBcIi0xXCI7XG4gICAgICAgIHJldHVybiBOdW1iZXIobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9wZW5zIHRoZSBzcGVjaWZpZWQgZGF0YWJhc2UsIGNyZWF0aW5nIG9yIHVwZ3JhZGluZyBpdCBpZiBuZWNlc3NhcnkuXG4gICAgICovICAgIGFzeW5jIE8odCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kYiB8fCAoTihcIlNpbXBsZURiXCIsIFwiT3BlbmluZyBkYXRhYmFzZTpcIiwgdGhpcy5uYW1lKSwgdGhpcy5kYiA9IGF3YWl0IG5ldyBQcm9taXNlKCgoZSwgbikgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyhtaWtlbGVoZW4pOiBJbnZlc3RpZ2F0ZSBicm93c2VyIGNvbXBhdGliaWxpdHkuXG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSW5kZXhlZERCX0FQSS9Vc2luZ19JbmRleGVkREJcbiAgICAgICAgICAgIC8vIHN1Z2dlc3RzIElFOSBhbmQgb2xkZXIgV2ViS2l0IGJyb3dzZXJzIGhhbmRsZSB1cGdyYWRlXG4gICAgICAgICAgICAvLyBkaWZmZXJlbnRseS4gVGhleSBleHBlY3Qgc2V0VmVyc2lvbiwgYXMgZGVzY3JpYmVkIGhlcmU6XG4gICAgICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSURCVmVyc2lvbkNoYW5nZVJlcXVlc3Qvc2V0VmVyc2lvblxuICAgICAgICAgICAgY29uc3QgcyA9IGluZGV4ZWREQi5vcGVuKHRoaXMubmFtZSwgdGhpcy52ZXJzaW9uKTtcbiAgICAgICAgICAgIHMub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICBlKG4pO1xuICAgICAgICAgICAgfSwgcy5vbmJsb2NrZWQgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgbihuZXcgU3QodCwgXCJDYW5ub3QgdXBncmFkZSBJbmRleGVkREIgc2NoZW1hIHdoaWxlIGFub3RoZXIgdGFiIGlzIG9wZW4uIENsb3NlIGFsbCB0YWJzIHRoYXQgYWNjZXNzIEZpcmVzdG9yZSBhbmQgcmVsb2FkIHRoaXMgcGFnZSB0byBwcm9jZWVkLlwiKSk7XG4gICAgICAgICAgICB9LCBzLm9uZXJyb3IgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQuZXJyb3I7XG4gICAgICAgICAgICAgICAgXCJWZXJzaW9uRXJyb3JcIiA9PT0gcy5uYW1lID8gbihuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSBuZXdlciB2ZXJzaW9uIG9mIHRoZSBGaXJlc3RvcmUgU0RLIHdhcyBwcmV2aW91c2x5IHVzZWQgYW5kIHNvIHRoZSBwZXJzaXN0ZWQgZGF0YSBpcyBub3QgY29tcGF0aWJsZSB3aXRoIHRoZSB2ZXJzaW9uIG9mIHRoZSBTREsgeW91IGFyZSBub3cgdXNpbmcuIFRoZSBTREsgd2lsbCBvcGVyYXRlIHdpdGggcGVyc2lzdGVuY2UgZGlzYWJsZWQuIElmIHlvdSBuZWVkIHBlcnNpc3RlbmNlLCBwbGVhc2UgcmUtdXBncmFkZSB0byBhIG5ld2VyIHZlcnNpb24gb2YgdGhlIFNESyBvciBlbHNlIGNsZWFyIHRoZSBwZXJzaXN0ZWQgSW5kZXhlZERCIGRhdGEgZm9yIHlvdXIgYXBwIHRvIHN0YXJ0IGZyZXNoLlwiKSkgOiBcIkludmFsaWRTdGF0ZUVycm9yXCIgPT09IHMubmFtZSA/IG4obmV3IFUocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIlVuYWJsZSB0byBvcGVuIGFuIEluZGV4ZWREQiBjb25uZWN0aW9uLiBUaGlzIGNvdWxkIGJlIGR1ZSB0byBydW5uaW5nIGluIGEgcHJpdmF0ZSBicm93c2luZyBzZXNzaW9uIG9uIGEgYnJvd3NlciB3aG9zZSBwcml2YXRlIGJyb3dzaW5nIHNlc3Npb25zIGRvIG5vdCBzdXBwb3J0IEluZGV4ZWREQjogXCIgKyBzKSkgOiBuKG5ldyBTdCh0LCBzKSk7XG4gICAgICAgICAgICB9LCBzLm9udXBncmFkZW5lZWRlZCA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIE4oXCJTaW1wbGVEYlwiLCAnRGF0YWJhc2UgXCInICsgdGhpcy5uYW1lICsgJ1wiIHJlcXVpcmVzIHVwZ3JhZGUgZnJvbSB2ZXJzaW9uOicsIHQub2xkVmVyc2lvbik7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB0aGlzLlYuJChlLCBzLnRyYW5zYWN0aW9uLCB0Lm9sZFZlcnNpb24sIHRoaXMudmVyc2lvbikubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBOKFwiU2ltcGxlRGJcIiwgXCJEYXRhYmFzZSB1cGdyYWRlIHRvIHZlcnNpb24gXCIgKyB0aGlzLnZlcnNpb24gKyBcIiBjb21wbGV0ZVwiKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSkpLCB0aGlzLkYgJiYgKHRoaXMuZGIub252ZXJzaW9uY2hhbmdlID0gdCA9PiB0aGlzLkYodCkpLCB0aGlzLmRiO1xuICAgIH1cbiAgICBCKHQpIHtcbiAgICAgICAgdGhpcy5GID0gdCwgdGhpcy5kYiAmJiAodGhpcy5kYi5vbnZlcnNpb25jaGFuZ2UgPSBlID0+IHQoZSkpO1xuICAgIH1cbiAgICBhc3luYyBydW5UcmFuc2FjdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBcInJlYWRvbmx5XCIgPT09IGU7XG4gICAgICAgIGxldCByID0gMDtcbiAgICAgICAgZm9yICg7Oykge1xuICAgICAgICAgICAgKytyO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLmRiID0gYXdhaXQgdGhpcy5PKHQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBQdC5vcGVuKHRoaXMuZGIsIHQsIGkgPyBcInJlYWRvbmx5XCIgOiBcInJlYWR3cml0ZVwiLCBuKSwgciA9IHMoZSkubmV4dCgodCA9PiAoZS5QKCksIFxuICAgICAgICAgICAgICAgIHQpKSkuY2F0Y2goKHQgPT4gKFxuICAgICAgICAgICAgICAgIC8vIEFib3J0IHRoZSB0cmFuc2FjdGlvbiBpZiB0aGVyZSB3YXMgYW4gZXJyb3IuXG4gICAgICAgICAgICAgICAgZS5hYm9ydCh0KSwgdnQucmVqZWN0KHQpKSkpLnRvUHJvbWlzZSgpO1xuICAgICAgICAgICAgICAgIC8vIEFzIG5vdGVkIGFib3ZlLCBlcnJvcnMgYXJlIHByb3BhZ2F0ZWQgYnkgYWJvcnRpbmcgdGhlIHRyYW5zYWN0aW9uLiBTb1xuICAgICAgICAgICAgICAgIC8vIHdlIHN3YWxsb3cgYW55IGVycm9yIGhlcmUgdG8gYXZvaWQgdGhlIGJyb3dzZXIgbG9nZ2luZyBpdCBhcyB1bmhhbmRsZWQuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuY2F0Y2goKCgpID0+IHt9KSksIFxuICAgICAgICAgICAgICAgIC8vIFdhaXQgZm9yIHRoZSB0cmFuc2FjdGlvbiB0byBjb21wbGV0ZSAoaS5lLiBJbmRleGVkRGIncyBvbnN1Y2Nlc3MgZXZlbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBmaXJlKSwgYnV0IHN0aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgdHJhbnNhY3Rpb25GblJlc3VsdCBiYWNrIHRvIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhbGxlci5cbiAgICAgICAgICAgICAgICBhd2FpdCBlLnYsIHI7XG4gICAgICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQsIG4gPSBcIkZpcmViYXNlRXJyb3JcIiAhPT0gZS5uYW1lICYmIHIgPCAzO1xuICAgICAgICAgICAgICAgIC8vIFRPRE8oc2NobWlkdC1zZWJhc3RpYW4pOiBXZSBjb3VsZCBwcm9iYWJseSBiZSBzbWFydGVyIGFib3V0IHRoaXMgYW5kXG4gICAgICAgICAgICAgICAgLy8gbm90IHJldHJ5IGV4Y2VwdGlvbnMgdGhhdCBhcmUgbGlrZWx5IHVucmVjb3ZlcmFibGUgKHN1Y2ggYXMgcXVvdGFcbiAgICAgICAgICAgICAgICAvLyBleGNlZWRlZCBlcnJvcnMpLlxuICAgICAgICAgICAgICAgIC8vIE5vdGU6IFdlIGNhbm5vdCB1c2UgYW4gaW5zdGFuY2VvZiBjaGVjayBmb3IgRmlyZXN0b3JlRXhjZXB0aW9uLCBzaW5jZSB0aGVcbiAgICAgICAgICAgICAgICAvLyBleGNlcHRpb24gaXMgd3JhcHBlZCBpbiBhIGdlbmVyaWMgZXJyb3IgYnkgb3VyIGFzeW5jL2F3YWl0IGhhbmRsaW5nLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTihcIlNpbXBsZURiXCIsIFwiVHJhbnNhY3Rpb24gZmFpbGVkIHdpdGggZXJyb3I6XCIsIGUubWVzc2FnZSwgXCJSZXRyeWluZzpcIiwgbiksIFxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKSwgIW4pIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5kYiAmJiB0aGlzLmRiLmNsb3NlKCksIHRoaXMuZGIgPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgY29udHJvbGxlciBmb3IgaXRlcmF0aW5nIG92ZXIgYSBrZXkgcmFuZ2Ugb3IgaW5kZXguIEl0IGFsbG93cyBhbiBpdGVyYXRlXG4gKiBjYWxsYmFjayB0byBkZWxldGUgdGhlIGN1cnJlbnRseS1yZWZlcmVuY2VkIG9iamVjdCwgb3IganVtcCB0byBhIG5ldyBrZXlcbiAqIHdpdGhpbiB0aGUga2V5IHJhbmdlIG9yIGluZGV4LlxuICovIGNsYXNzIFZ0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuTCA9IHQsIHRoaXMucSA9ICExLCB0aGlzLlUgPSBudWxsO1xuICAgIH1cbiAgICBnZXQgaXNEb25lKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xO1xuICAgIH1cbiAgICBnZXQgSygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVTtcbiAgICB9XG4gICAgc2V0IGN1cnNvcih0KSB7XG4gICAgICAgIHRoaXMuTCA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgZnVuY3Rpb24gY2FuIGJlIGNhbGxlZCB0byBzdG9wIGl0ZXJhdGlvbiBhdCBhbnkgcG9pbnQuXG4gICAgICovICAgIGRvbmUoKSB7XG4gICAgICAgIHRoaXMucSA9ICEwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGlzIGZ1bmN0aW9uIGNhbiBiZSBjYWxsZWQgdG8gc2tpcCB0byB0aGF0IG5leHQga2V5LCB3aGljaCBjb3VsZCBiZVxuICAgICAqIGFuIGluZGV4IG9yIGEgcHJpbWFyeSBrZXkuXG4gICAgICovICAgIEcodCkge1xuICAgICAgICB0aGlzLlUgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWxldGUgdGhlIGN1cnJlbnQgY3Vyc29yIHZhbHVlIGZyb20gdGhlIG9iamVjdCBzdG9yZS5cbiAgICAgKlxuICAgICAqIE5PVEU6IFlvdSBDQU5OT1QgZG8gdGhpcyB3aXRoIGEga2V5c09ubHkgcXVlcnkuXG4gICAgICovICAgIGRlbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHh0KHRoaXMuTC5kZWxldGUoKSk7XG4gICAgfVxufVxuXG4vKiogQW4gZXJyb3IgdGhhdCB3cmFwcyBleGNlcHRpb25zIHRoYXQgdGhyb3duIGR1cmluZyBJbmRleGVkREIgZXhlY3V0aW9uLiAqLyBjbGFzcyBTdCBleHRlbmRzIFUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIocS5VTkFWQUlMQUJMRSwgYEluZGV4ZWREQiB0cmFuc2FjdGlvbiAnJHt0fScgZmFpbGVkOiAke2V9YCksIHRoaXMubmFtZSA9IFwiSW5kZXhlZERiVHJhbnNhY3Rpb25FcnJvclwiO1xuICAgIH1cbn1cblxuLyoqIFZlcmlmaWVzIHdoZXRoZXIgYGVgIGlzIGFuIEluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IuICovIGZ1bmN0aW9uIER0KHQpIHtcbiAgICAvLyBVc2UgbmFtZSBlcXVhbGl0eSwgYXMgaW5zdGFuY2VvZiBjaGVja3Mgb24gZXJyb3JzIGRvbid0IHdvcmsgd2l0aCBlcnJvcnNcbiAgICAvLyB0aGF0IHdyYXAgb3RoZXIgZXJyb3JzLlxuICAgIHJldHVybiBcIkluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3JcIiA9PT0gdC5uYW1lO1xufVxuXG4vKipcbiAqIEEgd3JhcHBlciBhcm91bmQgYW4gSURCT2JqZWN0U3RvcmUgcHJvdmlkaW5nIGFuIEFQSSB0aGF0OlxuICpcbiAqIDEpIEhhcyBnZW5lcmljIEtleVR5cGUgLyBWYWx1ZVR5cGUgcGFyYW1ldGVycyB0byBwcm92aWRlIHN0cm9uZ2x5LXR5cGVkXG4gKiBtZXRob2RzIGZvciBhY3RpbmcgYWdhaW5zdCB0aGUgb2JqZWN0IHN0b3JlLlxuICogMikgRGVhbHMgd2l0aCBJbmRleGVkREIncyBvbnN1Y2Nlc3MgLyBvbmVycm9yIGV2ZW50IGNhbGxiYWNrcywgbWFraW5nIGV2ZXJ5XG4gKiBtZXRob2QgcmV0dXJuIGEgUGVyc2lzdGVuY2VQcm9taXNlIGluc3RlYWQuXG4gKiAzKSBQcm92aWRlcyBhIGhpZ2hlci1sZXZlbCBBUEkgdG8gYXZvaWQgbmVlZGluZyB0byBkbyBleGNlc3NpdmUgd3JhcHBpbmcgb2ZcbiAqIGludGVybWVkaWF0ZSBJbmRleGVkREIgdHlwZXMgKElEQkN1cnNvcldpdGhWYWx1ZSwgZXRjLilcbiAqLyBjbGFzcyBDdCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnN0b3JlID0gdDtcbiAgICB9XG4gICAgcHV0KHQsIGUpIHtcbiAgICAgICAgbGV0IG47XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IGUgPyAoTihcIlNpbXBsZURiXCIsIFwiUFVUXCIsIHRoaXMuc3RvcmUubmFtZSwgdCwgZSksIG4gPSB0aGlzLnN0b3JlLnB1dChlLCB0KSkgOiAoTihcIlNpbXBsZURiXCIsIFwiUFVUXCIsIHRoaXMuc3RvcmUubmFtZSwgXCI8YXV0by1rZXk+XCIsIHQpLCBcbiAgICAgICAgbiA9IHRoaXMuc3RvcmUucHV0KHQpKSwgeHQobik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgYSBuZXcgdmFsdWUgaW50byBhbiBPYmplY3QgU3RvcmUgYW5kIHJldHVybnMgdGhlIG5ldyBrZXkuIFNpbWlsYXIgdG9cbiAgICAgKiBJbmRleGVkRGIncyBgYWRkKClgLCB0aGlzIG1ldGhvZCB3aWxsIGZhaWwgb24gcHJpbWFyeSBrZXkgY29sbGlzaW9ucy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB2YWx1ZSAtIFRoZSBvYmplY3QgdG8gd3JpdGUuXG4gICAgICogQHJldHVybnMgVGhlIGtleSBvZiB0aGUgdmFsdWUgdG8gYWRkLlxuICAgICAqLyAgICBhZGQodCkge1xuICAgICAgICBOKFwiU2ltcGxlRGJcIiwgXCJBRERcIiwgdGhpcy5zdG9yZS5uYW1lLCB0LCB0KTtcbiAgICAgICAgcmV0dXJuIHh0KHRoaXMuc3RvcmUuYWRkKHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0cyB0aGUgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBrZXkgZnJvbSB0aGUgc3BlY2lmaWVkIHN0b3JlLCBvciBudWxsXG4gICAgICogaWYgbm8gb2JqZWN0IGV4aXN0cyB3aXRoIHRoZSBzcGVjaWZpZWQga2V5LlxuICAgICAqXG4gICAgICogQGtleSBUaGUga2V5IG9mIHRoZSBvYmplY3QgdG8gZ2V0LlxuICAgICAqIEByZXR1cm5zIFRoZSBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSBvciBudWxsIGlmIG5vIG9iamVjdCBleGlzdHMuXG4gICAgICovICAgIGdldCh0KSB7XG4gICAgICAgIC8vIFdlJ3JlIGRvaW5nIGFuIHVuc2FmZSBjYXN0IHRvIFZhbHVlVHlwZS5cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgcmV0dXJuIHh0KHRoaXMuc3RvcmUuZ2V0KHQpKS5uZXh0KChlID0+IChcbiAgICAgICAgLy8gTm9ybWFsaXplIG5vbmV4aXN0ZW5jZSB0byBudWxsLlxuICAgICAgICB2b2lkIDAgPT09IGUgJiYgKGUgPSBudWxsKSwgTihcIlNpbXBsZURiXCIsIFwiR0VUXCIsIHRoaXMuc3RvcmUubmFtZSwgdCwgZSksIGUpKSk7XG4gICAgfVxuICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIE4oXCJTaW1wbGVEYlwiLCBcIkRFTEVURVwiLCB0aGlzLnN0b3JlLm5hbWUsIHQpO1xuICAgICAgICByZXR1cm4geHQodGhpcy5zdG9yZS5kZWxldGUodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJZiB3ZSBldmVyIG5lZWQgbW9yZSBvZiB0aGUgY291bnQgdmFyaWFudHMsIHdlIGNhbiBhZGQgb3ZlcmxvYWRzLiBGb3Igbm93LFxuICAgICAqIGFsbCB3ZSBuZWVkIGlzIHRvIGNvdW50IGV2ZXJ5dGhpbmcgaW4gYSBzdG9yZS5cbiAgICAgKlxuICAgICAqIFJldHVybnMgdGhlIG51bWJlciBvZiByb3dzIGluIHRoZSBzdG9yZS5cbiAgICAgKi8gICAgY291bnQoKSB7XG4gICAgICAgIE4oXCJTaW1wbGVEYlwiLCBcIkNPVU5UXCIsIHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIHJldHVybiB4dCh0aGlzLnN0b3JlLmNvdW50KCkpO1xuICAgIH1cbiAgICBqKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMub3B0aW9ucyh0LCBlKTtcbiAgICAgICAgLy8gVXNlIGBnZXRBbGwoKWAgaWYgdGhlIGJyb3dzZXIgc3VwcG9ydHMgSW5kZXhlZERCIHYzLCBhcyBpdCBpcyByb3VnaGx5XG4gICAgICAgIC8vIDIwJSBmYXN0ZXIuIFVuZm9ydHVuYXRlbHksIGdldEFsbCgpIGRvZXMgbm90IHN1cHBvcnQgY3VzdG9tIGluZGljZXMuXG4gICAgICAgICAgICAgICAgaWYgKG4uaW5kZXggfHwgXCJmdW5jdGlvblwiICE9IHR5cGVvZiB0aGlzLnN0b3JlLmdldEFsbCkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuY3Vyc29yKG4pLCBlID0gW107XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5XKHQsICgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGUucHVzaChuKTtcbiAgICAgICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgICAgIH1cbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuc3RvcmUuZ2V0QWxsKG4ucmFuZ2UpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyB2dCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICB0Lm9uZXJyb3IgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbih0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICAgICAgfSwgdC5vbnN1Y2Nlc3MgPSB0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgZSh0LnRhcmdldC5yZXN1bHQpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9hZHMgdGhlIGZpcnN0IGBjb3VudGAgZWxlbWVudHMgZnJvbSB0aGUgcHJvdmlkZWQgaW5kZXggcmFuZ2UuIExvYWRzIGFsbFxuICAgICAqIGVsZW1lbnRzIGlmIG5vIGxpbWl0IGlzIHByb3ZpZGVkLlxuICAgICAqLyAgICBIKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuZ2V0QWxsKHQsIG51bGwgPT09IGUgPyB2b2lkIDAgOiBlKTtcbiAgICAgICAgcmV0dXJuIG5ldyB2dCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgIG4ub25lcnJvciA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGUodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgfSwgbi5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICB0KGUudGFyZ2V0LnJlc3VsdCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEoodCwgZSkge1xuICAgICAgICBOKFwiU2ltcGxlRGJcIiwgXCJERUxFVEUgQUxMXCIsIHRoaXMuc3RvcmUubmFtZSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLm9wdGlvbnModCwgZSk7XG4gICAgICAgIG4uWSA9ICExO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5jdXJzb3Iobik7XG4gICAgICAgIHJldHVybiB0aGlzLlcocywgKCh0LCBlLCBuKSA9PiBuLmRlbGV0ZSgpKSk7XG4gICAgfVxuICAgIFgodCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgZSA/IG4gPSB0IDogKG4gPSB7fSwgZSA9IHQpO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5jdXJzb3Iobik7XG4gICAgICAgIHJldHVybiB0aGlzLlcocywgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEl0ZXJhdGVzIG92ZXIgYSBzdG9yZSwgYnV0IHdhaXRzIGZvciB0aGUgZ2l2ZW4gY2FsbGJhY2sgdG8gY29tcGxldGUgZm9yXG4gICAgICogZWFjaCBlbnRyeSBiZWZvcmUgaXRlcmF0aW5nIHRoZSBuZXh0IGVudHJ5LiBUaGlzIGFsbG93cyB0aGUgY2FsbGJhY2sgdG8gZG9cbiAgICAgKiBhc3luY2hyb25vdXMgd29yayB0byBkZXRlcm1pbmUgaWYgdGhpcyBpdGVyYXRpb24gc2hvdWxkIGNvbnRpbnVlLlxuICAgICAqXG4gICAgICogVGhlIHByb3ZpZGVkIGNhbGxiYWNrIHNob3VsZCByZXR1cm4gYHRydWVgIHRvIGNvbnRpbnVlIGl0ZXJhdGlvbiwgYW5kXG4gICAgICogYGZhbHNlYCBvdGhlcndpc2UuXG4gICAgICovICAgIFoodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jdXJzb3Ioe30pO1xuICAgICAgICByZXR1cm4gbmV3IHZ0KCgobiwgcykgPT4ge1xuICAgICAgICAgICAgZS5vbmVycm9yID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGt0KHQudGFyZ2V0LmVycm9yKTtcbiAgICAgICAgICAgICAgICBzKGUpO1xuICAgICAgICAgICAgfSwgZS5vbnN1Y2Nlc3MgPSBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgIHMgPyB0KHMucHJpbWFyeUtleSwgcy52YWx1ZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHQgPyBzLmNvbnRpbnVlKCkgOiBuKCk7XG4gICAgICAgICAgICAgICAgfSkpIDogbigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBXKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICByZXR1cm4gbmV3IHZ0KCgocywgaSkgPT4ge1xuICAgICAgICAgICAgdC5vbmVycm9yID0gdCA9PiB7XG4gICAgICAgICAgICAgICAgaSh0LnRhcmdldC5lcnJvcik7XG4gICAgICAgICAgICB9LCB0Lm9uc3VjY2VzcyA9IHQgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSB0LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgaWYgKCFpKSByZXR1cm4gdm9pZCBzKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IG5ldyBWdChpKSwgbyA9IGUoaS5wcmltYXJ5S2V5LCBpLnZhbHVlLCByKTtcbiAgICAgICAgICAgICAgICBpZiAobyBpbnN0YW5jZW9mIHZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBvLmNhdGNoKCh0ID0+IChyLmRvbmUoKSwgdnQucmVqZWN0KHQpKSkpO1xuICAgICAgICAgICAgICAgICAgICBuLnB1c2godCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHIuaXNEb25lID8gcygpIDogbnVsbCA9PT0gci5LID8gaS5jb250aW51ZSgpIDogaS5jb250aW51ZShyLkspO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHZ0LndhaXRGb3IobikpKTtcbiAgICB9XG4gICAgb3B0aW9ucyh0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0ICYmIChcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gbiA9IHQgOiBlID0gdCksIHtcbiAgICAgICAgICAgIGluZGV4OiBuLFxuICAgICAgICAgICAgcmFuZ2U6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY3Vyc29yKHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIm5leHRcIjtcbiAgICAgICAgaWYgKHQucmV2ZXJzZSAmJiAoZSA9IFwicHJldlwiKSwgdC5pbmRleCkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuc3RvcmUuaW5kZXgodC5pbmRleCk7XG4gICAgICAgICAgICByZXR1cm4gdC5ZID8gbi5vcGVuS2V5Q3Vyc29yKHQucmFuZ2UsIGUpIDogbi5vcGVuQ3Vyc29yKHQucmFuZ2UsIGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLnN0b3JlLm9wZW5DdXJzb3IodC5yYW5nZSwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFdyYXBzIGFuIElEQlJlcXVlc3QgaW4gYSBQZXJzaXN0ZW5jZVByb21pc2UsIHVzaW5nIHRoZSBvbnN1Y2Nlc3MgLyBvbmVycm9yXG4gKiBoYW5kbGVycyB0byByZXNvbHZlIC8gcmVqZWN0IHRoZSBQZXJzaXN0ZW5jZVByb21pc2UgYXMgYXBwcm9wcmlhdGUuXG4gKi8gZnVuY3Rpb24geHQodCkge1xuICAgIHJldHVybiBuZXcgdnQoKChlLCBuKSA9PiB7XG4gICAgICAgIHQub25zdWNjZXNzID0gdCA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgZShuKTtcbiAgICAgICAgfSwgdC5vbmVycm9yID0gdCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0ga3QodC50YXJnZXQuZXJyb3IpO1xuICAgICAgICAgICAgbihlKTtcbiAgICAgICAgfTtcbiAgICB9KSk7XG59XG5cbi8vIEd1YXJkIHNvIHdlIG9ubHkgcmVwb3J0IHRoZSBlcnJvciBvbmNlLlxubGV0IE50ID0gITE7XG5cbmZ1bmN0aW9uIGt0KHQpIHtcbiAgICBjb25zdCBlID0gYnQuUyhnZXRVQSgpKTtcbiAgICBpZiAoZSA+PSAxMi4yICYmIGUgPCAxMykge1xuICAgICAgICBjb25zdCBlID0gXCJBbiBpbnRlcm5hbCBlcnJvciB3YXMgZW5jb3VudGVyZWQgaW4gdGhlIEluZGV4ZWQgRGF0YWJhc2Ugc2VydmVyXCI7XG4gICAgICAgIGlmICh0Lm1lc3NhZ2UuaW5kZXhPZihlKSA+PSAwKSB7XG4gICAgICAgICAgICAvLyBXcmFwIGVycm9yIGluIGEgbW9yZSBkZXNjcmlwdGl2ZSBvbmUuXG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IFUoXCJpbnRlcm5hbFwiLCBgSU9TX0lOREVYRUREQl9CVUcxOiBJbmRleGVkRGIgaGFzIHRocm93biAnJHtlfScuIFRoaXMgaXMgbGlrZWx5IGR1ZSB0byBhbiB1bmF2b2lkYWJsZSBidWcgaW4gaU9TLiBTZWUgaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xLzU2NDk2Mjk2LzExMDkxNSBmb3IgZGV0YWlscyBhbmQgYSBwb3RlbnRpYWwgd29ya2Fyb3VuZC5gKTtcbiAgICAgICAgICAgIHJldHVybiBOdCB8fCAoTnQgPSAhMCwgXG4gICAgICAgICAgICAvLyBUaHJvdyBhIGdsb2JhbCBleGNlcHRpb24gb3V0c2lkZSBvZiB0aGlzIHByb21pc2UgY2hhaW4sIGZvciB0aGUgdXNlciB0b1xuICAgICAgICAgICAgLy8gcG90ZW50aWFsbHkgY2F0Y2guXG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhyb3cgdDtcbiAgICAgICAgICAgIH0pLCAwKSksIHQ7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHQ7XG59XG5cbi8qKiBUaGlzIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciB0aGUgc2NoZWR1bGluZyBvZiBJbmRleCBCYWNrZmlsbGVyLiAqL1xuY2xhc3MgTXQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5hc3luY1F1ZXVlID0gdCwgdGhpcy50dCA9IGUsIHRoaXMudGFzayA9IG51bGw7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICB0aGlzLmV0KDE1ZTMpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLnRhc2sgJiYgKHRoaXMudGFzay5jYW5jZWwoKSwgdGhpcy50YXNrID0gbnVsbCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy50YXNrO1xuICAgIH1cbiAgICBldCh0KSB7XG4gICAgICAgIE4oXCJJbmRleEJhY2tpbGxlclwiLCBgU2NoZWR1bGVkIGluICR7dH1tc2ApLCB0aGlzLnRhc2sgPSB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFmdGVyRGVsYXkoXCJpbmRleF9iYWNrZmlsbFwiIC8qIFRpbWVySWQuSW5kZXhCYWNrZmlsbCAqLyAsIHQsIChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnRhc2sgPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBOKFwiSW5kZXhCYWNraWxsZXJcIiwgYERvY3VtZW50cyB3cml0dGVuOiAke2F3YWl0IHRoaXMudHQubnQoKX1gKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBEdCh0KSA/IE4oXCJJbmRleEJhY2tpbGxlclwiLCBcIklnbm9yaW5nIEluZGV4ZWREQiBlcnJvciBkdXJpbmcgaW5kZXggYmFja2ZpbGw6IFwiLCB0KSA6IGF3YWl0IFJ0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5ldCg2ZTQpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKiogSW1wbGVtZW50cyB0aGUgc3RlcHMgZm9yIGJhY2tmaWxsaW5nIGluZGV4ZXMuICovIGNsYXNzIE90IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBMb2NhbFN0b3JlIHByb3ZpZGVzIGFjY2VzcyB0byBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRWaWV3LlxuICAgICAqIFRoZXNlIHByb3BlcnRpZXMgd2lsbCB1cGRhdGUgd2hlbiB0aGUgdXNlciBjaGFuZ2VzLiBDb25zZXF1ZW50bHksXG4gICAgICogbWFraW5nIGEgbG9jYWwgY29weSBvZiBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRWaWV3IHdpbGwgcmVxdWlyZVxuICAgICAqIHVwZGF0ZXMgb3ZlciB0aW1lLiBUaGUgc2ltcGxlciBzb2x1dGlvbiBpcyB0byByZWx5IG9uIExvY2FsU3RvcmUgdG8gaGF2ZVxuICAgICAqIGFuIHVwLXRvLWRhdGUgcmVmZXJlbmNlcyB0byBJbmRleE1hbmFnZXIgYW5kIExvY2FsRG9jdW1lbnRTdG9yZS5cbiAgICAgKi9cbiAgICB0LCBlKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IHQsIHRoaXMucGVyc2lzdGVuY2UgPSBlO1xuICAgIH1cbiAgICBhc3luYyBudCh0ID0gNTApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJCYWNrZmlsbCBJbmRleGVzXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKGUgPT4gdGhpcy5zdChlLCB0KSkpO1xuICAgIH1cbiAgICAvKiogV3JpdGVzIGluZGV4IGVudHJpZXMgdW50aWwgdGhlIGNhcCBpcyByZWFjaGVkLiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHByb2Nlc3NlZC4gKi8gICAgc3QodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IFNldDtcbiAgICAgICAgbGV0IHMgPSBlLCBpID0gITA7XG4gICAgICAgIHJldHVybiB2dC5kb1doaWxlKCgoKSA9PiAhMCA9PT0gaSAmJiBzID4gMCksICgoKSA9PiB0aGlzLmxvY2FsU3RvcmUuaW5kZXhNYW5hZ2VyLmdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSh0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBlICYmICFuLmhhcyhlKSkgcmV0dXJuIE4oXCJJbmRleEJhY2tpbGxlclwiLCBgUHJvY2Vzc2luZyBjb2xsZWN0aW9uOiAke2V9YCksIFxuICAgICAgICAgICAgdGhpcy5pdCh0LCBlLCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICBzIC09IHQsIG4uYWRkKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgaSA9ICExO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBlIC0gcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgZW50cmllcyBmb3IgdGhlIHByb3ZpZGVkIGNvbGxlY3Rpb24gZ3JvdXAuIFJldHVybnMgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgcHJvY2Vzc2VkLlxuICAgICAqLyAgICBpdCh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFVzZSB0aGUgZWFybGllc3Qgb2Zmc2V0IG9mIGFsbCBmaWVsZCBpbmRleGVzIHRvIHF1ZXJ5IHRoZSBsb2NhbCBjYWNoZS5cbiAgICAgICAgcmV0dXJuIHRoaXMubG9jYWxTdG9yZS5pbmRleE1hbmFnZXIuZ2V0TWluT2Zmc2V0RnJvbUNvbGxlY3Rpb25Hcm91cCh0LCBlKS5uZXh0KChzID0+IHRoaXMubG9jYWxTdG9yZS5sb2NhbERvY3VtZW50cy5nZXROZXh0RG9jdW1lbnRzKHQsIGUsIHMsIG4pLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uY2hhbmdlcztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxvY2FsU3RvcmUuaW5kZXhNYW5hZ2VyLnVwZGF0ZUluZGV4RW50cmllcyh0LCBpKS5uZXh0KCgoKSA9PiB0aGlzLnJ0KHMsIG4pKSkubmV4dCgobiA9PiAoTihcIkluZGV4QmFja2lsbGVyXCIsIGBVcGRhdGluZyBvZmZzZXQ6ICR7bn1gKSwgXG4gICAgICAgICAgICB0aGlzLmxvY2FsU3RvcmUuaW5kZXhNYW5hZ2VyLnVwZGF0ZUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuKSkpKS5uZXh0KCgoKSA9PiBpLnNpemUpKTtcbiAgICAgICAgfSkpKSk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRoZSBuZXh0IG9mZnNldCBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgZG9jdW1lbnRzLiAqLyAgICBydCh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gdDtcbiAgICAgICAgcmV0dXJuIGUuY2hhbmdlcy5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IHB0KGUpO1xuICAgICAgICAgICAgVHQocywgbikgPiAwICYmIChuID0gcyk7XG4gICAgICAgIH0pKSwgbmV3IEl0KG4ucmVhZFRpbWUsIG4uZG9jdW1lbnRLZXksIE1hdGgubWF4KGUuYmF0Y2hJZCwgdC5sYXJnZXN0QmF0Y2hJZCkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogYExpc3RlblNlcXVlbmNlYCBpcyBhIG1vbm90b25pYyBzZXF1ZW5jZS4gSXQgaXMgaW5pdGlhbGl6ZWQgd2l0aCBhIG1pbmltdW0gdmFsdWUgdG9cbiAqIGV4Y2VlZC4gQWxsIHN1YnNlcXVlbnQgY2FsbHMgdG8gbmV4dCB3aWxsIHJldHVybiBpbmNyZWFzaW5nIHZhbHVlcy4gSWYgcHJvdmlkZWQgd2l0aCBhXG4gKiBgU2VxdWVuY2VOdW1iZXJTeW5jZXJgLCBpdCB3aWxsIGFkZGl0aW9uYWxseSBidW1wIGl0cyBuZXh0IHZhbHVlIHdoZW4gdG9sZCBvZiBhIG5ldyB2YWx1ZSwgYXNcbiAqIHdlbGwgYXMgd3JpdGUgb3V0IHNlcXVlbmNlIG51bWJlcnMgdGhhdCBpdCBwcm9kdWNlcyB2aWEgYG5leHQoKWAuXG4gKi8gY2xhc3MgJHQge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5wcmV2aW91c1ZhbHVlID0gdCwgZSAmJiAoZS5zZXF1ZW5jZU51bWJlckhhbmRsZXIgPSB0ID0+IHRoaXMub3QodCksIHRoaXMudXQgPSB0ID0+IGUud3JpdGVTZXF1ZW5jZU51bWJlcih0KSk7XG4gICAgfVxuICAgIG90KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJldmlvdXNWYWx1ZSA9IE1hdGgubWF4KHQsIHRoaXMucHJldmlvdXNWYWx1ZSksIHRoaXMucHJldmlvdXNWYWx1ZTtcbiAgICB9XG4gICAgbmV4dCgpIHtcbiAgICAgICAgY29uc3QgdCA9ICsrdGhpcy5wcmV2aW91c1ZhbHVlO1xuICAgICAgICByZXR1cm4gdGhpcy51dCAmJiB0aGlzLnV0KHQpLCB0O1xuICAgIH1cbn1cblxuJHQuY3QgPSAtMTtcblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgYSB2YXJpYWJsZSBpcyBlaXRoZXIgdW5kZWZpbmVkIG9yIG51bGwuXG4gKi9cbmZ1bmN0aW9uIEZ0KHQpIHtcbiAgICByZXR1cm4gbnVsbCA9PSB0O1xufVxuXG4vKiogUmV0dXJucyB3aGV0aGVyIHRoZSB2YWx1ZSByZXByZXNlbnRzIC0wLiAqLyBmdW5jdGlvbiBCdCh0KSB7XG4gICAgLy8gRGV0ZWN0IGlmIHRoZSB2YWx1ZSBpcyAtMC4wLiBCYXNlZCBvbiBwb2x5ZmlsbCBmcm9tXG4gICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvT2JqZWN0L2lzXG4gICAgcmV0dXJuIDAgPT09IHQgJiYgMSAvIHQgPT0gLTEgLyAwO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBhIHZhbHVlIGlzIGFuIGludGVnZXIgYW5kIGluIHRoZSBzYWZlIGludGVnZXIgcmFuZ2VcbiAqIEBwYXJhbSB2YWx1ZSAtIFRoZSB2YWx1ZSB0byB0ZXN0IGZvciBiZWluZyBhbiBpbnRlZ2VyIGFuZCBpbiB0aGUgc2FmZSByYW5nZVxuICovIGZ1bmN0aW9uIEx0KHQpIHtcbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCAmJiBOdW1iZXIuaXNJbnRlZ2VyKHQpICYmICFCdCh0KSAmJiB0IDw9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSICYmIHQgPj0gTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEVuY29kZXMgYSByZXNvdXJjZSBwYXRoIGludG8gYSBJbmRleGVkRGItY29tcGF0aWJsZSBzdHJpbmcgZm9ybS5cbiAqL1xuZnVuY3Rpb24gcXQodCkge1xuICAgIGxldCBlID0gXCJcIjtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIGUubGVuZ3RoID4gMCAmJiAoZSA9IEt0KGUpKSwgZSA9IFV0KHQuZ2V0KG4pLCBlKTtcbiAgICByZXR1cm4gS3QoZSk7XG59XG5cbi8qKiBFbmNvZGVzIGEgc2luZ2xlIHNlZ21lbnQgb2YgYSByZXNvdXJjZSBwYXRoIGludG8gdGhlIGdpdmVuIHJlc3VsdCAqLyBmdW5jdGlvbiBVdCh0LCBlKSB7XG4gICAgbGV0IG4gPSBlO1xuICAgIGNvbnN0IHMgPSB0Lmxlbmd0aDtcbiAgICBmb3IgKGxldCBlID0gMDsgZSA8IHM7IGUrKykge1xuICAgICAgICBjb25zdCBzID0gdC5jaGFyQXQoZSk7XG4gICAgICAgIHN3aXRjaCAocykge1xuICAgICAgICAgIGNhc2UgXCJcXDBcIjpcbiAgICAgICAgICAgIG4gKz0gXCJcdTAwMDFcdTAwMTBcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAwMVwiOlxuICAgICAgICAgICAgbiArPSBcIlx1MDAwMVx1MDAxMVwiO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgbiArPSBzO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuO1xufVxuXG4vKiogRW5jb2RlcyBhIHBhdGggc2VwYXJhdG9yIGludG8gdGhlIGdpdmVuIHJlc3VsdCAqLyBmdW5jdGlvbiBLdCh0KSB7XG4gICAgcmV0dXJuIHQgKyBcIlx1MDAwMVx1MDAwMVwiO1xufVxuXG4vKipcbiAqIERlY29kZXMgdGhlIGdpdmVuIEluZGV4ZWREYi1jb21wYXRpYmxlIHN0cmluZyBmb3JtIG9mIGEgcmVzb3VyY2UgcGF0aCBpbnRvXG4gKiBhIFJlc291cmNlUGF0aCBpbnN0YW5jZS4gTm90ZSB0aGF0IHRoaXMgbWV0aG9kIGlzIG5vdCBzdWl0YWJsZSBmb3IgdXNlIHdpdGhcbiAqIGRlY29kaW5nIHJlc291cmNlIG5hbWVzIGZyb20gdGhlIHNlcnZlcjsgdGhvc2UgYXJlIE9uZSBQbGF0Zm9ybSBmb3JtYXRcbiAqIHN0cmluZ3MuXG4gKi8gZnVuY3Rpb24gR3QodCkge1xuICAgIC8vIEV2ZW50IHRoZSBlbXB0eSBwYXRoIG11c3QgZW5jb2RlIGFzIGEgcGF0aCBvZiBhdCBsZWFzdCBsZW5ndGggMi4gQSBwYXRoXG4gICAgLy8gd2l0aCBleGFjdGx5IDIgbXVzdCBiZSB0aGUgZW1wdHkgcGF0aC5cbiAgICBjb25zdCBlID0gdC5sZW5ndGg7XG4gICAgaWYgKEYoZSA+PSAyKSwgMiA9PT0gZSkgcmV0dXJuIEYoXCJcdTAwMDFcIiA9PT0gdC5jaGFyQXQoMCkgJiYgXCJcdTAwMDFcIiA9PT0gdC5jaGFyQXQoMSkpLCB1dC5lbXB0eVBhdGgoKTtcbiAgICAvLyBFc2NhcGUgY2hhcmFjdGVycyBjYW5ub3QgZXhpc3QgcGFzdCB0aGUgc2Vjb25kLXRvLWxhc3QgcG9zaXRpb24gaW4gdGhlXG4gICAgLy8gc291cmNlIHZhbHVlLlxuICAgICAgICBjb25zdCBfX1BSSVZBVEVfbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCA9IGUgLSAyLCBuID0gW107XG4gICAgbGV0IHMgPSBcIlwiO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZTsgKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHR3byBjaGFyYWN0ZXJzIG9mIGEgdmFsaWQgZW5jb2RlZCBwYXRoIG11c3QgYmUgYSBzZXBhcmF0b3IsIHNvXG4gICAgICAgIC8vIHRoZXJlIG11c3QgYmUgYW4gZW5kIHRvIHRoaXMgc2VnbWVudC5cbiAgICAgICAgY29uc3QgZSA9IHQuaW5kZXhPZihcIlx1MDAwMVwiLCBpKTtcbiAgICAgICAgKGUgPCAwIHx8IGUgPiBfX1BSSVZBVEVfbGFzdFJlYXNvbmFibGVFc2NhcGVJbmRleCkgJiYgJCgpO1xuICAgICAgICBzd2l0Y2ggKHQuY2hhckF0KGUgKyAxKSkge1xuICAgICAgICAgIGNhc2UgXCJcdTAwMDFcIjpcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LnN1YnN0cmluZyhpLCBlKTtcbiAgICAgICAgICAgIGxldCBvO1xuICAgICAgICAgICAgMCA9PT0gcy5sZW5ndGggPyBcbiAgICAgICAgICAgIC8vIEF2b2lkIGNvcHlpbmcgZm9yIHRoZSBjb21tb24gY2FzZSBvZiBhIHNlZ21lbnQgdGhhdCBleGNsdWRlcyBcXDBcbiAgICAgICAgICAgIC8vIGFuZCBcXDAwMVxuICAgICAgICAgICAgbyA9IHIgOiAocyArPSByLCBvID0gcywgcyA9IFwiXCIpLCBuLnB1c2gobyk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCJcdTAwMTBcIjpcbiAgICAgICAgICAgIHMgKz0gdC5zdWJzdHJpbmcoaSwgZSksIHMgKz0gXCJcXDBcIjtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIlx1MDAxMVwiOlxuICAgICAgICAgICAgLy8gVGhlIGVzY2FwZSBjaGFyYWN0ZXIgY2FuIGJlIHVzZWQgaW4gdGhlIG91dHB1dCB0byBlbmNvZGUgaXRzZWxmLlxuICAgICAgICAgICAgcyArPSB0LnN1YnN0cmluZyhpLCBlICsgMSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAkKCk7XG4gICAgICAgIH1cbiAgICAgICAgaSA9IGUgKyAyO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IHV0KG4pO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBRdCA9IFsgXCJ1c2VySWRcIiwgXCJiYXRjaElkXCIgXTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTmFtZSBvZiB0aGUgSW5kZXhlZERiIG9iamVjdCBzdG9yZS5cbiAqXG4gKiBOb3RlIHRoYXQgdGhlIG5hbWUgJ293bmVyJyBpcyBjaG9zZW4gdG8gZW5zdXJlIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGhcbiAqIG9sZGVyIGNsaWVudHMgdGhhdCBvbmx5IHN1cHBvcnRlZCBzaW5nbGUgbG9ja2VkIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2VcbiAqIGxheWVyLlxuICovXG4vKipcbiAqIENyZWF0ZXMgYSBbdXNlcklkLCBlbmNvZGVkUGF0aF0ga2V5IGZvciB1c2UgaW4gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnNcbiAqIGluZGV4IHRvIGl0ZXJhdGUgb3ZlciBhbGwgYXQgZG9jdW1lbnQgbXV0YXRpb25zIGZvciBhIGdpdmVuIHBhdGggb3IgbG93ZXIuXG4gKi9cbmZ1bmN0aW9uIGp0KHQsIGUpIHtcbiAgICByZXR1cm4gWyB0LCBxdChlKSBdO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBmdWxsIGluZGV4IGtleSBvZiBbdXNlcklkLCBlbmNvZGVkUGF0aCwgYmF0Y2hJZF0gZm9yIGluc2VydGluZ1xuICogYW5kIGRlbGV0aW5nIGludG8gdGhlIERiRG9jdW1lbnRNdXRhdGlvbnMgaW5kZXguXG4gKi8gZnVuY3Rpb24genQodCwgZSwgbikge1xuICAgIHJldHVybiBbIHQsIHF0KGUpLCBuIF07XG59XG5cbi8qKlxuICogQmVjYXVzZSB3ZSBzdG9yZSBhbGwgdGhlIHVzZWZ1bCBpbmZvcm1hdGlvbiBmb3IgdGhpcyBzdG9yZSBpbiB0aGUga2V5LFxuICogdGhlcmUgaXMgbm8gdXNlZnVsIGluZm9ybWF0aW9uIHRvIHN0b3JlIGFzIHRoZSB2YWx1ZS4gVGhlIHJhdyAodW5lbmNvZGVkKVxuICogcGF0aCBjYW5ub3QgYmUgc3RvcmVkIGJlY2F1c2UgSW5kZXhlZERiIGRvZXNuJ3Qgc3RvcmUgcHJvdG90eXBlXG4gKiBpbmZvcm1hdGlvbi5cbiAqLyBjb25zdCBXdCA9IHt9LCBIdCA9IFsgXCJwcmVmaXhQYXRoXCIsIFwiY29sbGVjdGlvbkdyb3VwXCIsIFwicmVhZFRpbWVcIiwgXCJkb2N1bWVudElkXCIgXSwgSnQgPSBbIFwicHJlZml4UGF0aFwiLCBcImNvbGxlY3Rpb25Hcm91cFwiLCBcImRvY3VtZW50SWRcIiBdLCBZdCA9IFsgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJyZWFkVGltZVwiLCBcInByZWZpeFBhdGhcIiwgXCJkb2N1bWVudElkXCIgXSwgWHQgPSBbIFwiY2Fub25pY2FsSWRcIiwgXCJ0YXJnZXRJZFwiIF0sIFp0ID0gWyBcInRhcmdldElkXCIsIFwicGF0aFwiIF0sIHRlID0gWyBcInBhdGhcIiwgXCJ0YXJnZXRJZFwiIF0sIGVlID0gWyBcImNvbGxlY3Rpb25JZFwiLCBcInBhcmVudFwiIF0sIG5lID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiBdLCBzZSA9IFsgXCJ1aWRcIiwgXCJzZXF1ZW5jZU51bWJlclwiIF0sIGllID0gWyBcImluZGV4SWRcIiwgXCJ1aWRcIiwgXCJhcnJheVZhbHVlXCIsIFwiZGlyZWN0aW9uYWxWYWx1ZVwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiLCBcImRvY3VtZW50S2V5XCIgXSwgcmUgPSBbIFwiaW5kZXhJZFwiLCBcInVpZFwiLCBcIm9yZGVyZWREb2N1bWVudEtleVwiIF0sIG9lID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwiZG9jdW1lbnRJZFwiIF0sIHVlID0gWyBcInVzZXJJZFwiLCBcImNvbGxlY3Rpb25QYXRoXCIsIFwibGFyZ2VzdEJhdGNoSWRcIiBdLCBjZSA9IFsgXCJ1c2VySWRcIiwgXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJsYXJnZXN0QmF0Y2hJZFwiIF0sIGFlID0gWyAuLi5bIC4uLlsgLi4uWyAuLi5bIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1wiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiIF0sIFwiY2xpZW50TWV0YWRhdGFcIiBdLCBcInJlbW90ZURvY3VtZW50R2xvYmFsXCIgXSwgXCJjb2xsZWN0aW9uUGFyZW50c1wiIF0sIFwiYnVuZGxlc1wiLCBcIm5hbWVkUXVlcmllc1wiIF0sIGhlID0gWyAuLi5hZSwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgbGUgPSBbIFwibXV0YXRpb25RdWV1ZXNcIiwgXCJtdXRhdGlvbnNcIiwgXCJkb2N1bWVudE11dGF0aW9uc1wiLCBcInJlbW90ZURvY3VtZW50c1YxNFwiLCBcInRhcmdldHNcIiwgXCJvd25lclwiLCBcInRhcmdldEdsb2JhbFwiLCBcInRhcmdldERvY3VtZW50c1wiLCBcImNsaWVudE1ldGFkYXRhXCIsIFwicmVtb3RlRG9jdW1lbnRHbG9iYWxcIiwgXCJjb2xsZWN0aW9uUGFyZW50c1wiLCBcImJ1bmRsZXNcIiwgXCJuYW1lZFF1ZXJpZXNcIiwgXCJkb2N1bWVudE92ZXJsYXlzXCIgXSwgZmUgPSBsZSwgZGUgPSBbIC4uLmZlLCBcImluZGV4Q29uZmlndXJhdGlvblwiLCBcImluZGV4U3RhdGVcIiwgXCJpbmRleEVudHJpZXNcIiBdO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY2xhc3MgX2UgZXh0ZW5kcyBBdCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmF0ID0gdCwgdGhpcy5jdXJyZW50U2VxdWVuY2VOdW1iZXIgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gd2UodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgIHJldHVybiBidC5NKG4uYXQsIGUpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBtZSh0KSB7XG4gICAgbGV0IGUgPSAwO1xuICAgIGZvciAoY29uc3QgbiBpbiB0KSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgbikgJiYgZSsrO1xuICAgIHJldHVybiBlO1xufVxuXG5mdW5jdGlvbiBnZSh0LCBlKSB7XG4gICAgZm9yIChjb25zdCBuIGluIHQpIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LCBuKSAmJiBlKG4sIHRbbl0pO1xufVxuXG5mdW5jdGlvbiB5ZSh0KSB7XG4gICAgZm9yIChjb25zdCBlIGluIHQpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgZSkpIHJldHVybiAhMTtcbiAgICByZXR1cm4gITA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBBbiBpbW11dGFibGUgc29ydGVkIG1hcCBpbXBsZW1lbnRhdGlvbiwgYmFzZWQgb24gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrXG4vLyB0cmVlLlxuY2xhc3MgcGUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gdCwgdGhpcy5yb290ID0gZSB8fCBUZS5FTVBUWTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIG1hcCwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleS92YWx1ZSBhZGRlZCBvciByZXBsYWNlZC5cbiAgICBpbnNlcnQodCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IHBlKHRoaXMuY29tcGFyYXRvciwgdGhpcy5yb290Lmluc2VydCh0LCBlLCB0aGlzLmNvbXBhcmF0b3IpLmNvcHkobnVsbCwgbnVsbCwgVGUuQkxBQ0ssIG51bGwsIG51bGwpKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIG1hcCwgd2l0aCB0aGUgc3BlY2lmaWVkIGtleSByZW1vdmVkLlxuICAgIHJlbW92ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgcGUodGhpcy5jb21wYXJhdG9yLCB0aGlzLnJvb3QucmVtb3ZlKHQsIHRoaXMuY29tcGFyYXRvcikuY29weShudWxsLCBudWxsLCBUZS5CTEFDSywgbnVsbCwgbnVsbCkpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSB2YWx1ZSBvZiB0aGUgbm9kZSB3aXRoIHRoZSBnaXZlbiBrZXksIG9yIG51bGwuXG4gICAgZ2V0KHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnJvb3Q7XG4gICAgICAgIGZvciAoOyFlLmlzRW1wdHkoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdGhpcy5jb21wYXJhdG9yKHQsIGUua2V5KTtcbiAgICAgICAgICAgIGlmICgwID09PSBuKSByZXR1cm4gZS52YWx1ZTtcbiAgICAgICAgICAgIG4gPCAwID8gZSA9IGUubGVmdCA6IG4gPiAwICYmIChlID0gZS5yaWdodCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBlbGVtZW50IGluIHRoaXMgc29ydGVkIG1hcCwgb3IgLTEgaWYgaXQgZG9lc24ndFxuICAgIC8vIGV4aXN0LlxuICAgIGluZGV4T2YodCkge1xuICAgICAgICAvLyBOdW1iZXIgb2Ygbm9kZXMgdGhhdCB3ZXJlIHBydW5lZCB3aGVuIGRlc2NlbmRpbmcgcmlnaHRcbiAgICAgICAgbGV0IGUgPSAwLCBuID0gdGhpcy5yb290O1xuICAgICAgICBmb3IgKDshbi5pc0VtcHR5KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuY29tcGFyYXRvcih0LCBuLmtleSk7XG4gICAgICAgICAgICBpZiAoMCA9PT0gcykgcmV0dXJuIGUgKyBuLmxlZnQuc2l6ZTtcbiAgICAgICAgICAgIHMgPCAwID8gbiA9IG4ubGVmdCA6IChcbiAgICAgICAgICAgIC8vIENvdW50IGFsbCBub2RlcyBsZWZ0IG9mIHRoZSBub2RlIHBsdXMgdGhlIG5vZGUgaXRzZWxmXG4gICAgICAgICAgICBlICs9IG4ubGVmdC5zaXplICsgMSwgbiA9IG4ucmlnaHQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIE5vZGUgbm90IGZvdW5kXG4gICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290LmlzRW1wdHkoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIG5vZGVzIGluIHRoZSBtYXAuXG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3Quc2l6ZTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBrZXkgaW4gdGhlIG1hcC5cbiAgICBtaW5LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJvb3QubWluS2V5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgdGhlIG1heGltdW0ga2V5IGluIHRoZSBtYXAuXG4gICAgbWF4S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb290Lm1heEtleSgpO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIG1hcCBpbiBrZXkgb3JkZXIgYW5kIGNhbGxzIHRoZSBzcGVjaWZpZWQgYWN0aW9uIGZ1bmN0aW9uXG4gICAgLy8gZm9yIGVhY2gga2V5L3ZhbHVlIHBhaXIuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICBpbm9yZGVyVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5pbm9yZGVyVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICBmb3JFYWNoKHQpIHtcbiAgICAgICAgdGhpcy5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4gKHQoZSwgbiksICExKSkpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4gKHQucHVzaChgJHtlfToke259YCksICExKSkpLCBgeyR7dC5qb2luKFwiLCBcIil9fWA7XG4gICAgfVxuICAgIC8vIFRyYXZlcnNlcyB0aGUgbWFwIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIGtleS92YWx1ZSBwYWlyLiBJZiBhY3Rpb24gcmV0dXJucyB0cnVlLCB0cmF2ZXJzYWwgaXNcbiAgICAvLyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICByZXZlcnNlVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucm9vdC5yZXZlcnNlVHJhdmVyc2FsKHQpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGFuIGl0ZXJhdG9yIG92ZXIgdGhlIFNvcnRlZE1hcC5cbiAgICBnZXRJdGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJZSh0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgITEpO1xuICAgIH1cbiAgICBnZXRJdGVyYXRvckZyb20odCkge1xuICAgICAgICByZXR1cm4gbmV3IEllKHRoaXMucm9vdCwgdCwgdGhpcy5jb21wYXJhdG9yLCAhMSk7XG4gICAgfVxuICAgIGdldFJldmVyc2VJdGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJZSh0aGlzLnJvb3QsIG51bGwsIHRoaXMuY29tcGFyYXRvciwgITApO1xuICAgIH1cbiAgICBnZXRSZXZlcnNlSXRlcmF0b3JGcm9tKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBJZSh0aGlzLnJvb3QsIHQsIHRoaXMuY29tcGFyYXRvciwgITApO1xuICAgIH1cbn1cblxuIC8vIGVuZCBTb3J0ZWRNYXBcbi8vIEFuIGl0ZXJhdG9yIG92ZXIgYW4gTExSQk5vZGUuXG5jbGFzcyBJZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLmlzUmV2ZXJzZSA9IHMsIHRoaXMubm9kZVN0YWNrID0gW107XG4gICAgICAgIGxldCBpID0gMTtcbiAgICAgICAgZm9yICg7IXQuaXNFbXB0eSgpOyApIGlmIChpID0gZSA/IG4odC5rZXksIGUpIDogMSwgXG4gICAgICAgIC8vIGZsaXAgdGhlIGNvbXBhcmlzb24gaWYgd2UncmUgZ29pbmcgaW4gcmV2ZXJzZVxuICAgICAgICBlICYmIHMgJiYgKGkgKj0gLTEpLCBpIDwgMCkgXG4gICAgICAgIC8vIFRoaXMgbm9kZSBpcyBsZXNzIHRoYW4gb3VyIHN0YXJ0IGtleS4gaWdub3JlIGl0XG4gICAgICAgIHQgPSB0aGlzLmlzUmV2ZXJzZSA/IHQubGVmdCA6IHQucmlnaHQ7IGVsc2Uge1xuICAgICAgICAgICAgaWYgKDAgPT09IGkpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIG5vZGUgaXMgZXhhY3RseSBlcXVhbCB0byBvdXIgc3RhcnQga2V5LiBQdXNoIGl0IG9uIHRoZSBzdGFjayxcbiAgICAgICAgICAgICAgICAvLyBidXQgc3RvcCBpdGVyYXRpbmc7XG4gICAgICAgICAgICAgICAgdGhpcy5ub2RlU3RhY2sucHVzaCh0KTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFRoaXMgbm9kZSBpcyBncmVhdGVyIHRoYW4gb3VyIHN0YXJ0IGtleSwgYWRkIGl0IHRvIHRoZSBzdGFjayBhbmQgbW92ZVxuICAgICAgICAgICAgLy8gdG8gdGhlIG5leHQgb25lXG4gICAgICAgICAgICB0aGlzLm5vZGVTdGFjay5wdXNoKHQpLCB0ID0gdGhpcy5pc1JldmVyc2UgPyB0LnJpZ2h0IDogdC5sZWZ0O1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldE5leHQoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcy5ub2RlU3RhY2sucG9wKCk7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBrZXk6IHQua2V5LFxuICAgICAgICAgICAgdmFsdWU6IHQudmFsdWVcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuaXNSZXZlcnNlKSBmb3IgKHQgPSB0LmxlZnQ7ICF0LmlzRW1wdHkoKTsgKSB0aGlzLm5vZGVTdGFjay5wdXNoKHQpLCB0ID0gdC5yaWdodDsgZWxzZSBmb3IgKHQgPSB0LnJpZ2h0OyAhdC5pc0VtcHR5KCk7ICkgdGhpcy5ub2RlU3RhY2sucHVzaCh0KSwgXG4gICAgICAgIHQgPSB0LmxlZnQ7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICBoYXNOZXh0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ub2RlU3RhY2subGVuZ3RoID4gMDtcbiAgICB9XG4gICAgcGVlaygpIHtcbiAgICAgICAgaWYgKDAgPT09IHRoaXMubm9kZVN0YWNrLmxlbmd0aCkgcmV0dXJuIG51bGw7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLm5vZGVTdGFja1t0aGlzLm5vZGVTdGFjay5sZW5ndGggLSAxXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGtleTogdC5rZXksXG4gICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICB9O1xuICAgIH1cbn1cblxuIC8vIGVuZCBTb3J0ZWRNYXBJdGVyYXRvclxuLy8gUmVwcmVzZW50cyBhIG5vZGUgaW4gYSBMZWZ0LWxlYW5pbmcgUmVkLUJsYWNrIHRyZWUuXG5jbGFzcyBUZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMudmFsdWUgPSBlLCB0aGlzLmNvbG9yID0gbnVsbCAhPSBuID8gbiA6IFRlLlJFRCwgdGhpcy5sZWZ0ID0gbnVsbCAhPSBzID8gcyA6IFRlLkVNUFRZLCBcbiAgICAgICAgdGhpcy5yaWdodCA9IG51bGwgIT0gaSA/IGkgOiBUZS5FTVBUWSwgdGhpcy5zaXplID0gdGhpcy5sZWZ0LnNpemUgKyAxICsgdGhpcy5yaWdodC5zaXplO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLCBvcHRpb25hbGx5IHJlcGxhY2luZyBwaWVjZXMgb2YgaXQuXG4gICAgY29weSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHJldHVybiBuZXcgVGUobnVsbCAhPSB0ID8gdCA6IHRoaXMua2V5LCBudWxsICE9IGUgPyBlIDogdGhpcy52YWx1ZSwgbnVsbCAhPSBuID8gbiA6IHRoaXMuY29sb3IsIG51bGwgIT0gcyA/IHMgOiB0aGlzLmxlZnQsIG51bGwgIT0gaSA/IGkgOiB0aGlzLnJpZ2h0KTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICAvLyBUcmF2ZXJzZXMgdGhlIHRyZWUgaW4ga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvbiBmdW5jdGlvblxuICAgIC8vIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICBpbm9yZGVyVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5pbm9yZGVyVHJhdmVyc2FsKHQpIHx8IHQodGhpcy5rZXksIHRoaXMudmFsdWUpIHx8IHRoaXMucmlnaHQuaW5vcmRlclRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgLy8gVHJhdmVyc2VzIHRoZSB0cmVlIGluIHJldmVyc2Uga2V5IG9yZGVyIGFuZCBjYWxscyB0aGUgc3BlY2lmaWVkIGFjdGlvblxuICAgIC8vIGZ1bmN0aW9uIGZvciBlYWNoIG5vZGUuIElmIGFjdGlvbiByZXR1cm5zIHRydWUsIHRyYXZlcnNhbCBpcyBhYm9ydGVkLlxuICAgIC8vIFJldHVybnMgdGhlIGZpcnN0IHRydXRoeSB2YWx1ZSByZXR1cm5lZCBieSBhY3Rpb24sIG9yIHRoZSBsYXN0IGZhbHNleVxuICAgIC8vIHZhbHVlIHJldHVybmVkIGJ5IGFjdGlvbi5cbiAgICByZXZlcnNlVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmlnaHQucmV2ZXJzZVRyYXZlcnNhbCh0KSB8fCB0KHRoaXMua2V5LCB0aGlzLnZhbHVlKSB8fCB0aGlzLmxlZnQucmV2ZXJzZVRyYXZlcnNhbCh0KTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWluaW11bSBub2RlIGluIHRoZSB0cmVlLlxuICAgIG1pbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5pc0VtcHR5KCkgPyB0aGlzIDogdGhpcy5sZWZ0Lm1pbigpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIHRoZSBtYXhpbXVtIGtleSBpbiB0aGUgdHJlZS5cbiAgICBtaW5LZXkoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1pbigpLmtleTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyB0aGUgbWF4aW11bSBrZXkgaW4gdGhlIHRyZWUuXG4gICAgbWF4S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yaWdodC5pc0VtcHR5KCkgPyB0aGlzLmtleSA6IHRoaXMucmlnaHQubWF4S2V5KCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIGtleS92YWx1ZSBhZGRlZC5cbiAgICBpbnNlcnQodCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IHRoaXM7XG4gICAgICAgIGNvbnN0IGkgPSBuKHQsIHMua2V5KTtcbiAgICAgICAgcmV0dXJuIHMgPSBpIDwgMCA/IHMuY29weShudWxsLCBudWxsLCBudWxsLCBzLmxlZnQuaW5zZXJ0KHQsIGUsIG4pLCBudWxsKSA6IDAgPT09IGkgPyBzLmNvcHkobnVsbCwgZSwgbnVsbCwgbnVsbCwgbnVsbCkgOiBzLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgcy5yaWdodC5pbnNlcnQodCwgZSwgbikpLCBcbiAgICAgICAgcy5maXhVcCgpO1xuICAgIH1cbiAgICByZW1vdmVNaW4oKSB7XG4gICAgICAgIGlmICh0aGlzLmxlZnQuaXNFbXB0eSgpKSByZXR1cm4gVGUuRU1QVFk7XG4gICAgICAgIGxldCB0ID0gdGhpcztcbiAgICAgICAgcmV0dXJuIHQubGVmdC5pc1JlZCgpIHx8IHQubGVmdC5sZWZ0LmlzUmVkKCkgfHwgKHQgPSB0Lm1vdmVSZWRMZWZ0KCkpLCB0ID0gdC5jb3B5KG51bGwsIG51bGwsIG51bGwsIHQubGVmdC5yZW1vdmVNaW4oKSwgbnVsbCksIFxuICAgICAgICB0LmZpeFVwKCk7XG4gICAgfVxuICAgIC8vIFJldHVybnMgbmV3IHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBpdGVtIHJlbW92ZWQuXG4gICAgcmVtb3ZlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4sIHMgPSB0aGlzO1xuICAgICAgICBpZiAoZSh0LCBzLmtleSkgPCAwKSBzLmxlZnQuaXNFbXB0eSgpIHx8IHMubGVmdC5pc1JlZCgpIHx8IHMubGVmdC5sZWZ0LmlzUmVkKCkgfHwgKHMgPSBzLm1vdmVSZWRMZWZ0KCkpLCBcbiAgICAgICAgcyA9IHMuY29weShudWxsLCBudWxsLCBudWxsLCBzLmxlZnQucmVtb3ZlKHQsIGUpLCBudWxsKTsgZWxzZSB7XG4gICAgICAgICAgICBpZiAocy5sZWZ0LmlzUmVkKCkgJiYgKHMgPSBzLnJvdGF0ZVJpZ2h0KCkpLCBzLnJpZ2h0LmlzRW1wdHkoKSB8fCBzLnJpZ2h0LmlzUmVkKCkgfHwgcy5yaWdodC5sZWZ0LmlzUmVkKCkgfHwgKHMgPSBzLm1vdmVSZWRSaWdodCgpKSwgXG4gICAgICAgICAgICAwID09PSBlKHQsIHMua2V5KSkge1xuICAgICAgICAgICAgICAgIGlmIChzLnJpZ2h0LmlzRW1wdHkoKSkgcmV0dXJuIFRlLkVNUFRZO1xuICAgICAgICAgICAgICAgIG4gPSBzLnJpZ2h0Lm1pbigpLCBzID0gcy5jb3B5KG4ua2V5LCBuLnZhbHVlLCBudWxsLCBudWxsLCBzLnJpZ2h0LnJlbW92ZU1pbigpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHMgPSBzLmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgcy5yaWdodC5yZW1vdmUodCwgZSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzLmZpeFVwKCk7XG4gICAgfVxuICAgIGlzUmVkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb2xvcjtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBuZXcgdHJlZSBhZnRlciBwZXJmb3JtaW5nIGFueSBuZWVkZWQgcm90YXRpb25zLlxuICAgIGZpeFVwKCkge1xuICAgICAgICBsZXQgdCA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0LnJpZ2h0LmlzUmVkKCkgJiYgIXQubGVmdC5pc1JlZCgpICYmICh0ID0gdC5yb3RhdGVMZWZ0KCkpLCB0LmxlZnQuaXNSZWQoKSAmJiB0LmxlZnQubGVmdC5pc1JlZCgpICYmICh0ID0gdC5yb3RhdGVSaWdodCgpKSwgXG4gICAgICAgIHQubGVmdC5pc1JlZCgpICYmIHQucmlnaHQuaXNSZWQoKSAmJiAodCA9IHQuY29sb3JGbGlwKCkpLCB0O1xuICAgIH1cbiAgICBtb3ZlUmVkTGVmdCgpIHtcbiAgICAgICAgbGV0IHQgPSB0aGlzLmNvbG9yRmxpcCgpO1xuICAgICAgICByZXR1cm4gdC5yaWdodC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LmNvcHkobnVsbCwgbnVsbCwgbnVsbCwgbnVsbCwgdC5yaWdodC5yb3RhdGVSaWdodCgpKSwgXG4gICAgICAgIHQgPSB0LnJvdGF0ZUxlZnQoKSwgdCA9IHQuY29sb3JGbGlwKCkpLCB0O1xuICAgIH1cbiAgICBtb3ZlUmVkUmlnaHQoKSB7XG4gICAgICAgIGxldCB0ID0gdGhpcy5jb2xvckZsaXAoKTtcbiAgICAgICAgcmV0dXJuIHQubGVmdC5sZWZ0LmlzUmVkKCkgJiYgKHQgPSB0LnJvdGF0ZVJpZ2h0KCksIHQgPSB0LmNvbG9yRmxpcCgpKSwgdDtcbiAgICB9XG4gICAgcm90YXRlTGVmdCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuY29weShudWxsLCBudWxsLCBUZS5SRUQsIG51bGwsIHRoaXMucmlnaHQubGVmdCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJpZ2h0LmNvcHkobnVsbCwgbnVsbCwgdGhpcy5jb2xvciwgdCwgbnVsbCk7XG4gICAgfVxuICAgIHJvdGF0ZVJpZ2h0KCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jb3B5KG51bGwsIG51bGwsIFRlLlJFRCwgdGhpcy5sZWZ0LnJpZ2h0LCBudWxsKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGVmdC5jb3B5KG51bGwsIG51bGwsIHRoaXMuY29sb3IsIG51bGwsIHQpO1xuICAgIH1cbiAgICBjb2xvckZsaXAoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmxlZnQuY29weShudWxsLCBudWxsLCAhdGhpcy5sZWZ0LmNvbG9yLCBudWxsLCBudWxsKSwgZSA9IHRoaXMucmlnaHQuY29weShudWxsLCBudWxsLCAhdGhpcy5yaWdodC5jb2xvciwgbnVsbCwgbnVsbCk7XG4gICAgICAgIHJldHVybiB0aGlzLmNvcHkobnVsbCwgbnVsbCwgIXRoaXMuY29sb3IsIHQsIGUpO1xuICAgIH1cbiAgICAvLyBGb3IgdGVzdGluZy5cbiAgICBjaGVja01heERlcHRoKCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5jaGVjaygpO1xuICAgICAgICByZXR1cm4gTWF0aC5wb3coMiwgdCkgPD0gdGhpcy5zaXplICsgMTtcbiAgICB9XG4gICAgLy8gSW4gYSBiYWxhbmNlZCBSQiB0cmVlLCB0aGUgYmxhY2stZGVwdGggKG51bWJlciBvZiBibGFjayBub2RlcykgZnJvbSByb290IHRvXG4gICAgLy8gbGVhdmVzIGlzIGVxdWFsIG9uIGJvdGggc2lkZXMuICBUaGlzIGZ1bmN0aW9uIHZlcmlmaWVzIHRoYXQgb3IgYXNzZXJ0cy5cbiAgICBjaGVjaygpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNSZWQoKSAmJiB0aGlzLmxlZnQuaXNSZWQoKSkgdGhyb3cgJCgpO1xuICAgICAgICBpZiAodGhpcy5yaWdodC5pc1JlZCgpKSB0aHJvdyAkKCk7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmxlZnQuY2hlY2soKTtcbiAgICAgICAgaWYgKHQgIT09IHRoaXMucmlnaHQuY2hlY2soKSkgdGhyb3cgJCgpO1xuICAgICAgICByZXR1cm4gdCArICh0aGlzLmlzUmVkKCkgPyAwIDogMSk7XG4gICAgfVxufVxuXG4gLy8gZW5kIExMUkJOb2RlXG4vLyBFbXB0eSBub2RlIGlzIHNoYXJlZCBiZXR3ZWVuIGFsbCBMTFJCIHRyZWVzLlxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcblRlLkVNUFRZID0gbnVsbCwgVGUuUkVEID0gITAsIFRlLkJMQUNLID0gITE7XG5cbi8vIGVuZCBMTFJCRW1wdHlOb2RlXG5UZS5FTVBUWSA9IG5ldyBcbi8vIFJlcHJlc2VudHMgYW4gZW1wdHkgbm9kZSAoYSBsZWFmIG5vZGUgaW4gdGhlIFJlZC1CbGFjayBUcmVlKS5cbmNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5zaXplID0gMDtcbiAgICB9XG4gICAgZ2V0IGtleSgpIHtcbiAgICAgICAgdGhyb3cgJCgpO1xuICAgIH1cbiAgICBnZXQgdmFsdWUoKSB7XG4gICAgICAgIHRocm93ICQoKTtcbiAgICB9XG4gICAgZ2V0IGNvbG9yKCkge1xuICAgICAgICB0aHJvdyAkKCk7XG4gICAgfVxuICAgIGdldCBsZWZ0KCkge1xuICAgICAgICB0aHJvdyAkKCk7XG4gICAgfVxuICAgIGdldCByaWdodCgpIHtcbiAgICAgICAgdGhyb3cgJCgpO1xuICAgIH1cbiAgICAvLyBSZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBub2RlLlxuICAgIGNvcHkodCwgZSwgbiwgcywgaSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkvdmFsdWUgYWRkZWQuXG4gICAgaW5zZXJ0KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBUZSh0LCBlKTtcbiAgICB9XG4gICAgLy8gUmV0dXJucyBhIGNvcHkgb2YgdGhlIHRyZWUsIHdpdGggdGhlIHNwZWNpZmllZCBrZXkgcmVtb3ZlZC5cbiAgICByZW1vdmUodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICBpbm9yZGVyVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICByZXZlcnNlVHJhdmVyc2FsKHQpIHtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBtaW5LZXkoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBtYXhLZXkoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBpc1JlZCgpIHtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICAvLyBGb3IgdGVzdGluZy5cbiAgICBjaGVja01heERlcHRoKCkge1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIGNoZWNrKCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9XG59O1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTb3J0ZWRTZXQgaXMgYW4gaW1tdXRhYmxlIChjb3B5LW9uLXdyaXRlKSBjb2xsZWN0aW9uIHRoYXQgaG9sZHMgZWxlbWVudHNcbiAqIGluIG9yZGVyIHNwZWNpZmllZCBieSB0aGUgcHJvdmlkZWQgY29tcGFyYXRvci5cbiAqXG4gKiBOT1RFOiBpZiBwcm92aWRlZCBjb21wYXJhdG9yIHJldHVybnMgMCBmb3IgdHdvIGVsZW1lbnRzLCB3ZSBjb25zaWRlciB0aGVtIHRvXG4gKiBiZSBlcXVhbCFcbiAqL1xuY2xhc3MgRWUge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5jb21wYXJhdG9yID0gdCwgdGhpcy5kYXRhID0gbmV3IHBlKHRoaXMuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0aGlzLmRhdGEuZ2V0KHQpO1xuICAgIH1cbiAgICBmaXJzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5taW5LZXkoKTtcbiAgICB9XG4gICAgbGFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5tYXhLZXkoKTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuc2l6ZTtcbiAgICB9XG4gICAgaW5kZXhPZih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEuaW5kZXhPZih0KTtcbiAgICB9XG4gICAgLyoqIEl0ZXJhdGVzIGVsZW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi8gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuZGF0YS5pbm9yZGVyVHJhdmVyc2FsKCgoZSwgbikgPT4gKHQoZSksICExKSkpO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgb3ZlciBgZWxlbWBzIHN1Y2ggdGhhdDogcmFuZ2VbMF0gJmx0Oz0gZWxlbSAmbHQ7IHJhbmdlWzFdLiAqLyAgICBmb3JFYWNoSW5SYW5nZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHRbMF0pO1xuICAgICAgICBmb3IgKDtuLmhhc05leHQoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5nZXROZXh0KCk7XG4gICAgICAgICAgICBpZiAodGhpcy5jb21wYXJhdG9yKHMua2V5LCB0WzFdKSA+PSAwKSByZXR1cm47XG4gICAgICAgICAgICBlKHMua2V5KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBJdGVyYXRlcyBvdmVyIGBlbGVtYHMgc3VjaCB0aGF0OiBzdGFydCAmbHQ7PSBlbGVtIHVudGlsIGZhbHNlIGlzIHJldHVybmVkLlxuICAgICAqLyAgICBmb3JFYWNoV2hpbGUodCwgZSkge1xuICAgICAgICBsZXQgbjtcbiAgICAgICAgZm9yIChuID0gdm9pZCAwICE9PSBlID8gdGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbShlKSA6IHRoaXMuZGF0YS5nZXRJdGVyYXRvcigpOyBuLmhhc05leHQoKTsgKSB7XG4gICAgICAgICAgICBpZiAoIXQobi5nZXROZXh0KCkua2V5KSkgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBGaW5kcyB0aGUgbGVhc3QgZWxlbWVudCBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gYGVsZW1gLiAqLyAgICBmaXJzdEFmdGVyT3JFcXVhbCh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3JGcm9tKHQpO1xuICAgICAgICByZXR1cm4gZS5oYXNOZXh0KCkgPyBlLmdldE5leHQoKS5rZXkgOiBudWxsO1xuICAgIH1cbiAgICBnZXRJdGVyYXRvcigpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBBZSh0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKSk7XG4gICAgfVxuICAgIGdldEl0ZXJhdG9yRnJvbSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQWUodGhpcy5kYXRhLmdldEl0ZXJhdG9yRnJvbSh0KSk7XG4gICAgfVxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYW4gZWxlbWVudCAqLyAgICBhZGQodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb3B5KHRoaXMuZGF0YS5yZW1vdmUodCkuaW5zZXJ0KHQsICEwKSk7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIGFuIGVsZW1lbnQgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaGFzKHQpID8gdGhpcy5jb3B5KHRoaXMuZGF0YS5yZW1vdmUodCkpIDogdGhpcztcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YS5pc0VtcHR5KCk7XG4gICAgfVxuICAgIHVuaW9uV2l0aCh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcztcbiAgICAgICAgLy8gTWFrZSBzdXJlIGByZXN1bHRgIGFsd2F5cyByZWZlcnMgdG8gdGhlIGxhcmdlciBvbmUgb2YgdGhlIHR3byBzZXRzLlxuICAgICAgICAgICAgICAgIHJldHVybiBlLnNpemUgPCB0LnNpemUgJiYgKGUgPSB0LCB0ID0gdGhpcyksIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICBlID0gZS5hZGQodCk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBFZSkpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gdC5zaXplKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRhdGEuZ2V0SXRlcmF0b3IoKSwgbiA9IHQuZGF0YS5nZXRJdGVyYXRvcigpO1xuICAgICAgICBmb3IgKDtlLmhhc05leHQoKTsgKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5nZXROZXh0KCkua2V5LCBzID0gbi5nZXROZXh0KCkua2V5O1xuICAgICAgICAgICAgaWYgKDAgIT09IHRoaXMuY29tcGFyYXRvcih0LCBzKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgdG9BcnJheSgpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQucHVzaChlKTtcbiAgICAgICAgfSkpLCB0O1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHQucHVzaChlKSkpLCBcIlNvcnRlZFNldChcIiArIHQudG9TdHJpbmcoKSArIFwiKVwiO1xuICAgIH1cbiAgICBjb3B5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBFZSh0aGlzLmNvbXBhcmF0b3IpO1xuICAgICAgICByZXR1cm4gZS5kYXRhID0gdCwgZTtcbiAgICB9XG59XG5cbmNsYXNzIEFlIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuaXRlciA9IHQ7XG4gICAgfVxuICAgIGdldE5leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZXIuZ2V0TmV4dCgpLmtleTtcbiAgICB9XG4gICAgaGFzTmV4dCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlci5oYXNOZXh0KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXBhcmVzIHR3byBzb3J0ZWQgc2V0cyBmb3IgZXF1YWxpdHkgdXNpbmcgdGhlaXIgbmF0dXJhbCBvcmRlcmluZy4gVGhlXG4gKiBtZXRob2QgY29tcHV0ZXMgdGhlIGludGVyc2VjdGlvbiBhbmQgaW52b2tlcyBgb25BZGRgIGZvciBldmVyeSBlbGVtZW50IHRoYXRcbiAqIGlzIGluIGBhZnRlcmAgYnV0IG5vdCBgYmVmb3JlYC4gYG9uUmVtb3ZlYCBpcyBpbnZva2VkIGZvciBldmVyeSBlbGVtZW50IGluXG4gKiBgYmVmb3JlYCBidXQgbWlzc2luZyBmcm9tIGBhZnRlcmAuXG4gKlxuICogVGhlIG1ldGhvZCBjcmVhdGVzIGEgY29weSBvZiBib3RoIGBiZWZvcmVgIGFuZCBgYWZ0ZXJgIGFuZCBydW5zIGluIE8obiBsb2dcbiAqIG4pLCB3aGVyZSBuIGlzIHRoZSBzaXplIG9mIHRoZSB0d28gbGlzdHMuXG4gKlxuICogQHBhcmFtIGJlZm9yZSAtIFRoZSBlbGVtZW50cyB0aGF0IGV4aXN0IGluIHRoZSBvcmlnaW5hbCBzZXQuXG4gKiBAcGFyYW0gYWZ0ZXIgLSBUaGUgZWxlbWVudHMgdG8gZGlmZiBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBzZXQuXG4gKiBAcGFyYW0gY29tcGFyYXRvciAtIFRoZSBjb21wYXJhdG9yIGZvciB0aGUgZWxlbWVudHMgaW4gYmVmb3JlIGFuZCBhZnRlci5cbiAqIEBwYXJhbSBvbkFkZCAtIEEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBldmVyeSBlbGVtZW50IHRoYXQgaXMgcGFydCBvZiBgXG4gKiBhZnRlcmAgYnV0IG5vdCBgYmVmb3JlYC5cbiAqIEBwYXJhbSBvblJlbW92ZSAtIEEgZnVuY3Rpb24gdG8gaW52b2tlIGZvciBldmVyeSBlbGVtZW50IHRoYXQgaXMgcGFydCBvZlxuICogYGJlZm9yZWAgYnV0IG5vdCBgYWZ0ZXJgLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIG5leHQgZWxlbWVudCBmcm9tIHRoZSBpdGVyYXRvciBvciBgdW5kZWZpbmVkYCBpZiBub25lIGF2YWlsYWJsZS5cbiAqL1xuZnVuY3Rpb24gUmUodCkge1xuICAgIHJldHVybiB0Lmhhc05leHQoKSA/IHQuZ2V0TmV4dCgpIDogdm9pZCAwO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBQcm92aWRlcyBhIHNldCBvZiBmaWVsZHMgdGhhdCBjYW4gYmUgdXNlZCB0byBwYXJ0aWFsbHkgcGF0Y2ggYSBkb2N1bWVudC5cbiAqIEZpZWxkTWFzayBpcyB1c2VkIGluIGNvbmp1bmN0aW9uIHdpdGggT2JqZWN0VmFsdWUuXG4gKiBFeGFtcGxlczpcbiAqICAgZm9vIC0gT3ZlcndyaXRlcyBmb28gZW50aXJlbHkgd2l0aCB0aGUgcHJvdmlkZWQgdmFsdWUuIElmIGZvbyBpcyBub3RcbiAqICAgICAgICAgcHJlc2VudCBpbiB0aGUgY29tcGFuaW9uIE9iamVjdFZhbHVlLCB0aGUgZmllbGQgaXMgZGVsZXRlZC5cbiAqICAgZm9vLmJhciAtIE92ZXJ3cml0ZXMgb25seSB0aGUgZmllbGQgYmFyIG9mIHRoZSBvYmplY3QgZm9vLlxuICogICAgICAgICAgICAgSWYgZm9vIGlzIG5vdCBhbiBvYmplY3QsIGZvbyBpcyByZXBsYWNlZCB3aXRoIGFuIG9iamVjdFxuICogICAgICAgICAgICAgY29udGFpbmluZyBmb29cbiAqLyBjbGFzcyB2ZSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmZpZWxkcyA9IHQsIFxuICAgICAgICAvLyBUT0RPKGRpbW9uZCk6IHZhbGlkYXRpb24gb2YgRmllbGRNYXNrXG4gICAgICAgIC8vIFNvcnQgdGhlIGZpZWxkIG1hc2sgdG8gc3VwcG9ydCBgRmllbGRNYXNrLmlzRXF1YWwoKWAgYW5kIGFzc2VydCBiZWxvdy5cbiAgICAgICAgdC5zb3J0KGF0LmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgdmUoW10pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgbmV3IEZpZWxkTWFzayBvYmplY3QgdGhhdCBpcyB0aGUgcmVzdWx0IG9mIGFkZGluZyBhbGwgdGhlIGdpdmVuXG4gICAgICogZmllbGRzIHBhdGhzIHRvIHRoaXMgZmllbGQgbWFzay5cbiAgICAgKi8gICAgdW5pb25XaXRoKHQpIHtcbiAgICAgICAgbGV0IGUgPSBuZXcgRWUoYXQuY29tcGFyYXRvcik7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLmZpZWxkcykgZSA9IGUuYWRkKHQpO1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZSA9IGUuYWRkKG4pO1xuICAgICAgICByZXR1cm4gbmV3IHZlKGUudG9BcnJheSgpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCBgZmllbGRQYXRoYCBpcyBpbmNsdWRlZCBieSBhdCBsZWFzdCBvbmUgZmllbGQgaW4gdGhpcyBmaWVsZFxuICAgICAqIG1hc2suXG4gICAgICpcbiAgICAgKiBUaGlzIGlzIGFuIE8obikgb3BlcmF0aW9uLCB3aGVyZSBgbmAgaXMgdGhlIHNpemUgb2YgdGhlIGZpZWxkIG1hc2suXG4gICAgICovICAgIGNvdmVycyh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLmZpZWxkcykgaWYgKGUuaXNQcmVmaXhPZih0KSkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gbnQodGhpcy5maWVsZHMsIHQuZmllbGRzLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjMgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gZXJyb3IgZW5jb3VudGVyZWQgd2hpbGUgZGVjb2RpbmcgYmFzZTY0IHN0cmluZy5cbiAqLyBjbGFzcyBQZSBleHRlbmRzIEVycm9yIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoLi4uYXJndW1lbnRzKSwgdGhpcy5uYW1lID0gXCJCYXNlNjREZWNvZGVFcnJvclwiO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBDb252ZXJ0cyBhIEJhc2U2NCBlbmNvZGVkIHN0cmluZyB0byBhIGJpbmFyeSBzdHJpbmcuICovXG4vKiogVHJ1ZSBpZiBhbmQgb25seSBpZiB0aGUgQmFzZTY0IGNvbnZlcnNpb24gZnVuY3Rpb25zIGFyZSBhdmFpbGFibGUuICovXG5mdW5jdGlvbiBiZSgpIHtcbiAgICByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgYXRvYjtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW1tdXRhYmxlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIFwicHJvdG9cIiBieXRlIHN0cmluZy5cbiAqXG4gKiBQcm90byBieXRlIHN0cmluZ3MgY2FuIGVpdGhlciBiZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmdzIG9yIFVpbnQ4QXJyYXlzIHdoZW5cbiAqIHNlbnQgb24gdGhlIHdpcmUuIFRoaXMgY2xhc3MgYWJzdHJhY3RzIGF3YXkgdGhpcyBkaWZmZXJlbnRpYXRpb24gYnkgaG9sZGluZ1xuICogdGhlIHByb3RvIGJ5dGUgc3RyaW5nIGluIGEgY29tbW9uIGNsYXNzIHRoYXQgbXVzdCBiZSBjb252ZXJ0ZWQgaW50byBhIHN0cmluZ1xuICogYmVmb3JlIGJlaW5nIHNlbnQgYXMgYSBwcm90by5cbiAqIEBpbnRlcm5hbFxuICovIGNsYXNzIFZlIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuYmluYXJ5U3RyaW5nID0gdDtcbiAgICB9XG4gICAgc3RhdGljIGZyb21CYXNlNjRTdHJpbmcodCkge1xuICAgICAgICBjb25zdCBlID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXRvYih0KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAvLyBDaGVjayB0aGF0IGBET01FeGNlcHRpb25gIGlzIGRlZmluZWQgYmVmb3JlIHVzaW5nIGl0IHRvIGF2b2lkXG4gICAgICAgICAgICAgICAgLy8gXCJSZWZlcmVuY2VFcnJvcjogUHJvcGVydHkgJ0RPTUV4Y2VwdGlvbicgZG9lc24ndCBleGlzdFwiIGluIHJlYWN0LW5hdGl2ZS5cbiAgICAgICAgICAgICAgICAvLyAoaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvNzExNSlcbiAgICAgICAgICAgICAgICB0aHJvdyBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBET01FeGNlcHRpb24gJiYgdCBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbiA/IG5ldyBQZShcIkludmFsaWQgYmFzZTY0IHN0cmluZzogXCIgKyB0KSA6IHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyoqIENvbnZlcnRzIGEgYmluYXJ5IHN0cmluZyB0byBhIEJhc2U2NCBlbmNvZGVkIHN0cmluZy4gKi8gKHQpO1xuICAgICAgICByZXR1cm4gbmV3IFZlKGUpO1xuICAgIH1cbiAgICBzdGF0aWMgZnJvbVVpbnQ4QXJyYXkodCkge1xuICAgICAgICAvLyBUT0RPKGluZGV4aW5nKTsgUmVtb3ZlIHRoZSBjb3B5IG9mIHRoZSBieXRlIHN0cmluZyBoZXJlIGFzIHRoaXMgbWV0aG9kXG4gICAgICAgIC8vIGlzIGZyZXF1ZW50bHkgY2FsbGVkIGR1cmluZyBpbmRleGluZy5cbiAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAvKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBjb252ZXJ0IGFuIFVpbnQ4YXJyYXkgdG8gYSBiaW5hcnkgc3RyaW5nLlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGxldCBlID0gXCJcIjtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikgZSArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKHRbbl0pO1xuICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBIZWxwZXIgZnVuY3Rpb24gdG8gY29udmVydCBhIGJpbmFyeSBzdHJpbmcgdG8gYW4gVWludDhBcnJheS5cbiAqLyAodCk7XG4gICAgICAgIHJldHVybiBuZXcgVmUoZSk7XG4gICAgfVxuICAgIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgICAgICBsZXQgdCA9IDA7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZXh0OiAoKSA9PiB0IDwgdGhpcy5iaW5hcnlTdHJpbmcubGVuZ3RoID8ge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLmJpbmFyeVN0cmluZy5jaGFyQ29kZUF0KHQrKyksXG4gICAgICAgICAgICAgICAgZG9uZTogITFcbiAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHZvaWQgMCxcbiAgICAgICAgICAgICAgICBkb25lOiAhMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cbiAgICB0b0Jhc2U2NCgpIHtcbiAgICAgICAgcmV0dXJuIHQgPSB0aGlzLmJpbmFyeVN0cmluZywgYnRvYSh0KTtcbiAgICAgICAgdmFyIHQ7XG4gICAgfVxuICAgIHRvVWludDhBcnJheSgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgVWludDhBcnJheSh0Lmxlbmd0aCk7XG4gICAgICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQubGVuZ3RoOyBuKyspIGVbbl0gPSB0LmNoYXJDb2RlQXQobik7XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgICAgICAvLyBBIFJlZ0V4cCBtYXRjaGluZyBJU08gODYwMSBVVEMgdGltZXN0YW1wcyB3aXRoIG9wdGlvbmFsIGZyYWN0aW9uLlxuICAgICAgICAodGhpcy5iaW5hcnlTdHJpbmcpO1xuICAgIH1cbiAgICBhcHByb3hpbWF0ZUJ5dGVTaXplKCkge1xuICAgICAgICByZXR1cm4gMiAqIHRoaXMuYmluYXJ5U3RyaW5nLmxlbmd0aDtcbiAgICB9XG4gICAgY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIGV0KHRoaXMuYmluYXJ5U3RyaW5nLCB0LmJpbmFyeVN0cmluZyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5iaW5hcnlTdHJpbmcgPT09IHQuYmluYXJ5U3RyaW5nO1xuICAgIH1cbn1cblxuVmUuRU1QVFlfQllURV9TVFJJTkcgPSBuZXcgVmUoXCJcIik7XG5cbmNvbnN0IFNlID0gbmV3IFJlZ0V4cCgvXlxcZHs0fS1cXGRcXGQtXFxkXFxkVFxcZFxcZDpcXGRcXGQ6XFxkXFxkKD86XFwuKFxcZCspKT9aJC8pO1xuXG4vKipcbiAqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB2YWx1ZXMgZm9yIGEgdGltZXN0YW1wIHZhbHVlIGludG8gYSBcInNlY29uZHMgYW5kXG4gKiBuYW5vc1wiIHJlcHJlc2VudGF0aW9uLlxuICovIGZ1bmN0aW9uIERlKHQpIHtcbiAgICAvLyBUaGUganNvbiBpbnRlcmZhY2UgKGZvciB0aGUgYnJvd3Nlcikgd2lsbCByZXR1cm4gYW4gaXNvIHRpbWVzdGFtcCBzdHJpbmcsXG4gICAgLy8gd2hpbGUgdGhlIHByb3RvIGpzIGxpYnJhcnkgKGZvciBub2RlKSB3aWxsIHJldHVybiBhXG4gICAgLy8gZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcCBpbnN0YW5jZS5cbiAgICBpZiAoRighIXQpLCBcInN0cmluZ1wiID09IHR5cGVvZiB0KSB7XG4gICAgICAgIC8vIFRoZSBkYXRlIHN0cmluZyBjYW4gaGF2ZSBoaWdoZXIgcHJlY2lzaW9uIChuYW5vcykgdGhhbiB0aGUgRGF0ZSBjbGFzc1xuICAgICAgICAvLyAobWlsbGlzKSwgc28gd2UgZG8gc29tZSBjdXN0b20gcGFyc2luZyBoZXJlLlxuICAgICAgICAvLyBQYXJzZSB0aGUgbmFub3MgcmlnaHQgb3V0IG9mIHRoZSBzdHJpbmcuXG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgY29uc3QgbiA9IFNlLmV4ZWModCk7XG4gICAgICAgIGlmIChGKCEhbiksIG5bMV0pIHtcbiAgICAgICAgICAgIC8vIFBhZCB0aGUgZnJhY3Rpb24gb3V0IHRvIDkgZGlnaXRzIChuYW5vcykuXG4gICAgICAgICAgICBsZXQgdCA9IG5bMV07XG4gICAgICAgICAgICB0ID0gKHQgKyBcIjAwMDAwMDAwMFwiKS5zdWJzdHIoMCwgOSksIGUgPSBOdW1iZXIodCk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUGFyc2UgdGhlIGRhdGUgdG8gZ2V0IHRoZSBzZWNvbmRzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgRGF0ZSh0KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlY29uZHM6IE1hdGguZmxvb3Iocy5nZXRUaW1lKCkgLyAxZTMpLFxuICAgICAgICAgICAgbmFub3M6IGVcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogQ2UodC5zZWNvbmRzKSxcbiAgICAgICAgbmFub3M6IENlKHQubmFub3MpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBDb252ZXJ0cyB0aGUgcG9zc2libGUgUHJvdG8gdHlwZXMgZm9yIG51bWJlcnMgaW50byBhIEphdmFTY3JpcHQgbnVtYmVyLlxuICogUmV0dXJucyAwIGlmIHRoZSB2YWx1ZSBpcyBub3QgbnVtZXJpYy5cbiAqLyBmdW5jdGlvbiBDZSh0KSB7XG4gICAgLy8gVE9ETyhiam9ybmljayk6IEhhbmRsZSBpbnQ2NCBncmVhdGVyIHRoYW4gNTMgYml0cy5cbiAgICByZXR1cm4gXCJudW1iZXJcIiA9PSB0eXBlb2YgdCA/IHQgOiBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gTnVtYmVyKHQpIDogMDtcbn1cblxuLyoqIENvbnZlcnRzIHRoZSBwb3NzaWJsZSBQcm90byB0eXBlcyBmb3IgQmxvYnMgaW50byBhIEJ5dGVTdHJpbmcuICovIGZ1bmN0aW9uIHhlKHQpIHtcbiAgICByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IFZlLmZyb21CYXNlNjRTdHJpbmcodCkgOiBWZS5mcm9tVWludDhBcnJheSh0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsbHktYXBwbGllZCBTZXJ2ZXJUaW1lc3RhbXAuXG4gKlxuICogU2VydmVyIFRpbWVzdGFtcHMgYXJlIGJhY2tlZCBieSBNYXBWYWx1ZXMgdGhhdCBjb250YWluIGFuIGludGVybmFsIGZpZWxkXG4gKiBgX190eXBlX19gIHdpdGggYSB2YWx1ZSBvZiBgc2VydmVyX3RpbWVzdGFtcGAuIFRoZSBwcmV2aW91cyB2YWx1ZSBhbmQgbG9jYWxcbiAqIHdyaXRlIHRpbWUgYXJlIHN0b3JlZCBpbiBpdHMgYF9fcHJldmlvdXNfdmFsdWVfX2AgYW5kIGBfX2xvY2FsX3dyaXRlX3RpbWVfX2BcbiAqIGZpZWxkcyByZXNwZWN0aXZlbHkuXG4gKlxuICogTm90ZXM6XG4gKiAtIFNlcnZlclRpbWVzdGFtcFZhbHVlIGluc3RhbmNlcyBhcmUgY3JlYXRlZCBhcyB0aGUgcmVzdWx0IG9mIGFwcGx5aW5nIGFcbiAqICAgdHJhbnNmb3JtLiBUaGV5IGNhbiBvbmx5IGV4aXN0IGluIHRoZSBsb2NhbCB2aWV3IG9mIGEgZG9jdW1lbnQuIFRoZXJlZm9yZVxuICogICB0aGV5IGRvIG5vdCBuZWVkIHRvIGJlIHBhcnNlZCBvciBzZXJpYWxpemVkLlxuICogLSBXaGVuIGV2YWx1YXRlZCBsb2NhbGx5IChlLmcuIGZvciBzbmFwc2hvdC5kYXRhKCkpLCB0aGV5IGJ5IGRlZmF1bHRcbiAqICAgZXZhbHVhdGUgdG8gYG51bGxgLiBUaGlzIGJlaGF2aW9yIGNhbiBiZSBjb25maWd1cmVkIGJ5IHBhc3NpbmcgY3VzdG9tXG4gKiAgIEZpZWxkVmFsdWVPcHRpb25zIHRvIHZhbHVlKCkuXG4gKiAtIFdpdGggcmVzcGVjdCB0byBvdGhlciBTZXJ2ZXJUaW1lc3RhbXBWYWx1ZXMsIHRoZXkgc29ydCBieSB0aGVpclxuICogICBsb2NhbFdyaXRlVGltZS5cbiAqLyBmdW5jdGlvbiBOZSh0KSB7XG4gICAgdmFyIGUsIG47XG4gICAgcmV0dXJuIFwic2VydmVyX3RpbWVzdGFtcFwiID09PSAobnVsbCA9PT0gKG4gPSAoKG51bGwgPT09IChlID0gbnVsbCA9PSB0ID8gdm9pZCAwIDogdC5tYXBWYWx1ZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5maWVsZHMpIHx8IHt9KS5fX3R5cGVfXykgfHwgdm9pZCAwID09PSBuID8gdm9pZCAwIDogbi5zdHJpbmdWYWx1ZSk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBTZXJ2ZXJUaW1lc3RhbXAgcHJvdG8gdmFsdWUgKHVzaW5nIHRoZSBpbnRlcm5hbCBmb3JtYXQpLlxuICovXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlIG9mIHRoZSBmaWVsZCBiZWZvcmUgdGhpcyBTZXJ2ZXJUaW1lc3RhbXAgd2FzIHNldC5cbiAqXG4gKiBQcmVzZXJ2aW5nIHRoZSBwcmV2aW91cyB2YWx1ZXMgYWxsb3dzIHRoZSB1c2VyIHRvIGRpc3BsYXkgdGhlIGxhc3QgcmVzb2xlZFxuICogdmFsdWUgdW50aWwgdGhlIGJhY2tlbmQgcmVzcG9uZHMgd2l0aCB0aGUgdGltZXN0YW1wLlxuICovXG5mdW5jdGlvbiBrZSh0KSB7XG4gICAgY29uc3QgZSA9IHQubWFwVmFsdWUuZmllbGRzLl9fcHJldmlvdXNfdmFsdWVfXztcbiAgICByZXR1cm4gTmUoZSkgPyBrZShlKSA6IGU7XG59XG5cbi8qKlxuICogUmV0dXJucyB0aGUgbG9jYWwgdGltZSBhdCB3aGljaCB0aGlzIHRpbWVzdGFtcCB3YXMgZmlyc3Qgc2V0LlxuICovIGZ1bmN0aW9uIE1lKHQpIHtcbiAgICBjb25zdCBlID0gRGUodC5tYXBWYWx1ZS5maWVsZHMuX19sb2NhbF93cml0ZV90aW1lX18udGltZXN0YW1wVmFsdWUpO1xuICAgIHJldHVybiBuZXcgaXQoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgT2Uge1xuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBEYXRhYmFzZUluZm8gdXNpbmcgdGhlIHByb3ZpZGVkIGhvc3QsIGRhdGFiYXNlSWQgYW5kXG4gICAgICogcGVyc2lzdGVuY2VLZXkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YWJhc2VJZCAtIFRoZSBkYXRhYmFzZSB0byB1c2UuXG4gICAgICogQHBhcmFtIGFwcElkIC0gVGhlIEZpcmViYXNlIEFwcCBJZC5cbiAgICAgKiBAcGFyYW0gcGVyc2lzdGVuY2VLZXkgLSBBIHVuaXF1ZSBpZGVudGlmaWVyIGZvciB0aGlzIEZpcmVzdG9yZSdzIGxvY2FsXG4gICAgICogc3RvcmFnZSAodXNlZCBpbiBjb25qdW5jdGlvbiB3aXRoIHRoZSBkYXRhYmFzZUlkKS5cbiAgICAgKiBAcGFyYW0gaG9zdCAtIFRoZSBGaXJlc3RvcmUgYmFja2VuZCBob3N0IHRvIGNvbm5lY3QgdG8uXG4gICAgICogQHBhcmFtIHNzbCAtIFdoZXRoZXIgdG8gdXNlIFNTTCB3aGVuIGNvbm5lY3RpbmcuXG4gICAgICogQHBhcmFtIGZvcmNlTG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZm9yY2VMb25nUG9sbGluZyBvcHRpb25cbiAgICAgKiB3aGVuIHVzaW5nIFdlYkNoYW5uZWwgYXMgdGhlIG5ldHdvcmsgdHJhbnNwb3J0LlxuICAgICAqIEBwYXJhbSBhdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgLSBXaGV0aGVyIHRvIHVzZSB0aGUgZGV0ZWN0QnVmZmVyaW5nUHJveHlcbiAgICAgKiBvcHRpb24gd2hlbiB1c2luZyBXZWJDaGFubmVsIGFzIHRoZSBuZXR3b3JrIHRyYW5zcG9ydC5cbiAgICAgKiBAcGFyYW0gdXNlRmV0Y2hTdHJlYW1zIFdoZXRoZXIgdG8gdXNlIHRoZSBGZXRjaCBBUEkgaW5zdGVhZCBvZlxuICAgICAqIFhNTEhUVFBSZXF1ZXN0XG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbywgdSkge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSB0LCB0aGlzLmFwcElkID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuaG9zdCA9IHMsIHRoaXMuc3NsID0gaSwgXG4gICAgICAgIHRoaXMuZm9yY2VMb25nUG9sbGluZyA9IHIsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gbywgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSB1O1xuICAgIH1cbn1cblxuLyoqIFRoZSBkZWZhdWx0IGRhdGFiYXNlIG5hbWUgZm9yIGEgcHJvamVjdC4gKi9cbi8qKlxuICogUmVwcmVzZW50cyB0aGUgZGF0YWJhc2UgSUQgYSBGaXJlc3RvcmUgY2xpZW50IGlzIGFzc29jaWF0ZWQgd2l0aC5cbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyAkZSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnByb2plY3RJZCA9IHQsIHRoaXMuZGF0YWJhc2UgPSBlIHx8IFwiKGRlZmF1bHQpXCI7XG4gICAgfVxuICAgIHN0YXRpYyBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyAkZShcIlwiLCBcIlwiKTtcbiAgICB9XG4gICAgZ2V0IGlzRGVmYXVsdERhdGFiYXNlKCkge1xuICAgICAgICByZXR1cm4gXCIoZGVmYXVsdClcIiA9PT0gdGhpcy5kYXRhYmFzZTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgJGUgJiYgdC5wcm9qZWN0SWQgPT09IHRoaXMucHJvamVjdElkICYmIHQuZGF0YWJhc2UgPT09IHRoaXMuZGF0YWJhc2U7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuY29uc3QgRmUgPSB7XG4gICAgbWFwVmFsdWU6IHtcbiAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICBfX3R5cGVfXzoge1xuICAgICAgICAgICAgICAgIHN0cmluZ1ZhbHVlOiBcIl9fbWF4X19cIlxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSwgQmUgPSB7XG4gICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxufTtcblxuLyoqIEV4dHJhY3RzIHRoZSBiYWNrZW5kJ3MgdHlwZSBvcmRlciBmb3IgdGhlIHByb3ZpZGVkIHZhbHVlLiAqL1xuZnVuY3Rpb24gTGUodCkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIHQgPyAwIC8qIFR5cGVPcmRlci5OdWxsVmFsdWUgKi8gOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyAxIC8qIFR5cGVPcmRlci5Cb29sZWFuVmFsdWUgKi8gOiBcImludGVnZXJWYWx1ZVwiIGluIHQgfHwgXCJkb3VibGVWYWx1ZVwiIGluIHQgPyAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6IFwidGltZXN0YW1wVmFsdWVcIiBpbiB0ID8gMyAvKiBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWUgKi8gOiBcInN0cmluZ1ZhbHVlXCIgaW4gdCA/IDUgLyogVHlwZU9yZGVyLlN0cmluZ1ZhbHVlICovIDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IDYgLyogVHlwZU9yZGVyLkJsb2JWYWx1ZSAqLyA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiB0ID8gNyAvKiBUeXBlT3JkZXIuUmVmVmFsdWUgKi8gOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8gOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyA5IC8qIFR5cGVPcmRlci5BcnJheVZhbHVlICovIDogXCJtYXBWYWx1ZVwiIGluIHQgPyBOZSh0KSA/IDQgLyogVHlwZU9yZGVyLlNlcnZlclRpbWVzdGFtcFZhbHVlICovIDogZW4odCkgPyA5MDA3MTk5MjU0NzQwOTkxIC8qIFR5cGVPcmRlci5NYXhWYWx1ZSAqLyA6IDEwIC8qIFR5cGVPcmRlci5PYmplY3RWYWx1ZSAqLyA6ICQoKTtcbn1cblxuLyoqIFRlc3RzIGBsZWZ0YCBhbmQgYHJpZ2h0YCBmb3IgZXF1YWxpdHkgYmFzZWQgb24gdGhlIGJhY2tlbmQgc2VtYW50aWNzLiAqLyBmdW5jdGlvbiBxZSh0LCBlKSB7XG4gICAgaWYgKHQgPT09IGUpIHJldHVybiAhMDtcbiAgICBjb25zdCBuID0gTGUodCk7XG4gICAgaWYgKG4gIT09IExlKGUpKSByZXR1cm4gITE7XG4gICAgc3dpdGNoIChuKSB7XG4gICAgICBjYXNlIDAgLyogVHlwZU9yZGVyLk51bGxWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDkwMDcxOTkyNTQ3NDA5OTEgLyogVHlwZU9yZGVyLk1heFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuICEwO1xuXG4gICAgICBjYXNlIDEgLyogVHlwZU9yZGVyLkJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiB0LmJvb2xlYW5WYWx1ZSA9PT0gZS5ib29sZWFuVmFsdWU7XG5cbiAgICAgIGNhc2UgNCAvKiBUeXBlT3JkZXIuU2VydmVyVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gTWUodCkuaXNFcXVhbChNZShlKSk7XG5cbiAgICAgIGNhc2UgMyAvKiBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQudGltZXN0YW1wVmFsdWUgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZS50aW1lc3RhbXBWYWx1ZSAmJiB0LnRpbWVzdGFtcFZhbHVlLmxlbmd0aCA9PT0gZS50aW1lc3RhbXBWYWx1ZS5sZW5ndGgpIFxuICAgICAgICAgICAgLy8gVXNlIHN0cmluZyBlcXVhbGl0eSBmb3IgSVNPIDg2MDEgdGltZXN0YW1wc1xuICAgICAgICAgICAgcmV0dXJuIHQudGltZXN0YW1wVmFsdWUgPT09IGUudGltZXN0YW1wVmFsdWU7XG4gICAgICAgICAgICBjb25zdCBuID0gRGUodC50aW1lc3RhbXBWYWx1ZSksIHMgPSBEZShlLnRpbWVzdGFtcFZhbHVlKTtcbiAgICAgICAgICAgIHJldHVybiBuLnNlY29uZHMgPT09IHMuc2Vjb25kcyAmJiBuLm5hbm9zID09PSBzLm5hbm9zO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDUgLyogVHlwZU9yZGVyLlN0cmluZ1ZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIHQuc3RyaW5nVmFsdWUgPT09IGUuc3RyaW5nVmFsdWU7XG5cbiAgICAgIGNhc2UgNiAvKiBUeXBlT3JkZXIuQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiB4ZSh0LmJ5dGVzVmFsdWUpLmlzRXF1YWwoeGUoZS5ieXRlc1ZhbHVlKSk7XG4gICAgICAgIH0odCwgZSk7XG5cbiAgICAgIGNhc2UgNyAvKiBUeXBlT3JkZXIuUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5yZWZlcmVuY2VWYWx1ZSA9PT0gZS5yZWZlcmVuY2VWYWx1ZTtcblxuICAgICAgY2FzZSA4IC8qIFR5cGVPcmRlci5HZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBDZSh0Lmdlb1BvaW50VmFsdWUubGF0aXR1ZGUpID09PSBDZShlLmdlb1BvaW50VmFsdWUubGF0aXR1ZGUpICYmIENlKHQuZ2VvUG9pbnRWYWx1ZS5sb25naXR1ZGUpID09PSBDZShlLmdlb1BvaW50VmFsdWUubG9uZ2l0dWRlKTtcbiAgICAgICAgfSh0LCBlKTtcblxuICAgICAgY2FzZSAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBpZiAoXCJpbnRlZ2VyVmFsdWVcIiBpbiB0ICYmIFwiaW50ZWdlclZhbHVlXCIgaW4gZSkgcmV0dXJuIENlKHQuaW50ZWdlclZhbHVlKSA9PT0gQ2UoZS5pbnRlZ2VyVmFsdWUpO1xuICAgICAgICAgICAgaWYgKFwiZG91YmxlVmFsdWVcIiBpbiB0ICYmIFwiZG91YmxlVmFsdWVcIiBpbiBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IENlKHQuZG91YmxlVmFsdWUpLCBzID0gQ2UoZS5kb3VibGVWYWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gPT09IHMgPyBCdChuKSA9PT0gQnQocykgOiBpc05hTihuKSAmJiBpc05hTihzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgfSh0LCBlKTtcblxuICAgICAgY2FzZSA5IC8qIFR5cGVPcmRlci5BcnJheVZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIG50KHQuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIGUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW10sIHFlKTtcblxuICAgICAgY2FzZSAxMCAvKiBUeXBlT3JkZXIuT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQubWFwVmFsdWUuZmllbGRzIHx8IHt9LCBzID0gZS5tYXBWYWx1ZS5maWVsZHMgfHwge307XG4gICAgICAgICAgICBpZiAobWUobikgIT09IG1lKHMpKSByZXR1cm4gITE7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgaW4gbikgaWYgKG4uaGFzT3duUHJvcGVydHkodCkgJiYgKHZvaWQgMCA9PT0gc1t0XSB8fCAhcWUoblt0XSwgc1t0XSkpKSByZXR1cm4gITE7XG4gICAgICAgICAgICByZXR1cm4gITA7XG4gICAgICAgIH1cbiAgICAgICAgLyoqIFJldHVybnMgdHJ1ZSBpZiB0aGUgQXJyYXlWYWx1ZSBjb250YWlucyB0aGUgc3BlY2lmaWVkIGVsZW1lbnQuICovICh0LCBlKTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuICQoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFVlKHQsIGUpIHtcbiAgICByZXR1cm4gdm9pZCAwICE9PSAodC52YWx1ZXMgfHwgW10pLmZpbmQoKHQgPT4gcWUodCwgZSkpKTtcbn1cblxuZnVuY3Rpb24gS2UodCwgZSkge1xuICAgIGlmICh0ID09PSBlKSByZXR1cm4gMDtcbiAgICBjb25zdCBuID0gTGUodCksIHMgPSBMZShlKTtcbiAgICBpZiAobiAhPT0gcykgcmV0dXJuIGV0KG4sIHMpO1xuICAgIHN3aXRjaCAobikge1xuICAgICAgY2FzZSAwIC8qIFR5cGVPcmRlci5OdWxsVmFsdWUgKi8gOlxuICAgICAgY2FzZSA5MDA3MTk5MjU0NzQwOTkxIC8qIFR5cGVPcmRlci5NYXhWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiAwO1xuXG4gICAgICBjYXNlIDEgLyogVHlwZU9yZGVyLkJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBldCh0LmJvb2xlYW5WYWx1ZSwgZS5ib29sZWFuVmFsdWUpO1xuXG4gICAgICBjYXNlIDIgLyogVHlwZU9yZGVyLk51bWJlclZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBDZSh0LmludGVnZXJWYWx1ZSB8fCB0LmRvdWJsZVZhbHVlKSwgcyA9IENlKGUuaW50ZWdlclZhbHVlIHx8IGUuZG91YmxlVmFsdWUpO1xuICAgICAgICAgICAgcmV0dXJuIG4gPCBzID8gLTEgOiBuID4gcyA/IDEgOiBuID09PSBzID8gMCA6IFxuICAgICAgICAgICAgLy8gb25lIG9yIGJvdGggYXJlIE5hTi5cbiAgICAgICAgICAgIGlzTmFOKG4pID8gaXNOYU4ocykgPyAwIDogLTEgOiAxO1xuICAgICAgICB9KHQsIGUpO1xuXG4gICAgICBjYXNlIDMgLyogVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIEdlKHQudGltZXN0YW1wVmFsdWUsIGUudGltZXN0YW1wVmFsdWUpO1xuXG4gICAgICBjYXNlIDQgLyogVHlwZU9yZGVyLlNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIEdlKE1lKHQpLCBNZShlKSk7XG5cbiAgICAgIGNhc2UgNSAvKiBUeXBlT3JkZXIuU3RyaW5nVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZXQodC5zdHJpbmdWYWx1ZSwgZS5zdHJpbmdWYWx1ZSk7XG5cbiAgICAgIGNhc2UgNiAvKiBUeXBlT3JkZXIuQmxvYlZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB4ZSh0KSwgcyA9IHhlKGUpO1xuICAgICAgICAgICAgcmV0dXJuIG4uY29tcGFyZVRvKHMpO1xuICAgICAgICB9KHQuYnl0ZXNWYWx1ZSwgZS5ieXRlc1ZhbHVlKTtcblxuICAgICAgY2FzZSA3IC8qIFR5cGVPcmRlci5SZWZWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5zcGxpdChcIi9cIiksIHMgPSBlLnNwbGl0KFwiL1wiKTtcbiAgICAgICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgbi5sZW5ndGggJiYgdCA8IHMubGVuZ3RoOyB0KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gZXQoblt0XSwgc1t0XSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IGUpIHJldHVybiBlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGV0KG4ubGVuZ3RoLCBzLmxlbmd0aCk7XG4gICAgICAgIH0odC5yZWZlcmVuY2VWYWx1ZSwgZS5yZWZlcmVuY2VWYWx1ZSk7XG5cbiAgICAgIGNhc2UgOCAvKiBUeXBlT3JkZXIuR2VvUG9pbnRWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZXQoQ2UodC5sYXRpdHVkZSksIENlKGUubGF0aXR1ZGUpKTtcbiAgICAgICAgICAgIGlmICgwICE9PSBuKSByZXR1cm4gbjtcbiAgICAgICAgICAgIHJldHVybiBldChDZSh0LmxvbmdpdHVkZSksIENlKGUubG9uZ2l0dWRlKSk7XG4gICAgICAgIH0odC5nZW9Qb2ludFZhbHVlLCBlLmdlb1BvaW50VmFsdWUpO1xuXG4gICAgICBjYXNlIDkgLyogVHlwZU9yZGVyLkFycmF5VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQudmFsdWVzIHx8IFtdLCBzID0gZS52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IG4ubGVuZ3RoICYmIHQgPCBzLmxlbmd0aDsgKyt0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IEtlKG5bdF0sIHNbdF0pO1xuICAgICAgICAgICAgICAgIGlmIChlKSByZXR1cm4gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBldChuLmxlbmd0aCwgcy5sZW5ndGgpO1xuICAgICAgICB9KHQuYXJyYXlWYWx1ZSwgZS5hcnJheVZhbHVlKTtcblxuICAgICAgY2FzZSAxMCAvKiBUeXBlT3JkZXIuT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQgPT09IEZlLm1hcFZhbHVlICYmIGUgPT09IEZlLm1hcFZhbHVlKSByZXR1cm4gMDtcbiAgICAgICAgICAgIGlmICh0ID09PSBGZS5tYXBWYWx1ZSkgcmV0dXJuIDE7XG4gICAgICAgICAgICBpZiAoZSA9PT0gRmUubWFwVmFsdWUpIHJldHVybiAtMTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LmZpZWxkcyB8fCB7fSwgcyA9IE9iamVjdC5rZXlzKG4pLCBpID0gZS5maWVsZHMgfHwge30sIHIgPSBPYmplY3Qua2V5cyhpKTtcbiAgICAgICAgICAgIC8vIEV2ZW4gdGhvdWdoIE1hcFZhbHVlcyBhcmUgbGlrZWx5IHNvcnRlZCBjb3JyZWN0bHkgYmFzZWQgb24gdGhlaXIgaW5zZXJ0aW9uXG4gICAgICAgICAgICAvLyBvcmRlciAoZS5nLiB3aGVuIHJlY2VpdmVkIGZyb20gdGhlIGJhY2tlbmQpLCBsb2NhbCBtb2RpZmljYXRpb25zIGNhbiBicmluZ1xuICAgICAgICAgICAgLy8gZWxlbWVudHMgb3V0IG9mIG9yZGVyLiBXZSBuZWVkIHRvIHJlLXNvcnQgdGhlIGVsZW1lbnRzIHRvIGVuc3VyZSB0aGF0XG4gICAgICAgICAgICAvLyBjYW5vbmljYWwgSURzIGFyZSBpbmRlcGVuZGVudCBvZiBpbnNlcnRpb24gb3JkZXIuXG4gICAgICAgICAgICBzLnNvcnQoKSwgci5zb3J0KCk7XG4gICAgICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHMubGVuZ3RoICYmIHQgPCByLmxlbmd0aDsgKyt0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IGV0KHNbdF0sIHJbdF0pO1xuICAgICAgICAgICAgICAgIGlmICgwICE9PSBlKSByZXR1cm4gZTtcbiAgICAgICAgICAgICAgICBjb25zdCBvID0gS2UobltzW3RdXSwgaVtyW3RdXSk7XG4gICAgICAgICAgICAgICAgaWYgKDAgIT09IG8pIHJldHVybiBvO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGV0KHMubGVuZ3RoLCByLmxlbmd0aCk7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBHZW5lcmF0ZXMgdGhlIGNhbm9uaWNhbCBJRCBmb3IgdGhlIHByb3ZpZGVkIGZpZWxkIHZhbHVlIChhcyB1c2VkIGluIFRhcmdldFxuICogc2VyaWFsaXphdGlvbikuXG4gKi8gKHQubWFwVmFsdWUsIGUubWFwVmFsdWUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyAkKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBHZSh0LCBlKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSAmJiB0Lmxlbmd0aCA9PT0gZS5sZW5ndGgpIHJldHVybiBldCh0LCBlKTtcbiAgICBjb25zdCBuID0gRGUodCksIHMgPSBEZShlKSwgaSA9IGV0KG4uc2Vjb25kcywgcy5zZWNvbmRzKTtcbiAgICByZXR1cm4gMCAhPT0gaSA/IGkgOiBldChuLm5hbm9zLCBzLm5hbm9zKTtcbn1cblxuZnVuY3Rpb24gUWUodCkge1xuICAgIHJldHVybiBqZSh0KTtcbn1cblxuZnVuY3Rpb24gamUodCkge1xuICAgIHJldHVybiBcIm51bGxWYWx1ZVwiIGluIHQgPyBcIm51bGxcIiA6IFwiYm9vbGVhblZhbHVlXCIgaW4gdCA/IFwiXCIgKyB0LmJvb2xlYW5WYWx1ZSA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCA/IFwiXCIgKyB0LmludGVnZXJWYWx1ZSA6IFwiZG91YmxlVmFsdWVcIiBpbiB0ID8gXCJcIiArIHQuZG91YmxlVmFsdWUgOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IERlKHQpO1xuICAgICAgICByZXR1cm4gYHRpbWUoJHtlLnNlY29uZHN9LCR7ZS5uYW5vc30pYDtcbiAgICB9KHQudGltZXN0YW1wVmFsdWUpIDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB0LnN0cmluZ1ZhbHVlIDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IHhlKHQuYnl0ZXNWYWx1ZSkudG9CYXNlNjQoKSA6IFwicmVmZXJlbmNlVmFsdWVcIiBpbiB0ID8gKG4gPSB0LnJlZmVyZW5jZVZhbHVlLCBcbiAgICBodC5mcm9tTmFtZShuKS50b1N0cmluZygpKSA6IFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQgPyBgZ2VvKCR7KGUgPSB0Lmdlb1BvaW50VmFsdWUpLmxhdGl0dWRlfSwke2UubG9uZ2l0dWRlfSlgIDogXCJhcnJheVZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGUgPSBcIltcIiwgbiA9ICEwO1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdC52YWx1ZXMgfHwgW10pIG4gPyBuID0gITEgOiBlICs9IFwiLFwiLCBlICs9IGplKHMpO1xuICAgICAgICByZXR1cm4gZSArIFwiXVwiO1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYW4gYXBwcm94aW1hdGUgKGFuZCB3aWxkbHkgaW5hY2N1cmF0ZSkgaW4tbWVtb3J5IHNpemUgZm9yIHRoZSBmaWVsZFxuICogdmFsdWUuXG4gKlxuICogVGhlIG1lbW9yeSBzaXplIHRha2VzIGludG8gYWNjb3VudCBvbmx5IHRoZSBhY3R1YWwgdXNlciBkYXRhIGFzIGl0IHJlc2lkZXNcbiAqIGluIG1lbW9yeSBhbmQgaWdub3JlcyBvYmplY3Qgb3ZlcmhlYWQuXG4gKi8gKHQuYXJyYXlWYWx1ZSkgOiBcIm1hcFZhbHVlXCIgaW4gdCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgLy8gSXRlcmF0aW9uIG9yZGVyIGluIEphdmFTY3JpcHQgaXMgbm90IGd1YXJhbnRlZWQuIFRvIGVuc3VyZSB0aGF0IHdlIGdlbmVyYXRlXG4gICAgICAgIC8vIG1hdGNoaW5nIGNhbm9uaWNhbCBJRHMgZm9yIGlkZW50aWNhbCBtYXBzLCB3ZSBuZWVkIHRvIHNvcnQgdGhlIGtleXMuXG4gICAgICAgIGNvbnN0IGUgPSBPYmplY3Qua2V5cyh0LmZpZWxkcyB8fCB7fSkuc29ydCgpO1xuICAgICAgICBsZXQgbiA9IFwie1wiLCBzID0gITA7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBlKSBzID8gcyA9ICExIDogbiArPSBcIixcIiwgbiArPSBgJHtpfToke2plKHQuZmllbGRzW2ldKX1gO1xuICAgICAgICByZXR1cm4gbiArIFwifVwiO1xuICAgIH0odC5tYXBWYWx1ZSkgOiAkKCk7XG4gICAgdmFyIGUsIG47XG59XG5cbmZ1bmN0aW9uIHplKHQpIHtcbiAgICBzd2l0Y2ggKExlKHQpKSB7XG4gICAgICBjYXNlIDAgLyogVHlwZU9yZGVyLk51bGxWYWx1ZSAqLyA6XG4gICAgICBjYXNlIDEgLyogVHlwZU9yZGVyLkJvb2xlYW5WYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiA0O1xuXG4gICAgICBjYXNlIDIgLyogVHlwZU9yZGVyLk51bWJlclZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIDg7XG5cbiAgICAgIGNhc2UgMyAvKiBUeXBlT3JkZXIuVGltZXN0YW1wVmFsdWUgKi8gOlxuICAgICAgY2FzZSA4IC8qIFR5cGVPcmRlci5HZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgLy8gR2VvUG9pbnRzIGFyZSBtYWRlIHVwIG9mIHR3byBkaXN0aW5jdCBudW1iZXJzIChsYXRpdHVkZSArIGxvbmdpdHVkZSlcbiAgICAgICAgcmV0dXJuIDE2O1xuXG4gICAgICBjYXNlIDQgLyogVHlwZU9yZGVyLlNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgY29uc3QgZSA9IGtlKHQpO1xuICAgICAgICByZXR1cm4gZSA/IDE2ICsgemUoZSkgOiAxNjtcblxuICAgICAgY2FzZSA1IC8qIFR5cGVPcmRlci5TdHJpbmdWYWx1ZSAqLyA6XG4gICAgICAgIC8vIFNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0RhdGFfc3RydWN0dXJlczpcbiAgICAgICAgLy8gXCJKYXZhU2NyaXB0J3MgU3RyaW5nIHR5cGUgaXMgWy4uLl0gYSBzZXQgb2YgZWxlbWVudHMgb2YgMTYtYml0IHVuc2lnbmVkXG4gICAgICAgIC8vIGludGVnZXIgdmFsdWVzXCJcbiAgICAgICAgcmV0dXJuIDIgKiB0LnN0cmluZ1ZhbHVlLmxlbmd0aDtcblxuICAgICAgY2FzZSA2IC8qIFR5cGVPcmRlci5CbG9iVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4geGUodC5ieXRlc1ZhbHVlKS5hcHByb3hpbWF0ZUJ5dGVTaXplKCk7XG5cbiAgICAgIGNhc2UgNyAvKiBUeXBlT3JkZXIuUmVmVmFsdWUgKi8gOlxuICAgICAgICByZXR1cm4gdC5yZWZlcmVuY2VWYWx1ZS5sZW5ndGg7XG5cbiAgICAgIGNhc2UgOSAvKiBUeXBlT3JkZXIuQXJyYXlWYWx1ZSAqLyA6XG4gICAgICAgIHJldHVybiAodC5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSkucmVkdWNlKCgodCwgZSkgPT4gdCArIHplKGUpKSwgMCk7XG5cbiAgICAgIGNhc2UgMTAgLyogVHlwZU9yZGVyLk9iamVjdFZhbHVlICovIDpcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgICAgIHJldHVybiBnZSh0LmZpZWxkcywgKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZSArPSB0Lmxlbmd0aCArIHplKG4pO1xuICAgICAgICAgICAgfSkpLCBlO1xuICAgICAgICB9KHQubWFwVmFsdWUpO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyAkKCk7XG4gICAgfVxufVxuXG4vKiogUmV0dXJucyBhIHJlZmVyZW5jZSB2YWx1ZSBmb3IgdGhlIHByb3ZpZGVkIGRhdGFiYXNlIGFuZCBrZXkuICovXG5mdW5jdGlvbiBXZSh0LCBlKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVmZXJlbmNlVmFsdWU6IGBwcm9qZWN0cy8ke3QucHJvamVjdElkfS9kYXRhYmFzZXMvJHt0LmRhdGFiYXNlfS9kb2N1bWVudHMvJHtlLnBhdGguY2Fub25pY2FsU3RyaW5nKCl9YFxuICAgIH07XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhbiBJbnRlZ2VyVmFsdWUgLiAqLyBmdW5jdGlvbiBIZSh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImludGVnZXJWYWx1ZVwiIGluIHQ7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYHZhbHVlYCBpcyBhIERvdWJsZVZhbHVlLiAqL1xuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGFuIEFycmF5VmFsdWUuICovXG5mdW5jdGlvbiBKZSh0KSB7XG4gICAgcmV0dXJuICEhdCAmJiBcImFycmF5VmFsdWVcIiBpbiB0O1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIGB2YWx1ZWAgaXMgYSBOdWxsVmFsdWUuICovIGZ1bmN0aW9uIFllKHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwibnVsbFZhbHVlXCIgaW4gdDtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIE5hTi4gKi8gZnVuY3Rpb24gWGUodCkge1xuICAgIHJldHVybiAhIXQgJiYgXCJkb3VibGVWYWx1ZVwiIGluIHQgJiYgaXNOYU4oTnVtYmVyKHQuZG91YmxlVmFsdWUpKTtcbn1cblxuLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGEgTWFwVmFsdWUuICovIGZ1bmN0aW9uIFplKHQpIHtcbiAgICByZXR1cm4gISF0ICYmIFwibWFwVmFsdWVcIiBpbiB0O1xufVxuXG4vKiogQ3JlYXRlcyBhIGRlZXAgY29weSBvZiBgc291cmNlYC4gKi8gZnVuY3Rpb24gdG4odCkge1xuICAgIGlmICh0Lmdlb1BvaW50VmFsdWUpIHJldHVybiB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IE9iamVjdC5hc3NpZ24oe30sIHQuZ2VvUG9pbnRWYWx1ZSlcbiAgICB9O1xuICAgIGlmICh0LnRpbWVzdGFtcFZhbHVlICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQudGltZXN0YW1wVmFsdWUpIHJldHVybiB7XG4gICAgICAgIHRpbWVzdGFtcFZhbHVlOiBPYmplY3QuYXNzaWduKHt9LCB0LnRpbWVzdGFtcFZhbHVlKVxuICAgIH07XG4gICAgaWYgKHQubWFwVmFsdWUpIHtcbiAgICAgICAgY29uc3QgZSA9IHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiB7fVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZ2UodC5tYXBWYWx1ZS5maWVsZHMsICgodCwgbikgPT4gZS5tYXBWYWx1ZS5maWVsZHNbdF0gPSB0bihuKSkpLCBlO1xuICAgIH1cbiAgICBpZiAodC5hcnJheVZhbHVlKSB7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgdmFsdWVzOiBbXVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8ICh0LmFycmF5VmFsdWUudmFsdWVzIHx8IFtdKS5sZW5ndGg7ICsrbikgZS5hcnJheVZhbHVlLnZhbHVlc1tuXSA9IHRuKHQuYXJyYXlWYWx1ZS52YWx1ZXNbbl0pO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oe30sIHQpO1xufVxuXG4vKiogUmV0dXJucyB0cnVlIGlmIHRoZSBWYWx1ZSByZXByZXNlbnRzIHRoZSBjYW5vbmljYWwge0BsaW5rICNNQVhfVkFMVUV9IC4gKi8gZnVuY3Rpb24gZW4odCkge1xuICAgIHJldHVybiBcIl9fbWF4X19cIiA9PT0gKCgodC5tYXBWYWx1ZSB8fCB7fSkuZmllbGRzIHx8IHt9KS5fX3R5cGVfXyB8fCB7fSkuc3RyaW5nVmFsdWU7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBsb3dlc3QgdmFsdWUgZm9yIHRoZSBnaXZlbiB2YWx1ZSB0eXBlIChpbmNsdXNpdmUpLiAqLyBmdW5jdGlvbiBubih0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IEJlIDogXCJib29sZWFuVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBib29sZWFuVmFsdWU6ICExXG4gICAgfSA6IFwiaW50ZWdlclZhbHVlXCIgaW4gdCB8fCBcImRvdWJsZVZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgIH0gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgdGltZXN0YW1wVmFsdWU6IHtcbiAgICAgICAgICAgIHNlY29uZHM6IE51bWJlci5NSU5fU0FGRV9JTlRFR0VSXG4gICAgICAgIH1cbiAgICB9IDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIHN0cmluZ1ZhbHVlOiBcIlwiXG4gICAgfSA6IFwiYnl0ZXNWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGJ5dGVzVmFsdWU6IFwiXCJcbiAgICB9IDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyBXZSgkZS5lbXB0eSgpLCBodC5lbXB0eSgpKSA6IFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiAtOTAsXG4gICAgICAgICAgICBsb25naXR1ZGU6IC0xODBcbiAgICAgICAgfVxuICAgIH0gOiBcImFycmF5VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgIH0gOiBcIm1hcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgfSA6ICQoKTtcbn1cblxuLyoqIFJldHVybnMgdGhlIGxhcmdlc3QgdmFsdWUgZm9yIHRoZSBnaXZlbiB2YWx1ZSB0eXBlIChleGNsdXNpdmUpLiAqLyBmdW5jdGlvbiBzbih0KSB7XG4gICAgcmV0dXJuIFwibnVsbFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgYm9vbGVhblZhbHVlOiAhMVxuICAgIH0gOiBcImJvb2xlYW5WYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICB9IDogXCJpbnRlZ2VyVmFsdWVcIiBpbiB0IHx8IFwiZG91YmxlVmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgc2Vjb25kczogTnVtYmVyLk1JTl9TQUZFX0lOVEVHRVJcbiAgICAgICAgfVxuICAgIH0gOiBcInRpbWVzdGFtcFZhbHVlXCIgaW4gdCA/IHtcbiAgICAgICAgc3RyaW5nVmFsdWU6IFwiXCJcbiAgICB9IDogXCJzdHJpbmdWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGJ5dGVzVmFsdWU6IFwiXCJcbiAgICB9IDogXCJieXRlc1ZhbHVlXCIgaW4gdCA/IFdlKCRlLmVtcHR5KCksIGh0LmVtcHR5KCkpIDogXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQgPyB7XG4gICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgIGxhdGl0dWRlOiAtOTAsXG4gICAgICAgICAgICBsb25naXR1ZGU6IC0xODBcbiAgICAgICAgfVxuICAgIH0gOiBcImdlb1BvaW50VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBhcnJheVZhbHVlOiB7fVxuICAgIH0gOiBcImFycmF5VmFsdWVcIiBpbiB0ID8ge1xuICAgICAgICBtYXBWYWx1ZToge31cbiAgICB9IDogXCJtYXBWYWx1ZVwiIGluIHQgPyBGZSA6ICQoKTtcbn1cblxuZnVuY3Rpb24gcm4odCwgZSkge1xuICAgIGNvbnN0IG4gPSBLZSh0LnZhbHVlLCBlLnZhbHVlKTtcbiAgICByZXR1cm4gMCAhPT0gbiA/IG4gOiB0LmluY2x1c2l2ZSAmJiAhZS5pbmNsdXNpdmUgPyAtMSA6ICF0LmluY2x1c2l2ZSAmJiBlLmluY2x1c2l2ZSA/IDEgOiAwO1xufVxuXG5mdW5jdGlvbiBvbih0LCBlKSB7XG4gICAgY29uc3QgbiA9IEtlKHQudmFsdWUsIGUudmFsdWUpO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IHQuaW5jbHVzaXZlICYmICFlLmluY2x1c2l2ZSA/IDEgOiAhdC5pbmNsdXNpdmUgJiYgZS5pbmNsdXNpdmUgPyAtMSA6IDA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIE9iamVjdFZhbHVlIHJlcHJlc2VudHMgYSBNYXBWYWx1ZSBpbiB0aGUgRmlyZXN0b3JlIFByb3RvIGFuZCBvZmZlcnMgdGhlXG4gKiBhYmlsaXR5IHRvIGFkZCBhbmQgcmVtb3ZlIGZpZWxkcyAodmlhIHRoZSBPYmplY3RWYWx1ZUJ1aWxkZXIpLlxuICovIGNsYXNzIHVuIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMudmFsdWUgPSB0O1xuICAgIH1cbiAgICBzdGF0aWMgZW1wdHkoKSB7XG4gICAgICAgIHJldHVybiBuZXcgdW4oe1xuICAgICAgICAgICAgbWFwVmFsdWU6IHt9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2YWx1ZSBhdCB0aGUgZ2l2ZW4gcGF0aCBvciBudWxsLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSB0aGUgcGF0aCB0byBzZWFyY2hcbiAgICAgKiBAcmV0dXJucyBUaGUgdmFsdWUgYXQgdGhlIHBhdGggb3IgbnVsbCBpZiB0aGUgcGF0aCBpcyBub3Qgc2V0LlxuICAgICAqLyAgICBmaWVsZCh0KSB7XG4gICAgICAgIGlmICh0LmlzRW1wdHkoKSkgcmV0dXJuIHRoaXMudmFsdWU7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGxldCBlID0gdGhpcy52YWx1ZTtcbiAgICAgICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGggLSAxOyArK24pIGlmIChlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0LmdldChuKV0sIFxuICAgICAgICAgICAgIVplKGUpKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiBlID0gKGUubWFwVmFsdWUuZmllbGRzIHx8IHt9KVt0Lmxhc3RTZWdtZW50KCldLCBlIHx8IG51bGw7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgZmllbGQgdG8gdGhlIHByb3ZpZGVkIHZhbHVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHBhdGggLSBUaGUgZmllbGQgcGF0aCB0byBzZXQuXG4gICAgICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIHRvIHNldC5cbiAgICAgKi8gICAgc2V0KHQsIGUpIHtcbiAgICAgICAgdGhpcy5nZXRGaWVsZHNNYXAodC5wb3BMYXN0KCkpW3QubGFzdFNlZ21lbnQoKV0gPSB0bihlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgcHJvdmlkZWQgZmllbGRzIHRvIHRoZSBwcm92aWRlZCB2YWx1ZXMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZGF0YSAtIEEgbWFwIG9mIGZpZWxkcyB0byB2YWx1ZXMgKG9yIG51bGwgZm9yIGRlbGV0ZXMpLlxuICAgICAqLyAgICBzZXRBbGwodCkge1xuICAgICAgICBsZXQgZSA9IGF0LmVtcHR5UGF0aCgpLCBuID0ge30sIHMgPSBbXTtcbiAgICAgICAgdC5mb3JFYWNoKCgodCwgaSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlLmlzSW1tZWRpYXRlUGFyZW50T2YoaSkpIHtcbiAgICAgICAgICAgICAgICAvLyBJbnNlcnQgdGhlIGFjY3VtdWxhdGVkIGNoYW5nZXMgYXQgdGhpcyBwYXJlbnQgbG9jYXRpb25cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBseUNoYW5nZXModCwgbiwgcyksIG4gPSB7fSwgcyA9IFtdLCBlID0gaS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ID8gbltpLmxhc3RTZWdtZW50KCldID0gdG4odCkgOiBzLnB1c2goaS5sYXN0U2VnbWVudCgpKTtcbiAgICAgICAgfSkpO1xuICAgICAgICBjb25zdCBpID0gdGhpcy5nZXRGaWVsZHNNYXAoZSk7XG4gICAgICAgIHRoaXMuYXBwbHlDaGFuZ2VzKGksIG4sIHMpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBmaWVsZCBhdCB0aGUgc3BlY2lmaWVkIHBhdGguIElmIHRoZXJlIGlzIG5vIGZpZWxkIGF0IHRoZVxuICAgICAqIHNwZWNpZmllZCBwYXRoLCBub3RoaW5nIGlzIGNoYW5nZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcGF0aCAtIFRoZSBmaWVsZCBwYXRoIHRvIHJlbW92ZS5cbiAgICAgKi8gICAgZGVsZXRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZmllbGQodC5wb3BMYXN0KCkpO1xuICAgICAgICBaZShlKSAmJiBlLm1hcFZhbHVlLmZpZWxkcyAmJiBkZWxldGUgZS5tYXBWYWx1ZS5maWVsZHNbdC5sYXN0U2VnbWVudCgpXTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiBxZSh0aGlzLnZhbHVlLCB0LnZhbHVlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgbWFwIHRoYXQgY29udGFpbnMgdGhlIGxlYWYgZWxlbWVudCBvZiBgcGF0aGAuIElmIHRoZSBwYXJlbnRcbiAgICAgKiBlbnRyeSBkb2VzIG5vdCB5ZXQgZXhpc3QsIG9yIGlmIGl0IGlzIG5vdCBhIG1hcCwgYSBuZXcgbWFwIHdpbGwgYmUgY3JlYXRlZC5cbiAgICAgKi8gICAgZ2V0RmllbGRzTWFwKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0aGlzLnZhbHVlO1xuICAgICAgICBlLm1hcFZhbHVlLmZpZWxkcyB8fCAoZS5tYXBWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZpZWxkczoge31cbiAgICAgICAgfSk7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgbGV0IHMgPSBlLm1hcFZhbHVlLmZpZWxkc1t0LmdldChuKV07XG4gICAgICAgICAgICBaZShzKSAmJiBzLm1hcFZhbHVlLmZpZWxkcyB8fCAocyA9IHtcbiAgICAgICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHt9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwgZS5tYXBWYWx1ZS5maWVsZHNbdC5nZXQobildID0gcyksIGUgPSBzO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBlLm1hcFZhbHVlLmZpZWxkcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgYGZpZWxkc01hcGAgYnkgYWRkaW5nLCByZXBsYWNpbmcgb3IgZGVsZXRpbmcgdGhlIHNwZWNpZmllZFxuICAgICAqIGVudHJpZXMuXG4gICAgICovICAgIGFwcGx5Q2hhbmdlcyh0LCBlLCBuKSB7XG4gICAgICAgIGdlKGUsICgoZSwgbikgPT4gdFtlXSA9IG4pKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIG4pIGRlbGV0ZSB0W2VdO1xuICAgIH1cbiAgICBjbG9uZSgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyB1bih0bih0aGlzLnZhbHVlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaWVsZE1hc2sgYnVpbHQgZnJvbSBhbGwgZmllbGRzIGluIGEgTWFwVmFsdWUuXG4gKi8gZnVuY3Rpb24gY24odCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gZ2UodC5maWVsZHMsICgodCwgbikgPT4ge1xuICAgICAgICBjb25zdCBzID0gbmV3IGF0KFsgdCBdKTtcbiAgICAgICAgaWYgKFplKG4pKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gY24obi5tYXBWYWx1ZSkuZmllbGRzO1xuICAgICAgICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSBcbiAgICAgICAgICAgIC8vIFByZXNlcnZlIHRoZSBlbXB0eSBtYXAgYnkgYWRkaW5nIGl0IHRvIHRoZSBGaWVsZE1hc2suXG4gICAgICAgICAgICBlLnB1c2gocyk7IGVsc2UgXG4gICAgICAgICAgICAvLyBGb3IgbmVzdGVkIGFuZCBub24tZW1wdHkgT2JqZWN0VmFsdWVzLCBhZGQgdGhlIEZpZWxkUGF0aCBvZiB0aGVcbiAgICAgICAgICAgIC8vIGxlYWYgbm9kZXMuXG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdCkgZS5wdXNoKHMuY2hpbGQobikpO1xuICAgICAgICB9IGVsc2UgXG4gICAgICAgIC8vIEZvciBuZXN0ZWQgYW5kIG5vbi1lbXB0eSBPYmplY3RWYWx1ZXMsIGFkZCB0aGUgRmllbGRQYXRoIG9mIHRoZSBsZWFmXG4gICAgICAgIC8vIG5vZGVzLlxuICAgICAgICBlLnB1c2gocyk7XG4gICAgfSkpLCBuZXcgdmUoZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJlcHJlc2VudHMgYSBkb2N1bWVudCBpbiBGaXJlc3RvcmUgd2l0aCBhIGtleSwgdmVyc2lvbiwgZGF0YSBhbmQgd2hldGhlciBpdFxuICogaGFzIGxvY2FsIG11dGF0aW9ucyBhcHBsaWVkIHRvIGl0LlxuICpcbiAqIERvY3VtZW50cyBjYW4gdHJhbnNpdGlvbiBiZXR3ZWVuIHN0YXRlcyB2aWEgYGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQoKWAsXG4gKiBgY29udmVydFRvTm9Eb2N1bWVudCgpYCBhbmQgYGNvbnZlcnRUb1Vua25vd25Eb2N1bWVudCgpYC4gSWYgYSBkb2N1bWVudCBkb2VzXG4gKiBub3QgdHJhbnNpdGlvbiB0byBvbmUgb2YgdGhlc2Ugc3RhdGVzIGV2ZW4gYWZ0ZXIgYWxsIG11dGF0aW9ucyBoYXZlIGJlZW5cbiAqIGFwcGxpZWQsIGBpc1ZhbGlkRG9jdW1lbnQoKWAgcmV0dXJucyBmYWxzZSBhbmQgdGhlIGRvY3VtZW50IHNob3VsZCBiZSByZW1vdmVkXG4gKiBmcm9tIGFsbCB2aWV3cy5cbiAqLyBjbGFzcyBhbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgciwgbykge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gZSwgdGhpcy52ZXJzaW9uID0gbiwgdGhpcy5yZWFkVGltZSA9IHMsIHRoaXMuY3JlYXRlVGltZSA9IGksIFxuICAgICAgICB0aGlzLmRhdGEgPSByLCB0aGlzLmRvY3VtZW50U3RhdGUgPSBvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgZG9jdW1lbnQgd2l0aCBubyBrbm93biB2ZXJzaW9uIG9yIGRhdGEsIGJ1dCB3aGljaCBjYW4gc2VydmUgYXNcbiAgICAgKiBiYXNlIGRvY3VtZW50IGZvciBtdXRhdGlvbnMuXG4gICAgICovICAgIHN0YXRpYyBuZXdJbnZhbGlkRG9jdW1lbnQodCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuKHQsIDAgLyogRG9jdW1lbnRUeXBlLklOVkFMSUQgKi8gLCBcbiAgICAgICAgLyogdmVyc2lvbiAqLyBydC5taW4oKSwgXG4gICAgICAgIC8qIHJlYWRUaW1lICovIHJ0Lm1pbigpLCBcbiAgICAgICAgLyogY3JlYXRlVGltZSAqLyBydC5taW4oKSwgdW4uZW1wdHkoKSwgMCAvKiBEb2N1bWVudFN0YXRlLlNZTkNFRCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgZG9jdW1lbnQgdGhhdCBpcyBrbm93biB0byBleGlzdCB3aXRoIHRoZSBnaXZlbiBkYXRhIGF0IHRoZVxuICAgICAqIGdpdmVuIHZlcnNpb24uXG4gICAgICovICAgIHN0YXRpYyBuZXdGb3VuZERvY3VtZW50KHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBhbih0LCAxIC8qIERvY3VtZW50VHlwZS5GT1VORF9ET0NVTUVOVCAqLyAsIFxuICAgICAgICAvKiB2ZXJzaW9uICovIGUsIFxuICAgICAgICAvKiByZWFkVGltZSAqLyBydC5taW4oKSwgXG4gICAgICAgIC8qIGNyZWF0ZVRpbWUgKi8gbiwgcywgMCAvKiBEb2N1bWVudFN0YXRlLlNZTkNFRCAqLyk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IGRvY3VtZW50IHRoYXQgaXMga25vd24gdG8gbm90IGV4aXN0IGF0IHRoZSBnaXZlbiB2ZXJzaW9uLiAqLyAgICBzdGF0aWMgbmV3Tm9Eb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW4odCwgMiAvKiBEb2N1bWVudFR5cGUuTk9fRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgLyogdmVyc2lvbiAqLyBlLCBcbiAgICAgICAgLyogcmVhZFRpbWUgKi8gcnQubWluKCksIFxuICAgICAgICAvKiBjcmVhdGVUaW1lICovIHJ0Lm1pbigpLCB1bi5lbXB0eSgpLCAwIC8qIERvY3VtZW50U3RhdGUuU1lOQ0VEICovKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBkb2N1bWVudCB0aGF0IGlzIGtub3duIHRvIGV4aXN0IGF0IHRoZSBnaXZlbiB2ZXJzaW9uIGJ1dFxuICAgICAqIHdob3NlIGRhdGEgaXMgbm90IGtub3duIChlLmcuIGEgZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd25cbiAgICAgKiBiYXNlIGRvY3VtZW50KS5cbiAgICAgKi8gICAgc3RhdGljIG5ld1Vua25vd25Eb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgYW4odCwgMyAvKiBEb2N1bWVudFR5cGUuVU5LTk9XTl9ET0NVTUVOVCAqLyAsIFxuICAgICAgICAvKiB2ZXJzaW9uICovIGUsIFxuICAgICAgICAvKiByZWFkVGltZSAqLyBydC5taW4oKSwgXG4gICAgICAgIC8qIGNyZWF0ZVRpbWUgKi8gcnQubWluKCksIHVuLmVtcHR5KCksIDIgLyogRG9jdW1lbnRTdGF0ZS5IQVNfQ09NTUlUVEVEX01VVEFUSU9OUyAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYW5kIHRoYXQgaXRzIHZlcnNpb25cbiAgICAgKiBhbmQgZGF0YSBhcmUga25vd24uXG4gICAgICovICAgIGNvbnZlcnRUb0ZvdW5kRG9jdW1lbnQodCwgZSkge1xuICAgICAgICAvLyBJZiBhIGRvY3VtZW50IGlzIHN3aXRjaGluZyBzdGF0ZSBmcm9tIGJlaW5nIGFuIGludmFsaWQgb3IgZGVsZXRlZFxuICAgICAgICAvLyBkb2N1bWVudCB0byBhIHZhbGlkIChGT1VORF9ET0NVTUVOVCkgZG9jdW1lbnQsIGVpdGhlciBkdWUgdG8gcmVjZWl2aW5nIGFuXG4gICAgICAgIC8vIHVwZGF0ZSBmcm9tIFdhdGNoIG9yIGR1ZSB0byBhcHBseWluZyBhIGxvY2FsIHNldCBtdXRhdGlvbiBvbiB0b3BcbiAgICAgICAgLy8gb2YgYSBkZWxldGVkIGRvY3VtZW50LCBvdXIgYmVzdCBndWVzcyBhYm91dCBpdHMgY3JlYXRlVGltZSB3b3VsZCBiZSB0aGVcbiAgICAgICAgLy8gdmVyc2lvbiBhdCB3aGljaCB0aGUgZG9jdW1lbnQgdHJhbnNpdGlvbmVkIHRvIGEgRk9VTkRfRE9DVU1FTlQuXG4gICAgICAgIHJldHVybiAhdGhpcy5jcmVhdGVUaW1lLmlzRXF1YWwocnQubWluKCkpIHx8IDIgLyogRG9jdW1lbnRUeXBlLk5PX0RPQ1VNRU5UICovICE9PSB0aGlzLmRvY3VtZW50VHlwZSAmJiAwIC8qIERvY3VtZW50VHlwZS5JTlZBTElEICovICE9PSB0aGlzLmRvY3VtZW50VHlwZSB8fCAodGhpcy5jcmVhdGVUaW1lID0gdCksIFxuICAgICAgICB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLmRvY3VtZW50VHlwZSA9IDEgLyogRG9jdW1lbnRUeXBlLkZPVU5EX0RPQ1VNRU5UICovICwgdGhpcy5kYXRhID0gZSwgXG4gICAgICAgIHRoaXMuZG9jdW1lbnRTdGF0ZSA9IDAgLyogRG9jdW1lbnRTdGF0ZS5TWU5DRUQgKi8gLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDaGFuZ2VzIHRoZSBkb2N1bWVudCB0eXBlIHRvIGluZGljYXRlIHRoYXQgaXQgZG9lc24ndCBleGlzdCBhdCB0aGUgZ2l2ZW5cbiAgICAgKiB2ZXJzaW9uLlxuICAgICAqLyAgICBjb252ZXJ0VG9Ob0RvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMiAvKiBEb2N1bWVudFR5cGUuTk9fRE9DVU1FTlQgKi8gLCBcbiAgICAgICAgdGhpcy5kYXRhID0gdW4uZW1wdHkoKSwgdGhpcy5kb2N1bWVudFN0YXRlID0gMCAvKiBEb2N1bWVudFN0YXRlLlNZTkNFRCAqLyAsIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENoYW5nZXMgdGhlIGRvY3VtZW50IHR5cGUgdG8gaW5kaWNhdGUgdGhhdCBpdCBleGlzdHMgYXQgYSBnaXZlbiB2ZXJzaW9uIGJ1dFxuICAgICAqIHRoYXQgaXRzIGRhdGEgaXMgbm90IGtub3duIChlLmcuIGEgZG9jdW1lbnQgdGhhdCB3YXMgdXBkYXRlZCB3aXRob3V0IGEga25vd25cbiAgICAgKiBiYXNlIGRvY3VtZW50KS5cbiAgICAgKi8gICAgY29udmVydFRvVW5rbm93bkRvY3VtZW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudmVyc2lvbiA9IHQsIHRoaXMuZG9jdW1lbnRUeXBlID0gMyAvKiBEb2N1bWVudFR5cGUuVU5LTk9XTl9ET0NVTUVOVCAqLyAsIFxuICAgICAgICB0aGlzLmRhdGEgPSB1bi5lbXB0eSgpLCB0aGlzLmRvY3VtZW50U3RhdGUgPSAyIC8qIERvY3VtZW50U3RhdGUuSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gLCBcbiAgICAgICAgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzQ29tbWl0dGVkTXV0YXRpb25zKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudFN0YXRlID0gMiAvKiBEb2N1bWVudFN0YXRlLkhBU19DT01NSVRURURfTVVUQVRJT05TICovICwgdGhpcztcbiAgICB9XG4gICAgc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50U3RhdGUgPSAxIC8qIERvY3VtZW50U3RhdGUuSEFTX0xPQ0FMX01VVEFUSU9OUyAqLyAsIHRoaXMudmVyc2lvbiA9IHJ0Lm1pbigpLCBcbiAgICAgICAgdGhpcztcbiAgICB9XG4gICAgc2V0UmVhZFRpbWUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZWFkVGltZSA9IHQsIHRoaXM7XG4gICAgfVxuICAgIGdldCBoYXNMb2NhbE11dGF0aW9ucygpIHtcbiAgICAgICAgcmV0dXJuIDEgLyogRG9jdW1lbnRTdGF0ZS5IQVNfTE9DQUxfTVVUQVRJT05TICovID09PSB0aGlzLmRvY3VtZW50U3RhdGU7XG4gICAgfVxuICAgIGdldCBoYXNDb21taXR0ZWRNdXRhdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiAyIC8qIERvY3VtZW50U3RhdGUuSEFTX0NPTU1JVFRFRF9NVVRBVElPTlMgKi8gPT09IHRoaXMuZG9jdW1lbnRTdGF0ZTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc0xvY2FsTXV0YXRpb25zIHx8IHRoaXMuaGFzQ29tbWl0dGVkTXV0YXRpb25zO1xuICAgIH1cbiAgICBpc1ZhbGlkRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAwIC8qIERvY3VtZW50VHlwZS5JTlZBTElEICovICE9PSB0aGlzLmRvY3VtZW50VHlwZTtcbiAgICB9XG4gICAgaXNGb3VuZERvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMSAvKiBEb2N1bWVudFR5cGUuRk9VTkRfRE9DVU1FTlQgKi8gPT09IHRoaXMuZG9jdW1lbnRUeXBlO1xuICAgIH1cbiAgICBpc05vRG9jdW1lbnQoKSB7XG4gICAgICAgIHJldHVybiAyIC8qIERvY3VtZW50VHlwZS5OT19ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzVW5rbm93bkRvY3VtZW50KCkge1xuICAgICAgICByZXR1cm4gMyAvKiBEb2N1bWVudFR5cGUuVU5LTk9XTl9ET0NVTUVOVCAqLyA9PT0gdGhpcy5kb2N1bWVudFR5cGU7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIGFuICYmIHRoaXMua2V5LmlzRXF1YWwodC5rZXkpICYmIHRoaXMudmVyc2lvbi5pc0VxdWFsKHQudmVyc2lvbikgJiYgdGhpcy5kb2N1bWVudFR5cGUgPT09IHQuZG9jdW1lbnRUeXBlICYmIHRoaXMuZG9jdW1lbnRTdGF0ZSA9PT0gdC5kb2N1bWVudFN0YXRlICYmIHRoaXMuZGF0YS5pc0VxdWFsKHQuZGF0YSk7XG4gICAgfVxuICAgIG11dGFibGVDb3B5KCkge1xuICAgICAgICByZXR1cm4gbmV3IGFuKHRoaXMua2V5LCB0aGlzLmRvY3VtZW50VHlwZSwgdGhpcy52ZXJzaW9uLCB0aGlzLnJlYWRUaW1lLCB0aGlzLmNyZWF0ZVRpbWUsIHRoaXMuZGF0YS5jbG9uZSgpLCB0aGlzLmRvY3VtZW50U3RhdGUpO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBEb2N1bWVudCgke3RoaXMua2V5fSwgJHt0aGlzLnZlcnNpb259LCAke0pTT04uc3RyaW5naWZ5KHRoaXMuZGF0YS52YWx1ZSl9LCB7Y3JlYXRlVGltZTogJHt0aGlzLmNyZWF0ZVRpbWV9fSksIHtkb2N1bWVudFR5cGU6ICR7dGhpcy5kb2N1bWVudFR5cGV9fSksIHtkb2N1bWVudFN0YXRlOiAke3RoaXMuZG9jdW1lbnRTdGF0ZX19KWA7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXBhcmVzIHRoZSB2YWx1ZSBmb3IgZmllbGQgYGZpZWxkYCBpbiB0aGUgcHJvdmlkZWQgZG9jdW1lbnRzLiBUaHJvd3MgaWZcbiAqIHRoZSBmaWVsZCBkb2VzIG5vdCBleGlzdCBpbiBib3RoIGRvY3VtZW50cy5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGJvdW5kIG9mIGEgcXVlcnkuXG4gKlxuICogVGhlIGJvdW5kIGlzIHNwZWNpZmllZCB3aXRoIHRoZSBnaXZlbiBjb21wb25lbnRzIHJlcHJlc2VudGluZyBhIHBvc2l0aW9uIGFuZFxuICogd2hldGhlciBpdCdzIGp1c3QgYmVmb3JlIG9yIGp1c3QgYWZ0ZXIgdGhlIHBvc2l0aW9uIChyZWxhdGl2ZSB0byB3aGF0ZXZlciB0aGVcbiAqIHF1ZXJ5IG9yZGVyIGlzKS5cbiAqXG4gKiBUaGUgcG9zaXRpb24gcmVwcmVzZW50cyBhIGxvZ2ljYWwgaW5kZXggcG9zaXRpb24gZm9yIGEgcXVlcnkuIEl0J3MgYSBwcmVmaXhcbiAqIG9mIHZhbHVlcyBmb3IgdGhlIChwb3RlbnRpYWxseSBpbXBsaWNpdCkgb3JkZXIgYnkgY2xhdXNlcyBvZiBhIHF1ZXJ5LlxuICpcbiAqIEJvdW5kIHByb3ZpZGVzIGEgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHdoZXRoZXIgYSBkb2N1bWVudCBjb21lcyBiZWZvcmUgb3JcbiAqIGFmdGVyIGEgYm91bmQuIFRoaXMgaXMgaW5mbHVlbmNlZCBieSB3aGV0aGVyIHRoZSBwb3NpdGlvbiBpcyBqdXN0IGJlZm9yZSBvclxuICoganVzdCBhZnRlciB0aGUgcHJvdmlkZWQgdmFsdWVzLlxuICovXG5jbGFzcyBobiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gdCwgdGhpcy5pbmNsdXNpdmUgPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gbG4odCwgZSwgbikge1xuICAgIGxldCBzID0gMDtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHQucG9zaXRpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgciA9IGVbaV0sIG8gPSB0LnBvc2l0aW9uW2ldO1xuICAgICAgICBpZiAoci5maWVsZC5pc0tleUZpZWxkKCkpIHMgPSBodC5jb21wYXJhdG9yKGh0LmZyb21OYW1lKG8ucmVmZXJlbmNlVmFsdWUpLCBuLmtleSk7IGVsc2Uge1xuICAgICAgICAgICAgcyA9IEtlKG8sIG4uZGF0YS5maWVsZChyLmZpZWxkKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKFwiZGVzY1wiIC8qIERpcmVjdGlvbi5ERVNDRU5ESU5HICovID09PSByLmRpciAmJiAocyAqPSAtMSksIDAgIT09IHMpIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gcztcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBhZnRlciBhIGJvdW5kIHVzaW5nIHRoZSBwcm92aWRlZCBzb3J0XG4gKiBvcmRlci5cbiAqLyBmdW5jdGlvbiBmbih0LCBlKSB7XG4gICAgaWYgKG51bGwgPT09IHQpIHJldHVybiBudWxsID09PSBlO1xuICAgIGlmIChudWxsID09PSBlKSByZXR1cm4gITE7XG4gICAgaWYgKHQuaW5jbHVzaXZlICE9PSBlLmluY2x1c2l2ZSB8fCB0LnBvc2l0aW9uLmxlbmd0aCAhPT0gZS5wb3NpdGlvbi5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQucG9zaXRpb24ubGVuZ3RoOyBuKyspIHtcbiAgICAgICAgaWYgKCFxZSh0LnBvc2l0aW9uW25dLCBlLnBvc2l0aW9uW25dKSkgcmV0dXJuICExO1xuICAgIH1cbiAgICByZXR1cm4gITA7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIG9yZGVyaW5nIG9uIGEgZmllbGQsIGluIHNvbWUgRGlyZWN0aW9uLiBEaXJlY3Rpb24gZGVmYXVsdHMgdG8gQVNDRU5ESU5HLlxuICovIGNsYXNzIGRuIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlID0gXCJhc2NcIiAvKiBEaXJlY3Rpb24uQVNDRU5ESU5HICovKSB7XG4gICAgICAgIHRoaXMuZmllbGQgPSB0LCB0aGlzLmRpciA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfbih0LCBlKSB7XG4gICAgcmV0dXJuIHQuZGlyID09PSBlLmRpciAmJiB0LmZpZWxkLmlzRXF1YWwoZS5maWVsZCk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIHduIHt9XG5cbmNsYXNzIG1uIGV4dGVuZHMgd24ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5maWVsZCA9IHQsIHRoaXMub3AgPSBlLCB0aGlzLnZhbHVlID0gbjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHQuaXNLZXlGaWVsZCgpID8gXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSBlIHx8IFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovID09PSBlID8gdGhpcy5jcmVhdGVLZXlGaWVsZEluRmlsdGVyKHQsIGUsIG4pIDogbmV3IFBuKHQsIGUsIG4pIDogXCJhcnJheS1jb250YWluc1wiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TICovID09PSBlID8gbmV3IERuKHQsIG4pIDogXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSBlID8gbmV3IENuKHQsIG4pIDogXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gPT09IGUgPyBuZXcgeG4odCwgbikgOiBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gZSA/IG5ldyBObih0LCBuKSA6IG5ldyBtbih0LCBlLCBuKTtcbiAgICB9XG4gICAgc3RhdGljIGNyZWF0ZUtleUZpZWxkSW5GaWx0ZXIodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gXCJpblwiIC8qIE9wZXJhdG9yLklOICovID09PSBlID8gbmV3IGJuKHQsIG4pIDogbmV3IFZuKHQsIG4pO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZGF0YS5maWVsZCh0aGlzLmZpZWxkKTtcbiAgICAgICAgLy8gVHlwZXMgZG8gbm90IGhhdmUgdG8gbWF0Y2ggaW4gTk9UX0VRVUFMIGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gPT09IHRoaXMub3AgPyBudWxsICE9PSBlICYmIHRoaXMubWF0Y2hlc0NvbXBhcmlzb24oS2UoZSwgdGhpcy52YWx1ZSkpIDogbnVsbCAhPT0gZSAmJiBMZSh0aGlzLnZhbHVlKSA9PT0gTGUoZSkgJiYgdGhpcy5tYXRjaGVzQ29tcGFyaXNvbihLZShlLCB0aGlzLnZhbHVlKSk7XG4gICAgICAgIC8vIE9ubHkgY29tcGFyZSB0eXBlcyB3aXRoIG1hdGNoaW5nIGJhY2tlbmQgb3JkZXIgKHN1Y2ggYXMgZG91YmxlIGFuZCBpbnQpLlxuICAgICAgICB9XG4gICAgbWF0Y2hlc0NvbXBhcmlzb24odCkge1xuICAgICAgICBzd2l0Y2ggKHRoaXMub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPFwiIC8qIE9wZXJhdG9yLkxFU1NfVEhBTiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdCA8IDA7XG5cbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBPcGVyYXRvci5MRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPD0gMDtcblxuICAgICAgICAgIGNhc2UgXCI9PVwiIC8qIE9wZXJhdG9yLkVRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwID09PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiAwICE9PSB0O1xuXG4gICAgICAgICAgY2FzZSBcIj5cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU4gKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQgPiAwO1xuXG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHJldHVybiB0ID49IDA7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpc0luZXF1YWxpdHkoKSB7XG4gICAgICAgIHJldHVybiBbIFwiPFwiIC8qIE9wZXJhdG9yLkxFU1NfVEhBTiAqLyAsIFwiPD1cIiAvKiBPcGVyYXRvci5MRVNTX1RIQU5fT1JfRVFVQUwgKi8gLCBcIj5cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU4gKi8gLCBcIj49XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOX09SX0VRVUFMICovICwgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyAsIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovIF0uaW5kZXhPZih0aGlzLm9wKSA+PSAwO1xuICAgIH1cbiAgICBnZXRGbGF0dGVuZWRGaWx0ZXJzKCkge1xuICAgICAgICByZXR1cm4gWyB0aGlzIF07XG4gICAgfVxuICAgIGdldEZpbHRlcnMoKSB7XG4gICAgICAgIHJldHVybiBbIHRoaXMgXTtcbiAgICB9XG4gICAgZ2V0Rmlyc3RJbmVxdWFsaXR5RmllbGQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlzSW5lcXVhbGl0eSgpID8gdGhpcy5maWVsZCA6IG51bGw7XG4gICAgfVxufVxuXG5jbGFzcyBnbiBleHRlbmRzIHduIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlsdGVycyA9IHQsIHRoaXMub3AgPSBlLCB0aGlzLmh0ID0gbnVsbDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGZpbHRlciBiYXNlZCBvbiB0aGUgcHJvdmlkZWQgYXJndW1lbnRzLlxuICAgICAqLyAgICBzdGF0aWMgY3JlYXRlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBnbih0LCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiB5bih0aGlzKSA/IHZvaWQgMCA9PT0gdGhpcy5maWx0ZXJzLmZpbmQoKGUgPT4gIWUubWF0Y2hlcyh0KSkpIDogdm9pZCAwICE9PSB0aGlzLmZpbHRlcnMuZmluZCgoZSA9PiBlLm1hdGNoZXModCkpKTtcbiAgICB9XG4gICAgZ2V0RmxhdHRlbmVkRmlsdGVycygpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuaHQgfHwgKHRoaXMuaHQgPSB0aGlzLmZpbHRlcnMucmVkdWNlKCgodCwgZSkgPT4gdC5jb25jYXQoZS5nZXRGbGF0dGVuZWRGaWx0ZXJzKCkpKSwgW10pKSwgXG4gICAgICAgIHRoaXMuaHQ7XG4gICAgfVxuICAgIC8vIFJldHVybnMgYSBtdXRhYmxlIGNvcHkgb2YgYHRoaXMuZmlsdGVyc2BcbiAgICBnZXRGaWx0ZXJzKCkge1xuICAgICAgICByZXR1cm4gT2JqZWN0LmFzc2lnbihbXSwgdGhpcy5maWx0ZXJzKTtcbiAgICB9XG4gICAgZ2V0Rmlyc3RJbmVxdWFsaXR5RmllbGQoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB0aGlzLmx0KCh0ID0+IHQuaXNJbmVxdWFsaXR5KCkpKTtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHQgPyB0LmZpZWxkIDogbnVsbDtcbiAgICB9XG4gICAgLy8gUGVyZm9ybXMgYSBkZXB0aC1maXJzdCBzZWFyY2ggdG8gZmluZCBhbmQgcmV0dXJuIHRoZSBmaXJzdCBGaWVsZEZpbHRlciBpbiB0aGUgY29tcG9zaXRlIGZpbHRlclxuICAgIC8vIHRoYXQgc2F0aXNmaWVzIHRoZSBwcmVkaWNhdGUuIFJldHVybnMgYG51bGxgIGlmIG5vbmUgb2YgdGhlIEZpZWxkRmlsdGVycyBzYXRpc2Z5IHRoZVxuICAgIC8vIHByZWRpY2F0ZS5cbiAgICBsdCh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLmdldEZsYXR0ZW5lZEZpbHRlcnMoKSkgaWYgKHQoZSkpIHJldHVybiBlO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHluKHQpIHtcbiAgICByZXR1cm4gXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi8gPT09IHQub3A7XG59XG5cbmZ1bmN0aW9uIHBuKHQpIHtcbiAgICByZXR1cm4gXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovID09PSB0Lm9wO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGZpbHRlciBpcyBhIGNvbmp1bmN0aW9uIG9mIGZpZWxkIGZpbHRlcnMgb25seS4gUmV0dXJucyBmYWxzZSBvdGhlcndpc2UuXG4gKi8gZnVuY3Rpb24gSW4odCkge1xuICAgIHJldHVybiBUbih0KSAmJiB5bih0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBmaWx0ZXIgZG9lcyBub3QgY29udGFpbiBhbnkgY29tcG9zaXRlIGZpbHRlcnMuIFJldHVybnMgZmFsc2Ugb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIFRuKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5maWx0ZXJzKSBpZiAoZSBpbnN0YW5jZW9mIGduKSByZXR1cm4gITE7XG4gICAgcmV0dXJuICEwO1xufVxuXG5mdW5jdGlvbiBFbih0KSB7XG4gICAgaWYgKHQgaW5zdGFuY2VvZiBtbikgXG4gICAgLy8gVE9ETyhiLzI5MTgzMTY1KTogVGVjaG5pY2FsbHksIHRoaXMgd29uJ3QgYmUgdW5pcXVlIGlmIHR3byB2YWx1ZXMgaGF2ZVxuICAgIC8vIHRoZSBzYW1lIGRlc2NyaXB0aW9uLCBzdWNoIGFzIHRoZSBpbnQgMyBhbmQgdGhlIHN0cmluZyBcIjNcIi4gU28gd2Ugc2hvdWxkXG4gICAgLy8gYWRkIHRoZSB0eXBlcyBpbiBoZXJlIHNvbWVob3csIHRvby5cbiAgICByZXR1cm4gdC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSArIHQub3AudG9TdHJpbmcoKSArIFFlKHQudmFsdWUpO1xuICAgIGlmIChJbih0KSkgXG4gICAgLy8gT2xkZXIgU0RLIHZlcnNpb25zIHVzZSBhbiBpbXBsaWNpdCBBTkQgb3BlcmF0aW9uIGJldHdlZW4gdGhlaXIgZmlsdGVycy5cbiAgICAvLyBJbiB0aGUgbmV3IFNESyB2ZXJzaW9ucywgdGhlIGRldmVsb3BlciBtYXkgdXNlIGFuIGV4cGxpY2l0IEFORCBmaWx0ZXIuXG4gICAgLy8gVG8gc3RheSBjb25zaXN0ZW50IHdpdGggdGhlIG9sZCB1c2FnZXMsIHdlIGFkZCBhIHNwZWNpYWwgY2FzZSB0byBlbnN1cmVcbiAgICAvLyB0aGUgY2Fub25pY2FsIElEIGZvciB0aGVzZSB0d28gYXJlIHRoZSBzYW1lLiBGb3IgZXhhbXBsZTpcbiAgICAvLyBgY29sLndoZXJlRXF1YWxzKFwiYVwiLCAxKS53aGVyZUVxdWFscyhcImJcIiwgMilgIHNob3VsZCBoYXZlIHRoZSBzYW1lXG4gICAgLy8gY2Fub25pY2FsIElEIGFzIGBjb2wud2hlcmUoYW5kKGVxdWFscyhcImFcIiwxKSwgZXF1YWxzKFwiYlwiLDIpKSlgLlxuICAgIHJldHVybiB0LmZpbHRlcnMubWFwKCh0ID0+IEVuKHQpKSkuam9pbihcIixcIik7XG4gICAge1xuICAgICAgICAvLyBmaWx0ZXIgaW5zdGFuY2VvZiBDb21wb3NpdGVGaWx0ZXJcbiAgICAgICAgY29uc3QgZSA9IHQuZmlsdGVycy5tYXAoKHQgPT4gRW4odCkpKS5qb2luKFwiLFwiKTtcbiAgICAgICAgcmV0dXJuIGAke3Qub3B9KCR7ZX0pYDtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEFuKHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIG1uID8gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gZSBpbnN0YW5jZW9mIG1uICYmIHQub3AgPT09IGUub3AgJiYgdC5maWVsZC5pc0VxdWFsKGUuZmllbGQpICYmIHFlKHQudmFsdWUsIGUudmFsdWUpO1xuICAgIH0odCwgZSkgOiB0IGluc3RhbmNlb2YgZ24gPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgZ24gJiYgdC5vcCA9PT0gZS5vcCAmJiB0LmZpbHRlcnMubGVuZ3RoID09PSBlLmZpbHRlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gdC5maWx0ZXJzLnJlZHVjZSgoKHQsIG4sIHMpID0+IHQgJiYgQW4obiwgZS5maWx0ZXJzW3NdKSksICEwKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyBhIG5ldyBjb21wb3NpdGUgZmlsdGVyIHRoYXQgY29udGFpbnMgYWxsIGZpbHRlciBmcm9tXG4gKiBgY29tcG9zaXRlRmlsdGVyYCBwbHVzIGFsbCB0aGUgZ2l2ZW4gZmlsdGVycyBpbiBgb3RoZXJGaWx0ZXJzYC5cbiAqLyAodCwgZSkgOiB2b2lkICQoKTtcbn1cblxuZnVuY3Rpb24gUm4odCwgZSkge1xuICAgIGNvbnN0IG4gPSB0LmZpbHRlcnMuY29uY2F0KGUpO1xuICAgIHJldHVybiBnbi5jcmVhdGUobiwgdC5vcCk7XG59XG5cbi8qKiBSZXR1cm5zIGEgZGVidWcgZGVzY3JpcHRpb24gZm9yIGBmaWx0ZXJgLiAqLyBmdW5jdGlvbiB2bih0KSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBtbiA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIGAke3QuZmllbGQuY2Fub25pY2FsU3RyaW5nKCl9ICR7dC5vcH0gJHtRZSh0LnZhbHVlKX1gO1xuICAgIH1cbiAgICAvKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIChpLmUuICdfX25hbWVfXycpLiAqLyAodCkgOiB0IGluc3RhbmNlb2YgZ24gPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiB0Lm9wLnRvU3RyaW5nKCkgKyBcIiB7XCIgKyB0LmdldEZpbHRlcnMoKS5tYXAodm4pLmpvaW4oXCIgLFwiKSArIFwifVwiO1xuICAgIH0odCkgOiBcIkZpbHRlclwiO1xufVxuXG5jbGFzcyBQbiBleHRlbmRzIG1uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIG4pLCB0aGlzLmtleSA9IGh0LmZyb21OYW1lKG4ucmVmZXJlbmNlVmFsdWUpO1xuICAgIH1cbiAgICBtYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGh0LmNvbXBhcmF0b3IodC5rZXksIHRoaXMua2V5KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubWF0Y2hlc0NvbXBhcmlzb24oZSk7XG4gICAgfVxufVxuXG4vKiogRmlsdGVyIHRoYXQgbWF0Y2hlcyBvbiBrZXkgZmllbGRzIHdpdGhpbiBhbiBhcnJheS4gKi8gY2xhc3MgYm4gZXh0ZW5kcyBtbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gLCBlKSwgdGhpcy5rZXlzID0gU24oXCJpblwiIC8qIE9wZXJhdG9yLklOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICByZXR1cm4gdGhpcy5rZXlzLnNvbWUoKGUgPT4gZS5pc0VxdWFsKHQua2V5KSkpO1xuICAgIH1cbn1cblxuLyoqIEZpbHRlciB0aGF0IG1hdGNoZXMgb24ga2V5IGZpZWxkcyBub3QgcHJlc2VudCB3aXRoaW4gYW4gYXJyYXkuICovIGNsYXNzIFZuIGV4dGVuZHMgbW4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gLCBlKSwgdGhpcy5rZXlzID0gU24oXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5rZXlzLnNvbWUoKGUgPT4gZS5pc0VxdWFsKHQua2V5KSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gU24odCwgZSkge1xuICAgIHZhciBuO1xuICAgIHJldHVybiAoKG51bGwgPT09IChuID0gZS5hcnJheVZhbHVlKSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLnZhbHVlcykgfHwgW10pLm1hcCgodCA9PiBodC5mcm9tTmFtZSh0LnJlZmVyZW5jZVZhbHVlKSkpO1xufVxuXG4vKiogQSBGaWx0ZXIgdGhhdCBpbXBsZW1lbnRzIHRoZSBhcnJheS1jb250YWlucyBvcGVyYXRvci4gKi8gY2xhc3MgRG4gZXh0ZW5kcyBtbiB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0LCBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi8gLCBlKTtcbiAgICB9XG4gICAgbWF0Y2hlcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBKZShlKSAmJiBVZShlLmFycmF5VmFsdWUsIHRoaXMudmFsdWUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgSU4gb3BlcmF0b3IuICovIGNsYXNzIENuIGV4dGVuZHMgbW4ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgXCJpblwiIC8qIE9wZXJhdG9yLklOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gZSAmJiBVZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIGUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgbm90LWluIG9wZXJhdG9yLiAqLyBjbGFzcyB4biBleHRlbmRzIG1uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBpZiAoVWUodGhpcy52YWx1ZS5hcnJheVZhbHVlLCB7XG4gICAgICAgICAgICBudWxsVmFsdWU6IFwiTlVMTF9WQUxVRVwiXG4gICAgICAgIH0pKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0LmRhdGEuZmllbGQodGhpcy5maWVsZCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBlICYmICFVZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIGUpO1xuICAgIH1cbn1cblxuLyoqIEEgRmlsdGVyIHRoYXQgaW1wbGVtZW50cyB0aGUgYXJyYXktY29udGFpbnMtYW55IG9wZXJhdG9yLiAqLyBjbGFzcyBObiBleHRlbmRzIG1uIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgZSk7XG4gICAgfVxuICAgIG1hdGNoZXModCkge1xuICAgICAgICBjb25zdCBlID0gdC5kYXRhLmZpZWxkKHRoaXMuZmllbGQpO1xuICAgICAgICByZXR1cm4gISghSmUoZSkgfHwgIWUuYXJyYXlWYWx1ZS52YWx1ZXMpICYmIGUuYXJyYXlWYWx1ZS52YWx1ZXMuc29tZSgodCA9PiBVZSh0aGlzLnZhbHVlLmFycmF5VmFsdWUsIHQpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLy8gVmlzaWJsZSBmb3IgdGVzdGluZ1xuY2xhc3Mga24ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUgPSBudWxsLCBuID0gW10sIHMgPSBbXSwgaSA9IG51bGwsIHIgPSBudWxsLCBvID0gbnVsbCkge1xuICAgICAgICB0aGlzLnBhdGggPSB0LCB0aGlzLmNvbGxlY3Rpb25Hcm91cCA9IGUsIHRoaXMub3JkZXJCeSA9IG4sIHRoaXMuZmlsdGVycyA9IHMsIHRoaXMubGltaXQgPSBpLCBcbiAgICAgICAgdGhpcy5zdGFydEF0ID0gciwgdGhpcy5lbmRBdCA9IG8sIHRoaXMuZnQgPSBudWxsO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhIFRhcmdldCB3aXRoIGEgcGF0aCBhbmQgb3B0aW9uYWwgYWRkaXRpb25hbCBxdWVyeSBjb25zdHJhaW50cy5cbiAqIFBhdGggbXVzdCBjdXJyZW50bHkgYmUgZW1wdHkgaWYgdGhpcyBpcyBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkuXG4gKlxuICogTk9URTogeW91IHNob3VsZCBhbHdheXMgY29uc3RydWN0IGBUYXJnZXRgIGZyb20gYFF1ZXJ5LnRvVGFyZ2V0YCBpbnN0ZWFkIG9mXG4gKiB1c2luZyB0aGlzIGZhY3RvcnkgbWV0aG9kLCBiZWNhdXNlIGBRdWVyeWAgcHJvdmlkZXMgYW4gaW1wbGljaXQgYG9yZGVyQnlgXG4gKiBwcm9wZXJ0eS5cbiAqLyBmdW5jdGlvbiBNbih0LCBlID0gbnVsbCwgbiA9IFtdLCBzID0gW10sIGkgPSBudWxsLCByID0gbnVsbCwgbyA9IG51bGwpIHtcbiAgICByZXR1cm4gbmV3IGtuKHQsIGUsIG4sIHMsIGksIHIsIG8pO1xufVxuXG5mdW5jdGlvbiBPbih0KSB7XG4gICAgY29uc3QgZSA9IEwodCk7XG4gICAgaWYgKG51bGwgPT09IGUuZnQpIHtcbiAgICAgICAgbGV0IHQgPSBlLnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIG51bGwgIT09IGUuY29sbGVjdGlvbkdyb3VwICYmICh0ICs9IFwifGNnOlwiICsgZS5jb2xsZWN0aW9uR3JvdXApLCB0ICs9IFwifGY6XCIsIHQgKz0gZS5maWx0ZXJzLm1hcCgodCA9PiBFbih0KSkpLmpvaW4oXCIsXCIpLCBcbiAgICAgICAgdCArPSBcInxvYjpcIiwgdCArPSBlLm9yZGVyQnkubWFwKCh0ID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIC8vIFRPRE8oYi8yOTE4MzE2NSk6IE1ha2UgdGhpcyBjb2xsaXNpb24gcm9idXN0LlxuICAgICAgICAgICAgcmV0dXJuIHQuZmllbGQuY2Fub25pY2FsU3RyaW5nKCkgKyB0LmRpcjtcbiAgICAgICAgfSh0KSkpLmpvaW4oXCIsXCIpLCBGdChlLmxpbWl0KSB8fCAodCArPSBcInxsOlwiLCB0ICs9IGUubGltaXQpLCBlLnN0YXJ0QXQgJiYgKHQgKz0gXCJ8bGI6XCIsIFxuICAgICAgICB0ICs9IGUuc3RhcnRBdC5pbmNsdXNpdmUgPyBcImI6XCIgOiBcImE6XCIsIHQgKz0gZS5zdGFydEF0LnBvc2l0aW9uLm1hcCgodCA9PiBRZSh0KSkpLmpvaW4oXCIsXCIpKSwgXG4gICAgICAgIGUuZW5kQXQgJiYgKHQgKz0gXCJ8dWI6XCIsIHQgKz0gZS5lbmRBdC5pbmNsdXNpdmUgPyBcImE6XCIgOiBcImI6XCIsIHQgKz0gZS5lbmRBdC5wb3NpdGlvbi5tYXAoKHQgPT4gUWUodCkpKS5qb2luKFwiLFwiKSksIFxuICAgICAgICBlLmZ0ID0gdDtcbiAgICB9XG4gICAgcmV0dXJuIGUuZnQ7XG59XG5cbmZ1bmN0aW9uICRuKHQsIGUpIHtcbiAgICBpZiAodC5saW1pdCAhPT0gZS5saW1pdCkgcmV0dXJuICExO1xuICAgIGlmICh0Lm9yZGVyQnkubGVuZ3RoICE9PSBlLm9yZGVyQnkubGVuZ3RoKSByZXR1cm4gITE7XG4gICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lm9yZGVyQnkubGVuZ3RoOyBuKyspIGlmICghX24odC5vcmRlckJ5W25dLCBlLm9yZGVyQnlbbl0pKSByZXR1cm4gITE7XG4gICAgaWYgKHQuZmlsdGVycy5sZW5ndGggIT09IGUuZmlsdGVycy5sZW5ndGgpIHJldHVybiAhMTtcbiAgICBmb3IgKGxldCBuID0gMDsgbiA8IHQuZmlsdGVycy5sZW5ndGg7IG4rKykgaWYgKCFBbih0LmZpbHRlcnNbbl0sIGUuZmlsdGVyc1tuXSkpIHJldHVybiAhMTtcbiAgICByZXR1cm4gdC5jb2xsZWN0aW9uR3JvdXAgPT09IGUuY29sbGVjdGlvbkdyb3VwICYmICghIXQucGF0aC5pc0VxdWFsKGUucGF0aCkgJiYgKCEhZm4odC5zdGFydEF0LCBlLnN0YXJ0QXQpICYmIGZuKHQuZW5kQXQsIGUuZW5kQXQpKSk7XG59XG5cbmZ1bmN0aW9uIEZuKHQpIHtcbiAgICByZXR1cm4gaHQuaXNEb2N1bWVudEtleSh0LnBhdGgpICYmIG51bGwgPT09IHQuY29sbGVjdGlvbkdyb3VwICYmIDAgPT09IHQuZmlsdGVycy5sZW5ndGg7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBmaWVsZCBmaWx0ZXJzIHRoYXQgdGFyZ2V0IHRoZSBnaXZlbiBmaWVsZCBwYXRoLiAqLyBmdW5jdGlvbiBCbih0LCBlKSB7XG4gICAgcmV0dXJuIHQuZmlsdGVycy5maWx0ZXIoKHQgPT4gdCBpbnN0YW5jZW9mIG1uICYmIHQuZmllbGQuaXNFcXVhbChlKSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIHZhbHVlcyB0aGF0IGFyZSB1c2VkIGluIEFSUkFZX0NPTlRBSU5TIG9yIEFSUkFZX0NPTlRBSU5TX0FOWVxuICogZmlsdGVycy4gUmV0dXJucyBgbnVsbGAgaWYgdGhlcmUgYXJlIG5vIHN1Y2ggZmlsdGVycy5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSB0byB1c2UgYXMgdGhlIGxvd2VyIGJvdW5kIGZvciBhc2NlbmRpbmcgaW5kZXggc2VnbWVudCBhdFxuICogdGhlIHByb3ZpZGVkIGBmaWVsZFBhdGhgIChvciB0aGUgdXBwZXIgYm91bmQgZm9yIGFuIGRlc2NlbmRpbmcgc2VnbWVudCkuXG4gKi9cbmZ1bmN0aW9uIExuKHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IEJlLCBpID0gITA7XG4gICAgLy8gUHJvY2VzcyBhbGwgZmlsdGVycyB0byBmaW5kIGEgdmFsdWUgZm9yIHRoZSBjdXJyZW50IGZpZWxkIHNlZ21lbnRcbiAgICBmb3IgKGNvbnN0IG4gb2YgQm4odCwgZSkpIHtcbiAgICAgICAgbGV0IHQgPSBCZSwgZSA9ICEwO1xuICAgICAgICBzd2l0Y2ggKG4ub3ApIHtcbiAgICAgICAgICBjYXNlIFwiPFwiIC8qIE9wZXJhdG9yLkxFU1NfVEhBTiAqLyA6XG4gICAgICAgICAgY2FzZSBcIjw9XCIgLyogT3BlcmF0b3IuTEVTU19USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICAgIHQgPSBubihuLnZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovIDpcbiAgICAgICAgICBjYXNlIFwiPj1cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCI+XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOICovIDpcbiAgICAgICAgICAgIHQgPSBuLnZhbHVlLCBlID0gITE7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA6XG4gICAgICAgICAgICB0ID0gQmU7XG4gLy8gUmVtYWluaW5nIGZpbHRlcnMgY2Fubm90IGJlIHVzZWQgYXMgbG93ZXIgYm91bmRzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgcm4oe1xuICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGVcbiAgICAgICAgfSkgPCAwICYmIChzID0gdCwgaSA9IGUpO1xuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBhZGRpdGlvbmFsIGJvdW5kLCBjb21wYXJlIHRoZSB2YWx1ZXMgYWdhaW5zdCB0aGUgZXhpc3RpbmdcbiAgICAvLyByYW5nZSB0byBzZWUgaWYgd2UgY2FuIG5hcnJvdyB0aGUgc2NvcGUuXG4gICAgICAgIGlmIChudWxsICE9PSBuKSBmb3IgKGxldCByID0gMDsgciA8IHQub3JkZXJCeS5sZW5ndGg7ICsrcikge1xuICAgICAgICBpZiAodC5vcmRlckJ5W3JdLmZpZWxkLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnBvc2l0aW9uW3JdO1xuICAgICAgICAgICAgcm4oe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBzLFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0LFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogbi5pbmNsdXNpdmVcbiAgICAgICAgICAgIH0pIDwgMCAmJiAocyA9IHQsIGkgPSBuLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSB2YWx1ZSB0byB1c2UgYXMgdGhlIHVwcGVyIGJvdW5kIGZvciBhc2NlbmRpbmcgaW5kZXggc2VnbWVudCBhdFxuICogdGhlIHByb3ZpZGVkIGBmaWVsZFBhdGhgIChvciB0aGUgbG93ZXIgYm91bmQgZm9yIGEgZGVzY2VuZGluZyBzZWdtZW50KS5cbiAqLyBmdW5jdGlvbiBxbih0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSBGZSwgaSA9ICEwO1xuICAgIC8vIFByb2Nlc3MgYWxsIGZpbHRlcnMgdG8gZmluZCBhIHZhbHVlIGZvciB0aGUgY3VycmVudCBmaWVsZCBzZWdtZW50XG4gICAgZm9yIChjb25zdCBuIG9mIEJuKHQsIGUpKSB7XG4gICAgICAgIGxldCB0ID0gRmUsIGUgPSAhMDtcbiAgICAgICAgc3dpdGNoIChuLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIj49XCIgLyogT3BlcmF0b3IuR1JFQVRFUl9USEFOX09SX0VRVUFMICovIDpcbiAgICAgICAgICBjYXNlIFwiPlwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTiAqLyA6XG4gICAgICAgICAgICB0ID0gc24obi52YWx1ZSksIGUgPSAhMTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovIDpcbiAgICAgICAgICBjYXNlIFwiPD1cIiAvKiBPcGVyYXRvci5MRVNTX1RIQU5fT1JfRVFVQUwgKi8gOlxuICAgICAgICAgICAgdCA9IG4udmFsdWU7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCI8XCIgLyogT3BlcmF0b3IuTEVTU19USEFOICovIDpcbiAgICAgICAgICAgIHQgPSBuLnZhbHVlLCBlID0gITE7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA6XG4gICAgICAgICAgICB0ID0gRmU7XG4gLy8gUmVtYWluaW5nIGZpbHRlcnMgY2Fubm90IGJlIHVzZWQgYXMgdXBwZXIgYm91bmRzLlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgb24oe1xuICAgICAgICAgICAgdmFsdWU6IHMsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGlcbiAgICAgICAgfSwge1xuICAgICAgICAgICAgdmFsdWU6IHQsXG4gICAgICAgICAgICBpbmNsdXNpdmU6IGVcbiAgICAgICAgfSkgPiAwICYmIChzID0gdCwgaSA9IGUpO1xuICAgIH1cbiAgICAvLyBJZiB0aGVyZSBpcyBhbiBhZGRpdGlvbmFsIGJvdW5kLCBjb21wYXJlIHRoZSB2YWx1ZXMgYWdhaW5zdCB0aGUgZXhpc3RpbmdcbiAgICAvLyByYW5nZSB0byBzZWUgaWYgd2UgY2FuIG5hcnJvdyB0aGUgc2NvcGUuXG4gICAgICAgIGlmIChudWxsICE9PSBuKSBmb3IgKGxldCByID0gMDsgciA8IHQub3JkZXJCeS5sZW5ndGg7ICsrcikge1xuICAgICAgICBpZiAodC5vcmRlckJ5W3JdLmZpZWxkLmlzRXF1YWwoZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuLnBvc2l0aW9uW3JdO1xuICAgICAgICAgICAgb24oe1xuICAgICAgICAgICAgICAgIHZhbHVlOiBzLFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogaVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHZhbHVlOiB0LFxuICAgICAgICAgICAgICAgIGluY2x1c2l2ZTogbi5pbmNsdXNpdmVcbiAgICAgICAgICAgIH0pID4gMCAmJiAocyA9IHQsIGkgPSBuLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB2YWx1ZTogcyxcbiAgICAgICAgaW5jbHVzaXZlOiBpXG4gICAgfTtcbn1cblxuLyoqIFJldHVybnMgdGhlIG51bWJlciBvZiBzZWdtZW50cyBvZiBhIHBlcmZlY3QgaW5kZXggZm9yIHRoaXMgdGFyZ2V0LiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUXVlcnkgZW5jYXBzdWxhdGVzIGFsbCB0aGUgcXVlcnkgYXR0cmlidXRlcyB3ZSBzdXBwb3J0IGluIHRoZSBTREsuIEl0IGNhblxuICogYmUgcnVuIGFnYWluc3QgdGhlIExvY2FsU3RvcmUsIGFzIHdlbGwgYXMgYmUgY29udmVydGVkIHRvIGEgYFRhcmdldGAgdG9cbiAqIHF1ZXJ5IHRoZSBSZW1vdGVTdG9yZSByZXN1bHRzLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmNsYXNzIFVuIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIFF1ZXJ5IHdpdGggYSBwYXRoIGFuZCBvcHRpb25hbCBhZGRpdGlvbmFsIHF1ZXJ5IGNvbnN0cmFpbnRzLlxuICAgICAqIFBhdGggbXVzdCBjdXJyZW50bHkgYmUgZW1wdHkgaWYgdGhpcyBpcyBhIGNvbGxlY3Rpb24gZ3JvdXAgcXVlcnkuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSA9IG51bGwsIG4gPSBbXSwgcyA9IFtdLCBpID0gbnVsbCwgciA9IFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyAsIG8gPSBudWxsLCB1ID0gbnVsbCkge1xuICAgICAgICB0aGlzLnBhdGggPSB0LCB0aGlzLmNvbGxlY3Rpb25Hcm91cCA9IGUsIHRoaXMuZXhwbGljaXRPcmRlckJ5ID0gbiwgdGhpcy5maWx0ZXJzID0gcywgXG4gICAgICAgIHRoaXMubGltaXQgPSBpLCB0aGlzLmxpbWl0VHlwZSA9IHIsIHRoaXMuc3RhcnRBdCA9IG8sIHRoaXMuZW5kQXQgPSB1LCB0aGlzLmR0ID0gbnVsbCwgXG4gICAgICAgIC8vIFRoZSBjb3JyZXNwb25kaW5nIGBUYXJnZXRgIG9mIHRoaXMgYFF1ZXJ5YCBpbnN0YW5jZS5cbiAgICAgICAgdGhpcy5fdCA9IG51bGwsIHRoaXMuc3RhcnRBdCwgdGhpcy5lbmRBdDtcbiAgICB9XG59XG5cbi8qKiBDcmVhdGVzIGEgbmV3IFF1ZXJ5IGluc3RhbmNlIHdpdGggdGhlIG9wdGlvbnMgcHJvdmlkZWQuICovIGZ1bmN0aW9uIEtuKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpIHtcbiAgICByZXR1cm4gbmV3IFVuKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpO1xufVxuXG4vKiogQ3JlYXRlcyBhIG5ldyBRdWVyeSBmb3IgYSBxdWVyeSB0aGF0IG1hdGNoZXMgYWxsIGRvY3VtZW50cyBhdCBgcGF0aGAgKi8gZnVuY3Rpb24gR24odCkge1xuICAgIHJldHVybiBuZXcgVW4odCk7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGNvbnZlcnQgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5IGludG8gYSBjb2xsZWN0aW9uIHF1ZXJ5IGF0IGFcbiAqIHNwZWNpZmljIHBhdGguIFRoaXMgaXMgdXNlZCB3aGVuIGV4ZWN1dGluZyBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJpZXMsIHNpbmNlXG4gKiB3ZSBoYXZlIHRvIHNwbGl0IHRoZSBxdWVyeSBpbnRvIGEgc2V0IG9mIGNvbGxlY3Rpb24gcXVlcmllcyBhdCBtdWx0aXBsZVxuICogcGF0aHMuXG4gKi9cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoaXMgcXVlcnkgZG9lcyBub3Qgc3BlY2lmeSBhbnkgcXVlcnkgY29uc3RyYWludHMgdGhhdFxuICogY291bGQgcmVtb3ZlIHJlc3VsdHMuXG4gKi9cbmZ1bmN0aW9uIFFuKHQpIHtcbiAgICByZXR1cm4gMCA9PT0gdC5maWx0ZXJzLmxlbmd0aCAmJiBudWxsID09PSB0LmxpbWl0ICYmIG51bGwgPT0gdC5zdGFydEF0ICYmIG51bGwgPT0gdC5lbmRBdCAmJiAoMCA9PT0gdC5leHBsaWNpdE9yZGVyQnkubGVuZ3RoIHx8IDEgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCAmJiB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZC5pc0tleUZpZWxkKCkpO1xufVxuXG5mdW5jdGlvbiBqbih0KSB7XG4gICAgcmV0dXJuIHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyB0LmV4cGxpY2l0T3JkZXJCeVswXS5maWVsZCA6IG51bGw7XG59XG5cbmZ1bmN0aW9uIHpuKHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5maWx0ZXJzKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlLmdldEZpcnN0SW5lcXVhbGl0eUZpZWxkKCk7XG4gICAgICAgIGlmIChudWxsICE9PSB0KSByZXR1cm4gdDtcbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBRdWVyeSBmb3IgYSBjb2xsZWN0aW9uIGdyb3VwIHF1ZXJ5IHRoYXQgbWF0Y2hlcyBhbGwgZG9jdW1lbnRzXG4gKiB3aXRoaW4gdGhlIHByb3ZpZGVkIGNvbGxlY3Rpb24gZ3JvdXAuXG4gKi9cbi8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgY29sbGVjdGlvbiBncm91cCByYXRoZXIgdGhhbiBhIHNwZWNpZmljXG4gKiBjb2xsZWN0aW9uLlxuICovXG5mdW5jdGlvbiBXbih0KSB7XG4gICAgcmV0dXJuIG51bGwgIT09IHQuY29sbGVjdGlvbkdyb3VwO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGltcGxpY2l0IG9yZGVyIGJ5IGNvbnN0cmFpbnQgdGhhdCBpcyB1c2VkIHRvIGV4ZWN1dGUgdGhlIFF1ZXJ5LFxuICogd2hpY2ggY2FuIGJlIGRpZmZlcmVudCBmcm9tIHRoZSBvcmRlciBieSBjb25zdHJhaW50cyB0aGUgdXNlciBwcm92aWRlZCAoZS5nLlxuICogdGhlIFNESyBhbmQgYmFja2VuZCBhbHdheXMgb3JkZXJzIGJ5IGBfX25hbWVfX2ApLlxuICovIGZ1bmN0aW9uIEhuKHQpIHtcbiAgICBjb25zdCBlID0gTCh0KTtcbiAgICBpZiAobnVsbCA9PT0gZS5kdCkge1xuICAgICAgICBlLmR0ID0gW107XG4gICAgICAgIGNvbnN0IHQgPSB6bihlKSwgbiA9IGpuKGUpO1xuICAgICAgICBpZiAobnVsbCAhPT0gdCAmJiBudWxsID09PSBuKSBcbiAgICAgICAgLy8gSW4gb3JkZXIgdG8gaW1wbGljaXRseSBhZGQga2V5IG9yZGVyaW5nLCB3ZSBtdXN0IGFsc28gYWRkIHRoZVxuICAgICAgICAvLyBpbmVxdWFsaXR5IGZpbHRlciBmaWVsZCBmb3IgaXQgdG8gYmUgYSB2YWxpZCBxdWVyeS5cbiAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IGluZXF1YWxpdHkgZmllbGQgYW5kIGtleSBvcmRlcmluZyBpcyBhc2NlbmRpbmcuXG4gICAgICAgIHQuaXNLZXlGaWVsZCgpIHx8IGUuZHQucHVzaChuZXcgZG4odCkpLCBlLmR0LnB1c2gobmV3IGRuKGF0LmtleUZpZWxkKCksIFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLykpOyBlbHNlIHtcbiAgICAgICAgICAgIGxldCB0ID0gITE7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgZS5leHBsaWNpdE9yZGVyQnkpIGUuZHQucHVzaChuKSwgbi5maWVsZC5pc0tleUZpZWxkKCkgJiYgKHQgPSAhMCk7XG4gICAgICAgICAgICBpZiAoIXQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgb3JkZXIgb2YgdGhlIGltcGxpY2l0IGtleSBvcmRlcmluZyBhbHdheXMgbWF0Y2hlcyB0aGUgbGFzdFxuICAgICAgICAgICAgICAgIC8vIGV4cGxpY2l0IG9yZGVyIGJ5XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCA+IDAgPyBlLmV4cGxpY2l0T3JkZXJCeVtlLmV4cGxpY2l0T3JkZXJCeS5sZW5ndGggLSAxXS5kaXIgOiBcImFzY1wiIC8qIERpcmVjdGlvbi5BU0NFTkRJTkcgKi87XG4gICAgICAgICAgICAgICAgZS5kdC5wdXNoKG5ldyBkbihhdC5rZXlGaWVsZCgpLCB0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGUuZHQ7XG59XG5cbi8qKlxuICogQ29udmVydHMgdGhpcyBgUXVlcnlgIGluc3RhbmNlIHRvIGl0J3MgY29ycmVzcG9uZGluZyBgVGFyZ2V0YCByZXByZXNlbnRhdGlvbi5cbiAqLyBmdW5jdGlvbiBKbih0KSB7XG4gICAgY29uc3QgZSA9IEwodCk7XG4gICAgaWYgKCFlLl90KSBpZiAoXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovID09PSBlLmxpbWl0VHlwZSkgZS5fdCA9IE1uKGUucGF0aCwgZS5jb2xsZWN0aW9uR3JvdXAsIEhuKGUpLCBlLmZpbHRlcnMsIGUubGltaXQsIGUuc3RhcnRBdCwgZS5lbmRBdCk7IGVsc2Uge1xuICAgICAgICAvLyBGbGlwIHRoZSBvcmRlckJ5IGRpcmVjdGlvbnMgc2luY2Ugd2Ugd2FudCB0aGUgbGFzdCByZXN1bHRzXG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBuIG9mIEhuKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi8gPT09IG4uZGlyID8gXCJhc2NcIiAvKiBEaXJlY3Rpb24uQVNDRU5ESU5HICovIDogXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi87XG4gICAgICAgICAgICB0LnB1c2gobmV3IGRuKG4uZmllbGQsIGUpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBuZWVkIHRvIHN3YXAgdGhlIGN1cnNvcnMgdG8gbWF0Y2ggdGhlIG5vdy1mbGlwcGVkIHF1ZXJ5IG9yZGVyaW5nLlxuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBlLmVuZEF0ID8gbmV3IGhuKGUuZW5kQXQucG9zaXRpb24sIGUuZW5kQXQuaW5jbHVzaXZlKSA6IG51bGwsIHMgPSBlLnN0YXJ0QXQgPyBuZXcgaG4oZS5zdGFydEF0LnBvc2l0aW9uLCBlLnN0YXJ0QXQuaW5jbHVzaXZlKSA6IG51bGw7XG4gICAgICAgIC8vIE5vdyByZXR1cm4gYXMgYSBMaW1pdFR5cGUuRmlyc3QgcXVlcnkuXG4gICAgICAgIGUuX3QgPSBNbihlLnBhdGgsIGUuY29sbGVjdGlvbkdyb3VwLCB0LCBlLmZpbHRlcnMsIGUubGltaXQsIG4sIHMpO1xuICAgIH1cbiAgICByZXR1cm4gZS5fdDtcbn1cblxuZnVuY3Rpb24gWW4odCwgZSkge1xuICAgIGUuZ2V0Rmlyc3RJbmVxdWFsaXR5RmllbGQoKSwgem4odCk7XG4gICAgY29uc3QgbiA9IHQuZmlsdGVycy5jb25jYXQoWyBlIF0pO1xuICAgIHJldHVybiBuZXcgVW4odC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgbiwgdC5saW1pdCwgdC5saW1pdFR5cGUsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG59XG5cbmZ1bmN0aW9uIFhuKHQsIGUsIG4pIHtcbiAgICByZXR1cm4gbmV3IFVuKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHQuZmlsdGVycy5zbGljZSgpLCBlLCBuLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xufVxuXG5mdW5jdGlvbiBabih0LCBlKSB7XG4gICAgcmV0dXJuICRuKEpuKHQpLCBKbihlKSkgJiYgdC5saW1pdFR5cGUgPT09IGUubGltaXRUeXBlO1xufVxuXG4vLyBUT0RPKGIvMjkxODMxNjUpOiBUaGlzIGlzIHVzZWQgdG8gZ2V0IGEgdW5pcXVlIHN0cmluZyBmcm9tIGEgcXVlcnkgdG8sIGZvclxuLy8gZXhhbXBsZSwgdXNlIGFzIGEgZGljdGlvbmFyeSBrZXksIGJ1dCB0aGUgaW1wbGVtZW50YXRpb24gaXMgc3ViamVjdCB0b1xuLy8gY29sbGlzaW9ucy4gTWFrZSBpdCBjb2xsaXNpb24tZnJlZS5cbmZ1bmN0aW9uIHRzKHQpIHtcbiAgICByZXR1cm4gYCR7T24oSm4odCkpfXxsdDoke3QubGltaXRUeXBlfWA7XG59XG5cbmZ1bmN0aW9uIGVzKHQpIHtcbiAgICByZXR1cm4gYFF1ZXJ5KHRhcmdldD0ke2Z1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGUgPSB0LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSB0LmNvbGxlY3Rpb25Hcm91cCAmJiAoZSArPSBcIiBjb2xsZWN0aW9uR3JvdXA9XCIgKyB0LmNvbGxlY3Rpb25Hcm91cCksIFxuICAgICAgICB0LmZpbHRlcnMubGVuZ3RoID4gMCAmJiAoZSArPSBgLCBmaWx0ZXJzOiBbJHt0LmZpbHRlcnMubWFwKCh0ID0+IHZuKHQpKSkuam9pbihcIiwgXCIpfV1gKSwgXG4gICAgICAgIEZ0KHQubGltaXQpIHx8IChlICs9IFwiLCBsaW1pdDogXCIgKyB0LmxpbWl0KSwgdC5vcmRlckJ5Lmxlbmd0aCA+IDAgJiYgKGUgKz0gYCwgb3JkZXJCeTogWyR7dC5vcmRlckJ5Lm1hcCgodCA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYCR7dC5maWVsZC5jYW5vbmljYWxTdHJpbmcoKX0gKCR7dC5kaXJ9KWA7XG4gICAgICAgIH0odCkpKS5qb2luKFwiLCBcIil9XWApLCB0LnN0YXJ0QXQgJiYgKGUgKz0gXCIsIHN0YXJ0QXQ6IFwiLCBlICs9IHQuc3RhcnRBdC5pbmNsdXNpdmUgPyBcImI6XCIgOiBcImE6XCIsIFxuICAgICAgICBlICs9IHQuc3RhcnRBdC5wb3NpdGlvbi5tYXAoKHQgPT4gUWUodCkpKS5qb2luKFwiLFwiKSksIHQuZW5kQXQgJiYgKGUgKz0gXCIsIGVuZEF0OiBcIiwgXG4gICAgICAgIGUgKz0gdC5lbmRBdC5pbmNsdXNpdmUgPyBcImE6XCIgOiBcImI6XCIsIGUgKz0gdC5lbmRBdC5wb3NpdGlvbi5tYXAoKHQgPT4gUWUodCkpKS5qb2luKFwiLFwiKSksIFxuICAgICAgICBgVGFyZ2V0KCR7ZX0pYDtcbiAgICB9KEpuKHQpKX07IGxpbWl0VHlwZT0ke3QubGltaXRUeXBlfSlgO1xufVxuXG4vKiogUmV0dXJucyB3aGV0aGVyIGBkb2NgIG1hdGNoZXMgdGhlIGNvbnN0cmFpbnRzIG9mIGBxdWVyeWAuICovIGZ1bmN0aW9uIG5zKHQsIGUpIHtcbiAgICByZXR1cm4gZS5pc0ZvdW5kRG9jdW1lbnQoKSAmJiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLmtleS5wYXRoO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdC5jb2xsZWN0aW9uR3JvdXAgPyBlLmtleS5oYXNDb2xsZWN0aW9uSWQodC5jb2xsZWN0aW9uR3JvdXApICYmIHQucGF0aC5pc1ByZWZpeE9mKG4pIDogaHQuaXNEb2N1bWVudEtleSh0LnBhdGgpID8gdC5wYXRoLmlzRXF1YWwobikgOiB0LnBhdGguaXNJbW1lZGlhdGVQYXJlbnRPZihuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBBIGRvY3VtZW50IG11c3QgaGF2ZSBhIHZhbHVlIGZvciBldmVyeSBvcmRlcmluZyBjbGF1c2UgaW4gb3JkZXIgdG8gc2hvdyB1cFxuICogaW4gdGhlIHJlc3VsdHMuXG4gKi8gKHQsIGUpICYmIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gV2UgbXVzdCB1c2UgYHF1ZXJ5T3JkZXJCeSgpYCB0byBnZXQgdGhlIGxpc3Qgb2YgYWxsIG9yZGVyQnlzIChib3RoIGltcGxpY2l0IGFuZCBleHBsaWNpdCkuXG4gICAgICAgIC8vIE5vdGUgdGhhdCBmb3IgT1IgcXVlcmllcywgb3JkZXJCeSBhcHBsaWVzIHRvIGFsbCBkaXNqdW5jdGlvbiB0ZXJtcyBhbmQgaW1wbGljaXQgb3JkZXJCeXMgbXVzdFxuICAgICAgICAvLyBiZSB0YWtlbiBpbnRvIGFjY291bnQuIEZvciBleGFtcGxlLCB0aGUgcXVlcnkgXCJhID4gMSB8fCBiPT0xXCIgaGFzIGFuIGltcGxpY2l0IFwib3JkZXJCeSBhXCIgZHVlXG4gICAgICAgIC8vIHRvIHRoZSBpbmVxdWFsaXR5LCBhbmQgaXMgZXZhbHVhdGVkIGFzIFwiYSA+IDEgb3JkZXJCeSBhIHx8IGI9PTEgb3JkZXJCeSBhXCIuXG4gICAgICAgIC8vIEEgZG9jdW1lbnQgd2l0aCBjb250ZW50IG9mIHtiOjF9IG1hdGNoZXMgdGhlIGZpbHRlcnMsIGJ1dCBkb2VzIG5vdCBtYXRjaCB0aGUgb3JkZXJCeSBiZWNhdXNlXG4gICAgICAgIC8vIGl0J3MgbWlzc2luZyB0aGUgZmllbGQgJ2EnLlxuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgSG4odCkpIFxuICAgICAgICAvLyBvcmRlciBieSBrZXkgYWx3YXlzIG1hdGNoZXNcbiAgICAgICAgaWYgKCFuLmZpZWxkLmlzS2V5RmllbGQoKSAmJiBudWxsID09PSBlLmRhdGEuZmllbGQobi5maWVsZCkpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH0odCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5maWx0ZXJzKSBpZiAoIW4ubWF0Y2hlcyhlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBzdXJlIGEgZG9jdW1lbnQgaXMgd2l0aGluIHRoZSBib3VuZHMsIGlmIHByb3ZpZGVkLiAqLyAodCwgZSkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBpZiAodC5zdGFydEF0ICYmICFcbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgYSBkb2N1bWVudCBzb3J0cyBiZWZvcmUgYSBib3VuZCB1c2luZyB0aGUgcHJvdmlkZWQgc29ydFxuICogb3JkZXIuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgY29uc3QgcyA9IGxuKHQsIGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIHQuaW5jbHVzaXZlID8gcyA8PSAwIDogcyA8IDA7XG4gICAgICAgIH0odC5zdGFydEF0LCBIbih0KSwgZSkpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHQuZW5kQXQgJiYgIWZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBsbih0LCBlLCBuKTtcbiAgICAgICAgICAgIHJldHVybiB0LmluY2x1c2l2ZSA/IHMgPj0gMCA6IHMgPiAwO1xuICAgICAgICB9KHQuZW5kQXQsIEhuKHQpLCBlKSkgcmV0dXJuICExO1xuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxuICAgIC8qKlxuICogUmV0dXJucyB0aGUgY29sbGVjdGlvbiBncm91cCB0aGF0IHRoaXMgcXVlcnkgdGFyZ2V0cy5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFRoaXMgaXMgb25seSB1c2VkIGluIHRoZSBXZWIgU0RLIHRvIGZhY2lsaXRhdGUgbXVsdGktdGFiXG4gKiBzeW5jaHJvbml6YXRpb24gZm9yIHF1ZXJ5IHJlc3VsdHMuXG4gKi8gKHQsIGUpO1xufVxuXG5mdW5jdGlvbiBzcyh0KSB7XG4gICAgcmV0dXJuIHQuY29sbGVjdGlvbkdyb3VwIHx8ICh0LnBhdGgubGVuZ3RoICUgMiA9PSAxID8gdC5wYXRoLmxhc3RTZWdtZW50KCkgOiB0LnBhdGguZ2V0KHQucGF0aC5sZW5ndGggLSAyKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIG5ldyBjb21wYXJhdG9yIGZ1bmN0aW9uIHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcGFyZSB0d28gZG9jdW1lbnRzXG4gKiBiYXNlZCBvbiB0aGUgUXVlcnkncyBvcmRlcmluZyBjb25zdHJhaW50LlxuICovIGZ1bmN0aW9uIGlzKHQpIHtcbiAgICByZXR1cm4gKGUsIG4pID0+IHtcbiAgICAgICAgbGV0IHMgPSAhMTtcbiAgICAgICAgZm9yIChjb25zdCBpIG9mIEhuKHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gcnMoaSwgZSwgbik7XG4gICAgICAgICAgICBpZiAoMCAhPT0gdCkgcmV0dXJuIHQ7XG4gICAgICAgICAgICBzID0gcyB8fCBpLmZpZWxkLmlzS2V5RmllbGQoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBycyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IHQuZmllbGQuaXNLZXlGaWVsZCgpID8gaHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5kYXRhLmZpZWxkKHQpLCBpID0gbi5kYXRhLmZpZWxkKHQpO1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gcyAmJiBudWxsICE9PSBpID8gS2UocywgaSkgOiAkKCk7XG4gICAgfSh0LmZpZWxkLCBlLCBuKTtcbiAgICBzd2l0Y2ggKHQuZGlyKSB7XG4gICAgICBjYXNlIFwiYXNjXCIgLyogRGlyZWN0aW9uLkFTQ0VORElORyAqLyA6XG4gICAgICAgIHJldHVybiBzO1xuXG4gICAgICBjYXNlIFwiZGVzY1wiIC8qIERpcmVjdGlvbi5ERVNDRU5ESU5HICovIDpcbiAgICAgICAgcmV0dXJuIC0xICogcztcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuICQoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgbWFwIGltcGxlbWVudGF0aW9uIHRoYXQgdXNlcyBvYmplY3RzIGFzIGtleXMuIE9iamVjdHMgbXVzdCBoYXZlIGFuXG4gKiBhc3NvY2lhdGVkIGVxdWFscyBmdW5jdGlvbiBhbmQgbXVzdCBiZSBpbW11dGFibGUuIEVudHJpZXMgaW4gdGhlIG1hcCBhcmVcbiAqIHN0b3JlZCB0b2dldGhlciB3aXRoIHRoZSBrZXkgYmVpbmcgcHJvZHVjZWQgZnJvbSB0aGUgbWFwS2V5Rm4uIFRoaXMgbWFwXG4gKiBhdXRvbWF0aWNhbGx5IGhhbmRsZXMgY29sbGlzaW9ucyBvZiBrZXlzLlxuICovIGNsYXNzIG9zIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMubWFwS2V5Rm4gPSB0LCB0aGlzLmVxdWFsc0ZuID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgaW5uZXIgbWFwIGZvciBhIGtleS92YWx1ZSBwYWlyLiBEdWUgdG8gdGhlIHBvc3NpYmlsaXR5IG9mIGNvbGxpc2lvbnMgd2VcbiAgICAgICAgICoga2VlcCBhIGxpc3Qgb2YgZW50cmllcyB0aGF0IHdlIGRvIGEgbGluZWFyIHNlYXJjaCB0aHJvdWdoIHRvIGZpbmQgYW4gYWN0dWFsXG4gICAgICAgICAqIG1hdGNoLiBOb3RlIHRoYXQgY29sbGlzaW9ucyBzaG91bGQgYmUgcmFyZSwgc28gd2Ugc3RpbGwgZXhwZWN0IG5lYXJcbiAgICAgICAgICogY29uc3RhbnQgdGltZSBsb29rdXBzIGluIHByYWN0aWNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5pbm5lciA9IHt9LCBcbiAgICAgICAgLyoqIFRoZSBudW1iZXIgb2YgZW50cmllcyBzdG9yZWQgaW4gdGhlIG1hcCAqL1xuICAgICAgICB0aGlzLmlubmVyU2l6ZSA9IDA7XG4gICAgfVxuICAgIC8qKiBHZXQgYSB2YWx1ZSBmb3IgdGhpcyBrZXksIG9yIHVuZGVmaW5lZCBpZiBpdCBkb2VzIG5vdCBleGlzdC4gKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMubWFwS2V5Rm4odCksIG4gPSB0aGlzLmlubmVyW2VdO1xuICAgICAgICBpZiAodm9pZCAwICE9PSBuKSBmb3IgKGNvbnN0IFtlLCBzXSBvZiBuKSBpZiAodGhpcy5lcXVhbHNGbihlLCB0KSkgcmV0dXJuIHM7XG4gICAgfVxuICAgIGhhcyh0KSB7XG4gICAgICAgIHJldHVybiB2b2lkIDAgIT09IHRoaXMuZ2V0KHQpO1xuICAgIH1cbiAgICAvKiogUHV0IHRoaXMga2V5IGFuZCB2YWx1ZSBpbiB0aGUgbWFwLiAqLyAgICBzZXQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5tYXBLZXlGbih0KSwgcyA9IHRoaXMuaW5uZXJbbl07XG4gICAgICAgIGlmICh2b2lkIDAgPT09IHMpIHJldHVybiB0aGlzLmlubmVyW25dID0gWyBbIHQsIGUgXSBdLCB2b2lkIHRoaXMuaW5uZXJTaXplKys7XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgcy5sZW5ndGg7IG4rKykgaWYgKHRoaXMuZXF1YWxzRm4oc1tuXVswXSwgdCkpIFxuICAgICAgICAvLyBUaGlzIGlzIHVwZGF0aW5nIGFuIGV4aXN0aW5nIGVudHJ5IGFuZCBkb2VzIG5vdCBpbmNyZWFzZSBgaW5uZXJTaXplYC5cbiAgICAgICAgcmV0dXJuIHZvaWQgKHNbbl0gPSBbIHQsIGUgXSk7XG4gICAgICAgIHMucHVzaChbIHQsIGUgXSksIHRoaXMuaW5uZXJTaXplKys7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlbW92ZSB0aGlzIGtleSBmcm9tIHRoZSBtYXAuIFJldHVybnMgYSBib29sZWFuIGlmIGFueXRoaW5nIHdhcyBkZWxldGVkLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5tYXBLZXlGbih0KSwgbiA9IHRoaXMuaW5uZXJbZV07XG4gICAgICAgIGlmICh2b2lkIDAgPT09IG4pIHJldHVybiAhMTtcbiAgICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBuLmxlbmd0aDsgcysrKSBpZiAodGhpcy5lcXVhbHNGbihuW3NdWzBdLCB0KSkgcmV0dXJuIDEgPT09IG4ubGVuZ3RoID8gZGVsZXRlIHRoaXMuaW5uZXJbZV0gOiBuLnNwbGljZShzLCAxKSwgXG4gICAgICAgIHRoaXMuaW5uZXJTaXplLS0sICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIGZvckVhY2godCkge1xuICAgICAgICBnZSh0aGlzLmlubmVyLCAoKGUsIG4pID0+IHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgW2UsIHNdIG9mIG4pIHQoZSwgcyk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHllKHRoaXMuaW5uZXIpO1xuICAgIH1cbiAgICBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pbm5lclNpemU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCB1cyA9IG5ldyBwZShodC5jb21wYXJhdG9yKTtcblxuZnVuY3Rpb24gY3MoKSB7XG4gICAgcmV0dXJuIHVzO1xufVxuXG5jb25zdCBhcyA9IG5ldyBwZShodC5jb21wYXJhdG9yKTtcblxuZnVuY3Rpb24gaHMoLi4udCkge1xuICAgIGxldCBlID0gYXM7XG4gICAgZm9yIChjb25zdCBuIG9mIHQpIGUgPSBlLmluc2VydChuLmtleSwgbik7XG4gICAgcmV0dXJuIGU7XG59XG5cbmZ1bmN0aW9uIGxzKHQpIHtcbiAgICBsZXQgZSA9IGFzO1xuICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBuKSA9PiBlID0gZS5pbnNlcnQodCwgbi5vdmVybGF5ZWREb2N1bWVudCkpKSwgZTtcbn1cblxuZnVuY3Rpb24gZnMoKSB7XG4gICAgcmV0dXJuIF9zKCk7XG59XG5cbmZ1bmN0aW9uIGRzKCkge1xuICAgIHJldHVybiBfcygpO1xufVxuXG5mdW5jdGlvbiBfcygpIHtcbiAgICByZXR1cm4gbmV3IG9zKCh0ID0+IHQudG9TdHJpbmcoKSksICgodCwgZSkgPT4gdC5pc0VxdWFsKGUpKSk7XG59XG5cbmNvbnN0IHdzID0gbmV3IHBlKGh0LmNvbXBhcmF0b3IpO1xuXG5jb25zdCBtcyA9IG5ldyBFZShodC5jb21wYXJhdG9yKTtcblxuZnVuY3Rpb24gZ3MoLi4udCkge1xuICAgIGxldCBlID0gbXM7XG4gICAgZm9yIChjb25zdCBuIG9mIHQpIGUgPSBlLmFkZChuKTtcbiAgICByZXR1cm4gZTtcbn1cblxuY29uc3QgeXMgPSBuZXcgRWUoZXQpO1xuXG5mdW5jdGlvbiBwcygpIHtcbiAgICByZXR1cm4geXM7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFJldHVybnMgYW4gRG91YmxlVmFsdWUgZm9yIGB2YWx1ZWAgdGhhdCBpcyBlbmNvZGVkIGJhc2VkIHRoZSBzZXJpYWxpemVyJ3NcbiAqIGB1c2VQcm90bzNKc29uYCBzZXR0aW5nLlxuICovIGZ1bmN0aW9uIElzKHQsIGUpIHtcbiAgICBpZiAodC51c2VQcm90bzNKc29uKSB7XG4gICAgICAgIGlmIChpc05hTihlKSkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIk5hTlwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChlID09PSAxIC8gMCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIkluZmluaXR5XCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKGUgPT09IC0xIC8gMCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBcIi1JbmZpbml0eVwiXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICAgIGRvdWJsZVZhbHVlOiBCdChlKSA/IFwiLTBcIiA6IGVcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYW4gSW50ZWdlclZhbHVlIGZvciBgdmFsdWVgLlxuICovIGZ1bmN0aW9uIFRzKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBpbnRlZ2VyVmFsdWU6IFwiXCIgKyB0XG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgdmFsdWUgZm9yIGEgbnVtYmVyIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICogVGhlIHJldHVybiB2YWx1ZSBpcyBhbiBJbnRlZ2VyVmFsdWUgaWYgaXQgY2FuIHNhZmVseSByZXByZXNlbnQgdGhlIHZhbHVlLFxuICogb3RoZXJ3aXNlIGEgRG91YmxlVmFsdWUgaXMgcmV0dXJuZWQuXG4gKi8gZnVuY3Rpb24gRXModCwgZSkge1xuICAgIHJldHVybiBMdChlKSA/IFRzKGUpIDogSXModCwgZSk7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE4IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogVXNlZCB0byByZXByZXNlbnQgYSBmaWVsZCB0cmFuc2Zvcm0gb24gYSBtdXRhdGlvbi4gKi8gY2xhc3MgQXMge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgc3RydWN0dXJhbCB0eXBlIG9mIGBUcmFuc2Zvcm1PcGVyYXRpb25gIGlzIHVuaXF1ZS5cbiAgICAgICAgLy8gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9taWNyb3NvZnQvVHlwZVNjcmlwdC9pc3N1ZXMvNTQ1MVxuICAgICAgICB0aGlzLl8gPSB2b2lkIDA7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBsb2NhbCB0cmFuc2Zvcm0gcmVzdWx0IGFnYWluc3QgdGhlIHByb3ZpZGVkIGBwcmV2aW91c1ZhbHVlYCxcbiAqIG9wdGlvbmFsbHkgdXNpbmcgdGhlIHByb3ZpZGVkIGxvY2FsV3JpdGVUaW1lLlxuICovIGZ1bmN0aW9uIFJzKHQsIGUsIG4pIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIGJzID8gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0ge1xuICAgICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICAgICAgX190eXBlX186IHtcbiAgICAgICAgICAgICAgICAgICAgc3RyaW5nVmFsdWU6IFwic2VydmVyX3RpbWVzdGFtcFwiXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBfX2xvY2FsX3dyaXRlX3RpbWVfXzoge1xuICAgICAgICAgICAgICAgICAgICB0aW1lc3RhbXBWYWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2Vjb25kczogdC5zZWNvbmRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFub3M6IHQubmFub3NlY29uZHNcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgLy8gV2Ugc2hvdWxkIGF2b2lkIHN0b3JpbmcgZGVlcGx5IG5lc3RlZCBzZXJ2ZXIgdGltZXN0YW1wIG1hcCB2YWx1ZXNcbiAgICAgICAgLy8gYmVjYXVzZSB3ZSBuZXZlciB1c2UgdGhlIGludGVybWVkaWF0ZSBcInByZXZpb3VzIHZhbHVlc1wiLlxuICAgICAgICAvLyBGb3IgZXhhbXBsZTpcbiAgICAgICAgLy8gcHJldmlvdXM6IDQyTCwgYWRkOiB0MSwgcmVzdWx0OiB0MSAtPiA0MkxcbiAgICAgICAgLy8gcHJldmlvdXM6IHQxLCAgYWRkOiB0MiwgcmVzdWx0OiB0MiAtPiA0MkwgKE5PVCB0MiAtPiB0MSAtPiA0MkwpXG4gICAgICAgIC8vIHByZXZpb3VzOiB0MiwgIGFkZDogdDMsIHJlc3VsdDogdDMgLT4gNDJMIChOT1QgdDMgLT4gdDIgLT4gdDEgLT4gNDJMKVxuICAgICAgICAvLyBgZ2V0UHJldmlvdXNWYWx1ZWAgcmVjdXJzaXZlbHkgdHJhdmVyc2VzIHNlcnZlciB0aW1lc3RhbXBzIHRvIGZpbmQgdGhlXG4gICAgICAgIC8vIGxlYXN0IHJlY2VudCBWYWx1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gZSAmJiBOZShlKSAmJiAoZSA9IGtlKGUpKSwgZSAmJiAobi5maWVsZHMuX19wcmV2aW91c192YWx1ZV9fID0gZSksIFxuICAgICAgICB7XG4gICAgICAgICAgICBtYXBWYWx1ZTogblxuICAgICAgICB9O1xuICAgIH0obiwgZSkgOiB0IGluc3RhbmNlb2YgVnMgPyBTcyh0LCBlKSA6IHQgaW5zdGFuY2VvZiBEcyA/IENzKHQsIGUpIDogZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IFNpbmNlIEphdmFTY3JpcHQncyBpbnRlZ2VyIGFyaXRobWV0aWMgaXMgbGltaXRlZCB0byA1MyBiaXRcbiAgICAgICAgLy8gcHJlY2lzaW9uIGFuZCByZXNvbHZlcyBvdmVyZmxvd3MgYnkgcmVkdWNpbmcgcHJlY2lzaW9uLCB3ZSBkbyBub3RcbiAgICAgICAgLy8gbWFudWFsbHkgY2FwIG92ZXJmbG93cyBhdCAyXjYzLlxuICAgICAgICBjb25zdCBuID0gUHModCwgZSksIHMgPSBOcyhuKSArIE5zKHQud3QpO1xuICAgICAgICByZXR1cm4gSGUobikgJiYgSGUodC53dCkgPyBUcyhzKSA6IElzKHQuc2VyaWFsaXplciwgcyk7XG4gICAgfSh0LCBlKTtcbn1cblxuLyoqXG4gKiBDb21wdXRlcyBhIGZpbmFsIHRyYW5zZm9ybSByZXN1bHQgYWZ0ZXIgdGhlIHRyYW5zZm9ybSBoYXMgYmVlbiBhY2tub3dsZWRnZWRcbiAqIGJ5IHRoZSBzZXJ2ZXIsIHBvdGVudGlhbGx5IHVzaW5nIHRoZSBzZXJ2ZXItcHJvdmlkZWQgdHJhbnNmb3JtUmVzdWx0LlxuICovIGZ1bmN0aW9uIHZzKHQsIGUsIG4pIHtcbiAgICAvLyBUaGUgc2VydmVyIGp1c3Qgc2VuZHMgbnVsbCBhcyB0aGUgdHJhbnNmb3JtIHJlc3VsdCBmb3IgYXJyYXkgb3BlcmF0aW9ucyxcbiAgICAvLyBzbyB3ZSBoYXZlIHRvIGNhbGN1bGF0ZSBhIHJlc3VsdCB0aGUgc2FtZSBhcyB3ZSBkbyBmb3IgbG9jYWxcbiAgICAvLyBhcHBsaWNhdGlvbnMuXG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBWcyA/IFNzKHQsIGUpIDogdCBpbnN0YW5jZW9mIERzID8gQ3ModCwgZSkgOiBuO1xufVxuXG4vKipcbiAqIElmIHRoaXMgdHJhbnNmb3JtIG9wZXJhdGlvbiBpcyBub3QgaWRlbXBvdGVudCwgcmV0dXJucyB0aGUgYmFzZSB2YWx1ZSB0b1xuICogcGVyc2lzdCBmb3IgdGhpcyB0cmFuc2Zvcm0uIElmIGEgYmFzZSB2YWx1ZSBpcyByZXR1cm5lZCwgdGhlIHRyYW5zZm9ybVxuICogb3BlcmF0aW9uIGlzIGFsd2F5cyBhcHBsaWVkIHRvIHRoaXMgYmFzZSB2YWx1ZSwgZXZlbiBpZiBkb2N1bWVudCBoYXNcbiAqIGFscmVhZHkgYmVlbiB1cGRhdGVkLlxuICpcbiAqIEJhc2UgdmFsdWVzIHByb3ZpZGUgY29uc2lzdGVudCBiZWhhdmlvciBmb3Igbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtcyBhbmRcbiAqIGFsbG93IHVzIHRvIHJldHVybiB0aGUgc2FtZSBsYXRlbmN5LWNvbXBlbnNhdGVkIHZhbHVlIGV2ZW4gaWYgdGhlIGJhY2tlbmRcbiAqIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlIHRyYW5zZm9ybSBvcGVyYXRpb24uIFRoZSBiYXNlIHZhbHVlIGlzIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IHRyYW5zZm9ybXMsIGFzIHRoZXkgY2FuIGJlIHJlLXBsYXllZCBldmVuIGlmIHRoZSBiYWNrZW5kIGhhc1xuICogYWxyZWFkeSBhcHBsaWVkIHRoZW0uXG4gKlxuICogQHJldHVybnMgYSBiYXNlIHZhbHVlIHRvIHN0b3JlIGFsb25nIHdpdGggdGhlIG11dGF0aW9uLCBvciBudWxsIGZvclxuICogaWRlbXBvdGVudCB0cmFuc2Zvcm1zLlxuICovIGZ1bmN0aW9uIFBzKHQsIGUpIHtcbiAgICByZXR1cm4gdCBpbnN0YW5jZW9mIHhzID8gSGUobiA9IGUpIHx8IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuICEhdCAmJiBcImRvdWJsZVZhbHVlXCIgaW4gdDtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdHJ1ZSBpZiBgdmFsdWVgIGlzIGVpdGhlciBhbiBJbnRlZ2VyVmFsdWUgb3IgYSBEb3VibGVWYWx1ZS4gKi8gKG4pID8gZSA6IHtcbiAgICAgICAgaW50ZWdlclZhbHVlOiAwXG4gICAgfSA6IG51bGw7XG4gICAgdmFyIG47XG59XG5cbi8qKiBUcmFuc2Zvcm1zIGEgdmFsdWUgaW50byBhIHNlcnZlci1nZW5lcmF0ZWQgdGltZXN0YW1wLiAqL1xuY2xhc3MgYnMgZXh0ZW5kcyBBcyB7fVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSB1bmlvbiBvcGVyYXRpb24uICovIGNsYXNzIFZzIGV4dGVuZHMgQXMge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5lbGVtZW50cyA9IHQ7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBTcyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGtzKGUpO1xuICAgIGZvciAoY29uc3QgZSBvZiB0LmVsZW1lbnRzKSBuLnNvbWUoKHQgPT4gcWUodCwgZSkpKSB8fCBuLnB1c2goZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYXJyYXlWYWx1ZToge1xuICAgICAgICAgICAgdmFsdWVzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG4vKiogVHJhbnNmb3JtcyBhbiBhcnJheSB2YWx1ZSB2aWEgYSByZW1vdmUgb3BlcmF0aW9uLiAqLyBjbGFzcyBEcyBleHRlbmRzIEFzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZWxlbWVudHMgPSB0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gQ3ModCwgZSkge1xuICAgIGxldCBuID0ga3MoZSk7XG4gICAgZm9yIChjb25zdCBlIG9mIHQuZWxlbWVudHMpIG4gPSBuLmZpbHRlcigodCA9PiAhcWUodCwgZSkpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICB2YWx1ZXM6IG5cbiAgICAgICAgfVxuICAgIH07XG59XG5cbi8qKlxuICogSW1wbGVtZW50cyB0aGUgYmFja2VuZCBzZW1hbnRpY3MgZm9yIGxvY2FsbHkgY29tcHV0ZWQgTlVNRVJJQ19BREQgKGluY3JlbWVudClcbiAqIHRyYW5zZm9ybXMuIENvbnZlcnRzIGFsbCBmaWVsZCB2YWx1ZXMgdG8gaW50ZWdlcnMgb3IgZG91YmxlcywgYnV0IHVubGlrZSB0aGVcbiAqIGJhY2tlbmQgZG9lcyBub3QgY2FwIGludGVnZXIgdmFsdWVzIGF0IDJeNjMuIEluc3RlYWQsIEphdmFTY3JpcHQgbnVtYmVyXG4gKiBhcml0aG1ldGljIGlzIHVzZWQgYW5kIHByZWNpc2lvbiBsb3NzIGNhbiBvY2N1ciBmb3IgdmFsdWVzIGdyZWF0ZXIgdGhhbiAyXjUzLlxuICovIGNsYXNzIHhzIGV4dGVuZHMgQXMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5zZXJpYWxpemVyID0gdCwgdGhpcy53dCA9IGU7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBOcyh0KSB7XG4gICAgcmV0dXJuIENlKHQuaW50ZWdlclZhbHVlIHx8IHQuZG91YmxlVmFsdWUpO1xufVxuXG5mdW5jdGlvbiBrcyh0KSB7XG4gICAgcmV0dXJuIEplKHQpICYmIHQuYXJyYXlWYWx1ZS52YWx1ZXMgPyB0LmFycmF5VmFsdWUudmFsdWVzLnNsaWNlKCkgOiBbXTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBBIGZpZWxkIHBhdGggYW5kIHRoZSBUcmFuc2Zvcm1PcGVyYXRpb24gdG8gcGVyZm9ybSB1cG9uIGl0LiAqLyBjbGFzcyBNcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmZpZWxkID0gdCwgdGhpcy50cmFuc2Zvcm0gPSBlO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gT3ModCwgZSkge1xuICAgIHJldHVybiB0LmZpZWxkLmlzRXF1YWwoZS5maWVsZCkgJiYgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIFZzICYmIGUgaW5zdGFuY2VvZiBWcyB8fCB0IGluc3RhbmNlb2YgRHMgJiYgZSBpbnN0YW5jZW9mIERzID8gbnQodC5lbGVtZW50cywgZS5lbGVtZW50cywgcWUpIDogdCBpbnN0YW5jZW9mIHhzICYmIGUgaW5zdGFuY2VvZiB4cyA/IHFlKHQud3QsIGUud3QpIDogdCBpbnN0YW5jZW9mIGJzICYmIGUgaW5zdGFuY2VvZiBicztcbiAgICB9KHQudHJhbnNmb3JtLCBlLnRyYW5zZm9ybSk7XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHN1Y2Nlc3NmdWxseSBhcHBseWluZyBhIG11dGF0aW9uIHRvIHRoZSBiYWNrZW5kLiAqL1xuY2xhc3MgJHMge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSB2ZXJzaW9uIGF0IHdoaWNoIHRoZSBtdXRhdGlvbiB3YXMgY29tbWl0dGVkOlxuICAgICAqXG4gICAgICogLSBGb3IgbW9zdCBvcGVyYXRpb25zLCB0aGlzIGlzIHRoZSB1cGRhdGVUaW1lIGluIHRoZSBXcml0ZVJlc3VsdC5cbiAgICAgKiAtIEZvciBkZWxldGVzLCB0aGUgY29tbWl0VGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSAoYmVjYXVzZSBkZWxldGVzIGFyZVxuICAgICAqICAgbm90IHN0b3JlZCBhbmQgaGF2ZSBubyB1cGRhdGVUaW1lKS5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGVzZSB2ZXJzaW9ucyBjYW4gYmUgZGlmZmVyZW50OiBOby1vcCB3cml0ZXMgd2lsbCBub3QgY2hhbmdlXG4gICAgICogdGhlIHVwZGF0ZVRpbWUgZXZlbiB0aG91Z2ggdGhlIGNvbW1pdFRpbWUgYWR2YW5jZXMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIHJlc3VsdGluZyBmaWVsZHMgcmV0dXJuZWQgZnJvbSB0aGUgYmFja2VuZCBhZnRlciBhIG11dGF0aW9uXG4gICAgICogY29udGFpbmluZyBmaWVsZCB0cmFuc2Zvcm1zIGhhcyBiZWVuIGNvbW1pdHRlZC4gQ29udGFpbnMgb25lIEZpZWxkVmFsdWVcbiAgICAgKiBmb3IgZWFjaCBGaWVsZFRyYW5zZm9ybSB0aGF0IHdhcyBpbiB0aGUgbXV0YXRpb24uXG4gICAgICpcbiAgICAgKiBXaWxsIGJlIGVtcHR5IGlmIHRoZSBtdXRhdGlvbiBkaWQgbm90IGNvbnRhaW4gYW55IGZpZWxkIHRyYW5zZm9ybXMuXG4gICAgICovXG4gICAgZSkge1xuICAgICAgICB0aGlzLnZlcnNpb24gPSB0LCB0aGlzLnRyYW5zZm9ybVJlc3VsdHMgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBFbmNvZGVzIGEgcHJlY29uZGl0aW9uIGZvciBhIG11dGF0aW9uLiBUaGlzIGZvbGxvd3MgdGhlIG1vZGVsIHRoYXQgdGhlXG4gKiBiYWNrZW5kIGFjY2VwdHMgd2l0aCB0aGUgc3BlY2lhbCBjYXNlIG9mIGFuIGV4cGxpY2l0IFwiZW1wdHlcIiBwcmVjb25kaXRpb25cbiAqIChtZWFuaW5nIG5vIHByZWNvbmRpdGlvbikuXG4gKi8gY2xhc3MgRnMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51cGRhdGVUaW1lID0gdCwgdGhpcy5leGlzdHMgPSBlO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBlbXB0eSBQcmVjb25kaXRpb24uICovICAgIHN0YXRpYyBub25lKCkge1xuICAgICAgICByZXR1cm4gbmV3IEZzO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyBQcmVjb25kaXRpb24gd2l0aCBhbiBleGlzdHMgZmxhZy4gKi8gICAgc3RhdGljIGV4aXN0cyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgRnModm9pZCAwLCB0KTtcbiAgICB9XG4gICAgLyoqIENyZWF0ZXMgYSBuZXcgUHJlY29uZGl0aW9uIGJhc2VkIG9uIGEgdmVyc2lvbiBhIGRvY3VtZW50IGV4aXN0cyBhdC4gKi8gICAgc3RhdGljIHVwZGF0ZVRpbWUodCkge1xuICAgICAgICByZXR1cm4gbmV3IEZzKHQpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyB3aGV0aGVyIHRoaXMgUHJlY29uZGl0aW9uIGlzIGVtcHR5LiAqLyAgICBnZXQgaXNOb25lKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0aGlzLnVwZGF0ZVRpbWUgJiYgdm9pZCAwID09PSB0aGlzLmV4aXN0cztcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmV4aXN0cyA9PT0gdC5leGlzdHMgJiYgKHRoaXMudXBkYXRlVGltZSA/ICEhdC51cGRhdGVUaW1lICYmIHRoaXMudXBkYXRlVGltZS5pc0VxdWFsKHQudXBkYXRlVGltZSkgOiAhdC51cGRhdGVUaW1lKTtcbiAgICB9XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHByZWNvbmRpdGlvbnMgaXMgdmFsaWQgZm9yIHRoZSBnaXZlbiBkb2N1bWVudC4gKi8gZnVuY3Rpb24gQnModCwgZSkge1xuICAgIHJldHVybiB2b2lkIDAgIT09IHQudXBkYXRlVGltZSA/IGUuaXNGb3VuZERvY3VtZW50KCkgJiYgZS52ZXJzaW9uLmlzRXF1YWwodC51cGRhdGVUaW1lKSA6IHZvaWQgMCA9PT0gdC5leGlzdHMgfHwgdC5leGlzdHMgPT09IGUuaXNGb3VuZERvY3VtZW50KCk7XG59XG5cbi8qKlxuICogQSBtdXRhdGlvbiBkZXNjcmliZXMgYSBzZWxmLWNvbnRhaW5lZCBjaGFuZ2UgdG8gYSBkb2N1bWVudC4gTXV0YXRpb25zIGNhblxuICogY3JlYXRlLCByZXBsYWNlLCBkZWxldGUsIGFuZCB1cGRhdGUgc3Vic2V0cyBvZiBkb2N1bWVudHMuXG4gKlxuICogTXV0YXRpb25zIG5vdCBvbmx5IGFjdCBvbiB0aGUgdmFsdWUgb2YgdGhlIGRvY3VtZW50IGJ1dCBhbHNvIGl0cyB2ZXJzaW9uLlxuICpcbiAqIEZvciBsb2NhbCBtdXRhdGlvbnMgKG11dGF0aW9ucyB0aGF0IGhhdmVuJ3QgYmVlbiBjb21taXR0ZWQgeWV0KSwgd2UgcHJlc2VydmVcbiAqIHRoZSBleGlzdGluZyB2ZXJzaW9uIGZvciBTZXQgYW5kIFBhdGNoIG11dGF0aW9ucy4gRm9yIERlbGV0ZSBtdXRhdGlvbnMsIHdlXG4gKiByZXNldCB0aGUgdmVyc2lvbiB0byAwLlxuICpcbiAqIEhlcmUncyB0aGUgZXhwZWN0ZWQgdHJhbnNpdGlvbiB0YWJsZS5cbiAqXG4gKiBNVVRBVElPTiAgICAgICAgICAgQVBQTElFRCBUTyAgICAgICAgICAgIFJFU1VMVFMgSU5cbiAqXG4gKiBTZXRNdXRhdGlvbiAgICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxuICogU2V0TXV0YXRpb24gICAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBEb2N1bWVudCh2MClcbiAqIFNldE11dGF0aW9uICAgICAgICBJbnZhbGlkRG9jdW1lbnQodjApICAgRG9jdW1lbnQodjApXG4gKiBQYXRjaE11dGF0aW9uICAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIERvY3VtZW50KHYzKVxuICogUGF0Y2hNdXRhdGlvbiAgICAgIE5vRG9jdW1lbnQodjMpICAgICAgICBOb0RvY3VtZW50KHYzKVxuICogUGF0Y2hNdXRhdGlvbiAgICAgIEludmFsaWREb2N1bWVudCh2MCkgICBVbmtub3duRG9jdW1lbnQodjMpXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgRG9jdW1lbnQodjMpICAgICAgICAgIE5vRG9jdW1lbnQodjApXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgTm9Eb2N1bWVudCh2MykgICAgICAgIE5vRG9jdW1lbnQodjApXG4gKiBEZWxldGVNdXRhdGlvbiAgICAgSW52YWxpZERvY3VtZW50KHYwKSAgIE5vRG9jdW1lbnQodjApXG4gKlxuICogRm9yIGFja25vd2xlZGdlZCBtdXRhdGlvbnMsIHdlIHVzZSB0aGUgdXBkYXRlVGltZSBvZiB0aGUgV3JpdGVSZXNwb25zZSBhc1xuICogdGhlIHJlc3VsdGluZyB2ZXJzaW9uIGZvciBTZXQgYW5kIFBhdGNoIG11dGF0aW9ucy4gQXMgZGVsZXRlcyBoYXZlIG5vXG4gKiBleHBsaWNpdCB1cGRhdGUgdGltZSwgd2UgdXNlIHRoZSBjb21taXRUaW1lIG9mIHRoZSBXcml0ZVJlc3BvbnNlIGZvclxuICogRGVsZXRlIG11dGF0aW9ucy5cbiAqXG4gKiBJZiBhIG11dGF0aW9uIGlzIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZCBidXQgZmFpbHMgdGhlIHByZWNvbmRpdGlvbiBjaGVja1xuICogbG9jYWxseSwgd2UgdHJhbnNpdGlvbiB0byBhbiBgVW5rbm93bkRvY3VtZW50YCBhbmQgcmVseSBvbiBXYXRjaCB0byBzZW5kIHVzXG4gKiB0aGUgdXBkYXRlZCB2ZXJzaW9uLlxuICpcbiAqIEZpZWxkIHRyYW5zZm9ybXMgYXJlIHVzZWQgb25seSB3aXRoIFBhdGNoIGFuZCBTZXQgTXV0YXRpb25zLiBXZSB1c2UgdGhlXG4gKiBgdXBkYXRlVHJhbnNmb3Jtc2AgbWVzc2FnZSB0byBzdG9yZSB0cmFuc2Zvcm1zLCByYXRoZXIgdGhhbiB0aGUgYHRyYW5zZm9ybXNgc1xuICogbWVzc2FnZXMuXG4gKlxuICogIyMgU3ViY2xhc3NpbmcgTm90ZXNcbiAqXG4gKiBFdmVyeSB0eXBlIG9mIG11dGF0aW9uIG5lZWRzIHRvIGltcGxlbWVudCBpdHMgb3duIGFwcGx5VG9SZW1vdGVEb2N1bWVudCgpIGFuZFxuICogYXBwbHlUb0xvY2FsVmlldygpIHRvIGltcGxlbWVudCB0aGUgYWN0dWFsIGJlaGF2aW9yIG9mIGFwcGx5aW5nIHRoZSBtdXRhdGlvblxuICogdG8gc29tZSBzb3VyY2UgZG9jdW1lbnQgKHNlZSBgc2V0TXV0YXRpb25BcHBseVRvUmVtb3RlRG9jdW1lbnQoKWAgZm9yIGFuXG4gKiBleGFtcGxlKS5cbiAqLyBjbGFzcyBMcyB7fVxuXG4vKipcbiAqIEEgdXRpbGl0eSBtZXRob2QgdG8gY2FsY3VsYXRlIGEgYE11dGF0aW9uYCByZXByZXNlbnRpbmcgdGhlIG92ZXJsYXkgZnJvbSB0aGVcbiAqIGZpbmFsIHN0YXRlIG9mIHRoZSBkb2N1bWVudCwgYW5kIGEgYEZpZWxkTWFza2AgcmVwcmVzZW50aW5nIHRoZSBmaWVsZHMgdGhhdFxuICogYXJlIG11dGF0ZWQgYnkgdGhlIGxvY2FsIG11dGF0aW9ucy5cbiAqLyBmdW5jdGlvbiBxcyh0LCBlKSB7XG4gICAgaWYgKCF0Lmhhc0xvY2FsTXV0YXRpb25zIHx8IGUgJiYgMCA9PT0gZS5maWVsZHMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAvLyBtYXNrIGlzIG51bGwgd2hlbiBzZXRzIG9yIGRlbGV0ZXMgYXJlIGFwcGxpZWQgdG8gdGhlIGN1cnJlbnQgZG9jdW1lbnQuXG4gICAgICAgIGlmIChudWxsID09PSBlKSByZXR1cm4gdC5pc05vRG9jdW1lbnQoKSA/IG5ldyBZcyh0LmtleSwgRnMubm9uZSgpKSA6IG5ldyBqcyh0LmtleSwgdC5kYXRhLCBGcy5ub25lKCkpO1xuICAgIHtcbiAgICAgICAgY29uc3QgbiA9IHQuZGF0YSwgcyA9IHVuLmVtcHR5KCk7XG4gICAgICAgIGxldCBpID0gbmV3IEVlKGF0LmNvbXBhcmF0b3IpO1xuICAgICAgICBmb3IgKGxldCB0IG9mIGUuZmllbGRzKSBpZiAoIWkuaGFzKHQpKSB7XG4gICAgICAgICAgICBsZXQgZSA9IG4uZmllbGQodCk7XG4gICAgICAgICAgICAvLyBJZiB3ZSBhcmUgZGVsZXRpbmcgYSBuZXN0ZWQgZmllbGQsIHdlIHRha2UgdGhlIGltbWVkaWF0ZSBwYXJlbnQgYXNcbiAgICAgICAgICAgIC8vIHRoZSBtYXNrIHVzZWQgdG8gY29uc3RydWN0IHRoZSByZXN1bHRpbmcgbXV0YXRpb24uXG4gICAgICAgICAgICAvLyBKdXN0aWZpY2F0aW9uOiBOZXN0ZWQgZmllbGRzIGNhbiBjcmVhdGUgcGFyZW50IGZpZWxkcyBpbXBsaWNpdGx5LiBJZlxuICAgICAgICAgICAgLy8gb25seSBhIGxlYWYgZW50cnkgaXMgZGVsZXRlZCBpbiBsYXRlciBtdXRhdGlvbnMsIHRoZSBwYXJlbnQgZmllbGRcbiAgICAgICAgICAgIC8vIHNob3VsZCBzdGlsbCByZW1haW4sIGJ1dCB3ZSBtYXkgaGF2ZSBsb3N0IHRoaXMgaW5mb3JtYXRpb24uXG4gICAgICAgICAgICAvLyBDb25zaWRlciBtdXRhdGlvbiAoZm9vLmJhciAxKSwgdGhlbiBtdXRhdGlvbiAoZm9vLmJhciBkZWxldGUoKSkuXG4gICAgICAgICAgICAvLyBUaGlzIGxlYXZlcyB0aGUgZmluYWwgcmVzdWx0IChmb28sIHt9KS4gRGVzcGl0ZSB0aGUgZmFjdCB0aGF0IGBkb2NgXG4gICAgICAgICAgICAvLyBoYXMgdGhlIGNvcnJlY3QgcmVzdWx0LCBgZm9vYCBpcyBub3QgaW4gYG1hc2tgLCBhbmQgdGhlIHJlc3VsdGluZ1xuICAgICAgICAgICAgLy8gbXV0YXRpb24gd291bGQgbWlzcyBgZm9vYC5cbiAgICAgICAgICAgICAgICAgICAgICAgIG51bGwgPT09IGUgJiYgdC5sZW5ndGggPiAxICYmICh0ID0gdC5wb3BMYXN0KCksIGUgPSBuLmZpZWxkKHQpKSwgbnVsbCA9PT0gZSA/IHMuZGVsZXRlKHQpIDogcy5zZXQodCwgZSksIFxuICAgICAgICAgICAgaSA9IGkuYWRkKHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcgenModC5rZXksIHMsIG5ldyB2ZShpLnRvQXJyYXkoKSksIEZzLm5vbmUoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgdGhpcyBtdXRhdGlvbiB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHRoZSBwdXJwb3NlcyBvZiBjb21wdXRpbmcgYVxuICogbmV3IHJlbW90ZSBkb2N1bWVudC4gSWYgdGhlIGlucHV0IGRvY3VtZW50IGRvZXNuJ3QgbWF0Y2ggdGhlIGV4cGVjdGVkIHN0YXRlXG4gKiAoZS5nLiBpdCBpcyBpbnZhbGlkIG9yIG91dGRhdGVkKSwgdGhlIGRvY3VtZW50IHR5cGUgbWF5IHRyYW5zaXRpb24gdG9cbiAqIHVua25vd24uXG4gKlxuICogQHBhcmFtIG11dGF0aW9uIC0gVGhlIG11dGF0aW9uIHRvIGFwcGx5LlxuICogQHBhcmFtIGRvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIG11dGF0ZS4gVGhlIGlucHV0IGRvY3VtZW50IGNhbiBiZSBhblxuICogICAgIGludmFsaWQgZG9jdW1lbnQgaWYgdGhlIGNsaWVudCBoYXMgbm8ga25vd2xlZGdlIG9mIHRoZSBwcmUtbXV0YXRpb24gc3RhdGVcbiAqICAgICBvZiB0aGUgZG9jdW1lbnQuXG4gKiBAcGFyYW0gbXV0YXRpb25SZXN1bHQgLSBUaGUgcmVzdWx0IG9mIGFwcGx5aW5nIHRoZSBtdXRhdGlvbiBmcm9tIHRoZSBiYWNrZW5kLlxuICovIGZ1bmN0aW9uIFVzKHQsIGUsIG4pIHtcbiAgICB0IGluc3RhbmNlb2YganMgPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFVubGlrZSBzZXRNdXRhdGlvbkFwcGx5VG9Mb2NhbFZpZXcsIGlmIHdlJ3JlIGFwcGx5aW5nIGEgbXV0YXRpb24gdG8gYVxuICAgICAgICAvLyByZW1vdGUgZG9jdW1lbnQgdGhlIHNlcnZlciBoYXMgYWNjZXB0ZWQgdGhlIG11dGF0aW9uIHNvIHRoZSBwcmVjb25kaXRpb25cbiAgICAgICAgLy8gbXVzdCBoYXZlIGhlbGQuXG4gICAgICAgIGNvbnN0IHMgPSB0LnZhbHVlLmNsb25lKCksIGkgPSBIcyh0LmZpZWxkVHJhbnNmb3JtcywgZSwgbi50cmFuc2Zvcm1SZXN1bHRzKTtcbiAgICAgICAgcy5zZXRBbGwoaSksIGUuY29udmVydFRvRm91bmREb2N1bWVudChuLnZlcnNpb24sIHMpLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0odCwgZSwgbikgOiB0IGluc3RhbmNlb2YgenMgPyBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGlmICghQnModC5wcmVjb25kaXRpb24sIGUpKSBcbiAgICAgICAgLy8gU2luY2UgdGhlIG11dGF0aW9uIHdhcyBub3QgcmVqZWN0ZWQsIHdlIGtub3cgdGhhdCB0aGUgcHJlY29uZGl0aW9uXG4gICAgICAgIC8vIG1hdGNoZWQgb24gdGhlIGJhY2tlbmQuIFdlIHRoZXJlZm9yZSBtdXN0IG5vdCBoYXZlIHRoZSBleHBlY3RlZCB2ZXJzaW9uXG4gICAgICAgIC8vIG9mIHRoZSBkb2N1bWVudCBpbiBvdXIgY2FjaGUgYW5kIGNvbnZlcnQgdG8gYW4gVW5rbm93bkRvY3VtZW50IHdpdGggYVxuICAgICAgICAvLyBrbm93biB1cGRhdGVUaW1lLlxuICAgICAgICByZXR1cm4gdm9pZCBlLmNvbnZlcnRUb1Vua25vd25Eb2N1bWVudChuLnZlcnNpb24pO1xuICAgICAgICBjb25zdCBzID0gSHModC5maWVsZFRyYW5zZm9ybXMsIGUsIG4udHJhbnNmb3JtUmVzdWx0cyksIGkgPSBlLmRhdGE7XG4gICAgICAgIGkuc2V0QWxsKFdzKHQpKSwgaS5zZXRBbGwocyksIGUuY29udmVydFRvRm91bmREb2N1bWVudChuLnZlcnNpb24sIGkpLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0odCwgZSwgbikgOiBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIC8vIFVubGlrZSBhcHBseVRvTG9jYWxWaWV3LCBpZiB3ZSdyZSBhcHBseWluZyBhIG11dGF0aW9uIHRvIGEgcmVtb3RlXG4gICAgICAgIC8vIGRvY3VtZW50IHRoZSBzZXJ2ZXIgaGFzIGFjY2VwdGVkIHRoZSBtdXRhdGlvbiBzbyB0aGUgcHJlY29uZGl0aW9uIG11c3RcbiAgICAgICAgLy8gaGF2ZSBoZWxkLlxuICAgICAgICBlLmNvbnZlcnRUb05vRG9jdW1lbnQobi52ZXJzaW9uKS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKTtcbiAgICB9KDAsIGUsIG4pO1xufVxuXG4vKipcbiAqIEFwcGxpZXMgdGhpcyBtdXRhdGlvbiB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQgZm9yIHRoZSBwdXJwb3NlcyBvZiBjb21wdXRpbmdcbiAqIHRoZSBuZXcgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50LiBJZiB0aGUgaW5wdXQgZG9jdW1lbnQgZG9lc24ndCBtYXRjaCB0aGVcbiAqIGV4cGVjdGVkIHN0YXRlLCB0aGUgZG9jdW1lbnQgaXMgbm90IG1vZGlmaWVkLlxuICpcbiAqIEBwYXJhbSBtdXRhdGlvbiAtIFRoZSBtdXRhdGlvbiB0byBhcHBseS5cbiAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBtdXRhdGUuIFRoZSBpbnB1dCBkb2N1bWVudCBjYW4gYmUgYW5cbiAqICAgICBpbnZhbGlkIGRvY3VtZW50IGlmIHRoZSBjbGllbnQgaGFzIG5vIGtub3dsZWRnZSBvZiB0aGUgcHJlLW11dGF0aW9uIHN0YXRlXG4gKiAgICAgb2YgdGhlIGRvY3VtZW50LlxuICogQHBhcmFtIHByZXZpb3VzTWFzayAtIFRoZSBmaWVsZHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBiZWZvcmUgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbi5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIEEgdGltZXN0YW1wIGluZGljYXRpbmcgdGhlIGxvY2FsIHdyaXRlIHRpbWUgb2YgdGhlXG4gKiAgICAgYmF0Y2ggdGhpcyBtdXRhdGlvbiBpcyBhIHBhcnQgb2YuXG4gKiBAcmV0dXJucyBBIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyB0aGUgZmllbGRzIHRoYXQgYXJlIGNoYW5nZWQgYnkgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbi5cbiAqLyBmdW5jdGlvbiBLcyh0LCBlLCBuLCBzKSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBqcyA/IGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgaWYgKCFCcyh0LnByZWNvbmRpdGlvbiwgZSkpIFxuICAgICAgICAvLyBUaGUgbXV0YXRpb24gZmFpbGVkIHRvIGFwcGx5IChlLmcuIGEgZG9jdW1lbnQgSUQgY3JlYXRlZCB3aXRoIGFkZCgpXG4gICAgICAgIC8vIGNhdXNlZCBhIG5hbWUgY29sbGlzaW9uKS5cbiAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIGNvbnN0IGkgPSB0LnZhbHVlLmNsb25lKCksIHIgPSBKcyh0LmZpZWxkVHJhbnNmb3JtcywgcywgZSk7XG4gICAgICAgIHJldHVybiBpLnNldEFsbChyKSwgZS5jb252ZXJ0VG9Gb3VuZERvY3VtZW50KGUudmVyc2lvbiwgaSkuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSwgXG4gICAgICAgIG51bGw7XG4gLy8gU2V0TXV0YXRpb24gb3ZlcndyaXRlcyBhbGwgZmllbGRzLlxuICAgICAgICB9XG4gICAgLyoqXG4gKiBBIG11dGF0aW9uIHRoYXQgbW9kaWZpZXMgZmllbGRzIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGggdGhlXG4gKiBnaXZlbiB2YWx1ZXMuIFRoZSB2YWx1ZXMgYXJlIGFwcGxpZWQgdGhyb3VnaCBhIGZpZWxkIG1hc2s6XG4gKlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIGJvdGggdGhlIG1hc2sgYW5kIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nIGZpZWxkXG4gKiAgICBpcyB1cGRhdGVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIG5laXRoZXIgdGhlIG1hc2sgbm9yIHRoZSB2YWx1ZXMsIHRoZSBjb3JyZXNwb25kaW5nXG4gKiAgICBmaWVsZCBpcyB1bm1vZGlmaWVkLlxuICogICogV2hlbiBhIGZpZWxkIGlzIGluIHRoZSBtYXNrIGJ1dCBub3QgaW4gdGhlIHZhbHVlcywgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGRcbiAqICAgIGlzIGRlbGV0ZWQuXG4gKiAgKiBXaGVuIGEgZmllbGQgaXMgbm90IGluIHRoZSBtYXNrIGJ1dCBpcyBpbiB0aGUgdmFsdWVzLCB0aGUgdmFsdWVzIG1hcCBpc1xuICogICAgaWdub3JlZC5cbiAqLyAodCwgZSwgbiwgcykgOiB0IGluc3RhbmNlb2YgenMgPyBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIGlmICghQnModC5wcmVjb25kaXRpb24sIGUpKSByZXR1cm4gbjtcbiAgICAgICAgY29uc3QgaSA9IEpzKHQuZmllbGRUcmFuc2Zvcm1zLCBzLCBlKSwgciA9IGUuZGF0YTtcbiAgICAgICAgaWYgKHIuc2V0QWxsKFdzKHQpKSwgci5zZXRBbGwoaSksIGUuY29udmVydFRvRm91bmREb2N1bWVudChlLnZlcnNpb24sIHIpLnNldEhhc0xvY2FsTXV0YXRpb25zKCksIFxuICAgICAgICBudWxsID09PSBuKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIG4udW5pb25XaXRoKHQuZmllbGRNYXNrLmZpZWxkcykudW5pb25XaXRoKHQuZmllbGRUcmFuc2Zvcm1zLm1hcCgodCA9PiB0LmZpZWxkKSkpO1xuICAgIH1cbiAgICAvKipcbiAqIFJldHVybnMgYSBGaWVsZFBhdGgvVmFsdWUgbWFwIHdpdGggdGhlIGNvbnRlbnQgb2YgdGhlIFBhdGNoTXV0YXRpb24uXG4gKi8gKHQsIGUsIG4sIHMpIDogZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBpZiAoQnModC5wcmVjb25kaXRpb24sIGUpKSByZXR1cm4gZS5jb252ZXJ0VG9Ob0RvY3VtZW50KGUudmVyc2lvbikuc2V0SGFzTG9jYWxNdXRhdGlvbnMoKSwgXG4gICAgICAgIG51bGw7XG4gICAgICAgIHJldHVybiBuO1xuICAgIH1cbiAgICAvKipcbiAqIEEgbXV0YXRpb24gdGhhdCB2ZXJpZmllcyB0aGUgZXhpc3RlbmNlIG9mIHRoZSBkb2N1bWVudCBhdCB0aGUgZ2l2ZW4ga2V5IHdpdGhcbiAqIHRoZSBwcm92aWRlZCBwcmVjb25kaXRpb24uXG4gKlxuICogVGhlIGB2ZXJpZnlgIG9wZXJhdGlvbiBpcyBvbmx5IHVzZWQgaW4gVHJhbnNhY3Rpb25zLCBhbmQgdGhpcyBjbGFzcyBzZXJ2ZXNcbiAqIHByaW1hcmlseSB0byBmYWNpbGl0YXRlIHNlcmlhbGl6YXRpb24gaW50byBwcm90b3MuXG4gKi8gKHQsIGUsIG4pO1xufVxuXG4vKipcbiAqIElmIHRoaXMgbXV0YXRpb24gaXMgbm90IGlkZW1wb3RlbnQsIHJldHVybnMgdGhlIGJhc2UgdmFsdWUgdG8gcGVyc2lzdCB3aXRoXG4gKiB0aGlzIG11dGF0aW9uLiBJZiBhIGJhc2UgdmFsdWUgaXMgcmV0dXJuZWQsIHRoZSBtdXRhdGlvbiBpcyBhbHdheXMgYXBwbGllZFxuICogdG8gdGhpcyBiYXNlIHZhbHVlLCBldmVuIGlmIGRvY3VtZW50IGhhcyBhbHJlYWR5IGJlZW4gdXBkYXRlZC5cbiAqXG4gKiBUaGUgYmFzZSB2YWx1ZSBpcyBhIHNwYXJzZSBvYmplY3QgdGhhdCBjb25zaXN0cyBvZiBvbmx5IHRoZSBkb2N1bWVudFxuICogZmllbGRzIGZvciB3aGljaCB0aGlzIG11dGF0aW9uIGNvbnRhaW5zIGEgbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtYXRpb25cbiAqIChlLmcuIGEgbnVtZXJpYyBpbmNyZW1lbnQpLiBUaGUgcHJvdmlkZWQgdmFsdWUgZ3VhcmFudGVlcyBjb25zaXN0ZW50XG4gKiBiZWhhdmlvciBmb3Igbm9uLWlkZW1wb3RlbnQgdHJhbnNmb3JtcyBhbmQgYWxsb3cgdXMgdG8gcmV0dXJuIHRoZSBzYW1lXG4gKiBsYXRlbmN5LWNvbXBlbnNhdGVkIHZhbHVlIGV2ZW4gaWYgdGhlIGJhY2tlbmQgaGFzIGFscmVhZHkgYXBwbGllZCB0aGVcbiAqIG11dGF0aW9uLiBUaGUgYmFzZSB2YWx1ZSBpcyBudWxsIGZvciBpZGVtcG90ZW50IG11dGF0aW9ucywgYXMgdGhleSBjYW4gYmVcbiAqIHJlLXBsYXllZCBldmVuIGlmIHRoZSBiYWNrZW5kIGhhcyBhbHJlYWR5IGFwcGxpZWQgdGhlbS5cbiAqXG4gKiBAcmV0dXJucyBhIGJhc2UgdmFsdWUgdG8gc3RvcmUgYWxvbmcgd2l0aCB0aGUgbXV0YXRpb24sIG9yIG51bGwgZm9yXG4gKiBpZGVtcG90ZW50IG11dGF0aW9ucy5cbiAqLyBmdW5jdGlvbiBHcyh0LCBlKSB7XG4gICAgbGV0IG4gPSBudWxsO1xuICAgIGZvciAoY29uc3QgcyBvZiB0LmZpZWxkVHJhbnNmb3Jtcykge1xuICAgICAgICBjb25zdCB0ID0gZS5kYXRhLmZpZWxkKHMuZmllbGQpLCBpID0gUHMocy50cmFuc2Zvcm0sIHQgfHwgbnVsbCk7XG4gICAgICAgIG51bGwgIT0gaSAmJiAobnVsbCA9PT0gbiAmJiAobiA9IHVuLmVtcHR5KCkpLCBuLnNldChzLmZpZWxkLCBpKSk7XG4gICAgfVxuICAgIHJldHVybiBuIHx8IG51bGw7XG59XG5cbmZ1bmN0aW9uIFFzKHQsIGUpIHtcbiAgICByZXR1cm4gdC50eXBlID09PSBlLnR5cGUgJiYgKCEhdC5rZXkuaXNFcXVhbChlLmtleSkgJiYgKCEhdC5wcmVjb25kaXRpb24uaXNFcXVhbChlLnByZWNvbmRpdGlvbikgJiYgKCEhZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwID09PSB0ICYmIHZvaWQgMCA9PT0gZSB8fCAhKCF0IHx8ICFlKSAmJiBudCh0LCBlLCAoKHQsIGUpID0+IE9zKHQsIGUpKSk7XG4gICAgfSh0LmZpZWxkVHJhbnNmb3JtcywgZS5maWVsZFRyYW5zZm9ybXMpICYmICgwIC8qIE11dGF0aW9uVHlwZS5TZXQgKi8gPT09IHQudHlwZSA/IHQudmFsdWUuaXNFcXVhbChlLnZhbHVlKSA6IDEgLyogTXV0YXRpb25UeXBlLlBhdGNoICovICE9PSB0LnR5cGUgfHwgdC5kYXRhLmlzRXF1YWwoZS5kYXRhKSAmJiB0LmZpZWxkTWFzay5pc0VxdWFsKGUuZmllbGRNYXNrKSkpKSk7XG59XG5cbi8qKlxuICogQSBtdXRhdGlvbiB0aGF0IGNyZWF0ZXMgb3IgcmVwbGFjZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkgd2l0aCB0aGVcbiAqIG9iamVjdCB2YWx1ZSBjb250ZW50cy5cbiAqLyBjbGFzcyBqcyBleHRlbmRzIExzIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzID0gW10pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnZhbHVlID0gZSwgdGhpcy5wcmVjb25kaXRpb24gPSBuLCB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IHMsIFxuICAgICAgICB0aGlzLnR5cGUgPSAwIC8qIE11dGF0aW9uVHlwZS5TZXQgKi87XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG5jbGFzcyB6cyBleHRlbmRzIExzIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpID0gW10pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLmRhdGEgPSBlLCB0aGlzLmZpZWxkTWFzayA9IG4sIHRoaXMucHJlY29uZGl0aW9uID0gcywgXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gaSwgdGhpcy50eXBlID0gMSAvKiBNdXRhdGlvblR5cGUuUGF0Y2ggKi87XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGRNYXNrO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gV3ModCkge1xuICAgIGNvbnN0IGUgPSBuZXcgTWFwO1xuICAgIHJldHVybiB0LmZpZWxkTWFzay5maWVsZHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgIGlmICghbi5pc0VtcHR5KCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0LmRhdGEuZmllbGQobik7XG4gICAgICAgICAgICBlLnNldChuLCBzKTtcbiAgICAgICAgfVxuICAgIH0pKSwgZTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBvZiBcInRyYW5zZm9ybSByZXN1bHRzXCIgKGEgdHJhbnNmb3JtIHJlc3VsdCBpcyBhIGZpZWxkIHZhbHVlXG4gKiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIHRyYW5zZm9ybSkgZm9yIHVzZSBhZnRlciBhIG11dGF0aW9uXG4gKiBjb250YWluaW5nIHRyYW5zZm9ybXMgaGFzIGJlZW4gYWNrbm93bGVkZ2VkIGJ5IHRoZSBzZXJ2ZXIuXG4gKlxuICogQHBhcmFtIGZpZWxkVHJhbnNmb3JtcyAtIFRoZSBmaWVsZCB0cmFuc2Zvcm1zIHRvIGFwcGx5IHRoZSByZXN1bHQgdG8uXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIGRvY3VtZW50IGFmdGVyIGFwcGx5aW5nIGFsbFxuICogcHJldmlvdXMgbXV0YXRpb25zLlxuICogQHBhcmFtIHNlcnZlclRyYW5zZm9ybVJlc3VsdHMgLSBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgcmVjZWl2ZWQgYnkgdGhlIHNlcnZlci5cbiAqIEByZXR1cm5zIFRoZSB0cmFuc2Zvcm0gcmVzdWx0cyBsaXN0LlxuICovIGZ1bmN0aW9uIEhzKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICBGKHQubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHIgPSB0W2ldLCBvID0gci50cmFuc2Zvcm0sIHUgPSBlLmRhdGEuZmllbGQoci5maWVsZCk7XG4gICAgICAgIHMuc2V0KHIuZmllbGQsIHZzKG8sIHUsIG5baV0pKTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIGxpc3Qgb2YgXCJ0cmFuc2Zvcm0gcmVzdWx0c1wiIChhIHRyYW5zZm9ybSByZXN1bHQgaXMgYSBmaWVsZCB2YWx1ZVxuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHQgb2YgYXBwbHlpbmcgYSB0cmFuc2Zvcm0pIGZvciB1c2Ugd2hlbiBhcHBseWluZyBhXG4gKiB0cmFuc2Zvcm0gbG9jYWxseS5cbiAqXG4gKiBAcGFyYW0gZmllbGRUcmFuc2Zvcm1zIC0gVGhlIGZpZWxkIHRyYW5zZm9ybXMgdG8gYXBwbHkgdGhlIHJlc3VsdCB0by5cbiAqIEBwYXJhbSBsb2NhbFdyaXRlVGltZSAtIFRoZSBsb2NhbCB0aW1lIG9mIHRoZSBtdXRhdGlvbiAodXNlZCB0b1xuICogICAgIGdlbmVyYXRlIFNlcnZlclRpbWVzdGFtcFZhbHVlcykuXG4gKiBAcGFyYW0gbXV0YWJsZURvY3VtZW50IC0gVGhlIGRvY3VtZW50IHRvIGFwcGx5IHRyYW5zZm9ybXMgb24uXG4gKiBAcmV0dXJucyBUaGUgdHJhbnNmb3JtIHJlc3VsdHMgbGlzdC5cbiAqLyBmdW5jdGlvbiBKcyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IG5ldyBNYXA7XG4gICAgZm9yIChjb25zdCBpIG9mIHQpIHtcbiAgICAgICAgY29uc3QgdCA9IGkudHJhbnNmb3JtLCByID0gbi5kYXRhLmZpZWxkKGkuZmllbGQpO1xuICAgICAgICBzLnNldChpLmZpZWxkLCBScyh0LCByLCBlKSk7XG4gICAgfVxuICAgIHJldHVybiBzO1xufVxuXG4vKiogQSBtdXRhdGlvbiB0aGF0IGRlbGV0ZXMgdGhlIGRvY3VtZW50IGF0IHRoZSBnaXZlbiBrZXkuICovIGNsYXNzIFlzIGV4dGVuZHMgTHMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5rZXkgPSB0LCB0aGlzLnByZWNvbmRpdGlvbiA9IGUsIHRoaXMudHlwZSA9IDIgLyogTXV0YXRpb25UeXBlLkRlbGV0ZSAqLyAsIFxuICAgICAgICB0aGlzLmZpZWxkVHJhbnNmb3JtcyA9IFtdO1xuICAgIH1cbiAgICBnZXRGaWVsZE1hc2soKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuY2xhc3MgWHMgZXh0ZW5kcyBMcyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmtleSA9IHQsIHRoaXMucHJlY29uZGl0aW9uID0gZSwgdGhpcy50eXBlID0gMyAvKiBNdXRhdGlvblR5cGUuVmVyaWZ5ICovICwgXG4gICAgICAgIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gW107XG4gICAgfVxuICAgIGdldEZpZWxkTWFzaygpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGJhdGNoIG9mIG11dGF0aW9ucyB0aGF0IHdpbGwgYmUgc2VudCBhcyBvbmUgdW5pdCB0byB0aGUgYmFja2VuZC5cbiAqLyBjbGFzcyBacyB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgdW5pcXVlIElEIG9mIHRoaXMgbXV0YXRpb24gYmF0Y2guXG4gICAgICogQHBhcmFtIGxvY2FsV3JpdGVUaW1lIC0gVGhlIG9yaWdpbmFsIHdyaXRlIHRpbWUgb2YgdGhpcyBtdXRhdGlvbi5cbiAgICAgKiBAcGFyYW0gYmFzZU11dGF0aW9ucyAtIE11dGF0aW9ucyB0aGF0IGFyZSB1c2VkIHRvIHBvcHVsYXRlIHRoZSBiYXNlXG4gICAgICogdmFsdWVzIHdoZW4gdGhpcyBtdXRhdGlvbiBpcyBhcHBsaWVkIGxvY2FsbHkuIFRoaXMgY2FuIGJlIHVzZWQgdG8gbG9jYWxseVxuICAgICAqIG92ZXJ3cml0ZSB2YWx1ZXMgdGhhdCBhcmUgcGVyc2lzdGVkIGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuIEJhc2VcbiAgICAgKiBtdXRhdGlvbnMgYXJlIG5ldmVyIHNlbnQgdG8gdGhlIGJhY2tlbmQuXG4gICAgICogQHBhcmFtIG11dGF0aW9ucyAtIFRoZSB1c2VyLXByb3ZpZGVkIG11dGF0aW9ucyBpbiB0aGlzIG11dGF0aW9uIGJhdGNoLlxuICAgICAqIFVzZXItcHJvdmlkZWQgbXV0YXRpb25zIGFyZSBhcHBsaWVkIGJvdGggbG9jYWxseSBhbmQgcmVtb3RlbHkgb24gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2hJZCA9IHQsIHRoaXMubG9jYWxXcml0ZVRpbWUgPSBlLCB0aGlzLmJhc2VNdXRhdGlvbnMgPSBuLCB0aGlzLm11dGF0aW9ucyA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgYWxsIHRoZSBtdXRhdGlvbnMgaW4gdGhpcyBNdXRhdGlvbkJhdGNoIHRvIHRoZSBzcGVjaWZpZWQgZG9jdW1lbnRcbiAgICAgKiB0byBjb21wdXRlIHRoZSBzdGF0ZSBvZiB0aGUgcmVtb3RlIGRvY3VtZW50XG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnQgLSBUaGUgZG9jdW1lbnQgdG8gYXBwbHkgbXV0YXRpb25zIHRvLlxuICAgICAqIEBwYXJhbSBiYXRjaFJlc3VsdCAtIFRoZSByZXN1bHQgb2YgYXBwbHlpbmcgdGhlIE11dGF0aW9uQmF0Y2ggdG8gdGhlXG4gICAgICogYmFja2VuZC5cbiAgICAgKi8gICAgYXBwbHlUb1JlbW90ZURvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUubXV0YXRpb25SZXN1bHRzO1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHRoaXMubXV0YXRpb25zLmxlbmd0aDsgZSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5tdXRhdGlvbnNbZV07XG4gICAgICAgICAgICBpZiAocy5rZXkuaXNFcXVhbCh0LmtleSkpIHtcbiAgICAgICAgICAgICAgICBVcyhzLCB0LCBuW2VdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBvZiBhIGRvY3VtZW50IGdpdmVuIGFsbCB0aGUgbXV0YXRpb25zIGluIHRoaXNcbiAgICAgKiBiYXRjaC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudCAtIFRoZSBkb2N1bWVudCB0byBhcHBseSBtdXRhdGlvbnMgdG8uXG4gICAgICogQHBhcmFtIG11dGF0ZWRGaWVsZHMgLSBGaWVsZHMgdGhhdCBoYXZlIGJlZW4gdXBkYXRlZCBiZWZvcmUgYXBwbHlpbmcgdGhpcyBtdXRhdGlvbiBiYXRjaC5cbiAgICAgKiBAcmV0dXJucyBBIGBGaWVsZE1hc2tgIHJlcHJlc2VudGluZyBhbGwgdGhlIGZpZWxkcyB0aGF0IGFyZSBtdXRhdGVkLlxuICAgICAqLyAgICBhcHBseVRvTG9jYWxWaWV3KHQsIGUpIHtcbiAgICAgICAgLy8gRmlyc3QsIGFwcGx5IHRoZSBiYXNlIHN0YXRlLiBUaGlzIGFsbG93cyB1cyB0byBhcHBseSBub24taWRlbXBvdGVudFxuICAgICAgICAvLyB0cmFuc2Zvcm0gYWdhaW5zdCBhIGNvbnNpc3RlbnQgc2V0IG9mIHZhbHVlcy5cbiAgICAgICAgZm9yIChjb25zdCBuIG9mIHRoaXMuYmFzZU11dGF0aW9ucykgbi5rZXkuaXNFcXVhbCh0LmtleSkgJiYgKGUgPSBLcyhuLCB0LCBlLCB0aGlzLmxvY2FsV3JpdGVUaW1lKSk7XG4gICAgICAgIC8vIFNlY29uZCwgYXBwbHkgYWxsIHVzZXItcHJvdmlkZWQgbXV0YXRpb25zLlxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0aGlzLm11dGF0aW9ucykgbi5rZXkuaXNFcXVhbCh0LmtleSkgJiYgKGUgPSBLcyhuLCB0LCBlLCB0aGlzLmxvY2FsV3JpdGVUaW1lKSk7XG4gICAgICAgIHJldHVybiBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21wdXRlcyB0aGUgbG9jYWwgdmlldyBmb3IgYWxsIHByb3ZpZGVkIGRvY3VtZW50cyBnaXZlbiB0aGUgbXV0YXRpb25zIGluXG4gICAgICogdGhpcyBiYXRjaC4gUmV0dXJucyBhIGBEb2N1bWVudEtleWAgdG8gYE11dGF0aW9uYCBtYXAgd2hpY2ggY2FuIGJlIHVzZWQgdG9cbiAgICAgKiByZXBsYWNlIGFsbCB0aGUgbXV0YXRpb24gYXBwbGljYXRpb25zLlxuICAgICAqLyAgICBhcHBseVRvTG9jYWxEb2N1bWVudFNldCh0LCBlKSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogVGhpcyBpbXBsZW1lbnRhdGlvbiBpcyBPKG5eMikuIElmIHdlIGFwcGx5IHRoZSBtdXRhdGlvbnNcbiAgICAgICAgLy8gZGlyZWN0bHkgKGFzIGRvbmUgaW4gYGFwcGx5VG9Mb2NhbFZpZXcoKWApLCB3ZSBjYW4gcmVkdWNlIHRoZSBjb21wbGV4aXR5XG4gICAgICAgIC8vIHRvIE8obikuXG4gICAgICAgIGNvbnN0IG4gPSBkcygpO1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbnMuZm9yRWFjaCgocyA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdC5nZXQocy5rZXkpLCByID0gaS5vdmVybGF5ZWREb2N1bWVudDtcbiAgICAgICAgICAgIC8vIFRPRE8obXV0YWJsZWRvY3VtZW50cyk6IFRoaXMgbWV0aG9kIHNob3VsZCB0YWtlIGEgTXV0YWJsZURvY3VtZW50TWFwXG4gICAgICAgICAgICAvLyBhbmQgd2Ugc2hvdWxkIHJlbW92ZSB0aGlzIGNhc3QuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbyA9IHRoaXMuYXBwbHlUb0xvY2FsVmlldyhyLCBpLm11dGF0ZWRGaWVsZHMpO1xuICAgICAgICAgICAgLy8gU2V0IG11dGF0ZWRGaWVsZHMgdG8gbnVsbCBpZiB0aGUgZG9jdW1lbnQgaXMgb25seSBmcm9tIGxvY2FsIG11dGF0aW9ucy5cbiAgICAgICAgICAgIC8vIFRoaXMgY3JlYXRlcyBhIFNldCBvciBEZWxldGUgbXV0YXRpb24sIGluc3RlYWQgb2YgdHJ5aW5nIHRvIGNyZWF0ZSBhXG4gICAgICAgICAgICAvLyBwYXRjaCBtdXRhdGlvbiBhcyB0aGUgb3ZlcmxheS5cbiAgICAgICAgICAgICAgICAgICAgICAgIG8gPSBlLmhhcyhzLmtleSkgPyBudWxsIDogbztcbiAgICAgICAgICAgIGNvbnN0IHUgPSBxcyhyLCBvKTtcbiAgICAgICAgICAgIG51bGwgIT09IHUgJiYgbi5zZXQocy5rZXksIHUpLCByLmlzVmFsaWREb2N1bWVudCgpIHx8IHIuY29udmVydFRvTm9Eb2N1bWVudChydC5taW4oKSk7XG4gICAgICAgIH0pKSwgbjtcbiAgICB9XG4gICAga2V5cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25zLnJlZHVjZSgoKHQsIGUpID0+IHQuYWRkKGUua2V5KSksIGdzKCkpO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYmF0Y2hJZCA9PT0gdC5iYXRjaElkICYmIG50KHRoaXMubXV0YXRpb25zLCB0Lm11dGF0aW9ucywgKCh0LCBlKSA9PiBRcyh0LCBlKSkpICYmIG50KHRoaXMuYmFzZU11dGF0aW9ucywgdC5iYXNlTXV0YXRpb25zLCAoKHQsIGUpID0+IFFzKHQsIGUpKSk7XG4gICAgfVxufVxuXG4vKiogVGhlIHJlc3VsdCBvZiBhcHBseWluZyBhIG11dGF0aW9uIGJhdGNoIHRvIHRoZSBiYWNrZW5kLiAqLyBjbGFzcyB0aSB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgXG4gICAgLyoqXG4gICAgICogQSBwcmUtY29tcHV0ZWQgbWFwcGluZyBmcm9tIGVhY2ggbXV0YXRlZCBkb2N1bWVudCB0byB0aGUgcmVzdWx0aW5nXG4gICAgICogdmVyc2lvbi5cbiAgICAgKi9cbiAgICBzKSB7XG4gICAgICAgIHRoaXMuYmF0Y2ggPSB0LCB0aGlzLmNvbW1pdFZlcnNpb24gPSBlLCB0aGlzLm11dGF0aW9uUmVzdWx0cyA9IG4sIHRoaXMuZG9jVmVyc2lvbnMgPSBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IE11dGF0aW9uQmF0Y2hSZXN1bHQgZm9yIHRoZSBnaXZlbiBiYXRjaCBhbmQgcmVzdWx0cy4gVGhlcmVcbiAgICAgKiBtdXN0IGJlIG9uZSByZXN1bHQgZm9yIGVhY2ggbXV0YXRpb24gaW4gdGhlIGJhdGNoLiBUaGlzIHN0YXRpYyBmYWN0b3J5XG4gICAgICogY2FjaGVzIGEgZG9jdW1lbnQ9Jmd0O3ZlcnNpb24gbWFwcGluZyAoZG9jVmVyc2lvbnMpLlxuICAgICAqLyAgICBzdGF0aWMgZnJvbSh0LCBlLCBuKSB7XG4gICAgICAgIEYodC5tdXRhdGlvbnMubGVuZ3RoID09PSBuLmxlbmd0aCk7XG4gICAgICAgIGxldCBzID0gd3M7XG4gICAgICAgIGNvbnN0IGkgPSB0Lm11dGF0aW9ucztcbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCBpLmxlbmd0aDsgdCsrKSBzID0gcy5pbnNlcnQoaVt0XS5rZXksIG5bdF0udmVyc2lvbik7XG4gICAgICAgIHJldHVybiBuZXcgdGkodCwgZSwgbiwgcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRhdGlvbiBvZiBhbiBvdmVybGF5IGNvbXB1dGVkIGJ5IEZpcmVzdG9yZS5cbiAqXG4gKiBIb2xkcyBpbmZvcm1hdGlvbiBhYm91dCBhIG11dGF0aW9uIGFuZCB0aGUgbGFyZ2VzdCBiYXRjaCBpZCBpbiBGaXJlc3RvcmUgd2hlblxuICogdGhlIG11dGF0aW9uIHdhcyBjcmVhdGVkLlxuICovIGNsYXNzIGVpIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMubGFyZ2VzdEJhdGNoSWQgPSB0LCB0aGlzLm11dGF0aW9uID0gZTtcbiAgICB9XG4gICAgZ2V0S2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tdXRhdGlvbi5rZXk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdCAmJiB0aGlzLm11dGF0aW9uID09PSB0Lm11dGF0aW9uO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgcmV0dXJuIGBPdmVybGF5e1xcbiAgICAgIGxhcmdlc3RCYXRjaElkOiAke3RoaXMubGFyZ2VzdEJhdGNoSWR9LFxcbiAgICAgIG11dGF0aW9uOiAke3RoaXMubXV0YXRpb24udG9TdHJpbmcoKX1cXG4gICAgfWA7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDb25jcmV0ZSBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgQWdncmVnYXRlIHR5cGUuXG4gKi8gY2xhc3Mgbmkge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5hbGlhcyA9IHQsIHRoaXMuZ3QgPSBlLCB0aGlzLmZpZWxkUGF0aCA9IG47XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBzaSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmNvdW50ID0gdCwgdGhpcy51bmNoYW5nZWROYW1lcyA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBFcnJvciBDb2RlcyBkZXNjcmliaW5nIHRoZSBkaWZmZXJlbnQgd2F5cyBHUlBDIGNhbiBmYWlsLiBUaGVzZSBhcmUgY29waWVkXG4gKiBkaXJlY3RseSBmcm9tIEdSUEMncyBzb3VyY2VzIGhlcmU6XG4gKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2dycGMvZ3JwYy9ibG9iL2JjZWVjOTRlYTRmYzVmMDA4NWQ4MTIzNWQ4ZTFjMDY3OThkYzM0MWEvaW5jbHVkZS9ncnBjJTJCJTJCL2ltcGwvY29kZWdlbi9zdGF0dXNfY29kZV9lbnVtLmhcbiAqXG4gKiBJbXBvcnRhbnQhIFRoZSBuYW1lcyBvZiB0aGVzZSBpZGVudGlmaWVycyBtYXR0ZXIgYmVjYXVzZSB0aGUgc3RyaW5nIGZvcm1zXG4gKiBhcmUgdXNlZCBmb3IgcmV2ZXJzZSBsb29rdXBzIGZyb20gdGhlIHdlYmNoYW5uZWwgc3RyZWFtLiBEbyBOT1QgY2hhbmdlIHRoZVxuICogbmFtZXMgb2YgdGhlc2UgaWRlbnRpZmllcnMgb3IgY2hhbmdlIHRoaXMgaW50byBhIGNvbnN0IGVudW0uXG4gKi8gdmFyIGlpLCByaTtcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZXJyb3IgY29kZSByZXByZXNlbnRzIGEgcGVybWFuZW50IGVycm9yIHdoZW4gcmVjZWl2ZWRcbiAqIGluIHJlc3BvbnNlIHRvIGEgbm9uLXdyaXRlIG9wZXJhdGlvbi5cbiAqXG4gKiBTZWUgaXNQZXJtYW5lbnRXcml0ZUVycm9yIGZvciBjbGFzc2lmeWluZyB3cml0ZSBlcnJvcnMuXG4gKi9cbmZ1bmN0aW9uIG9pKHQpIHtcbiAgICBzd2l0Y2ggKHQpIHtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAkKCk7XG5cbiAgICAgIGNhc2UgcS5DQU5DRUxMRUQ6XG4gICAgICBjYXNlIHEuVU5LTk9XTjpcbiAgICAgIGNhc2UgcS5ERUFETElORV9FWENFRURFRDpcbiAgICAgIGNhc2UgcS5SRVNPVVJDRV9FWEhBVVNURUQ6XG4gICAgICBjYXNlIHEuSU5URVJOQUw6XG4gICAgICBjYXNlIHEuVU5BVkFJTEFCTEU6XG4gLy8gVW5hdXRoZW50aWNhdGVkIG1lYW5zIHNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggb3VyIHRva2VuIGFuZCB3ZSBuZWVkXG4gICAgICAgIC8vIHRvIHJldHJ5IHdpdGggbmV3IGNyZWRlbnRpYWxzIHdoaWNoIHdpbGwgaGFwcGVuIGF1dG9tYXRpY2FsbHkuXG4gICAgICAgICAgICAgIGNhc2UgcS5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiAhMTtcblxuICAgICAgY2FzZSBxLklOVkFMSURfQVJHVU1FTlQ6XG4gICAgICBjYXNlIHEuTk9UX0ZPVU5EOlxuICAgICAgY2FzZSBxLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgY2FzZSBxLlBFUk1JU1NJT05fREVOSUVEOlxuICAgICAgY2FzZSBxLkZBSUxFRF9QUkVDT05ESVRJT046XG4gLy8gQWJvcnRlZCBtaWdodCBiZSByZXRyaWVkIGluIHNvbWUgc2NlbmFyaW9zLCBidXQgdGhhdCBpcyBkZXBlbmRhbnQgb25cbiAgICAgICAgLy8gdGhlIGNvbnRleHQgYW5kIHNob3VsZCBoYW5kbGVkIGluZGl2aWR1YWxseSBieSB0aGUgY2FsbGluZyBjb2RlLlxuICAgICAgICAvLyBTZWUgaHR0cHM6Ly9jbG91ZC5nb29nbGUuY29tL2FwaXMvZGVzaWduL2Vycm9ycy5cbiAgICAgICAgICAgICAgY2FzZSBxLkFCT1JURUQ6XG4gICAgICBjYXNlIHEuT1VUX09GX1JBTkdFOlxuICAgICAgY2FzZSBxLlVOSU1QTEVNRU5URUQ6XG4gICAgICBjYXNlIHEuREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIERldGVybWluZXMgd2hldGhlciBhbiBlcnJvciBjb2RlIHJlcHJlc2VudHMgYSBwZXJtYW5lbnQgZXJyb3Igd2hlbiByZWNlaXZlZFxuICogaW4gcmVzcG9uc2UgdG8gYSB3cml0ZSBvcGVyYXRpb24uXG4gKlxuICogV3JpdGUgb3BlcmF0aW9ucyBtdXN0IGJlIGhhbmRsZWQgc3BlY2lhbGx5IGJlY2F1c2UgYXMgb2YgYi8xMTk0Mzc3NjQsIEFCT1JURURcbiAqIGVycm9ycyBvbiB0aGUgd3JpdGUgc3RyZWFtIHNob3VsZCBiZSByZXRyaWVkIHRvbyAoZXZlbiB0aG91Z2ggQUJPUlRFRCBlcnJvcnNcbiAqIGFyZSBub3QgZ2VuZXJhbGx5IHJldHJ5YWJsZSkuXG4gKlxuICogTm90ZSB0aGF0IGR1cmluZyB0aGUgaW5pdGlhbCBoYW5kc2hha2Ugb24gdGhlIHdyaXRlIHN0cmVhbSBhbiBBQk9SVEVEIGVycm9yXG4gKiBzaWduYWxzIHRoYXQgd2Ugc2hvdWxkIGRpc2NhcmQgb3VyIHN0cmVhbSB0b2tlbiAoaS5lLiBpdCBpcyBwZXJtYW5lbnQpLiBUaGlzXG4gKiBtZWFucyBhIGhhbmRzaGFrZSBlcnJvciBzaG91bGQgYmUgY2xhc3NpZmllZCB3aXRoIGlzUGVybWFuZW50RXJyb3IsIGFib3ZlLlxuICovXG4vKipcbiAqIE1hcHMgYW4gZXJyb3IgQ29kZSBmcm9tIEdSUEMgc3RhdHVzIGNvZGUgbnVtYmVyLCBsaWtlIDAsIDEsIG9yIDE0LiBUaGVzZVxuICogYXJlIG5vdCB0aGUgc2FtZSBhcyBIVFRQIHN0YXR1cyBjb2Rlcy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBHUlBDIHN0YXR1cyBjb2RlLiBGYWlscyBpZiB0aGVyZVxuICogICAgIGlzIG5vIG1hdGNoLlxuICovXG5mdW5jdGlvbiB1aSh0KSB7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCkgXG4gICAgLy8gVGhpcyBzaG91bGRuJ3Qgbm9ybWFsbHkgaGFwcGVuLCBidXQgaW4gY2VydGFpbiBlcnJvciBjYXNlcyAobGlrZSB0cnlpbmdcbiAgICAvLyB0byBzZW5kIGludmFsaWQgcHJvdG8gbWVzc2FnZXMpIHdlIG1heSBnZXQgYW4gZXJyb3Igd2l0aCBubyBHUlBDIGNvZGUuXG4gICAgcmV0dXJuIGsoXCJHUlBDIGVycm9yIGhhcyBubyAuY29kZVwiKSwgcS5VTktOT1dOO1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSBpaS5PSzpcbiAgICAgICAgcmV0dXJuIHEuT0s7XG5cbiAgICAgIGNhc2UgaWkuQ0FOQ0VMTEVEOlxuICAgICAgICByZXR1cm4gcS5DQU5DRUxMRUQ7XG5cbiAgICAgIGNhc2UgaWkuVU5LTk9XTjpcbiAgICAgICAgcmV0dXJuIHEuVU5LTk9XTjtcblxuICAgICAgY2FzZSBpaS5ERUFETElORV9FWENFRURFRDpcbiAgICAgICAgcmV0dXJuIHEuREVBRExJTkVfRVhDRUVERUQ7XG5cbiAgICAgIGNhc2UgaWkuUkVTT1VSQ0VfRVhIQVVTVEVEOlxuICAgICAgICByZXR1cm4gcS5SRVNPVVJDRV9FWEhBVVNURUQ7XG5cbiAgICAgIGNhc2UgaWkuSU5URVJOQUw6XG4gICAgICAgIHJldHVybiBxLklOVEVSTkFMO1xuXG4gICAgICBjYXNlIGlpLlVOQVZBSUxBQkxFOlxuICAgICAgICByZXR1cm4gcS5VTkFWQUlMQUJMRTtcblxuICAgICAgY2FzZSBpaS5VTkFVVEhFTlRJQ0FURUQ6XG4gICAgICAgIHJldHVybiBxLlVOQVVUSEVOVElDQVRFRDtcblxuICAgICAgY2FzZSBpaS5JTlZBTElEX0FSR1VNRU5UOlxuICAgICAgICByZXR1cm4gcS5JTlZBTElEX0FSR1VNRU5UO1xuXG4gICAgICBjYXNlIGlpLk5PVF9GT1VORDpcbiAgICAgICAgcmV0dXJuIHEuTk9UX0ZPVU5EO1xuXG4gICAgICBjYXNlIGlpLkFMUkVBRFlfRVhJU1RTOlxuICAgICAgICByZXR1cm4gcS5BTFJFQURZX0VYSVNUUztcblxuICAgICAgY2FzZSBpaS5QRVJNSVNTSU9OX0RFTklFRDpcbiAgICAgICAgcmV0dXJuIHEuUEVSTUlTU0lPTl9ERU5JRUQ7XG5cbiAgICAgIGNhc2UgaWkuRkFJTEVEX1BSRUNPTkRJVElPTjpcbiAgICAgICAgcmV0dXJuIHEuRkFJTEVEX1BSRUNPTkRJVElPTjtcblxuICAgICAgY2FzZSBpaS5BQk9SVEVEOlxuICAgICAgICByZXR1cm4gcS5BQk9SVEVEO1xuXG4gICAgICBjYXNlIGlpLk9VVF9PRl9SQU5HRTpcbiAgICAgICAgcmV0dXJuIHEuT1VUX09GX1JBTkdFO1xuXG4gICAgICBjYXNlIGlpLlVOSU1QTEVNRU5URUQ6XG4gICAgICAgIHJldHVybiBxLlVOSU1QTEVNRU5URUQ7XG5cbiAgICAgIGNhc2UgaWkuREFUQV9MT1NTOlxuICAgICAgICByZXR1cm4gcS5EQVRBX0xPU1M7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAkKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIENvbnZlcnRzIGFuIEhUVFAgcmVzcG9uc2UncyBlcnJvciBzdGF0dXMgdG8gdGhlIGVxdWl2YWxlbnQgZXJyb3IgY29kZS5cbiAqXG4gKiBAcGFyYW0gc3RhdHVzIC0gQW4gSFRUUCBlcnJvciByZXNwb25zZSBzdGF0dXMgKFwiRkFJTEVEX1BSRUNPTkRJVElPTlwiLFxuICogXCJVTktOT1dOXCIsIGV0Yy4pXG4gKiBAcmV0dXJucyBUaGUgZXF1aXZhbGVudCBDb2RlLiBOb24tbWF0Y2hpbmcgcmVzcG9uc2VzIGFyZSBtYXBwZWQgdG9cbiAqICAgICBDb2RlLlVOS05PV04uXG4gKi8gKHJpID0gaWkgfHwgKGlpID0ge30pKVtyaS5PSyA9IDBdID0gXCJPS1wiLCByaVtyaS5DQU5DRUxMRUQgPSAxXSA9IFwiQ0FOQ0VMTEVEXCIsIFxucmlbcmkuVU5LTk9XTiA9IDJdID0gXCJVTktOT1dOXCIsIHJpW3JpLklOVkFMSURfQVJHVU1FTlQgPSAzXSA9IFwiSU5WQUxJRF9BUkdVTUVOVFwiLCBcbnJpW3JpLkRFQURMSU5FX0VYQ0VFREVEID0gNF0gPSBcIkRFQURMSU5FX0VYQ0VFREVEXCIsIHJpW3JpLk5PVF9GT1VORCA9IDVdID0gXCJOT1RfRk9VTkRcIiwgXG5yaVtyaS5BTFJFQURZX0VYSVNUUyA9IDZdID0gXCJBTFJFQURZX0VYSVNUU1wiLCByaVtyaS5QRVJNSVNTSU9OX0RFTklFRCA9IDddID0gXCJQRVJNSVNTSU9OX0RFTklFRFwiLCBcbnJpW3JpLlVOQVVUSEVOVElDQVRFRCA9IDE2XSA9IFwiVU5BVVRIRU5USUNBVEVEXCIsIHJpW3JpLlJFU09VUkNFX0VYSEFVU1RFRCA9IDhdID0gXCJSRVNPVVJDRV9FWEhBVVNURURcIiwgXG5yaVtyaS5GQUlMRURfUFJFQ09ORElUSU9OID0gOV0gPSBcIkZBSUxFRF9QUkVDT05ESVRJT05cIiwgcmlbcmkuQUJPUlRFRCA9IDEwXSA9IFwiQUJPUlRFRFwiLCBcbnJpW3JpLk9VVF9PRl9SQU5HRSA9IDExXSA9IFwiT1VUX09GX1JBTkdFXCIsIHJpW3JpLlVOSU1QTEVNRU5URUQgPSAxMl0gPSBcIlVOSU1QTEVNRU5URURcIiwgXG5yaVtyaS5JTlRFUk5BTCA9IDEzXSA9IFwiSU5URVJOQUxcIiwgcmlbcmkuVU5BVkFJTEFCTEUgPSAxNF0gPSBcIlVOQVZBSUxBQkxFXCIsIHJpW3JpLkRBVEFfTE9TUyA9IDE1XSA9IFwiREFUQV9MT1NTXCI7XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIE1hbmFnZXMgXCJ0ZXN0aW5nIGhvb2tzXCIsIGhvb2tzIGludG8gdGhlIGludGVybmFscyBvZiB0aGUgU0RLIHRvIHZlcmlmeVxuICogaW50ZXJuYWwgc3RhdGUgYW5kIGV2ZW50cyBkdXJpbmcgaW50ZWdyYXRpb24gdGVzdHMuIERvIG5vdCB1c2UgdGhpcyBjbGFzc1xuICogZXhjZXB0IGZvciB0ZXN0aW5nIHB1cnBvc2VzLlxuICpcbiAqIFRoZXJlIGFyZSB0d28gd2F5cyB0byByZXRyaWV2ZSB0aGUgZ2xvYmFsIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzOlxuICogMS4gVGhlIGBpbnN0YW5jZWAgcHJvcGVydHksIHdoaWNoIHJldHVybnMgbnVsbCBpZiB0aGUgZ2xvYmFsIHNpbmdsZXRvblxuICogICAgICBpbnN0YW5jZSBoYXMgbm90IGJlZW4gY3JlYXRlZC4gVXNlIHRoaXMgcHJvcGVydHkgaWYgdGhlIGNhbGxlciBzaG91bGRcbiAqICAgICAgXCJkbyBub3RoaW5nXCIgaWYgdGhlcmUgYXJlIG5vIHRlc3RpbmcgaG9va3MgcmVnaXN0ZXJlZCwgc3VjaCBhcyB3aGVuXG4gKiAgICAgIGRlbGl2ZXJpbmcgYW4gZXZlbnQgdG8gbm90aWZ5IHJlZ2lzdGVyZWQgY2FsbGJhY2tzLlxuICogMi4gVGhlIGBnZXRPckNyZWF0ZUluc3RhbmNlKClgIG1ldGhvZCwgd2hpY2ggY3JlYXRlcyB0aGUgZ2xvYmFsIHNpbmdsZXRvblxuICogICAgICBpbnN0YW5jZSBpZiBpdCBoYXMgbm90IGJlZW4gY3JlYXRlZC4gVXNlIHRoaXMgbWV0aG9kIGlmIHRoZSBpbnN0YW5jZSBpc1xuICogICAgICBuZWVkZWQgdG8sIGZvciBleGFtcGxlLCByZWdpc3RlciBhIGNhbGxiYWNrLlxuICpcbiAqIEBpbnRlcm5hbFxuICovXG5jbGFzcyBjaSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMub25FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaENhbGxiYWNrcyA9IG5ldyBNYXA7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLCBvciBudWxsIGlmIGl0IGhhcyBub3QgYmVlblxuICAgICAqIGluaXRpYWxpemVkLlxuICAgICAqLyAgICBzdGF0aWMgZ2V0IGluc3RhbmNlKCkge1xuICAgICAgICByZXR1cm4gYWk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHNpbmdsZXRvbiBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzLCBjcmVhdGluZyBpdCBpZiBpcyBoYXMgbmV2ZXJcbiAgICAgKiBiZWVuIGNyZWF0ZWQgYmVmb3JlLlxuICAgICAqLyAgICBzdGF0aWMgZ2V0T3JDcmVhdGVJbnN0YW5jZSgpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgPT09IGFpICYmIChhaSA9IG5ldyBjaSksIGFpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWdpc3RlcnMgYSBjYWxsYmFjayB0byBiZSBub3RpZmllZCB3aGVuIGFuIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2hcbiAgICAgKiBvY2N1cnMgaW4gdGhlIFdhdGNoIGxpc3RlbiBzdHJlYW0uXG4gICAgICpcbiAgICAgKiBUaGUgcmVsYXRpdmUgb3JkZXIgaW4gd2hpY2ggY2FsbGJhY2tzIGFyZSBub3RpZmllZCBpcyB1bnNwZWNpZmllZDsgZG8gbm90XG4gICAgICogcmVseSBvbiBhbnkgcGFydGljdWxhciBvcmRlcmluZy4gSWYgYSBnaXZlbiBjYWxsYmFjayBpcyByZWdpc3RlcmVkIG11bHRpcGxlXG4gICAgICogdGltZXMgdGhlbiBpdCB3aWxsIGJlIG5vdGlmaWVkIG11bHRpcGxlIHRpbWVzLCBvbmNlIHBlciByZWdpc3RyYXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgdGhlIGNhbGxiYWNrIHRvIGludm9rZSB1cG9uIGV4aXN0ZW5jZSBmaWx0ZXIgbWlzbWF0Y2guXG4gICAgICpcbiAgICAgKiBAcmV0dXJuIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsIHVucmVnaXN0ZXJzIHRoZSBnaXZlbiBjYWxsYmFjazsgb25seVxuICAgICAqIHRoZSBmaXJzdCBpbnZvY2F0aW9uIG9mIHRoZSByZXR1cm5lZCBmdW5jdGlvbiBkb2VzIGFueXRoaW5nOyBhbGwgc3Vic2VxdWVudFxuICAgICAqIGludm9jYXRpb25zIGRvIG5vdGhpbmcuXG4gICAgICovICAgIG9uRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2godCkge1xuICAgICAgICBjb25zdCBlID0gU3ltYm9sKCk7XG4gICAgICAgIHJldHVybiB0aGlzLm9uRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hDYWxsYmFja3Muc2V0KGUsIHQpLCAoKSA9PiB0aGlzLm9uRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hDYWxsYmFja3MuZGVsZXRlKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBJbnZva2VzIGFsbCBjdXJyZW50bHktcmVnaXN0ZXJlZCBgb25FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaGAgY2FsbGJhY2tzLlxuICAgICAqIEBwYXJhbSBpbmZvIEluZm9ybWF0aW9uIGFib3V0IHRoZSBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoLlxuICAgICAqLyAgICBub3RpZnlPbkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoKHQpIHtcbiAgICAgICAgdGhpcy5vbkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoQ2FsbGJhY2tzLmZvckVhY2goKGUgPT4gZSh0KSkpO1xuICAgIH1cbn1cblxuLyoqIFRoZSBnbG9iYWwgc2luZ2xldG9uIGluc3RhbmNlIG9mIGBUZXN0aW5nSG9va3NgLiAqLyBsZXQgYWkgPSBudWxsO1xuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbnN0YW5jZSBvZiB0aGUgUGxhdGZvcm0ncyAnVGV4dEVuY29kZXInIGltcGxlbWVudGF0aW9uLlxuICovIGZ1bmN0aW9uIGhpKCkge1xuICAgIHJldHVybiBuZXcgVGV4dEVuY29kZXI7XG59XG5cbi8qKlxuICogQW4gaW5zdGFuY2Ugb2YgdGhlIFBsYXRmb3JtJ3MgJ1RleHREZWNvZGVyJyBpbXBsZW1lbnRhdGlvbi5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNvbnN0IGxpID0gbmV3IEludGVnZXIoWyA0Mjk0OTY3Mjk1LCA0Mjk0OTY3Mjk1IF0sIDApO1xuXG4vLyBIYXNoIGEgc3RyaW5nIHVzaW5nIG1kNSBoYXNoaW5nIGFsZ29yaXRobS5cbmZ1bmN0aW9uIGZpKHQpIHtcbiAgICBjb25zdCBlID0gaGkoKS5lbmNvZGUodCksIG4gPSBuZXcgTWQ1O1xuICAgIHJldHVybiBuLnVwZGF0ZShlKSwgbmV3IFVpbnQ4QXJyYXkobi5kaWdlc3QoKSk7XG59XG5cbi8vIEludGVycHJldCB0aGUgMTYgYnl0ZXMgYXJyYXkgYXMgdHdvIDY0LWJpdCB1bnNpZ25lZCBpbnRlZ2VycywgZW5jb2RlZCB1c2luZ1xuLy8gMuKAmXMgY29tcGxlbWVudCB1c2luZyBsaXR0bGUgZW5kaWFuLlxuZnVuY3Rpb24gZGkodCkge1xuICAgIGNvbnN0IGUgPSBuZXcgRGF0YVZpZXcodC5idWZmZXIpLCBuID0gZS5nZXRVaW50MzIoMCwgLyogbGl0dGxlRW5kaWFuPSAqLyAhMCksIHMgPSBlLmdldFVpbnQzMig0LCAvKiBsaXR0bGVFbmRpYW49ICovICEwKSwgaSA9IGUuZ2V0VWludDMyKDgsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITApLCByID0gZS5nZXRVaW50MzIoMTIsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITApO1xuICAgIHJldHVybiBbIG5ldyBJbnRlZ2VyKFsgbiwgcyBdLCAwKSwgbmV3IEludGVnZXIoWyBpLCByIF0sIDApIF07XG59XG5cbmNsYXNzIF9pIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIGlmICh0aGlzLmJpdG1hcCA9IHQsIHRoaXMucGFkZGluZyA9IGUsIHRoaXMuaGFzaENvdW50ID0gbiwgZSA8IDAgfHwgZSA+PSA4KSB0aHJvdyBuZXcgd2koYEludmFsaWQgcGFkZGluZzogJHtlfWApO1xuICAgICAgICBpZiAobiA8IDApIHRocm93IG5ldyB3aShgSW52YWxpZCBoYXNoIGNvdW50OiAke259YCk7XG4gICAgICAgIGlmICh0Lmxlbmd0aCA+IDAgJiYgMCA9PT0gdGhpcy5oYXNoQ291bnQpIFxuICAgICAgICAvLyBPbmx5IGVtcHR5IGJsb29tIGZpbHRlciBjYW4gaGF2ZSAwIGhhc2ggY291bnQuXG4gICAgICAgIHRocm93IG5ldyB3aShgSW52YWxpZCBoYXNoIGNvdW50OiAke259YCk7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCAmJiAwICE9PSBlKSBcbiAgICAgICAgLy8gRW1wdHkgYmxvb20gZmlsdGVyIHNob3VsZCBoYXZlIDAgcGFkZGluZy5cbiAgICAgICAgdGhyb3cgbmV3IHdpKGBJbnZhbGlkIHBhZGRpbmcgd2hlbiBiaXRtYXAgbGVuZ3RoIGlzIDA6ICR7ZX1gKTtcbiAgICAgICAgdGhpcy55dCA9IDggKiB0Lmxlbmd0aCAtIGUsIFxuICAgICAgICAvLyBTZXQgdGhlIGJpdCBjb3VudCBpbiBJbnRlZ2VyIHRvIGF2b2lkIHJlcGV0aXRpb24gaW4gbWlnaHRDb250YWluKCkuXG4gICAgICAgIHRoaXMuSXQgPSBJbnRlZ2VyLmZyb21OdW1iZXIodGhpcy55dCk7XG4gICAgfVxuICAgIC8vIENhbGN1bGF0ZSB0aGUgaXRoIGhhc2ggdmFsdWUgYmFzZWQgb24gdGhlIGhhc2hlZCA2NGJpdCBpbnRlZ2VycyxcbiAgICAvLyBhbmQgY2FsY3VsYXRlIGl0cyBjb3JyZXNwb25kaW5nIGJpdCBpbmRleCBpbiB0aGUgYml0bWFwIHRvIGJlIGNoZWNrZWQuXG4gICAgVHQodCwgZSwgbikge1xuICAgICAgICAvLyBDYWxjdWxhdGUgaGFzaGVkIHZhbHVlIGgoaSkgPSBoMSArIChpICogaDIpLlxuICAgICAgICBsZXQgcyA9IHQuYWRkKGUubXVsdGlwbHkoSW50ZWdlci5mcm9tTnVtYmVyKG4pKSk7XG4gICAgICAgIC8vIFdyYXAgaWYgaGFzaCB2YWx1ZSBvdmVyZmxvdyA2NGJpdC5cbiAgICAgICAgICAgICAgICByZXR1cm4gMSA9PT0gcy5jb21wYXJlKGxpKSAmJiAocyA9IG5ldyBJbnRlZ2VyKFsgcy5nZXRCaXRzKDApLCBzLmdldEJpdHMoMSkgXSwgMCkpLCBcbiAgICAgICAgcy5tb2R1bG8odGhpcy5JdCkudG9OdW1iZXIoKTtcbiAgICB9XG4gICAgLy8gUmV0dXJuIHdoZXRoZXIgdGhlIGJpdCBvbiB0aGUgZ2l2ZW4gaW5kZXggaW4gdGhlIGJpdG1hcCBpcyBzZXQgdG8gMS5cbiAgICBFdCh0KSB7XG4gICAgICAgIHJldHVybiAwICE9ICh0aGlzLmJpdG1hcFtNYXRoLmZsb29yKHQgLyA4KV0gJiAxIDw8IHQgJSA4KTtcbiAgICB9XG4gICAgQXQodCkge1xuICAgICAgICAvLyBFbXB0eSBiaXRtYXAgc2hvdWxkIGFsd2F5cyByZXR1cm4gZmFsc2Ugb24gbWVtYmVyc2hpcCBjaGVjay5cbiAgICAgICAgaWYgKDAgPT09IHRoaXMueXQpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IGZpKHQpLCBbbiwgc10gPSBkaShlKTtcbiAgICAgICAgZm9yIChsZXQgdCA9IDA7IHQgPCB0aGlzLmhhc2hDb3VudDsgdCsrKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5UdChuLCBzLCB0KTtcbiAgICAgICAgICAgIGlmICghdGhpcy5FdChlKSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgLyoqIENyZWF0ZSBibG9vbSBmaWx0ZXIgZm9yIHRlc3RpbmcgcHVycG9zZXMgb25seS4gKi8gICAgc3RhdGljIGNyZWF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0ICUgOCA9PSAwID8gMCA6IDggLSB0ICUgOCwgaSA9IG5ldyBVaW50OEFycmF5KE1hdGguY2VpbCh0IC8gOCkpLCByID0gbmV3IF9pKGksIHMsIGUpO1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKCh0ID0+IHIuaW5zZXJ0KHQpKSksIHI7XG4gICAgfVxuICAgIGluc2VydCh0KSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLnl0KSByZXR1cm47XG4gICAgICAgIGNvbnN0IGUgPSBmaSh0KSwgW24sIHNdID0gZGkoZSk7XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgdGhpcy5oYXNoQ291bnQ7IHQrKykge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuVHQobiwgcywgdCk7XG4gICAgICAgICAgICB0aGlzLlJ0KGUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFJ0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IE1hdGguZmxvb3IodCAvIDgpLCBuID0gdCAlIDg7XG4gICAgICAgIHRoaXMuYml0bWFwW2VdIHw9IDEgPDwgbjtcbiAgICB9XG59XG5cbmNsYXNzIHdpIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlciguLi5hcmd1bWVudHMpLCB0aGlzLm5hbWUgPSBcIkJsb29tRmlsdGVyRXJyb3JcIjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGV2ZW50IGZyb20gdGhlIFJlbW90ZVN0b3JlLiBJdCBpcyBzcGxpdCBpbnRvIHRhcmdldENoYW5nZXMgKGNoYW5nZXMgdG8gdGhlXG4gKiBzdGF0ZSBvciB0aGUgc2V0IG9mIGRvY3VtZW50cyBpbiBvdXIgd2F0Y2hlZCB0YXJnZXRzKSBhbmQgZG9jdW1lbnRVcGRhdGVzXG4gKiAoY2hhbmdlcyB0byB0aGUgYWN0dWFsIGRvY3VtZW50cykuXG4gKi8gY2xhc3MgbWkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBzbmFwc2hvdCB2ZXJzaW9uIHRoaXMgZXZlbnQgYnJpbmdzIHVzIHVwIHRvLCBvciBNSU4gaWYgbm90IHNldC5cbiAgICAgKi9cbiAgICB0LCBcbiAgICAvKipcbiAgICAgKiBBIG1hcCBmcm9tIHRhcmdldCB0byBjaGFuZ2VzIHRvIHRoZSB0YXJnZXQuIFNlZSBUYXJnZXRDaGFuZ2UuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQSBtYXAgb2YgdGFyZ2V0cyB0aGF0IGlzIGtub3duIHRvIGJlIGluY29uc2lzdGVudCwgYW5kIHRoZSBwdXJwb3NlIGZvclxuICAgICAqIHJlLWxpc3RlbmluZy4gTGlzdGVucyBmb3IgdGhlc2UgdGFyZ2V0cyBzaG91bGQgYmUgcmUtZXN0YWJsaXNoZWQgd2l0aG91dFxuICAgICAqIHJlc3VtZSB0b2tlbnMuXG4gICAgICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogQSBzZXQgb2Ygd2hpY2ggZG9jdW1lbnRzIGhhdmUgY2hhbmdlZCBvciBiZWVuIGRlbGV0ZWQsIGFsb25nIHdpdGggdGhlXG4gICAgICogZG9jJ3MgbmV3IHZhbHVlcyAoaWYgbm90IGRlbGV0ZWQpLlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIEEgc2V0IG9mIHdoaWNoIGRvY3VtZW50IHVwZGF0ZXMgYXJlIGR1ZSBvbmx5IHRvIGxpbWJvIHJlc29sdXRpb24gdGFyZ2V0cy5cbiAgICAgKi9cbiAgICBpKSB7XG4gICAgICAgIHRoaXMuc25hcHNob3RWZXJzaW9uID0gdCwgdGhpcy50YXJnZXRDaGFuZ2VzID0gZSwgdGhpcy50YXJnZXRNaXNtYXRjaGVzID0gbiwgdGhpcy5kb2N1bWVudFVwZGF0ZXMgPSBzLCBcbiAgICAgICAgdGhpcy5yZXNvbHZlZExpbWJvRG9jdW1lbnRzID0gaTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSEFDSzogVmlld3MgcmVxdWlyZSBSZW1vdGVFdmVudHMgaW4gb3JkZXIgdG8gZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHZpZXcgaXNcbiAgICAgKiBDVVJSRU5ULCBidXQgc2Vjb25kYXJ5IHRhYnMgZG9uJ3QgcmVjZWl2ZSByZW1vdGUgZXZlbnRzLiBTbyB0aGlzIG1ldGhvZCBpc1xuICAgICAqIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnQgdGhhdCBjYW4gYmUgdXNlZCB0byBhcHBseSBhXG4gICAgICogQ1VSUkVOVCBzdGF0dXMgY2hhbmdlIHRvIGEgVmlldywgZm9yIHF1ZXJpZXMgZXhlY3V0ZWQgaW4gYSBkaWZmZXJlbnQgdGFiLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBzdGF0aWMgY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIHMuc2V0KHQsIGdpLmNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlLCBuKSksIG5ldyBtaShydC5taW4oKSwgcywgbmV3IHBlKGV0KSwgY3MoKSwgZ3MoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgVGFyZ2V0Q2hhbmdlIHNwZWNpZmllcyB0aGUgc2V0IG9mIGNoYW5nZXMgZm9yIGEgc3BlY2lmaWMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAqIGEgUmVtb3RlRXZlbnQuIFRoZXNlIGNoYW5nZXMgdHJhY2sgd2hpY2ggZG9jdW1lbnRzIGFyZSBhZGRlZCwgbW9kaWZpZWQgb3JcbiAqIHJlbW92ZWQsIGFzIHdlbGwgYXMgdGhlIHRhcmdldCdzIHJlc3VtZSB0b2tlbiBhbmQgd2hldGhlciB0aGUgdGFyZ2V0IGlzXG4gKiBtYXJrZWQgQ1VSUkVOVC5cbiAqIFRoZSBhY3R1YWwgY2hhbmdlcyAqdG8qIGRvY3VtZW50cyBhcmUgbm90IHBhcnQgb2YgdGhlIFRhcmdldENoYW5nZSBzaW5jZVxuICogZG9jdW1lbnRzIG1heSBiZSBwYXJ0IG9mIG11bHRpcGxlIHRhcmdldHMuXG4gKi8gY2xhc3MgZ2kge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIEFuIG9wYXF1ZSwgc2VydmVyLWFzc2lnbmVkIHRva2VuIHRoYXQgYWxsb3dzIHdhdGNoaW5nIGEgcXVlcnkgdG8gYmUgcmVzdW1lZFxuICAgICAqIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdCBtYXRjaGVzIHRoZVxuICAgICAqIHF1ZXJ5LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpbiB0aW1lIGZyb20gd2hpY2hcbiAgICAgKiB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSBcImN1cnJlbnRcIiAoc3luY2VkKSBzdGF0dXMgb2YgdGhpcyB0YXJnZXQuIE5vdGUgdGhhdCBcImN1cnJlbnRcIlxuICAgICAqIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbCB0aGF0IGltcGxpZXMgdGhhdCBhIHRhcmdldCBpc1xuICAgICAqIGJvdGggdXAtdG8tZGF0ZSBhbmQgY29uc2lzdGVudCB3aXRoIHRoZSByZXN0IG9mIHRoZSB3YXRjaCBzdHJlYW0uXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHNldCBvZiBkb2N1bWVudHMgdGhhdCB3ZXJlIG5ld2x5IGFzc2lnbmVkIHRvIHRoaXMgdGFyZ2V0IGFzIHBhcnQgb2ZcbiAgICAgKiB0aGlzIHJlbW90ZSBldmVudC5cbiAgICAgKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2V0IG9mIGRvY3VtZW50cyB0aGF0IHdlcmUgYWxyZWFkeSBhc3NpZ25lZCB0byB0aGlzIHRhcmdldCBidXQgcmVjZWl2ZWRcbiAgICAgKiBhbiB1cGRhdGUgZHVyaW5nIHRoaXMgcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgd2VyZSByZW1vdmVkIGZyb20gdGhpcyB0YXJnZXQgYXMgcGFydCBvZiB0aGlzXG4gICAgICogcmVtb3RlIGV2ZW50LlxuICAgICAqL1xuICAgIGkpIHtcbiAgICAgICAgdGhpcy5yZXN1bWVUb2tlbiA9IHQsIHRoaXMuY3VycmVudCA9IGUsIHRoaXMuYWRkZWREb2N1bWVudHMgPSBuLCB0aGlzLm1vZGlmaWVkRG9jdW1lbnRzID0gcywgXG4gICAgICAgIHRoaXMucmVtb3ZlZERvY3VtZW50cyA9IGk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoaXMgbWV0aG9kIGlzIHVzZWQgdG8gY3JlYXRlIGEgc3ludGhlc2l6ZWQgVGFyZ2V0Q2hhbmdlcyB0aGF0IGNhbiBiZSB1c2VkIHRvXG4gICAgICogYXBwbHkgYSBDVVJSRU5UIHN0YXR1cyBjaGFuZ2UgdG8gYSBWaWV3IChmb3IgcXVlcmllcyBleGVjdXRlZCBpbiBhIGRpZmZlcmVudFxuICAgICAqIHRhYikgb3IgZm9yIG5ldyBxdWVyaWVzICh0byByYWlzZSBzbmFwc2hvdHMgd2l0aCBjb3JyZWN0IENVUlJFTlQgc3RhdHVzKS5cbiAgICAgKi8gICAgc3RhdGljIGNyZWF0ZVN5bnRoZXNpemVkVGFyZ2V0Q2hhbmdlRm9yQ3VycmVudENoYW5nZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgZ2kobiwgZSwgZ3MoKSwgZ3MoKSwgZ3MoKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXByZXNlbnRzIGEgY2hhbmdlZCBkb2N1bWVudCBhbmQgYSBsaXN0IG9mIHRhcmdldCBpZHMgdG8gd2hpY2ggdGhpcyBjaGFuZ2VcbiAqIGFwcGxpZXMuXG4gKlxuICogSWYgZG9jdW1lbnQgaGFzIGJlZW4gZGVsZXRlZCBOb0RvY3VtZW50IHdpbGwgYmUgcHJvdmlkZWQuXG4gKi8gY2xhc3MgeWkge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgbmV3IGRvY3VtZW50IGFwcGxpZXMgdG8gYWxsIG9mIHRoZXNlIHRhcmdldHMuICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBuZXcgZG9jdW1lbnQgaXMgcmVtb3ZlZCBmcm9tIGFsbCBvZiB0aGVzZSB0YXJnZXRzLiAqL1xuICAgIGUsIFxuICAgIC8qKiBUaGUga2V5IG9mIHRoZSBkb2N1bWVudCBmb3IgdGhpcyBjaGFuZ2UuICovXG4gICAgbiwgXG4gICAgLyoqXG4gICAgICogVGhlIG5ldyBkb2N1bWVudCBvciBOb0RvY3VtZW50IGlmIGl0IHdhcyBkZWxldGVkLiBJcyBudWxsIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IHdlbnQgb3V0IG9mIHZpZXcgd2l0aG91dCB0aGUgc2VydmVyIHNlbmRpbmcgYSBuZXcgZG9jdW1lbnQuXG4gICAgICovXG4gICAgcykge1xuICAgICAgICB0aGlzLnZ0ID0gdCwgdGhpcy5yZW1vdmVkVGFyZ2V0SWRzID0gZSwgdGhpcy5rZXkgPSBuLCB0aGlzLlB0ID0gcztcbiAgICB9XG59XG5cbmNsYXNzIHBpIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLmJ0ID0gZTtcbiAgICB9XG59XG5cbmNsYXNzIElpIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogV2hhdCBraW5kIG9mIGNoYW5nZSBvY2N1cnJlZCB0byB0aGUgd2F0Y2ggdGFyZ2V0LiAqL1xuICAgIHQsIFxuICAgIC8qKiBUaGUgdGFyZ2V0IElEcyB0aGF0IHdlcmUgYWRkZWQvcmVtb3ZlZC9zZXQuICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogQW4gb3BhcXVlLCBzZXJ2ZXItYXNzaWduZWQgdG9rZW4gdGhhdCBhbGxvd3Mgd2F0Y2hpbmcgYSB0YXJnZXQgdG8gYmVcbiAgICAgKiByZXN1bWVkIGFmdGVyIGRpc2Nvbm5lY3Rpbmcgd2l0aG91dCByZXRyYW5zbWl0dGluZyBhbGwgdGhlIGRhdGEgdGhhdFxuICAgICAqIG1hdGNoZXMgdGhlIHRhcmdldC4gVGhlIHJlc3VtZSB0b2tlbiBlc3NlbnRpYWxseSBpZGVudGlmaWVzIGEgcG9pbnQgaW5cbiAgICAgKiB0aW1lIGZyb20gd2hpY2ggdGhlIHNlcnZlciBzaG91bGQgcmVzdW1lIHNlbmRpbmcgcmVzdWx0cy5cbiAgICAgKi9cbiAgICBuID0gVmUuRU1QVFlfQllURV9TVFJJTkdcbiAgICAvKiogQW4gUlBDIGVycm9yIGluZGljYXRpbmcgd2h5IHRoZSB3YXRjaCBmYWlsZWQuICovICwgcyA9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHQsIHRoaXMudGFyZ2V0SWRzID0gZSwgdGhpcy5yZXN1bWVUb2tlbiA9IG4sIHRoaXMuY2F1c2UgPSBzO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyB0aGUgaW50ZXJuYWwgc3RhdGUgb2YgYSBXYXRjaCB0YXJnZXQuICovIGNsYXNzIFRpIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFRoZSBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgKGFkZHMgb3IgcmVtb3ZlcykgdGhhdCB3ZSBhcmUgd2FpdGluZyBvbi5cbiAgICAgICAgICogV2Ugb25seSBjb25zaWRlciB0YXJnZXRzIGFjdGl2ZSB0aGF0IGhhdmUgbm8gcGVuZGluZyByZXNwb25zZXMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlZ0ID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnQgY2hhbmdlcyBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoZXNlIGNoYW5nZXMgYXJlIGNvbnRpbnVvdXNseSB1cGRhdGVkIGFzIHdlIHJlY2VpdmUgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgICAgICogYWx3YXlzIHJlZmxlY3QgdGhlIGN1cnJlbnQgc2V0IG9mIGNoYW5nZXMgYWdhaW5zdCB0aGUgbGFzdCBpc3N1ZWQgc25hcHNob3QuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlN0ID0gUmkoKSwgXG4gICAgICAgIC8qKiBTZWUgcHVibGljIGdldHRlcnMgZm9yIGV4cGxhbmF0aW9ucyBvZiB0aGVzZSBmaWVsZHMuICovXG4gICAgICAgIHRoaXMuRHQgPSBWZS5FTVBUWV9CWVRFX1NUUklORywgdGhpcy5DdCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhpcyB0YXJnZXQgc3RhdGUgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZSBuZXh0IHNuYXBzaG90LiBXZVxuICAgICAgICAgKiBpbml0aWFsaXplIHRvIHRydWUgc28gdGhhdCBuZXdseS1hZGRlZCB0YXJnZXRzIGFyZSBpbmNsdWRlZCBpbiB0aGUgbmV4dFxuICAgICAgICAgKiBSZW1vdGVFdmVudC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMueHQgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGlzIHRhcmdldCBoYXMgYmVlbiBtYXJrZWQgJ2N1cnJlbnQnLlxuICAgICAqXG4gICAgICogJ0N1cnJlbnQnIGhhcyBzcGVjaWFsIG1lYW5pbmcgaW4gdGhlIFJQQyBwcm90b2NvbDogSXQgaW1wbGllcyB0aGF0IHRoZVxuICAgICAqIFdhdGNoIGJhY2tlbmQgaGFzIHNlbnQgdXMgYWxsIGNoYW5nZXMgdXAgdG8gdGhlIHBvaW50IGF0IHdoaWNoIHRoZSB0YXJnZXRcbiAgICAgKiB3YXMgYWRkZWQgYW5kIHRoYXQgdGhlIHRhcmdldCBpcyBjb25zaXN0ZW50IHdpdGggdGhlIHJlc3Qgb2YgdGhlIHdhdGNoXG4gICAgICogc3RyZWFtLlxuICAgICAqLyAgICBnZXQgY3VycmVudCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ3Q7XG4gICAgfVxuICAgIC8qKiBUaGUgbGFzdCByZXN1bWUgdG9rZW4gc2VudCB0byB1cyBmb3IgdGhpcyB0YXJnZXQuICovICAgIGdldCByZXN1bWVUb2tlbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRHQ7XG4gICAgfVxuICAgIC8qKiBXaGV0aGVyIHRoaXMgdGFyZ2V0IGhhcyBwZW5kaW5nIHRhcmdldCBhZGRzIG9yIHRhcmdldCByZW1vdmVzLiAqLyAgICBnZXQgTnQoKSB7XG4gICAgICAgIHJldHVybiAwICE9PSB0aGlzLlZ0O1xuICAgIH1cbiAgICAvKiogV2hldGhlciB3ZSBoYXZlIG1vZGlmaWVkIGFueSBzdGF0ZSB0aGF0IHNob3VsZCB0cmlnZ2VyIGEgc25hcHNob3QuICovICAgIGdldCBrdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMueHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFwcGxpZXMgdGhlIHJlc3VtZSB0b2tlbiB0byB0aGUgVGFyZ2V0Q2hhbmdlLCBidXQgb25seSB3aGVuIGl0IGhhcyBhIG5ld1xuICAgICAqIHZhbHVlLiBFbXB0eSByZXN1bWVUb2tlbnMgYXJlIGRpc2NhcmRlZC5cbiAgICAgKi8gICAgTXQodCkge1xuICAgICAgICB0LmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgJiYgKHRoaXMueHQgPSAhMCwgdGhpcy5EdCA9IHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgdGFyZ2V0IGNoYW5nZSBmcm9tIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogVG8gcmVzZXQgdGhlIGRvY3VtZW50IGNoYW5nZXMgYWZ0ZXIgcmFpc2luZyB0aGlzIHNuYXBzaG90LCBjYWxsXG4gICAgICogYGNsZWFyUGVuZGluZ0NoYW5nZXMoKWAuXG4gICAgICovICAgIE90KCkge1xuICAgICAgICBsZXQgdCA9IGdzKCksIGUgPSBncygpLCBuID0gZ3MoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuU3QuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIHN3aXRjaCAoaSkge1xuICAgICAgICAgICAgICBjYXNlIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgdCA9IHQuYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICBlID0gZS5hZGQocyk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICAgICAgbiA9IG4uYWRkKHMpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgJCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIG5ldyBnaSh0aGlzLkR0LCB0aGlzLkN0LCB0LCBlLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBkb2N1bWVudCBjaGFuZ2VzIGFuZCBzZXRzIGBoYXNQZW5kaW5nQ2hhbmdlc2AgdG8gZmFsc2UuXG4gICAgICovICAgICR0KCkge1xuICAgICAgICB0aGlzLnh0ID0gITEsIHRoaXMuU3QgPSBSaSgpO1xuICAgIH1cbiAgICBGdCh0LCBlKSB7XG4gICAgICAgIHRoaXMueHQgPSAhMCwgdGhpcy5TdCA9IHRoaXMuU3QuaW5zZXJ0KHQsIGUpO1xuICAgIH1cbiAgICBCdCh0KSB7XG4gICAgICAgIHRoaXMueHQgPSAhMCwgdGhpcy5TdCA9IHRoaXMuU3QucmVtb3ZlKHQpO1xuICAgIH1cbiAgICBMdCgpIHtcbiAgICAgICAgdGhpcy5WdCArPSAxO1xuICAgIH1cbiAgICBxdCgpIHtcbiAgICAgICAgdGhpcy5WdCAtPSAxO1xuICAgIH1cbiAgICBVdCgpIHtcbiAgICAgICAgdGhpcy54dCA9ICEwLCB0aGlzLkN0ID0gITA7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgaGVscGVyIGNsYXNzIHRvIGFjY3VtdWxhdGUgd2F0Y2ggY2hhbmdlcyBpbnRvIGEgUmVtb3RlRXZlbnQuXG4gKi9cbmNsYXNzIEVpIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuS3QgPSB0LCBcbiAgICAgICAgLyoqIFRoZSBpbnRlcm5hbCBzdGF0ZSBvZiBhbGwgdHJhY2tlZCB0YXJnZXRzLiAqL1xuICAgICAgICB0aGlzLkd0ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKiBLZWVwcyB0cmFjayBvZiB0aGUgZG9jdW1lbnRzIHRvIHVwZGF0ZSBzaW5jZSB0aGUgbGFzdCByYWlzZWQgc25hcHNob3QuICovXG4gICAgICAgIHRoaXMuUXQgPSBjcygpLCBcbiAgICAgICAgLyoqIEEgbWFwcGluZyBvZiBkb2N1bWVudCBrZXlzIHRvIHRoZWlyIHNldCBvZiB0YXJnZXQgSURzLiAqL1xuICAgICAgICB0aGlzLmp0ID0gQWkoKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcCBvZiB0YXJnZXRzIHdpdGggZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLiBUaGVzZSB0YXJnZXRzIGFyZVxuICAgICAgICAgKiBrbm93biB0byBiZSBpbmNvbnNpc3RlbnQgYW5kIHRoZWlyIGxpc3RlbnMgbmVlZHMgdG8gYmUgcmUtZXN0YWJsaXNoZWQgYnlcbiAgICAgICAgICogUmVtb3RlU3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnp0ID0gbmV3IHBlKGV0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBEb2N1bWVudFdhdGNoQ2hhbmdlIHRvIHRoZSBjdXJyZW50IHNldCBvZiBjaGFuZ2VzLlxuICAgICAqLyAgICBXdCh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0LnZ0KSB0LlB0ICYmIHQuUHQuaXNGb3VuZERvY3VtZW50KCkgPyB0aGlzLkh0KGUsIHQuUHQpIDogdGhpcy5KdChlLCB0LmtleSwgdC5QdCk7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0LnJlbW92ZWRUYXJnZXRJZHMpIHRoaXMuSnQoZSwgdC5rZXksIHQuUHQpO1xuICAgIH1cbiAgICAvKiogUHJvY2Vzc2VzIGFuZCBhZGRzIHRoZSBXYXRjaFRhcmdldENoYW5nZSB0byB0aGUgY3VycmVudCBzZXQgb2YgY2hhbmdlcy4gKi8gICAgWXQodCkge1xuICAgICAgICB0aGlzLmZvckVhY2hUYXJnZXQodCwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMuWHQoZSk7XG4gICAgICAgICAgICBzd2l0Y2ggKHQuc3RhdGUpIHtcbiAgICAgICAgICAgICAgY2FzZSAwIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuTm9DaGFuZ2UgKi8gOlxuICAgICAgICAgICAgICAgIHRoaXMuWnQoZSkgJiYgbi5NdCh0LnJlc3VtZVRva2VuKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDEgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5BZGRlZCAqLyA6XG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcbiAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cbiAgICAgICAgICAgICAgICBuLnF0KCksIG4uTnQgfHwgXG4gICAgICAgICAgICAgICAgLy8gV2UgaGF2ZSBhIGZyZXNobHkgYWRkZWQgdGFyZ2V0LCBzbyB3ZSBuZWVkIHRvIHJlc2V0IGFueSBzdGF0ZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgd2UgaGFkIHByZXZpb3VzbHkuIFRoaXMgY2FuIGhhcHBlbiBlLmcuIHdoZW4gcmVtb3ZlIGFuZCBhZGRcbiAgICAgICAgICAgICAgICAvLyBiYWNrIGEgdGFyZ2V0IGZvciBleGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoZXMuXG4gICAgICAgICAgICAgICAgbi4kdCgpLCBuLk10KHQucmVzdW1lVG9rZW4pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8ga2VlcCB0cmFjayBvZiByZW1vdmVkIHRhcmdldHMgdG8gd2UgY2FuIHBvc3QtZmlsdGVyIGFuZFxuICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbnkgdGFyZ2V0IGNoYW5nZXMuXG4gICAgICAgICAgICAgICAgLy8gV2UgbmVlZCB0byBkZWNyZW1lbnQgdGhlIG51bWJlciBvZiBwZW5kaW5nIGFja3MgbmVlZGVkIGZyb20gd2F0Y2hcbiAgICAgICAgICAgICAgICAvLyBmb3IgdGhpcyB0YXJnZXRJZC5cbiAgICAgICAgICAgICAgICBuLnF0KCksIG4uTnQgfHwgdGhpcy5yZW1vdmVUYXJnZXQoZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgY2FzZSAzIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQ3VycmVudCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5adChlKSAmJiAobi5VdCgpLCBuLk10KHQucmVzdW1lVG9rZW4pKTtcbiAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICBjYXNlIDQgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5SZXNldCAqLyA6XG4gICAgICAgICAgICAgICAgdGhpcy5adChlKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgdGhlIHRhcmdldCBhbmQgc3ludGhlc2l6ZXMgcmVtb3ZlcyBmb3IgYWxsIGV4aXN0aW5nXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzLiBUaGUgYmFja2VuZCB3aWxsIHJlLWFkZCBhbnkgZG9jdW1lbnRzIHRoYXQgc3RpbGxcbiAgICAgICAgICAgICAgICAvLyBtYXRjaCB0aGUgdGFyZ2V0IGJlZm9yZSBpdCBzZW5kcyB0aGUgbmV4dCBnbG9iYWwgc25hcHNob3QuXG4gICAgICAgICAgICAgICAgdGhpcy50ZShlKSwgbi5NdCh0LnJlc3VtZVRva2VuKSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhbGwgdGFyZ2V0SWRzIHRoYXQgdGhlIHdhdGNoIGNoYW5nZSBhcHBsaWVzIHRvOiBlaXRoZXIgdGhlXG4gICAgICogdGFyZ2V0SWRzIGV4cGxpY2l0bHkgbGlzdGVkIGluIHRoZSBjaGFuZ2Ugb3IgdGhlIHRhcmdldElkcyBvZiBhbGwgY3VycmVudGx5XG4gICAgICogYWN0aXZlIHRhcmdldHMuXG4gICAgICovICAgIGZvckVhY2hUYXJnZXQodCwgZSkge1xuICAgICAgICB0LnRhcmdldElkcy5sZW5ndGggPiAwID8gdC50YXJnZXRJZHMuZm9yRWFjaChlKSA6IHRoaXMuR3QuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgIHRoaXMuWnQobikgJiYgZShuKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBIYW5kbGVzIGV4aXN0ZW5jZSBmaWx0ZXJzIGFuZCBzeW50aGVzaXplcyBkZWxldGVzIGZvciBmaWx0ZXIgbWlzbWF0Y2hlcy5cbiAgICAgKiBUYXJnZXRzIHRoYXQgYXJlIGludmFsaWRhdGVkIGJ5IGZpbHRlciBtaXNtYXRjaGVzIGFyZSBhZGRlZCB0b1xuICAgICAqIGBwZW5kaW5nVGFyZ2V0UmVzZXRzYC5cbiAgICAgKi8gICAgZWUodCkge1xuICAgICAgICB2YXIgZTtcbiAgICAgICAgY29uc3QgbiA9IHQudGFyZ2V0SWQsIHMgPSB0LmJ0LmNvdW50LCBpID0gdGhpcy5uZShuKTtcbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBpLnRhcmdldDtcbiAgICAgICAgICAgIGlmIChGbihyKSkgaWYgKDAgPT09IHMpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgZXhpc3RlbmNlIGZpbHRlciB0b2xkIHVzIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBleGlzdC4gV2UgZGVkdWNlXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB0aGlzIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0IGFuZCBhcHBseSBhIGRlbGV0ZWQgZG9jdW1lbnQgdG9cbiAgICAgICAgICAgICAgICAvLyBvdXIgdXBkYXRlcy4gV2l0aG91dCBhcHBseWluZyB0aGlzIGRlbGV0ZWQgZG9jdW1lbnQgdGhlcmUgbWlnaHQgYmVcbiAgICAgICAgICAgICAgICAvLyBhbm90aGVyIHF1ZXJ5IHRoYXQgd2lsbCByYWlzZSB0aGlzIGRvY3VtZW50IGFzIHBhcnQgb2YgYSBzbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIHVudGlsIGl0IGlzIHJlc29sdmVkLCBlc3NlbnRpYWxseSBleHBvc2luZyBpbmNvbnNpc3RlbmN5IGJldHdlZW5cbiAgICAgICAgICAgICAgICAvLyBxdWVyaWVzLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgaHQoci5wYXRoKTtcbiAgICAgICAgICAgICAgICB0aGlzLkp0KG4sIHQsIGFuLm5ld05vRG9jdW1lbnQodCwgcnQubWluKCkpKTtcbiAgICAgICAgICAgIH0gZWxzZSBGKDEgPT09IHMpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpID0gdGhpcy5zZShuKTtcbiAgICAgICAgICAgICAgICAvLyBFeGlzdGVuY2UgZmlsdGVyIG1pc21hdGNoLiBNYXJrIHRoZSBkb2N1bWVudHMgYXMgYmVpbmcgaW4gbGltYm8sIGFuZFxuICAgICAgICAgICAgICAgIC8vIHJhaXNlIGEgc25hcHNob3Qgd2l0aCBgaXNGcm9tQ2FjaGU6dHJ1ZWAuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpICE9PSBzKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIEFwcGx5IGJsb29tIGZpbHRlciB0byBpZGVudGlmeSBhbmQgbWFyayByZW1vdmVkIGRvY3VtZW50cy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHRoaXMuaWUodCwgaSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICgwIC8qIEJsb29tRmlsdGVyQXBwbGljYXRpb25TdGF0dXMuU3VjY2VzcyAqLyAhPT0gcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgYmxvb20gZmlsdGVyIGFwcGxpY2F0aW9uIGZhaWxzLCB3ZSByZXNldCB0aGUgbWFwcGluZyBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRyaWdnZXIgcmUtcnVuIG9mIHRoZSBxdWVyeS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudGUobik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gMiAvKiBCbG9vbUZpbHRlckFwcGxpY2F0aW9uU3RhdHVzLkZhbHNlUG9zaXRpdmUgKi8gPT09IHMgPyBcIlRhcmdldFB1cnBvc2VFeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaEJsb29tXCIgLyogVGFyZ2V0UHVycG9zZS5FeGlzdGVuY2VGaWx0ZXJNaXNtYXRjaEJsb29tICovIDogXCJUYXJnZXRQdXJwb3NlRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hcIiAvKiBUYXJnZXRQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy56dCA9IHRoaXMuenQuaW5zZXJ0KG4sIHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG51bGwgPT09IChlID0gY2kuaW5zdGFuY2UpIHx8IHZvaWQgMCA9PT0gZSB8fCBlLm5vdGlmeU9uRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2goZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHMsIGksIHIsIG8sIHUsIGM7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxvY2FsQ2FjaGVDb3VudDogZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGlzdGVuY2VGaWx0ZXJDb3VudDogbi5jb3VudFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgaCA9IG4udW5jaGFuZ2VkTmFtZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBoICYmIChhLmJsb29tRmlsdGVyID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcGxpZWQ6IDAgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5TdWNjZXNzICovID09PSB0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2hDb3VudDogbnVsbCAhPT0gKHMgPSBudWxsID09IGggPyB2b2lkIDAgOiBoLmhhc2hDb3VudCkgJiYgdm9pZCAwICE9PSBzID8gcyA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYml0bWFwTGVuZ3RoOiBudWxsICE9PSAobyA9IG51bGwgPT09IChyID0gbnVsbCA9PT0gKGkgPSBudWxsID09IGggPyB2b2lkIDAgOiBoLmJpdHMpIHx8IHZvaWQgMCA9PT0gaSA/IHZvaWQgMCA6IGkuYml0bWFwKSB8fCB2b2lkIDAgPT09IHIgPyB2b2lkIDAgOiByLmxlbmd0aCkgJiYgdm9pZCAwICE9PSBvID8gbyA6IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFkZGluZzogbnVsbCAhPT0gKGMgPSBudWxsID09PSAodSA9IG51bGwgPT0gaCA/IHZvaWQgMCA6IGguYml0cykgfHwgdm9pZCAwID09PSB1ID8gdm9pZCAwIDogdS5wYWRkaW5nKSAmJiB2b2lkIDAgIT09IGMgPyBjIDogMFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAocywgaSwgdC5idCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAgICAgKiBBcHBseSBibG9vbSBmaWx0ZXIgdG8gcmVtb3ZlIHRoZSBkZWxldGVkIGRvY3VtZW50cywgYW5kIHJldHVybiB0aGVcbiAgICAgKiBhcHBsaWNhdGlvbiBzdGF0dXMuXG4gICAgICovICAgIGllKHQsIGUpIHtcbiAgICAgICAgY29uc3Qge3VuY2hhbmdlZE5hbWVzOiBuLCBjb3VudDogc30gPSB0LmJ0O1xuICAgICAgICBpZiAoIW4gfHwgIW4uYml0cykgcmV0dXJuIDEgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5Ta2lwcGVkICovO1xuICAgICAgICBjb25zdCB7Yml0czoge2JpdG1hcDogaSA9IFwiXCIsIHBhZGRpbmc6IHIgPSAwfSwgaGFzaENvdW50OiBvID0gMH0gPSBuO1xuICAgICAgICBsZXQgdSwgYztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHUgPSB4ZShpKS50b1VpbnQ4QXJyYXkoKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBQZSkgcmV0dXJuIE0oXCJEZWNvZGluZyB0aGUgYmFzZTY0IGJsb29tIGZpbHRlciBpbiBleGlzdGVuY2UgZmlsdGVyIGZhaWxlZCAoXCIgKyB0Lm1lc3NhZ2UgKyBcIik7IGlnbm9yaW5nIHRoZSBibG9vbSBmaWx0ZXIgYW5kIGZhbGxpbmcgYmFjayB0byBmdWxsIHJlLXF1ZXJ5LlwiKSwgXG4gICAgICAgICAgICAxIC8qIEJsb29tRmlsdGVyQXBwbGljYXRpb25TdGF0dXMuU2tpcHBlZCAqLztcbiAgICAgICAgICAgIHRocm93IHQ7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIEJsb29tRmlsdGVyIHRocm93cyBlcnJvciBpZiB0aGUgaW5wdXRzIGFyZSBpbnZhbGlkLlxuICAgICAgICAgICAgYyA9IG5ldyBfaSh1LCByLCBvKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgcmV0dXJuIE0odCBpbnN0YW5jZW9mIHdpID8gXCJCbG9vbUZpbHRlciBlcnJvcjogXCIgOiBcIkFwcGx5aW5nIGJsb29tIGZpbHRlciBmYWlsZWQ6IFwiLCB0KSwgXG4gICAgICAgICAgICAxIC8qIEJsb29tRmlsdGVyQXBwbGljYXRpb25TdGF0dXMuU2tpcHBlZCAqLztcbiAgICAgICAgfVxuICAgICAgICBpZiAoMCA9PT0gYy55dCkgcmV0dXJuIDEgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5Ta2lwcGVkICovO1xuICAgICAgICByZXR1cm4gcyAhPT0gZSAtIHRoaXMucmUodC50YXJnZXRJZCwgYykgPyAyIC8qIEJsb29tRmlsdGVyQXBwbGljYXRpb25TdGF0dXMuRmFsc2VQb3NpdGl2ZSAqLyA6IDAgLyogQmxvb21GaWx0ZXJBcHBsaWNhdGlvblN0YXR1cy5TdWNjZXNzICovO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaWx0ZXIgb3V0IHJlbW92ZWQgZG9jdW1lbnRzIGJhc2VkIG9uIGJsb29tIGZpbHRlciBtZW1iZXJzaGlwIHJlc3VsdCBhbmRcbiAgICAgKiByZXR1cm4gbnVtYmVyIG9mIGRvY3VtZW50cyByZW1vdmVkLlxuICAgICAqLyAgICByZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLkt0LmdldFJlbW90ZUtleXNGb3JUYXJnZXQodCk7XG4gICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gdGhpcy5LdC5vZSgpLCByID0gYHByb2plY3RzLyR7aS5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke2kuZGF0YWJhc2V9L2RvY3VtZW50cy8ke24ucGF0aC5jYW5vbmljYWxTdHJpbmcoKX1gO1xuICAgICAgICAgICAgZS5BdChyKSB8fCAodGhpcy5KdCh0LCBuLCAvKnVwZGF0ZWREb2N1bWVudD0qLyBudWxsKSwgcysrKTtcbiAgICAgICAgfSkpLCBzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyB0aGUgY3VycmVudGx5IGFjY3VtdWxhdGVkIHN0YXRlIGludG8gYSByZW1vdGUgZXZlbnQgYXQgdGhlXG4gICAgICogcHJvdmlkZWQgc25hcHNob3QgdmVyc2lvbi4gUmVzZXRzIHRoZSBhY2N1bXVsYXRlZCBjaGFuZ2VzIGJlZm9yZSByZXR1cm5pbmcuXG4gICAgICovICAgIHVlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBNYXA7XG4gICAgICAgIHRoaXMuR3QuZm9yRWFjaCgoKG4sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSB0aGlzLm5lKHMpO1xuICAgICAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgICAgICAgICBpZiAobi5jdXJyZW50ICYmIEZuKGkudGFyZ2V0KSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBEb2N1bWVudCBxdWVyaWVzIGZvciBkb2N1bWVudCB0aGF0IGRvbid0IGV4aXN0IGNhbiBwcm9kdWNlIGFuIGVtcHR5XG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc3VsdCBzZXQuIFRvIHVwZGF0ZSBvdXIgbG9jYWwgY2FjaGUsIHdlIHN5bnRoZXNpemUgYSBkb2N1bWVudFxuICAgICAgICAgICAgICAgICAgICAvLyBkZWxldGUgaWYgd2UgaGF2ZSBub3QgcHJldmlvdXNseSByZWNlaXZlZCB0aGUgZG9jdW1lbnQuIFRoaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVzb2x2ZXMgdGhlIGxpbWJvIHN0YXRlIG9mIHRoZSBkb2N1bWVudCwgcmVtb3ZpbmcgaXQgZnJvbVxuICAgICAgICAgICAgICAgICAgICAvLyBsaW1ib0RvY3VtZW50UmVmcy5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZGVhbGx5IHdlIHdvdWxkIGhhdmUgYW4gZXhwbGljaXQgbG9va3VwIHRhcmdldFxuICAgICAgICAgICAgICAgICAgICAvLyBpbnN0ZWFkIHJlc3VsdGluZyBpbiBhbiBleHBsaWNpdCBkZWxldGUgbWVzc2FnZSBhbmQgd2UgY291bGRcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHRoaXMgc3BlY2lhbCBsb2dpYy5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBodChpLnRhcmdldC5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPT0gdGhpcy5RdC5nZXQoZSkgfHwgdGhpcy5jZShzLCBlKSB8fCB0aGlzLkp0KHMsIGUsIGFuLm5ld05vRG9jdW1lbnQoZSwgdCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBuLmt0ICYmIChlLnNldChzLCBuLk90KCkpLCBuLiR0KCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSk7XG4gICAgICAgIGxldCBuID0gZ3MoKTtcbiAgICAgICAgLy8gV2UgZXh0cmFjdCB0aGUgc2V0IG9mIGxpbWJvLW9ubHkgZG9jdW1lbnQgdXBkYXRlcyBhcyB0aGUgR0MgbG9naWNcbiAgICAgICAgLy8gc3BlY2lhbC1jYXNlcyBkb2N1bWVudHMgdGhhdCBkbyBub3QgYXBwZWFyIGluIHRoZSB0YXJnZXQgY2FjaGUuXG4gICAgICAgIFxuICAgICAgICAvLyBUT0RPKGdzb2x0aXMpOiBFeHBhbmQgb24gdGhpcyBjb21tZW50IG9uY2UgR0MgaXMgYXZhaWxhYmxlIGluIHRoZSBKU1xuICAgICAgICAvLyBjbGllbnQuXG4gICAgICAgICAgICAgICAgdGhpcy5qdC5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgbGV0IHMgPSAhMDtcbiAgICAgICAgICAgIGUuZm9yRWFjaFdoaWxlKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5uZSh0KTtcbiAgICAgICAgICAgICAgICByZXR1cm4gIWUgfHwgXCJUYXJnZXRQdXJwb3NlTGltYm9SZXNvbHV0aW9uXCIgLyogVGFyZ2V0UHVycG9zZS5MaW1ib1Jlc29sdXRpb24gKi8gPT09IGUucHVycG9zZSB8fCAocyA9ICExLCBcbiAgICAgICAgICAgICAgICAhMSk7XG4gICAgICAgICAgICB9KSksIHMgJiYgKG4gPSBuLmFkZCh0KSk7XG4gICAgICAgIH0pKSwgdGhpcy5RdC5mb3JFYWNoKCgoZSwgbikgPT4gbi5zZXRSZWFkVGltZSh0KSkpO1xuICAgICAgICBjb25zdCBzID0gbmV3IG1pKHQsIGUsIHRoaXMuenQsIHRoaXMuUXQsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5RdCA9IGNzKCksIHRoaXMuanQgPSBBaSgpLCB0aGlzLnp0ID0gbmV3IHBlKGV0KSwgcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQgdG8gdGhlIGludGVybmFsIGxpc3Qgb2YgZG9jdW1lbnQgdXBkYXRlcyBhbmRcbiAgICAgKiBpdHMgZG9jdW1lbnQga2V5IHRvIHRoZSBnaXZlbiB0YXJnZXQncyBtYXBwaW5nLlxuICAgICAqL1xuICAgIC8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gICAgSHQodCwgZSkge1xuICAgICAgICBpZiAoIXRoaXMuWnQodCkpIHJldHVybjtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuY2UodCwgZS5rZXkpID8gMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovIDogMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovO1xuICAgICAgICB0aGlzLlh0KHQpLkZ0KGUua2V5LCBuKSwgdGhpcy5RdCA9IHRoaXMuUXQuaW5zZXJ0KGUua2V5LCBlKSwgdGhpcy5qdCA9IHRoaXMuanQuaW5zZXJ0KGUua2V5LCB0aGlzLmFlKGUua2V5KS5hZGQodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBwcm92aWRlZCBkb2N1bWVudCBmcm9tIHRoZSB0YXJnZXQgbWFwcGluZy4gSWYgdGhlXG4gICAgICogZG9jdW1lbnQgbm8gbG9uZ2VyIG1hdGNoZXMgdGhlIHRhcmdldCwgYnV0IHRoZSBkb2N1bWVudCdzIHN0YXRlIGlzIHN0aWxsXG4gICAgICoga25vd24gKGUuZy4gd2Uga25vdyB0aGF0IHRoZSBkb2N1bWVudCB3YXMgZGVsZXRlZCBvciB3ZSByZWNlaXZlZCB0aGUgY2hhbmdlXG4gICAgICogdGhhdCBjYXVzZWQgdGhlIGZpbHRlciBtaXNtYXRjaCksIHRoZSBuZXcgZG9jdW1lbnQgY2FuIGJlIHByb3ZpZGVkXG4gICAgICogdG8gdXBkYXRlIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUuXG4gICAgICovXG4gICAgLy8gVmlzaWJsZSBmb3IgdGVzdGluZy5cbiAgICBKdCh0LCBlLCBuKSB7XG4gICAgICAgIGlmICghdGhpcy5adCh0KSkgcmV0dXJuO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5YdCh0KTtcbiAgICAgICAgdGhpcy5jZSh0LCBlKSA/IHMuRnQoZSwgMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8pIDogXG4gICAgICAgIC8vIFRoZSBkb2N1bWVudCBtYXkgaGF2ZSBlbnRlcmVkIGFuZCBsZWZ0IHRoZSB0YXJnZXQgYmVmb3JlIHdlIHJhaXNlZCBhXG4gICAgICAgIC8vIHNuYXBzaG90LCBzbyB3ZSBjYW4ganVzdCBpZ25vcmUgdGhlIGNoYW5nZS5cbiAgICAgICAgcy5CdChlKSwgdGhpcy5qdCA9IHRoaXMuanQuaW5zZXJ0KGUsIHRoaXMuYWUoZSkuZGVsZXRlKHQpKSwgbiAmJiAodGhpcy5RdCA9IHRoaXMuUXQuaW5zZXJ0KGUsIG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5HdC5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgY291bnQgb2YgZG9jdW1lbnRzIGluIHRoZSB0YXJnZXQuIFRoaXMgaW5jbHVkZXMgYm90aFxuICAgICAqIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgdGhlIExvY2FsU3RvcmUgY29uc2lkZXJzIHRvIGJlIHBhcnQgb2YgdGhlXG4gICAgICogdGFyZ2V0IGFzIHdlbGwgYXMgYW55IGFjY3VtdWxhdGVkIGNoYW5nZXMuXG4gICAgICovICAgIHNlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuWHQodCkuT3QoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuS3QuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KS5zaXplICsgZS5hZGRlZERvY3VtZW50cy5zaXplIC0gZS5yZW1vdmVkRG9jdW1lbnRzLnNpemU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluY3JlbWVudCB0aGUgbnVtYmVyIG9mIGFja3MgbmVlZGVkIGZyb20gd2F0Y2ggYmVmb3JlIHdlIGNhbiBjb25zaWRlciB0aGVcbiAgICAgKiBzZXJ2ZXIgdG8gYmUgJ2luLXN5bmMnIHdpdGggdGhlIGNsaWVudCdzIGFjdGl2ZSB0YXJnZXRzLlxuICAgICAqLyAgICBMdCh0KSB7XG4gICAgICAgIHRoaXMuWHQodCkuTHQoKTtcbiAgICB9XG4gICAgWHQodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMuR3QuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSB8fCAoZSA9IG5ldyBUaSwgdGhpcy5HdC5zZXQodCwgZSkpLCBlO1xuICAgIH1cbiAgICBhZSh0KSB7XG4gICAgICAgIGxldCBlID0gdGhpcy5qdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlIHx8IChlID0gbmV3IEVlKGV0KSwgdGhpcy5qdCA9IHRoaXMuanQuaW5zZXJ0KHQsIGUpKSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVmVyaWZpZXMgdGhhdCB0aGUgdXNlciBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0IChieSBjYWxsaW5nXG4gICAgICogYGdldFRhcmdldERhdGFGb3JUYXJnZXQoKWApIGFuZCB0aGF0IHdlIGFyZSBub3Qgd2FpdGluZyBmb3IgcGVuZGluZyBBRERzXG4gICAgICogZnJvbSB3YXRjaC5cbiAgICAgKi8gICAgWnQodCkge1xuICAgICAgICBjb25zdCBlID0gbnVsbCAhPT0gdGhpcy5uZSh0KTtcbiAgICAgICAgcmV0dXJuIGUgfHwgTihcIldhdGNoQ2hhbmdlQWdncmVnYXRvclwiLCBcIkRldGVjdGVkIGluYWN0aXZlIHRhcmdldFwiLCB0KSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgVGFyZ2V0RGF0YSBmb3IgYW4gYWN0aXZlIHRhcmdldCAoaS5lLiBhIHRhcmdldCB0aGF0IHRoZSB1c2VyXG4gICAgICogaXMgc3RpbGwgaW50ZXJlc3RlZCBpbiB0aGF0IGhhcyBubyBvdXRzdGFuZGluZyB0YXJnZXQgY2hhbmdlIHJlcXVlc3RzKS5cbiAgICAgKi8gICAgbmUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5HdC5nZXQodCk7XG4gICAgICAgIHJldHVybiBlICYmIGUuTnQgPyBudWxsIDogdGhpcy5LdC5oZSh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBzdGF0ZSBvZiBhIFdhdGNoIHRhcmdldCB0byBpdHMgaW5pdGlhbCBzdGF0ZSAoZS5nLiBzZXRzXG4gICAgICogJ2N1cnJlbnQnIHRvIGZhbHNlLCBjbGVhcnMgdGhlIHJlc3VtZSB0b2tlbiBhbmQgcmVtb3ZlcyBpdHMgdGFyZ2V0IG1hcHBpbmdcbiAgICAgKiBmcm9tIGFsbCBkb2N1bWVudHMpLlxuICAgICAqLyAgICB0ZSh0KSB7XG4gICAgICAgIHRoaXMuR3Quc2V0KHQsIG5ldyBUaSk7XG4gICAgICAgIHRoaXMuS3QuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCh0KS5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHRoaXMuSnQodCwgZSwgLyp1cGRhdGVkRG9jdW1lbnQ9Ki8gbnVsbCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBMb2NhbFN0b3JlIGNvbnNpZGVycyB0aGUgZG9jdW1lbnQgdG8gYmUgcGFydCBvZiB0aGVcbiAgICAgKiBzcGVjaWZpZWQgdGFyZ2V0LlxuICAgICAqLyAgICBjZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkt0LmdldFJlbW90ZUtleXNGb3JUYXJnZXQodCkuaGFzKGUpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gQWkoKSB7XG4gICAgcmV0dXJuIG5ldyBwZShodC5jb21wYXJhdG9yKTtcbn1cblxuZnVuY3Rpb24gUmkoKSB7XG4gICAgcmV0dXJuIG5ldyBwZShodC5jb21wYXJhdG9yKTtcbn1cblxuY29uc3QgdmkgPSAoKCkgPT4ge1xuICAgIGNvbnN0IHQgPSB7XG4gICAgICAgIGFzYzogXCJBU0NFTkRJTkdcIixcbiAgICAgICAgZGVzYzogXCJERVNDRU5ESU5HXCJcbiAgICB9O1xuICAgIHJldHVybiB0O1xufSkoKSwgUGkgPSAoKCkgPT4ge1xuICAgIGNvbnN0IHQgPSB7XG4gICAgICAgIFwiPFwiOiBcIkxFU1NfVEhBTlwiLFxuICAgICAgICBcIjw9XCI6IFwiTEVTU19USEFOX09SX0VRVUFMXCIsXG4gICAgICAgIFwiPlwiOiBcIkdSRUFURVJfVEhBTlwiLFxuICAgICAgICBcIj49XCI6IFwiR1JFQVRFUl9USEFOX09SX0VRVUFMXCIsXG4gICAgICAgIFwiPT1cIjogXCJFUVVBTFwiLFxuICAgICAgICBcIiE9XCI6IFwiTk9UX0VRVUFMXCIsXG4gICAgICAgIFwiYXJyYXktY29udGFpbnNcIjogXCJBUlJBWV9DT05UQUlOU1wiLFxuICAgICAgICBpbjogXCJJTlwiLFxuICAgICAgICBcIm5vdC1pblwiOiBcIk5PVF9JTlwiLFxuICAgICAgICBcImFycmF5LWNvbnRhaW5zLWFueVwiOiBcIkFSUkFZX0NPTlRBSU5TX0FOWVwiXG4gICAgfTtcbiAgICByZXR1cm4gdDtcbn0pKCksIGJpID0gKCgpID0+IHtcbiAgICBjb25zdCB0ID0ge1xuICAgICAgICBhbmQ6IFwiQU5EXCIsXG4gICAgICAgIG9yOiBcIk9SXCJcbiAgICB9O1xuICAgIHJldHVybiB0O1xufSkoKTtcblxuLyoqXG4gKiBUaGlzIGNsYXNzIGdlbmVyYXRlcyBKc29uT2JqZWN0IHZhbHVlcyBmb3IgdGhlIERhdGFzdG9yZSBBUEkgc3VpdGFibGUgZm9yXG4gKiBzZW5kaW5nIHRvIGVpdGhlciBHUlBDIHN0dWIgbWV0aG9kcyBvciB2aWEgdGhlIEpTT04vSFRUUCBSRVNUIEFQSS5cbiAqXG4gKiBUaGUgc2VyaWFsaXplciBzdXBwb3J0cyBib3RoIFByb3RvYnVmLmpzIGFuZCBQcm90bzMgSlNPTiBmb3JtYXRzLiBCeVxuICogc2V0dGluZyBgdXNlUHJvdG8zSnNvbmAgdG8gdHJ1ZSwgdGhlIHNlcmlhbGl6ZXIgd2lsbCB1c2UgdGhlIFByb3RvMyBKU09OXG4gKiBmb3JtYXQuXG4gKlxuICogRm9yIGEgZGVzY3JpcHRpb24gb2YgdGhlIFByb3RvMyBKU09OIGZvcm1hdCBjaGVja1xuICogaHR0cHM6Ly9kZXZlbG9wZXJzLmdvb2dsZS5jb20vcHJvdG9jb2wtYnVmZmVycy9kb2NzL3Byb3RvMyNqc29uXG4gKlxuICogVE9ETyhrbGltdCk6IFdlIGNhbiByZW1vdmUgdGhlIGRhdGFiYXNlSWQgYXJndW1lbnQgaWYgd2Uga2VlcCB0aGUgZnVsbFxuICogcmVzb3VyY2UgbmFtZSBpbiBkb2N1bWVudHMuXG4gKi9cbmNsYXNzIFZpIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJZCA9IHQsIHRoaXMudXNlUHJvdG8zSnNvbiA9IGU7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBudW1iZXIgKG9yIG51bGwpIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50b1xuICogYSBnb29nbGUucHJvdG9idWYuSW50MzJWYWx1ZSBwcm90by5cbiAqIERPIE5PVCBVU0UgVEhJUyBGT1IgQU5ZVEhJTkcgRUxTRS5cbiAqIFRoaXMgbWV0aG9kIGNoZWF0cy4gSXQncyB0eXBlZCBhcyByZXR1cm5pbmcgXCJudW1iZXJcIiBiZWNhdXNlIHRoYXQncyB3aGF0XG4gKiBvdXIgZ2VuZXJhdGVkIHByb3RvIGludGVyZmFjZXMgc2F5IEludDMyVmFsdWUgbXVzdCBiZS4gQnV0IEdSUEMgYWN0dWFsbHlcbiAqIGV4cGVjdHMgYSB7IHZhbHVlOiA8bnVtYmVyPiB9IHN0cnVjdC5cbiAqL1xuZnVuY3Rpb24gU2kodCwgZSkge1xuICAgIHJldHVybiB0LnVzZVByb3RvM0pzb24gfHwgRnQoZSkgPyBlIDoge1xuICAgICAgICB2YWx1ZTogZVxuICAgIH07XG59XG5cbi8qKlxuICogUmV0dXJucyBhIG51bWJlciAob3IgbnVsbCkgZnJvbSBhIGdvb2dsZS5wcm90b2J1Zi5JbnQzMlZhbHVlIHByb3RvLlxuICovXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYSBEYXRlIHRoYXQncyBhcHByb3ByaWF0ZSB0byBwdXQgaW50byBhIHByb3RvLlxuICovXG5mdW5jdGlvbiBEaSh0LCBlKSB7XG4gICAgaWYgKHQudXNlUHJvdG8zSnNvbikge1xuICAgICAgICByZXR1cm4gYCR7bmV3IERhdGUoMWUzICogZS5zZWNvbmRzKS50b0lTT1N0cmluZygpLnJlcGxhY2UoL1xcLlxcZCovLCBcIlwiKS5yZXBsYWNlKFwiWlwiLCBcIlwiKX0uJHsoXCIwMDAwMDAwMDBcIiArIGUubmFub3NlY29uZHMpLnNsaWNlKC05KX1aYDtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc2Vjb25kczogXCJcIiArIGUuc2Vjb25kcyxcbiAgICAgICAgbmFub3M6IGUubmFub3NlY29uZHNcbiAgICB9O1xufVxuXG4vKipcbiAqIFJldHVybnMgYSB2YWx1ZSBmb3IgYnl0ZXMgdGhhdCdzIGFwcHJvcHJpYXRlIHRvIHB1dCBpbiBhIHByb3RvLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi9cbmZ1bmN0aW9uIENpKHQsIGUpIHtcbiAgICByZXR1cm4gdC51c2VQcm90bzNKc29uID8gZS50b0Jhc2U2NCgpIDogZS50b1VpbnQ4QXJyYXkoKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgQnl0ZVN0cmluZyBiYXNlZCBvbiB0aGUgcHJvdG8gc3RyaW5nIHZhbHVlLlxuICovIGZ1bmN0aW9uIHhpKHQsIGUpIHtcbiAgICByZXR1cm4gRGkodCwgZS50b1RpbWVzdGFtcCgpKTtcbn1cblxuZnVuY3Rpb24gTmkodCkge1xuICAgIHJldHVybiBGKCEhdCksIHJ0LmZyb21UaW1lc3RhbXAoZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gRGUodCk7XG4gICAgICAgIHJldHVybiBuZXcgaXQoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbiAgICB9KHQpKTtcbn1cblxuZnVuY3Rpb24ga2kodCwgZSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgdXQoWyBcInByb2plY3RzXCIsIHQucHJvamVjdElkLCBcImRhdGFiYXNlc1wiLCB0LmRhdGFiYXNlIF0pO1xuICAgIH0odCkuY2hpbGQoXCJkb2N1bWVudHNcIikuY2hpbGQoZSkuY2Fub25pY2FsU3RyaW5nKCk7XG59XG5cbmZ1bmN0aW9uIE1pKHQpIHtcbiAgICBjb25zdCBlID0gdXQuZnJvbVN0cmluZyh0KTtcbiAgICByZXR1cm4gRih1cihlKSksIGU7XG59XG5cbmZ1bmN0aW9uIE9pKHQsIGUpIHtcbiAgICByZXR1cm4ga2kodC5kYXRhYmFzZUlkLCBlLnBhdGgpO1xufVxuXG5mdW5jdGlvbiAkaSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IE1pKGUpO1xuICAgIGlmIChuLmdldCgxKSAhPT0gdC5kYXRhYmFzZUlkLnByb2plY3RJZCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBwcm9qZWN0OiBcIiArIG4uZ2V0KDEpICsgXCIgdnMgXCIgKyB0LmRhdGFiYXNlSWQucHJvamVjdElkKTtcbiAgICBpZiAobi5nZXQoMykgIT09IHQuZGF0YWJhc2VJZC5kYXRhYmFzZSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIlRyaWVkIHRvIGRlc2VyaWFsaXplIGtleSBmcm9tIGRpZmZlcmVudCBkYXRhYmFzZTogXCIgKyBuLmdldCgzKSArIFwiIHZzIFwiICsgdC5kYXRhYmFzZUlkLmRhdGFiYXNlKTtcbiAgICByZXR1cm4gbmV3IGh0KHFpKG4pKTtcbn1cblxuZnVuY3Rpb24gRmkodCwgZSkge1xuICAgIHJldHVybiBraSh0LmRhdGFiYXNlSWQsIGUpO1xufVxuXG5mdW5jdGlvbiBCaSh0KSB7XG4gICAgY29uc3QgZSA9IE1pKHQpO1xuICAgIC8vIEluIHYxYmV0YTEgcXVlcmllcyBmb3IgY29sbGVjdGlvbnMgYXQgdGhlIHJvb3QgZGlkIG5vdCBoYXZlIGEgdHJhaWxpbmdcbiAgICAvLyBcIi9kb2N1bWVudHNcIi4gSW4gdjEgYWxsIHJlc291cmNlIHBhdGhzIGNvbnRhaW4gXCIvZG9jdW1lbnRzXCIuIFByZXNlcnZlIHRoZVxuICAgIC8vIGFiaWxpdHkgdG8gcmVhZCB0aGUgdjFiZXRhMSBmb3JtIGZvciBjb21wYXRpYmlsaXR5IHdpdGggcXVlcmllcyBwZXJzaXN0ZWRcbiAgICAvLyBpbiB0aGUgbG9jYWwgdGFyZ2V0IGNhY2hlLlxuICAgICAgICByZXR1cm4gNCA9PT0gZS5sZW5ndGggPyB1dC5lbXB0eVBhdGgoKSA6IHFpKGUpO1xufVxuXG5mdW5jdGlvbiBMaSh0KSB7XG4gICAgcmV0dXJuIG5ldyB1dChbIFwicHJvamVjdHNcIiwgdC5kYXRhYmFzZUlkLnByb2plY3RJZCwgXCJkYXRhYmFzZXNcIiwgdC5kYXRhYmFzZUlkLmRhdGFiYXNlIF0pLmNhbm9uaWNhbFN0cmluZygpO1xufVxuXG5mdW5jdGlvbiBxaSh0KSB7XG4gICAgcmV0dXJuIEYodC5sZW5ndGggPiA0ICYmIFwiZG9jdW1lbnRzXCIgPT09IHQuZ2V0KDQpKSwgdC5wb3BGaXJzdCg1KTtcbn1cblxuLyoqIENyZWF0ZXMgYSBEb2N1bWVudCBwcm90byBmcm9tIGtleSBhbmQgZmllbGRzIChidXQgbm8gY3JlYXRlL3VwZGF0ZSB0aW1lKSAqLyBmdW5jdGlvbiBVaSh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbmFtZTogT2kodCwgZSksXG4gICAgICAgIGZpZWxkczogbi52YWx1ZS5tYXBWYWx1ZS5maWVsZHNcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBLaSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9ICRpKHQsIGUubmFtZSksIGkgPSBOaShlLnVwZGF0ZVRpbWUpLCByID0gZS5jcmVhdGVUaW1lID8gTmkoZS5jcmVhdGVUaW1lKSA6IHJ0Lm1pbigpLCBvID0gbmV3IHVuKHtcbiAgICAgICAgbWFwVmFsdWU6IHtcbiAgICAgICAgICAgIGZpZWxkczogZS5maWVsZHNcbiAgICAgICAgfVxuICAgIH0pLCB1ID0gYW4ubmV3Rm91bmREb2N1bWVudChzLCBpLCByLCBvKTtcbiAgICByZXR1cm4gbiAmJiB1LnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpLCBuID8gdS5zZXRIYXNDb21taXR0ZWRNdXRhdGlvbnMoKSA6IHU7XG59XG5cbmZ1bmN0aW9uIEdpKHQsIGUpIHtcbiAgICByZXR1cm4gXCJmb3VuZFwiIGluIGUgPyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIEYoISFlLmZvdW5kKSwgZS5mb3VuZC5uYW1lLCBlLmZvdW5kLnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IG4gPSAkaSh0LCBlLmZvdW5kLm5hbWUpLCBzID0gTmkoZS5mb3VuZC51cGRhdGVUaW1lKSwgaSA9IGUuZm91bmQuY3JlYXRlVGltZSA/IE5pKGUuZm91bmQuY3JlYXRlVGltZSkgOiBydC5taW4oKSwgciA9IG5ldyB1bih7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogZS5mb3VuZC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBhbi5uZXdGb3VuZERvY3VtZW50KG4sIHMsIGksIHIpO1xuICAgIH0odCwgZSkgOiBcIm1pc3NpbmdcIiBpbiBlID8gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBGKCEhZS5taXNzaW5nKSwgRighIWUucmVhZFRpbWUpO1xuICAgICAgICBjb25zdCBuID0gJGkodCwgZS5taXNzaW5nKSwgcyA9IE5pKGUucmVhZFRpbWUpO1xuICAgICAgICByZXR1cm4gYW4ubmV3Tm9Eb2N1bWVudChuLCBzKTtcbiAgICB9KHQsIGUpIDogJCgpO1xufVxuXG5mdW5jdGlvbiBRaSh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKFwidGFyZ2V0Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLnRhcmdldENoYW5nZTtcbiAgICAgICAgLy8gcHJvdG8zIGRlZmF1bHQgdmFsdWUgaXMgdW5zZXQgaW4gSlNPTiAodW5kZWZpbmVkKSwgc28gdXNlICdOT19DSEFOR0UnXG4gICAgICAgIC8vIGlmIHVuc2V0XG4gICAgICAgIGNvbnN0IHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gXCJOT19DSEFOR0VcIiA9PT0gdCA/IDAgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5Ob0NoYW5nZSAqLyA6IFwiQUREXCIgPT09IHQgPyAxIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuQWRkZWQgKi8gOiBcIlJFTU9WRVwiID09PSB0ID8gMiAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlbW92ZWQgKi8gOiBcIkNVUlJFTlRcIiA9PT0gdCA/IDMgLyogV2F0Y2hUYXJnZXRDaGFuZ2VTdGF0ZS5DdXJyZW50ICovIDogXCJSRVNFVFwiID09PSB0ID8gNCAvKiBXYXRjaFRhcmdldENoYW5nZVN0YXRlLlJlc2V0ICovIDogJCgpO1xuICAgICAgICB9KGUudGFyZ2V0Q2hhbmdlLnRhcmdldENoYW5nZVR5cGUgfHwgXCJOT19DSEFOR0VcIiksIGkgPSBlLnRhcmdldENoYW5nZS50YXJnZXRJZHMgfHwgW10sIHIgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gdC51c2VQcm90bzNKc29uID8gKEYodm9pZCAwID09PSBlIHx8IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUpLCBWZS5mcm9tQmFzZTY0U3RyaW5nKGUgfHwgXCJcIikpIDogKEYodm9pZCAwID09PSBlIHx8IGUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSwgXG4gICAgICAgICAgICBWZS5mcm9tVWludDhBcnJheShlIHx8IG5ldyBVaW50OEFycmF5KSk7XG4gICAgICAgIH0odCwgZS50YXJnZXRDaGFuZ2UucmVzdW1lVG9rZW4pLCBvID0gZS50YXJnZXRDaGFuZ2UuY2F1c2UsIHUgPSBvICYmIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB2b2lkIDAgPT09IHQuY29kZSA/IHEuVU5LTk9XTiA6IHVpKHQuY29kZSk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFUoZSwgdC5tZXNzYWdlIHx8IFwiXCIpO1xuICAgICAgICB9KG8pO1xuICAgICAgICBuID0gbmV3IElpKHMsIGksIHIsIHUgfHwgbnVsbCk7XG4gICAgfSBlbHNlIGlmIChcImRvY3VtZW50Q2hhbmdlXCIgaW4gZSkge1xuICAgICAgICBlLmRvY3VtZW50Q2hhbmdlO1xuICAgICAgICBjb25zdCBzID0gZS5kb2N1bWVudENoYW5nZTtcbiAgICAgICAgcy5kb2N1bWVudCwgcy5kb2N1bWVudC5uYW1lLCBzLmRvY3VtZW50LnVwZGF0ZVRpbWU7XG4gICAgICAgIGNvbnN0IGkgPSAkaSh0LCBzLmRvY3VtZW50Lm5hbWUpLCByID0gTmkocy5kb2N1bWVudC51cGRhdGVUaW1lKSwgbyA9IHMuZG9jdW1lbnQuY3JlYXRlVGltZSA/IE5pKHMuZG9jdW1lbnQuY3JlYXRlVGltZSkgOiBydC5taW4oKSwgdSA9IG5ldyB1bih7XG4gICAgICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgICAgIGZpZWxkczogcy5kb2N1bWVudC5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSksIGMgPSBhbi5uZXdGb3VuZERvY3VtZW50KGksIHIsIG8sIHUpLCBhID0gcy50YXJnZXRJZHMgfHwgW10sIGggPSBzLnJlbW92ZWRUYXJnZXRJZHMgfHwgW107XG4gICAgICAgIG4gPSBuZXcgeWkoYSwgaCwgYy5rZXksIGMpO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudERlbGV0ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudERlbGV0ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnREZWxldGU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSAkaSh0LCBzLmRvY3VtZW50KSwgciA9IHMucmVhZFRpbWUgPyBOaShzLnJlYWRUaW1lKSA6IHJ0Lm1pbigpLCBvID0gYW4ubmV3Tm9Eb2N1bWVudChpLCByKSwgdSA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyB5aShbXSwgdSwgby5rZXksIG8pO1xuICAgIH0gZWxzZSBpZiAoXCJkb2N1bWVudFJlbW92ZVwiIGluIGUpIHtcbiAgICAgICAgZS5kb2N1bWVudFJlbW92ZTtcbiAgICAgICAgY29uc3QgcyA9IGUuZG9jdW1lbnRSZW1vdmU7XG4gICAgICAgIHMuZG9jdW1lbnQ7XG4gICAgICAgIGNvbnN0IGkgPSAkaSh0LCBzLmRvY3VtZW50KSwgciA9IHMucmVtb3ZlZFRhcmdldElkcyB8fCBbXTtcbiAgICAgICAgbiA9IG5ldyB5aShbXSwgciwgaSwgbnVsbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKCEoXCJmaWx0ZXJcIiBpbiBlKSkgcmV0dXJuICQoKTtcbiAgICAgICAge1xuICAgICAgICAgICAgZS5maWx0ZXI7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5maWx0ZXI7XG4gICAgICAgICAgICB0LnRhcmdldElkO1xuICAgICAgICAgICAgY29uc3Qge2NvdW50OiBzID0gMCwgdW5jaGFuZ2VkTmFtZXM6IGl9ID0gdCwgciA9IG5ldyBzaShzLCBpKSwgbyA9IHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBuID0gbmV3IHBpKG8sIHIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuO1xufVxuXG5mdW5jdGlvbiBqaSh0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgaWYgKGUgaW5zdGFuY2VvZiBqcykgbiA9IHtcbiAgICAgICAgdXBkYXRlOiBVaSh0LCBlLmtleSwgZS52YWx1ZSlcbiAgICB9OyBlbHNlIGlmIChlIGluc3RhbmNlb2YgWXMpIG4gPSB7XG4gICAgICAgIGRlbGV0ZTogT2kodCwgZS5rZXkpXG4gICAgfTsgZWxzZSBpZiAoZSBpbnN0YW5jZW9mIHpzKSBuID0ge1xuICAgICAgICB1cGRhdGU6IFVpKHQsIGUua2V5LCBlLmRhdGEpLFxuICAgICAgICB1cGRhdGVNYXNrOiBvcihlLmZpZWxkTWFzaylcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCEoZSBpbnN0YW5jZW9mIFhzKSkgcmV0dXJuICQoKTtcbiAgICAgICAgbiA9IHtcbiAgICAgICAgICAgIHZlcmlmeTogT2kodCwgZS5rZXkpXG4gICAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiBlLmZpZWxkVHJhbnNmb3Jtcy5sZW5ndGggPiAwICYmIChuLnVwZGF0ZVRyYW5zZm9ybXMgPSBlLmZpZWxkVHJhbnNmb3Jtcy5tYXAoKHQgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS50cmFuc2Zvcm07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgYnMpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBzZXRUb1NlcnZlclZhbHVlOiBcIlJFUVVFU1RfVElNRVwiXG4gICAgICAgIH07XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgVnMpIHJldHVybiB7XG4gICAgICAgICAgICBmaWVsZFBhdGg6IGUuZmllbGQuY2Fub25pY2FsU3RyaW5nKCksXG4gICAgICAgICAgICBhcHBlbmRNaXNzaW5nRWxlbWVudHM6IHtcbiAgICAgICAgICAgICAgICB2YWx1ZXM6IG4uZWxlbWVudHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKG4gaW5zdGFuY2VvZiBEcykgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkUGF0aDogZS5maWVsZC5jYW5vbmljYWxTdHJpbmcoKSxcbiAgICAgICAgICAgIHJlbW92ZUFsbEZyb21BcnJheToge1xuICAgICAgICAgICAgICAgIHZhbHVlczogbi5lbGVtZW50c1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBpZiAobiBpbnN0YW5jZW9mIHhzKSByZXR1cm4ge1xuICAgICAgICAgICAgZmllbGRQYXRoOiBlLmZpZWxkLmNhbm9uaWNhbFN0cmluZygpLFxuICAgICAgICAgICAgaW5jcmVtZW50OiBuLnd0XG4gICAgICAgIH07XG4gICAgICAgIHRocm93ICQoKTtcbiAgICB9KDAsIHQpKSkpLCBlLnByZWNvbmRpdGlvbi5pc05vbmUgfHwgKG4uY3VycmVudERvY3VtZW50ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBlLnVwZGF0ZVRpbWUgPyB7XG4gICAgICAgICAgICB1cGRhdGVUaW1lOiB4aSh0LCBlLnVwZGF0ZVRpbWUpXG4gICAgICAgIH0gOiB2b2lkIDAgIT09IGUuZXhpc3RzID8ge1xuICAgICAgICAgICAgZXhpc3RzOiBlLmV4aXN0c1xuICAgICAgICB9IDogJCgpO1xuICAgIH0odCwgZS5wcmVjb25kaXRpb24pKSwgbjtcbn1cblxuZnVuY3Rpb24gemkodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmN1cnJlbnREb2N1bWVudCA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gdC51cGRhdGVUaW1lID8gRnMudXBkYXRlVGltZShOaSh0LnVwZGF0ZVRpbWUpKSA6IHZvaWQgMCAhPT0gdC5leGlzdHMgPyBGcy5leGlzdHModC5leGlzdHMpIDogRnMubm9uZSgpO1xuICAgIH0oZS5jdXJyZW50RG9jdW1lbnQpIDogRnMubm9uZSgpLCBzID0gZS51cGRhdGVUcmFuc2Zvcm1zID8gZS51cGRhdGVUcmFuc2Zvcm1zLm1hcCgoZSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGxldCBuID0gbnVsbDtcbiAgICAgICAgaWYgKFwic2V0VG9TZXJ2ZXJWYWx1ZVwiIGluIGUpIEYoXCJSRVFVRVNUX1RJTUVcIiA9PT0gZS5zZXRUb1NlcnZlclZhbHVlKSwgbiA9IG5ldyBiczsgZWxzZSBpZiAoXCJhcHBlbmRNaXNzaW5nRWxlbWVudHNcIiBpbiBlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5hcHBlbmRNaXNzaW5nRWxlbWVudHMudmFsdWVzIHx8IFtdO1xuICAgICAgICAgICAgbiA9IG5ldyBWcyh0KTtcbiAgICAgICAgfSBlbHNlIGlmIChcInJlbW92ZUFsbEZyb21BcnJheVwiIGluIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlLnJlbW92ZUFsbEZyb21BcnJheS52YWx1ZXMgfHwgW107XG4gICAgICAgICAgICBuID0gbmV3IERzKHQpO1xuICAgICAgICB9IGVsc2UgXCJpbmNyZW1lbnRcIiBpbiBlID8gbiA9IG5ldyB4cyh0LCBlLmluY3JlbWVudCkgOiAkKCk7XG4gICAgICAgIGNvbnN0IHMgPSBhdC5mcm9tU2VydmVyRm9ybWF0KGUuZmllbGRQYXRoKTtcbiAgICAgICAgcmV0dXJuIG5ldyBNcyhzLCBuKTtcbiAgICB9KHQsIGUpKSkgOiBbXTtcbiAgICBpZiAoZS51cGRhdGUpIHtcbiAgICAgICAgZS51cGRhdGUubmFtZTtcbiAgICAgICAgY29uc3QgaSA9ICRpKHQsIGUudXBkYXRlLm5hbWUpLCByID0gbmV3IHVuKHtcbiAgICAgICAgICAgIG1hcFZhbHVlOiB7XG4gICAgICAgICAgICAgICAgZmllbGRzOiBlLnVwZGF0ZS5maWVsZHNcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChlLnVwZGF0ZU1hc2spIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuZmllbGRQYXRocyB8fCBbXTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IHZlKGUubWFwKCh0ID0+IGF0LmZyb21TZXJ2ZXJGb3JtYXQodCkpKSk7XG4gICAgICAgICAgICB9KGUudXBkYXRlTWFzayk7XG4gICAgICAgICAgICByZXR1cm4gbmV3IHpzKGksIHIsIHQsIG4sIHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuZXcganMoaSwgciwgbiwgcyk7XG4gICAgfVxuICAgIGlmIChlLmRlbGV0ZSkge1xuICAgICAgICBjb25zdCBzID0gJGkodCwgZS5kZWxldGUpO1xuICAgICAgICByZXR1cm4gbmV3IFlzKHMsIG4pO1xuICAgIH1cbiAgICBpZiAoZS52ZXJpZnkpIHtcbiAgICAgICAgY29uc3QgcyA9ICRpKHQsIGUudmVyaWZ5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBYcyhzLCBuKTtcbiAgICB9XG4gICAgcmV0dXJuICQoKTtcbn1cblxuZnVuY3Rpb24gV2kodCwgZSkge1xuICAgIHJldHVybiB0ICYmIHQubGVuZ3RoID4gMCA/IChGKHZvaWQgMCAhPT0gZSksIHQubWFwKCh0ID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gTk9URTogRGVsZXRlcyBkb24ndCBoYXZlIGFuIHVwZGF0ZVRpbWUuXG4gICAgICAgIGxldCBuID0gdC51cGRhdGVUaW1lID8gTmkodC51cGRhdGVUaW1lKSA6IE5pKGUpO1xuICAgICAgICByZXR1cm4gbi5pc0VxdWFsKHJ0Lm1pbigpKSAmJiAoXG4gICAgICAgIC8vIFRoZSBGaXJlc3RvcmUgRW11bGF0b3IgY3VycmVudGx5IHJldHVybnMgYW4gdXBkYXRlIHRpbWUgb2YgMCBmb3JcbiAgICAgICAgLy8gZGVsZXRlcyBvZiBub24tZXhpc3RpbmcgZG9jdW1lbnRzIChyYXRoZXIgdGhhbiBudWxsKS4gVGhpcyBicmVha3MgdGhlXG4gICAgICAgIC8vIHRlc3QgXCJnZXQgZGVsZXRlZCBkb2Mgd2hpbGUgb2ZmbGluZSB3aXRoIHNvdXJjZT1jYWNoZVwiIGFzIE5vRG9jdW1lbnRzXG4gICAgICAgIC8vIHdpdGggdmVyc2lvbiAwIGFyZSBmaWx0ZXJlZCBieSBJbmRleGVkRGIncyBSZW1vdGVEb2N1bWVudENhY2hlLlxuICAgICAgICAvLyBUT0RPKCMyMTQ5KTogUmVtb3ZlIHRoaXMgd2hlbiBFbXVsYXRvciBpcyBmaXhlZFxuICAgICAgICBuID0gTmkoZSkpLCBuZXcgJHMobiwgdC50cmFuc2Zvcm1SZXN1bHRzIHx8IFtdKTtcbiAgICB9KHQsIGUpKSkpIDogW107XG59XG5cbmZ1bmN0aW9uIEhpKHQsIGUpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkb2N1bWVudHM6IFsgRmkodCwgZS5wYXRoKSBdXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gSmkodCwgZSkge1xuICAgIC8vIERpc3NlY3QgdGhlIHBhdGggaW50byBwYXJlbnQsIGNvbGxlY3Rpb25JZCwgYW5kIG9wdGlvbmFsIGtleSBmaWx0ZXIuXG4gICAgY29uc3QgbiA9IHtcbiAgICAgICAgc3RydWN0dXJlZFF1ZXJ5OiB7fVxuICAgIH0sIHMgPSBlLnBhdGg7XG4gICAgbnVsbCAhPT0gZS5jb2xsZWN0aW9uR3JvdXAgPyAobi5wYXJlbnQgPSBGaSh0LCBzKSwgbi5zdHJ1Y3R1cmVkUXVlcnkuZnJvbSA9IFsge1xuICAgICAgICBjb2xsZWN0aW9uSWQ6IGUuY29sbGVjdGlvbkdyb3VwLFxuICAgICAgICBhbGxEZXNjZW5kYW50czogITBcbiAgICB9IF0pIDogKG4ucGFyZW50ID0gRmkodCwgcy5wb3BMYXN0KCkpLCBuLnN0cnVjdHVyZWRRdWVyeS5mcm9tID0gWyB7XG4gICAgICAgIGNvbGxlY3Rpb25JZDogcy5sYXN0U2VnbWVudCgpXG4gICAgfSBdKTtcbiAgICBjb25zdCBpID0gZnVuY3Rpb24odCkge1xuICAgICAgICBpZiAoMCA9PT0gdC5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgcmV0dXJuIHJyKGduLmNyZWF0ZSh0LCBcImFuZFwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLkFORCAqLykpO1xuICAgIH0oZS5maWx0ZXJzKTtcbiAgICBpICYmIChuLnN0cnVjdHVyZWRRdWVyeS53aGVyZSA9IGkpO1xuICAgIGNvbnN0IHIgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICgwID09PSB0Lmxlbmd0aCkgcmV0dXJuO1xuICAgICAgICByZXR1cm4gdC5tYXAoKHQgPT4gXG4gICAgICAgIC8vIHZpc2libGUgZm9yIHRlc3RpbmdcbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBmaWVsZDogc3IodC5maWVsZCksXG4gICAgICAgICAgICAgICAgZGlyZWN0aW9uOiB0cih0LmRpcilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0odCkpKTtcbiAgICB9KGUub3JkZXJCeSk7XG4gICAgciAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkub3JkZXJCeSA9IHIpO1xuICAgIGNvbnN0IG8gPSBTaSh0LCBlLmxpbWl0KTtcbiAgICB2YXIgdTtcbiAgICByZXR1cm4gbnVsbCAhPT0gbyAmJiAobi5zdHJ1Y3R1cmVkUXVlcnkubGltaXQgPSBvKSwgZS5zdGFydEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5zdGFydEF0ID0ge1xuICAgICAgICBiZWZvcmU6ICh1ID0gZS5zdGFydEF0KS5pbmNsdXNpdmUsXG4gICAgICAgIHZhbHVlczogdS5wb3NpdGlvblxuICAgIH0pLCBlLmVuZEF0ICYmIChuLnN0cnVjdHVyZWRRdWVyeS5lbmRBdCA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJlZm9yZTogIXQuaW5jbHVzaXZlLFxuICAgICAgICAgICAgdmFsdWVzOiB0LnBvc2l0aW9uXG4gICAgICAgIH07XG4gICAgfShlLmVuZEF0KSksIG47XG59XG5cbmZ1bmN0aW9uIFlpKHQpIHtcbiAgICBsZXQgZSA9IEJpKHQucGFyZW50KTtcbiAgICBjb25zdCBuID0gdC5zdHJ1Y3R1cmVkUXVlcnksIHMgPSBuLmZyb20gPyBuLmZyb20ubGVuZ3RoIDogMDtcbiAgICBsZXQgaSA9IG51bGw7XG4gICAgaWYgKHMgPiAwKSB7XG4gICAgICAgIEYoMSA9PT0gcyk7XG4gICAgICAgIGNvbnN0IHQgPSBuLmZyb21bMF07XG4gICAgICAgIHQuYWxsRGVzY2VuZGFudHMgPyBpID0gdC5jb2xsZWN0aW9uSWQgOiBlID0gZS5jaGlsZCh0LmNvbGxlY3Rpb25JZCk7XG4gICAgfVxuICAgIGxldCByID0gW107XG4gICAgbi53aGVyZSAmJiAociA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFppKHQpO1xuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIGduICYmIEluKGUpKSByZXR1cm4gZS5nZXRGaWx0ZXJzKCk7XG4gICAgICAgIHJldHVybiBbIGUgXTtcbiAgICB9KG4ud2hlcmUpKTtcbiAgICBsZXQgbyA9IFtdO1xuICAgIG4ub3JkZXJCeSAmJiAobyA9IG4ub3JkZXJCeS5tYXAoKHQgPT4gZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IGRuKGlyKHQuZmllbGQpLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgY2FzZSBcIkFTQ0VORElOR1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFzY1wiIC8qIERpcmVjdGlvbi5BU0NFTkRJTkcgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIkRFU0NFTkRJTkdcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi87XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICAodC5kaXJlY3Rpb24pKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICh0KSkpKTtcbiAgICBsZXQgdSA9IG51bGw7XG4gICAgbi5saW1pdCAmJiAodSA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIHJldHVybiBlID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgdCA/IHQudmFsdWUgOiB0LCBGdChlKSA/IG51bGwgOiBlO1xuICAgIH0obi5saW1pdCkpO1xuICAgIGxldCBjID0gbnVsbDtcbiAgICBuLnN0YXJ0QXQgJiYgKGMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuYmVmb3JlLCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgICAgIHJldHVybiBuZXcgaG4obiwgZSk7XG4gICAgfShuLnN0YXJ0QXQpKTtcbiAgICBsZXQgYSA9IG51bGw7XG4gICAgcmV0dXJuIG4uZW5kQXQgJiYgKGEgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhdC5iZWZvcmUsIG4gPSB0LnZhbHVlcyB8fCBbXTtcbiAgICAgICAgcmV0dXJuIG5ldyBobihuLCBlKTtcbiAgICB9XG4gICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgIChuLmVuZEF0KSksIEtuKGUsIGksIG8sIHIsIHUsIFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyAsIGMsIGEpO1xufVxuXG5mdW5jdGlvbiBYaSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgc3dpdGNoICh0KSB7XG4gICAgICAgICAgY2FzZSBcIlRhcmdldFB1cnBvc2VMaXN0ZW5cIiAvKiBUYXJnZXRQdXJwb3NlLkxpc3RlbiAqLyA6XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcblxuICAgICAgICAgIGNhc2UgXCJUYXJnZXRQdXJwb3NlRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hcIiAvKiBUYXJnZXRQdXJwb3NlLkV4aXN0ZW5jZUZpbHRlck1pc21hdGNoICovIDpcbiAgICAgICAgICAgIHJldHVybiBcImV4aXN0ZW5jZS1maWx0ZXItbWlzbWF0Y2hcIjtcblxuICAgICAgICAgIGNhc2UgXCJUYXJnZXRQdXJwb3NlRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hCbG9vbVwiIC8qIFRhcmdldFB1cnBvc2UuRXhpc3RlbmNlRmlsdGVyTWlzbWF0Y2hCbG9vbSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gXCJleGlzdGVuY2UtZmlsdGVyLW1pc21hdGNoLWJsb29tXCI7XG5cbiAgICAgICAgICBjYXNlIFwiVGFyZ2V0UHVycG9zZUxpbWJvUmVzb2x1dGlvblwiIC8qIFRhcmdldFB1cnBvc2UuTGltYm9SZXNvbHV0aW9uICovIDpcbiAgICAgICAgICAgIHJldHVybiBcImxpbWJvLWRvY3VtZW50XCI7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfVxuICAgIH0oZS5wdXJwb3NlKTtcbiAgICByZXR1cm4gbnVsbCA9PSBuID8gbnVsbCA6IHtcbiAgICAgICAgXCJnb29nLWxpc3Rlbi10YWdzXCI6IG5cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBaaSh0KSB7XG4gICAgcmV0dXJuIHZvaWQgMCAhPT0gdC51bmFyeUZpbHRlciA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgc3dpdGNoICh0LnVuYXJ5RmlsdGVyLm9wKSB7XG4gICAgICAgICAgY2FzZSBcIklTX05BTlwiOlxuICAgICAgICAgICAgY29uc3QgZSA9IGlyKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIG1uLmNyZWF0ZShlLCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgZG91YmxlVmFsdWU6IE5hTlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIFwiSVNfTlVMTFwiOlxuICAgICAgICAgICAgY29uc3QgbiA9IGlyKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIG1uLmNyZWF0ZShuLCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjYXNlIFwiSVNfTk9UX05BTlwiOlxuICAgICAgICAgICAgY29uc3QgcyA9IGlyKHQudW5hcnlGaWx0ZXIuZmllbGQpO1xuICAgICAgICAgICAgcmV0dXJuIG1uLmNyZWF0ZShzLCBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovICwge1xuICAgICAgICAgICAgICAgIGRvdWJsZVZhbHVlOiBOYU5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgY2FzZSBcIklTX05PVF9OVUxMXCI6XG4gICAgICAgICAgICBjb25zdCBpID0gaXIodC51bmFyeUZpbHRlci5maWVsZCk7XG4gICAgICAgICAgICByZXR1cm4gbW4uY3JlYXRlKGksIFwiIT1cIiAvKiBPcGVyYXRvci5OT1RfRVFVQUwgKi8gLCB7XG4gICAgICAgICAgICAgICAgbnVsbFZhbHVlOiBcIk5VTExfVkFMVUVcIlxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgfVxuICAgIH0odCkgOiB2b2lkIDAgIT09IHQuZmllbGRGaWx0ZXIgPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBtbi5jcmVhdGUoaXIodC5maWVsZEZpbHRlci5maWVsZCksIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgICAgICBjYXNlIFwiRVFVQUxcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCI9PVwiIC8qIE9wZXJhdG9yLkVRVUFMICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJOT1RfRVFVQUxcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiR1JFQVRFUl9USEFOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiPlwiIC8qIE9wZXJhdG9yLkdSRUFURVJfVEhBTiAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiR1JFQVRFUl9USEFOX09SX0VRVUFMXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiPj1cIiAvKiBPcGVyYXRvci5HUkVBVEVSX1RIQU5fT1JfRVFVQUwgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTlwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIjxcIiAvKiBPcGVyYXRvci5MRVNTX1RIQU4gKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIkxFU1NfVEhBTl9PUl9FUVVBTFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcIjw9XCIgLyogT3BlcmF0b3IuTEVTU19USEFOX09SX0VRVUFMICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJBUlJBWV9DT05UQUlOU1wiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi87XG5cbiAgICAgICAgICAgICAgY2FzZSBcIklOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiTk9UX0lOXCI6XG4gICAgICAgICAgICAgICAgcmV0dXJuIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJBUlJBWV9DT05UQUlOU19BTllcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi87XG5cbiAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICByZXR1cm4gJCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHQuZmllbGRGaWx0ZXIub3ApLCB0LmZpZWxkRmlsdGVyLnZhbHVlKTtcbiAgICB9KHQpIDogdm9pZCAwICE9PSB0LmNvbXBvc2l0ZUZpbHRlciA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIGduLmNyZWF0ZSh0LmNvbXBvc2l0ZUZpbHRlci5maWx0ZXJzLm1hcCgodCA9PiBaaSh0KSkpLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgY2FzZSBcIkFORFwiOlxuICAgICAgICAgICAgICAgIHJldHVybiBcImFuZFwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLkFORCAqLztcblxuICAgICAgICAgICAgICBjYXNlIFwiT1JcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovO1xuXG4gICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0LmNvbXBvc2l0ZUZpbHRlci5vcCkpO1xuICAgIH0odCkgOiAkKCk7XG59XG5cbmZ1bmN0aW9uIHRyKHQpIHtcbiAgICByZXR1cm4gdmlbdF07XG59XG5cbmZ1bmN0aW9uIGVyKHQpIHtcbiAgICByZXR1cm4gUGlbdF07XG59XG5cbmZ1bmN0aW9uIG5yKHQpIHtcbiAgICByZXR1cm4gYmlbdF07XG59XG5cbmZ1bmN0aW9uIHNyKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBmaWVsZFBhdGg6IHQuY2Fub25pY2FsU3RyaW5nKClcbiAgICB9O1xufVxuXG5mdW5jdGlvbiBpcih0KSB7XG4gICAgcmV0dXJuIGF0LmZyb21TZXJ2ZXJGb3JtYXQodC5maWVsZFBhdGgpO1xufVxuXG5mdW5jdGlvbiBycih0KSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBtbiA/IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgaWYgKFwiPT1cIiAvKiBPcGVyYXRvci5FUVVBTCAqLyA9PT0gdC5vcCkge1xuICAgICAgICAgICAgaWYgKFhlKHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzcih0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTkFOXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKFllKHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzcih0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTlVMTFwiXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIGlmIChcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovID09PSB0Lm9wKSB7XG4gICAgICAgICAgICBpZiAoWGUodC52YWx1ZSkpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdW5hcnlGaWx0ZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHNyKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgICAgICBvcDogXCJJU19OT1RfTkFOXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKFllKHQudmFsdWUpKSByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVuYXJ5RmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzcih0LmZpZWxkKSxcbiAgICAgICAgICAgICAgICAgICAgb3A6IFwiSVNfTk9UX05VTExcIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZpZWxkRmlsdGVyOiB7XG4gICAgICAgICAgICAgICAgZmllbGQ6IHNyKHQuZmllbGQpLFxuICAgICAgICAgICAgICAgIG9wOiBlcih0Lm9wKSxcbiAgICAgICAgICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH0odCkgOiB0IGluc3RhbmNlb2YgZ24gPyBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LmdldEZpbHRlcnMoKS5tYXAoKHQgPT4gcnIodCkpKTtcbiAgICAgICAgaWYgKDEgPT09IGUubGVuZ3RoKSByZXR1cm4gZVswXTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGNvbXBvc2l0ZUZpbHRlcjoge1xuICAgICAgICAgICAgICAgIG9wOiBucih0Lm9wKSxcbiAgICAgICAgICAgICAgICBmaWx0ZXJzOiBlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfSh0KSA6ICQoKTtcbn1cblxuZnVuY3Rpb24gb3IodCkge1xuICAgIGNvbnN0IGUgPSBbXTtcbiAgICByZXR1cm4gdC5maWVsZHMuZm9yRWFjaCgodCA9PiBlLnB1c2godC5jYW5vbmljYWxTdHJpbmcoKSkpKSwge1xuICAgICAgICBmaWVsZFBhdGhzOiBlXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gdXIodCkge1xuICAgIC8vIFJlc291cmNlIG5hbWVzIGhhdmUgYXQgbGVhc3QgNCBjb21wb25lbnRzIChwcm9qZWN0IElELCBkYXRhYmFzZSBJRClcbiAgICByZXR1cm4gdC5sZW5ndGggPj0gNCAmJiBcInByb2plY3RzXCIgPT09IHQuZ2V0KDApICYmIFwiZGF0YWJhc2VzXCIgPT09IHQuZ2V0KDIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbW11dGFibGUgc2V0IG9mIG1ldGFkYXRhIHRoYXQgdGhlIGxvY2FsIHN0b3JlIHRyYWNrcyBmb3IgZWFjaCB0YXJnZXQuXG4gKi8gY2xhc3MgY3Ige1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgdGFyZ2V0IGJlaW5nIGxpc3RlbmVkIHRvLiAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSB0YXJnZXQgSUQgdG8gd2hpY2ggdGhlIHRhcmdldCBjb3JyZXNwb25kczsgQXNzaWduZWQgYnkgdGhlXG4gICAgICogTG9jYWxTdG9yZSBmb3IgdXNlciBsaXN0ZW5zIGFuZCBieSB0aGUgU3luY0VuZ2luZSBmb3IgbGltYm8gd2F0Y2hlcy5cbiAgICAgKi9cbiAgICBlLCBcbiAgICAvKiogVGhlIHB1cnBvc2Ugb2YgdGhlIHRhcmdldC4gKi9cbiAgICBuLCBcbiAgICAvKipcbiAgICAgKiBUaGUgc2VxdWVuY2UgbnVtYmVyIG9mIHRoZSBsYXN0IHRyYW5zYWN0aW9uIGR1cmluZyB3aGljaCB0aGlzIHRhcmdldCBkYXRhXG4gICAgICogd2FzIG1vZGlmaWVkLlxuICAgICAqL1xuICAgIHMsIFxuICAgIC8qKiBUaGUgbGF0ZXN0IHNuYXBzaG90IHZlcnNpb24gc2VlbiBmb3IgdGhpcyB0YXJnZXQuICovXG4gICAgaSA9IHJ0Lm1pbigpXG4gICAgLyoqXG4gICAgICogVGhlIG1heGltdW0gc25hcHNob3QgdmVyc2lvbiBhdCB3aGljaCB0aGUgYXNzb2NpYXRlZCB2aWV3XG4gICAgICogY29udGFpbmVkIG5vIGxpbWJvIGRvY3VtZW50cy5cbiAgICAgKi8gLCByID0gcnQubWluKClcbiAgICAvKipcbiAgICAgKiBBbiBvcGFxdWUsIHNlcnZlci1hc3NpZ25lZCB0b2tlbiB0aGF0IGFsbG93cyB3YXRjaGluZyBhIHRhcmdldCB0byBiZVxuICAgICAqIHJlc3VtZWQgYWZ0ZXIgZGlzY29ubmVjdGluZyB3aXRob3V0IHJldHJhbnNtaXR0aW5nIGFsbCB0aGUgZGF0YSB0aGF0XG4gICAgICogbWF0Y2hlcyB0aGUgdGFyZ2V0LiBUaGUgcmVzdW1lIHRva2VuIGVzc2VudGlhbGx5IGlkZW50aWZpZXMgYSBwb2ludCBpblxuICAgICAqIHRpbWUgZnJvbSB3aGljaCB0aGUgc2VydmVyIHNob3VsZCByZXN1bWUgc2VuZGluZyByZXN1bHRzLlxuICAgICAqLyAsIG8gPSBWZS5FTVBUWV9CWVRFX1NUUklOR1xuICAgIC8qKlxuICAgICAqIFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRoYXQgbGFzdCBtYXRjaGVkIHRoZSBxdWVyeSBhdCB0aGUgcmVzdW1lIHRva2VuIG9yXG4gICAgICogcmVhZCB0aW1lLiBEb2N1bWVudHMgYXJlIGNvdW50ZWQgb25seSB3aGVuIG1ha2luZyBhIGxpc3RlbiByZXF1ZXN0IHdpdGhcbiAgICAgKiByZXN1bWUgdG9rZW4gb3IgcmVhZCB0aW1lLCBvdGhlcndpc2UsIGtlZXAgaXQgbnVsbC5cbiAgICAgKi8gLCB1ID0gbnVsbCkge1xuICAgICAgICB0aGlzLnRhcmdldCA9IHQsIHRoaXMudGFyZ2V0SWQgPSBlLCB0aGlzLnB1cnBvc2UgPSBuLCB0aGlzLnNlcXVlbmNlTnVtYmVyID0gcywgdGhpcy5zbmFwc2hvdFZlcnNpb24gPSBpLCBcbiAgICAgICAgdGhpcy5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uID0gciwgdGhpcy5yZXN1bWVUb2tlbiA9IG8sIHRoaXMuZXhwZWN0ZWRDb3VudCA9IHU7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIGEgbmV3IHRhcmdldCBkYXRhIGluc3RhbmNlIHdpdGggYW4gdXBkYXRlZCBzZXF1ZW5jZSBudW1iZXIuICovICAgIHdpdGhTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3IodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdCwgdGhpcy5zbmFwc2hvdFZlcnNpb24sIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgdGhpcy5yZXN1bWVUb2tlbiwgdGhpcy5leHBlY3RlZENvdW50KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyB0YXJnZXQgZGF0YSBpbnN0YW5jZSB3aXRoIGFuIHVwZGF0ZWQgcmVzdW1lIHRva2VuIGFuZFxuICAgICAqIHNuYXBzaG90IHZlcnNpb24uXG4gICAgICovICAgIHdpdGhSZXN1bWVUb2tlbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgY3IodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdGhpcy5zZXF1ZW5jZU51bWJlciwgZSwgdGhpcy5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uLCB0LCBcbiAgICAgICAgLyogZXhwZWN0ZWRDb3VudD0gKi8gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIGV4cGVjdGVkIGNvdW50LlxuICAgICAqLyAgICB3aXRoRXhwZWN0ZWRDb3VudCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3IodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdGhpcy5zZXF1ZW5jZU51bWJlciwgdGhpcy5zbmFwc2hvdFZlcnNpb24sIHRoaXMubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgdGhpcy5yZXN1bWVUb2tlbiwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgdGFyZ2V0IGRhdGEgaW5zdGFuY2Ugd2l0aCBhbiB1cGRhdGVkIGxhc3QgbGltYm8gZnJlZVxuICAgICAqIHNuYXBzaG90IHZlcnNpb24gbnVtYmVyLlxuICAgICAqLyAgICB3aXRoTGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgY3IodGhpcy50YXJnZXQsIHRoaXMudGFyZ2V0SWQsIHRoaXMucHVycG9zZSwgdGhpcy5zZXF1ZW5jZU51bWJlciwgdGhpcy5zbmFwc2hvdFZlcnNpb24sIHQsIHRoaXMucmVzdW1lVG9rZW4sIHRoaXMuZXhwZWN0ZWRDb3VudCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFNlcmlhbGl6ZXIgZm9yIHZhbHVlcyBzdG9yZWQgaW4gdGhlIExvY2FsU3RvcmUuICovIGNsYXNzIGFyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMubGUgPSB0O1xuICAgIH1cbn1cblxuLyoqIERlY29kZXMgYSByZW1vdGUgZG9jdW1lbnQgZnJvbSBzdG9yYWdlIGxvY2FsbHkgdG8gYSBEb2N1bWVudC4gKi8gZnVuY3Rpb24gaHIodCwgZSkge1xuICAgIGxldCBuO1xuICAgIGlmIChlLmRvY3VtZW50KSBuID0gS2kodC5sZSwgZS5kb2N1bWVudCwgISFlLmhhc0NvbW1pdHRlZE11dGF0aW9ucyk7IGVsc2UgaWYgKGUubm9Eb2N1bWVudCkge1xuICAgICAgICBjb25zdCB0ID0gaHQuZnJvbVNlZ21lbnRzKGUubm9Eb2N1bWVudC5wYXRoKSwgcyA9IF9yKGUubm9Eb2N1bWVudC5yZWFkVGltZSk7XG4gICAgICAgIG4gPSBhbi5uZXdOb0RvY3VtZW50KHQsIHMpLCBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucyAmJiBuLnNldEhhc0NvbW1pdHRlZE11dGF0aW9ucygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICghZS51bmtub3duRG9jdW1lbnQpIHJldHVybiAkKCk7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBodC5mcm9tU2VnbWVudHMoZS51bmtub3duRG9jdW1lbnQucGF0aCksIHMgPSBfcihlLnVua25vd25Eb2N1bWVudC52ZXJzaW9uKTtcbiAgICAgICAgICAgIG4gPSBhbi5uZXdVbmtub3duRG9jdW1lbnQodCwgcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGUucmVhZFRpbWUgJiYgbi5zZXRSZWFkVGltZShmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgaXQodFswXSwgdFsxXSk7XG4gICAgICAgIHJldHVybiBydC5mcm9tVGltZXN0YW1wKGUpO1xuICAgIH0oZS5yZWFkVGltZSkpLCBuO1xufVxuXG4vKiogRW5jb2RlcyBhIGRvY3VtZW50IGZvciBzdG9yYWdlIGxvY2FsbHkuICovIGZ1bmN0aW9uIGxyKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZS5rZXksIHMgPSB7XG4gICAgICAgIHByZWZpeFBhdGg6IG4uZ2V0Q29sbGVjdGlvblBhdGgoKS5wb3BMYXN0KCkudG9BcnJheSgpLFxuICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IG4uY29sbGVjdGlvbkdyb3VwLFxuICAgICAgICBkb2N1bWVudElkOiBuLnBhdGgubGFzdFNlZ21lbnQoKSxcbiAgICAgICAgcmVhZFRpbWU6IGZyKGUucmVhZFRpbWUpLFxuICAgICAgICBoYXNDb21taXR0ZWRNdXRhdGlvbnM6IGUuaGFzQ29tbWl0dGVkTXV0YXRpb25zXG4gICAgfTtcbiAgICBpZiAoZS5pc0ZvdW5kRG9jdW1lbnQoKSkgcy5kb2N1bWVudCA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IE9pKHQsIGUua2V5KSxcbiAgICAgICAgICAgIGZpZWxkczogZS5kYXRhLnZhbHVlLm1hcFZhbHVlLmZpZWxkcyxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWU6IERpKHQsIGUudmVyc2lvbi50b1RpbWVzdGFtcCgpKSxcbiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IERpKHQsIGUuY3JlYXRlVGltZS50b1RpbWVzdGFtcCgpKVxuICAgICAgICB9O1xuICAgIH0odC5sZSwgZSk7IGVsc2UgaWYgKGUuaXNOb0RvY3VtZW50KCkpIHMubm9Eb2N1bWVudCA9IHtcbiAgICAgICAgcGF0aDogbi5wYXRoLnRvQXJyYXkoKSxcbiAgICAgICAgcmVhZFRpbWU6IGRyKGUudmVyc2lvbilcbiAgICB9OyBlbHNlIHtcbiAgICAgICAgaWYgKCFlLmlzVW5rbm93bkRvY3VtZW50KCkpIHJldHVybiAkKCk7XG4gICAgICAgIHMudW5rbm93bkRvY3VtZW50ID0ge1xuICAgICAgICAgICAgcGF0aDogbi5wYXRoLnRvQXJyYXkoKSxcbiAgICAgICAgICAgIHZlcnNpb246IGRyKGUudmVyc2lvbilcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHM7XG59XG5cbmZ1bmN0aW9uIGZyKHQpIHtcbiAgICBjb25zdCBlID0gdC50b1RpbWVzdGFtcCgpO1xuICAgIHJldHVybiBbIGUuc2Vjb25kcywgZS5uYW5vc2Vjb25kcyBdO1xufVxuXG5mdW5jdGlvbiBkcih0KSB7XG4gICAgY29uc3QgZSA9IHQudG9UaW1lc3RhbXAoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzZWNvbmRzOiBlLnNlY29uZHMsXG4gICAgICAgIG5hbm9zZWNvbmRzOiBlLm5hbm9zZWNvbmRzXG4gICAgfTtcbn1cblxuZnVuY3Rpb24gX3IodCkge1xuICAgIGNvbnN0IGUgPSBuZXcgaXQodC5zZWNvbmRzLCB0Lm5hbm9zZWNvbmRzKTtcbiAgICByZXR1cm4gcnQuZnJvbVRpbWVzdGFtcChlKTtcbn1cblxuLyoqIEVuY29kZXMgYSBiYXRjaCBvZiBtdXRhdGlvbnMgaW50byBhIERiTXV0YXRpb25CYXRjaCBmb3IgbG9jYWwgc3RvcmFnZS4gKi9cbi8qKiBEZWNvZGVzIGEgRGJNdXRhdGlvbkJhdGNoIGludG8gYSBNdXRhdGlvbkJhdGNoICovXG5mdW5jdGlvbiB3cih0LCBlKSB7XG4gICAgY29uc3QgbiA9IChlLmJhc2VNdXRhdGlvbnMgfHwgW10pLm1hcCgoZSA9PiB6aSh0LmxlLCBlKSkpO1xuICAgIC8vIFNxdWFzaCBvbGQgdHJhbnNmb3JtIG11dGF0aW9ucyBpbnRvIGV4aXN0aW5nIHBhdGNoIG9yIHNldCBtdXRhdGlvbnMuXG4gICAgLy8gVGhlIHJlcGxhY2VtZW50IG9mIHJlcHJlc2VudGluZyBgdHJhbnNmb3Jtc2Agd2l0aCBgdXBkYXRlX3RyYW5zZm9ybXNgXG4gICAgLy8gb24gdGhlIFNESyBtZWFucyB0aGF0IG9sZCBgdHJhbnNmb3JtYCBtdXRhdGlvbnMgc3RvcmVkIGluIEluZGV4ZWREQiBuZWVkXG4gICAgLy8gdG8gYmUgdXBkYXRlZCB0byBgdXBkYXRlX3RyYW5zZm9ybXNgLlxuICAgIC8vIFRPRE8oYi8xNzQ2MDgzNzQpOiBSZW1vdmUgdGhpcyBjb2RlIG9uY2Ugd2UgcGVyZm9ybSBhIHNjaGVtYSBtaWdyYXRpb24uXG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgZS5tdXRhdGlvbnMubGVuZ3RoIC0gMTsgKyt0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLm11dGF0aW9uc1t0XTtcbiAgICAgICAgaWYgKHQgKyAxIDwgZS5tdXRhdGlvbnMubGVuZ3RoICYmIHZvaWQgMCAhPT0gZS5tdXRhdGlvbnNbdCArIDFdLnRyYW5zZm9ybSkge1xuICAgICAgICAgICAgY29uc3QgcyA9IGUubXV0YXRpb25zW3QgKyAxXTtcbiAgICAgICAgICAgIG4udXBkYXRlVHJhbnNmb3JtcyA9IHMudHJhbnNmb3JtLmZpZWxkVHJhbnNmb3JtcywgZS5tdXRhdGlvbnMuc3BsaWNlKHQgKyAxLCAxKSwgXG4gICAgICAgICAgICArK3Q7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgcyA9IGUubXV0YXRpb25zLm1hcCgoZSA9PiB6aSh0LmxlLCBlKSkpLCBpID0gaXQuZnJvbU1pbGxpcyhlLmxvY2FsV3JpdGVUaW1lTXMpO1xuICAgIHJldHVybiBuZXcgWnMoZS5iYXRjaElkLCBpLCBuLCBzKTtcbn1cblxuLyoqIERlY29kZXMgYSBEYlRhcmdldCBpbnRvIFRhcmdldERhdGEgKi8gZnVuY3Rpb24gbXIodCkge1xuICAgIGNvbnN0IGUgPSBfcih0LnJlYWRUaW1lKSwgbiA9IHZvaWQgMCAhPT0gdC5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uID8gX3IodC5sYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKSA6IHJ0Lm1pbigpO1xuICAgIGxldCBzO1xuICAgIHZhciBpO1xuICAgIHJldHVybiB2b2lkIDAgIT09IHQucXVlcnkuZG9jdW1lbnRzID8gKEYoMSA9PT0gKGkgPSB0LnF1ZXJ5KS5kb2N1bWVudHMubGVuZ3RoKSwgXG4gICAgcyA9IEpuKEduKEJpKGkuZG9jdW1lbnRzWzBdKSkpKSA6IHMgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIHJldHVybiBKbihZaSh0KSk7XG4gICAgfSh0LnF1ZXJ5KSwgbmV3IGNyKHMsIHQudGFyZ2V0SWQsIFwiVGFyZ2V0UHVycG9zZUxpc3RlblwiIC8qIFRhcmdldFB1cnBvc2UuTGlzdGVuICovICwgdC5sYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIsIGUsIG4sIFZlLmZyb21CYXNlNjRTdHJpbmcodC5yZXN1bWVUb2tlbikpO1xufVxuXG4vKiogRW5jb2RlcyBUYXJnZXREYXRhIGludG8gYSBEYlRhcmdldCBmb3Igc3RvcmFnZSBsb2NhbGx5LiAqLyBmdW5jdGlvbiBncih0LCBlKSB7XG4gICAgY29uc3QgbiA9IGRyKGUuc25hcHNob3RWZXJzaW9uKSwgcyA9IGRyKGUubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbik7XG4gICAgbGV0IGk7XG4gICAgaSA9IEZuKGUudGFyZ2V0KSA/IEhpKHQubGUsIGUudGFyZ2V0KSA6IEppKHQubGUsIGUudGFyZ2V0KTtcbiAgICAvLyBXZSBjYW4ndCBzdG9yZSB0aGUgcmVzdW1lVG9rZW4gYXMgYSBCeXRlU3RyaW5nIGluIEluZGV4ZWREYiwgc28gd2VcbiAgICAvLyBjb252ZXJ0IGl0IHRvIGEgYmFzZTY0IHN0cmluZyBmb3Igc3RvcmFnZS5cbiAgICAgICAgY29uc3QgciA9IGUucmVzdW1lVG9rZW4udG9CYXNlNjQoKTtcbiAgICAvLyBsYXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgaXMgYWx3YXlzIDAgdW50aWwgd2UgZG8gcmVhbCBHQy5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGFyZ2V0SWQ6IGUudGFyZ2V0SWQsXG4gICAgICAgIGNhbm9uaWNhbElkOiBPbihlLnRhcmdldCksXG4gICAgICAgIHJlYWRUaW1lOiBuLFxuICAgICAgICByZXN1bWVUb2tlbjogcixcbiAgICAgICAgbGFzdExpc3RlblNlcXVlbmNlTnVtYmVyOiBlLnNlcXVlbmNlTnVtYmVyLFxuICAgICAgICBsYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uOiBzLFxuICAgICAgICBxdWVyeTogaVxuICAgIH07XG59XG5cbi8qKlxuICogQSBoZWxwZXIgZnVuY3Rpb24gZm9yIGZpZ3VyaW5nIG91dCB3aGF0IGtpbmQgb2YgcXVlcnkgaGFzIGJlZW4gc3RvcmVkLlxuICovXG4vKipcbiAqIEVuY29kZXMgYSBgQnVuZGxlZFF1ZXJ5YCBmcm9tIGJ1bmRsZSBwcm90byB0byBhIFF1ZXJ5IG9iamVjdC5cbiAqXG4gKiBUaGlzIHJlY29uc3RydWN0cyB0aGUgb3JpZ2luYWwgcXVlcnkgdXNlZCB0byBidWlsZCB0aGUgYnVuZGxlIGJlaW5nIGxvYWRlZCxcbiAqIGluY2x1ZGluZyBmZWF0dXJlcyBleGlzdHMgb25seSBpbiBTREtzIChmb3IgZXhhbXBsZTogbGltaXQtdG8tbGFzdCkuXG4gKi9cbmZ1bmN0aW9uIHlyKHQpIHtcbiAgICBjb25zdCBlID0gWWkoe1xuICAgICAgICBwYXJlbnQ6IHQucGFyZW50LFxuICAgICAgICBzdHJ1Y3R1cmVkUXVlcnk6IHQuc3RydWN0dXJlZFF1ZXJ5XG4gICAgfSk7XG4gICAgcmV0dXJuIFwiTEFTVFwiID09PSB0LmxpbWl0VHlwZSA/IFhuKGUsIGUubGltaXQsIFwiTFwiIC8qIExpbWl0VHlwZS5MYXN0ICovKSA6IGU7XG59XG5cbi8qKiBFbmNvZGVzIGEgTmFtZWRRdWVyeSBwcm90byBvYmplY3QgdG8gYSBOYW1lZFF1ZXJ5IG1vZGVsIG9iamVjdC4gKi9cbi8qKiBFbmNvZGVzIGEgRGJEb2N1bWVudE92ZXJsYXkgb2JqZWN0IHRvIGFuIE92ZXJsYXkgbW9kZWwgb2JqZWN0LiAqL1xuZnVuY3Rpb24gcHIodCwgZSkge1xuICAgIHJldHVybiBuZXcgZWkoZS5sYXJnZXN0QmF0Y2hJZCwgemkodC5sZSwgZS5vdmVybGF5TXV0YXRpb24pKTtcbn1cblxuLyoqIERlY29kZXMgYW4gT3ZlcmxheSBtb2RlbCBvYmplY3QgaW50byBhIERiRG9jdW1lbnRPdmVybGF5IG9iamVjdC4gKi9cbi8qKlxuICogUmV0dXJucyB0aGUgRGJEb2N1bWVudE92ZXJsYXlLZXkgY29ycmVzcG9uZGluZyB0byB0aGUgZ2l2ZW4gdXNlciBhbmRcbiAqIGRvY3VtZW50IGtleS5cbiAqL1xuZnVuY3Rpb24gSXIodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICByZXR1cm4gWyB0LCBxdChlLnBhdGgucG9wTGFzdCgpKSwgbiBdO1xufVxuXG5mdW5jdGlvbiBUcih0LCBlLCBuLCBzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5kZXhJZDogdCxcbiAgICAgICAgdWlkOiBlLnVpZCB8fCBcIlwiLFxuICAgICAgICBzZXF1ZW5jZU51bWJlcjogbixcbiAgICAgICAgcmVhZFRpbWU6IGRyKHMucmVhZFRpbWUpLFxuICAgICAgICBkb2N1bWVudEtleTogcXQocy5kb2N1bWVudEtleS5wYXRoKSxcbiAgICAgICAgbGFyZ2VzdEJhdGNoSWQ6IHMubGFyZ2VzdEJhdGNoSWRcbiAgICB9O1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBFciB7XG4gICAgZ2V0QnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gQXIodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgaWQ6IChlID0gdCkuYnVuZGxlSWQsXG4gICAgICAgICAgICAgICAgY3JlYXRlVGltZTogX3IoZS5jcmVhdGVUaW1lKSxcbiAgICAgICAgICAgICAgICB2ZXJzaW9uOiBlLnZlcnNpb25cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIERiQnVuZGxlIHRvIGEgQnVuZGxlTWV0YWRhdGEgb2JqZWN0LiAqL1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIEJ1bmRsZU1ldGFkYXRhIHRvIGEgRGJCdW5kbGUuICovICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBBcih0KS5wdXQoe1xuICAgICAgICAgICAgYnVuZGxlSWQ6IChuID0gZSkuaWQsXG4gICAgICAgICAgICBjcmVhdGVUaW1lOiBkcihOaShuLmNyZWF0ZVRpbWUpKSxcbiAgICAgICAgICAgIHZlcnNpb246IG4udmVyc2lvblxuICAgICAgICB9KTtcbiAgICAgICAgdmFyIG47XG4gICAgICAgIC8qKiBFbmNvZGVzIGEgRGJOYW1lZFF1ZXJ5IHRvIGEgTmFtZWRRdWVyeS4gKi8gICAgfVxuICAgIGdldE5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gUnIodCkuZ2V0KGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKHQpIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogKGUgPSB0KS5uYW1lLFxuICAgICAgICAgICAgICAgIHF1ZXJ5OiB5cihlLmJ1bmRsZWRRdWVyeSksXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IF9yKGUucmVhZFRpbWUpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAvKiogRW5jb2RlcyBhIE5hbWVkUXVlcnkgZnJvbSBhIGJ1bmRsZSBwcm90byB0byBhIERiTmFtZWRRdWVyeS4gKi8gICAgICAgIH0pKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gUnIodCkucHV0KGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbmFtZTogdC5uYW1lLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBkcihOaSh0LnJlYWRUaW1lKSksXG4gICAgICAgICAgICAgICAgYnVuZGxlZFF1ZXJ5OiB0LmJ1bmRsZWRRdWVyeVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgYnVuZGxlcyBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gQXIodCkge1xuICAgIHJldHVybiB3ZSh0LCBcImJ1bmRsZXNcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBuYW1lZFF1ZXJpZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIFJyKHQpIHtcbiAgICByZXR1cm4gd2UodCwgXCJuYW1lZFF1ZXJpZXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEltcGxlbWVudGF0aW9uIG9mIERvY3VtZW50T3ZlcmxheUNhY2hlIHVzaW5nIEluZGV4ZWREYi5cbiAqLyBjbGFzcyB2ciB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHNlcmlhbGl6ZXIgLSBUaGUgZG9jdW1lbnQgc2VyaWFsaXplci5cbiAgICAgKiBAcGFyYW0gdXNlcklkIC0gVGhlIHVzZXJJZCBmb3Igd2hpY2ggd2UgYXJlIGFjY2Vzc2luZyBvdmVybGF5cy5cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHQsIHRoaXMudXNlcklkID0gZTtcbiAgICB9XG4gICAgc3RhdGljIGZlKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUudWlkIHx8IFwiXCI7XG4gICAgICAgIHJldHVybiBuZXcgdnIodCwgbik7XG4gICAgfVxuICAgIGdldE92ZXJsYXkodCwgZSkge1xuICAgICAgICByZXR1cm4gUHIodCkuZ2V0KElyKHRoaXMudXNlcklkLCBlKSkubmV4dCgodCA9PiB0ID8gcHIodGhpcy5zZXJpYWxpemVyLCB0KSA6IG51bGwpKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZnMoKTtcbiAgICAgICAgcmV0dXJuIHZ0LmZvckVhY2goZSwgKGUgPT4gdGhpcy5nZXRPdmVybGF5KHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPT0gdCAmJiBuLnNldChlLCB0KTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKChuLCBpKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gbmV3IGVpKGUsIGkpO1xuICAgICAgICAgICAgcy5wdXNoKHRoaXMuZGUodCwgcikpO1xuICAgICAgICB9KSksIHZ0LndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgU2V0O1xuICAgICAgICAvLyBHZXQgdGhlIHNldCBvZiB1bmlxdWUgY29sbGVjdGlvbiBwYXRocy5cbiAgICAgICAgICAgICAgICBlLmZvckVhY2goKHQgPT4gcy5hZGQocXQodC5nZXRDb2xsZWN0aW9uUGF0aCgpKSkpKTtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIHRoaXMudXNlcklkLCBlLCBuIF0sIFsgdGhpcy51c2VySWQsIGUsIG4gKyAxIF0sIFxuICAgICAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICAgICAgaS5wdXNoKFByKHQpLkooXCJjb2xsZWN0aW9uUGF0aE92ZXJsYXlJbmRleFwiLCBzKSk7XG4gICAgICAgIH0pKSwgdnQud2FpdEZvcihpKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IGZzKCksIGkgPSBxdChlKSwgciA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIGksIG4gXSwgWyB0aGlzLnVzZXJJZCwgaSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMCk7XG4gICAgICAgIHJldHVybiBQcih0KS5qKFwiY29sbGVjdGlvblBhdGhPdmVybGF5SW5kZXhcIiwgcikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBwcih0aGlzLnNlcmlhbGl6ZXIsIGUpO1xuICAgICAgICAgICAgICAgIHMuc2V0KHQuZ2V0S2V5KCksIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHM7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXNGb3JDb2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gZnMoKTtcbiAgICAgICAgbGV0IHI7XG4gICAgICAgIC8vIFdlIHdhbnQgYmF0Y2ggSURzIGxhcmdlciB0aGFuIGBzaW5jZUJhdGNoSWRgLCBhbmQgc28gdGhlIGxvd2VyIGJvdW5kXG4gICAgICAgIC8vIGlzIG5vdCBpbmNsdXNpdmUuXG4gICAgICAgICAgICAgICAgY29uc3QgbyA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIGUsIG4gXSwgWyB0aGlzLnVzZXJJZCwgZSwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMCk7XG4gICAgICAgIHJldHVybiBQcih0KS5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcImNvbGxlY3Rpb25Hcm91cE92ZXJsYXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IG9cbiAgICAgICAgfSwgKCh0LCBlLCBuKSA9PiB7XG4gICAgICAgICAgICAvLyBXZSBkbyBub3Qgd2FudCB0byByZXR1cm4gcGFydGlhbCBiYXRjaCBvdmVybGF5cywgZXZlbiBpZiB0aGUgc2l6ZVxuICAgICAgICAgICAgLy8gb2YgdGhlIHJlc3VsdCBzZXQgZXhjZWVkcyB0aGUgZ2l2ZW4gYGNvdW50YCBhcmd1bWVudC4gVGhlcmVmb3JlLCB3ZVxuICAgICAgICAgICAgLy8gY29udGludWUgdG8gYWdncmVnYXRlIHJlc3VsdHMgZXZlbiBhZnRlciB0aGUgcmVzdWx0IHNpemUgZXhjZWVkc1xuICAgICAgICAgICAgLy8gYGNvdW50YCBpZiB0aGVyZSBhcmUgbW9yZSBvdmVybGF5cyBmcm9tIHRoZSBgY3VycmVudEJhdGNoSWRgLlxuICAgICAgICAgICAgY29uc3QgbyA9IHByKHRoaXMuc2VyaWFsaXplciwgZSk7XG4gICAgICAgICAgICBpLnNpemUoKSA8IHMgfHwgby5sYXJnZXN0QmF0Y2hJZCA9PT0gciA/IChpLnNldChvLmdldEtleSgpLCBvKSwgciA9IG8ubGFyZ2VzdEJhdGNoSWQpIDogbi5kb25lKCk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGRlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFByKHQpLnB1dChmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBjb25zdCBbcywgaSwgcl0gPSBJcihlLCBuLm11dGF0aW9uLmtleSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHVzZXJJZDogZSxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uUGF0aDogaSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudElkOiByLFxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb25Hcm91cDogbi5tdXRhdGlvbi5rZXkuZ2V0Q29sbGVjdGlvbkdyb3VwKCksXG4gICAgICAgICAgICAgICAgbGFyZ2VzdEJhdGNoSWQ6IG4ubGFyZ2VzdEJhdGNoSWQsXG4gICAgICAgICAgICAgICAgb3ZlcmxheU11dGF0aW9uOiBqaSh0LmxlLCBuLm11dGF0aW9uKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0aGlzLnNlcmlhbGl6ZXIsIHRoaXMudXNlcklkLCBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgZG9jdW1lbnQgb3ZlcmxheSBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gUHIodCkge1xuICAgIHJldHVybiB3ZSh0LCBcImRvY3VtZW50T3ZlcmxheXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIxIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBOb3RlOiBUaGlzIGNvZGUgaXMgY29waWVkIGZyb20gdGhlIGJhY2tlbmQuIENvZGUgdGhhdCBpcyBub3QgdXNlZCBieVxuLy8gRmlyZXN0b3JlIHdhcyByZW1vdmVkLlxuLyoqIEZpcmVzdG9yZSBpbmRleCB2YWx1ZSB3cml0ZXIuICAqL1xuY2xhc3MgYnIge1xuICAgIGNvbnN0cnVjdG9yKCkge31cbiAgICAvLyBUaGUgd3JpdGUgbWV0aG9kcyBiZWxvdyBzaG9ydC1jaXJjdWl0IHdyaXRpbmcgdGVybWluYXRvcnMgZm9yIHZhbHVlc1xuICAgIC8vIGNvbnRhaW5pbmcgYSAodGVybWluYXRpbmcpIHRydW5jYXRlZCB2YWx1ZS5cbiAgICAvLyBBcyBhbiBleGFtcGxlLCBjb25zaWRlciB0aGUgcmVzdWx0aW5nIGVuY29kaW5nIGZvcjpcbiAgICAvLyBbXCJiYXJcIiwgWzIsIFwiZm9vXCJdXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWSwgTlVNQkVSLCAyLCBTVFJJTkcsIFwiZm9vXCIsIFRFUk0sIFRFUk0sIFRFUk0pXG4gICAgLy8gW1wiYmFyXCIsIFsyLCB0cnVuY2F0ZWQoXCJmb29cIildXSAtPiAoU1RSSU5HLCBcImJhclwiLCBURVJNLCBBUlJBWSwgTlVNQkVSLCAyLCBTVFJJTkcsIFwiZm9vXCIsIFRSVU5DKVxuICAgIC8vIFtcImJhclwiLCB0cnVuY2F0ZWQoW1wiZm9vXCJdKV0gLT4gKFNUUklORywgXCJiYXJcIiwgVEVSTSwgQVJSQVkuIFNUUklORywgXCJmb29cIiwgVEVSTSwgVFJVTkMpXG4gICAgLyoqIFdyaXRlcyBhbiBpbmRleCB2YWx1ZS4gICovXG4gICAgX2UodCwgZSkge1xuICAgICAgICB0aGlzLndlKHQsIGUpLCBcbiAgICAgICAgLy8gV3JpdGUgc2VwYXJhdG9yIHRvIHNwbGl0IGluZGV4IHZhbHVlc1xuICAgICAgICAvLyAoc2VlIGdvL2ZpcmVzdG9yZS1zdG9yYWdlLWZvcm1hdCNlbmNvZGluZ3MpLlxuICAgICAgICBlLm1lKCk7XG4gICAgfVxuICAgIHdlKHQsIGUpIHtcbiAgICAgICAgaWYgKFwibnVsbFZhbHVlXCIgaW4gdCkgdGhpcy5nZShlLCA1KTsgZWxzZSBpZiAoXCJib29sZWFuVmFsdWVcIiBpbiB0KSB0aGlzLmdlKGUsIDEwKSwgXG4gICAgICAgIGUueWUodC5ib29sZWFuVmFsdWUgPyAxIDogMCk7IGVsc2UgaWYgKFwiaW50ZWdlclZhbHVlXCIgaW4gdCkgdGhpcy5nZShlLCAxNSksIGUueWUoQ2UodC5pbnRlZ2VyVmFsdWUpKTsgZWxzZSBpZiAoXCJkb3VibGVWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBDZSh0LmRvdWJsZVZhbHVlKTtcbiAgICAgICAgICAgIGlzTmFOKG4pID8gdGhpcy5nZShlLCAxMykgOiAodGhpcy5nZShlLCAxNSksIEJ0KG4pID8gXG4gICAgICAgICAgICAvLyAtMC4wLCAwIGFuZCAwLjAgYXJlIGFsbCBjb25zaWRlcmVkIHRoZSBzYW1lXG4gICAgICAgICAgICBlLnllKDApIDogZS55ZShuKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJ0aW1lc3RhbXBWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnRpbWVzdGFtcFZhbHVlO1xuICAgICAgICAgICAgdGhpcy5nZShlLCAyMCksIFwic3RyaW5nXCIgPT0gdHlwZW9mIG4gPyBlLnBlKG4pIDogKGUucGUoYCR7bi5zZWNvbmRzIHx8IFwiXCJ9YCksIGUueWUobi5uYW5vcyB8fCAwKSk7XG4gICAgICAgIH0gZWxzZSBpZiAoXCJzdHJpbmdWYWx1ZVwiIGluIHQpIHRoaXMuSWUodC5zdHJpbmdWYWx1ZSwgZSksIHRoaXMuVGUoZSk7IGVsc2UgaWYgKFwiYnl0ZXNWYWx1ZVwiIGluIHQpIHRoaXMuZ2UoZSwgMzApLCBcbiAgICAgICAgZS5FZSh4ZSh0LmJ5dGVzVmFsdWUpKSwgdGhpcy5UZShlKTsgZWxzZSBpZiAoXCJyZWZlcmVuY2VWYWx1ZVwiIGluIHQpIHRoaXMuQWUodC5yZWZlcmVuY2VWYWx1ZSwgZSk7IGVsc2UgaWYgKFwiZ2VvUG9pbnRWYWx1ZVwiIGluIHQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0Lmdlb1BvaW50VmFsdWU7XG4gICAgICAgICAgICB0aGlzLmdlKGUsIDQ1KSwgZS55ZShuLmxhdGl0dWRlIHx8IDApLCBlLnllKG4ubG9uZ2l0dWRlIHx8IDApO1xuICAgICAgICB9IGVsc2UgXCJtYXBWYWx1ZVwiIGluIHQgPyBlbih0KSA/IHRoaXMuZ2UoZSwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpIDogKHRoaXMuUmUodC5tYXBWYWx1ZSwgZSksIFxuICAgICAgICB0aGlzLlRlKGUpKSA6IFwiYXJyYXlWYWx1ZVwiIGluIHQgPyAodGhpcy52ZSh0LmFycmF5VmFsdWUsIGUpLCB0aGlzLlRlKGUpKSA6ICQoKTtcbiAgICB9XG4gICAgSWUodCwgZSkge1xuICAgICAgICB0aGlzLmdlKGUsIDI1KSwgdGhpcy5QZSh0LCBlKTtcbiAgICB9XG4gICAgUGUodCwgZSkge1xuICAgICAgICBlLnBlKHQpO1xuICAgIH1cbiAgICBSZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0LmZpZWxkcyB8fCB7fTtcbiAgICAgICAgdGhpcy5nZShlLCA1NSk7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBPYmplY3Qua2V5cyhuKSkgdGhpcy5JZSh0LCBlKSwgdGhpcy53ZShuW3RdLCBlKTtcbiAgICB9XG4gICAgdmUodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdC52YWx1ZXMgfHwgW107XG4gICAgICAgIHRoaXMuZ2UoZSwgNTApO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgbikgdGhpcy53ZSh0LCBlKTtcbiAgICB9XG4gICAgQWUodCwgZSkge1xuICAgICAgICB0aGlzLmdlKGUsIDM3KTtcbiAgICAgICAgaHQuZnJvbU5hbWUodCkucGF0aC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuZ2UoZSwgNjApLCB0aGlzLlBlKHQsIGUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdlKHQsIGUpIHtcbiAgICAgICAgdC55ZShlKTtcbiAgICB9XG4gICAgVGUodCkge1xuICAgICAgICAvLyBXaGlsZSB0aGUgU0RLIGRvZXMgbm90IGltcGxlbWVudCB0cnVuY2F0aW9uLCB0aGUgdHJ1bmNhdGlvbiBtYXJrZXIgaXNcbiAgICAgICAgLy8gdXNlZCB0byB0ZXJtaW5hdGUgYWxsIHZhcmlhYmxlIGxlbmd0aCB2YWx1ZXMgKHdoaWNoIGFyZSBzdHJpbmdzLCBieXRlcyxcbiAgICAgICAgLy8gcmVmZXJlbmNlcywgYXJyYXlzIGFuZCBtYXBzKS5cbiAgICAgICAgdC55ZSgyKTtcbiAgICB9XG59XG5cbmJyLmJlID0gbmV3IGJyO1xuXG4vKipcbiAqIENvdW50cyB0aGUgbnVtYmVyIG9mIHplcm9zIGluIGEgYnl0ZS5cbiAqXG4gKiBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuICovXG5mdW5jdGlvbiBWcih0KSB7XG4gICAgaWYgKDAgPT09IHQpIHJldHVybiA4O1xuICAgIGxldCBlID0gMDtcbiAgICByZXR1cm4gdCA+PiA0ID09IDAgJiYgKFxuICAgIC8vIFRlc3QgaWYgdGhlIGZpcnN0IGZvdXIgYml0cyBhcmUgemVyby5cbiAgICBlICs9IDQsIHQgPDw9IDQpLCB0ID4+IDYgPT0gMCAmJiAoXG4gICAgLy8gVGVzdCBpZiB0aGUgZmlyc3QgdHdvIChvciBuZXh0IHR3bykgYml0cyBhcmUgemVyby5cbiAgICBlICs9IDIsIHQgPDw9IDIpLCB0ID4+IDcgPT0gMCAmJiAoXG4gICAgLy8gVGVzdCBpZiB0aGUgcmVtYWluaW5nIGJpdCBpcyB6ZXJvLlxuICAgIGUgKz0gMSksIGU7XG59XG5cbi8qKiBDb3VudHMgdGhlIG51bWJlciBvZiBsZWFkaW5nIHplcm9zIGluIHRoZSBnaXZlbiBieXRlIGFycmF5LiAqL1xuLyoqXG4gKiBSZXR1cm5zIHRoZSBudW1iZXIgb2YgYnl0ZXMgcmVxdWlyZWQgdG8gc3RvcmUgXCJ2YWx1ZVwiLiBMZWFkaW5nIHplcm8gYnl0ZXNcbiAqIGFyZSBza2lwcGVkLlxuICovXG5mdW5jdGlvbiBTcih0KSB7XG4gICAgLy8gVGhpcyBpcyBqdXN0IHRoZSBudW1iZXIgb2YgYnl0ZXMgZm9yIHRoZSB1bnNpZ25lZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgbnVtYmVyLlxuICAgIGNvbnN0IGUgPSA2NCAtIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICBmb3IgKGxldCBuID0gMDsgbiA8IDg7ICsrbikge1xuICAgICAgICAgICAgY29uc3QgcyA9IFZyKDI1NSAmIHRbbl0pO1xuICAgICAgICAgICAgaWYgKGUgKz0gcywgOCAhPT0gcykgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfSh0KTtcbiAgICByZXR1cm4gTWF0aC5jZWlsKGUgLyA4KTtcbn1cblxuLyoqXG4gKiBPcmRlcmVkQ29kZVdyaXRlciBpcyBhIG1pbmltYWwtYWxsb2NhdGlvbiBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgd3JpdGluZ1xuICogYmVoYXZpb3IgZGVmaW5lZCBieSB0aGUgYmFja2VuZC5cbiAqXG4gKiBUaGUgY29kZSBpcyBwb3J0ZWQgZnJvbSBpdHMgSmF2YSBjb3VudGVycGFydC5cbiAqLyBjbGFzcyBEciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuYnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoMTAyNCksIHRoaXMucG9zaXRpb24gPSAwO1xuICAgIH1cbiAgICBWZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0W1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICAgICAgbGV0IG4gPSBlLm5leHQoKTtcbiAgICAgICAgZm9yICg7IW4uZG9uZTsgKSB0aGlzLlNlKG4udmFsdWUpLCBuID0gZS5uZXh0KCk7XG4gICAgICAgIHRoaXMuRGUoKTtcbiAgICB9XG4gICAgQ2UodCkge1xuICAgICAgICBjb25zdCBlID0gdFtTeW1ib2wuaXRlcmF0b3JdKCk7XG4gICAgICAgIGxldCBuID0gZS5uZXh0KCk7XG4gICAgICAgIGZvciAoOyFuLmRvbmU7ICkgdGhpcy54ZShuLnZhbHVlKSwgbiA9IGUubmV4dCgpO1xuICAgICAgICB0aGlzLk5lKCk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgdXRmOCBieXRlcyBpbnRvIHRoaXMgYnl0ZSBzZXF1ZW5jZSwgYXNjZW5kaW5nLiAqLyAgICBrZSh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0KSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5jaGFyQ29kZUF0KDApO1xuICAgICAgICAgICAgaWYgKHQgPCAxMjgpIHRoaXMuU2UodCk7IGVsc2UgaWYgKHQgPCAyMDQ4KSB0aGlzLlNlKDk2MCB8IHQgPj4+IDYpLCB0aGlzLlNlKDEyOCB8IDYzICYgdCk7IGVsc2UgaWYgKGUgPCBcIlxcdWQ4MDBcIiB8fCBcIlxcdWRiZmZcIiA8IGUpIHRoaXMuU2UoNDgwIHwgdCA+Pj4gMTIpLCBcbiAgICAgICAgICAgIHRoaXMuU2UoMTI4IHwgNjMgJiB0ID4+PiA2KSwgdGhpcy5TZSgxMjggfCA2MyAmIHQpOyBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gZS5jb2RlUG9pbnRBdCgwKTtcbiAgICAgICAgICAgICAgICB0aGlzLlNlKDI0MCB8IHQgPj4+IDE4KSwgdGhpcy5TZSgxMjggfCA2MyAmIHQgPj4+IDEyKSwgdGhpcy5TZSgxMjggfCA2MyAmIHQgPj4+IDYpLCBcbiAgICAgICAgICAgICAgICB0aGlzLlNlKDEyOCB8IDYzICYgdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5EZSgpO1xuICAgIH1cbiAgICAvKiogV3JpdGVzIHV0ZjggYnl0ZXMgaW50byB0aGlzIGJ5dGUgc2VxdWVuY2UsIGRlc2NlbmRpbmcgKi8gICAgTWUodCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdCkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuY2hhckNvZGVBdCgwKTtcbiAgICAgICAgICAgIGlmICh0IDwgMTI4KSB0aGlzLnhlKHQpOyBlbHNlIGlmICh0IDwgMjA0OCkgdGhpcy54ZSg5NjAgfCB0ID4+PiA2KSwgdGhpcy54ZSgxMjggfCA2MyAmIHQpOyBlbHNlIGlmIChlIDwgXCJcXHVkODAwXCIgfHwgXCJcXHVkYmZmXCIgPCBlKSB0aGlzLnhlKDQ4MCB8IHQgPj4+IDEyKSwgXG4gICAgICAgICAgICB0aGlzLnhlKDEyOCB8IDYzICYgdCA+Pj4gNiksIHRoaXMueGUoMTI4IHwgNjMgJiB0KTsgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IGUuY29kZVBvaW50QXQoMCk7XG4gICAgICAgICAgICAgICAgdGhpcy54ZSgyNDAgfCB0ID4+PiAxOCksIHRoaXMueGUoMTI4IHwgNjMgJiB0ID4+PiAxMiksIHRoaXMueGUoMTI4IHwgNjMgJiB0ID4+PiA2KSwgXG4gICAgICAgICAgICAgICAgdGhpcy54ZSgxMjggfCA2MyAmIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuTmUoKTtcbiAgICB9XG4gICAgT2UodCkge1xuICAgICAgICAvLyBWYWx1ZXMgYXJlIGVuY29kZWQgd2l0aCBhIHNpbmdsZSBieXRlIGxlbmd0aCBwcmVmaXgsIGZvbGxvd2VkIGJ5IHRoZVxuICAgICAgICAvLyBhY3R1YWwgdmFsdWUgaW4gYmlnLWVuZGlhbiBmb3JtYXQgd2l0aCBsZWFkaW5nIDAgYnl0ZXMgZHJvcHBlZC5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuJGUodCksIG4gPSBTcihlKTtcbiAgICAgICAgdGhpcy5GZSgxICsgbiksIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSAyNTUgJiBuO1xuICAgICAgICAvLyBXcml0ZSB0aGUgbGVuZ3RoXG4gICAgICAgIGZvciAobGV0IHQgPSBlLmxlbmd0aCAtIG47IHQgPCBlLmxlbmd0aDsgKyt0KSB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gMjU1ICYgZVt0XTtcbiAgICB9XG4gICAgQmUodCkge1xuICAgICAgICAvLyBWYWx1ZXMgYXJlIGVuY29kZWQgd2l0aCBhIHNpbmdsZSBieXRlIGxlbmd0aCBwcmVmaXgsIGZvbGxvd2VkIGJ5IHRoZVxuICAgICAgICAvLyBpbnZlcnRlZCB2YWx1ZSBpbiBiaWctZW5kaWFuIGZvcm1hdCB3aXRoIGxlYWRpbmcgMCBieXRlcyBkcm9wcGVkLlxuICAgICAgICBjb25zdCBlID0gdGhpcy4kZSh0KSwgbiA9IFNyKGUpO1xuICAgICAgICB0aGlzLkZlKDEgKyBuKSwgdGhpcy5idWZmZXJbdGhpcy5wb3NpdGlvbisrXSA9IH4oMjU1ICYgbik7XG4gICAgICAgIC8vIFdyaXRlIHRoZSBsZW5ndGhcbiAgICAgICAgZm9yIChsZXQgdCA9IGUubGVuZ3RoIC0gbjsgdCA8IGUubGVuZ3RoOyArK3QpIHRoaXMuYnVmZmVyW3RoaXMucG9zaXRpb24rK10gPSB+KDI1NSAmIGVbdF0pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBXcml0ZXMgdGhlIFwiaW5maW5pdHlcIiBieXRlIHNlcXVlbmNlIHRoYXQgc29ydHMgYWZ0ZXIgYWxsIG90aGVyIGJ5dGVcbiAgICAgKiBzZXF1ZW5jZXMgd3JpdHRlbiBpbiBhc2NlbmRpbmcgb3JkZXIuXG4gICAgICovICAgIExlKCkge1xuICAgICAgICB0aGlzLnFlKDI1NSksIHRoaXMucWUoMjU1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogV3JpdGVzIHRoZSBcImluZmluaXR5XCIgYnl0ZSBzZXF1ZW5jZSB0aGF0IHNvcnRzIGJlZm9yZSBhbGwgb3RoZXIgYnl0ZVxuICAgICAqIHNlcXVlbmNlcyB3cml0dGVuIGluIGRlc2NlbmRpbmcgb3JkZXIuXG4gICAgICovICAgIFVlKCkge1xuICAgICAgICB0aGlzLktlKDI1NSksIHRoaXMuS2UoMjU1KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBidWZmZXIgc3VjaCB0aGF0IGl0IGlzIHRoZSBzYW1lIGFzIHdoZW4gaXQgd2FzIG5ld2x5XG4gICAgICogY29uc3RydWN0ZWQuXG4gICAgICovICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLnBvc2l0aW9uID0gMDtcbiAgICB9XG4gICAgc2VlZCh0KSB7XG4gICAgICAgIHRoaXMuRmUodC5sZW5ndGgpLCB0aGlzLmJ1ZmZlci5zZXQodCwgdGhpcy5wb3NpdGlvbiksIHRoaXMucG9zaXRpb24gKz0gdC5sZW5ndGg7XG4gICAgfVxuICAgIC8qKiBNYWtlcyBhIGNvcHkgb2YgdGhlIGVuY29kZWQgYnl0ZXMgaW4gdGhpcyBidWZmZXIuICAqLyAgICBHZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLnNsaWNlKDAsIHRoaXMucG9zaXRpb24pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBFbmNvZGVzIGB2YWxgIGludG8gYW4gZW5jb2Rpbmcgc28gdGhhdCB0aGUgb3JkZXIgbWF0Y2hlcyB0aGUgSUVFRSA3NTRcbiAgICAgKiBmbG9hdGluZy1wb2ludCBjb21wYXJpc29uIHJlc3VsdHMgd2l0aCB0aGUgZm9sbG93aW5nIGV4Y2VwdGlvbnM6XG4gICAgICogICAtMC4wIDwgMC4wXG4gICAgICogICBhbGwgbm9uLU5hTiA8IE5hTlxuICAgICAqICAgTmFOID0gTmFOXG4gICAgICovICAgICRlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFxuICAgICAgICAvKiogQ29udmVydHMgYSBKYXZhU2NyaXB0IG51bWJlciB0byBhIGJ5dGUgYXJyYXkgKHVzaW5nIGJpZyBlbmRpYW4gZW5jb2RpbmcpLiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IERhdGFWaWV3KG5ldyBBcnJheUJ1ZmZlcig4KSk7XG4gICAgICAgICAgICByZXR1cm4gZS5zZXRGbG9hdDY0KDAsIHQsIC8qIGxpdHRsZUVuZGlhbj0gKi8gITEpLCBuZXcgVWludDhBcnJheShlLmJ1ZmZlcik7XG4gICAgICAgIH0odCksIG4gPSAwICE9ICgxMjggJiBlWzBdKTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGZpcnN0IGJpdCBpcyBzZXQuIFdlIHVzZSBhIGJpdCBtYXNrIHNpbmNlIHZhbHVlWzBdIGlzXG4gICAgICAgIC8vIGVuY29kZWQgYXMgYSBudW1iZXIgZnJvbSAwIHRvIDI1NS5cbiAgICAgICAgICAgICAgICAvLyBSZXZlcnQgdGhlIHR3byBjb21wbGVtZW50IHRvIGdldCBuYXR1cmFsIG9yZGVyaW5nXG4gICAgICAgIGVbMF0gXj0gbiA/IDI1NSA6IDEyODtcbiAgICAgICAgZm9yIChsZXQgdCA9IDE7IHQgPCBlLmxlbmd0aDsgKyt0KSBlW3RdIF49IG4gPyAyNTUgOiAwO1xuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgLyoqIFdyaXRlcyBhIHNpbmdsZSBieXRlIGFzY2VuZGluZyB0byB0aGUgYnVmZmVyLiAqLyAgICBTZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAyNTUgJiB0O1xuICAgICAgICAwID09PSBlID8gKHRoaXMucWUoMCksIHRoaXMucWUoMjU1KSkgOiAyNTUgPT09IGUgPyAodGhpcy5xZSgyNTUpLCB0aGlzLnFlKDApKSA6IHRoaXMucWUoZSk7XG4gICAgfVxuICAgIC8qKiBXcml0ZXMgYSBzaW5nbGUgYnl0ZSBkZXNjZW5kaW5nIHRvIHRoZSBidWZmZXIuICAqLyAgICB4ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSAyNTUgJiB0O1xuICAgICAgICAwID09PSBlID8gKHRoaXMuS2UoMCksIHRoaXMuS2UoMjU1KSkgOiAyNTUgPT09IGUgPyAodGhpcy5LZSgyNTUpLCB0aGlzLktlKDApKSA6IHRoaXMuS2UodCk7XG4gICAgfVxuICAgIERlKCkge1xuICAgICAgICB0aGlzLnFlKDApLCB0aGlzLnFlKDEpO1xuICAgIH1cbiAgICBOZSgpIHtcbiAgICAgICAgdGhpcy5LZSgwKSwgdGhpcy5LZSgxKTtcbiAgICB9XG4gICAgcWUodCkge1xuICAgICAgICB0aGlzLkZlKDEpLCB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gdDtcbiAgICB9XG4gICAgS2UodCkge1xuICAgICAgICB0aGlzLkZlKDEpLCB0aGlzLmJ1ZmZlclt0aGlzLnBvc2l0aW9uKytdID0gfnQ7XG4gICAgfVxuICAgIEZlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQgKyB0aGlzLnBvc2l0aW9uO1xuICAgICAgICBpZiAoZSA8PSB0aGlzLmJ1ZmZlci5sZW5ndGgpIHJldHVybjtcbiAgICAgICAgLy8gVHJ5IGRvdWJsaW5nLlxuICAgICAgICAgICAgICAgIGxldCBuID0gMiAqIHRoaXMuYnVmZmVyLmxlbmd0aDtcbiAgICAgICAgLy8gU3RpbGwgbm90IGJpZyBlbm91Z2g/IEp1c3QgYWxsb2NhdGUgdGhlIHJpZ2h0IHNpemUuXG4gICAgICAgICAgICAgICAgbiA8IGUgJiYgKG4gPSBlKTtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBuZXcgYnVmZmVyLlxuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgVWludDhBcnJheShuKTtcbiAgICAgICAgcy5zZXQodGhpcy5idWZmZXIpLCAvLyBjb3B5IG9sZCBkYXRhXG4gICAgICAgIHRoaXMuYnVmZmVyID0gcztcbiAgICB9XG59XG5cbmNsYXNzIENyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuUWUgPSB0O1xuICAgIH1cbiAgICBFZSh0KSB7XG4gICAgICAgIHRoaXMuUWUuVmUodCk7XG4gICAgfVxuICAgIHBlKHQpIHtcbiAgICAgICAgdGhpcy5RZS5rZSh0KTtcbiAgICB9XG4gICAgeWUodCkge1xuICAgICAgICB0aGlzLlFlLk9lKHQpO1xuICAgIH1cbiAgICBtZSgpIHtcbiAgICAgICAgdGhpcy5RZS5MZSgpO1xuICAgIH1cbn1cblxuY2xhc3MgeHIge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5RZSA9IHQ7XG4gICAgfVxuICAgIEVlKHQpIHtcbiAgICAgICAgdGhpcy5RZS5DZSh0KTtcbiAgICB9XG4gICAgcGUodCkge1xuICAgICAgICB0aGlzLlFlLk1lKHQpO1xuICAgIH1cbiAgICB5ZSh0KSB7XG4gICAgICAgIHRoaXMuUWUuQmUodCk7XG4gICAgfVxuICAgIG1lKCkge1xuICAgICAgICB0aGlzLlFlLlVlKCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEltcGxlbWVudHMgYERpcmVjdGlvbmFsSW5kZXhCeXRlRW5jb2RlcmAgdXNpbmcgYE9yZGVyZWRDb2RlV3JpdGVyYCBmb3IgdGhlXG4gKiBhY3R1YWwgZW5jb2RpbmcuXG4gKi8gY2xhc3MgTnIge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLlFlID0gbmV3IERyLCB0aGlzLmplID0gbmV3IENyKHRoaXMuUWUpLCB0aGlzLnplID0gbmV3IHhyKHRoaXMuUWUpO1xuICAgIH1cbiAgICBzZWVkKHQpIHtcbiAgICAgICAgdGhpcy5RZS5zZWVkKHQpO1xuICAgIH1cbiAgICBXZSh0KSB7XG4gICAgICAgIHJldHVybiAwIC8qIEluZGV4S2luZC5BU0NFTkRJTkcgKi8gPT09IHQgPyB0aGlzLmplIDogdGhpcy56ZTtcbiAgICB9XG4gICAgR2UoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlFlLkdlKCk7XG4gICAgfVxuICAgIHJlc2V0KCkge1xuICAgICAgICB0aGlzLlFlLnJlc2V0KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqIFJlcHJlc2VudHMgYW4gaW5kZXggZW50cnkgc2F2ZWQgYnkgdGhlIFNESyBpbiBwZXJzaXN0ZWQgc3RvcmFnZS4gKi8gY2xhc3Mga3Ige1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5pbmRleElkID0gdCwgdGhpcy5kb2N1bWVudEtleSA9IGUsIHRoaXMuYXJyYXlWYWx1ZSA9IG4sIHRoaXMuZGlyZWN0aW9uYWxWYWx1ZSA9IHM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gSW5kZXhFbnRyeSBlbnRyeSB0aGF0IHNvcnRzIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSBjdXJyZW50XG4gICAgICogZGlyZWN0aW9uYWwgdmFsdWUuXG4gICAgICovICAgIEhlKCkge1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5kaXJlY3Rpb25hbFZhbHVlLmxlbmd0aCwgZSA9IDAgPT09IHQgfHwgMjU1ID09PSB0aGlzLmRpcmVjdGlvbmFsVmFsdWVbdCAtIDFdID8gdCArIDEgOiB0LCBuID0gbmV3IFVpbnQ4QXJyYXkoZSk7XG4gICAgICAgIHJldHVybiBuLnNldCh0aGlzLmRpcmVjdGlvbmFsVmFsdWUsIDApLCBlICE9PSB0ID8gbi5zZXQoWyAwIF0sIHRoaXMuZGlyZWN0aW9uYWxWYWx1ZS5sZW5ndGgpIDogKytuW24ubGVuZ3RoIC0gMV0sIFxuICAgICAgICBuZXcga3IodGhpcy5pbmRleElkLCB0aGlzLmRvY3VtZW50S2V5LCB0aGlzLmFycmF5VmFsdWUsIG4pO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gTXIodCwgZSkge1xuICAgIGxldCBuID0gdC5pbmRleElkIC0gZS5pbmRleElkO1xuICAgIHJldHVybiAwICE9PSBuID8gbiA6IChuID0gT3IodC5hcnJheVZhbHVlLCBlLmFycmF5VmFsdWUpLCAwICE9PSBuID8gbiA6IChuID0gT3IodC5kaXJlY3Rpb25hbFZhbHVlLCBlLmRpcmVjdGlvbmFsVmFsdWUpLCBcbiAgICAwICE9PSBuID8gbiA6IGh0LmNvbXBhcmF0b3IodC5kb2N1bWVudEtleSwgZS5kb2N1bWVudEtleSkpKTtcbn1cblxuZnVuY3Rpb24gT3IodCwgZSkge1xuICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGggJiYgbiA8IGUubGVuZ3RoOyArK24pIHtcbiAgICAgICAgY29uc3QgcyA9IHRbbl0gLSBlW25dO1xuICAgICAgICBpZiAoMCAhPT0gcykgcmV0dXJuIHM7XG4gICAgfVxuICAgIHJldHVybiB0Lmxlbmd0aCAtIGUubGVuZ3RoO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGxpZ2h0IHF1ZXJ5IHBsYW5uZXIgZm9yIEZpcmVzdG9yZS5cbiAqXG4gKiBUaGlzIGNsYXNzIG1hdGNoZXMgYSBgRmllbGRJbmRleGAgYWdhaW5zdCBhIEZpcmVzdG9yZSBRdWVyeSBgVGFyZ2V0YC4gSXRcbiAqIGRldGVybWluZXMgd2hldGhlciBhIGdpdmVuIGluZGV4IGNhbiBiZSB1c2VkIHRvIHNlcnZlIHRoZSBzcGVjaWZpZWQgdGFyZ2V0LlxuICpcbiAqIFRoZSBmb2xsb3dpbmcgdGFibGUgc2hvd2Nhc2VzIHNvbWUgcG9zc2libGUgaW5kZXggY29uZmlndXJhdGlvbnM6XG4gKlxuICogUXVlcnkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgSW5kZXhcbiAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gKiB3aGVyZSgnYScsICc9PScsICdhJykud2hlcmUoJ2InLCAnPT0nLCAnYicpICAgICAgICAgfCBhIEFTQywgYiBERVNDXG4gKiB3aGVyZSgnYScsICc9PScsICdhJykud2hlcmUoJ2InLCAnPT0nLCAnYicpICAgICAgICAgfCBhIEFTQ1xuICogd2hlcmUoJ2EnLCAnPT0nLCAnYScpLndoZXJlKCdiJywgJz09JywgJ2InKSAgICAgICAgIHwgYiBERVNDXG4gKiB3aGVyZSgnYScsICc+PScsICdhJykub3JkZXJCeSgnYScpICAgICAgICAgICAgICAgICAgfCBhIEFTQ1xuICogd2hlcmUoJ2EnLCAnPj0nLCAnYScpLm9yZGVyQnkoJ2EnLCAnZGVzYycpICAgICAgICAgIHwgYSBERVNDXG4gKiB3aGVyZSgnYScsICc+PScsICdhJykub3JkZXJCeSgnYScpLm9yZGVyQnkoJ2InKSAgICAgfCBhIEFTQywgYiBBU0NcbiAqIHdoZXJlKCdhJywgJz49JywgJ2EnKS5vcmRlckJ5KCdhJykub3JkZXJCeSgnYicpICAgICB8IGEgQVNDXG4gKiB3aGVyZSgnYScsICdhcnJheS1jb250YWlucycsICdhJykub3JkZXJCeSgnYicpICAgICAgfCBhIENPTlRBSU5TLCBiIEFTQ0VORElOR1xuICogd2hlcmUoJ2EnLCAnYXJyYXktY29udGFpbnMnLCAnYScpLm9yZGVyQnkoJ2InKSAgICAgIHwgYSBDT05UQUlOU1xuICovIGNsYXNzICRyIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuY29sbGVjdGlvbklkID0gbnVsbCAhPSB0LmNvbGxlY3Rpb25Hcm91cCA/IHQuY29sbGVjdGlvbkdyb3VwIDogdC5wYXRoLmxhc3RTZWdtZW50KCksIFxuICAgICAgICB0aGlzLkplID0gdC5vcmRlckJ5LCB0aGlzLlllID0gW107XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmZpbHRlcnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBlO1xuICAgICAgICAgICAgdC5pc0luZXF1YWxpdHkoKSA/IHRoaXMuWGUgPSB0IDogdGhpcy5ZZS5wdXNoKHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciB0aGUgaW5kZXggY2FuIGJlIHVzZWQgdG8gc2VydmUgdGhlIFRhcmdldEluZGV4TWF0Y2hlcidzXG4gICAgICogdGFyZ2V0LlxuICAgICAqXG4gICAgICogQW4gaW5kZXggaXMgY29uc2lkZXJlZCBjYXBhYmxlIG9mIHNlcnZpbmcgdGhlIHRhcmdldCB3aGVuOlxuICAgICAqIC0gVGhlIHRhcmdldCB1c2VzIGFsbCBpbmRleCBzZWdtZW50cyBmb3IgaXRzIGZpbHRlcnMgYW5kIG9yZGVyQnkgY2xhdXNlcy5cbiAgICAgKiAgIFRoZSB0YXJnZXQgY2FuIGhhdmUgYWRkaXRpb25hbCBmaWx0ZXIgYW5kIG9yZGVyQnkgY2xhdXNlcywgYnV0IG5vdFxuICAgICAqICAgZmV3ZXIuXG4gICAgICogLSBJZiBhbiBBcnJheUNvbnRhaW5zL0FycmF5Q29udGFpbnNBbnlmaWx0ZXIgaXMgdXNlZCwgdGhlIGluZGV4IG11c3QgYWxzb1xuICAgICAqICAgaGF2ZSBhIGNvcnJlc3BvbmRpbmcgYENPTlRBSU5TYCBzZWdtZW50LlxuICAgICAqIC0gQWxsIGRpcmVjdGlvbmFsIGluZGV4IHNlZ21lbnRzIGNhbiBiZSBtYXBwZWQgdG8gdGhlIHRhcmdldCBhcyBhIHNlcmllcyBvZlxuICAgICAqICAgZXF1YWxpdHkgZmlsdGVycywgYSBzaW5nbGUgaW5lcXVhbGl0eSBmaWx0ZXIgYW5kIGEgc2VyaWVzIG9mIG9yZGVyQnlcbiAgICAgKiAgIGNsYXVzZXMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhlIGVxdWFsaXR5IGZpbHRlcnMgbWF5IGFwcGVhciBvdXQgb2Ygb3JkZXIuXG4gICAgICogLSBUaGUgb3B0aW9uYWwgc2VnbWVudCBmb3IgdGhlIGluZXF1YWxpdHkgZmlsdGVyIG11c3QgYXBwZWFyIGFmdGVyIGFsbFxuICAgICAqICAgZXF1YWxpdHkgc2VnbWVudHMuXG4gICAgICogLSBUaGUgc2VnbWVudHMgdGhhdCByZXByZXNlbnQgdGhhdCBvcmRlckJ5IGNsYXVzZSBvZiB0aGUgdGFyZ2V0IG11c3QgYXBwZWFyXG4gICAgICogICBpbiBvcmRlciBhZnRlciBhbGwgZXF1YWxpdHkgYW5kIGluZXF1YWxpdHkgc2VnbWVudHMuIFNpbmdsZSBvcmRlckJ5XG4gICAgICogICBjbGF1c2VzIGNhbm5vdCBiZSBza2lwcGVkLCBidXQgYSBjb250aW51b3VzIG9yZGVyQnkgc3VmZml4IG1heSBiZVxuICAgICAqICAgb21pdHRlZC5cbiAgICAgKi8gICAgWmUodCkge1xuICAgICAgICBGKHQuY29sbGVjdGlvbkdyb3VwID09PSB0aGlzLmNvbGxlY3Rpb25JZCk7XG4gICAgICAgIC8vIElmIHRoZXJlIGlzIGFuIGFycmF5IGVsZW1lbnQsIGZpbmQgYSBtYXRjaGluZyBmaWx0ZXIuXG4gICAgICAgIGNvbnN0IGUgPSBmdCh0KTtcbiAgICAgICAgaWYgKHZvaWQgMCAhPT0gZSAmJiAhdGhpcy50bihlKSkgcmV0dXJuICExO1xuICAgICAgICBjb25zdCBuID0gZHQodCk7XG4gICAgICAgIGxldCBzID0gMCwgaSA9IDA7XG4gICAgICAgIC8vIFByb2Nlc3MgYWxsIGVxdWFsaXRpZXMgZmlyc3QuIEVxdWFsaXRpZXMgY2FuIGFwcGVhciBvdXQgb2Ygb3JkZXIuXG4gICAgICAgIGZvciAoO3MgPCBuLmxlbmd0aCAmJiB0aGlzLnRuKG5bc10pOyArK3MpIDtcbiAgICAgICAgLy8gSWYgd2UgYWxyZWFkeSBoYXZlIHByb2Nlc3NlZCBhbGwgc2VnbWVudHMsIGFsbCBzZWdtZW50cyBhcmUgdXNlZCB0byBzZXJ2ZVxuICAgICAgICAvLyB0aGUgZXF1YWxpdHkgZmlsdGVycyBhbmQgd2UgZG8gbm90IG5lZWQgdG8gbWFwIGFueSBzZWdtZW50cyB0byB0aGVcbiAgICAgICAgLy8gdGFyZ2V0J3MgaW5lcXVhbGl0eSBhbmQgb3JkZXJCeSBjbGF1c2VzLlxuICAgICAgICAgICAgICAgIGlmIChzID09PSBuLmxlbmd0aCkgcmV0dXJuICEwO1xuICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBpbmVxdWFsaXR5IGZpbHRlciwgdGhlIG5leHQgc2VnbWVudCBtdXN0IG1hdGNoIGJvdGggdGhlXG4gICAgICAgIC8vIGZpbHRlciBhbmQgdGhlIGZpcnN0IG9yZGVyQnkgY2xhdXNlLlxuICAgICAgICAgICAgICAgIGlmICh2b2lkIDAgIT09IHRoaXMuWGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuW3NdO1xuICAgICAgICAgICAgaWYgKCF0aGlzLmVuKHRoaXMuWGUsIHQpIHx8ICF0aGlzLm5uKHRoaXMuSmVbaSsrXSwgdCkpIHJldHVybiAhMTtcbiAgICAgICAgICAgICsrcztcbiAgICAgICAgfVxuICAgICAgICAvLyBBbGwgcmVtYWluaW5nIHNlZ21lbnRzIG5lZWQgdG8gcmVwcmVzZW50IHRoZSBwcmVmaXggb2YgdGhlIHRhcmdldCdzXG4gICAgICAgIC8vIG9yZGVyQnkuXG4gICAgICAgICAgICAgICAgZm9yICg7cyA8IG4ubGVuZ3RoOyArK3MpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuW3NdO1xuICAgICAgICAgICAgaWYgKGkgPj0gdGhpcy5KZS5sZW5ndGggfHwgIXRoaXMubm4odGhpcy5KZVtpKytdLCB0KSkgcmV0dXJuICExO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhMDtcbiAgICB9XG4gICAgdG4odCkge1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5ZZSkgaWYgKHRoaXMuZW4oZSwgdCkpIHJldHVybiAhMDtcbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbiAgICBlbih0LCBlKSB7XG4gICAgICAgIGlmICh2b2lkIDAgPT09IHQgfHwgIXQuZmllbGQuaXNFcXVhbChlLmZpZWxkUGF0aCkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IFwiYXJyYXktY29udGFpbnNcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOUyAqLyA9PT0gdC5vcCB8fCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gdC5vcDtcbiAgICAgICAgcmV0dXJuIDIgLyogSW5kZXhLaW5kLkNPTlRBSU5TICovID09PSBlLmtpbmQgPT09IG47XG4gICAgfVxuICAgIG5uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICEhdC5maWVsZC5pc0VxdWFsKGUuZmllbGRQYXRoKSAmJiAoMCAvKiBJbmRleEtpbmQuQVNDRU5ESU5HICovID09PSBlLmtpbmQgJiYgXCJhc2NcIiAvKiBEaXJlY3Rpb24uQVNDRU5ESU5HICovID09PSB0LmRpciB8fCAxIC8qIEluZGV4S2luZC5ERVNDRU5ESU5HICovID09PSBlLmtpbmQgJiYgXCJkZXNjXCIgLyogRGlyZWN0aW9uLkRFU0NFTkRJTkcgKi8gPT09IHQuZGlyKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFByb3ZpZGVzIHV0aWxpdHkgZnVuY3Rpb25zIHRoYXQgaGVscCB3aXRoIGJvb2xlYW4gbG9naWMgdHJhbnNmb3JtYXRpb25zIG5lZWRlZCBmb3IgaGFuZGxpbmdcbiAqIGNvbXBsZXggZmlsdGVycyB1c2VkIGluIHF1ZXJpZXMuXG4gKi9cbi8qKlxuICogVGhlIGBpbmAgZmlsdGVyIGlzIG9ubHkgYSBzeW50YWN0aWMgc3VnYXIgb3ZlciBhIGRpc2p1bmN0aW9uIG9mIGVxdWFsaXRpZXMuIEZvciBpbnN0YW5jZTogYGEgaW5cbiAqIFsxLDIsM11gIGlzIGluIGZhY3QgYGE9PTEgfHwgYT09MiB8fCBhPT0zYC4gVGhpcyBtZXRob2QgZXhwYW5kcyBhbnkgYGluYCBmaWx0ZXIgaW4gdGhlIGdpdmVuXG4gKiBpbnB1dCBpbnRvIGEgZGlzanVuY3Rpb24gb2YgZXF1YWxpdHkgZmlsdGVycyBhbmQgcmV0dXJucyB0aGUgZXhwYW5kZWQgZmlsdGVyLlxuICovIGZ1bmN0aW9uIEZyKHQpIHtcbiAgICB2YXIgZSwgbjtcbiAgICBpZiAoRih0IGluc3RhbmNlb2YgbW4gfHwgdCBpbnN0YW5jZW9mIGduKSwgdCBpbnN0YW5jZW9mIG1uKSB7XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgQ24pIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSAobnVsbCA9PT0gKG4gPSBudWxsID09PSAoZSA9IHQudmFsdWUuYXJyYXlWYWx1ZSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS52YWx1ZXMpIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4ubWFwKChlID0+IG1uLmNyZWF0ZSh0LmZpZWxkLCBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gLCBlKSkpKSB8fCBbXTtcbiAgICAgICAgICAgIHJldHVybiBnbi5jcmVhdGUocywgXCJvclwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLk9SICovKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBXZSBoYXZlIHJlYWNoZWQgb3RoZXIga2luZHMgb2YgZmllbGQgZmlsdGVycy5cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuICAgIC8vIFdlIGhhdmUgYSBjb21wb3NpdGUgZmlsdGVyLlxuICAgICAgICBjb25zdCBzID0gdC5maWx0ZXJzLm1hcCgodCA9PiBGcih0KSkpO1xuICAgIHJldHVybiBnbi5jcmVhdGUocywgdC5vcCk7XG59XG5cbi8qKlxuICogR2l2ZW4gYSBjb21wb3NpdGUgZmlsdGVyLCByZXR1cm5zIHRoZSBsaXN0IG9mIHRlcm1zIGluIGl0cyBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybS5cbiAqXG4gKiA8cD5FYWNoIGVsZW1lbnQgaW4gdGhlIHJldHVybiB2YWx1ZSBpcyBvbmUgdGVybSBvZiB0aGUgcmVzdWx0aW5nIERORi4gRm9yIGluc3RhbmNlOiBGb3IgdGhlXG4gKiBpbnB1dDogKEEgfHwgQikgJiYgQywgdGhlIERORiBmb3JtIGlzOiAoQSAmJiBDKSB8fCAoQiAmJiBDKSwgYW5kIHRoZSByZXR1cm4gdmFsdWUgaXMgYSBsaXN0XG4gKiB3aXRoIHR3byBlbGVtZW50czogYSBjb21wb3NpdGUgZmlsdGVyIHRoYXQgcGVyZm9ybXMgKEEgJiYgQyksIGFuZCBhIGNvbXBvc2l0ZSBmaWx0ZXIgdGhhdFxuICogcGVyZm9ybXMgKEIgJiYgQykuXG4gKlxuICogQHBhcmFtIGZpbHRlciB0aGUgY29tcG9zaXRlIGZpbHRlciB0byBjYWxjdWxhdGUgRE5GIHRyYW5zZm9ybSBmb3IuXG4gKiBAcmV0dXJuIHRoZSB0ZXJtcyBpbiB0aGUgRE5GIHRyYW5zZm9ybS5cbiAqLyBmdW5jdGlvbiBCcih0KSB7XG4gICAgaWYgKDAgPT09IHQuZ2V0RmlsdGVycygpLmxlbmd0aCkgcmV0dXJuIFtdO1xuICAgIGNvbnN0IGUgPSBLcihGcih0KSk7XG4gICAgcmV0dXJuIEYoVXIoZSkpLCBMcihlKSB8fCBxcihlKSA/IFsgZSBdIDogZS5nZXRGaWx0ZXJzKCk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGZpbHRlciBpcyBhIHNpbmdsZSBmaWVsZCBmaWx0ZXIuIGUuZy4gKGEgPT0gMTApLiAqLyBmdW5jdGlvbiBMcih0KSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBtbjtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIGdpdmVuIGZpbHRlciBpcyB0aGUgY29uanVuY3Rpb24gb2Ygb25lIG9yIG1vcmUgZmllbGQgZmlsdGVycy4gZS5nLiAoYSA9PSAxMFxuICogJiYgYiA9PSAyMClcbiAqLyBmdW5jdGlvbiBxcih0KSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBnbiAmJiBJbih0KTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBnaXZlbiBmaWx0ZXIgaXMgaW4gZGlzanVuY3RpdmUgbm9ybWFsIGZvcm0gKERORikuXG4gKlxuICogPHA+SW4gYm9vbGVhbiBsb2dpYywgYSBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybSAoRE5GKSBpcyBhIGNhbm9uaWNhbCBub3JtYWwgZm9ybSBvZiBhIGxvZ2ljYWxcbiAqIGZvcm11bGEgY29uc2lzdGluZyBvZiBhIGRpc2p1bmN0aW9uIG9mIGNvbmp1bmN0aW9uczsgaXQgY2FuIGFsc28gYmUgZGVzY3JpYmVkIGFzIGFuIE9SIG9mIEFORHMuXG4gKlxuICogPHA+Rm9yIG1vcmUgaW5mbywgdmlzaXQ6IGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Rpc2p1bmN0aXZlX25vcm1hbF9mb3JtXG4gKi8gZnVuY3Rpb24gVXIodCkge1xuICAgIHJldHVybiBMcih0KSB8fCBxcih0KSB8fCBcbiAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgZ2l2ZW4gZmlsdGVyIGlzIHRoZSBkaXNqdW5jdGlvbiBvZiBvbmUgb3IgbW9yZSBcImZsYXQgY29uanVuY3Rpb25zXCIgYW5kXG4gKiBmaWVsZCBmaWx0ZXJzLiBlLmcuIChhID09IDEwKSB8fCAoYj09MjAgJiYgYz09MzApXG4gKi9cbiAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgZ24gJiYgcG4odCkpIHtcbiAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0LmdldEZpbHRlcnMoKSkgaWYgKCFMcihlKSAmJiAhcXIoZSkpIHJldHVybiAhMTtcbiAgICAgICAgICAgIHJldHVybiAhMDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gITE7XG4gICAgfSh0KTtcbn1cblxuZnVuY3Rpb24gS3IodCkge1xuICAgIGlmIChGKHQgaW5zdGFuY2VvZiBtbiB8fCB0IGluc3RhbmNlb2YgZ24pLCB0IGluc3RhbmNlb2YgbW4pIHJldHVybiB0O1xuICAgIGlmICgxID09PSB0LmZpbHRlcnMubGVuZ3RoKSByZXR1cm4gS3IodC5maWx0ZXJzWzBdKTtcbiAgICAvLyBDb21wdXRlIERORiBmb3IgZWFjaCBvZiB0aGUgc3ViZmlsdGVycyBmaXJzdFxuICAgICAgICBjb25zdCBlID0gdC5maWx0ZXJzLm1hcCgodCA9PiBLcih0KSkpO1xuICAgIGxldCBuID0gZ24uY3JlYXRlKGUsIHQub3ApO1xuICAgIHJldHVybiBuID0ganIobiksIFVyKG4pID8gbiA6IChGKG4gaW5zdGFuY2VvZiBnbiksIEYoeW4obikpLCBGKG4uZmlsdGVycy5sZW5ndGggPiAxKSwgXG4gICAgbi5maWx0ZXJzLnJlZHVjZSgoKHQsIGUpID0+IEdyKHQsIGUpKSkpO1xufVxuXG5mdW5jdGlvbiBHcih0LCBlKSB7XG4gICAgbGV0IG47XG4gICAgcmV0dXJuIEYodCBpbnN0YW5jZW9mIG1uIHx8IHQgaW5zdGFuY2VvZiBnbiksIEYoZSBpbnN0YW5jZW9mIG1uIHx8IGUgaW5zdGFuY2VvZiBnbiksIFxuICAgIC8vIEZpZWxkRmlsdGVyIEZpZWxkRmlsdGVyXG4gICAgbiA9IHQgaW5zdGFuY2VvZiBtbiA/IGUgaW5zdGFuY2VvZiBtbiA/IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgLy8gQ29uanVuY3Rpb24gZGlzdHJpYnV0aW9uIGZvciB0d28gZmllbGQgZmlsdGVycyBpcyB0aGUgY29uanVuY3Rpb24gb2YgdGhlbS5cbiAgICAgICAgcmV0dXJuIGduLmNyZWF0ZShbIHQsIGUgXSwgXCJhbmRcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5BTkQgKi8pO1xuICAgIH0odCwgZSkgOiBRcih0LCBlKSA6IGUgaW5zdGFuY2VvZiBtbiA/IFFyKGUsIHQpIDogZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAvLyBUaGVyZSBhcmUgZm91ciBjYXNlczpcbiAgICAgICAgLy8gKEEgJiBCKSAmIChDICYgRCkgLS0+IChBICYgQiAmIEMgJiBEKVxuICAgICAgICAvLyAoQSAmIEIpICYgKEMgfCBEKSAtLT4gKEEgJiBCICYgQykgfCAoQSAmIEIgJiBEKVxuICAgICAgICAvLyAoQSB8IEIpICYgKEMgJiBEKSAtLT4gKEMgJiBEICYgQSkgfCAoQyAmIEQgJiBCKVxuICAgICAgICAvLyAoQSB8IEIpICYgKEMgfCBEKSAtLT4gKEEgJiBDKSB8IChBICYgRCkgfCAoQiAmIEMpIHwgKEIgJiBEKVxuICAgICAgICAvLyBDYXNlIDEgaXMgYSBtZXJnZS5cbiAgICAgICAgaWYgKEYodC5maWx0ZXJzLmxlbmd0aCA+IDAgJiYgZS5maWx0ZXJzLmxlbmd0aCA+IDApLCB5bih0KSAmJiB5bihlKSkgcmV0dXJuIFJuKHQsIGUuZ2V0RmlsdGVycygpKTtcbiAgICAgICAgLy8gQ2FzZSAyLDMsNCBhbGwgaGF2ZSBhdCBsZWFzdCBvbmUgc2lkZSAobGhzIG9yIHJocykgdGhhdCBpcyBhIGRpc2p1bmN0aW9uLiBJbiBhbGwgdGhyZWUgY2FzZXNcbiAgICAgICAgLy8gd2Ugc2hvdWxkIHRha2UgZWFjaCBlbGVtZW50IG9mIHRoZSBkaXNqdW5jdGlvbiBhbmQgZGlzdHJpYnV0ZSBpdCBvdmVyIHRoZSBvdGhlciBzaWRlLCBhbmRcbiAgICAgICAgLy8gcmV0dXJuIHRoZSBkaXNqdW5jdGlvbiBvZiB0aGUgZGlzdHJpYnV0aW9uIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHBuKHQpID8gdCA6IGUsIHMgPSBwbih0KSA/IGUgOiB0LCBpID0gbi5maWx0ZXJzLm1hcCgodCA9PiBHcih0LCBzKSkpO1xuICAgICAgICByZXR1cm4gZ24uY3JlYXRlKGksIFwib3JcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5PUiAqLyk7XG4gICAgfSh0LCBlKSwganIobik7XG59XG5cbmZ1bmN0aW9uIFFyKHQsIGUpIHtcbiAgICAvLyBUaGVyZSBhcmUgdHdvIGNhc2VzOlxuICAgIC8vIEEgJiAoQiAmIEMpIC0tPiAoQSAmIEIgJiBDKVxuICAgIC8vIEEgJiAoQiB8IEMpIC0tPiAoQSAmIEIpIHwgKEEgJiBDKVxuICAgIGlmICh5bihlKSkgXG4gICAgLy8gQ2FzZSAxXG4gICAgcmV0dXJuIFJuKGUsIHQuZ2V0RmlsdGVycygpKTtcbiAgICB7XG4gICAgICAgIC8vIENhc2UgMlxuICAgICAgICBjb25zdCBuID0gZS5maWx0ZXJzLm1hcCgoZSA9PiBHcih0LCBlKSkpO1xuICAgICAgICByZXR1cm4gZ24uY3JlYXRlKG4sIFwib3JcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5PUiAqLyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgdGhlIGFzc29jaWF0aXZpdHkgcHJvcGVydHkgdG8gdGhlIGdpdmVuIGZpbHRlciBhbmQgcmV0dXJucyB0aGUgcmVzdWx0aW5nIGZpbHRlci5cbiAqXG4gKiA8dWw+XG4gKiAgIDxsaT5BIHwgKEIgfCBDKSA9PSAoQSB8IEIpIHwgQyA9PSAoQSB8IEIgfCBDKVxuICogICA8bGk+QSAmIChCICYgQykgPT0gKEEgJiBCKSAmIEMgPT0gKEEgJiBCICYgQylcbiAqIDwvdWw+XG4gKlxuICogPHA+Rm9yIG1vcmUgaW5mbywgdmlzaXQ6IGh0dHBzOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0Fzc29jaWF0aXZlX3Byb3BlcnR5I1Byb3Bvc2l0aW9uYWxfbG9naWNcbiAqLyBmdW5jdGlvbiBqcih0KSB7XG4gICAgaWYgKEYodCBpbnN0YW5jZW9mIG1uIHx8IHQgaW5zdGFuY2VvZiBnbiksIHQgaW5zdGFuY2VvZiBtbikgcmV0dXJuIHQ7XG4gICAgY29uc3QgZSA9IHQuZ2V0RmlsdGVycygpO1xuICAgIC8vIElmIHRoZSBjb21wb3NpdGUgZmlsdGVyIG9ubHkgY29udGFpbnMgMSBmaWx0ZXIsIGFwcGx5IGFzc29jaWF0aXZpdHkgdG8gaXQuXG4gICAgICAgIGlmICgxID09PSBlLmxlbmd0aCkgcmV0dXJuIGpyKGVbMF0pO1xuICAgIC8vIEFzc29jaWF0aXZpdHkgYXBwbGllZCB0byBhIGZsYXQgY29tcG9zaXRlIGZpbHRlciByZXN1bHRzIGlzIGl0c2VsZi5cbiAgICAgICAgaWYgKFRuKHQpKSByZXR1cm4gdDtcbiAgICAvLyBGaXJzdCBhcHBseSBhc3NvY2lhdGl2aXR5IHRvIGFsbCBzdWJmaWx0ZXJzLiBUaGlzIHdpbGwgaW4gdHVybiByZWN1cnNpdmVseSBhcHBseVxuICAgIC8vIGFzc29jaWF0aXZpdHkgdG8gYWxsIG5lc3RlZCBjb21wb3NpdGUgZmlsdGVycyBhbmQgZmllbGQgZmlsdGVycy5cbiAgICAgICAgY29uc3QgbiA9IGUubWFwKCh0ID0+IGpyKHQpKSksIHMgPSBbXTtcbiAgICAvLyBGb3IgY29tcG9zaXRlIHN1YmZpbHRlcnMgdGhhdCBwZXJmb3JtIHRoZSBzYW1lIGtpbmQgb2YgbG9naWNhbCBvcGVyYXRpb24gYXMgYGNvbXBvc2l0ZUZpbHRlcmBcbiAgICAvLyB0YWtlIG91dCB0aGVpciBmaWx0ZXJzIGFuZCBhZGQgdGhlbSB0byBgY29tcG9zaXRlRmlsdGVyYC4gRm9yIGV4YW1wbGU6XG4gICAgLy8gY29tcG9zaXRlRmlsdGVyID0gKEEgfCAoQiB8IEMgfCBEKSlcbiAgICAvLyBjb21wb3NpdGVTdWJmaWx0ZXIgPSAoQiB8IEMgfCBEKVxuICAgIC8vIFJlc3VsdDogKEEgfCBCIHwgQyB8IEQpXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBgY29tcG9zaXRlU3ViZmlsdGVyYCBoYXMgYmVlbiBlbGltaW5hdGVkLCBhbmQgaXRzIGZpbHRlcnMgKEIsIEMsIEQpIGhhdmUgYmVlblxuICAgIC8vIGFkZGVkIHRvIHRoZSB0b3AtbGV2ZWwgXCJjb21wb3NpdGVGaWx0ZXJcIi5cbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgIGUgaW5zdGFuY2VvZiBtbiA/IHMucHVzaChlKSA6IGUgaW5zdGFuY2VvZiBnbiAmJiAoZS5vcCA9PT0gdC5vcCA/IFxuICAgICAgICAvLyBjb21wb3NpdGVGaWx0ZXI6IChBIHwgKEIgfCBDKSlcbiAgICAgICAgLy8gY29tcG9zaXRlU3ViZmlsdGVyOiAoQiB8IEMpXG4gICAgICAgIC8vIFJlc3VsdDogKEEgfCBCIHwgQylcbiAgICAgICAgcy5wdXNoKC4uLmUuZmlsdGVycykgOiBcbiAgICAgICAgLy8gY29tcG9zaXRlRmlsdGVyOiAoQSB8IChCICYgQykpXG4gICAgICAgIC8vIGNvbXBvc2l0ZVN1YmZpbHRlcjogKEIgJiBDKVxuICAgICAgICAvLyBSZXN1bHQ6IChBIHwgKEIgJiBDKSlcbiAgICAgICAgcy5wdXNoKGUpKTtcbiAgICB9KSksIDEgPT09IHMubGVuZ3RoID8gc1swXSA6IGduLmNyZWF0ZShzLCB0Lm9wKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqLyBjbGFzcyB6ciB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc24gPSBuZXcgV3I7XG4gICAgfVxuICAgIGFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc24uYWRkKGUpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldENvbGxlY3Rpb25QYXJlbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUodGhpcy5zbi5nZXRFbnRyaWVzKGUpKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ1RhcmdldCh0LCBlKSB7XG4gICAgICAgIC8vIEZpZWxkIGluZGljZXMgYXJlIG5vdCBzdXBwb3J0ZWQgd2l0aCBtZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKG51bGwpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUodCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSgwIC8qIEluZGV4VHlwZS5OT05FICovKTtcbiAgICB9XG4gICAgZ2V0RmllbGRJbmRleGVzKHQsIGUpIHtcbiAgICAgICAgLy8gRmllbGQgaW5kaWNlcyBhcmUgbm90IHN1cHBvcnRlZCB3aXRoIG1lbW9yeSBwZXJzaXN0ZW5jZS5cbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoW10pO1xuICAgIH1cbiAgICBnZXROZXh0Q29sbGVjdGlvbkdyb3VwVG9VcGRhdGUodCkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZShudWxsKTtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoSXQubWluKCkpO1xuICAgIH1cbiAgICBnZXRNaW5PZmZzZXRGcm9tQ29sbGVjdGlvbkdyb3VwKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoSXQubWluKCkpO1xuICAgIH1cbiAgICB1cGRhdGVDb2xsZWN0aW9uR3JvdXAodCwgZSwgbikge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICB1cGRhdGVJbmRleEVudHJpZXModCwgZSkge1xuICAgICAgICAvLyBGaWVsZCBpbmRpY2VzIGFyZSBub3Qgc3VwcG9ydGVkIHdpdGggbWVtb3J5IHBlcnNpc3RlbmNlLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbnRlcm5hbCBpbXBsZW1lbnRhdGlvbiBvZiB0aGUgY29sbGVjdGlvbi1wYXJlbnQgaW5kZXggZXhwb3NlZCBieSBNZW1vcnlJbmRleE1hbmFnZXIuXG4gKiBBbHNvIHVzZWQgZm9yIGluLW1lbW9yeSBjYWNoaW5nIGJ5IEluZGV4ZWREYkluZGV4TWFuYWdlciBhbmQgaW5pdGlhbCBpbmRleCBwb3B1bGF0aW9uXG4gKiBpbiBpbmRleGVkZGJfc2NoZW1hLnRzXG4gKi8gY2xhc3MgV3Ige1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmluZGV4ID0ge307XG4gICAgfVxuICAgIC8vIFJldHVybnMgZmFsc2UgaWYgdGhlIGVudHJ5IGFscmVhZHkgZXhpc3RlZC5cbiAgICBhZGQodCkge1xuICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBuID0gdC5wb3BMYXN0KCksIHMgPSB0aGlzLmluZGV4W2VdIHx8IG5ldyBFZSh1dC5jb21wYXJhdG9yKSwgaSA9ICFzLmhhcyhuKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhbZV0gPSBzLmFkZChuKSwgaTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQubGFzdFNlZ21lbnQoKSwgbiA9IHQucG9wTGFzdCgpLCBzID0gdGhpcy5pbmRleFtlXTtcbiAgICAgICAgcmV0dXJuIHMgJiYgcy5oYXMobik7XG4gICAgfVxuICAgIGdldEVudHJpZXModCkge1xuICAgICAgICByZXR1cm4gKHRoaXMuaW5kZXhbdF0gfHwgbmV3IEVlKHV0LmNvbXBhcmF0b3IpKS50b0FycmF5KCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCBIciA9IG5ldyBVaW50OEFycmF5KDApO1xuXG4vKipcbiAqIEEgcGVyc2lzdGVkIGltcGxlbWVudGF0aW9uIG9mIEluZGV4TWFuYWdlci5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IFVubGlrZSBpT1MgYW5kIEFuZHJvaWQsIHRoZSBXZWIgU0RLIGRvZXMgbm90IG1lbW9pemUgaW5kZXhcbiAqIGRhdGEgYXMgaXQgc3VwcG9ydHMgbXVsdGktdGFiIGFjY2Vzcy5cbiAqL1xuY2xhc3MgSnIge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy51c2VyID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBbiBpbi1tZW1vcnkgY29weSBvZiB0aGUgaW5kZXggZW50cmllcyB3ZSd2ZSBhbHJlYWR5IHdyaXR0ZW4gc2luY2UgdGhlIFNES1xuICAgICAgICAgKiBsYXVuY2hlZC4gVXNlZCB0byBhdm9pZCByZS13cml0aW5nIHRoZSBzYW1lIGVudHJ5IHJlcGVhdGVkbHkuXG4gICAgICAgICAqXG4gICAgICAgICAqIFRoaXMgaXMgKk5PVCogYSBjb21wbGV0ZSBjYWNoZSBvZiB3aGF0J3MgaW4gcGVyc2lzdGVuY2UgYW5kIHNvIGNhbiBuZXZlciBiZVxuICAgICAgICAgKiB1c2VkIHRvIHNhdGlzZnkgcmVhZHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnJuID0gbmV3IFdyLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgZnJvbSBhIHRhcmdldCB0byBpdHMgZXF1aXZhbGVudCBsaXN0IG9mIHN1Yi10YXJnZXRzLiBFYWNoIHN1Yi10YXJnZXRcbiAgICAgICAgICogY29udGFpbnMgb25seSBvbmUgdGVybSBmcm9tIHRoZSB0YXJnZXQncyBkaXNqdW5jdGl2ZSBub3JtYWwgZm9ybSAoRE5GKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMub24gPSBuZXcgb3MoKHQgPT4gT24odCkpLCAoKHQsIGUpID0+ICRuKHQsIGUpKSksIHRoaXMudWlkID0gdC51aWQgfHwgXCJcIjtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyBhIG5ldyBlbnRyeSB0byB0aGUgY29sbGVjdGlvbiBwYXJlbnQgaW5kZXguXG4gICAgICpcbiAgICAgKiBSZXBlYXRlZCBjYWxscyBmb3IgdGhlIHNhbWUgY29sbGVjdGlvblBhdGggc2hvdWxkIGJlIGF2b2lkZWQgd2l0aGluIGFcbiAgICAgKiB0cmFuc2FjdGlvbiBhcyBJbmRleGVkRGJJbmRleE1hbmFnZXIgb25seSBjYWNoZXMgd3JpdGVzIG9uY2UgYSB0cmFuc2FjdGlvblxuICAgICAqIGhhcyBiZWVuIGNvbW1pdHRlZC5cbiAgICAgKi8gICAgYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgZSkge1xuICAgICAgICBpZiAoIXRoaXMucm4uaGFzKGUpKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5sYXN0U2VnbWVudCgpLCBzID0gZS5wb3BMYXN0KCk7XG4gICAgICAgICAgICB0LmFkZE9uQ29tbWl0dGVkTGlzdGVuZXIoKCgpID0+IHtcbiAgICAgICAgICAgICAgICAvLyBBZGQgdGhlIGNvbGxlY3Rpb24gdG8gdGhlIGluIG1lbW9yeSBjYWNoZSBvbmx5IGlmIHRoZSB0cmFuc2FjdGlvbiB3YXNcbiAgICAgICAgICAgICAgICAvLyBzdWNjZXNzZnVsbHkgY29tbWl0dGVkLlxuICAgICAgICAgICAgICAgIHRoaXMucm4uYWRkKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgY29uc3QgaSA9IHtcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uSWQ6IG4sXG4gICAgICAgICAgICAgICAgcGFyZW50OiBxdChzKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBZcih0KS5wdXQoaSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0Q29sbGVjdGlvblBhcmVudHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW10sIHMgPSBJREJLZXlSYW5nZS5ib3VuZChbIGUsIFwiXCIgXSwgWyBzdChlKSwgXCJcIiBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCk7XG4gICAgICAgIHJldHVybiBZcih0KS5qKHMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIGNvbGxlY3Rpb25JZCBndWFyZCBzaG91bGRuJ3QgYmUgbmVjZXNzYXJ5IChhbmQgaXNuJ3QgYXMgbG9uZ1xuICAgICAgICAgICAgICAgIC8vIGFzIHdlJ3JlIHJ1bm5pbmcgaW4gYSByZWFsIGJyb3dzZXIpLCBidXQgdGhlcmUncyBhIGJ1ZyBpblxuICAgICAgICAgICAgICAgIC8vIGluZGV4ZWRkYnNoaW0gdGhhdCBicmVha3Mgb3VyIHJhbmdlIGluIG91ciB0ZXN0cyBydW5uaW5nIGluIG5vZGU6XG4gICAgICAgICAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2F4ZW1jbGlvbi9JbmRleGVkREJTaGltL2lzc3Vlcy8zMzRcbiAgICAgICAgICAgICAgICBpZiAocy5jb2xsZWN0aW9uSWQgIT09IGUpIGJyZWFrO1xuICAgICAgICAgICAgICAgIG4ucHVzaChHdChzLnBhcmVudCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgYWRkRmllbGRJbmRleCh0LCBlKSB7XG4gICAgICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBWZXJpZnkgdGhhdCB0aGUgYXV0by1pbmNyZW1lbnRpbmcgaW5kZXggSUQgd29ya3MgaW5cbiAgICAgICAgLy8gU2FmYXJpICYgRmlyZWZveC5cbiAgICAgICAgY29uc3QgbiA9IFpyKHQpLCBzID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBpbmRleElkOiB0LmluZGV4SWQsXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbkdyb3VwOiB0LmNvbGxlY3Rpb25Hcm91cCxcbiAgICAgICAgICAgICAgICBmaWVsZHM6IHQuZmllbGRzLm1hcCgodCA9PiBbIHQuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCB0LmtpbmQgXSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICB9KGUpO1xuICAgICAgICBkZWxldGUgcy5pbmRleElkO1xuICAgICAgICAvLyBgaW5kZXhJZGAgaXMgYXV0by1wb3B1bGF0ZWQgYnkgSW5kZXhlZERiXG4gICAgICAgIGNvbnN0IGkgPSBuLmFkZChzKTtcbiAgICAgICAgaWYgKGUuaW5kZXhTdGF0ZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRvKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgbi5wdXQoVHIodCwgdGhpcy51c2VyLCBlLmluZGV4U3RhdGUuc2VxdWVuY2VOdW1iZXIsIGUuaW5kZXhTdGF0ZS5vZmZzZXQpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaS5uZXh0KCk7XG4gICAgfVxuICAgIGRlbGV0ZUZpZWxkSW5kZXgodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gWnIodCksIHMgPSB0byh0KSwgaSA9IFhyKHQpO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUoZS5pbmRleElkKS5uZXh0KCgoKSA9PiBzLmRlbGV0ZShJREJLZXlSYW5nZS5ib3VuZChbIGUuaW5kZXhJZCBdLCBbIGUuaW5kZXhJZCArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApKSkpLm5leHQoKCgpID0+IGkuZGVsZXRlKElEQktleVJhbmdlLmJvdW5kKFsgZS5pbmRleElkIF0sIFsgZS5pbmRleElkICsgMSBdLCBcbiAgICAgICAgLypsb3dlck9wZW49Ki8gITEsIFxuICAgICAgICAvKnVwcGVyT3Blbj0qLyAhMCkpKSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFhyKHQpO1xuICAgICAgICBsZXQgcyA9ICEwO1xuICAgICAgICBjb25zdCBpID0gbmV3IE1hcDtcbiAgICAgICAgcmV0dXJuIHZ0LmZvckVhY2godGhpcy51bihlKSwgKGUgPT4gdGhpcy5jbih0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHMgJiYgKHMgPSAhIXQpLCBpLnNldChlLCB0KTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHMpIHtcbiAgICAgICAgICAgICAgICBsZXQgdCA9IGdzKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICAgICAgICAgIHJldHVybiB2dC5mb3JFYWNoKGksICgoaSwgcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbztcbiAgICAgICAgICAgICAgICAgICAgTihcIkluZGV4ZWREYkluZGV4TWFuYWdlclwiLCBgVXNpbmcgaW5kZXggJHtvID0gaSwgYGlkPSR7by5pbmRleElkfXxjZz0ke28uY29sbGVjdGlvbkdyb3VwfXxmPSR7by5maWVsZHMubWFwKCh0ID0+IGAke3QuZmllbGRQYXRofToke3Qua2luZH1gKSkuam9pbihcIixcIil9YH0gdG8gZXhlY3V0ZSAke09uKGUpfWApO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1ID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGZ0KGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZvaWQgMCA9PT0gbikgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgQm4odCwgbi5maWVsZFBhdGgpKSBzd2l0Y2ggKGUub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGUudmFsdWUuYXJyYXlWYWx1ZS52YWx1ZXMgfHwgW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcImFycmF5LWNvbnRhaW5zXCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlMgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbIGUudmFsdWUgXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1haW5pbmcgZmlsdGVycyBhcmUgbm90IGFycmF5IGZpbHRlcnMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgdGhlIGxpc3Qgb2YgdmFsdWVzIHRoYXQgYXJlIHVzZWQgaW4gIT0gb3IgTk9UX0lOIGZpbHRlcnMuIFJldHVybnNcbiAqIGBudWxsYCBpZiB0aGVyZSBhcmUgbm8gc3VjaCBmaWx0ZXJzLlxuICovIChyLCBpKSwgYyA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIGR0KGUpKSBmb3IgKGNvbnN0IGUgb2YgQm4odCwgcy5maWVsZFBhdGgpKSBzd2l0Y2ggKGUub3ApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIj09XCIgLyogT3BlcmF0b3IuRVFVQUwgKi8gOlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gRW5jb2RlIGVxdWFsaXR5IHByZWZpeCwgd2hpY2ggaXMgZW5jb2RlZCBpbiB0aGUgaW5kZXggdmFsdWUgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGluZXF1YWxpdHkgKGUuZy4gYGEgPT0gJ2EnICYmIGIgIT0gJ2InYCBpcyBlbmNvZGVkIHRvXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYHZhbHVlICE9ICdhYidgKS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnNldChzLmZpZWxkUGF0aC5jYW5vbmljYWxTdHJpbmcoKSwgZS52YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90SW4vTm90RXF1YWwgaXMgYWx3YXlzIGEgc3VmZml4LiBUaGVyZSBjYW5ub3QgYmUgYW55IHJlbWFpbmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlZ21lbnRzIGFuZCBoZW5jZSB3ZSBjYW4gcmV0dXJuIGVhcmx5IGhlcmUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uc2V0KHMuZmllbGRQYXRoLmNhbm9uaWNhbFN0cmluZygpLCBlLnZhbHVlKSwgQXJyYXkuZnJvbShuLnZhbHVlcygpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZW1haW5pbmcgZmlsdGVycyBjYW5ub3QgYmUgdXNlZCBhcyBub3RJbiBib3VuZHMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAvKipcbiAqIFJldHVybnMgYSBsb3dlciBib3VuZCBvZiBmaWVsZCB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCBhcyBhIHN0YXJ0aW5nIHBvaW50IHRvXG4gKiBzY2FuIHRoZSBpbmRleCBkZWZpbmVkIGJ5IGBmaWVsZEluZGV4YC4gUmV0dXJucyBgTUlOX1ZBTFVFYCBpZiBubyBsb3dlciBib3VuZFxuICogZXhpc3RzLlxuICovIChyLCBpKSwgYSA9IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzID0gITA7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3IgZWFjaCBzZWdtZW50LCByZXRyaWV2ZSBhIGxvd2VyIGJvdW5kIGlmIHRoZXJlIGlzIGEgc3VpdGFibGUgZmlsdGVyIG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydEF0LlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIGR0KGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLyA9PT0gaS5raW5kID8gTG4odCwgaS5maWVsZFBhdGgsIHQuc3RhcnRBdCkgOiBxbih0LCBpLmZpZWxkUGF0aCwgdC5zdGFydEF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnB1c2goZS52YWx1ZSksIHMgJiYgKHMgPSBlLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGhuKG4sIHMpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhbiB1cHBlciBib3VuZCBvZiBmaWVsZCB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCBhcyBhbiBlbmRpbmcgcG9pbnRcbiAqIHdoZW4gc2Nhbm5pbmcgdGhlIGluZGV4IGRlZmluZWQgYnkgYGZpZWxkSW5kZXhgLiBSZXR1cm5zIGBNQVhfVkFMVUVgIGlmIG5vXG4gKiB1cHBlciBib3VuZCBleGlzdHMuXG4gKi8gKHIsIGkpLCBoID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHMgPSAhMDtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvciBlYWNoIHNlZ21lbnQsIHJldHJpZXZlIGFuIHVwcGVyIGJvdW5kIGlmIHRoZXJlIGlzIGEgc3VpdGFibGUgZmlsdGVyIG9yXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbmRBdC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgaSBvZiBkdChlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSAwIC8qIEluZGV4S2luZC5BU0NFTkRJTkcgKi8gPT09IGkua2luZCA/IHFuKHQsIGkuZmllbGRQYXRoLCB0LmVuZEF0KSA6IExuKHQsIGkuZmllbGRQYXRoLCB0LmVuZEF0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuLnB1c2goZS52YWx1ZSksIHMgJiYgKHMgPSBlLmluY2x1c2l2ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGhuKG4sIHMpO1xuICAgICAgICAgICAgICAgICAgICB9KHIsIGkpLCBsID0gdGhpcy5hbihpLCByLCBhKSwgZiA9IHRoaXMuYW4oaSwgciwgaCksIGQgPSB0aGlzLmhuKGksIHIsIGMpLCBfID0gdGhpcy5sbihpLmluZGV4SWQsIHUsIGwsIGEuaW5jbHVzaXZlLCBmLCBoLmluY2x1c2l2ZSwgZCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB2dC5mb3JFYWNoKF8sIChpID0+IG4uSChpLCBlLmxpbWl0KS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbiA9IGh0LmZyb21TZWdtZW50cyhlLmRvY3VtZW50S2V5KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0LmhhcyhuKSB8fCAodCA9IHQuYWRkKG4pLCBzLnB1c2gobikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUobnVsbCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgdW4odCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMub24uZ2V0KHQpO1xuICAgICAgICBpZiAoZSkgcmV0dXJuIGU7XG4gICAgICAgIGlmICgwID09PSB0LmZpbHRlcnMubGVuZ3RoKSBlID0gWyB0IF07IGVsc2Uge1xuICAgICAgICAgICAgZSA9IEJyKGduLmNyZWF0ZSh0LmZpbHRlcnMsIFwiYW5kXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuQU5EICovKSkubWFwKChlID0+IE1uKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQub3JkZXJCeSwgZS5nZXRGaWx0ZXJzKCksIHQubGltaXQsIHQuc3RhcnRBdCwgdC5lbmRBdCkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5vbi5zZXQodCwgZSksIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnN0cnVjdHMgYSBrZXkgcmFuZ2UgcXVlcnkgb24gYERiSW5kZXhFbnRyeVN0b3JlYCB0aGF0IHVuaW9ucyBhbGxcbiAgICAgKiBib3VuZHMuXG4gICAgICovICAgIGxuKHQsIGUsIG4sIHMsIGksIHIsIG8pIHtcbiAgICAgICAgLy8gVGhlIG51bWJlciBvZiB0b3RhbCBpbmRleCBzY2FucyB3ZSB1bmlvbiB0b2dldGhlci4gVGhpcyBpcyBzaW1pbGFyIHRvIGFcbiAgICAgICAgLy8gZGlzdHJpYnV0ZWQgbm9ybWFsIGZvcm0sIGJ1dCBhZGFwdGVkIGZvciBhcnJheSB2YWx1ZXMuIFdlIGNyZWF0ZSBhIHNpbmdsZVxuICAgICAgICAvLyBpbmRleCByYW5nZSBwZXIgdmFsdWUgaW4gYW4gQVJSQVlfQ09OVEFJTlMgb3IgQVJSQVlfQ09OVEFJTlNfQU5ZIGZpbHRlclxuICAgICAgICAvLyBjb21iaW5lZCB3aXRoIHRoZSB2YWx1ZXMgZnJvbSB0aGUgcXVlcnkgYm91bmRzLlxuICAgICAgICBjb25zdCB1ID0gKG51bGwgIT0gZSA/IGUubGVuZ3RoIDogMSkgKiBNYXRoLm1heChuLmxlbmd0aCwgaS5sZW5ndGgpLCBjID0gdSAvIChudWxsICE9IGUgPyBlLmxlbmd0aCA6IDEpLCBhID0gW107XG4gICAgICAgIGZvciAobGV0IGggPSAwOyBoIDwgdTsgKytoKSB7XG4gICAgICAgICAgICBjb25zdCB1ID0gZSA/IHRoaXMuZm4oZVtoIC8gY10pIDogSHIsIGwgPSB0aGlzLmRuKHQsIHUsIG5baCAlIGNdLCBzKSwgZiA9IHRoaXMuX24odCwgdSwgaVtoICUgY10sIHIpLCBkID0gby5tYXAoKGUgPT4gdGhpcy5kbih0LCB1LCBlLCBcbiAgICAgICAgICAgIC8qIGluY2x1c2l2ZT0gKi8gITApKSk7XG4gICAgICAgICAgICBhLnB1c2goLi4udGhpcy5jcmVhdGVSYW5nZShsLCBmLCBkKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGE7XG4gICAgfVxuICAgIC8qKiBHZW5lcmF0ZXMgdGhlIGxvd2VyIGJvdW5kIGZvciBgYXJyYXlWYWx1ZWAgYW5kIGBkaXJlY3Rpb25hbFZhbHVlYC4gKi8gICAgZG4odCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IGtyKHQsIGh0LmVtcHR5KCksIGUsIG4pO1xuICAgICAgICByZXR1cm4gcyA/IGkgOiBpLkhlKCk7XG4gICAgfVxuICAgIC8qKiBHZW5lcmF0ZXMgdGhlIHVwcGVyIGJvdW5kIGZvciBgYXJyYXlWYWx1ZWAgYW5kIGBkaXJlY3Rpb25hbFZhbHVlYC4gKi8gICAgX24odCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IGtyKHQsIGh0LmVtcHR5KCksIGUsIG4pO1xuICAgICAgICByZXR1cm4gcyA/IGkuSGUoKSA6IGk7XG4gICAgfVxuICAgIGNuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyAkcihlKSwgcyA9IG51bGwgIT0gZS5jb2xsZWN0aW9uR3JvdXAgPyBlLmNvbGxlY3Rpb25Hcm91cCA6IGUucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRGaWVsZEluZGV4ZXModCwgcykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAvLyBSZXR1cm4gdGhlIGluZGV4IHdpdGggdGhlIG1vc3QgbnVtYmVyIG9mIHNlZ21lbnRzLlxuICAgICAgICAgICAgbGV0IGUgPSBudWxsO1xuICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQpIHtcbiAgICAgICAgICAgICAgICBuLlplKHMpICYmICghZSB8fCBzLmZpZWxkcy5sZW5ndGggPiBlLmZpZWxkcy5sZW5ndGgpICYmIChlID0gcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRJbmRleFR5cGUodCwgZSkge1xuICAgICAgICBsZXQgbiA9IDIgLyogSW5kZXhUeXBlLkZVTEwgKi87XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLnVuKGUpO1xuICAgICAgICByZXR1cm4gdnQuZm9yRWFjaChzLCAoZSA9PiB0aGlzLmNuKHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdCA/IDAgLyogSW5kZXhUeXBlLk5PTkUgKi8gIT09IG4gJiYgdC5maWVsZHMubGVuZ3RoIDwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGxldCBlID0gbmV3IEVlKGF0LmNvbXBhcmF0b3IpLCBuID0gITE7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBzIG9mIHQuZmlsdGVycykgZm9yIChjb25zdCB0IG9mIHMuZ2V0RmxhdHRlbmVkRmlsdGVycygpKSBcbiAgICAgICAgICAgICAgICAvLyBfX25hbWVfXyBpcyBub3QgYW4gZXhwbGljaXQgc2VnbWVudCBvZiBhbnkgaW5kZXgsIHNvIHdlIGRvbid0IG5lZWQgdG9cbiAgICAgICAgICAgICAgICAvLyBjb3VudCBpdC5cbiAgICAgICAgICAgICAgICB0LmZpZWxkLmlzS2V5RmllbGQoKSB8fCAoXG4gICAgICAgICAgICAgICAgLy8gQVJSQVlfQ09OVEFJTlMgb3IgQVJSQVlfQ09OVEFJTlNfQU5ZIGZpbHRlcnMgbXVzdCBiZSBjb3VudGVkIHNlcGFyYXRlbHkuXG4gICAgICAgICAgICAgICAgLy8gRm9yIGluc3RhbmNlLCBpdCBpcyBwb3NzaWJsZSB0byBoYXZlIGFuIGluZGV4IGZvciBcImEgQVJSQVkgYSBBU0NcIi4gRXZlblxuICAgICAgICAgICAgICAgIC8vIHRob3VnaCB0aGVzZSBhcmUgb24gdGhlIHNhbWUgZmllbGQsIHRoZXkgc2hvdWxkIGJlIGNvdW50ZWQgYXMgdHdvXG4gICAgICAgICAgICAgICAgLy8gc2VwYXJhdGUgc2VnbWVudHMgaW4gYW4gaW5kZXguXG4gICAgICAgICAgICAgICAgXCJhcnJheS1jb250YWluc1wiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TICovID09PSB0Lm9wIHx8IFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovID09PSB0Lm9wID8gbiA9ICEwIDogZSA9IGUuYWRkKHQuZmllbGQpKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgdC5vcmRlckJ5KSBcbiAgICAgICAgICAgICAgICAvLyBfX25hbWVfXyBpcyBub3QgYW4gZXhwbGljaXQgc2VnbWVudCBvZiBhbnkgaW5kZXgsIHNvIHdlIGRvbid0IG5lZWQgdG9cbiAgICAgICAgICAgICAgICAvLyBjb3VudCBpdC5cbiAgICAgICAgICAgICAgICBuLmZpZWxkLmlzS2V5RmllbGQoKSB8fCAoZSA9IGUuYWRkKG4uZmllbGQpKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5zaXplICsgKG4gPyAxIDogMCk7XG4gICAgICAgICAgICB9KGUpICYmIChuID0gMSAvKiBJbmRleFR5cGUuUEFSVElBTCAqLykgOiBuID0gMCAvKiBJbmRleFR5cGUuTk9ORSAqLztcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gXG4gICAgICAgIC8vIE9SIHF1ZXJpZXMgaGF2ZSBtb3JlIHRoYW4gb25lIHN1Yi10YXJnZXQgKG9uZSBzdWItdGFyZ2V0IHBlciBETkYgdGVybSkuIFdlIGN1cnJlbnRseSBjb25zaWRlclxuICAgICAgICAvLyBPUiBxdWVyaWVzIHRoYXQgaGF2ZSBhIGBsaW1pdGAgdG8gaGF2ZSBhIHBhcnRpYWwgaW5kZXguIEZvciBzdWNoIHF1ZXJpZXMgd2UgcGVyZm9ybSBzb3J0aW5nXG4gICAgICAgIC8vIGFuZCBhcHBseSB0aGUgbGltaXQgaW4gbWVtb3J5IGFzIGEgcG9zdC1wcm9jZXNzaW5nIHN0ZXAuXG4gICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsICE9PSB0LmxpbWl0O1xuICAgICAgICB9KGUpICYmIHMubGVuZ3RoID4gMSAmJiAyIC8qIEluZGV4VHlwZS5GVUxMICovID09PSBuID8gMSAvKiBJbmRleFR5cGUuUEFSVElBTCAqLyA6IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgYnl0ZSBlbmNvZGVkIGZvcm0gb2YgdGhlIGRpcmVjdGlvbmFsIHZhbHVlcyBpbiB0aGUgZmllbGQgaW5kZXguXG4gICAgICogUmV0dXJucyBgbnVsbGAgaWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGhhdmUgYWxsIGZpZWxkcyBzcGVjaWZpZWQgaW4gdGhlXG4gICAgICogaW5kZXguXG4gICAgICovICAgIHduKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBOcjtcbiAgICAgICAgZm9yIChjb25zdCBzIG9mIGR0KHQpKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gZS5kYXRhLmZpZWxkKHMuZmllbGRQYXRoKTtcbiAgICAgICAgICAgIGlmIChudWxsID09IHQpIHJldHVybiBudWxsO1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uV2Uocy5raW5kKTtcbiAgICAgICAgICAgIGJyLmJlLl9lKHQsIGkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBuLkdlKCk7XG4gICAgfVxuICAgIC8qKiBFbmNvZGVzIGEgc2luZ2xlIHZhbHVlIHRvIHRoZSBhc2NlbmRpbmcgaW5kZXggZm9ybWF0LiAqLyAgICBmbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgTnI7XG4gICAgICAgIHJldHVybiBici5iZS5fZSh0LCBlLldlKDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLykpLCBlLkdlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYW4gZW5jb2RlZCBmb3JtIG9mIHRoZSBkb2N1bWVudCBrZXkgdGhhdCBzb3J0cyBiYXNlZCBvbiB0aGUga2V5XG4gICAgICogb3JkZXJpbmcgb2YgdGhlIGZpZWxkIGluZGV4LlxuICAgICAqLyAgICBtbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgTnI7XG4gICAgICAgIHJldHVybiBici5iZS5fZShXZSh0aGlzLmRhdGFiYXNlSWQsIGUpLCBuLldlKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBkdCh0KTtcbiAgICAgICAgICAgIHJldHVybiAwID09PSBlLmxlbmd0aCA/IDAgLyogSW5kZXhLaW5kLkFTQ0VORElORyAqLyA6IGVbZS5sZW5ndGggLSAxXS5raW5kO1xuICAgICAgICB9KHQpKSksIG4uR2UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5jb2RlcyB0aGUgZ2l2ZW4gZmllbGQgdmFsdWVzIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWNhdGlvbiBpbiBgdGFyZ2V0YC5cbiAgICAgKiBGb3IgSU4gcXVlcmllcywgYSBsaXN0IG9mIHBvc3NpYmxlIHZhbHVlcyBpcyByZXR1cm5lZC5cbiAgICAgKi8gICAgaG4odCwgZSwgbikge1xuICAgICAgICBpZiAobnVsbCA9PT0gbikgcmV0dXJuIFtdO1xuICAgICAgICBsZXQgcyA9IFtdO1xuICAgICAgICBzLnB1c2gobmV3IE5yKTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICBmb3IgKGNvbnN0IHIgb2YgZHQodCkpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBuW2krK107XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG4gb2YgcykgaWYgKHRoaXMuZ24oZSwgci5maWVsZFBhdGgpICYmIEplKHQpKSBzID0gdGhpcy55bihzLCByLCB0KTsgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IG4uV2Uoci5raW5kKTtcbiAgICAgICAgICAgICAgICBici5iZS5fZSh0LCBlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5wbihzKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5jb2RlcyB0aGUgZ2l2ZW4gYm91bmRzIGFjY29yZGluZyB0byB0aGUgc3BlY2lmaWNhdGlvbiBpbiBgdGFyZ2V0YC4gRm9yIElOXG4gICAgICogcXVlcmllcywgYSBsaXN0IG9mIHBvc3NpYmxlIHZhbHVlcyBpcyByZXR1cm5lZC5cbiAgICAgKi8gICAgYW4odCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5obih0LCBlLCBuLnBvc2l0aW9uKTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgdGhlIGJ5dGUgcmVwcmVzZW50YXRpb24gZm9yIHRoZSBwcm92aWRlZCBlbmNvZGVycy4gKi8gICAgcG4odCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGZvciAobGV0IG4gPSAwOyBuIDwgdC5sZW5ndGg7ICsrbikgZVtuXSA9IHRbbl0uR2UoKTtcbiAgICAgICAgcmV0dXJuIGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBzZXBhcmF0ZSBlbmNvZGVyIGZvciBlYWNoIGVsZW1lbnQgb2YgYW4gYXJyYXkuXG4gICAgICpcbiAgICAgKiBUaGUgbWV0aG9kIGFwcGVuZHMgZWFjaCB2YWx1ZSB0byBhbGwgZXhpc3RpbmcgZW5jb2RlcnMgKGUuZy4gZmlsdGVyKFwiYVwiLFxuICAgICAqIFwiPT1cIiwgXCJhMVwiKS5maWx0ZXIoXCJiXCIsIFwiaW5cIiwgW1wiYjFcIiwgXCJiMlwiXSkgYmVjb21lcyBbXCJhMSxiMVwiLCBcImExLGIyXCJdKS4gQVxuICAgICAqIGxpc3Qgb2YgbmV3IGVuY29kZXJzIGlzIHJldHVybmVkLlxuICAgICAqLyAgICB5bih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBbIC4uLnQgXSwgaSA9IFtdO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2Ygbi5hcnJheVZhbHVlLnZhbHVlcyB8fCBbXSkgZm9yIChjb25zdCBuIG9mIHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgTnI7XG4gICAgICAgICAgICBzLnNlZWQobi5HZSgpKSwgYnIuYmUuX2UodCwgcy5XZShlLmtpbmQpKSwgaS5wdXNoKHMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgICBnbih0LCBlKSB7XG4gICAgICAgIHJldHVybiAhIXQuZmlsdGVycy5maW5kKCh0ID0+IHQgaW5zdGFuY2VvZiBtbiAmJiB0LmZpZWxkLmlzRXF1YWwoZSkgJiYgKFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLyA9PT0gdC5vcCB8fCBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA9PT0gdC5vcCkpKTtcbiAgICB9XG4gICAgZ2V0RmllbGRJbmRleGVzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IFpyKHQpLCBzID0gdG8odCk7XG4gICAgICAgIHJldHVybiAoZSA/IG4uaihcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsIElEQktleVJhbmdlLmJvdW5kKGUsIGUpKSA6IG4uaigpKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgIHJldHVybiB2dC5mb3JFYWNoKHQsICh0ID0+IHMuZ2V0KFsgdC5pbmRleElkLCB0aGlzLnVpZCBdKS5uZXh0KChuID0+IHtcbiAgICAgICAgICAgICAgICBlLnB1c2goZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gZSA/IG5ldyBndChlLnNlcXVlbmNlTnVtYmVyLCBuZXcgSXQoX3IoZS5yZWFkVGltZSksIG5ldyBodChHdChlLmRvY3VtZW50S2V5KSksIGUubGFyZ2VzdEJhdGNoSWQpKSA6IGd0LmVtcHR5KCksIHMgPSB0LmZpZWxkcy5tYXAoKChbdCwgZV0pID0+IG5ldyB3dChhdC5mcm9tU2VydmVyRm9ybWF0KHQpLCBlKSkpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IGx0KHQuaW5kZXhJZCwgdC5jb2xsZWN0aW9uR3JvdXAsIHMsIG4pO1xuICAgICAgICAgICAgICAgIH0odCwgbikpO1xuICAgICAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gZSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRDb2xsZWN0aW9uR3JvdXBUb1VwZGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkSW5kZXhlcyh0KS5uZXh0KCh0ID0+IDAgPT09IHQubGVuZ3RoID8gbnVsbCA6ICh0LnNvcnQoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gdC5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyIC0gZS5pbmRleFN0YXRlLnNlcXVlbmNlTnVtYmVyO1xuICAgICAgICAgICAgcmV0dXJuIDAgIT09IG4gPyBuIDogZXQodC5jb2xsZWN0aW9uR3JvdXAsIGUuY29sbGVjdGlvbkdyb3VwKTtcbiAgICAgICAgfSkpLCB0WzBdLmNvbGxlY3Rpb25Hcm91cCkpKTtcbiAgICB9XG4gICAgdXBkYXRlQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFpyKHQpLCBpID0gdG8odCk7XG4gICAgICAgIHJldHVybiB0aGlzLkluKHQpLm5leHQoKHQgPT4gcy5qKFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgSURCS2V5UmFuZ2UuYm91bmQoZSwgZSkpLm5leHQoKGUgPT4gdnQuZm9yRWFjaChlLCAoZSA9PiBpLnB1dChUcihlLmluZGV4SWQsIHRoaXMudXNlciwgdCwgbikpKSkpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVJbmRleEVudHJpZXModCwgZSkge1xuICAgICAgICAvLyBQb3J0aW5nIE5vdGU6IGBnZXRGaWVsZEluZGV4ZXMoKWAgb24gV2ViIGRvZXMgbm90IGNhY2hlIGluZGV4IGxvb2t1cHMgYXNcbiAgICAgICAgLy8gaXQgY291bGQgYmUgdXNlZCBhY3Jvc3MgZGlmZmVyZW50IEluZGV4ZWREQiB0cmFuc2FjdGlvbnMuIEFzIGFueSBjYWNoZWRcbiAgICAgICAgLy8gZGF0YSBtaWdodCBiZSBpbnZhbGlkYXRlZCBieSBvdGhlciBtdWx0aS10YWIgY2xpZW50cywgd2UgY2FuIG9ubHkgdHJ1c3RcbiAgICAgICAgLy8gZGF0YSB3aXRoaW4gYSBzaW5nbGUgSW5kZXhlZERCIHRyYW5zYWN0aW9uLiBXZSB0aGVyZWZvcmUgYWRkIGEgY2FjaGVcbiAgICAgICAgLy8gaGVyZS5cbiAgICAgICAgY29uc3QgbiA9IG5ldyBNYXA7XG4gICAgICAgIHJldHVybiB2dC5mb3JFYWNoKGUsICgoZSwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uZ2V0KGUuY29sbGVjdGlvbkdyb3VwKTtcbiAgICAgICAgICAgIHJldHVybiAoaSA/IHZ0LnJlc29sdmUoaSkgOiB0aGlzLmdldEZpZWxkSW5kZXhlcyh0LCBlLmNvbGxlY3Rpb25Hcm91cCkpLm5leHQoKGkgPT4gKG4uc2V0KGUuY29sbGVjdGlvbkdyb3VwLCBpKSwgXG4gICAgICAgICAgICB2dC5mb3JFYWNoKGksIChuID0+IHRoaXMuVG4odCwgZSwgbikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuRW4ocywgbik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGUuaXNFcXVhbChpKSA/IHZ0LnJlc29sdmUoKSA6IHRoaXMuQW4odCwgcywgbiwgZSwgaSk7XG4gICAgICAgICAgICB9KSkpKSkpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBSbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBYcih0KS5wdXQoe1xuICAgICAgICAgICAgaW5kZXhJZDogcy5pbmRleElkLFxuICAgICAgICAgICAgdWlkOiB0aGlzLnVpZCxcbiAgICAgICAgICAgIGFycmF5VmFsdWU6IHMuYXJyYXlWYWx1ZSxcbiAgICAgICAgICAgIGRpcmVjdGlvbmFsVmFsdWU6IHMuZGlyZWN0aW9uYWxWYWx1ZSxcbiAgICAgICAgICAgIG9yZGVyZWREb2N1bWVudEtleTogdGhpcy5tbihuLCBlLmtleSksXG4gICAgICAgICAgICBkb2N1bWVudEtleTogZS5rZXkucGF0aC50b0FycmF5KClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHZuKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgcmV0dXJuIFhyKHQpLmRlbGV0ZShbIHMuaW5kZXhJZCwgdGhpcy51aWQsIHMuYXJyYXlWYWx1ZSwgcy5kaXJlY3Rpb25hbFZhbHVlLCB0aGlzLm1uKG4sIGUua2V5KSwgZS5rZXkucGF0aC50b0FycmF5KCkgXSk7XG4gICAgfVxuICAgIFRuKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IFhyKHQpO1xuICAgICAgICBsZXQgaSA9IG5ldyBFZShNcik7XG4gICAgICAgIHJldHVybiBzLlgoe1xuICAgICAgICAgICAgaW5kZXg6IFwiZG9jdW1lbnRLZXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLm9ubHkoWyBuLmluZGV4SWQsIHRoaXMudWlkLCB0aGlzLm1uKG4sIGUpIF0pXG4gICAgICAgIH0sICgodCwgcykgPT4ge1xuICAgICAgICAgICAgaSA9IGkuYWRkKG5ldyBrcihuLmluZGV4SWQsIGUsIHMuYXJyYXlWYWx1ZSwgcy5kaXJlY3Rpb25hbFZhbHVlKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIC8qKiBDcmVhdGVzIHRoZSBpbmRleCBlbnRyaWVzIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnQuICovICAgIEVuKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBuZXcgRWUoTXIpO1xuICAgICAgICBjb25zdCBzID0gdGhpcy53bihlLCB0KTtcbiAgICAgICAgaWYgKG51bGwgPT0gcykgcmV0dXJuIG47XG4gICAgICAgIGNvbnN0IGkgPSBmdChlKTtcbiAgICAgICAgaWYgKG51bGwgIT0gaSkge1xuICAgICAgICAgICAgY29uc3QgciA9IHQuZGF0YS5maWVsZChpLmZpZWxkUGF0aCk7XG4gICAgICAgICAgICBpZiAoSmUocikpIGZvciAoY29uc3QgaSBvZiByLmFycmF5VmFsdWUudmFsdWVzIHx8IFtdKSBuID0gbi5hZGQobmV3IGtyKGUuaW5kZXhJZCwgdC5rZXksIHRoaXMuZm4oaSksIHMpKTtcbiAgICAgICAgfSBlbHNlIG4gPSBuLmFkZChuZXcga3IoZS5pbmRleElkLCB0LmtleSwgSHIsIHMpKTtcbiAgICAgICAgcmV0dXJuIG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgdGhlIGluZGV4IGVudHJpZXMgZm9yIHRoZSBwcm92aWRlZCBkb2N1bWVudCBieSBkZWxldGluZyBlbnRyaWVzXG4gICAgICogdGhhdCBhcmUgbm8gbG9uZ2VyIHJlZmVyZW5jZWQgaW4gYG5ld0VudHJpZXNgIGFuZCBhZGRpbmcgYWxsIG5ld2x5IGFkZGVkXG4gICAgICogZW50cmllcy5cbiAgICAgKi8gICAgQW4odCwgZSwgbiwgcywgaSkge1xuICAgICAgICBOKFwiSW5kZXhlZERiSW5kZXhNYW5hZ2VyXCIsIFwiVXBkYXRpbmcgaW5kZXggZW50cmllcyBmb3IgZG9jdW1lbnQgJyVzJ1wiLCBlLmtleSk7XG4gICAgICAgIGNvbnN0IHIgPSBbXTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSB0LmdldEl0ZXJhdG9yKCksIG8gPSBlLmdldEl0ZXJhdG9yKCk7XG4gICAgICAgICAgICBsZXQgdSA9IFJlKHIpLCBjID0gUmUobyk7XG4gICAgICAgICAgICAvLyBXYWxrIHRocm91Z2ggdGhlIHR3byBzZXRzIGF0IHRoZSBzYW1lIHRpbWUsIHVzaW5nIHRoZSBvcmRlcmluZyBkZWZpbmVkIGJ5XG4gICAgICAgICAgICAvLyBgY29tcGFyYXRvcmAuXG4gICAgICAgICAgICBmb3IgKDt1IHx8IGM7ICkge1xuICAgICAgICAgICAgICAgIGxldCB0ID0gITEsIGUgPSAhMTtcbiAgICAgICAgICAgICAgICBpZiAodSAmJiBjKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuKHUsIGMpO1xuICAgICAgICAgICAgICAgICAgICBzIDwgMCA/IFxuICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgcmVtb3ZlZCBpZiB0aGUgbmV4dCBlbGVtZW50IGluIG91ciBvcmRlcmVkXG4gICAgICAgICAgICAgICAgICAgIC8vIHdhbGt0aHJvdWdoIGlzIG9ubHkgaW4gYGJlZm9yZWAuXG4gICAgICAgICAgICAgICAgICAgIGUgPSAhMCA6IHMgPiAwICYmIChcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhlIGVsZW1lbnQgd2FzIGFkZGVkIGlmIHRoZSBuZXh0IGVsZW1lbnQgaW4gb3VyIG9yZGVyZWQgd2Fsa3Rocm91Z2hcbiAgICAgICAgICAgICAgICAgICAgLy8gaXMgb25seSBpbiBgYWZ0ZXJgLlxuICAgICAgICAgICAgICAgICAgICB0ID0gITApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBudWxsICE9IHUgPyBlID0gITAgOiB0ID0gITA7XG4gICAgICAgICAgICAgICAgdCA/IChzKGMpLCBjID0gUmUobykpIDogZSA/IChpKHUpLCB1ID0gUmUocikpIDogKHUgPSBSZShyKSwgYyA9IFJlKG8pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfShzLCBpLCBNciwgKFxuICAgICAgICAvKiBvbkFkZD0gKi8gcyA9PiB7XG4gICAgICAgICAgICByLnB1c2godGhpcy5Sbih0LCBlLCBuLCBzKSk7XG4gICAgICAgIH0pLCAoXG4gICAgICAgIC8qIG9uUmVtb3ZlPSAqLyBzID0+IHtcbiAgICAgICAgICAgIHIucHVzaCh0aGlzLnZuKHQsIGUsIG4sIHMpKTtcbiAgICAgICAgfSkpLCB2dC53YWl0Rm9yKHIpO1xuICAgIH1cbiAgICBJbih0KSB7XG4gICAgICAgIGxldCBlID0gMTtcbiAgICAgICAgcmV0dXJuIHRvKHQpLlgoe1xuICAgICAgICAgICAgaW5kZXg6IFwic2VxdWVuY2VOdW1iZXJJbmRleFwiLFxuICAgICAgICAgICAgcmV2ZXJzZTogITAsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2UudXBwZXJCb3VuZChbIHRoaXMudWlkLCBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiBdKVxuICAgICAgICB9LCAoKHQsIG4sIHMpID0+IHtcbiAgICAgICAgICAgIHMuZG9uZSgpLCBlID0gbi5zZXF1ZW5jZU51bWJlciArIDE7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgYSBuZXcgc2V0IG9mIElEQiByYW5nZXMgdGhhdCBzcGxpdHMgdGhlIGV4aXN0aW5nIHJhbmdlIGFuZCBleGNsdWRlc1xuICAgICAqIGFueSB2YWx1ZXMgdGhhdCBtYXRjaCB0aGUgYG5vdEluVmFsdWVgIGZyb20gdGhlc2UgcmFuZ2VzLiBBcyBhbiBleGFtcGxlLFxuICAgICAqICdbZm9vID4gMiAmJiBmb28gIT0gM11gIGJlY29tZXMgIGBbZm9vID4gMiAmJiA8IDMsIGZvbyA+IDNdYC5cbiAgICAgKi8gICAgY3JlYXRlUmFuZ2UodCwgZSwgbikge1xuICAgICAgICAvLyBUaGUgbm90SW4gdmFsdWVzIG5lZWQgdG8gYmUgc29ydGVkIGFuZCB1bmlxdWUgc28gdGhhdCB3ZSBjYW4gcmV0dXJuIGFcbiAgICAgICAgLy8gc29ydGVkIHNldCBvZiBub24tb3ZlcmxhcHBpbmcgcmFuZ2VzLlxuICAgICAgICBuID0gbi5zb3J0KCgodCwgZSkgPT4gTXIodCwgZSkpKS5maWx0ZXIoKCh0LCBlLCBuKSA9PiAhZSB8fCAwICE9PSBNcih0LCBuW2UgLSAxXSkpKTtcbiAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICBzLnB1c2godCk7XG4gICAgICAgIGZvciAoY29uc3QgaSBvZiBuKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gTXIoaSwgdCksIHIgPSBNcihpLCBlKTtcbiAgICAgICAgICAgIGlmICgwID09PSBuKSBcbiAgICAgICAgICAgIC8vIGBub3RJblZhbHVlYCBpcyB0aGUgbG93ZXIgYm91bmQuIFdlIHRoZXJlZm9yZSBuZWVkIHRvIHJhaXNlIHRoZSBib3VuZFxuICAgICAgICAgICAgLy8gdG8gdGhlIG5leHQgdmFsdWUuXG4gICAgICAgICAgICBzWzBdID0gdC5IZSgpOyBlbHNlIGlmIChuID4gMCAmJiByIDwgMCkgXG4gICAgICAgICAgICAvLyBgbm90SW5WYWx1ZWAgaXMgaW4gdGhlIG1pZGRsZSBvZiB0aGUgcmFuZ2VcbiAgICAgICAgICAgIHMucHVzaChpKSwgcy5wdXNoKGkuSGUoKSk7IGVsc2UgaWYgKHIgPiAwKSBcbiAgICAgICAgICAgIC8vIGBub3RJblZhbHVlYCAoYW5kIGFsbCBmb2xsb3dpbmcgdmFsdWVzKSBhcmUgb3V0IG9mIHRoZSByYW5nZVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgcy5wdXNoKGUpO1xuICAgICAgICBjb25zdCBpID0gW107XG4gICAgICAgIGZvciAobGV0IHQgPSAwOyB0IDwgcy5sZW5ndGg7IHQgKz0gMikge1xuICAgICAgICAgICAgLy8gSWYgd2UgZW5jb3VudGVyIHR3byBib3VuZHMgdGhhdCB3aWxsIGNyZWF0ZSBhbiB1bm1hdGNoYWJsZSBrZXkgcmFuZ2UsXG4gICAgICAgICAgICAvLyB0aGVuIHdlIHJldHVybiBhbiBlbXB0eSBzZXQgb2Yga2V5IHJhbmdlcy5cbiAgICAgICAgICAgIGlmICh0aGlzLlBuKHNbdF0sIHNbdCArIDFdKSkgcmV0dXJuIFtdO1xuICAgICAgICAgICAgY29uc3QgZSA9IFsgc1t0XS5pbmRleElkLCB0aGlzLnVpZCwgc1t0XS5hcnJheVZhbHVlLCBzW3RdLmRpcmVjdGlvbmFsVmFsdWUsIEhyLCBbXSBdLCBuID0gWyBzW3QgKyAxXS5pbmRleElkLCB0aGlzLnVpZCwgc1t0ICsgMV0uYXJyYXlWYWx1ZSwgc1t0ICsgMV0uZGlyZWN0aW9uYWxWYWx1ZSwgSHIsIFtdIF07XG4gICAgICAgICAgICBpLnB1c2goSURCS2V5UmFuZ2UuYm91bmQoZSwgbikpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgICBQbih0LCBlKSB7XG4gICAgICAgIC8vIElmIGxvd2VyIGJvdW5kIGlzIGdyZWF0ZXIgdGhhbiB0aGUgdXBwZXIgYm91bmQsIHRoZW4gdGhlIGtleVxuICAgICAgICAvLyByYW5nZSBjYW4gbmV2ZXIgYmUgbWF0Y2hlZC5cbiAgICAgICAgcmV0dXJuIE1yKHQsIGUpID4gMDtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0RnJvbUNvbGxlY3Rpb25Hcm91cCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEZpZWxkSW5kZXhlcyh0LCBlKS5uZXh0KGVvKTtcbiAgICB9XG4gICAgZ2V0TWluT2Zmc2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0Lm1hcEFycmF5KHRoaXMudW4oZSksIChlID0+IHRoaXMuY24odCwgZSkubmV4dCgodCA9PiB0IHx8ICQoKSkpKSkubmV4dChlbyk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY29sbGVjdGlvblBhcmVudHNcbiAqIGRvY3VtZW50IHN0b3JlLlxuICovIGZ1bmN0aW9uIFlyKHQpIHtcbiAgICByZXR1cm4gd2UodCwgXCJjb2xsZWN0aW9uUGFyZW50c1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IGVudHJ5IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBYcih0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwiaW5kZXhFbnRyaWVzXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgaW5kZXggY29uZmlndXJhdGlvbiBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gWnIodCkge1xuICAgIHJldHVybiB3ZSh0LCBcImluZGV4Q29uZmlndXJhdGlvblwiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIGluZGV4IHN0YXRlIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiB0byh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwiaW5kZXhTdGF0ZVwiKTtcbn1cblxuZnVuY3Rpb24gZW8odCkge1xuICAgIEYoMCAhPT0gdC5sZW5ndGgpO1xuICAgIGxldCBlID0gdFswXS5pbmRleFN0YXRlLm9mZnNldCwgbiA9IGUubGFyZ2VzdEJhdGNoSWQ7XG4gICAgZm9yIChsZXQgcyA9IDE7IHMgPCB0Lmxlbmd0aDsgcysrKSB7XG4gICAgICAgIGNvbnN0IGkgPSB0W3NdLmluZGV4U3RhdGUub2Zmc2V0O1xuICAgICAgICBUdChpLCBlKSA8IDAgJiYgKGUgPSBpKSwgbiA8IGkubGFyZ2VzdEJhdGNoSWQgJiYgKG4gPSBpLmxhcmdlc3RCYXRjaElkKTtcbiAgICB9XG4gICAgcmV0dXJuIG5ldyBJdChlLnJlYWRUaW1lLCBlLmRvY3VtZW50S2V5LCBuKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3Qgbm8gPSB7XG4gICAgZGlkUnVuOiAhMSxcbiAgICBzZXF1ZW5jZU51bWJlcnNDb2xsZWN0ZWQ6IDAsXG4gICAgdGFyZ2V0c1JlbW92ZWQ6IDAsXG4gICAgZG9jdW1lbnRzUmVtb3ZlZDogMFxufTtcblxuY2xhc3Mgc28ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8vIFdoZW4gd2UgYXR0ZW1wdCB0byBjb2xsZWN0LCB3ZSB3aWxsIG9ubHkgZG8gc28gaWYgdGhlIGNhY2hlIHNpemUgaXMgZ3JlYXRlciB0aGFuIHRoaXNcbiAgICAvLyB0aHJlc2hvbGQuIFBhc3NpbmcgYENPTExFQ1RJT05fRElTQUJMRURgIGhlcmUgd2lsbCBjYXVzZSBjb2xsZWN0aW9uIHRvIGFsd2F5cyBiZSBza2lwcGVkLlxuICAgIHQsIFxuICAgIC8vIFRoZSBwZXJjZW50YWdlIG9mIHNlcXVlbmNlIG51bWJlcnMgdGhhdCB3ZSB3aWxsIGF0dGVtcHQgdG8gY29sbGVjdFxuICAgIGUsIFxuICAgIC8vIEEgY2FwIG9uIHRoZSB0b3RhbCBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyB0aGF0IHdpbGwgYmUgY29sbGVjdGVkLiBUaGlzIHByZXZlbnRzXG4gICAgLy8gdXMgZnJvbSBjb2xsZWN0aW5nIGEgaHVnZSBudW1iZXIgb2Ygc2VxdWVuY2UgbnVtYmVycyBpZiB0aGUgY2FjaGUgaGFzIGdyb3duIHZlcnkgbGFyZ2UuXG4gICAgbikge1xuICAgICAgICB0aGlzLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgPSB0LCB0aGlzLnBlcmNlbnRpbGVUb0NvbGxlY3QgPSBlLCB0aGlzLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QgPSBuO1xuICAgIH1cbiAgICBzdGF0aWMgd2l0aENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgc28odCwgc28uREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUsIHNvLkRFRkFVTFRfTUFYX1NFUVVFTkNFX05VTUJFUlNfVE9fQ09MTEVDVCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBEZWxldGUgYSBtdXRhdGlvbiBiYXRjaCBhbmQgdGhlIGFzc29jaWF0ZWQgZG9jdW1lbnQgbXV0YXRpb25zLlxuICogQHJldHVybnMgQSBQZXJzaXN0ZW5jZVByb21pc2Ugb2YgdGhlIGRvY3VtZW50IG11dGF0aW9ucyB0aGF0IHdlcmUgcmVtb3ZlZC5cbiAqL1xuZnVuY3Rpb24gaW8odCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LnN0b3JlKFwibXV0YXRpb25zXCIpLCBpID0gdC5zdG9yZShcImRvY3VtZW50TXV0YXRpb25zXCIpLCByID0gW10sIG8gPSBJREJLZXlSYW5nZS5vbmx5KG4uYmF0Y2hJZCk7XG4gICAgbGV0IHUgPSAwO1xuICAgIGNvbnN0IGMgPSBzLlgoe1xuICAgICAgICByYW5nZTogb1xuICAgIH0sICgodCwgZSwgbikgPT4gKHUrKywgbi5kZWxldGUoKSkpKTtcbiAgICByLnB1c2goYy5uZXh0KCgoKSA9PiB7XG4gICAgICAgIEYoMSA9PT0gdSk7XG4gICAgfSkpKTtcbiAgICBjb25zdCBhID0gW107XG4gICAgZm9yIChjb25zdCB0IG9mIG4ubXV0YXRpb25zKSB7XG4gICAgICAgIGNvbnN0IHMgPSB6dChlLCB0LmtleS5wYXRoLCBuLmJhdGNoSWQpO1xuICAgICAgICByLnB1c2goaS5kZWxldGUocykpLCBhLnB1c2godC5rZXkpO1xuICAgIH1cbiAgICByZXR1cm4gdnQud2FpdEZvcihyKS5uZXh0KCgoKSA9PiBhKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhbiBhcHByb3hpbWF0ZSBzaXplIGZvciB0aGUgZ2l2ZW4gZG9jdW1lbnQuXG4gKi8gZnVuY3Rpb24gcm8odCkge1xuICAgIGlmICghdCkgcmV0dXJuIDA7XG4gICAgbGV0IGU7XG4gICAgaWYgKHQuZG9jdW1lbnQpIGUgPSB0LmRvY3VtZW50OyBlbHNlIGlmICh0LnVua25vd25Eb2N1bWVudCkgZSA9IHQudW5rbm93bkRvY3VtZW50OyBlbHNlIHtcbiAgICAgICAgaWYgKCF0Lm5vRG9jdW1lbnQpIHRocm93ICQoKTtcbiAgICAgICAgZSA9IHQubm9Eb2N1bWVudDtcbiAgICB9XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGUpLmxlbmd0aDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBBIG11dGF0aW9uIHF1ZXVlIGZvciBhIHNwZWNpZmljIHVzZXIsIGJhY2tlZCBieSBJbmRleGVkREIuICovIHNvLkRFRkFVTFRfQ09MTEVDVElPTl9QRVJDRU5USUxFID0gMTAsIFxuc28uREVGQVVMVF9NQVhfU0VRVUVOQ0VfTlVNQkVSU19UT19DT0xMRUNUID0gMWUzLCBzby5ERUZBVUxUID0gbmV3IHNvKDQxOTQzMDQwLCBzby5ERUZBVUxUX0NPTExFQ1RJT05fUEVSQ0VOVElMRSwgc28uREVGQVVMVF9NQVhfU0VRVUVOQ0VfTlVNQkVSU19UT19DT0xMRUNUKSwgXG5zby5ESVNBQkxFRCA9IG5ldyBzbygtMSwgMCwgMCk7XG5cbmNsYXNzIG9vIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbm9ybWFsaXplZCB1c2VySWQgKGUuZy4gbnVsbCBVSUQgPT4gXCJcIiB1c2VySWQpIHVzZWQgdG8gc3RvcmUgL1xuICAgICAqIHJldHJpZXZlIG11dGF0aW9ucy5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudXNlcklkID0gdCwgdGhpcy5zZXJpYWxpemVyID0gZSwgdGhpcy5pbmRleE1hbmFnZXIgPSBuLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gcywgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBDYWNoZXMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2hlcy4gSWYgdGhlIG11dGF0aW9uXG4gICAgICAgICAqIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSBJbmRleGVkRGIsIHRoZSBjYWNoZWQgdmFsdWUgbWF5IGNvbnRpbnVlIHRvXG4gICAgICAgICAqIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIGJhdGNoJ3MgZG9jdW1lbnQga2V5cy4gVG8gcmVtb3ZlIGEgY2FjaGVkIHZhbHVlXG4gICAgICAgICAqIGxvY2FsbHksIGByZW1vdmVDYWNoZWRNdXRhdGlvbktleXMoKWAgc2hvdWxkIGJlIGludm9rZWQgZWl0aGVyIGRpcmVjdGx5XG4gICAgICAgICAqIG9yIHRocm91Z2ggYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYC5cbiAgICAgICAgICpcbiAgICAgICAgICogV2l0aCBtdWx0aS10YWIsIHdoZW4gdGhlIHByaW1hcnkgY2xpZW50IGFja25vd2xlZGdlcyBvciByZWplY3RzIGEgbXV0YXRpb24sXG4gICAgICAgICAqIHRoaXMgY2FjaGUgaXMgdXNlZCBieSBzZWNvbmRhcnkgY2xpZW50cyB0byBpbnZhbGlkYXRlIHRoZSBsb2NhbFxuICAgICAgICAgKiB2aWV3IG9mIHRoZSBkb2N1bWVudHMgdGhhdCB3ZXJlIHByZXZpb3VzbHkgYWZmZWN0ZWQgYnkgdGhlIG11dGF0aW9uLlxuICAgICAgICAgKi9cbiAgICAgICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICAgICAgdGhpcy5ibiA9IHt9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGEgbmV3IG11dGF0aW9uIHF1ZXVlIGZvciB0aGUgZ2l2ZW4gdXNlci5cbiAgICAgKiBAcGFyYW0gdXNlciAtIFRoZSB1c2VyIGZvciB3aGljaCB0byBjcmVhdGUgYSBtdXRhdGlvbiBxdWV1ZS5cbiAgICAgKiBAcGFyYW0gc2VyaWFsaXplciAtIFRoZSBzZXJpYWxpemVyIHRvIHVzZSB3aGVuIHBlcnNpc3RpbmcgdG8gSW5kZXhlZERiLlxuICAgICAqLyAgICBzdGF0aWMgZmUodCwgZSwgbiwgcykge1xuICAgICAgICAvLyBUT0RPKG1jZyk6IEZpZ3VyZSBvdXQgd2hhdCBjb25zdHJhaW50cyB0aGVyZSBhcmUgb24gdXNlcklEc1xuICAgICAgICAvLyBJbiBwYXJ0aWN1bGFyLCBhcmUgdGhlcmUgYW55IHJlc2VydmVkIGNoYXJhY3RlcnM/IGFyZSBlbXB0eSBpZHMgYWxsb3dlZD9cbiAgICAgICAgLy8gRm9yIHRoZSBtb21lbnQgc3RvcmUgdGhlc2UgdG9nZXRoZXIgaW4gdGhlIHNhbWUgbXV0YXRpb25zIHRhYmxlIGFzc3VtaW5nXG4gICAgICAgIC8vIHRoYXQgZW1wdHkgdXNlcklEcyBhcmVuJ3QgYWxsb3dlZC5cbiAgICAgICAgRihcIlwiICE9PSB0LnVpZCk7XG4gICAgICAgIGNvbnN0IGkgPSB0LmlzQXV0aGVudGljYXRlZCgpID8gdC51aWQgOiBcIlwiO1xuICAgICAgICByZXR1cm4gbmV3IG9vKGksIGUsIG4sIHMpO1xuICAgIH1cbiAgICBjaGVja0VtcHR5KHQpIHtcbiAgICAgICAgbGV0IGUgPSAhMDtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIE51bWJlci5ORUdBVElWRV9JTkZJTklUWSBdLCBbIHRoaXMudXNlcklkLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkgXSk7XG4gICAgICAgIHJldHVybiBjbyh0KS5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcInVzZXJNdXRhdGlvbnNJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IG5cbiAgICAgICAgfSwgKCh0LCBuLCBzKSA9PiB7XG4gICAgICAgICAgICBlID0gITEsIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICBhZGRNdXRhdGlvbkJhdGNoKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IGFvKHQpLCByID0gY28odCk7XG4gICAgICAgIC8vIFRoZSBJbmRleGVkRGIgaW1wbGVtZW50YXRpb24gaW4gQ2hyb21lIChhbmQgRmlyZWZveCkgZG9lcyBub3QgaGFuZGxlXG4gICAgICAgIC8vIGNvbXBvdW5kIGluZGljZXMgdGhhdCBpbmNsdWRlIGF1dG8tZ2VuZXJhdGVkIGtleXMgY29ycmVjdGx5LiBUbyBlbnN1cmVcbiAgICAgICAgLy8gdGhhdCB0aGUgaW5kZXggZW50cnkgaXMgYWRkZWQgY29ycmVjdGx5IGluIGFsbCBicm93c2Vycywgd2UgcGVyZm9ybSB0d29cbiAgICAgICAgLy8gd3JpdGVzOiBUaGUgZmlyc3Qgd3JpdGUgaXMgdXNlZCB0byByZXRyaWV2ZSB0aGUgbmV4dCBhdXRvLWdlbmVyYXRlZCBCYXRjaFxuICAgICAgICAvLyBJRCwgYW5kIHRoZSBzZWNvbmQgd3JpdGUgcG9wdWxhdGVzIHRoZSBpbmRleCBhbmQgc3RvcmVzIHRoZSBhY3R1YWxcbiAgICAgICAgLy8gbXV0YXRpb24gYmF0Y2guXG4gICAgICAgIC8vIFNlZTogaHR0cHM6Ly9idWdzLmNocm9taXVtLm9yZy9wL2Nocm9taXVtL2lzc3Vlcy9kZXRhaWw/aWQ9NzAxOTcyXG4gICAgICAgIC8vIFdlIHdyaXRlIGFuIGVtcHR5IG9iamVjdCB0byBvYnRhaW4ga2V5XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgIHJldHVybiByLmFkZCh7fSkubmV4dCgobyA9PiB7XG4gICAgICAgICAgICBGKFwibnVtYmVyXCIgPT0gdHlwZW9mIG8pO1xuICAgICAgICAgICAgY29uc3QgdSA9IG5ldyBacyhvLCBlLCBuLCBzKSwgYyA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5iYXNlTXV0YXRpb25zLm1hcCgoZSA9PiBqaSh0LmxlLCBlKSkpLCBpID0gbi5tdXRhdGlvbnMubWFwKChlID0+IGppKHQubGUsIGUpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBiYXRjaElkOiBuLmJhdGNoSWQsXG4gICAgICAgICAgICAgICAgICAgIGxvY2FsV3JpdGVUaW1lTXM6IG4ubG9jYWxXcml0ZVRpbWUudG9NaWxsaXMoKSxcbiAgICAgICAgICAgICAgICAgICAgYmFzZU11dGF0aW9uczogcyxcbiAgICAgICAgICAgICAgICAgICAgbXV0YXRpb25zOiBpXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0odGhpcy5zZXJpYWxpemVyLCB0aGlzLnVzZXJJZCwgdSksIGEgPSBbXTtcbiAgICAgICAgICAgIGxldCBoID0gbmV3IEVlKCgodCwgZSkgPT4gZXQodC5jYW5vbmljYWxTdHJpbmcoKSwgZS5jYW5vbmljYWxTdHJpbmcoKSkpKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHp0KHRoaXMudXNlcklkLCB0LmtleS5wYXRoLCBvKTtcbiAgICAgICAgICAgICAgICBoID0gaC5hZGQodC5rZXkucGF0aC5wb3BMYXN0KCkpLCBhLnB1c2goci5wdXQoYykpLCBhLnB1c2goaS5wdXQoZSwgV3QpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBoLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgICAgIGEucHVzaCh0aGlzLmluZGV4TWFuYWdlci5hZGRUb0NvbGxlY3Rpb25QYXJlbnRJbmRleCh0LCBlKSk7XG4gICAgICAgICAgICB9KSksIHQuYWRkT25Db21taXR0ZWRMaXN0ZW5lcigoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYm5bb10gPSB1LmtleXMoKTtcbiAgICAgICAgICAgIH0pKSwgdnQud2FpdEZvcihhKS5uZXh0KCgoKSA9PiB1KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgbG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBjbyh0KS5nZXQoZSkubmV4dCgodCA9PiB0ID8gKEYodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgd3IodGhpcy5zZXJpYWxpemVyLCB0KSkgOiBudWxsKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIGRvY3VtZW50IGtleXMgZm9yIHRoZSBtdXRhdGlvbiBiYXRjaCB3aXRoIHRoZSBnaXZlbiBiYXRjaElkLlxuICAgICAqIEZvciBwcmltYXJ5IGNsaWVudHMsIHRoaXMgbWV0aG9kIHJldHVybnMgYG51bGxgIGFmdGVyXG4gICAgICogYHJlbW92ZU11dGF0aW9uQmF0Y2hlcygpYCBoYXMgYmVlbiBjYWxsZWQuIFNlY29uZGFyeSBjbGllbnRzIHJldHVybiBhXG4gICAgICogY2FjaGVkIHJlc3VsdCB1bnRpbCBgcmVtb3ZlQ2FjaGVkTXV0YXRpb25LZXlzKClgIGlzIGludm9rZWQuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICBWbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJuW2VdID8gdnQucmVzb2x2ZSh0aGlzLmJuW2VdKSA6IHRoaXMubG9va3VwTXV0YXRpb25CYXRjaCh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmICh0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IHQua2V5cygpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJuW2VdID0gbiwgbjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgKyAxLCBzID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChbIHRoaXMudXNlcklkLCBuIF0pO1xuICAgICAgICBsZXQgaSA9IG51bGw7XG4gICAgICAgIHJldHVybiBjbyh0KS5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcInVzZXJNdXRhdGlvbnNJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IHNcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBlLnVzZXJJZCA9PT0gdGhpcy51c2VySWQgJiYgKEYoZS5iYXRjaElkID49IG4pLCBpID0gd3IodGhpcy5zZXJpYWxpemVyLCBlKSksIHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IElEQktleVJhbmdlLnVwcGVyQm91bmQoWyB0aGlzLnVzZXJJZCwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICBsZXQgbiA9IC0xO1xuICAgICAgICByZXR1cm4gY28odCkuWCh7XG4gICAgICAgICAgICBpbmRleDogXCJ1c2VyTXV0YXRpb25zSW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBlLFxuICAgICAgICAgICAgcmV2ZXJzZTogITBcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBuID0gZS5iYXRjaElkLCBzLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IElEQktleVJhbmdlLmJvdW5kKFsgdGhpcy51c2VySWQsIC0xIF0sIFsgdGhpcy51c2VySWQsIE51bWJlci5QT1NJVElWRV9JTkZJTklUWSBdKTtcbiAgICAgICAgcmV0dXJuIGNvKHQpLmooXCJ1c2VyTXV0YXRpb25zSW5kZXhcIiwgZSkubmV4dCgodCA9PiB0Lm1hcCgodCA9PiB3cih0aGlzLnNlcmlhbGl6ZXIsIHQpKSkpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nRG9jdW1lbnRLZXkodCwgZSkge1xuICAgICAgICAvLyBTY2FuIHRoZSBkb2N1bWVudC1tdXRhdGlvbiBpbmRleCBzdGFydGluZyB3aXRoIGEgcHJlZml4IHN0YXJ0aW5nIHdpdGhcbiAgICAgICAgLy8gdGhlIGdpdmVuIGRvY3VtZW50S2V5LlxuICAgICAgICBjb25zdCBuID0ganQodGhpcy51c2VySWQsIGUucGF0aCksIHMgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKG4pLCBpID0gW107XG4gICAgICAgIHJldHVybiBhbyh0KS5YKHtcbiAgICAgICAgICAgIHJhbmdlOiBzXG4gICAgICAgIH0sICgobiwgcywgcikgPT4ge1xuICAgICAgICAgICAgY29uc3QgW28sIHUsIGNdID0gbiwgYSA9IEd0KHUpO1xuICAgICAgICAgICAgLy8gT25seSBjb25zaWRlciByb3dzIG1hdGNoaW5nIGV4YWN0bHkgdGhlIHNwZWNpZmljIGtleSBvZlxuICAgICAgICAgICAgLy8gaW50ZXJlc3QuIE5vdGUgdGhhdCBiZWNhdXNlIHdlIG9yZGVyIGJ5IHBhdGggZmlyc3QsIGFuZCB3ZVxuICAgICAgICAgICAgLy8gb3JkZXIgdGVybWluYXRvcnMgYmVmb3JlIHBhdGggc2VwYXJhdG9ycywgd2UnbGwgZW5jb3VudGVyIGFsbFxuICAgICAgICAgICAgLy8gdGhlIGluZGV4IHJvd3MgZm9yIGRvY3VtZW50S2V5IGNvbnRpZ3VvdXNseS4gSW4gcGFydGljdWxhciwgYWxsXG4gICAgICAgICAgICAvLyB0aGUgcm93cyBmb3IgZG9jdW1lbnRLZXkgd2lsbCBvY2N1ciBiZWZvcmUgYW55IHJvd3MgZm9yXG4gICAgICAgICAgICAvLyBkb2N1bWVudHMgbmVzdGVkIGluIGEgc3ViY29sbGVjdGlvbiBiZW5lYXRoIGRvY3VtZW50S2V5IHNvIHdlXG4gICAgICAgICAgICAvLyBjYW4gc3RvcCBhcyBzb29uIGFzIHdlIGhpdCBhbnkgc3VjaCByb3cuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobyA9PT0gdGhpcy51c2VySWQgJiYgZS5wYXRoLmlzRXF1YWwoYSkpIFxuICAgICAgICAgICAgLy8gTG9vayB1cCB0aGUgbXV0YXRpb24gYmF0Y2ggaW4gdGhlIHN0b3JlLlxuICAgICAgICAgICAgcmV0dXJuIGNvKHQpLmdldChjKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoIXQpIHRocm93ICQoKTtcbiAgICAgICAgICAgICAgICBGKHQudXNlcklkID09PSB0aGlzLnVzZXJJZCksIGkucHVzaCh3cih0aGlzLnNlcmlhbGl6ZXIsIHQpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHIuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gaSkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5ldyBFZShldCk7XG4gICAgICAgIGNvbnN0IHMgPSBbXTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0ganQodGhpcy51c2VySWQsIGUucGF0aCksIHIgPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKGkpLCBvID0gYW8odCkuWCh7XG4gICAgICAgICAgICAgICAgcmFuZ2U6IHJcbiAgICAgICAgICAgIH0sICgodCwgcywgaSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtyLCBvLCB1XSA9IHQsIGMgPSBHdChvKTtcbiAgICAgICAgICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIHJvd3MgbWF0Y2hpbmcgZXhhY3RseSB0aGUgc3BlY2lmaWMga2V5IG9mXG4gICAgICAgICAgICAgICAgLy8gaW50ZXJlc3QuIE5vdGUgdGhhdCBiZWNhdXNlIHdlIG9yZGVyIGJ5IHBhdGggZmlyc3QsIGFuZCB3ZVxuICAgICAgICAgICAgICAgIC8vIG9yZGVyIHRlcm1pbmF0b3JzIGJlZm9yZSBwYXRoIHNlcGFyYXRvcnMsIHdlJ2xsIGVuY291bnRlciBhbGxcbiAgICAgICAgICAgICAgICAvLyB0aGUgaW5kZXggcm93cyBmb3IgZG9jdW1lbnRLZXkgY29udGlndW91c2x5LiBJbiBwYXJ0aWN1bGFyLCBhbGxcbiAgICAgICAgICAgICAgICAvLyB0aGUgcm93cyBmb3IgZG9jdW1lbnRLZXkgd2lsbCBvY2N1ciBiZWZvcmUgYW55IHJvd3MgZm9yXG4gICAgICAgICAgICAgICAgLy8gZG9jdW1lbnRzIG5lc3RlZCBpbiBhIHN1YmNvbGxlY3Rpb24gYmVuZWF0aCBkb2N1bWVudEtleSBzbyB3ZVxuICAgICAgICAgICAgICAgIC8vIGNhbiBzdG9wIGFzIHNvb24gYXMgd2UgaGl0IGFueSBzdWNoIHJvdy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgciA9PT0gdGhpcy51c2VySWQgJiYgZS5wYXRoLmlzRXF1YWwoYykgPyBuID0gbi5hZGQodSkgOiBpLmRvbmUoKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHMucHVzaChvKTtcbiAgICAgICAgfSkpLCB2dC53YWl0Rm9yKHMpLm5leHQoKCgpID0+IHRoaXMuU24odCwgbikpKTtcbiAgICB9XG4gICAgZ2V0QWxsTXV0YXRpb25CYXRjaGVzQWZmZWN0aW5nUXVlcnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS5wYXRoLCBzID0gbi5sZW5ndGggKyAxLCBpID0ganQodGhpcy51c2VySWQsIG4pLCByID0gSURCS2V5UmFuZ2UubG93ZXJCb3VuZChpKTtcbiAgICAgICAgLy8gQ29sbGVjdCB1cCB1bmlxdWUgYmF0Y2hJRHMgZW5jb3VudGVyZWQgZHVyaW5nIGEgc2NhbiBvZiB0aGUgaW5kZXguIFVzZSBhXG4gICAgICAgIC8vIFNvcnRlZFNldCB0byBhY2N1bXVsYXRlIGJhdGNoIElEcyBzbyB0aGV5IGNhbiBiZSB0cmF2ZXJzZWQgaW4gb3JkZXIgaW4gYVxuICAgICAgICAvLyBzY2FuIG9mIHRoZSBtYWluIHRhYmxlLlxuICAgICAgICBsZXQgbyA9IG5ldyBFZShldCk7XG4gICAgICAgIHJldHVybiBhbyh0KS5YKHtcbiAgICAgICAgICAgIHJhbmdlOiByXG4gICAgICAgIH0sICgodCwgZSwgaSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgW3IsIHUsIGNdID0gdCwgYSA9IEd0KHUpO1xuICAgICAgICAgICAgciA9PT0gdGhpcy51c2VySWQgJiYgbi5pc1ByZWZpeE9mKGEpID8gXG4gICAgICAgICAgICAvLyBSb3dzIHdpdGggZG9jdW1lbnQga2V5cyBtb3JlIHRoYW4gb25lIHNlZ21lbnQgbG9uZ2VyIHRoYW4gdGhlXG4gICAgICAgICAgICAvLyBxdWVyeSBwYXRoIGNhbid0IGJlIG1hdGNoZXMuIEZvciBleGFtcGxlLCBhIHF1ZXJ5IG9uICdyb29tcydcbiAgICAgICAgICAgIC8vIGNhbid0IG1hdGNoIHRoZSBkb2N1bWVudCAvcm9vbXMvYWJjL21lc3NhZ2VzL3h5eC5cbiAgICAgICAgICAgIC8vIFRPRE8obWNnKTogd2UnbGwgbmVlZCBhIGRpZmZlcmVudCBzY2FubmVyIHdoZW4gd2UgaW1wbGVtZW50XG4gICAgICAgICAgICAvLyBhbmNlc3RvciBxdWVyaWVzLlxuICAgICAgICAgICAgYS5sZW5ndGggPT09IHMgJiYgKG8gPSBvLmFkZChjKSkgOiBpLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHRoaXMuU24odCwgbykpKTtcbiAgICB9XG4gICAgU24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW10sIHMgPSBbXTtcbiAgICAgICAgLy8gVE9ETyhyb2Nrd29vZCk6IEltcGxlbWVudCB0aGlzIHVzaW5nIGl0ZXJhdGUuXG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgcy5wdXNoKGNvKHQpLmdldChlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gdCkgdGhyb3cgJCgpO1xuICAgICAgICAgICAgICAgIEYodC51c2VySWQgPT09IHRoaXMudXNlcklkKSwgbi5wdXNoKHdyKHRoaXMuc2VyaWFsaXplciwgdCkpO1xuICAgICAgICAgICAgfSkpKTtcbiAgICAgICAgfSkpLCB2dC53YWl0Rm9yKHMpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgcmVtb3ZlTXV0YXRpb25CYXRjaCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBpbyh0LmF0LCB0aGlzLnVzZXJJZCwgZSkubmV4dCgobiA9PiAodC5hZGRPbkNvbW1pdHRlZExpc3RlbmVyKCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLkRuKGUuYmF0Y2hJZCk7XG4gICAgICAgIH0pKSwgdnQuZm9yRWFjaChuLCAoZSA9PiB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIGUpKSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENsZWFycyB0aGUgY2FjaGVkIGtleXMgZm9yIGEgbXV0YXRpb24gYmF0Y2guIFRoaXMgbWV0aG9kIHNob3VsZCBiZVxuICAgICAqIGNhbGxlZCBieSBzZWNvbmRhcnkgY2xpZW50cyBhZnRlciB0aGV5IHByb2Nlc3MgbXV0YXRpb24gdXBkYXRlcy5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGlzIG1ldGhvZCBkb2VzIG5vdCBoYXZlIHRvIGJlIGNhbGxlZCBmcm9tIHByaW1hcnkgY2xpZW50cyBhc1xuICAgICAqIHRoZSBjb3JyZXNwb25kaW5nIGNhY2hlIGVudHJpZXMgYXJlIGNsZWFyZWQgd2hlbiBhbiBhY2tub3dsZWRnZWQgb3JcbiAgICAgKiByZWplY3RlZCBiYXRjaCBpcyByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHlcbiAgICBEbih0KSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmJuW3RdO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNoZWNrRW1wdHkodCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWUpIHJldHVybiB2dC5yZXNvbHZlKCk7XG4gICAgICAgICAgICAvLyBWZXJpZnkgdGhhdCB0aGVyZSBhcmUgbm8gZW50cmllcyBpbiB0aGUgZG9jdW1lbnRNdXRhdGlvbnMgaW5kZXggaWZcbiAgICAgICAgICAgIC8vIHRoZSBxdWV1ZSBpcyBlbXB0eS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBJREJLZXlSYW5nZS5sb3dlckJvdW5kKFsgdGhpcy51c2VySWQgXSk7XG4gICAgICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgICAgICByZXR1cm4gYW8odCkuWCh7XG4gICAgICAgICAgICAgICAgcmFuZ2U6IG5cbiAgICAgICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0WzBdID09PSB0aGlzLnVzZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gR3QodFsxXSk7XG4gICAgICAgICAgICAgICAgICAgIHMucHVzaChlKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Ugbi5kb25lKCk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgIEYoMCA9PT0gcy5sZW5ndGgpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHVvKHQsIHRoaXMudXNlcklkLCBlKTtcbiAgICB9XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seSAoc3RhdGUgaXMgaGVsZCBpbiBtZW1vcnkgaW4gb3RoZXIgY2xpZW50cykuXG4gICAgLyoqIFJldHVybnMgdGhlIG11dGF0aW9uIHF1ZXVlJ3MgbWV0YWRhdGEgZnJvbSBJbmRleGVkRGIuICovXG4gICAgQ24odCkge1xuICAgICAgICByZXR1cm4gaG8odCkuZ2V0KHRoaXMudXNlcklkKS5uZXh0KCh0ID0+IHQgfHwge1xuICAgICAgICAgICAgdXNlcklkOiB0aGlzLnVzZXJJZCxcbiAgICAgICAgICAgIGxhc3RBY2tub3dsZWRnZWRCYXRjaElkOiAtMSxcbiAgICAgICAgICAgIGxhc3RTdHJlYW1Ub2tlbjogXCJcIlxuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIG11dGF0aW9uIHF1ZXVlIGZvciB0aGUgZ2l2ZW4gdXNlciBjb250YWlucyBhIHBlbmRpbmdcbiAqICAgICAgICAgbXV0YXRpb24gZm9yIHRoZSBnaXZlbiBrZXkuXG4gKi8gZnVuY3Rpb24gdW8odCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBqdChlLCBuLnBhdGgpLCBpID0gc1sxXSwgciA9IElEQktleVJhbmdlLmxvd2VyQm91bmQocyk7XG4gICAgbGV0IG8gPSAhMTtcbiAgICByZXR1cm4gYW8odCkuWCh7XG4gICAgICAgIHJhbmdlOiByLFxuICAgICAgICBZOiAhMFxuICAgIH0sICgodCwgbiwgcykgPT4ge1xuICAgICAgICBjb25zdCBbciwgdSwgLypiYXRjaElEKi8gY10gPSB0O1xuICAgICAgICByID09PSBlICYmIHUgPT09IGkgJiYgKG8gPSAhMCksIHMuZG9uZSgpO1xuICAgIH0pKS5uZXh0KCgoKSA9PiBvKSk7XG59XG5cbi8qKiBSZXR1cm5zIHRydWUgaWYgYW55IG11dGF0aW9uIHF1ZXVlIGNvbnRhaW5zIHRoZSBnaXZlbiBkb2N1bWVudC4gKi9cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBtdXRhdGlvbnMgb2JqZWN0IHN0b3JlLlxuICovXG5mdW5jdGlvbiBjbyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwibXV0YXRpb25zXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgbXV0YXRpb25RdWV1ZXMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIGFvKHQpIHtcbiAgICByZXR1cm4gd2UodCwgXCJkb2N1bWVudE11dGF0aW9uc1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIG11dGF0aW9uUXVldWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBobyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwibXV0YXRpb25RdWV1ZXNcIik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogT2Zmc2V0IHRvIGVuc3VyZSBub24tb3ZlcmxhcHBpbmcgdGFyZ2V0IGlkcy4gKi9cbi8qKlxuICogR2VuZXJhdGVzIG1vbm90b25pY2FsbHkgaW5jcmVhc2luZyB0YXJnZXQgSURzIGZvciBzZW5kaW5nIHRhcmdldHMgdG8gdGhlXG4gKiB3YXRjaCBzdHJlYW0uXG4gKlxuICogVGhlIGNsaWVudCBjb25zdHJ1Y3RzIHR3byBnZW5lcmF0b3JzLCBvbmUgZm9yIHRoZSB0YXJnZXQgY2FjaGUsIGFuZCBvbmUgZm9yXG4gKiBmb3IgdGhlIHN5bmMgZW5naW5lICh0byBnZW5lcmF0ZSBsaW1ibyBkb2N1bWVudHMgdGFyZ2V0cykuIFRoZXNlXG4gKiBnZW5lcmF0b3JzIHByb2R1Y2Ugbm9uLW92ZXJsYXBwaW5nIElEcyAoYnkgdXNpbmcgZXZlbiBhbmQgb2RkIElEc1xuICogcmVzcGVjdGl2ZWx5KS5cbiAqXG4gKiBCeSBzZXBhcmF0aW5nIHRoZSB0YXJnZXQgSUQgc3BhY2UsIHRoZSBxdWVyeSBjYWNoZSBjYW4gZ2VuZXJhdGUgdGFyZ2V0IElEc1xuICogdGhhdCBwZXJzaXN0IGFjcm9zcyBjbGllbnQgcmVzdGFydHMsIHdoaWxlIHN5bmMgZW5naW5lIGNhbiBpbmRlcGVuZGVudGx5XG4gKiBnZW5lcmF0ZSBpbi1tZW1vcnkgdGFyZ2V0IElEcyB0aGF0IGFyZSB0cmFuc2llbnQgYW5kIGNhbiBiZSByZXVzZWQgYWZ0ZXIgYVxuICogcmVzdGFydC5cbiAqL1xuY2xhc3MgbG8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy54biA9IHQ7XG4gICAgfVxuICAgIG5leHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnhuICs9IDIsIHRoaXMueG47XG4gICAgfVxuICAgIHN0YXRpYyBObigpIHtcbiAgICAgICAgLy8gVGhlIHRhcmdldCBjYWNoZSBnZW5lcmF0b3IgbXVzdCByZXR1cm4gJzInIGluIGl0cyBmaXJzdCBjYWxsIHRvIGBuZXh0KClgXG4gICAgICAgIC8vIGFzIHRoZXJlIGlzIG5vIGRpZmZlcmVudGlhdGlvbiBpbiB0aGUgcHJvdG9jb2wgbGF5ZXIgYmV0d2VlbiBhbiB1bnNldFxuICAgICAgICAvLyBudW1iZXIgYW5kIHRoZSBudW1iZXIgJzAnLiBJZiB3ZSB3ZXJlIHRvIHNlbnQgYSB0YXJnZXQgd2l0aCB0YXJnZXQgSURcbiAgICAgICAgLy8gJzAnLCB0aGUgYmFja2VuZCB3b3VsZCBjb25zaWRlciBpdCB1bnNldCBhbmQgcmVwbGFjZSBpdCB3aXRoIGl0cyBvd24gSUQuXG4gICAgICAgIHJldHVybiBuZXcgbG8oMCk7XG4gICAgfVxuICAgIHN0YXRpYyBrbigpIHtcbiAgICAgICAgLy8gU3luYyBlbmdpbmUgYXNzaWducyB0YXJnZXQgSURzIGZvciBsaW1ibyBkb2N1bWVudCBkZXRlY3Rpb24uXG4gICAgICAgIHJldHVybiBuZXcgbG8oLTEpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgZm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHQsIHRoaXMuc2VyaWFsaXplciA9IGU7XG4gICAgfVxuICAgIC8vIFBPUlRJTkcgTk9URTogV2UgZG9uJ3QgY2FjaGUgZ2xvYmFsIG1ldGFkYXRhIGZvciB0aGUgdGFyZ2V0IGNhY2hlLCBzaW5jZVxuICAgIC8vIHNvbWUgb2YgaXQgKGluIHBhcnRpY3VsYXIgYGhpZ2hlc3RUYXJnZXRJZGApIGNhbiBiZSBtb2RpZmllZCBieSBzZWNvbmRhcnlcbiAgICAvLyB0YWJzLiBXZSBjb3VsZCBwZXJoYXBzIGJlIG1vcmUgZ3JhbnVsYXIgKGFuZCBlLmcuIHN0aWxsIGNhY2hlXG4gICAgLy8gYGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb25gIGluIG1lbW9yeSkgYnV0IGZvciBzaW1wbGljaXR5IHdlIGN1cnJlbnRseSBnb1xuICAgIC8vIHRvIEluZGV4ZWREYiB3aGVuZXZlciB3ZSBuZWVkIHRvIHJlYWQgbWV0YWRhdGEuIFdlIGNhbiByZXZpc2l0IGlmIGl0IHR1cm5zXG4gICAgLy8gb3V0IHRvIGhhdmUgYSBtZWFuaW5nZnVsIHBlcmZvcm1hbmNlIGltcGFjdC5cbiAgICBhbGxvY2F0ZVRhcmdldElkKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW4odCkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IGxvKGUuaGlnaGVzdFRhcmdldElkKTtcbiAgICAgICAgICAgIHJldHVybiBlLmhpZ2hlc3RUYXJnZXRJZCA9IG4ubmV4dCgpLCB0aGlzLk9uKHQsIGUpLm5leHQoKCgpID0+IGUuaGlnaGVzdFRhcmdldElkKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLk1uKHQpLm5leHQoKHQgPT4gcnQuZnJvbVRpbWVzdGFtcChuZXcgaXQodC5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uLnNlY29uZHMsIHQubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbi5uYW5vc2Vjb25kcykpKSk7XG4gICAgfVxuICAgIGdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLk1uKHQpLm5leHQoKHQgPT4gdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIpKTtcbiAgICB9XG4gICAgc2V0VGFyZ2V0c01ldGFkYXRhKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW4odCkubmV4dCgocyA9PiAocy5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgPSBlLCBuICYmIChzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24gPSBuLnRvVGltZXN0YW1wKCkpLCBcbiAgICAgICAgZSA+IHMuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyICYmIChzLmhpZ2hlc3RMaXN0ZW5TZXF1ZW5jZU51bWJlciA9IGUpLCB0aGlzLk9uKHQsIHMpKSkpO1xuICAgIH1cbiAgICBhZGRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJG4odCwgZSkubmV4dCgoKCkgPT4gdGhpcy5Nbih0KS5uZXh0KChuID0+IChuLnRhcmdldENvdW50ICs9IDEsIHRoaXMuRm4oZSwgbiksIFxuICAgICAgICB0aGlzLk9uKHQsIG4pKSkpKSk7XG4gICAgfVxuICAgIHVwZGF0ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy4kbih0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKCgpID0+IF9vKHQpLmRlbGV0ZShlLnRhcmdldElkKSkpLm5leHQoKCgpID0+IHRoaXMuTW4odCkpKS5uZXh0KChlID0+IChGKGUudGFyZ2V0Q291bnQgPiAwKSwgXG4gICAgICAgIGUudGFyZ2V0Q291bnQgLT0gMSwgdGhpcy5Pbih0LCBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRHJvcHMgYW55IHRhcmdldHMgd2l0aCBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCwgZXhjZXB0aW5nIHRob3NlXG4gICAgICogcHJlc2VudCBpbiBgYWN0aXZlVGFyZ2V0SWRzYC4gRG9jdW1lbnQgYXNzb2NpYXRpb25zIGZvciB0aGUgcmVtb3ZlZCB0YXJnZXRzIGFyZSBhbHNvIHJlbW92ZWQuXG4gICAgICogUmV0dXJucyB0aGUgbnVtYmVyIG9mIHRhcmdldHMgcmVtb3ZlZC5cbiAgICAgKi8gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIGxldCBzID0gMDtcbiAgICAgICAgY29uc3QgaSA9IFtdO1xuICAgICAgICByZXR1cm4gX28odCkuWCgoKHIsIG8pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHUgPSBtcihvKTtcbiAgICAgICAgICAgIHUuc2VxdWVuY2VOdW1iZXIgPD0gZSAmJiBudWxsID09PSBuLmdldCh1LnRhcmdldElkKSAmJiAocysrLCBpLnB1c2godGhpcy5yZW1vdmVUYXJnZXREYXRhKHQsIHUpKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB2dC53YWl0Rm9yKGkpKSkubmV4dCgoKCkgPT4gcykpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIHdpdGggZWFjaCBgVGFyZ2V0RGF0YWAgdGhhdCB3ZSBoYXZlIGNhY2hlZC5cbiAgICAgKi8gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHJldHVybiBfbyh0KS5YKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IG1yKG4pO1xuICAgICAgICAgICAgZShzKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBNbih0KSB7XG4gICAgICAgIHJldHVybiB3byh0KS5nZXQoXCJ0YXJnZXRHbG9iYWxLZXlcIikubmV4dCgodCA9PiAoRihudWxsICE9PSB0KSwgdCkpKTtcbiAgICB9XG4gICAgT24odCwgZSkge1xuICAgICAgICByZXR1cm4gd28odCkucHV0KFwidGFyZ2V0R2xvYmFsS2V5XCIsIGUpO1xuICAgIH1cbiAgICAkbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBfbyh0KS5wdXQoZ3IodGhpcy5zZXJpYWxpemVyLCBlKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEluLXBsYWNlIHVwZGF0ZXMgdGhlIHByb3ZpZGVkIG1ldGFkYXRhIHRvIGFjY291bnQgZm9yIHZhbHVlcyBpbiB0aGUgZ2l2ZW5cbiAgICAgKiBUYXJnZXREYXRhLiBTYXZpbmcgaXMgZG9uZSBzZXBhcmF0ZWx5LiBSZXR1cm5zIHRydWUgaWYgdGhlcmUgd2VyZSBhbnlcbiAgICAgKiBjaGFuZ2VzIHRvIHRoZSBtZXRhZGF0YS5cbiAgICAgKi8gICAgRm4odCwgZSkge1xuICAgICAgICBsZXQgbiA9ICExO1xuICAgICAgICByZXR1cm4gdC50YXJnZXRJZCA+IGUuaGlnaGVzdFRhcmdldElkICYmIChlLmhpZ2hlc3RUYXJnZXRJZCA9IHQudGFyZ2V0SWQsIG4gPSAhMCksIFxuICAgICAgICB0LnNlcXVlbmNlTnVtYmVyID4gZS5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXIgJiYgKGUuaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyID0gdC5zZXF1ZW5jZU51bWJlciwgXG4gICAgICAgIG4gPSAhMCksIG47XG4gICAgfVxuICAgIGdldFRhcmdldENvdW50KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTW4odCkubmV4dCgodCA9PiB0LnRhcmdldENvdW50KSk7XG4gICAgfVxuICAgIGdldFRhcmdldERhdGEodCwgZSkge1xuICAgICAgICAvLyBJdGVyYXRpbmcgYnkgdGhlIGNhbm9uaWNhbElkIG1heSB5aWVsZCBtb3JlIHRoYW4gb25lIHJlc3VsdCBiZWNhdXNlXG4gICAgICAgIC8vIGNhbm9uaWNhbElkIHZhbHVlcyBhcmUgbm90IHJlcXVpcmVkIHRvIGJlIHVuaXF1ZSBwZXIgdGFyZ2V0LiBUaGlzIHF1ZXJ5XG4gICAgICAgIC8vIGRlcGVuZHMgb24gdGhlIHF1ZXJ5VGFyZ2V0cyBpbmRleCB0byBiZSBlZmZpY2llbnQuXG4gICAgICAgIGNvbnN0IG4gPSBPbihlKSwgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgbiwgTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZIF0sIFsgbiwgTnVtYmVyLlBPU0lUSVZFX0lORklOSVRZIF0pO1xuICAgICAgICBsZXQgaSA9IG51bGw7XG4gICAgICAgIHJldHVybiBfbyh0KS5YKHtcbiAgICAgICAgICAgIHJhbmdlOiBzLFxuICAgICAgICAgICAgaW5kZXg6IFwicXVlcnlUYXJnZXRzSW5kZXhcIlxuICAgICAgICB9LCAoKHQsIG4sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBtcihuKTtcbiAgICAgICAgICAgIC8vIEFmdGVyIGZpbmRpbmcgYSBwb3RlbnRpYWwgbWF0Y2gsIGNoZWNrIHRoYXQgdGhlIHRhcmdldCBpc1xuICAgICAgICAgICAgLy8gYWN0dWFsbHkgZXF1YWwgdG8gdGhlIHJlcXVlc3RlZCB0YXJnZXQuXG4gICAgICAgICAgICAgICAgICAgICAgICAkbihlLCByLnRhcmdldCkgJiYgKGkgPSByLCBzLmRvbmUoKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBpKSk7XG4gICAgfVxuICAgIGFkZE1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gW10sIGkgPSBtbyh0KTtcbiAgICAgICAgcmV0dXJuIGUuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gcXQoZS5wYXRoKTtcbiAgICAgICAgICAgIHMucHVzaChpLnB1dCh7XG4gICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IG4sXG4gICAgICAgICAgICAgICAgcGF0aDogclxuICAgICAgICAgICAgfSkpLCBzLnB1c2godGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodCwgbiwgZSkpO1xuICAgICAgICB9KSksIHZ0LndhaXRGb3Iocyk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5cyh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogVGhlIHJldmVyc2UgaW5kZXggKGRvY3VtZW50c1RhcmdldHMpIGlzIG1haW50YWluZWQgYnlcbiAgICAgICAgLy8gSW5kZXhlZERiLlxuICAgICAgICBjb25zdCBzID0gbW8odCk7XG4gICAgICAgIHJldHVybiB2dC5mb3JFYWNoKGUsIChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBxdChlLnBhdGgpO1xuICAgICAgICAgICAgcmV0dXJuIHZ0LndhaXRGb3IoWyBzLmRlbGV0ZShbIG4sIGkgXSksIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHQsIG4sIGUpIF0pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG1vKHQpLCBzID0gSURCS2V5UmFuZ2UuYm91bmQoWyBlIF0sIFsgZSArIDEgXSwgXG4gICAgICAgIC8qbG93ZXJPcGVuPSovICExLCBcbiAgICAgICAgLyp1cHBlck9wZW49Ki8gITApO1xuICAgICAgICByZXR1cm4gbi5kZWxldGUocyk7XG4gICAgfVxuICAgIGdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IElEQktleVJhbmdlLmJvdW5kKFsgZSBdLCBbIGUgKyAxIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKSwgcyA9IG1vKHQpO1xuICAgICAgICBsZXQgaSA9IGdzKCk7XG4gICAgICAgIHJldHVybiBzLlgoe1xuICAgICAgICAgICAgcmFuZ2U6IG4sXG4gICAgICAgICAgICBZOiAhMFxuICAgICAgICB9LCAoKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBHdCh0WzFdKSwgciA9IG5ldyBodChzKTtcbiAgICAgICAgICAgIGkgPSBpLmFkZChyKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgY29udGFpbnNLZXkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gcXQoZS5wYXRoKSwgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgbiBdLCBbIHN0KG4pIF0sIFxuICAgICAgICAvKmxvd2VyT3Blbj0qLyAhMSwgXG4gICAgICAgIC8qdXBwZXJPcGVuPSovICEwKTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICByZXR1cm4gbW8odCkuWCh7XG4gICAgICAgICAgICBpbmRleDogXCJkb2N1bWVudFRhcmdldHNJbmRleFwiLFxuICAgICAgICAgICAgWTogITAsXG4gICAgICAgICAgICByYW5nZTogc1xuICAgICAgICB9LCAoKFt0LCBlXSwgbiwgcykgPT4ge1xuICAgICAgICAgICAgLy8gSGF2aW5nIGEgc2VudGluZWwgcm93IGZvciBhIGRvY3VtZW50IGRvZXMgbm90IGNvdW50IGFzIGNvbnRhaW5pbmcgdGhhdCBkb2N1bWVudDtcbiAgICAgICAgICAgIC8vIEZvciB0aGUgdGFyZ2V0IGNhY2hlLCBjb250YWluaW5nIHRoZSBkb2N1bWVudCBtZWFucyB0aGUgZG9jdW1lbnQgaXMgcGFydCBvZiBzb21lXG4gICAgICAgICAgICAvLyB0YXJnZXQuXG4gICAgICAgICAgICAwICE9PSB0ICYmIChpKyssIHMuZG9uZSgpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkgPiAwKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIExvb2tzIHVwIGEgVGFyZ2V0RGF0YSBlbnRyeSBieSB0YXJnZXQgSUQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdGFyZ2V0SWQgLSBUaGUgdGFyZ2V0IElEIG9mIHRoZSBUYXJnZXREYXRhIGVudHJ5IHRvIGxvb2sgdXAuXG4gICAgICogQHJldHVybnMgVGhlIGNhY2hlZCBUYXJnZXREYXRhIGVudHJ5LCBvciBudWxsIGlmIHRoZSBjYWNoZSBoYXMgbm8gZW50cnkgZm9yXG4gICAgICogdGhlIHRhcmdldC5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIGhlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIF9vKHQpLmdldChlKS5uZXh0KCh0ID0+IHQgPyBtcih0KSA6IG51bGwpKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBxdWVyaWVzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBfbyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwidGFyZ2V0c1wiKTtcbn1cblxuLyoqXG4gKiBIZWxwZXIgdG8gZ2V0IGEgdHlwZWQgU2ltcGxlRGJTdG9yZSBmb3IgdGhlIHRhcmdldCBnbG9iYWxzIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiB3byh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwidGFyZ2V0R2xvYmFsXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgZG9jdW1lbnQgdGFyZ2V0IG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBtbyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwidGFyZ2V0RG9jdW1lbnRzXCIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBnbyhbdCwgZV0sIFtuLCBzXSkge1xuICAgIGNvbnN0IGkgPSBldCh0LCBuKTtcbiAgICByZXR1cm4gMCA9PT0gaSA/IGV0KGUsIHMpIDogaTtcbn1cblxuLyoqXG4gKiBVc2VkIHRvIGNhbGN1bGF0ZSB0aGUgbnRoIHNlcXVlbmNlIG51bWJlci4gS2VlcHMgYSByb2xsaW5nIGJ1ZmZlciBvZiB0aGVcbiAqIGxvd2VzdCBuIHZhbHVlcyBwYXNzZWQgdG8gYGFkZEVsZW1lbnRgLCBhbmQgZmluYWxseSByZXBvcnRzIHRoZSBsYXJnZXN0IG9mXG4gKiB0aGVtIGluIGBtYXhWYWx1ZWAuXG4gKi8gY2xhc3MgeW8ge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5CbiA9IHQsIHRoaXMuYnVmZmVyID0gbmV3IEVlKGdvKSwgdGhpcy5MbiA9IDA7XG4gICAgfVxuICAgIHFuKCkge1xuICAgICAgICByZXR1cm4gKyt0aGlzLkxuO1xuICAgIH1cbiAgICBVbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBbIHQsIHRoaXMucW4oKSBdO1xuICAgICAgICBpZiAodGhpcy5idWZmZXIuc2l6ZSA8IHRoaXMuQm4pIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuYWRkKGUpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmJ1ZmZlci5sYXN0KCk7XG4gICAgICAgICAgICBnbyhlLCB0KSA8IDAgJiYgKHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuZGVsZXRlKHQpLmFkZChlKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZ2V0IG1heFZhbHVlKCkge1xuICAgICAgICAvLyBHdWFyYW50ZWVkIHRvIGJlIG5vbi1lbXB0eS4gSWYgd2UgZGVjaWRlIHdlIGFyZSBub3QgY29sbGVjdGluZyBhbnlcbiAgICAgICAgLy8gc2VxdWVuY2UgbnVtYmVycywgbnRoU2VxdWVuY2VOdW1iZXIgYmVsb3cgc2hvcnQtY2lyY3VpdHMuIElmIHdlIGhhdmVcbiAgICAgICAgLy8gZGVjaWRlZCB0aGF0IHdlIGFyZSBjb2xsZWN0aW5nIG4gc2VxdWVuY2UgbnVtYmVycywgaXQncyBiZWNhdXNlIG4gaXMgc29tZVxuICAgICAgICAvLyBwZXJjZW50YWdlIG9mIHRoZSBleGlzdGluZyBzZXF1ZW5jZSBudW1iZXJzLiBUaGF0IG1lYW5zIHdlIHNob3VsZCBuZXZlclxuICAgICAgICAvLyBiZSBpbiBhIHNpdHVhdGlvbiB3aGVyZSB3ZSBhcmUgY29sbGVjdGluZyBzZXF1ZW5jZSBudW1iZXJzIGJ1dCBkb24ndFxuICAgICAgICAvLyBhY3R1YWxseSBoYXZlIGFueS5cbiAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyLmxhc3QoKVswXTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyBpcyByZXNwb25zaWJsZSBmb3IgdGhlIHNjaGVkdWxpbmcgb2YgTFJVIGdhcmJhZ2UgY29sbGVjdGlvbi4gSXQgaGFuZGxlcyBjaGVja2luZ1xuICogd2hldGhlciBvciBub3QgR0MgaXMgZW5hYmxlZCwgYXMgd2VsbCBhcyB3aGljaCBkZWxheSB0byB1c2UgYmVmb3JlIHRoZSBuZXh0IHJ1bi5cbiAqLyBjbGFzcyBwbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IgPSB0LCB0aGlzLmFzeW5jUXVldWUgPSBlLCB0aGlzLmxvY2FsU3RvcmUgPSBuLCB0aGlzLktuID0gbnVsbDtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIC0xICE9PSB0aGlzLmdhcmJhZ2VDb2xsZWN0b3IucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgJiYgdGhpcy5Hbig2ZTQpO1xuICAgIH1cbiAgICBzdG9wKCkge1xuICAgICAgICB0aGlzLktuICYmICh0aGlzLktuLmNhbmNlbCgpLCB0aGlzLktuID0gbnVsbCk7XG4gICAgfVxuICAgIGdldCBzdGFydGVkKCkge1xuICAgICAgICByZXR1cm4gbnVsbCAhPT0gdGhpcy5LbjtcbiAgICB9XG4gICAgR24odCkge1xuICAgICAgICBOKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgR2FyYmFnZSBjb2xsZWN0aW9uIHNjaGVkdWxlZCBpbiAke3R9bXNgKSwgdGhpcy5LbiA9IHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQWZ0ZXJEZWxheShcImxydV9nYXJiYWdlX2NvbGxlY3Rpb25cIiAvKiBUaW1lcklkLkxydUdhcmJhZ2VDb2xsZWN0aW9uICovICwgdCwgKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuS24gPSBudWxsO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmxvY2FsU3RvcmUuY29sbGVjdEdhcmJhZ2UodGhpcy5nYXJiYWdlQ29sbGVjdG9yKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBEdCh0KSA/IE4oXCJMcnVHYXJiYWdlQ29sbGVjdG9yXCIsIFwiSWdub3JpbmcgSW5kZXhlZERCIGVycm9yIGR1cmluZyBnYXJiYWdlIGNvbGxlY3Rpb246IFwiLCB0KSA6IGF3YWl0IFJ0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgdGhpcy5HbigzZTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEltcGxlbWVudHMgdGhlIHN0ZXBzIGZvciBMUlUgZ2FyYmFnZSBjb2xsZWN0aW9uLlxuICovIGNsYXNzIElvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuUW4gPSB0LCB0aGlzLnBhcmFtcyA9IGU7XG4gICAgfVxuICAgIGNhbGN1bGF0ZVRhcmdldENvdW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUW4uam4odCkubmV4dCgodCA9PiBNYXRoLmZsb29yKGUgLyAxMDAgKiB0KSkpO1xuICAgIH1cbiAgICBudGhTZXF1ZW5jZU51bWJlcih0LCBlKSB7XG4gICAgICAgIGlmICgwID09PSBlKSByZXR1cm4gdnQucmVzb2x2ZSgkdC5jdCk7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgeW8oZSk7XG4gICAgICAgIHJldHVybiB0aGlzLlFuLmZvckVhY2hUYXJnZXQodCwgKHQgPT4gbi5Vbih0LnNlcXVlbmNlTnVtYmVyKSkpLm5leHQoKCgpID0+IHRoaXMuUW4uem4odCwgKHQgPT4gbi5Vbih0KSkpKSkubmV4dCgoKCkgPT4gbi5tYXhWYWx1ZSkpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuUW4ucmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Rbi5yZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKTtcbiAgICB9XG4gICAgY29sbGVjdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiAtMSA9PT0gdGhpcy5wYXJhbXMuY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCA/IChOKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBcIkdhcmJhZ2UgY29sbGVjdGlvbiBza2lwcGVkOyBkaXNhYmxlZFwiKSwgXG4gICAgICAgIHZ0LnJlc29sdmUobm8pKSA6IHRoaXMuZ2V0Q2FjaGVTaXplKHQpLm5leHQoKG4gPT4gbiA8IHRoaXMucGFyYW1zLmNhY2hlU2l6ZUNvbGxlY3Rpb25UaHJlc2hvbGQgPyAoTihcIkxydUdhcmJhZ2VDb2xsZWN0b3JcIiwgYEdhcmJhZ2UgY29sbGVjdGlvbiBza2lwcGVkOyBDYWNoZSBzaXplICR7bn0gaXMgbG93ZXIgdGhhbiB0aHJlc2hvbGQgJHt0aGlzLnBhcmFtcy5jYWNoZVNpemVDb2xsZWN0aW9uVGhyZXNob2xkfWApLCBcbiAgICAgICAgbm8pIDogdGhpcy5Xbih0LCBlKSkpO1xuICAgIH1cbiAgICBnZXRDYWNoZVNpemUodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5Rbi5nZXRDYWNoZVNpemUodCk7XG4gICAgfVxuICAgIFduKHQsIGUpIHtcbiAgICAgICAgbGV0IG4sIHMsIGksIHIsIG8sIGMsIGE7XG4gICAgICAgIGNvbnN0IGggPSBEYXRlLm5vdygpO1xuICAgICAgICByZXR1cm4gdGhpcy5jYWxjdWxhdGVUYXJnZXRDb3VudCh0LCB0aGlzLnBhcmFtcy5wZXJjZW50aWxlVG9Db2xsZWN0KS5uZXh0KChlID0+IChcbiAgICAgICAgLy8gQ2FwIGF0IHRoZSBjb25maWd1cmVkIG1heFxuICAgICAgICBlID4gdGhpcy5wYXJhbXMubWF4aW11bVNlcXVlbmNlTnVtYmVyc1RvQ29sbGVjdCA/IChOKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgQ2FwcGluZyBzZXF1ZW5jZSBudW1iZXJzIHRvIGNvbGxlY3QgZG93biB0byB0aGUgbWF4aW11bSBvZiAke3RoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3R9IGZyb20gJHtlfWApLCBcbiAgICAgICAgcyA9IHRoaXMucGFyYW1zLm1heGltdW1TZXF1ZW5jZU51bWJlcnNUb0NvbGxlY3QpIDogcyA9IGUsIHIgPSBEYXRlLm5vdygpLCB0aGlzLm50aFNlcXVlbmNlTnVtYmVyKHQsIHMpKSkpLm5leHQoKHMgPT4gKG4gPSBzLCBcbiAgICAgICAgbyA9IERhdGUubm93KCksIHRoaXMucmVtb3ZlVGFyZ2V0cyh0LCBuLCBlKSkpKS5uZXh0KChlID0+IChpID0gZSwgYyA9IERhdGUubm93KCksIFxuICAgICAgICB0aGlzLnJlbW92ZU9ycGhhbmVkRG9jdW1lbnRzKHQsIG4pKSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgaWYgKGEgPSBEYXRlLm5vdygpLCBDKCkgPD0gTG9nTGV2ZWwuREVCVUcpIHtcbiAgICAgICAgICAgICAgICBOKFwiTHJ1R2FyYmFnZUNvbGxlY3RvclwiLCBgTFJVIEdhcmJhZ2UgQ29sbGVjdGlvblxcblxcdENvdW50ZWQgdGFyZ2V0cyBpbiAke3IgLSBofW1zXFxuXFx0RGV0ZXJtaW5lZCBsZWFzdCByZWNlbnRseSB1c2VkICR7c30gaW4gYCArIChvIC0gcikgKyBcIm1zXFxuXCIgKyBgXFx0UmVtb3ZlZCAke2l9IHRhcmdldHMgaW4gYCArIChjIC0gbykgKyBcIm1zXFxuXCIgKyBgXFx0UmVtb3ZlZCAke3R9IGRvY3VtZW50cyBpbiBgICsgKGEgLSBjKSArIFwibXNcXG5cIiArIGBUb3RhbCBEdXJhdGlvbjogJHthIC0gaH1tc2ApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoe1xuICAgICAgICAgICAgICAgIGRpZFJ1bjogITAsXG4gICAgICAgICAgICAgICAgc2VxdWVuY2VOdW1iZXJzQ29sbGVjdGVkOiBzLFxuICAgICAgICAgICAgICAgIHRhcmdldHNSZW1vdmVkOiBpLFxuICAgICAgICAgICAgICAgIGRvY3VtZW50c1JlbW92ZWQ6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBUbyh0LCBlKSB7XG4gICAgcmV0dXJuIG5ldyBJbyh0LCBlKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQcm92aWRlcyBMUlUgZnVuY3Rpb25hbGl0eSBmb3IgSW5kZXhlZERCIHBlcnNpc3RlbmNlLiAqLyBjbGFzcyBFbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmRiID0gdCwgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gVG8odGhpcywgZSk7XG4gICAgfVxuICAgIGpuKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuSG4odCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkuZ2V0VGFyZ2V0Q291bnQodCkubmV4dCgodCA9PiBlLm5leHQoKGUgPT4gdCArIGUpKSkpO1xuICAgIH1cbiAgICBIbih0KSB7XG4gICAgICAgIGxldCBlID0gMDtcbiAgICAgICAgcmV0dXJuIHRoaXMuem4odCwgKHQgPT4ge1xuICAgICAgICAgICAgZSsrO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZSkpO1xuICAgIH1cbiAgICBmb3JFYWNoVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS5mb3JFYWNoVGFyZ2V0KHQsIGUpO1xuICAgIH1cbiAgICB6bih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkpuKHQsICgodCwgbikgPT4gZShuKSkpO1xuICAgIH1cbiAgICBhZGRSZWZlcmVuY2UodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gQW8odCwgbik7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBBbyh0LCBuKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmRiLmdldFRhcmdldENhY2hlKCkucmVtb3ZlVGFyZ2V0cyh0LCBlLCBuKTtcbiAgICB9XG4gICAgbWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkge1xuICAgICAgICByZXR1cm4gQW8odCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBhbnl0aGluZyB3b3VsZCBwcmV2ZW50IHRoaXMgZG9jdW1lbnQgZnJvbSBiZWluZyBnYXJiYWdlXG4gICAgICogY29sbGVjdGVkLCBnaXZlbiB0aGF0IHRoZSBkb2N1bWVudCBpbiBxdWVzdGlvbiBpcyBub3QgcHJlc2VudCBpbiBhbnlcbiAgICAgKiB0YXJnZXRzIGFuZCBoYXMgYSBzZXF1ZW5jZSBudW1iZXIgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHRoZSB1cHBlciBib3VuZCBmb3JcbiAgICAgKiB0aGUgY29sbGVjdGlvbiBydW4uXG4gICAgICovICAgIFluKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGxldCBuID0gITE7XG4gICAgICAgICAgICByZXR1cm4gaG8odCkuWigocyA9PiB1byh0LCBzLCBlKS5uZXh0KCh0ID0+ICh0ICYmIChuID0gITApLCB2dC5yZXNvbHZlKCF0KSkpKSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICAgICAgfSh0LCBlKTtcbiAgICB9XG4gICAgcmVtb3ZlT3JwaGFuZWREb2N1bWVudHModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kYi5nZXRSZW1vdGVEb2N1bWVudENhY2hlKCkubmV3Q2hhbmdlQnVmZmVyKCksIHMgPSBbXTtcbiAgICAgICAgbGV0IGkgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy5Kbih0LCAoKHIsIG8pID0+IHtcbiAgICAgICAgICAgIGlmIChvIDw9IGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdGhpcy5Zbih0LCByKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlKSBcbiAgICAgICAgICAgICAgICAgICAgLy8gT3VyIHNpemUgYWNjb3VudGluZyByZXF1aXJlcyB1cyB0byByZWFkIGFsbCBkb2N1bWVudHMgYmVmb3JlXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlbW92aW5nIHRoZW0uXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpKyssIG4uZ2V0RW50cnkodCwgcikubmV4dCgoKCkgPT4gKG4ucmVtb3ZlRW50cnkociwgcnQubWluKCkpLCBtbyh0KS5kZWxldGUoWyAwLCBxdChyLnBhdGgpIF0pKSkpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICBzLnB1c2goZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB2dC53YWl0Rm9yKHMpKSkubmV4dCgoKCkgPT4gbi5hcHBseSh0KSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUud2l0aFNlcXVlbmNlTnVtYmVyKHQuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKHQsIG4pO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIEFvKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYWxsIHByb3ZpZGVkIGZ1bmN0aW9uIGZvciBlYWNoIGRvY3VtZW50IGluIHRoZSBjYWNoZSB0aGF0IGlzICdvcnBoYW5lZCcuIE9ycGhhbmVkXG4gICAgICogbWVhbnMgbm90IGEgcGFydCBvZiBhbnkgdGFyZ2V0LCBzbyB0aGUgb25seSBlbnRyeSBpbiB0aGUgdGFyZ2V0LWRvY3VtZW50IGluZGV4IGZvclxuICAgICAqIHRoYXQgZG9jdW1lbnQgd2lsbCBiZSB0aGUgc2VudGluZWwgcm93ICh0YXJnZXRJZCAwKSwgd2hpY2ggd2lsbCBhbHNvIGhhdmUgdGhlIHNlcXVlbmNlXG4gICAgICogbnVtYmVyIGZvciB0aGUgbGFzdCB0aW1lIHRoZSBkb2N1bWVudCB3YXMgYWNjZXNzZWQuXG4gICAgICovICAgIEpuKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG1vKHQpO1xuICAgICAgICBsZXQgcywgaSA9ICR0LmN0O1xuICAgICAgICByZXR1cm4gbi5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50VGFyZ2V0c0luZGV4XCJcbiAgICAgICAgfSwgKChbdCwgbl0sIHtwYXRoOiByLCBzZXF1ZW5jZU51bWJlcjogb30pID0+IHtcbiAgICAgICAgICAgIDAgPT09IHQgPyAoXG4gICAgICAgICAgICAvLyBpZiBuZXh0VG9SZXBvcnQgaXMgdmFsaWQsIHJlcG9ydCBpdCwgdGhpcyBpcyBhIG5ldyBrZXkgc28gdGhlXG4gICAgICAgICAgICAvLyBsYXN0IG9uZSBtdXN0IG5vdCBiZSBhIG1lbWJlciBvZiBhbnkgdGFyZ2V0cy5cbiAgICAgICAgICAgIGkgIT09ICR0LmN0ICYmIGUobmV3IGh0KEd0KHMpKSwgaSksIFxuICAgICAgICAgICAgLy8gc2V0IG5leHRUb1JlcG9ydCB0byBiZSB0aGlzIHNlcXVlbmNlIG51bWJlci4gSXQncyB0aGUgbmV4dCBvbmUgd2VcbiAgICAgICAgICAgIC8vIG1pZ2h0IHJlcG9ydCwgaWYgd2UgZG9uJ3QgZmluZCBhbnkgdGFyZ2V0cyBmb3IgdGhpcyBkb2N1bWVudC5cbiAgICAgICAgICAgIC8vIE5vdGUgdGhhdCB0aGUgc2VxdWVuY2UgbnVtYmVyIG11c3QgYmUgZGVmaW5lZCB3aGVuIHRoZSB0YXJnZXRJZFxuICAgICAgICAgICAgLy8gaXMgMC5cbiAgICAgICAgICAgIGkgPSBvLCBzID0gcikgOiBcbiAgICAgICAgICAgIC8vIHNldCBuZXh0VG9SZXBvcnQgdG8gYmUgaW52YWxpZCwgd2Uga25vdyB3ZSBkb24ndCBuZWVkIHRvIHJlcG9ydFxuICAgICAgICAgICAgLy8gdGhpcyBvbmUgc2luY2Ugd2UgZm91bmQgYSB0YXJnZXQgZm9yIGl0LlxuICAgICAgICAgICAgaSA9ICR0LmN0O1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gU2luY2Ugd2UgcmVwb3J0IHNlcXVlbmNlIG51bWJlcnMgYWZ0ZXIgZ2V0dGluZyB0byB0aGUgbmV4dCBrZXksIHdlXG4gICAgICAgICAgICAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoZSBsYXN0IGtleSB3ZSBpdGVyYXRlZCBvdmVyIHdhcyBhbiBvcnBoYW5lZFxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgYW5kIHJlcG9ydCBpdC5cbiAgICAgICAgICAgIGkgIT09ICR0LmN0ICYmIGUobmV3IGh0KEd0KHMpKSwgaSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0Q2FjaGVTaXplKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGIuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLmdldFNpemUodCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBBbyh0LCBlKSB7XG4gICAgcmV0dXJuIG1vKHQpLnB1dChcbiAgICAvKipcbiAqIEByZXR1cm5zIEEgdmFsdWUgc3VpdGFibGUgZm9yIHdyaXRpbmcgYSBzZW50aW5lbCByb3cgaW4gdGhlIHRhcmdldC1kb2N1bWVudFxuICogc3RvcmUuXG4gKi9cbiAgICBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB0YXJnZXRJZDogMCxcbiAgICAgICAgICAgIHBhdGg6IHF0KHQucGF0aCksXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogZVxuICAgICAgICB9O1xuICAgIH0oZSwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQW4gaW4tbWVtb3J5IGJ1ZmZlciBvZiBlbnRyaWVzIHRvIGJlIHdyaXR0ZW4gdG8gYSBSZW1vdGVEb2N1bWVudENhY2hlLlxuICogSXQgY2FuIGJlIHVzZWQgdG8gYmF0Y2ggdXAgYSBzZXQgb2YgY2hhbmdlcyB0byBiZSB3cml0dGVuIHRvIHRoZSBjYWNoZSwgYnV0XG4gKiBhZGRpdGlvbmFsbHkgc3VwcG9ydHMgcmVhZGluZyBlbnRyaWVzIGJhY2sgd2l0aCB0aGUgYGdldEVudHJ5KClgIG1ldGhvZCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgdW5kZXJseWluZyBSZW1vdGVEb2N1bWVudENhY2hlIGlmIG5vIGVudHJ5IGlzXG4gKiBidWZmZXJlZC5cbiAqXG4gKiBFbnRyaWVzIGFkZGVkIHRvIHRoZSBjYWNoZSAqbXVzdCogYmUgcmVhZCBmaXJzdC4gVGhpcyBpcyB0byBmYWNpbGl0YXRlXG4gKiBjYWxjdWxhdGluZyB0aGUgc2l6ZSBkZWx0YSBvZiB0aGUgcGVuZGluZyBjaGFuZ2VzLlxuICpcbiAqIFBPUlRJTkcgTk9URTogVGhpcyBjbGFzcyB3YXMgaW1wbGVtZW50ZWQgdGhlbiByZW1vdmVkIGZyb20gb3RoZXIgcGxhdGZvcm1zLlxuICogSWYgYnl0ZS1jb3VudGluZyBlbmRzIHVwIGJlaW5nIG5lZWRlZCBvbiB0aGUgb3RoZXIgcGxhdGZvcm1zLCBjb25zaWRlclxuICogcG9ydGluZyB0aGlzIGNsYXNzIGFzIHBhcnQgb2YgdGhhdCBpbXBsZW1lbnRhdGlvbiB3b3JrLlxuICovIGNsYXNzIFJvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLy8gQSBtYXBwaW5nIG9mIGRvY3VtZW50IGtleSB0byB0aGUgbmV3IGNhY2hlIGVudHJ5IHRoYXQgc2hvdWxkIGJlIHdyaXR0ZW4uXG4gICAgICAgIHRoaXMuY2hhbmdlcyA9IG5ldyBvcygodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpLCB0aGlzLmNoYW5nZXNBcHBsaWVkID0gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5hZGRFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IG1vZGlmeSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgYWRkRW50cnkodCkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LmtleSwgdCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEJ1ZmZlcnMgYSBgUmVtb3RlRG9jdW1lbnRDYWNoZS5yZW1vdmVFbnRyeSgpYCBjYWxsLlxuICAgICAqXG4gICAgICogWW91IGNhbiBvbmx5IHJlbW92ZSBkb2N1bWVudHMgdGhhdCBoYXZlIGFscmVhZHkgYmVlbiByZXRyaWV2ZWQgdmlhXG4gICAgICogYGdldEVudHJ5KCkvZ2V0RW50cmllcygpYCAoZW5mb3JjZWQgdmlhIEluZGV4ZWREYnMgYGFwcGx5KClgKS5cbiAgICAgKi8gICAgcmVtb3ZlRW50cnkodCwgZSkge1xuICAgICAgICB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzLnNldCh0LCBhbi5uZXdJbnZhbGlkRG9jdW1lbnQodCkuc2V0UmVhZFRpbWUoZSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuIFRoZSBidWZmZXJlZCBjaGFuZ2VzIHdpbGwgZmlyc3QgYmUgY2hlY2tlZCxcbiAgICAgKiBhbmQgaWYgbm8gYnVmZmVyZWQgY2hhbmdlIGFwcGxpZXMsIHRoaXMgd2lsbCBmb3J3YXJkIHRvXG4gICAgICogYFJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgdHJhbnNhY3Rpb24gaW4gd2hpY2ggdG8gcGVyZm9ybSBhbnkgcGVyc2lzdGVuY2VcbiAgICAgKiAgICAgb3BlcmF0aW9ucy5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgLSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgZG9jdW1lbnQgb3IgYW4gaW52YWxpZCBkb2N1bWVudCBpZiB3ZSBoYXZlIG5vdGhpbmdcbiAgICAgKiBjYWNoZWQuXG4gICAgICovICAgIGdldEVudHJ5KHQsIGUpIHtcbiAgICAgICAgdGhpcy5hc3NlcnROb3RBcHBsaWVkKCk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLmNoYW5nZXMuZ2V0KGUpO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBuID8gdnQucmVzb2x2ZShuKSA6IHRoaXMuZ2V0RnJvbUNhY2hlKHQsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBzZXZlcmFsIGVudHJpZXMgaW4gdGhlIGNhY2hlLCBmb3J3YXJkaW5nIHRvXG4gICAgICogYFJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkoKWAuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgdHJhbnNhY3Rpb24gaW4gd2hpY2ggdG8gcGVyZm9ybSBhbnkgcGVyc2lzdGVuY2VcbiAgICAgKiAgICAgb3BlcmF0aW9ucy5cbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXlzIC0gVGhlIGtleXMgb2YgdGhlIGVudHJpZXMgdG8gbG9vayB1cC5cbiAgICAgKiBAcmV0dXJucyBBIG1hcCBvZiBjYWNoZWQgZG9jdW1lbnRzLCBpbmRleGVkIGJ5IGtleS4gSWYgYW4gZW50cnkgY2Fubm90IGJlXG4gICAgICogICAgIGZvdW5kLCB0aGUgY29ycmVzcG9uZGluZyBrZXkgd2lsbCBiZSBtYXBwZWQgdG8gYW4gaW52YWxpZCBkb2N1bWVudC5cbiAgICAgKi8gICAgZ2V0RW50cmllcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldEFsbEZyb21DYWNoZSh0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBidWZmZXJlZCBjaGFuZ2VzIHRvIHRoZSB1bmRlcmx5aW5nIFJlbW90ZURvY3VtZW50Q2FjaGUsIHVzaW5nXG4gICAgICogdGhlIHByb3ZpZGVkIHRyYW5zYWN0aW9uLlxuICAgICAqLyAgICBhcHBseSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmFzc2VydE5vdEFwcGxpZWQoKSwgdGhpcy5jaGFuZ2VzQXBwbGllZCA9ICEwLCB0aGlzLmFwcGx5Q2hhbmdlcyh0KTtcbiAgICB9XG4gICAgLyoqIEhlbHBlciB0byBhc3NlcnQgdGhpcy5jaGFuZ2VzIGlzIG5vdCBudWxsICAqLyAgICBhc3NlcnROb3RBcHBsaWVkKCkge31cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogVGhlIFJlbW90ZURvY3VtZW50Q2FjaGUgZm9yIEluZGV4ZWREYi4gVG8gY29uc3RydWN0LCBpbnZva2VcbiAqIGBuZXdJbmRleGVkRGJSZW1vdGVEb2N1bWVudENhY2hlKClgLlxuICovIGNsYXNzIHZvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHQ7XG4gICAgfVxuICAgIHNldEluZGV4TWFuYWdlcih0KSB7XG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQWRkcyB0aGUgc3VwcGxpZWQgZW50cmllcyB0byB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYGFkZEVudHJ5YCBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgIHRvIGVuc3VyZSBwcm9wZXIgYWNjb3VudGluZyBvZiBtZXRhZGF0YS5cbiAgICAgKi8gICAgYWRkRW50cnkodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gU28odCkucHV0KG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGEgZG9jdW1lbnQgZnJvbSB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYHJlbW92ZUVudHJ5YCAgYXJlIHJlcXVpcmVkIHRvIGdvIHRocm91Z2ggdGhlIFJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyXG4gICAgICogcmV0dXJuZWQgYnkgYG5ld0NoYW5nZUJ1ZmZlcigpYCB0byBlbnN1cmUgcHJvcGVyIGFjY291bnRpbmcgb2YgbWV0YWRhdGEuXG4gICAgICovICAgIHJlbW92ZUVudHJ5KHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIFNvKHQpLmRlbGV0ZShcbiAgICAgICAgLyoqXG4gKiBSZXR1cm5zIGEga2V5IHRoYXQgY2FuIGJlIHVzZWQgZm9yIGRvY3VtZW50IGxvb2t1cHMgdmlhIHRoZSBwcmltYXJ5IGtleSBvZlxuICogdGhlIERiUmVtb3RlRG9jdW1lbnQgb2JqZWN0IHN0b3JlLlxuICovXG4gICAgICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0LnBhdGgudG9BcnJheSgpO1xuICAgICAgICAgICAgcmV0dXJuIFsgXG4gICAgICAgICAgICAvKiBwcmVmaXggcGF0aCAqLyBuLnNsaWNlKDAsIG4ubGVuZ3RoIC0gMiksIFxuICAgICAgICAgICAgLyogY29sbGVjdGlvbiBpZCAqLyBuW24ubGVuZ3RoIC0gMl0sIGZyKGUpLCBcbiAgICAgICAgICAgIC8qIGRvY3VtZW50IGlkICovIG5bbi5sZW5ndGggLSAxXSBdO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmV0dXJucyBhIGtleSB0aGF0IGNhbiBiZSB1c2VkIGZvciBkb2N1bWVudCBsb29rdXBzIG9uIHRoZVxuICogYERiUmVtb3RlRG9jdW1lbnREb2N1bWVudENvbGxlY3Rpb25Hcm91cEluZGV4YCBpbmRleC5cbiAqLyAoZSwgbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBjdXJyZW50IGNhY2hlIHNpemUuXG4gICAgICpcbiAgICAgKiBDYWxsZXJzIHRvIGBhZGRFbnRyeSgpYCBhbmQgYHJlbW92ZUVudHJ5KClgICptdXN0KiBjYWxsIHRoaXMgYWZ0ZXJ3YXJkcyB0byB1cGRhdGUgdGhlXG4gICAgICogY2FjaGUncyBtZXRhZGF0YS5cbiAgICAgKi8gICAgdXBkYXRlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRNZXRhZGF0YSh0KS5uZXh0KChuID0+IChuLmJ5dGVTaXplICs9IGUsIHRoaXMuWG4odCwgbikpKSk7XG4gICAgfVxuICAgIGdldEVudHJ5KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBhbi5uZXdJbnZhbGlkRG9jdW1lbnQoZSk7XG4gICAgICAgIHJldHVybiBTbyh0KS5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcImRvY3VtZW50S2V5SW5kZXhcIixcbiAgICAgICAgICAgIHJhbmdlOiBJREJLZXlSYW5nZS5vbmx5KERvKGUpKVxuICAgICAgICB9LCAoKHQsIHMpID0+IHtcbiAgICAgICAgICAgIG4gPSB0aGlzLlpuKGUsIHMpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBMb29rcyB1cCBhbiBlbnRyeSBpbiB0aGUgY2FjaGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRLZXkgLSBUaGUga2V5IG9mIHRoZSBlbnRyeSB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIFRoZSBjYWNoZWQgZG9jdW1lbnQgZW50cnkgYW5kIGl0cyBzaXplLlxuICAgICAqLyAgICB0cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0ge1xuICAgICAgICAgICAgc2l6ZTogMCxcbiAgICAgICAgICAgIGRvY3VtZW50OiBhbi5uZXdJbnZhbGlkRG9jdW1lbnQoZSlcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFNvKHQpLlgoe1xuICAgICAgICAgICAgaW5kZXg6IFwiZG9jdW1lbnRLZXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IElEQktleVJhbmdlLm9ubHkoRG8oZSkpXG4gICAgICAgIH0sICgodCwgcykgPT4ge1xuICAgICAgICAgICAgbiA9IHtcbiAgICAgICAgICAgICAgICBkb2N1bWVudDogdGhpcy5abihlLCBzKSxcbiAgICAgICAgICAgICAgICBzaXplOiBybyhzKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgZ2V0RW50cmllcyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gY3MoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXModCwgZSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gdGhpcy5abih0LCBlKTtcbiAgICAgICAgICAgIG4gPSBuLmluc2VydCh0LCBzKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTG9va3MgdXAgc2V2ZXJhbCBlbnRyaWVzIGluIHRoZSBjYWNoZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudEtleXMgLSBUaGUgc2V0IG9mIGtleXMgZW50cmllcyB0byBsb29rIHVwLlxuICAgICAqIEByZXR1cm5zIEEgbWFwIG9mIGRvY3VtZW50cyBpbmRleGVkIGJ5IGtleSBhbmQgYSBtYXAgb2Ygc2l6ZXMgaW5kZXhlZCBieVxuICAgICAqICAgICBrZXkgKHplcm8gaWYgdGhlIGRvY3VtZW50IGRvZXMgbm90IGV4aXN0KS5cbiAgICAgKi8gICAgbnModCwgZSkge1xuICAgICAgICBsZXQgbiA9IGNzKCksIHMgPSBuZXcgcGUoaHQuY29tcGFyYXRvcik7XG4gICAgICAgIHJldHVybiB0aGlzLmVzKHQsIGUsICgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHRoaXMuWm4odCwgZSk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgaSksIHMgPSBzLmluc2VydCh0LCBybyhlKSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiAoe1xuICAgICAgICAgICAgZG9jdW1lbnRzOiBuLFxuICAgICAgICAgICAgc3M6IHNcbiAgICAgICAgfSkpKTtcbiAgICB9XG4gICAgZXModCwgZSwgbikge1xuICAgICAgICBpZiAoZS5pc0VtcHR5KCkpIHJldHVybiB2dC5yZXNvbHZlKCk7XG4gICAgICAgIGxldCBzID0gbmV3IEVlKHhvKTtcbiAgICAgICAgZS5mb3JFYWNoKCh0ID0+IHMgPSBzLmFkZCh0KSkpO1xuICAgICAgICBjb25zdCBpID0gSURCS2V5UmFuZ2UuYm91bmQoRG8ocy5maXJzdCgpKSwgRG8ocy5sYXN0KCkpKSwgciA9IHMuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgbGV0IG8gPSByLmdldE5leHQoKTtcbiAgICAgICAgcmV0dXJuIFNvKHQpLlgoe1xuICAgICAgICAgICAgaW5kZXg6IFwiZG9jdW1lbnRLZXlJbmRleFwiLFxuICAgICAgICAgICAgcmFuZ2U6IGlcbiAgICAgICAgfSwgKCh0LCBlLCBzKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gaHQuZnJvbVNlZ21lbnRzKFsgLi4uZS5wcmVmaXhQYXRoLCBlLmNvbGxlY3Rpb25Hcm91cCwgZS5kb2N1bWVudElkIF0pO1xuICAgICAgICAgICAgLy8gR28gdGhyb3VnaCBrZXlzIG5vdCBmb3VuZCBpbiBjYWNoZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoO28gJiYgeG8obywgaSkgPCAwOyApIG4obywgbnVsbCksIG8gPSByLmdldE5leHQoKTtcbiAgICAgICAgICAgIG8gJiYgby5pc0VxdWFsKGkpICYmIChcbiAgICAgICAgICAgIC8vIEtleSBmb3VuZCBpbiBjYWNoZS5cbiAgICAgICAgICAgIG4obywgZSksIG8gPSByLmhhc05leHQoKSA/IHIuZ2V0TmV4dCgpIDogbnVsbCksIFxuICAgICAgICAgICAgLy8gU2tpcCB0byB0aGUgbmV4dCBrZXkgKGlmIHRoZXJlIGlzIG9uZSkuXG4gICAgICAgICAgICBvID8gcy5HKERvKG8pKSA6IHMuZG9uZSgpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGhlIHJlc3Qgb2YgdGhlIGtleXMgYXJlIG5vdCBpbiB0aGUgY2FjaGUuIE9uZSBjYXNlIHdoZXJlIGBpdGVyYXRlYFxuICAgICAgICAgICAgLy8gYWJvdmUgd29uJ3QgZ28gdGhyb3VnaCB0aGVtIGlzIHdoZW4gdGhlIGNhY2hlIGlzIGVtcHR5LlxuICAgICAgICAgICAgZm9yICg7bzsgKSBuKG8sIG51bGwpLCBvID0gci5oYXNOZXh0KCkgPyByLmdldE5leHQoKSA6IG51bGw7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBlLnBhdGgsIHIgPSBbIGkucG9wTGFzdCgpLnRvQXJyYXkoKSwgaS5sYXN0U2VnbWVudCgpLCBmcihuLnJlYWRUaW1lKSwgbi5kb2N1bWVudEtleS5wYXRoLmlzRW1wdHkoKSA/IFwiXCIgOiBuLmRvY3VtZW50S2V5LnBhdGgubGFzdFNlZ21lbnQoKSBdLCBvID0gWyBpLnBvcExhc3QoKS50b0FycmF5KCksIGkubGFzdFNlZ21lbnQoKSwgWyBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUiwgTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIgXSwgXCJcIiBdO1xuICAgICAgICByZXR1cm4gU28odCkuaihJREJLZXlSYW5nZS5ib3VuZChyLCBvLCAhMCkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgbGV0IG4gPSBjcygpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5abihodC5mcm9tU2VnbWVudHMoaS5wcmVmaXhQYXRoLmNvbmNhdChpLmNvbGxlY3Rpb25Hcm91cCwgaS5kb2N1bWVudElkKSksIGkpO1xuICAgICAgICAgICAgICAgIHQuaXNGb3VuZERvY3VtZW50KCkgJiYgKG5zKGUsIHQpIHx8IHMuaGFzKHQua2V5KSkgJiYgKFxuICAgICAgICAgICAgICAgIC8vIEVpdGhlciB0aGUgZG9jdW1lbnQgbWF0Y2hlcyB0aGUgZ2l2ZW4gcXVlcnksIG9yIGl0IGlzIG11dGF0ZWQuXG4gICAgICAgICAgICAgICAgbiA9IG4uaW5zZXJ0KHQua2V5LCB0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBnZXRBbGxGcm9tQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgbGV0IGkgPSBjcygpO1xuICAgICAgICBjb25zdCByID0gQ28oZSwgbiksIG8gPSBDbyhlLCBJdC5tYXgoKSk7XG4gICAgICAgIHJldHVybiBTbyh0KS5YKHtcbiAgICAgICAgICAgIGluZGV4OiBcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsXG4gICAgICAgICAgICByYW5nZTogSURCS2V5UmFuZ2UuYm91bmQociwgbywgITApXG4gICAgICAgIH0sICgodCwgZSwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuWm4oaHQuZnJvbVNlZ21lbnRzKGUucHJlZml4UGF0aC5jb25jYXQoZS5jb2xsZWN0aW9uR3JvdXAsIGUuZG9jdW1lbnRJZCkpLCBlKTtcbiAgICAgICAgICAgIGkgPSBpLmluc2VydChyLmtleSwgciksIGkuc2l6ZSA9PT0gcyAmJiBuLmRvbmUoKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKTtcbiAgICB9XG4gICAgbmV3Q2hhbmdlQnVmZmVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBibyh0aGlzLCAhIXQgJiYgdC50cmFja1JlbW92YWxzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldE1ldGFkYXRhKHQpLm5leHQoKHQgPT4gdC5ieXRlU2l6ZSkpO1xuICAgIH1cbiAgICBnZXRNZXRhZGF0YSh0KSB7XG4gICAgICAgIHJldHVybiBWbyh0KS5nZXQoXCJyZW1vdGVEb2N1bWVudEdsb2JhbEtleVwiKS5uZXh0KCh0ID0+IChGKCEhdCksIHQpKSk7XG4gICAgfVxuICAgIFhuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIFZvKHQpLnB1dChcInJlbW90ZURvY3VtZW50R2xvYmFsS2V5XCIsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZWNvZGVzIGBkYlJlbW90ZURvY2AgYW5kIHJldHVybnMgdGhlIGRvY3VtZW50IChvciBhbiBpbnZhbGlkIGRvY3VtZW50IGlmXG4gICAgICogdGhlIGRvY3VtZW50IGNvcnJlc3BvbmRzIHRvIHRoZSBmb3JtYXQgdXNlZCBmb3Igc2VudGluZWwgZGVsZXRlcykuXG4gICAgICovICAgIFpuKHQsIGUpIHtcbiAgICAgICAgaWYgKGUpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBocih0aGlzLnNlcmlhbGl6ZXIsIGUpO1xuICAgICAgICAgICAgLy8gV2hldGhlciB0aGUgZG9jdW1lbnQgaXMgYSBzZW50aW5lbCByZW1vdmFsIGFuZCBzaG91bGQgb25seSBiZSB1c2VkIGluIHRoZVxuICAgICAgICAgICAgLy8gYGdldE5ld0RvY3VtZW50Q2hhbmdlcygpYFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodC5pc05vRG9jdW1lbnQoKSAmJiB0LnZlcnNpb24uaXNFcXVhbChydC5taW4oKSkpKSByZXR1cm4gdDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYW4ubmV3SW52YWxpZERvY3VtZW50KHQpO1xuICAgIH1cbn1cblxuLyoqIENyZWF0ZXMgYSBuZXcgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS4gKi8gZnVuY3Rpb24gUG8odCkge1xuICAgIHJldHVybiBuZXcgdm8odCk7XG59XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgSW5kZXhlZERiUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBVbmxpa2UgdGhlIE1lbW9yeVJlbW90ZURvY3VtZW50Q2hhbmdlQnVmZmVyLCB0aGUgSW5kZXhlZERiIGltcGxlbWVudGF0aW9uIGNvbXB1dGVzIHRoZSBzaXplXG4gKiBkZWx0YSBmb3IgYWxsIHN1Ym1pdHRlZCBjaGFuZ2VzLiBUaGlzIGF2b2lkcyBoYXZpbmcgdG8gcmUtcmVhZCBhbGwgZG9jdW1lbnRzIGZyb20gSW5kZXhlZERiXG4gKiB3aGVuIHdlIGFwcGx5IHRoZSBjaGFuZ2VzLlxuICovIGNsYXNzIGJvIGV4dGVuZHMgUm8ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudENhY2hlIC0gVGhlIEluZGV4ZWREYlJlbW90ZURvY3VtZW50Q2FjaGUgdG8gYXBwbHkgdGhlIGNoYW5nZXMgdG8uXG4gICAgICogQHBhcmFtIHRyYWNrUmVtb3ZhbHMgLSBXaGV0aGVyIHRvIGNyZWF0ZSBzZW50aW5lbCBkZWxldGVzIHRoYXQgY2FuIGJlIHRyYWNrZWQgYnlcbiAgICAgKiBgZ2V0TmV3RG9jdW1lbnRDaGFuZ2VzKClgLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5ycyA9IHQsIHRoaXMudHJhY2tSZW1vdmFscyA9IGUsIFxuICAgICAgICAvLyBBIG1hcCBvZiBkb2N1bWVudCBzaXplcyBhbmQgcmVhZCB0aW1lcyBwcmlvciB0byBhcHBseWluZyB0aGUgY2hhbmdlcyBpblxuICAgICAgICAvLyB0aGlzIGJ1ZmZlci5cbiAgICAgICAgdGhpcy5vcyA9IG5ldyBvcygodCA9PiB0LnRvU3RyaW5nKCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpO1xuICAgIH1cbiAgICBhcHBseUNoYW5nZXModCkge1xuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIGxldCBuID0gMCwgcyA9IG5ldyBFZSgoKHQsIGUpID0+IGV0KHQuY2Fub25pY2FsU3RyaW5nKCksIGUuY2Fub25pY2FsU3RyaW5nKCkpKSk7XG4gICAgICAgIHJldHVybiB0aGlzLmNoYW5nZXMuZm9yRWFjaCgoKGksIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0aGlzLm9zLmdldChpKTtcbiAgICAgICAgICAgIGlmIChlLnB1c2godGhpcy5ycy5yZW1vdmVFbnRyeSh0LCBpLCBvLnJlYWRUaW1lKSksIHIuaXNWYWxpZERvY3VtZW50KCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB1ID0gbHIodGhpcy5ycy5zZXJpYWxpemVyLCByKTtcbiAgICAgICAgICAgICAgICBzID0gcy5hZGQoaS5wYXRoLnBvcExhc3QoKSk7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IHJvKHUpO1xuICAgICAgICAgICAgICAgIG4gKz0gYyAtIG8uc2l6ZSwgZS5wdXNoKHRoaXMucnMuYWRkRW50cnkodCwgaSwgdSkpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChuIC09IG8uc2l6ZSwgdGhpcy50cmFja1JlbW92YWxzKSB7XG4gICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gdHJhY2sgcmVtb3ZhbHMsIHdlIHN0b3JlIGEgXCJzZW50aW5lbCBkZWxldGVcIiBpbiB0aGVcbiAgICAgICAgICAgICAgICAvLyBSZW1vdGVEb2N1bWVudENhY2hlLiBUaGlzIGVudHJ5IGlzIHJlcHJlc2VudGVkIGJ5IGEgTm9Eb2N1bWVudFxuICAgICAgICAgICAgICAgIC8vIHdpdGggYSB2ZXJzaW9uIG9mIDAgYW5kIGlnbm9yZWQgYnkgYG1heWJlRGVjb2RlRG9jdW1lbnQoKWAgYnV0XG4gICAgICAgICAgICAgICAgLy8gcHJlc2VydmVkIGluIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IGxyKHRoaXMucnMuc2VyaWFsaXplciwgci5jb252ZXJ0VG9Ob0RvY3VtZW50KHJ0Lm1pbigpKSk7XG4gICAgICAgICAgICAgICAgZS5wdXNoKHRoaXMucnMuYWRkRW50cnkodCwgaSwgbikpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHMuZm9yRWFjaCgobiA9PiB7XG4gICAgICAgICAgICBlLnB1c2godGhpcy5ycy5pbmRleE1hbmFnZXIuYWRkVG9Db2xsZWN0aW9uUGFyZW50SW5kZXgodCwgbikpO1xuICAgICAgICB9KSksIGUucHVzaCh0aGlzLnJzLnVwZGF0ZU1ldGFkYXRhKHQsIG4pKSwgdnQud2FpdEZvcihlKTtcbiAgICB9XG4gICAgZ2V0RnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZSBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5ycy50cyh0LCBlKS5uZXh0KCh0ID0+ICh0aGlzLm9zLnNldChlLCB7XG4gICAgICAgICAgICBzaXplOiB0LnNpemUsXG4gICAgICAgICAgICByZWFkVGltZTogdC5kb2N1bWVudC5yZWFkVGltZVxuICAgICAgICB9KSwgdC5kb2N1bWVudCkpKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgLy8gUmVjb3JkIHRoZSBzaXplIG9mIGV2ZXJ5dGhpbmcgd2UgbG9hZCBmcm9tIHRoZSBjYWNoZSBzbyB3ZSBjYW4gY29tcHV0ZVxuICAgICAgICAvLyBhIGRlbHRhIGxhdGVyLlxuICAgICAgICByZXR1cm4gdGhpcy5ycy5ucyh0LCBlKS5uZXh0KCgoe2RvY3VtZW50czogdCwgc3M6IGV9KSA9PiAoXG4gICAgICAgIC8vIE5vdGU6IGBnZXRBbGxGcm9tQ2FjaGVgIHJldHVybnMgdHdvIG1hcHMgaW5zdGVhZCBvZiBhIHNpbmdsZSBtYXAgZnJvbVxuICAgICAgICAvLyBrZXlzIHRvIGBEb2N1bWVudFNpemVFbnRyeWBzLiBUaGlzIGlzIHRvIGFsbG93IHJldHVybmluZyB0aGVcbiAgICAgICAgLy8gYE11dGFibGVEb2N1bWVudE1hcGAgZGlyZWN0bHksIHdpdGhvdXQgYSBjb252ZXJzaW9uLlxuICAgICAgICBlLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm9zLnNldChlLCB7XG4gICAgICAgICAgICAgICAgc2l6ZTogbixcbiAgICAgICAgICAgICAgICByZWFkVGltZTogdC5nZXQoZSkucmVhZFRpbWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIHQpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBWbyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwicmVtb3RlRG9jdW1lbnRHbG9iYWxcIik7XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSByZW1vdGVEb2N1bWVudHMgb2JqZWN0IHN0b3JlLlxuICovIGZ1bmN0aW9uIFNvKHQpIHtcbiAgICByZXR1cm4gd2UodCwgXCJyZW1vdGVEb2N1bWVudHNWMTRcIik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIGtleSB0aGF0IGNhbiBiZSB1c2VkIGZvciBkb2N1bWVudCBsb29rdXBzIG9uIHRoZVxuICogYERiUmVtb3RlRG9jdW1lbnREb2N1bWVudEtleUluZGV4YCBpbmRleC5cbiAqLyBmdW5jdGlvbiBEbyh0KSB7XG4gICAgY29uc3QgZSA9IHQucGF0aC50b0FycmF5KCk7XG4gICAgcmV0dXJuIFsgXG4gICAgLyogcHJlZml4IHBhdGggKi8gZS5zbGljZSgwLCBlLmxlbmd0aCAtIDIpLCBcbiAgICAvKiBjb2xsZWN0aW9uIGlkICovIGVbZS5sZW5ndGggLSAyXSwgXG4gICAgLyogZG9jdW1lbnQgaWQgKi8gZVtlLmxlbmd0aCAtIDFdIF07XG59XG5cbmZ1bmN0aW9uIENvKHQsIGUpIHtcbiAgICBjb25zdCBuID0gZS5kb2N1bWVudEtleS5wYXRoLnRvQXJyYXkoKTtcbiAgICByZXR1cm4gWyBcbiAgICAvKiBjb2xsZWN0aW9uIGlkICovIHQsIGZyKGUucmVhZFRpbWUpLCBcbiAgICAvKiBwcmVmaXggcGF0aCAqLyBuLnNsaWNlKDAsIG4ubGVuZ3RoIC0gMiksIFxuICAgIC8qIGRvY3VtZW50IGlkICovIG4ubGVuZ3RoID4gMCA/IG5bbi5sZW5ndGggLSAxXSA6IFwiXCIgXTtcbn1cblxuLyoqXG4gKiBDb21wYXJhdG9yIHRoYXQgY29tcGFyZXMgZG9jdW1lbnQga2V5cyBhY2NvcmRpbmcgdG8gdGhlIHByaW1hcnkga2V5IHNvcnRpbmdcbiAqIHVzZWQgYnkgdGhlIGBEYlJlbW90ZURvY3VtZW50RG9jdW1lbnRgIHN0b3JlIChieSBwcmVmaXggcGF0aCwgY29sbGVjdGlvbiBpZFxuICogYW5kIHRoZW4gZG9jdW1lbnQgSUQpLlxuICpcbiAqIFZpc2libGUgZm9yIHRlc3RpbmcuXG4gKi8gZnVuY3Rpb24geG8odCwgZSkge1xuICAgIGNvbnN0IG4gPSB0LnBhdGgudG9BcnJheSgpLCBzID0gZS5wYXRoLnRvQXJyYXkoKTtcbiAgICAvLyBUaGUgb3JkZXJpbmcgaXMgYmFzZWQgb24gaHR0cHM6Ly9jaHJvbWl1bS5nb29nbGVzb3VyY2UuY29tL2Nocm9taXVtL2JsaW5rLysvZmU1YzIxZmVmOTRkYWU3MWMxYzMzNDQ3NzViOGQ4YTdmN2U2ZDllYy9Tb3VyY2UvbW9kdWxlcy9pbmRleGVkZGIvSURCS2V5LmNwcCM3NFxuICAgIGxldCBpID0gMDtcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IG4ubGVuZ3RoIC0gMiAmJiB0IDwgcy5sZW5ndGggLSAyOyArK3QpIGlmIChpID0gZXQoblt0XSwgc1t0XSksIFxuICAgIGkpIHJldHVybiBpO1xuICAgIHJldHVybiBpID0gZXQobi5sZW5ndGgsIHMubGVuZ3RoKSwgaSB8fCAoaSA9IGV0KG5bbi5sZW5ndGggLSAyXSwgc1tzLmxlbmd0aCAtIDJdKSwgXG4gICAgaSB8fCBldChuW24ubGVuZ3RoIC0gMV0sIHNbcy5sZW5ndGggLSAxXSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTY2hlbWEgVmVyc2lvbiBmb3IgdGhlIFdlYiBjbGllbnQ6XG4gKiAxLiAgSW5pdGlhbCB2ZXJzaW9uIGluY2x1ZGluZyBNdXRhdGlvbiBRdWV1ZSwgUXVlcnkgQ2FjaGUsIGFuZCBSZW1vdGVcbiAqICAgICBEb2N1bWVudCBDYWNoZVxuICogMi4gIFVzZWQgdG8gZW5zdXJlIGEgdGFyZ2V0R2xvYmFsIG9iamVjdCBleGlzdHMgYW5kIGFkZCB0YXJnZXRDb3VudCB0byBpdC4gTm9cbiAqICAgICBsb25nZXIgcmVxdWlyZWQgYmVjYXVzZSBtaWdyYXRpb24gMyB1bmNvbmRpdGlvbmFsbHkgY2xlYXJzIGl0LlxuICogMy4gIERyb3BwZWQgYW5kIHJlLWNyZWF0ZWQgUXVlcnkgQ2FjaGUgdG8gZGVhbCB3aXRoIGNhY2hlIGNvcnJ1cHRpb24gcmVsYXRlZFxuICogICAgIHRvIGxpbWJvIHJlc29sdXRpb24uIEFkZHJlc3Nlc1xuICogICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9maXJlYmFzZS9maXJlYmFzZS1pb3Mtc2RrL2lzc3Vlcy8xNTQ4XG4gKiA0LiAgTXVsdGktVGFiIFN1cHBvcnQuXG4gKiA1LiAgUmVtb3ZhbCBvZiBoZWxkIHdyaXRlIGFja3MuXG4gKiA2LiAgQ3JlYXRlIGRvY3VtZW50IGdsb2JhbCBmb3IgdHJhY2tpbmcgZG9jdW1lbnQgY2FjaGUgc2l6ZS5cbiAqIDcuICBFbnN1cmUgZXZlcnkgY2FjaGVkIGRvY3VtZW50IGhhcyBhIHNlbnRpbmVsIHJvdyB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLlxuICogOC4gIEFkZCBjb2xsZWN0aW9uLXBhcmVudCBpbmRleCBmb3IgQ29sbGVjdGlvbiBHcm91cCBxdWVyaWVzLlxuICogOS4gIENoYW5nZSBSZW1vdGVEb2N1bWVudENoYW5nZXMgc3RvcmUgdG8gYmUga2V5ZWQgYnkgcmVhZFRpbWUgcmF0aGVyIHRoYW5cbiAqICAgICBhbiBhdXRvLWluY3JlbWVudGluZyBJRC4gVGhpcyBpcyByZXF1aXJlZCBmb3IgSW5kZXgtRnJlZSBxdWVyaWVzLlxuICogMTAuIFJld3JpdGUgdGhlIGNhbm9uaWNhbCBJRHMgdG8gdGhlIGV4cGxpY2l0IFByb3RvYnVmLWJhc2VkIGZvcm1hdC5cbiAqIDExLiBBZGQgYnVuZGxlcyBhbmQgbmFtZWRfcXVlcmllcyBmb3IgYnVuZGxlIHN1cHBvcnQuXG4gKiAxMi4gQWRkIGRvY3VtZW50IG92ZXJsYXlzLlxuICogMTMuIFJld3JpdGUgdGhlIGtleXMgb2YgdGhlIHJlbW90ZSBkb2N1bWVudCBjYWNoZSB0byBhbGxvdyBmb3IgZWZmaWNpZW50XG4gKiAgICAgZG9jdW1lbnQgbG9va3VwIHZpYSBgZ2V0QWxsKClgLlxuICogMTQuIEFkZCBvdmVybGF5cy5cbiAqIDE1LiBBZGQgaW5kZXhpbmcgc3VwcG9ydC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhIGxvY2FsIHZpZXcgKG92ZXJsYXkpIG9mIGEgZG9jdW1lbnQsIGFuZCB0aGUgZmllbGRzIHRoYXQgYXJlXG4gKiBsb2NhbGx5IG11dGF0ZWQuXG4gKi9cbmNsYXNzIE5vIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBcbiAgICAvKipcbiAgICAgKiBUaGUgZmllbGRzIHRoYXQgYXJlIGxvY2FsbHkgbXV0YXRlZCBieSBwYXRjaCBtdXRhdGlvbnMuXG4gICAgICpcbiAgICAgKiBJZiB0aGUgb3ZlcmxheWVkXHRkb2N1bWVudCBpcyBmcm9tIHNldCBvciBkZWxldGUgbXV0YXRpb25zLCB0aGlzIGlzIGBudWxsYC5cbiAgICAgKiBJZiB0aGVyZSBpcyBubyBvdmVybGF5IChtdXRhdGlvbikgZm9yIHRoZSBkb2N1bWVudCwgdGhpcyBpcyBhbiBlbXB0eSBgRmllbGRNYXNrYC5cbiAgICAgKi9cbiAgICBlKSB7XG4gICAgICAgIHRoaXMub3ZlcmxheWVkRG9jdW1lbnQgPSB0LCB0aGlzLm11dGF0ZWRGaWVsZHMgPSBlO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSByZWFkb25seSB2aWV3IG9mIHRoZSBsb2NhbCBzdGF0ZSBvZiBhbGwgZG9jdW1lbnRzIHdlJ3JlIHRyYWNraW5nIChpLmUuIHdlXG4gKiBoYXZlIGEgY2FjaGVkIHZlcnNpb24gaW4gcmVtb3RlRG9jdW1lbnRDYWNoZSBvciBsb2NhbCBtdXRhdGlvbnMgZm9yIHRoZVxuICogZG9jdW1lbnQpLiBUaGUgdmlldyBpcyBjb21wdXRlZCBieSBhcHBseWluZyB0aGUgbXV0YXRpb25zIGluIHRoZVxuICogTXV0YXRpb25RdWV1ZSB0byB0aGUgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqLyBjbGFzcyBrbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSB0LCB0aGlzLm11dGF0aW9uUXVldWUgPSBlLCB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlID0gbiwgXG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudCBpZGVudGlmaWVkIGJ5IGBrZXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgTG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnQgb3IgbnVsbCBpZiB3ZSBkb24ndCBoYXZlIGFueSBjYWNoZWRcbiAgICAgKiBzdGF0ZSBmb3IgaXQuXG4gICAgICovICAgIGdldERvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBudWxsO1xuICAgICAgICByZXR1cm4gdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZS5nZXRPdmVybGF5KHQsIGUpLm5leHQoKHMgPT4gKG4gPSBzLCB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cnkodCwgZSkpKSkubmV4dCgodCA9PiAobnVsbCAhPT0gbiAmJiBLcyhuLm11dGF0aW9uLCB0LCB2ZS5lbXB0eSgpLCBpdC5ub3coKSksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBsb2NhbCB2aWV3IG9mIHRoZSBkb2N1bWVudHMgaWRlbnRpZmllZCBieSBga2V5c2AuXG4gICAgICpcbiAgICAgKiBJZiB3ZSBkb24ndCBoYXZlIGNhY2hlZCBzdGF0ZSBmb3IgYSBkb2N1bWVudCBpbiBga2V5c2AsIGEgTm9Eb2N1bWVudCB3aWxsXG4gICAgICogYmUgc3RvcmVkIGZvciB0aGF0IGtleSBpbiB0aGUgcmVzdWx0aW5nIHNldC5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnRzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyaWVzKHQsIGUpLm5leHQoKGUgPT4gdGhpcy5nZXRMb2NhbFZpZXdPZkRvY3VtZW50cyh0LCBlLCBncygpKS5uZXh0KCgoKSA9PiBlKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2ltaWxhciB0byBgZ2V0RG9jdW1lbnRzYCwgYnV0IGNyZWF0ZXMgdGhlIGxvY2FsIHZpZXcgZnJvbSB0aGUgZ2l2ZW5cbiAgICAgKiBgYmFzZURvY3NgIHdpdGhvdXQgcmV0cmlldmluZyBkb2N1bWVudHMgZnJvbSB0aGUgbG9jYWwgc3RvcmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgdHJhbnNhY3Rpb24gdGhpcyBvcGVyYXRpb24gaXMgc2NvcGVkIHRvLlxuICAgICAqIEBwYXJhbSBkb2NzIC0gVGhlIGRvY3VtZW50cyB0byBhcHBseSBsb2NhbCBtdXRhdGlvbnMgdG8gZ2V0IHRoZSBsb2NhbCB2aWV3cy5cbiAgICAgKiBAcGFyYW0gZXhpc3RlbmNlU3RhdGVDaGFuZ2VkIC0gVGhlIHNldCBvZiBkb2N1bWVudCBrZXlzIHdob3NlIGV4aXN0ZW5jZSBzdGF0ZVxuICAgICAqICAgaXMgY2hhbmdlZC4gVGhpcyBpcyB1c2VmdWwgdG8gZGV0ZXJtaW5lIGlmIHNvbWUgZG9jdW1lbnRzIG92ZXJsYXkgbmVlZHNcbiAgICAgKiAgIHRvIGJlIHJlY2FsY3VsYXRlZC5cbiAgICAgKi8gICAgZ2V0TG9jYWxWaWV3T2ZEb2N1bWVudHModCwgZSwgbiA9IGdzKCkpIHtcbiAgICAgICAgY29uc3QgcyA9IGZzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnBvcHVsYXRlT3ZlcmxheXModCwgcywgZSkubmV4dCgoKCkgPT4gdGhpcy5jb21wdXRlVmlld3ModCwgZSwgcywgbikubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBsZXQgZSA9IGhzKCk7XG4gICAgICAgICAgICByZXR1cm4gdC5mb3JFYWNoKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGUgPSBlLmluc2VydCh0LCBuLm92ZXJsYXllZERvY3VtZW50KTtcbiAgICAgICAgICAgIH0pKSwgZTtcbiAgICAgICAgfSkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEdldHMgdGhlIG92ZXJsYXllZCBkb2N1bWVudHMgZm9yIHRoZSBnaXZlbiBkb2N1bWVudCBtYXAsIHdoaWNoIHdpbGwgaW5jbHVkZVxuICAgICAqIHRoZSBsb2NhbCB2aWV3IG9mIHRob3NlIGRvY3VtZW50cyBhbmQgYSBgRmllbGRNYXNrYCBpbmRpY2F0aW5nIHdoaWNoIGZpZWxkc1xuICAgICAqIGFyZSBtdXRhdGVkIGxvY2FsbHksIGBudWxsYCBpZiBvdmVybGF5IGlzIGEgU2V0IG9yIERlbGV0ZSBtdXRhdGlvbi5cbiAgICAgKi8gICAgZ2V0T3ZlcmxheWVkRG9jdW1lbnRzKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGZzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnBvcHVsYXRlT3ZlcmxheXModCwgbiwgZSkubmV4dCgoKCkgPT4gdGhpcy5jb21wdXRlVmlld3ModCwgZSwgbiwgZ3MoKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRmV0Y2hlcyB0aGUgb3ZlcmxheXMgZm9yIHtAY29kZSBkb2NzfSBhbmQgYWRkcyB0aGVtIHRvIHByb3ZpZGVkIG92ZXJsYXkgbWFwXG4gICAgICogaWYgdGhlIG1hcCBkb2VzIG5vdCBhbHJlYWR5IGNvbnRhaW4gYW4gZW50cnkgZm9yIHRoZSBnaXZlbiBkb2N1bWVudCBrZXkuXG4gICAgICovICAgIHBvcHVsYXRlT3ZlcmxheXModCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gW107XG4gICAgICAgIHJldHVybiBuLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgZS5oYXModCkgfHwgcy5wdXNoKHQpO1xuICAgICAgICB9KSksIHRoaXMuZG9jdW1lbnRPdmVybGF5Q2FjaGUuZ2V0T3ZlcmxheXModCwgcykubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0LmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZS5zZXQodCwgbik7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ29tcHV0ZXMgdGhlIGxvY2FsIHZpZXcgZm9yIHRoZSBnaXZlbiBkb2N1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jcyAtIFRoZSBkb2N1bWVudHMgdG8gY29tcHV0ZSB2aWV3cyBmb3IuIEl0IGFsc28gaGFzIHRoZSBiYXNlXG4gICAgICogICB2ZXJzaW9uIG9mIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIG92ZXJsYXlzIC0gVGhlIG92ZXJsYXlzIHRoYXQgbmVlZCB0byBiZSBhcHBsaWVkIHRvIHRoZSBnaXZlbiBiYXNlXG4gICAgICogICB2ZXJzaW9uIG9mIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIGV4aXN0ZW5jZVN0YXRlQ2hhbmdlZCAtIEEgc2V0IG9mIGRvY3VtZW50cyB3aG9zZSBleGlzdGVuY2Ugc3RhdGVzXG4gICAgICogICBtaWdodCBoYXZlIGNoYW5nZWQuIFRoaXMgaXMgdXNlZCB0byBkZXRlcm1pbmUgaWYgd2UgbmVlZCB0byByZS1jYWxjdWxhdGVcbiAgICAgKiAgIG92ZXJsYXlzIGZyb20gbXV0YXRpb24gcXVldWVzLlxuICAgICAqIEByZXR1cm4gQSBtYXAgcmVwcmVzZW50cyB0aGUgbG9jYWwgZG9jdW1lbnRzIHZpZXcuXG4gICAgICovICAgIGNvbXB1dGVWaWV3cyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGxldCBpID0gY3MoKTtcbiAgICAgICAgY29uc3QgciA9IF9zKCksIG8gPSBfcygpO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCgodCwgZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbyA9IG4uZ2V0KGUua2V5KTtcbiAgICAgICAgICAgIC8vIFJlY2FsY3VsYXRlIGFuIG92ZXJsYXkgaWYgdGhlIGRvY3VtZW50J3MgZXhpc3RlbmNlIHN0YXRlIGNoYW5nZWQgZHVlIHRvXG4gICAgICAgICAgICAvLyBhIHJlbW90ZSBldmVudCAqYW5kKiB0aGUgb3ZlcmxheSBpcyBhIFBhdGNoTXV0YXRpb24uIFRoaXMgaXMgYmVjYXVzZVxuICAgICAgICAgICAgLy8gZG9jdW1lbnQgZXhpc3RlbmNlIHN0YXRlIGNhbiBjaGFuZ2UgaWYgc29tZSBwYXRjaCBtdXRhdGlvbidzXG4gICAgICAgICAgICAvLyBwcmVjb25kaXRpb25zIGFyZSBtZXQuXG4gICAgICAgICAgICAvLyBOT1RFOiB3ZSByZWNhbGN1bGF0ZSB3aGVuIGBvdmVybGF5YCBpcyB1bmRlZmluZWQgYXMgd2VsbCwgYmVjYXVzZSB0aGVyZVxuICAgICAgICAgICAgLy8gbWlnaHQgYmUgYSBwYXRjaCBtdXRhdGlvbiB3aG9zZSBwcmVjb25kaXRpb24gZG9lcyBub3QgbWF0Y2ggYmVmb3JlIHRoZVxuICAgICAgICAgICAgLy8gY2hhbmdlIChoZW5jZSBvdmVybGF5IGlzIHVuZGVmaW5lZCksIGJ1dCB3b3VsZCBub3cgbWF0Y2guXG4gICAgICAgICAgICAgICAgICAgICAgICBzLmhhcyhlLmtleSkgJiYgKHZvaWQgMCA9PT0gbyB8fCBvLm11dGF0aW9uIGluc3RhbmNlb2YgenMpID8gaSA9IGkuaW5zZXJ0KGUua2V5LCBlKSA6IHZvaWQgMCAhPT0gbyA/IChyLnNldChlLmtleSwgby5tdXRhdGlvbi5nZXRGaWVsZE1hc2soKSksIFxuICAgICAgICAgICAgS3Moby5tdXRhdGlvbiwgZSwgby5tdXRhdGlvbi5nZXRGaWVsZE1hc2soKSwgaXQubm93KCkpKSA6IFxuICAgICAgICAgICAgLy8gbm8gb3ZlcmxheSBleGlzdHNcbiAgICAgICAgICAgIC8vIFVzaW5nIEVNUFRZIHRvIGluZGljYXRlIHRoZXJlIGlzIG5vIG92ZXJsYXkgZm9yIHRoZSBkb2N1bWVudC5cbiAgICAgICAgICAgIHIuc2V0KGUua2V5LCB2ZS5lbXB0eSgpKTtcbiAgICAgICAgfSkpLCB0aGlzLnJlY2FsY3VsYXRlQW5kU2F2ZU92ZXJsYXlzKHQsIGkpLm5leHQoKHQgPT4gKHQuZm9yRWFjaCgoKHQsIGUpID0+IHIuc2V0KHQsIGUpKSksIFxuICAgICAgICBlLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICB2YXIgbjtcbiAgICAgICAgICAgIHJldHVybiBvLnNldCh0LCBuZXcgTm8oZSwgbnVsbCAhPT0gKG4gPSByLmdldCh0KSkgJiYgdm9pZCAwICE9PSBuID8gbiA6IG51bGwpKTtcbiAgICAgICAgfSkpLCBvKSkpO1xuICAgIH1cbiAgICByZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5cyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBfcygpO1xuICAgICAgICAvLyBBIHJldmVyc2UgbG9va3VwIG1hcCBmcm9tIGJhdGNoIGlkIHRvIHRoZSBkb2N1bWVudHMgd2l0aGluIHRoYXQgYmF0Y2guXG4gICAgICAgICAgICAgICAgbGV0IHMgPSBuZXcgcGUoKCh0LCBlKSA9PiB0IC0gZSkpLCBpID0gZ3MoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZS5nZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGkgb2YgdCkgaS5rZXlzKCkuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGUuZ2V0KHQpO1xuICAgICAgICAgICAgICAgIGlmIChudWxsID09PSByKSByZXR1cm47XG4gICAgICAgICAgICAgICAgbGV0IG8gPSBuLmdldCh0KSB8fCB2ZS5lbXB0eSgpO1xuICAgICAgICAgICAgICAgIG8gPSBpLmFwcGx5VG9Mb2NhbFZpZXcociwgbyksIG4uc2V0KHQsIG8pO1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSAocy5nZXQoaS5iYXRjaElkKSB8fCBncygpKS5hZGQodCk7XG4gICAgICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KGkuYmF0Y2hJZCwgdSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gW10sIG8gPSBzLmdldFJldmVyc2VJdGVyYXRvcigpO1xuICAgICAgICAgICAgLy8gSXRlcmF0ZSBpbiBkZXNjZW5kaW5nIG9yZGVyIG9mIGJhdGNoIElEcywgYW5kIHNraXAgZG9jdW1lbnRzIHRoYXQgYXJlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IHNhdmVkLlxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yICg7by5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBvLmdldE5leHQoKSwgdSA9IHMua2V5LCBjID0gcy52YWx1ZSwgYSA9IGRzKCk7XG4gICAgICAgICAgICAgICAgYy5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpLmhhcyh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IHFzKGUuZ2V0KHQpLCBuLmdldCh0KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsICE9PSBzICYmIGEuc2V0KHQsIHMpLCBpID0gaS5hZGQodCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KSksIHIucHVzaCh0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLnNhdmVPdmVybGF5cyh0LCB1LCBhKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdnQud2FpdEZvcihyKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjYWxjdWxhdGVzIG92ZXJsYXlzIGJ5IHJlYWRpbmcgdGhlIGRvY3VtZW50cyBmcm9tIHJlbW90ZSBkb2N1bWVudCBjYWNoZVxuICAgICAqIGZpcnN0LCBhbmQgc2F2ZXMgdGhlbSBhZnRlciB0aGV5IGFyZSBjYWxjdWxhdGVkLlxuICAgICAqLyAgICByZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUuZ2V0RW50cmllcyh0LCBlKS5uZXh0KChlID0+IHRoaXMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXModCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGVyZm9ybXMgYSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCB2aWV3IG9mIGFsbCBkb2N1bWVudHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gdHJhbnNhY3Rpb24gLSBUaGUgcGVyc2lzdGVuY2UgdHJhbnNhY3Rpb24uXG4gICAgICogQHBhcmFtIHF1ZXJ5IC0gVGhlIHF1ZXJ5IHRvIG1hdGNoIGRvY3VtZW50cyBhZ2FpbnN0LlxuICAgICAqIEBwYXJhbSBvZmZzZXQgLSBSZWFkIHRpbWUgYW5kIGtleSB0byBzdGFydCBzY2FubmluZyBieSAoZXhjbHVzaXZlKS5cbiAgICAgKi8gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuKSB7XG4gICAgICAgIC8qKlxuICogUmV0dXJucyB3aGV0aGVyIHRoZSBxdWVyeSBtYXRjaGVzIGEgc2luZ2xlIGRvY3VtZW50IGJ5IHBhdGggKHJhdGhlciB0aGFuIGFcbiAqIGNvbGxlY3Rpb24pLlxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gaHQuaXNEb2N1bWVudEtleSh0LnBhdGgpICYmIG51bGwgPT09IHQuY29sbGVjdGlvbkdyb3VwICYmIDAgPT09IHQuZmlsdGVycy5sZW5ndGg7XG4gICAgICAgIH0oZSkgPyB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nRG9jdW1lbnRRdWVyeSh0LCBlLnBhdGgpIDogV24oZSkgPyB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvbkdyb3VwUXVlcnkodCwgZSwgbikgOiB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KHQsIGUsIG4pO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhIGNvbGxlY3Rpb24gZ3JvdXAsIHJldHVybnMgdGhlIG5leHQgZG9jdW1lbnRzIHRoYXQgZm9sbG93IHRoZSBwcm92aWRlZCBvZmZzZXQsIGFsb25nXG4gICAgICogd2l0aCBhbiB1cGRhdGVkIGJhdGNoIElELlxuICAgICAqXG4gICAgICogPHA+VGhlIGRvY3VtZW50cyByZXR1cm5lZCBieSB0aGlzIG1ldGhvZCBhcmUgb3JkZXJlZCBieSByZW1vdGUgdmVyc2lvbiBmcm9tIHRoZSBwcm92aWRlZFxuICAgICAqIG9mZnNldC4gSWYgdGhlcmUgYXJlIG5vIG1vcmUgcmVtb3RlIGRvY3VtZW50cyBhZnRlciB0aGUgcHJvdmlkZWQgb2Zmc2V0LCBkb2N1bWVudHMgd2l0aFxuICAgICAqIG11dGF0aW9ucyBpbiBvcmRlciBvZiBiYXRjaCBpZCBmcm9tIHRoZSBvZmZzZXQgYXJlIHJldHVybmVkLiBTaW5jZSBhbGwgZG9jdW1lbnRzIGluIGEgYmF0Y2ggYXJlXG4gICAgICogcmV0dXJuZWQgdG9nZXRoZXIsIHRoZSB0b3RhbCBudW1iZXIgb2YgZG9jdW1lbnRzIHJldHVybmVkIGNhbiBleGNlZWQge0Bjb2RlIGNvdW50fS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB0cmFuc2FjdGlvblxuICAgICAqIEBwYXJhbSBjb2xsZWN0aW9uR3JvdXAgVGhlIGNvbGxlY3Rpb24gZ3JvdXAgZm9yIHRoZSBkb2N1bWVudHMuXG4gICAgICogQHBhcmFtIG9mZnNldCBUaGUgb2Zmc2V0IHRvIGluZGV4IGludG8uXG4gICAgICogQHBhcmFtIGNvdW50IFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIHRvIHJldHVyblxuICAgICAqIEByZXR1cm4gQSBMb2NhbFdyaXRlUmVzdWx0IHdpdGggdGhlIGRvY3VtZW50cyB0aGF0IGZvbGxvdyB0aGUgcHJvdmlkZWQgb2Zmc2V0IGFuZCB0aGUgbGFzdCBwcm9jZXNzZWQgYmF0Y2ggaWQuXG4gICAgICovICAgIGdldE5leHREb2N1bWVudHModCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgbiwgcykubmV4dCgoaSA9PiB7XG4gICAgICAgICAgICBjb25zdCByID0gcyAtIGkuc2l6ZSA+IDAgPyB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLmdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbkdyb3VwKHQsIGUsIG4ubGFyZ2VzdEJhdGNoSWQsIHMgLSBpLnNpemUpIDogdnQucmVzb2x2ZShmcygpKTtcbiAgICAgICAgICAgIC8vIFRoZSBjYWxsc2l0ZSB3aWxsIHVzZSB0aGUgbGFyZ2VzdCBiYXRjaCBJRCB0b2dldGhlciB3aXRoIHRoZSBsYXRlc3QgcmVhZCB0aW1lIHRvIGNyZWF0ZVxuICAgICAgICAgICAgLy8gYSBuZXcgaW5kZXggb2Zmc2V0LiBTaW5jZSB3ZSBvbmx5IHByb2Nlc3MgYmF0Y2ggSURzIGlmIGFsbCByZW1vdGUgZG9jdW1lbnRzIGhhdmUgYmVlbiByZWFkLFxuICAgICAgICAgICAgLy8gbm8gb3ZlcmxheSB3aWxsIGluY3JlYXNlIHRoZSBvdmVyYWxsIHJlYWQgdGltZS4gVGhpcyBpcyB3aHkgd2Ugb25seSBuZWVkIHRvIHNwZWNpYWwgY2FzZVxuICAgICAgICAgICAgLy8gdGhlIGJhdGNoIGlkLlxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG8gPSAtMSwgdSA9IGk7XG4gICAgICAgICAgICByZXR1cm4gci5uZXh0KChlID0+IHZ0LmZvckVhY2goZSwgKChlLCBuKSA9PiAobyA8IG4ubGFyZ2VzdEJhdGNoSWQgJiYgKG8gPSBuLmxhcmdlc3RCYXRjaElkKSwgXG4gICAgICAgICAgICBpLmdldChlKSA/IHZ0LnJlc29sdmUoKSA6IHRoaXMucmVtb3RlRG9jdW1lbnRDYWNoZS5nZXRFbnRyeSh0LCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB1ID0gdS5pbnNlcnQoZSwgdCk7XG4gICAgICAgICAgICB9KSkpKSkubmV4dCgoKCkgPT4gdGhpcy5wb3B1bGF0ZU92ZXJsYXlzKHQsIGUsIGkpKSkubmV4dCgoKCkgPT4gdGhpcy5jb21wdXRlVmlld3ModCwgdSwgZSwgZ3MoKSkpKS5uZXh0KCh0ID0+ICh7XG4gICAgICAgICAgICAgICAgYmF0Y2hJZDogbyxcbiAgICAgICAgICAgICAgICBjaGFuZ2VzOiBscyh0KVxuICAgICAgICAgICAgfSkpKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nRG9jdW1lbnRRdWVyeSh0LCBlKSB7XG4gICAgICAgIC8vIEp1c3QgZG8gYSBzaW1wbGUgZG9jdW1lbnQgbG9va3VwLlxuICAgICAgICByZXR1cm4gdGhpcy5nZXREb2N1bWVudCh0LCBuZXcgaHQoZSkpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgbGV0IGUgPSBocygpO1xuICAgICAgICAgICAgcmV0dXJuIHQuaXNGb3VuZERvY3VtZW50KCkgJiYgKGUgPSBlLmluc2VydCh0LmtleSwgdCkpLCBlO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIGdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvbkdyb3VwUXVlcnkodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gZS5jb2xsZWN0aW9uR3JvdXA7XG4gICAgICAgIGxldCBpID0gaHMoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhNYW5hZ2VyLmdldENvbGxlY3Rpb25QYXJlbnRzKHQsIHMpLm5leHQoKHIgPT4gdnQuZm9yRWFjaChyLCAociA9PiB7XG4gICAgICAgICAgICBjb25zdCBvID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgVW4oZSwgXG4gICAgICAgICAgICAgICAgLypjb2xsZWN0aW9uR3JvdXA9Ki8gbnVsbCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xuICAgICAgICAgICAgfShlLCByLmNoaWxkKHMpKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERvY3VtZW50c01hdGNoaW5nQ29sbGVjdGlvblF1ZXJ5KHQsIG8sIG4pLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgICAgIHQuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaSA9IGkuaW5zZXJ0KHQsIGUpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IGkpKSkpO1xuICAgIH1cbiAgICBnZXREb2N1bWVudHNNYXRjaGluZ0NvbGxlY3Rpb25RdWVyeSh0LCBlLCBuKSB7XG4gICAgICAgIC8vIFF1ZXJ5IHRoZSByZW1vdGUgZG9jdW1lbnRzIGFuZCBvdmVybGF5IG11dGF0aW9ucy5cbiAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3VtZW50T3ZlcmxheUNhY2hlLmdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbih0LCBlLnBhdGgsIG4ubGFyZ2VzdEJhdGNoSWQpLm5leHQoKGkgPT4gKHMgPSBpLCBcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodCwgZSwgbiwgcykpKSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAvLyBBcyBkb2N1bWVudHMgbWlnaHQgbWF0Y2ggdGhlIHF1ZXJ5IGJlY2F1c2Ugb2YgdGhlaXIgb3ZlcmxheSB3ZSBuZWVkIHRvXG4gICAgICAgICAgICAvLyBpbmNsdWRlIGRvY3VtZW50cyBmb3IgYWxsIG92ZXJsYXlzIGluIHRoZSBpbml0aWFsIGRvY3VtZW50IHNldC5cbiAgICAgICAgICAgIHMuZm9yRWFjaCgoKGUsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gbi5nZXRLZXkoKTtcbiAgICAgICAgICAgICAgICBudWxsID09PSB0LmdldChzKSAmJiAodCA9IHQuaW5zZXJ0KHMsIGFuLm5ld0ludmFsaWREb2N1bWVudChzKSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgLy8gQXBwbHkgdGhlIG92ZXJsYXlzIGFuZCBtYXRjaCBhZ2FpbnN0IHRoZSBxdWVyeS5cbiAgICAgICAgICAgIGxldCBuID0gaHMoKTtcbiAgICAgICAgICAgIHJldHVybiB0LmZvckVhY2goKCh0LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgciA9IHMuZ2V0KHQpO1xuICAgICAgICAgICAgICAgIHZvaWQgMCAhPT0gciAmJiBLcyhyLm11dGF0aW9uLCBpLCB2ZS5lbXB0eSgpLCBpdC5ub3coKSksIFxuICAgICAgICAgICAgICAgIC8vIEZpbmFsbHksIGluc2VydCB0aGUgZG9jdW1lbnRzIHRoYXQgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5XG4gICAgICAgICAgICAgICAgbnMoZSwgaSkgJiYgKG4gPSBuLmluc2VydCh0LCBpKSk7XG4gICAgICAgICAgICB9KSksIG47XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIE1vIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuc2VyaWFsaXplciA9IHQsIHRoaXMudXMgPSBuZXcgTWFwLCB0aGlzLmNzID0gbmV3IE1hcDtcbiAgICB9XG4gICAgZ2V0QnVuZGxlTWV0YWRhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSh0aGlzLnVzLmdldChlKSk7XG4gICAgfVxuICAgIHNhdmVCdW5kbGVNZXRhZGF0YSh0LCBlKSB7XG4gICAgICAgIC8qKiBEZWNvZGVzIGEgQnVuZGxlTWV0YWRhdGEgcHJvdG8gaW50byBhIEJ1bmRsZU1ldGFkYXRhIG9iamVjdC4gKi9cbiAgICAgICAgdmFyIG47XG4gICAgICAgIHJldHVybiB0aGlzLnVzLnNldChlLmlkLCB7XG4gICAgICAgICAgICBpZDogKG4gPSBlKS5pZCxcbiAgICAgICAgICAgIHZlcnNpb246IG4udmVyc2lvbixcbiAgICAgICAgICAgIGNyZWF0ZVRpbWU6IE5pKG4uY3JlYXRlVGltZSlcbiAgICAgICAgfSksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0TmFtZWRRdWVyeSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHRoaXMuY3MuZ2V0KGUpKTtcbiAgICB9XG4gICAgc2F2ZU5hbWVkUXVlcnkodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jcy5zZXQoZS5uYW1lLCBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICAgICAgICBxdWVyeTogeXIodC5idW5kbGVkUXVlcnkpLFxuICAgICAgICAgICAgICAgIHJlYWRUaW1lOiBOaSh0LnJlYWRUaW1lKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfShlKSksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIyIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGluLW1lbW9yeSBpbXBsZW1lbnRhdGlvbiBvZiBEb2N1bWVudE92ZXJsYXlDYWNoZS5cbiAqLyBjbGFzcyBPbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIEEgbWFwIHNvcnRlZCBieSBEb2N1bWVudEtleSwgd2hvc2UgdmFsdWUgaXMgYSBwYWlyIG9mIHRoZSBsYXJnZXN0IGJhdGNoIGlkXG4gICAgICAgIC8vIGZvciB0aGUgb3ZlcmxheSBhbmQgdGhlIG92ZXJsYXkgaXRzZWxmLlxuICAgICAgICB0aGlzLm92ZXJsYXlzID0gbmV3IHBlKGh0LmNvbXBhcmF0b3IpLCB0aGlzLmhzID0gbmV3IE1hcDtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHRoaXMub3ZlcmxheXMuZ2V0KGUpKTtcbiAgICB9XG4gICAgZ2V0T3ZlcmxheXModCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZnMoKTtcbiAgICAgICAgcmV0dXJuIHZ0LmZvckVhY2goZSwgKGUgPT4gdGhpcy5nZXRPdmVybGF5KHQsIGUpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgbnVsbCAhPT0gdCAmJiBuLnNldChlLCB0KTtcbiAgICAgICAgfSkpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBzYXZlT3ZlcmxheXModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbi5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgdGhpcy5kZSh0LCBlLCBzKTtcbiAgICAgICAgfSkpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLmhzLmdldChuKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgMCAhPT0gcyAmJiAocy5mb3JFYWNoKCh0ID0+IHRoaXMub3ZlcmxheXMgPSB0aGlzLm92ZXJsYXlzLnJlbW92ZSh0KSkpLCBcbiAgICAgICAgdGhpcy5ocy5kZWxldGUobikpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldE92ZXJsYXlzRm9yQ29sbGVjdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBmcygpLCBpID0gZS5sZW5ndGggKyAxLCByID0gbmV3IGh0KGUuY2hpbGQoXCJcIikpLCBvID0gdGhpcy5vdmVybGF5cy5nZXRJdGVyYXRvckZyb20ocik7XG4gICAgICAgIGZvciAoO28uaGFzTmV4dCgpOyApIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBvLmdldE5leHQoKS52YWx1ZSwgciA9IHQuZ2V0S2V5KCk7XG4gICAgICAgICAgICBpZiAoIWUuaXNQcmVmaXhPZihyLnBhdGgpKSBicmVhaztcbiAgICAgICAgICAgIC8vIERvY3VtZW50cyBmcm9tIHN1Yi1jb2xsZWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgci5wYXRoLmxlbmd0aCA9PT0gaSAmJiAodC5sYXJnZXN0QmF0Y2hJZCA+IG4gJiYgcy5zZXQodC5nZXRLZXkoKSwgdCkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHMpO1xuICAgIH1cbiAgICBnZXRPdmVybGF5c0ZvckNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGxldCBpID0gbmV3IHBlKCgodCwgZSkgPT4gdCAtIGUpKTtcbiAgICAgICAgY29uc3QgciA9IHRoaXMub3ZlcmxheXMuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ci5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IHIuZ2V0TmV4dCgpLnZhbHVlO1xuICAgICAgICAgICAgaWYgKHQuZ2V0S2V5KCkuZ2V0Q29sbGVjdGlvbkdyb3VwKCkgPT09IGUgJiYgdC5sYXJnZXN0QmF0Y2hJZCA+IG4pIHtcbiAgICAgICAgICAgICAgICBsZXQgZSA9IGkuZ2V0KHQubGFyZ2VzdEJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIG51bGwgPT09IGUgJiYgKGUgPSBmcygpLCBpID0gaS5pbnNlcnQodC5sYXJnZXN0QmF0Y2hJZCwgZSkpLCBlLnNldCh0LmdldEtleSgpLCB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCBvID0gZnMoKSwgdSA9IGkuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7dS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgaWYgKHUuZ2V0TmV4dCgpLnZhbHVlLmZvckVhY2goKCh0LCBlKSA9PiBvLnNldCh0LCBlKSkpLCBvLnNpemUoKSA+PSBzKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZShvKTtcbiAgICB9XG4gICAgZGUodCwgZSwgbikge1xuICAgICAgICAvLyBSZW1vdmUgdGhlIGFzc29jaWF0aW9uIG9mIHRoZSBvdmVybGF5IHRvIGl0cyBiYXRjaCBpZC5cbiAgICAgICAgY29uc3QgcyA9IHRoaXMub3ZlcmxheXMuZ2V0KG4ua2V5KTtcbiAgICAgICAgaWYgKG51bGwgIT09IHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmhzLmdldChzLmxhcmdlc3RCYXRjaElkKS5kZWxldGUobi5rZXkpO1xuICAgICAgICAgICAgdGhpcy5ocy5zZXQocy5sYXJnZXN0QmF0Y2hJZCwgdCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5vdmVybGF5cyA9IHRoaXMub3ZlcmxheXMuaW5zZXJ0KG4ua2V5LCBuZXcgZWkoZSwgbikpO1xuICAgICAgICAvLyBDcmVhdGUgdGhlIGFzc29jaWF0aW9uIG9mIHRoaXMgb3ZlcmxheSB0byB0aGUgZ2l2ZW4gbGFyZ2VzdEJhdGNoSWQuXG4gICAgICAgIGxldCBpID0gdGhpcy5ocy5nZXQoZSk7XG4gICAgICAgIHZvaWQgMCA9PT0gaSAmJiAoaSA9IGdzKCksIHRoaXMuaHMuc2V0KGUsIGkpKSwgdGhpcy5ocy5zZXQoZSwgaS5hZGQobi5rZXkpKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgY29sbGVjdGlvbiBvZiByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgZnJvbSBzb21lIGtpbmQgb2YgbnVtYmVyZWQgZW50aXR5XG4gKiAoZWl0aGVyIGEgdGFyZ2V0IElEIG9yIGJhdGNoIElEKS4gQXMgcmVmZXJlbmNlcyBhcmUgYWRkZWQgdG8gb3IgcmVtb3ZlZCBmcm9tXG4gKiB0aGUgc2V0IGNvcnJlc3BvbmRpbmcgZXZlbnRzIGFyZSBlbWl0dGVkIHRvIGEgcmVnaXN0ZXJlZCBnYXJiYWdlIGNvbGxlY3Rvci5cbiAqXG4gKiBFYWNoIHJlZmVyZW5jZSBpcyByZXByZXNlbnRlZCBieSBhIERvY3VtZW50UmVmZXJlbmNlIG9iamVjdC4gRWFjaCBvZiB0aGVtXG4gKiBjb250YWlucyBlbm91Z2ggaW5mb3JtYXRpb24gdG8gdW5pcXVlbHkgaWRlbnRpZnkgdGhlIHJlZmVyZW5jZS4gVGhleSBhcmUgYWxsXG4gKiBzdG9yZWQgcHJpbWFyaWx5IGluIGEgc2V0IHNvcnRlZCBieSBrZXkuIEEgZG9jdW1lbnQgaXMgY29uc2lkZXJlZCBnYXJiYWdlIGlmXG4gKiB0aGVyZSdzIG5vIHJlZmVyZW5jZXMgaW4gdGhhdCBzZXQgKHRoaXMgY2FuIGJlIGVmZmljaWVudGx5IGNoZWNrZWQgdGhhbmtzIHRvXG4gKiBzb3J0aW5nIGJ5IGtleSkuXG4gKlxuICogUmVmZXJlbmNlU2V0IGFsc28ga2VlcHMgYSBzZWNvbmRhcnkgc2V0IHRoYXQgY29udGFpbnMgcmVmZXJlbmNlcyBzb3J0ZWQgYnlcbiAqIElEcy4gVGhpcyBvbmUgaXMgdXNlZCB0byBlZmZpY2llbnRseSBpbXBsZW1lbnQgcmVtb3ZhbCBvZiBhbGwgcmVmZXJlbmNlcyBieVxuICogc29tZSB0YXJnZXQgSUQuXG4gKi8gY2xhc3MgJG8ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IGtleS5cbiAgICAgICAgdGhpcy5scyA9IG5ldyBFZShGby5mcyksIFxuICAgICAgICAvLyBBIHNldCBvZiBvdXRzdGFuZGluZyByZWZlcmVuY2VzIHRvIGEgZG9jdW1lbnQgc29ydGVkIGJ5IHRhcmdldCBpZC5cbiAgICAgICAgdGhpcy5kcyA9IG5ldyBFZShGby5fcyk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIHRydWUgaWYgdGhlIHJlZmVyZW5jZSBzZXQgY29udGFpbnMgbm8gcmVmZXJlbmNlcy4gKi8gICAgaXNFbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubHMuaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKiogQWRkcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW4gSUQuICovICAgIGFkZFJlZmVyZW5jZSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgRm8odCwgZSk7XG4gICAgICAgIHRoaXMubHMgPSB0aGlzLmxzLmFkZChuKSwgdGhpcy5kcyA9IHRoaXMuZHMuYWRkKG4pO1xuICAgIH1cbiAgICAvKiogQWRkIHJlZmVyZW5jZXMgdG8gdGhlIGdpdmVuIGRvY3VtZW50IGtleXMgZm9yIHRoZSBnaXZlbiBJRC4gKi8gICAgd3ModCwgZSkge1xuICAgICAgICB0LmZvckVhY2goKHQgPT4gdGhpcy5hZGRSZWZlcmVuY2UodCwgZSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVtb3ZlcyBhIHJlZmVyZW5jZSB0byB0aGUgZ2l2ZW4gZG9jdW1lbnQga2V5IGZvciB0aGUgZ2l2ZW5cbiAgICAgKiBJRC5cbiAgICAgKi8gICAgcmVtb3ZlUmVmZXJlbmNlKHQsIGUpIHtcbiAgICAgICAgdGhpcy5ncyhuZXcgRm8odCwgZSkpO1xuICAgIH1cbiAgICB5cyh0LCBlKSB7XG4gICAgICAgIHQuZm9yRWFjaCgodCA9PiB0aGlzLnJlbW92ZVJlZmVyZW5jZSh0LCBlKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDbGVhcnMgYWxsIHJlZmVyZW5jZXMgd2l0aCBhIGdpdmVuIElELiBDYWxscyByZW1vdmVSZWYoKSBmb3IgZWFjaCBrZXlcbiAgICAgKiByZW1vdmVkLlxuICAgICAqLyAgICBwcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgaHQobmV3IHV0KFtdKSksIG4gPSBuZXcgRm8oZSwgdCksIHMgPSBuZXcgRm8oZSwgdCArIDEpLCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLmRzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmdzKHQpLCBpLnB1c2godC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIElzKCkge1xuICAgICAgICB0aGlzLmxzLmZvckVhY2goKHQgPT4gdGhpcy5ncyh0KSkpO1xuICAgIH1cbiAgICBncyh0KSB7XG4gICAgICAgIHRoaXMubHMgPSB0aGlzLmxzLmRlbGV0ZSh0KSwgdGhpcy5kcyA9IHRoaXMuZHMuZGVsZXRlKHQpO1xuICAgIH1cbiAgICBUcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgaHQobmV3IHV0KFtdKSksIG4gPSBuZXcgRm8oZSwgdCksIHMgPSBuZXcgRm8oZSwgdCArIDEpO1xuICAgICAgICBsZXQgaSA9IGdzKCk7XG4gICAgICAgIHJldHVybiB0aGlzLmRzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICBpID0gaS5hZGQodC5rZXkpO1xuICAgICAgICB9KSksIGk7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyBGbyh0LCAwKSwgbiA9IHRoaXMubHMuZmlyc3RBZnRlck9yRXF1YWwoZSk7XG4gICAgICAgIHJldHVybiBudWxsICE9PSBuICYmIHQuaXNFcXVhbChuLmtleSk7XG4gICAgfVxufVxuXG5jbGFzcyBGbyB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmtleSA9IHQsIHRoaXMuRXMgPSBlO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBrZXkgdGhlbiBieSBJRCAqLyAgICBzdGF0aWMgZnModCwgZSkge1xuICAgICAgICByZXR1cm4gaHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpIHx8IGV0KHQuRXMsIGUuRXMpO1xuICAgIH1cbiAgICAvKiogQ29tcGFyZSBieSBJRCB0aGVuIGJ5IGtleSAqLyAgICBzdGF0aWMgX3ModCwgZSkge1xuICAgICAgICByZXR1cm4gZXQodC5FcywgZS5FcykgfHwgaHQuY29tcGFyYXRvcih0LmtleSwgZS5rZXkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgQm8ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5pbmRleE1hbmFnZXIgPSB0LCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gZSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgc2V0IG9mIGFsbCBtdXRhdGlvbnMgdGhhdCBoYXZlIGJlZW4gc2VudCBidXQgbm90IHlldCBiZWVuIGFwcGxpZWQgdG9cbiAgICAgICAgICogdGhlIGJhY2tlbmQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSBbXSwgXG4gICAgICAgIC8qKiBOZXh0IHZhbHVlIHRvIHVzZSB3aGVuIGFzc2lnbmluZyBzZXF1ZW50aWFsIElEcyB0byBlYWNoIG11dGF0aW9uIGJhdGNoLiAqL1xuICAgICAgICB0aGlzLkFzID0gMSwgXG4gICAgICAgIC8qKiBBbiBvcmRlcmVkIG1hcHBpbmcgYmV0d2VlbiBkb2N1bWVudHMgYW5kIHRoZSBtdXRhdGlvbnMgYmF0Y2ggSURzLiAqL1xuICAgICAgICB0aGlzLlJzID0gbmV3IEVlKEZvLmZzKTtcbiAgICB9XG4gICAgY2hlY2tFbXB0eSh0KSB7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKDAgPT09IHRoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGgpO1xuICAgIH1cbiAgICBhZGRNdXRhdGlvbkJhdGNoKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgY29uc3QgaSA9IHRoaXMuQXM7XG4gICAgICAgIHRoaXMuQXMrKywgdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA+IDAgJiYgdGhpcy5tdXRhdGlvblF1ZXVlW3RoaXMubXV0YXRpb25RdWV1ZS5sZW5ndGggLSAxXTtcbiAgICAgICAgY29uc3QgciA9IG5ldyBacyhpLCBlLCBuLCBzKTtcbiAgICAgICAgdGhpcy5tdXRhdGlvblF1ZXVlLnB1c2gocik7XG4gICAgICAgIC8vIFRyYWNrIHJlZmVyZW5jZXMgYnkgZG9jdW1lbnQga2V5IGFuZCBpbmRleCBjb2xsZWN0aW9uIHBhcmVudHMuXG4gICAgICAgIGZvciAoY29uc3QgZSBvZiBzKSB0aGlzLlJzID0gdGhpcy5Scy5hZGQobmV3IEZvKGUua2V5LCBpKSksIHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIGUua2V5LnBhdGgucG9wTGFzdCgpKTtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUocik7XG4gICAgfVxuICAgIGxvb2t1cE11dGF0aW9uQmF0Y2godCwgZSkge1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSh0aGlzLnZzKGUpKTtcbiAgICB9XG4gICAgZ2V0TmV4dE11dGF0aW9uQmF0Y2hBZnRlckJhdGNoSWQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZSArIDEsIHMgPSB0aGlzLlBzKG4pLCBpID0gcyA8IDAgPyAwIDogcztcbiAgICAgICAgLy8gVGhlIHJlcXVlc3RlZCBiYXRjaElkIG1heSBzdGlsbCBiZSBvdXQgb2YgcmFuZ2Ugc28gbm9ybWFsaXplIGl0IHRvIHRoZVxuICAgICAgICAvLyBzdGFydCBvZiB0aGUgcXVldWUuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUodGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA+IGkgPyB0aGlzLm11dGF0aW9uUXVldWVbaV0gOiBudWxsKTtcbiAgICB9XG4gICAgZ2V0SGlnaGVzdFVuYWNrbm93bGVkZ2VkQmF0Y2hJZCgpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoMCA9PT0gdGhpcy5tdXRhdGlvblF1ZXVlLmxlbmd0aCA/IC0xIDogdGhpcy5BcyAtIDEpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXModCkge1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSh0aGlzLm11dGF0aW9uUXVldWUuc2xpY2UoKSk7XG4gICAgfVxuICAgIGdldEFsbE11dGF0aW9uQmF0Y2hlc0FmZmVjdGluZ0RvY3VtZW50S2V5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBGbyhlLCAwKSwgcyA9IG5ldyBGbyhlLCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpLCBpID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLlJzLmZvckVhY2hJblJhbmdlKFsgbiwgcyBdLCAodCA9PiB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy52cyh0LkVzKTtcbiAgICAgICAgICAgIGkucHVzaChlKTtcbiAgICAgICAgfSkpLCB2dC5yZXNvbHZlKGkpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdEb2N1bWVudEtleXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IG5ldyBFZShldCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IG5ldyBGbyh0LCAwKSwgcyA9IG5ldyBGbyh0LCBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFkpO1xuICAgICAgICAgICAgdGhpcy5Scy5mb3JFYWNoSW5SYW5nZShbIGUsIHMgXSwgKHQgPT4ge1xuICAgICAgICAgICAgICAgIG4gPSBuLmFkZCh0LkVzKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLCB2dC5yZXNvbHZlKHRoaXMuYnMobikpO1xuICAgIH1cbiAgICBnZXRBbGxNdXRhdGlvbkJhdGNoZXNBZmZlY3RpbmdRdWVyeSh0LCBlKSB7XG4gICAgICAgIC8vIFVzZSB0aGUgcXVlcnkgcGF0aCBhcyBhIHByZWZpeCBmb3IgdGVzdGluZyBpZiBhIGRvY3VtZW50IG1hdGNoZXMgdGhlXG4gICAgICAgIC8vIHF1ZXJ5LlxuICAgICAgICBjb25zdCBuID0gZS5wYXRoLCBzID0gbi5sZW5ndGggKyAxO1xuICAgICAgICAvLyBDb25zdHJ1Y3QgYSBkb2N1bWVudCByZWZlcmVuY2UgZm9yIGFjdHVhbGx5IHNjYW5uaW5nIHRoZSBpbmRleC4gVW5saWtlXG4gICAgICAgIC8vIHRoZSBwcmVmaXggdGhlIGRvY3VtZW50IGtleSBpbiB0aGlzIHJlZmVyZW5jZSBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2ZcbiAgICAgICAgLy8gc2VnbWVudHMuIFRoZSBlbXB0eSBzZWdtZW50IGNhbiBiZSB1c2VkIGEgc3VmZml4IG9mIHRoZSBxdWVyeSBwYXRoXG4gICAgICAgIC8vIGJlY2F1c2UgaXQgcHJlY2VkZXMgYWxsIG90aGVyIHNlZ21lbnRzIGluIGFuIG9yZGVyZWQgdHJhdmVyc2FsLlxuICAgICAgICBsZXQgaSA9IG47XG4gICAgICAgIGh0LmlzRG9jdW1lbnRLZXkoaSkgfHwgKGkgPSBpLmNoaWxkKFwiXCIpKTtcbiAgICAgICAgY29uc3QgciA9IG5ldyBGbyhuZXcgaHQoaSksIDApO1xuICAgICAgICAvLyBGaW5kIHVuaXF1ZSBiYXRjaElEcyByZWZlcmVuY2VkIGJ5IGFsbCBkb2N1bWVudHMgcG90ZW50aWFsbHkgbWF0Y2hpbmcgdGhlXG4gICAgICAgIC8vIHF1ZXJ5LlxuICAgICAgICAgICAgICAgIGxldCBvID0gbmV3IEVlKGV0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuUnMuZm9yRWFjaFdoaWxlKCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSB0LmtleS5wYXRoO1xuICAgICAgICAgICAgcmV0dXJuICEhbi5pc1ByZWZpeE9mKGUpICYmIChcbiAgICAgICAgICAgIC8vIFJvd3Mgd2l0aCBkb2N1bWVudCBrZXlzIG1vcmUgdGhhbiBvbmUgc2VnbWVudCBsb25nZXIgdGhhbiB0aGUgcXVlcnlcbiAgICAgICAgICAgIC8vIHBhdGggY2FuJ3QgYmUgbWF0Y2hlcy4gRm9yIGV4YW1wbGUsIGEgcXVlcnkgb24gJ3Jvb21zJyBjYW4ndCBtYXRjaFxuICAgICAgICAgICAgLy8gdGhlIGRvY3VtZW50IC9yb29tcy9hYmMvbWVzc2FnZXMveHl4LlxuICAgICAgICAgICAgLy8gVE9ETyhtY2cpOiB3ZSdsbCBuZWVkIGEgZGlmZmVyZW50IHNjYW5uZXIgd2hlbiB3ZSBpbXBsZW1lbnRcbiAgICAgICAgICAgIC8vIGFuY2VzdG9yIHF1ZXJpZXMuXG4gICAgICAgICAgICBlLmxlbmd0aCA9PT0gcyAmJiAobyA9IG8uYWRkKHQuRXMpKSwgITApO1xuICAgICAgICB9KSwgciksIHZ0LnJlc29sdmUodGhpcy5icyhvKSk7XG4gICAgfVxuICAgIGJzKHQpIHtcbiAgICAgICAgLy8gQ29uc3RydWN0IGFuIGFycmF5IG9mIG1hdGNoaW5nIGJhdGNoZXMsIHNvcnRlZCBieSBiYXRjaElEIHRvIGVuc3VyZSB0aGF0XG4gICAgICAgIC8vIG11bHRpcGxlIG11dGF0aW9ucyBhZmZlY3RpbmcgdGhlIHNhbWUgZG9jdW1lbnQga2V5IGFyZSBhcHBsaWVkIGluIG9yZGVyLlxuICAgICAgICBjb25zdCBlID0gW107XG4gICAgICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgbiA9IHRoaXMudnModCk7XG4gICAgICAgICAgICBudWxsICE9PSBuICYmIGUucHVzaChuKTtcbiAgICAgICAgfSkpLCBlO1xuICAgIH1cbiAgICByZW1vdmVNdXRhdGlvbkJhdGNoKHQsIGUpIHtcbiAgICAgICAgRigwID09PSB0aGlzLlZzKGUuYmF0Y2hJZCwgXCJyZW1vdmVkXCIpKSwgdGhpcy5tdXRhdGlvblF1ZXVlLnNoaWZ0KCk7XG4gICAgICAgIGxldCBuID0gdGhpcy5ScztcbiAgICAgICAgcmV0dXJuIHZ0LmZvckVhY2goZS5tdXRhdGlvbnMsIChzID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgRm8ocy5rZXksIGUuYmF0Y2hJZCk7XG4gICAgICAgICAgICByZXR1cm4gbiA9IG4uZGVsZXRlKGkpLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlLm1hcmtQb3RlbnRpYWxseU9ycGhhbmVkKHQsIHMua2V5KTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuUnMgPSBuO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIERuKHQpIHtcbiAgICAgICAgLy8gTm8tb3Agc2luY2UgdGhlIG1lbW9yeSBtdXRhdGlvbiBxdWV1ZSBkb2VzIG5vdCBtYWludGFpbiBhIHNlcGFyYXRlIGNhY2hlLlxuICAgIH1cbiAgICBjb250YWluc0tleSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgRm8oZSwgMCksIHMgPSB0aGlzLlJzLmZpcnN0QWZ0ZXJPckVxdWFsKG4pO1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZShlLmlzRXF1YWwocyAmJiBzLmtleSkpO1xuICAgIH1cbiAgICBwZXJmb3JtQ29uc2lzdGVuY3lDaGVjayh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEZpbmRzIHRoZSBpbmRleCBvZiB0aGUgZ2l2ZW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWUgYW5kIGFzc2VydHMgdGhhdFxuICAgICAqIHRoZSByZXN1bHRpbmcgaW5kZXggaXMgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIHF1ZXVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhdGNoSWQgLSBUaGUgYmF0Y2hJZCB0byBzZWFyY2ggZm9yXG4gICAgICogQHBhcmFtIGFjdGlvbiAtIEEgZGVzY3JpcHRpb24gb2Ygd2hhdCB0aGUgY2FsbGVyIGlzIGRvaW5nLCBwaHJhc2VkIGluIHBhc3NpdmVcbiAgICAgKiBmb3JtIChlLmcuIFwiYWNrbm93bGVkZ2VkXCIgaW4gYSByb3V0aW5lIHRoYXQgYWNrbm93bGVkZ2VzIGJhdGNoZXMpLlxuICAgICAqLyAgICBWcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlBzKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBGaW5kcyB0aGUgaW5kZXggb2YgdGhlIGdpdmVuIGJhdGNoSWQgaW4gdGhlIG11dGF0aW9uIHF1ZXVlLiBUaGlzIG9wZXJhdGlvblxuICAgICAqIGlzIE8oMSkuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBUaGUgY29tcHV0ZWQgaW5kZXggb2YgdGhlIGJhdGNoIHdpdGggdGhlIGdpdmVuIGJhdGNoSWQsIGJhc2VkIG9uXG4gICAgICogdGhlIHN0YXRlIG9mIHRoZSBxdWV1ZS4gTm90ZSB0aGlzIGluZGV4IGNhbiBiZSBuZWdhdGl2ZSBpZiB0aGUgcmVxdWVzdGVkXG4gICAgICogYmF0Y2hJZCBoYXMgYWxyZWFkeSBiZWVuIHJlbXZvZWQgZnJvbSB0aGUgcXVldWUgb3IgcGFzdCB0aGUgZW5kIG9mIHRoZVxuICAgICAqIHF1ZXVlIGlmIHRoZSBiYXRjaElkIGlzIGxhcmdlciB0aGFuIHRoZSBsYXN0IGFkZGVkIGJhdGNoLlxuICAgICAqLyAgICBQcyh0KSB7XG4gICAgICAgIGlmICgwID09PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKSBcbiAgICAgICAgLy8gQXMgYW4gaW5kZXggdGhpcyBpcyBwYXN0IHRoZSBlbmQgb2YgdGhlIHF1ZXVlXG4gICAgICAgIHJldHVybiAwO1xuICAgICAgICAvLyBFeGFtaW5lIHRoZSBmcm9udCBvZiB0aGUgcXVldWUgdG8gZmlndXJlIG91dCB0aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHRoZVxuICAgICAgICAvLyBiYXRjaElkIGFuZCBpbmRleGVzIGluIHRoZSBhcnJheS4gTm90ZSB0aGF0IHNpbmNlIHRoZSBxdWV1ZSBpcyBvcmRlcmVkXG4gICAgICAgIC8vIGJ5IGJhdGNoSWQsIGlmIHRoZSBmaXJzdCBiYXRjaCBoYXMgYSBsYXJnZXIgYmF0Y2hJZCB0aGVuIHRoZSByZXF1ZXN0ZWRcbiAgICAgICAgLy8gYmF0Y2hJZCBkb2Vzbid0IGV4aXN0IGluIHRoZSBxdWV1ZS5cbiAgICAgICAgICAgICAgICByZXR1cm4gdCAtIHRoaXMubXV0YXRpb25RdWV1ZVswXS5iYXRjaElkO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHZlcnNpb24gb2YgbG9va3VwTXV0YXRpb25CYXRjaCB0aGF0IGRvZXNuJ3QgcmV0dXJuIGEgcHJvbWlzZSwgdGhpcyBtYWtlc1xuICAgICAqIG90aGVyIGZ1bmN0aW9ucyB0aGF0IHVzZXMgdGhpcyBjb2RlIGVhc2llciB0byByZWFkIGFuZCBtb3JlIGVmZmljZW50LlxuICAgICAqLyAgICB2cyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLlBzKHQpO1xuICAgICAgICBpZiAoZSA8IDAgfHwgZSA+PSB0aGlzLm11dGF0aW9uUXVldWUubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHRoaXMubXV0YXRpb25RdWV1ZVtlXTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBtZW1vcnktb25seSBSZW1vdGVEb2N1bWVudENhY2hlIGZvciBJbmRleGVkRGIuIFRvIGNvbnN0cnVjdCwgaW52b2tlXG4gKiBgbmV3TWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSgpYC5cbiAqL1xuY2xhc3MgTG8ge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBzaXplciAtIFVzZWQgdG8gYXNzZXNzIHRoZSBzaXplIG9mIGEgZG9jdW1lbnQuIEZvciBlYWdlciBHQywgdGhpcyBpc1xuICAgICAqIGV4cGVjdGVkIHRvIGp1c3QgcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZlxuICAgICAqIGNhbGN1bGF0aW5nIHRoZSBzaXplLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5TcyA9IHQsIFxuICAgICAgICAvKiogVW5kZXJseWluZyBjYWNoZSBvZiBkb2N1bWVudHMgYW5kIHRoZWlyIHJlYWQgdGltZXMuICovXG4gICAgICAgIHRoaXMuZG9jcyA9IG5ldyBwZShodC5jb21wYXJhdG9yKSwgXG4gICAgICAgIC8qKiBTaXplIG9mIGFsbCBjYWNoZWQgZG9jdW1lbnRzLiAqL1xuICAgICAgICB0aGlzLnNpemUgPSAwO1xuICAgIH1cbiAgICBzZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICB0aGlzLmluZGV4TWFuYWdlciA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkZHMgdGhlIHN1cHBsaWVkIGVudHJ5IHRvIHRoZSBjYWNoZSBhbmQgdXBkYXRlcyB0aGUgY2FjaGUgc2l6ZSBhcyBhcHByb3ByaWF0ZS5cbiAgICAgKlxuICAgICAqIEFsbCBjYWxscyBvZiBgYWRkRW50cnlgICBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICBhZGRFbnRyeSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IHRoaXMuZG9jcy5nZXQobiksIGkgPSBzID8gcy5zaXplIDogMCwgciA9IHRoaXMuU3MoZSk7XG4gICAgICAgIHJldHVybiB0aGlzLmRvY3MgPSB0aGlzLmRvY3MuaW5zZXJ0KG4sIHtcbiAgICAgICAgICAgIGRvY3VtZW50OiBlLm11dGFibGVDb3B5KCksXG4gICAgICAgICAgICBzaXplOiByXG4gICAgICAgIH0pLCB0aGlzLnNpemUgKz0gciAtIGksIHRoaXMuaW5kZXhNYW5hZ2VyLmFkZFRvQ29sbGVjdGlvblBhcmVudEluZGV4KHQsIG4ucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIHRoZSBzcGVjaWZpZWQgZW50cnkgZnJvbSB0aGUgY2FjaGUgYW5kIHVwZGF0ZXMgdGhlIGNhY2hlIHNpemUgYXMgYXBwcm9wcmlhdGUuXG4gICAgICpcbiAgICAgKiBBbGwgY2FsbHMgb2YgYHJlbW92ZUVudHJ5YCBhcmUgcmVxdWlyZWQgdG8gZ28gdGhyb3VnaCB0aGUgUmVtb3RlRG9jdW1lbnRDaGFuZ2VCdWZmZXJcbiAgICAgKiByZXR1cm5lZCBieSBgbmV3Q2hhbmdlQnVmZmVyKClgLlxuICAgICAqLyAgICByZW1vdmVFbnRyeSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmRvY3MuZ2V0KHQpO1xuICAgICAgICBlICYmICh0aGlzLmRvY3MgPSB0aGlzLmRvY3MucmVtb3ZlKHQpLCB0aGlzLnNpemUgLT0gZS5zaXplKTtcbiAgICB9XG4gICAgZ2V0RW50cnkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5kb2NzLmdldChlKTtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUobiA/IG4uZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IGFuLm5ld0ludmFsaWREb2N1bWVudChlKSk7XG4gICAgfVxuICAgIGdldEVudHJpZXModCwgZSkge1xuICAgICAgICBsZXQgbiA9IGNzKCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jcy5nZXQodCk7XG4gICAgICAgICAgICBuID0gbi5pbnNlcnQodCwgZSA/IGUuZG9jdW1lbnQubXV0YWJsZUNvcHkoKSA6IGFuLm5ld0ludmFsaWREb2N1bWVudCh0KSk7XG4gICAgICAgIH0pKSwgdnQucmVzb2x2ZShuKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGxldCBpID0gY3MoKTtcbiAgICAgICAgLy8gRG9jdW1lbnRzIGFyZSBvcmRlcmVkIGJ5IGtleSwgc28gd2UgY2FuIHVzZSBhIHByZWZpeCBzY2FuIHRvIG5hcnJvdyBkb3duXG4gICAgICAgIC8vIHRoZSBkb2N1bWVudHMgd2UgbmVlZCB0byBtYXRjaCB0aGUgcXVlcnkgYWdhaW5zdC5cbiAgICAgICAgICAgICAgICBjb25zdCByID0gZS5wYXRoLCBvID0gbmV3IGh0KHIuY2hpbGQoXCJcIikpLCB1ID0gdGhpcy5kb2NzLmdldEl0ZXJhdG9yRnJvbShvKTtcbiAgICAgICAgZm9yICg7dS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3Qge2tleTogdCwgdmFsdWU6IHtkb2N1bWVudDogb319ID0gdS5nZXROZXh0KCk7XG4gICAgICAgICAgICBpZiAoIXIuaXNQcmVmaXhPZih0LnBhdGgpKSBicmVhaztcbiAgICAgICAgICAgIHQucGF0aC5sZW5ndGggPiByLmxlbmd0aCArIDEgfHwgKFR0KHB0KG8pLCBuKSA8PSAwIHx8IChzLmhhcyhvLmtleSkgfHwgbnMoZSwgbykpICYmIChpID0gaS5pbnNlcnQoby5rZXksIG8ubXV0YWJsZUNvcHkoKSkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZShpKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNvbGxlY3Rpb25Hcm91cCh0LCBlLCBuLCBzKSB7XG4gICAgICAgIC8vIFRoaXMgbWV0aG9kIHNob3VsZCBvbmx5IGJlIGNhbGxlZCBmcm9tIHRoZSBJbmRleEJhY2tmaWxsZXIgaWYgcGVyc2lzdGVuY2VcbiAgICAgICAgLy8gaXMgZW5hYmxlZC5cbiAgICAgICAgJCgpO1xuICAgIH1cbiAgICBEcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2dC5mb3JFYWNoKHRoaXMuZG9jcywgKHQgPT4gZSh0KSkpO1xuICAgIH1cbiAgICBuZXdDaGFuZ2VCdWZmZXIodCkge1xuICAgICAgICAvLyBgdHJhY2tSZW1vdmFsc2AgaXMgaWdub3JlcyBzaW5jZSB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZSBrZWVwc1xuICAgICAgICAvLyBhIHNlcGFyYXRlIGNoYW5nZWxvZyBhbmQgZG9lcyBub3QgbmVlZCBzcGVjaWFsIGhhbmRsaW5nIGZvciByZW1vdmFscy5cbiAgICAgICAgcmV0dXJuIG5ldyBxbyh0aGlzKTtcbiAgICB9XG4gICAgZ2V0U2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHRoaXMuc2l6ZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgbWVtb3J5LW9ubHkgUmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqXG4gKiBAcGFyYW0gc2l6ZXIgLSBVc2VkIHRvIGFzc2VzcyB0aGUgc2l6ZSBvZiBhIGRvY3VtZW50LiBGb3IgZWFnZXIgR0MsIHRoaXMgaXNcbiAqIGV4cGVjdGVkIHRvIGp1c3QgcmV0dXJuIDAgdG8gYXZvaWQgdW5uZWNlc3NhcmlseSBkb2luZyB0aGUgd29yayBvZlxuICogY2FsY3VsYXRpbmcgdGhlIHNpemUuXG4gKi9cbi8qKlxuICogSGFuZGxlcyB0aGUgZGV0YWlscyBvZiBhZGRpbmcgYW5kIHVwZGF0aW5nIGRvY3VtZW50cyBpbiB0aGUgTWVtb3J5UmVtb3RlRG9jdW1lbnRDYWNoZS5cbiAqL1xuY2xhc3MgcW8gZXh0ZW5kcyBSbyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnJzID0gdDtcbiAgICB9XG4gICAgYXBwbHlDaGFuZ2VzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VzLmZvckVhY2goKChuLCBzKSA9PiB7XG4gICAgICAgICAgICBzLmlzVmFsaWREb2N1bWVudCgpID8gZS5wdXNoKHRoaXMucnMuYWRkRW50cnkodCwgcykpIDogdGhpcy5ycy5yZW1vdmVFbnRyeShuKTtcbiAgICAgICAgfSkpLCB2dC53YWl0Rm9yKGUpO1xuICAgIH1cbiAgICBnZXRGcm9tQ2FjaGUodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5ycy5nZXRFbnRyeSh0LCBlKTtcbiAgICB9XG4gICAgZ2V0QWxsRnJvbUNhY2hlKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucnMuZ2V0RW50cmllcyh0LCBlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIFVvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgYSB0YXJnZXQgdG8gdGhlIGRhdGEgYWJvdXQgdGhhdCB0YXJnZXRcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuQ3MgPSBuZXcgb3MoKHQgPT4gT24odCkpLCAkbiksIFxuICAgICAgICAvKiogVGhlIGxhc3QgcmVjZWl2ZWQgc25hcHNob3QgdmVyc2lvbi4gKi9cbiAgICAgICAgdGhpcy5sYXN0UmVtb3RlU25hcHNob3RWZXJzaW9uID0gcnQubWluKCksIFxuICAgICAgICAvKiogVGhlIGhpZ2hlc3QgbnVtYmVyZWQgdGFyZ2V0IElEIGVuY291bnRlcmVkLiAqL1xuICAgICAgICB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IDAsIFxuICAgICAgICAvKiogVGhlIGhpZ2hlc3Qgc2VxdWVuY2UgbnVtYmVyIGVuY291bnRlcmVkLiAqL1xuICAgICAgICB0aGlzLnhzID0gMCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG9yZGVyZWQgYmlkaXJlY3Rpb25hbCBtYXBwaW5nIGJldHdlZW4gZG9jdW1lbnRzIGFuZCB0aGUgcmVtb3RlIHRhcmdldFxuICAgICAgICAgKiBJRHMuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLk5zID0gbmV3ICRvLCB0aGlzLnRhcmdldENvdW50ID0gMCwgdGhpcy5rcyA9IGxvLk5uKCk7XG4gICAgfVxuICAgIGZvckVhY2hUYXJnZXQodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Dcy5mb3JFYWNoKCgodCwgbikgPT4gZShuKSkpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIGdldExhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24odCkge1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSh0aGlzLmxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb24pO1xuICAgIH1cbiAgICBnZXRIaWdoZXN0U2VxdWVuY2VOdW1iZXIodCkge1xuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZSh0aGlzLnhzKTtcbiAgICB9XG4gICAgYWxsb2NhdGVUYXJnZXRJZCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhpZ2hlc3RUYXJnZXRJZCA9IHRoaXMua3MubmV4dCgpLCB2dC5yZXNvbHZlKHRoaXMuaGlnaGVzdFRhcmdldElkKTtcbiAgICB9XG4gICAgc2V0VGFyZ2V0c01ldGFkYXRhKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG4gJiYgKHRoaXMubGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbiA9IG4pLCBlID4gdGhpcy54cyAmJiAodGhpcy54cyA9IGUpLCBcbiAgICAgICAgdnQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICAkbih0KSB7XG4gICAgICAgIHRoaXMuQ3Muc2V0KHQudGFyZ2V0LCB0KTtcbiAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0SWQ7XG4gICAgICAgIGUgPiB0aGlzLmhpZ2hlc3RUYXJnZXRJZCAmJiAodGhpcy5rcyA9IG5ldyBsbyhlKSwgdGhpcy5oaWdoZXN0VGFyZ2V0SWQgPSBlKSwgdC5zZXF1ZW5jZU51bWJlciA+IHRoaXMueHMgJiYgKHRoaXMueHMgPSB0LnNlcXVlbmNlTnVtYmVyKTtcbiAgICB9XG4gICAgYWRkVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRuKGUpLCB0aGlzLnRhcmdldENvdW50ICs9IDEsIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgdXBkYXRlVGFyZ2V0RGF0YSh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiRuKGUpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldERhdGEodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5Dcy5kZWxldGUoZS50YXJnZXQpLCB0aGlzLk5zLnBzKGUudGFyZ2V0SWQpLCB0aGlzLnRhcmdldENvdW50IC09IDEsIFxuICAgICAgICB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldHModCwgZSwgbikge1xuICAgICAgICBsZXQgcyA9IDA7XG4gICAgICAgIGNvbnN0IGkgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ3MuZm9yRWFjaCgoKHIsIG8pID0+IHtcbiAgICAgICAgICAgIG8uc2VxdWVuY2VOdW1iZXIgPD0gZSAmJiBudWxsID09PSBuLmdldChvLnRhcmdldElkKSAmJiAodGhpcy5Dcy5kZWxldGUociksIGkucHVzaCh0aGlzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIG8udGFyZ2V0SWQpKSwgXG4gICAgICAgICAgICBzKyspO1xuICAgICAgICB9KSksIHZ0LndhaXRGb3IoaSkubmV4dCgoKCkgPT4gcykpO1xuICAgIH1cbiAgICBnZXRUYXJnZXRDb3VudCh0KSB7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHRoaXMudGFyZ2V0Q291bnQpO1xuICAgIH1cbiAgICBnZXRUYXJnZXREYXRhKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuQ3MuZ2V0KGUpIHx8IG51bGw7XG4gICAgICAgIHJldHVybiB2dC5yZXNvbHZlKG4pO1xuICAgIH1cbiAgICBhZGRNYXRjaGluZ0tleXModCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5Ocy53cyhlLCBuKSwgdnQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICByZW1vdmVNYXRjaGluZ0tleXModCwgZSwgbikge1xuICAgICAgICB0aGlzLk5zLnlzKGUsIG4pO1xuICAgICAgICBjb25zdCBzID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZSwgaSA9IFtdO1xuICAgICAgICByZXR1cm4gcyAmJiBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgaS5wdXNoKHMubWFya1BvdGVudGlhbGx5T3JwaGFuZWQodCwgZSkpO1xuICAgICAgICB9KSksIHZ0LndhaXRGb3IoaSk7XG4gICAgfVxuICAgIHJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTnMucHMoZSksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgZ2V0TWF0Y2hpbmdLZXlzRm9yVGFyZ2V0SWQodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5Ocy5UcyhlKTtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUobik7XG4gICAgfVxuICAgIGNvbnRhaW5zS2V5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUodGhpcy5Ocy5jb250YWluc0tleShlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIG1lbW9yeS1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIG9ubHkgaW4gUkFNIGFuZFxuICogbm90IHBlcnNpc3RlZCBhY3Jvc3Mgc2Vzc2lvbnMuXG4gKi9cbmNsYXNzIEtvIHtcbiAgICAvKipcbiAgICAgKiBUaGUgY29uc3RydWN0b3IgYWNjZXB0cyBhIGZhY3RvcnkgZm9yIGNyZWF0aW5nIGEgcmVmZXJlbmNlIGRlbGVnYXRlLiBUaGlzXG4gICAgICogYWxsb3dzIGJvdGggdGhlIGRlbGVnYXRlIGFuZCB0aGlzIGluc3RhbmNlIHRvIGhhdmUgc3Ryb25nIHJlZmVyZW5jZXMgdG9cbiAgICAgKiBlYWNoIG90aGVyIHdpdGhvdXQgaGF2aW5nIG51bGxhYmxlIGZpZWxkcyB0aGF0IHdvdWxkIHRoZW4gbmVlZCB0byBiZVxuICAgICAqIGNoZWNrZWQgb3IgYXNzZXJ0ZWQgb24gZXZlcnkgYWNjZXNzLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5NcyA9IHt9LCB0aGlzLm92ZXJsYXlzID0ge30sIHRoaXMuT3MgPSBuZXcgJHQoMCksIHRoaXMuJHMgPSAhMSwgdGhpcy4kcyA9ICEwLCBcbiAgICAgICAgdGhpcy5yZWZlcmVuY2VEZWxlZ2F0ZSA9IHQodGhpcyksIHRoaXMuRnMgPSBuZXcgVW8odGhpcyk7XG4gICAgICAgIHRoaXMuaW5kZXhNYW5hZ2VyID0gbmV3IHpyLCB0aGlzLnJlbW90ZURvY3VtZW50Q2FjaGUgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IExvKHQpO1xuICAgICAgICB9KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuQnModCkpKSwgdGhpcy5zZXJpYWxpemVyID0gbmV3IGFyKGUpLCB0aGlzLkxzID0gbmV3IE1vKHRoaXMuc2VyaWFsaXplcik7XG4gICAgfVxuICAgIHN0YXJ0KCkge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICAvLyBObyBkdXJhYmxlIHN0YXRlIHRvIGVuc3VyZSBpcyBjbG9zZWQgb24gc2h1dGRvd24uXG4gICAgICAgIHJldHVybiB0aGlzLiRzID0gITEsIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHM7XG4gICAgfVxuICAgIHNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCkge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgc2V0TmV0d29ya0VuYWJsZWQoKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICAvLyBXZSBkbyBub3QgY3VycmVudGx5IHN1cHBvcnQgaW5kaWNlcyBmb3IgbWVtb3J5IHBlcnNpc3RlbmNlLCBzbyB3ZSBjYW5cbiAgICAgICAgLy8gcmV0dXJuIHRoZSBzYW1lIHNoYXJlZCBpbnN0YW5jZSBvZiB0aGUgbWVtb3J5IGluZGV4IG1hbmFnZXIuXG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4TWFuYWdlcjtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUodCkge1xuICAgICAgICBsZXQgZSA9IHRoaXMub3ZlcmxheXNbdC50b0tleSgpXTtcbiAgICAgICAgcmV0dXJuIGUgfHwgKGUgPSBuZXcgT28sIHRoaXMub3ZlcmxheXNbdC50b0tleSgpXSA9IGUpLCBlO1xuICAgIH1cbiAgICBnZXRNdXRhdGlvblF1ZXVlKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSB0aGlzLk1zW3QudG9LZXkoKV07XG4gICAgICAgIHJldHVybiBuIHx8IChuID0gbmV3IEJvKGUsIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUpLCB0aGlzLk1zW3QudG9LZXkoKV0gPSBuKSwgbjtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkZzO1xuICAgIH1cbiAgICBnZXRSZW1vdGVEb2N1bWVudENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xuICAgIH1cbiAgICBnZXRCdW5kbGVDYWNoZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuTHM7XG4gICAgfVxuICAgIHJ1blRyYW5zYWN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgTihcIk1lbW9yeVBlcnNpc3RlbmNlXCIsIFwiU3RhcnRpbmcgdHJhbnNhY3Rpb246XCIsIHQpO1xuICAgICAgICBjb25zdCBzID0gbmV3IEdvKHRoaXMuT3MubmV4dCgpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVmZXJlbmNlRGVsZWdhdGUucXMoKSwgbihzKS5uZXh0KCh0ID0+IHRoaXMucmVmZXJlbmNlRGVsZWdhdGUuVXMocykubmV4dCgoKCkgPT4gdCkpKSkudG9Qcm9taXNlKCkudGhlbigodCA9PiAocy5yYWlzZU9uQ29tbWl0dGVkRXZlbnQoKSwgXG4gICAgICAgIHQpKSk7XG4gICAgfVxuICAgIEtzKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0Lm9yKE9iamVjdC52YWx1ZXModGhpcy5NcykubWFwKChuID0+ICgpID0+IG4uY29udGFpbnNLZXkodCwgZSkpKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIE1lbW9yeSBwZXJzaXN0ZW5jZSBpcyBub3QgYWN0dWFsbHkgdHJhbnNhY3Rpb25hbCwgYnV0IGZ1dHVyZSBpbXBsZW1lbnRhdGlvbnNcbiAqIG1heSBoYXZlIHRyYW5zYWN0aW9uLXNjb3BlZCBzdGF0ZS5cbiAqLyBjbGFzcyBHbyBleHRlbmRzIEF0IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuY3VycmVudFNlcXVlbmNlTnVtYmVyID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIFFvIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCBcbiAgICAgICAgLyoqIFRyYWNrcyBhbGwgZG9jdW1lbnRzIHRoYXQgYXJlIGFjdGl2ZSBpbiBRdWVyeSB2aWV3cy4gKi9cbiAgICAgICAgdGhpcy5HcyA9IG5ldyAkbywgXG4gICAgICAgIC8qKiBUaGUgbGlzdCBvZiBkb2N1bWVudHMgdGhhdCBhcmUgcG90ZW50aWFsbHkgR0NlZCBhZnRlciBlYWNoIHRyYW5zYWN0aW9uLiAqL1xuICAgICAgICB0aGlzLlFzID0gbnVsbDtcbiAgICB9XG4gICAgc3RhdGljIGpzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRbyh0KTtcbiAgICB9XG4gICAgZ2V0IHpzKCkge1xuICAgICAgICBpZiAodGhpcy5RcykgcmV0dXJuIHRoaXMuUXM7XG4gICAgICAgIHRocm93ICQoKTtcbiAgICB9XG4gICAgYWRkUmVmZXJlbmNlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuR3MuYWRkUmVmZXJlbmNlKG4sIGUpLCB0aGlzLnpzLmRlbGV0ZShuLnRvU3RyaW5nKCkpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkdzLnJlbW92ZVJlZmVyZW5jZShuLCBlKSwgdGhpcy56cy5hZGQobi50b1N0cmluZygpKSwgdnQucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnpzLmFkZChlLnRvU3RyaW5nKCkpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVRhcmdldCh0LCBlKSB7XG4gICAgICAgIHRoaXMuR3MucHMoZS50YXJnZXRJZCkuZm9yRWFjaCgodCA9PiB0aGlzLnpzLmFkZCh0LnRvU3RyaW5nKCkpKSk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCk7XG4gICAgICAgIHJldHVybiBuLmdldE1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGUudGFyZ2V0SWQpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHRoaXMuenMuYWRkKHQudG9TdHJpbmcoKSkpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IG4ucmVtb3ZlVGFyZ2V0RGF0YSh0LCBlKSkpO1xuICAgIH1cbiAgICBxcygpIHtcbiAgICAgICAgdGhpcy5RcyA9IG5ldyBTZXQ7XG4gICAgfVxuICAgIFVzKHQpIHtcbiAgICAgICAgLy8gUmVtb3ZlIG5ld2x5IG9ycGhhbmVkIGRvY3VtZW50cy5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLm5ld0NoYW5nZUJ1ZmZlcigpO1xuICAgICAgICByZXR1cm4gdnQuZm9yRWFjaCh0aGlzLnpzLCAobiA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gaHQuZnJvbVBhdGgobik7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5Xcyh0LCBzKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8IGUucmVtb3ZlRW50cnkocywgcnQubWluKCkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gKHRoaXMuUXMgPSBudWxsLCBlLmFwcGx5KHQpKSkpO1xuICAgIH1cbiAgICB1cGRhdGVMaW1ib0RvY3VtZW50KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuV3ModCwgZSkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICB0ID8gdGhpcy56cy5kZWxldGUoZS50b1N0cmluZygpKSA6IHRoaXMuenMuYWRkKGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgQnModCkge1xuICAgICAgICAvLyBGb3IgZWFnZXIgR0MsIHdlIGRvbid0IGNhcmUgYWJvdXQgdGhlIGRvY3VtZW50IHNpemUsIHRoZXJlIGFyZSBubyBzaXplIHRocmVzaG9sZHMuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgICBXcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiB2dC5vcihbICgpID0+IHZ0LnJlc29sdmUodGhpcy5Hcy5jb250YWluc0tleShlKSksICgpID0+IHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5jb250YWluc0tleSh0LCBlKSwgKCkgPT4gdGhpcy5wZXJzaXN0ZW5jZS5Lcyh0LCBlKSBdKTtcbiAgICB9XG59XG5cbmNsYXNzIGpvIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMucGVyc2lzdGVuY2UgPSB0LCB0aGlzLkhzID0gbmV3IG9zKCh0ID0+IHF0KHQucGF0aCkpLCAoKHQsIGUpID0+IHQuaXNFcXVhbChlKSkpLCBcbiAgICAgICAgdGhpcy5nYXJiYWdlQ29sbGVjdG9yID0gVG8odGhpcywgZSk7XG4gICAgfVxuICAgIHN0YXRpYyBqcyh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgam8odCwgZSk7XG4gICAgfVxuICAgIC8vIE5vLW9wcywgcHJlc2VudCBzbyBtZW1vcnkgcGVyc2lzdGVuY2UgZG9lc24ndCBoYXZlIHRvIGNhcmUgd2hpY2ggZGVsZWdhdGVcbiAgICAvLyBpdCBoYXMuXG4gICAgcXMoKSB7fVxuICAgIFVzKHQpIHtcbiAgICAgICAgcmV0dXJuIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgZm9yRWFjaFRhcmdldCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCkuZm9yRWFjaFRhcmdldCh0LCBlKTtcbiAgICB9XG4gICAgam4odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5Ibih0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5nZXRUYXJnZXRDb3VudCh0KS5uZXh0KCh0ID0+IGUubmV4dCgoZSA9PiB0ICsgZSkpKSk7XG4gICAgfVxuICAgIEhuKHQpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICByZXR1cm4gdGhpcy56bih0LCAodCA9PiB7XG4gICAgICAgICAgICBlKys7XG4gICAgICAgIH0pKS5uZXh0KCgoKSA9PiBlKSk7XG4gICAgfVxuICAgIHpuKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHZ0LmZvckVhY2godGhpcy5IcywgKChuLCBzKSA9PiB0aGlzLlluKHQsIG4sIHMpLm5leHQoKHQgPT4gdCA/IHZ0LnJlc29sdmUoKSA6IGUocykpKSkpO1xuICAgIH1cbiAgICByZW1vdmVUYXJnZXRzKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS5yZW1vdmVUYXJnZXRzKHQsIGUsIG4pO1xuICAgIH1cbiAgICByZW1vdmVPcnBoYW5lZERvY3VtZW50cyh0LCBlKSB7XG4gICAgICAgIGxldCBuID0gMDtcbiAgICAgICAgY29uc3QgcyA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLCBpID0gcy5uZXdDaGFuZ2VCdWZmZXIoKTtcbiAgICAgICAgcmV0dXJuIHMuRHModCwgKHMgPT4gdGhpcy5Zbih0LCBzLCBlKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHQgfHwgKG4rKywgaS5yZW1vdmVFbnRyeShzLCBydC5taW4oKSkpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiBpLmFwcGx5KHQpKSkubmV4dCgoKCkgPT4gbikpO1xuICAgIH1cbiAgICBtYXJrUG90ZW50aWFsbHlPcnBoYW5lZCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhzLnNldChlLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgcmVtb3ZlVGFyZ2V0KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUud2l0aFNlcXVlbmNlTnVtYmVyKHQuY3VycmVudFNlcXVlbmNlTnVtYmVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucGVyc2lzdGVuY2UuZ2V0VGFyZ2V0Q2FjaGUoKS51cGRhdGVUYXJnZXREYXRhKHQsIG4pO1xuICAgIH1cbiAgICBhZGRSZWZlcmVuY2UodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdGhpcy5Icy5zZXQobiwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpLCB2dC5yZXNvbHZlKCk7XG4gICAgfVxuICAgIHJlbW92ZVJlZmVyZW5jZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhzLnNldChuLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgdXBkYXRlTGltYm9Eb2N1bWVudCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkhzLnNldChlLCB0LmN1cnJlbnRTZXF1ZW5jZU51bWJlciksIHZ0LnJlc29sdmUoKTtcbiAgICB9XG4gICAgQnModCkge1xuICAgICAgICBsZXQgZSA9IHQua2V5LnRvU3RyaW5nKCkubGVuZ3RoO1xuICAgICAgICByZXR1cm4gdC5pc0ZvdW5kRG9jdW1lbnQoKSAmJiAoZSArPSB6ZSh0LmRhdGEudmFsdWUpKSwgZTtcbiAgICB9XG4gICAgWW4odCwgZSwgbikge1xuICAgICAgICByZXR1cm4gdnQub3IoWyAoKSA9PiB0aGlzLnBlcnNpc3RlbmNlLktzKHQsIGUpLCAoKSA9PiB0aGlzLnBlcnNpc3RlbmNlLmdldFRhcmdldENhY2hlKCkuY29udGFpbnNLZXkodCwgZSksICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLkhzLmdldChlKTtcbiAgICAgICAgICAgIHJldHVybiB2dC5yZXNvbHZlKHZvaWQgMCAhPT0gdCAmJiB0ID4gbik7XG4gICAgICAgIH0gXSk7XG4gICAgfVxuICAgIGdldENhY2hlU2l6ZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLmdldFJlbW90ZURvY3VtZW50Q2FjaGUoKS5nZXRTaXplKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLiAqLyBjbGFzcyB6byB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBkYXRhYmFzZSBjcmVhdGlvbiBhbmQgc2NoZW1hIHVwZ3JhZGVzLlxuICAgICAqXG4gICAgICogTm90ZSB0aGF0IGluIHByb2R1Y3Rpb24sIHRoaXMgbWV0aG9kIGlzIG9ubHkgZXZlciB1c2VkIHRvIHVwZ3JhZGUgdGhlIHNjaGVtYVxuICAgICAqIHRvIFNDSEVNQV9WRVJTSU9OLiBEaWZmZXJlbnQgdmFsdWVzIG9mIHRvVmVyc2lvbiBhcmUgb25seSB1c2VkIGZvciB0ZXN0aW5nXG4gICAgICogYW5kIGxvY2FsIGZlYXR1cmUgZGV2ZWxvcG1lbnQuXG4gICAgICovICAgICQodCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IFB0KFwiY3JlYXRlT3JVcGdyYWRlXCIsIGUpO1xuICAgICAgICBuIDwgMSAmJiBzID49IDEgJiYgKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJvd25lclwiKTtcbiAgICAgICAgfSh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm11dGF0aW9uUXVldWVzXCIsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBcInVzZXJJZFwiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJtdXRhdGlvbnNcIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiYmF0Y2hJZFwiLFxuICAgICAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6ICEwXG4gICAgICAgICAgICB9KS5jcmVhdGVJbmRleChcInVzZXJNdXRhdGlvbnNJbmRleFwiLCBRdCwge1xuICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgIH0pLCB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiZG9jdW1lbnRNdXRhdGlvbnNcIik7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBVcGdyYWRlIGZ1bmN0aW9uIHRvIG1pZ3JhdGUgdGhlICdtdXRhdGlvbnMnIHN0b3JlIGZyb20gVjEgdG8gVjMuIExvYWRzXG4gKiBhbmQgcmV3cml0ZXMgYWxsIGRhdGEuXG4gKi8gKHQpLCBXbyh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcInJlbW90ZURvY3VtZW50c1wiKTtcbiAgICAgICAgfSh0KSk7XG4gICAgICAgIC8vIE1pZ3JhdGlvbiAyIHRvIHBvcHVsYXRlIHRoZSB0YXJnZXRHbG9iYWwgb2JqZWN0IG5vIGxvbmdlciBuZWVkZWQgc2luY2VcbiAgICAgICAgLy8gbWlncmF0aW9uIDMgdW5jb25kaXRpb25hbGx5IGNsZWFycyBpdC5cbiAgICAgICAgICAgICAgICBsZXQgciA9IHZ0LnJlc29sdmUoKTtcbiAgICAgICAgcmV0dXJuIG4gPCAzICYmIHMgPj0gMyAmJiAoXG4gICAgICAgIC8vIEJyYW5kIG5ldyBjbGllbnRzIGRvbid0IG5lZWQgdG8gZHJvcCBhbmQgcmVjcmVhdGUtLW9ubHkgY2xpZW50cyB0aGF0XG4gICAgICAgIC8vIHBvdGVudGlhbGx5IGhhdmUgY29ycnVwdCBkYXRhLlxuICAgICAgICAwICE9PSBuICYmICghZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdC5kZWxldGVPYmplY3RTdG9yZShcInRhcmdldERvY3VtZW50c1wiKSwgdC5kZWxldGVPYmplY3RTdG9yZShcInRhcmdldHNcIiksIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJ0YXJnZXRHbG9iYWxcIik7XG4gICAgICAgIH0odCksIFdvKHQpKSwgciA9IHIubmV4dCgoKCkgPT4gXG4gICAgICAgIC8qKlxuICogQ3JlYXRlcyB0aGUgdGFyZ2V0IGdsb2JhbCBzaW5nbGV0b24gcm93LlxuICpcbiAqIEBwYXJhbSB0eG4gLSBUaGUgdmVyc2lvbiB1cGdyYWRlIHRyYW5zYWN0aW9uIGZvciBpbmRleGVkZGJcbiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC5zdG9yZShcInRhcmdldEdsb2JhbFwiKSwgbiA9IHtcbiAgICAgICAgICAgICAgICBoaWdoZXN0VGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgaGlnaGVzdExpc3RlblNlcXVlbmNlTnVtYmVyOiAwLFxuICAgICAgICAgICAgICAgIGxhc3RSZW1vdGVTbmFwc2hvdFZlcnNpb246IHJ0Lm1pbigpLnRvVGltZXN0YW1wKCksXG4gICAgICAgICAgICAgICAgdGFyZ2V0Q291bnQ6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gZS5wdXQoXCJ0YXJnZXRHbG9iYWxLZXlcIiwgbik7XG4gICAgICAgIH0oaSkpKSksIG4gPCA0ICYmIHMgPj0gNCAmJiAoMCAhPT0gbiAmJiAoXG4gICAgICAgIC8vIFNjaGVtYSB2ZXJzaW9uIDMgdXNlcyBhdXRvLWdlbmVyYXRlZCBrZXlzIHRvIGdlbmVyYXRlIGdsb2JhbGx5IHVuaXF1ZVxuICAgICAgICAvLyBtdXRhdGlvbiBiYXRjaCBJRHMgKHRoaXMgd2FzIHByZXZpb3VzbHkgZW5zdXJlZCBpbnRlcm5hbGx5IGJ5IHRoZVxuICAgICAgICAvLyBjbGllbnQpLiBUbyBtaWdyYXRlIHRvIHRoZSBuZXcgc2NoZW1hLCB3ZSBoYXZlIHRvIHJlYWQgYWxsIG11dGF0aW9uc1xuICAgICAgICAvLyBhbmQgd3JpdGUgdGhlbSBiYWNrIG91dC4gV2UgcHJlc2VydmUgdGhlIGV4aXN0aW5nIGJhdGNoIElEcyB0byBndWFyYW50ZWVcbiAgICAgICAgLy8gY29uc2lzdGVuY3kgd2l0aCBvdGhlciBvYmplY3Qgc3RvcmVzLiBBbnkgZnVydGhlciBtdXRhdGlvbiBiYXRjaCBJRHMgd2lsbFxuICAgICAgICAvLyBiZSBhdXRvLWdlbmVyYXRlZC5cbiAgICAgICAgciA9IHIubmV4dCgoKCkgPT4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgcmV0dXJuIGUuc3RvcmUoXCJtdXRhdGlvbnNcIikuaigpLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgICAgIHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJtdXRhdGlvbnNcIik7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcIm11dGF0aW9uc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiYmF0Y2hJZFwiLFxuICAgICAgICAgICAgICAgICAgICBhdXRvSW5jcmVtZW50OiAhMFxuICAgICAgICAgICAgICAgIH0pLmNyZWF0ZUluZGV4KFwidXNlck11dGF0aW9uc0luZGV4XCIsIFF0LCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5zdG9yZShcIm11dGF0aW9uc1wiKSwgaSA9IG4ubWFwKCh0ID0+IHMucHV0KHQpKSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZ0LndhaXRGb3IoaSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0odCwgaSkpKSksIHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImNsaWVudE1ldGFkYXRhXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogXCJjbGllbnRJZFwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KHQpO1xuICAgICAgICB9KSkpLCBuIDwgNSAmJiBzID49IDUgJiYgKHIgPSByLm5leHQoKCgpID0+IHRoaXMuSnMoaSkpKSksIG4gPCA2ICYmIHMgPj0gNiAmJiAociA9IHIubmV4dCgoKCkgPT4gKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudEdsb2JhbFwiKTtcbiAgICAgICAgfSh0KSwgdGhpcy5ZcyhpKSkpKSksIG4gPCA3ICYmIHMgPj0gNyAmJiAociA9IHIubmV4dCgoKCkgPT4gdGhpcy5YcyhpKSkpKSwgbiA8IDggJiYgcyA+PSA4ICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLlpzKHQsIGkpKSkpLCBcbiAgICAgICAgbiA8IDkgJiYgcyA+PSA5ICYmIChyID0gci5uZXh0KCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBNdWx0aS1UYWIgdXNlZCB0byBtYW5hZ2UgaXRzIG93biBjaGFuZ2Vsb2csIGJ1dCB0aGlzIGhhcyBiZWVuIG1vdmVkXG4gICAgICAgICAgICAvLyB0byB0aGUgRGJSZW1vdGVEb2N1bWVudCBvYmplY3Qgc3RvcmUgaXRzZWxmLiBTaW5jZSB0aGUgcHJldmlvdXMgY2hhbmdlXG4gICAgICAgICAgICAvLyBsb2cgb25seSBjb250YWluZWQgdHJhbnNpZW50IGRhdGEsIHdlIGNhbiBkcm9wIGl0cyBvYmplY3Qgc3RvcmUuXG4gICAgICAgICAgICAhZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQub2JqZWN0U3RvcmVOYW1lcy5jb250YWlucyhcInJlbW90ZURvY3VtZW50Q2hhbmdlc1wiKSAmJiB0LmRlbGV0ZU9iamVjdFN0b3JlKFwicmVtb3RlRG9jdW1lbnRDaGFuZ2VzXCIpO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgICAgIC8vIE5vdGU6IFNjaGVtYSB2ZXJzaW9uIDkgdXNlZCB0byBjcmVhdGUgYSByZWFkIHRpbWUgaW5kZXggZm9yIHRoZVxuICAgICAgICAgICAgLy8gUmVtb3RlRG9jdW1lbnRDYWNoZS4gVGhpcyBpcyBub3cgZG9uZSB3aXRoIHNjaGVtYSB2ZXJzaW9uIDEzLlxuICAgICAgICAgICAgICAgIH0pKSksIG4gPCAxMCAmJiBzID49IDEwICYmIChyID0gci5uZXh0KCgoKSA9PiB0aGlzLnRpKGkpKSkpLCBuIDwgMTEgJiYgcyA+PSAxMSAmJiAociA9IHIubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiYnVuZGxlc1wiLCB7XG4gICAgICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiYnVuZGxlSWRcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KSwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJuYW1lZFF1ZXJpZXNcIiwge1xuICAgICAgICAgICAgICAgICAgICBrZXlQYXRoOiBcIm5hbWVcIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSh0KTtcbiAgICAgICAgfSkpKSwgbiA8IDEyICYmIHMgPj0gMTIgJiYgKHIgPSByLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJkb2N1bWVudE92ZXJsYXlzXCIsIHtcbiAgICAgICAgICAgICAgICAgICAga2V5UGF0aDogb2VcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvblBhdGhPdmVybGF5SW5kZXhcIiwgdWUsIHtcbiAgICAgICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgICAgIH0pLCBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvbkdyb3VwT3ZlcmxheUluZGV4XCIsIGNlLCB7XG4gICAgICAgICAgICAgICAgICAgIHVuaXF1ZTogITFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0odCk7XG4gICAgICAgIH0pKSksIG4gPCAxMyAmJiBzID49IDEzICYmIChyID0gci5uZXh0KCgoKSA9PiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdC5jcmVhdGVPYmplY3RTdG9yZShcInJlbW90ZURvY3VtZW50c1YxNFwiLCB7XG4gICAgICAgICAgICAgICAga2V5UGF0aDogSHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZS5jcmVhdGVJbmRleChcImRvY3VtZW50S2V5SW5kZXhcIiwgSnQpLCBlLmNyZWF0ZUluZGV4KFwiY29sbGVjdGlvbkdyb3VwSW5kZXhcIiwgWXQpO1xuICAgICAgICB9KHQpKSkubmV4dCgoKCkgPT4gdGhpcy5laSh0LCBpKSkpLm5leHQoKCgpID0+IHQuZGVsZXRlT2JqZWN0U3RvcmUoXCJyZW1vdGVEb2N1bWVudHNcIikpKSksIFxuICAgICAgICBuIDwgMTQgJiYgcyA+PSAxNCAmJiAociA9IHIubmV4dCgoKCkgPT4gdGhpcy5uaSh0LCBpKSkpKSwgbiA8IDE1ICYmIHMgPj0gMTUgJiYgKHIgPSByLm5leHQoKCgpID0+IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJpbmRleENvbmZpZ3VyYXRpb25cIiwge1xuICAgICAgICAgICAgICAgIGtleVBhdGg6IFwiaW5kZXhJZFwiLFxuICAgICAgICAgICAgICAgIGF1dG9JbmNyZW1lbnQ6ICEwXG4gICAgICAgICAgICB9KS5jcmVhdGVJbmRleChcImNvbGxlY3Rpb25Hcm91cEluZGV4XCIsIFwiY29sbGVjdGlvbkdyb3VwXCIsIHtcbiAgICAgICAgICAgICAgICB1bmlxdWU6ICExXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHQuY3JlYXRlT2JqZWN0U3RvcmUoXCJpbmRleFN0YXRlXCIsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBuZVxuICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgoXCJzZXF1ZW5jZU51bWJlckluZGV4XCIsIHNlLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwiaW5kZXhFbnRyaWVzXCIsIHtcbiAgICAgICAgICAgICAgICBrZXlQYXRoOiBpZVxuICAgICAgICAgICAgfSkuY3JlYXRlSW5kZXgoXCJkb2N1bWVudEtleUluZGV4XCIsIHJlLCB7XG4gICAgICAgICAgICAgICAgdW5pcXVlOiAhMVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0odCkpKSksIHI7XG4gICAgfVxuICAgIFlzKHQpIHtcbiAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICByZXR1cm4gdC5zdG9yZShcInJlbW90ZURvY3VtZW50c1wiKS5YKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgZSArPSBybyhuKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB7XG4gICAgICAgICAgICAgICAgYnl0ZVNpemU6IGVcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXR1cm4gdC5zdG9yZShcInJlbW90ZURvY3VtZW50R2xvYmFsXCIpLnB1dChcInJlbW90ZURvY3VtZW50R2xvYmFsS2V5XCIsIG4pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIEpzKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuc3RvcmUoXCJtdXRhdGlvblF1ZXVlc1wiKSwgbiA9IHQuc3RvcmUoXCJtdXRhdGlvbnNcIik7XG4gICAgICAgIHJldHVybiBlLmooKS5uZXh0KChlID0+IHZ0LmZvckVhY2goZSwgKGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IElEQktleVJhbmdlLmJvdW5kKFsgZS51c2VySWQsIC0xIF0sIFsgZS51c2VySWQsIGUubGFzdEFja25vd2xlZGdlZEJhdGNoSWQgXSk7XG4gICAgICAgICAgICByZXR1cm4gbi5qKFwidXNlck11dGF0aW9uc0luZGV4XCIsIHMpLm5leHQoKG4gPT4gdnQuZm9yRWFjaChuLCAobiA9PiB7XG4gICAgICAgICAgICAgICAgRihuLnVzZXJJZCA9PT0gZS51c2VySWQpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSB3cih0aGlzLnNlcmlhbGl6ZXIsIG4pO1xuICAgICAgICAgICAgICAgIHJldHVybiBpbyh0LCBlLnVzZXJJZCwgcykubmV4dCgoKCkgPT4ge30pKTtcbiAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICB9KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW5zdXJlcyB0aGF0IGV2ZXJ5IGRvY3VtZW50IGluIHRoZSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgaGFzIGEgY29ycmVzcG9uZGluZyBzZW50aW5lbCByb3dcbiAgICAgKiB3aXRoIGEgc2VxdWVuY2UgbnVtYmVyLiBNaXNzaW5nIHJvd3MgYXJlIGdpdmVuIHRoZSBtb3N0IHJlY2VudGx5IHVzZWQgc2VxdWVuY2UgbnVtYmVyLlxuICAgICAqLyAgICBYcyh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0LnN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIpLCBuID0gdC5zdG9yZShcInJlbW90ZURvY3VtZW50c1wiKTtcbiAgICAgICAgcmV0dXJuIHQuc3RvcmUoXCJ0YXJnZXRHbG9iYWxcIikuZ2V0KFwidGFyZ2V0R2xvYmFsS2V5XCIpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IFtdO1xuICAgICAgICAgICAgcmV0dXJuIG4uWCgoKG4sIGkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByID0gbmV3IHV0KG4pLCBvID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gWyAwLCBxdCh0KSBdO1xuICAgICAgICAgICAgICAgIH0ocik7XG4gICAgICAgICAgICAgICAgcy5wdXNoKGUuZ2V0KG8pLm5leHQoKG4gPT4gbiA/IHZ0LnJlc29sdmUoKSA6IChuID0+IGUucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0SWQ6IDAsXG4gICAgICAgICAgICAgICAgICAgIHBhdGg6IHF0KG4pLFxuICAgICAgICAgICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogdC5oaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXJcbiAgICAgICAgICAgICAgICB9KSkocikpKSk7XG4gICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gdnQud2FpdEZvcihzKSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFpzKHQsIGUpIHtcbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBpbmRleC5cbiAgICAgICAgdC5jcmVhdGVPYmplY3RTdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIsIHtcbiAgICAgICAgICAgIGtleVBhdGg6IGVlXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBuID0gZS5zdG9yZShcImNvbGxlY3Rpb25QYXJlbnRzXCIpLCBzID0gbmV3IFdyLCBpID0gdCA9PiB7XG4gICAgICAgICAgICBpZiAocy5hZGQodCkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdC5sYXN0U2VnbWVudCgpLCBzID0gdC5wb3BMYXN0KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucHV0KHtcbiAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbklkOiBlLFxuICAgICAgICAgICAgICAgICAgICBwYXJlbnQ6IHF0KHMpXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIC8vIEhlbHBlciB0byBhZGQgYW4gaW5kZXggZW50cnkgaWZmIHdlIGhhdmVuJ3QgYWxyZWFkeSB3cml0dGVuIGl0LlxuICAgICAgICAgICAgICAgIC8vIEluZGV4IGV4aXN0aW5nIHJlbW90ZSBkb2N1bWVudHMuXG4gICAgICAgIHJldHVybiBlLnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLlgoe1xuICAgICAgICAgICAgWTogITBcbiAgICAgICAgfSwgKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gbmV3IHV0KHQpO1xuICAgICAgICAgICAgcmV0dXJuIGkobi5wb3BMYXN0KCkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gZS5zdG9yZShcImRvY3VtZW50TXV0YXRpb25zXCIpLlgoe1xuICAgICAgICAgICAgWTogITBcbiAgICAgICAgfSwgKChbdCwgZSwgbl0sIHMpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBHdChlKTtcbiAgICAgICAgICAgIHJldHVybiBpKHIucG9wTGFzdCgpKTtcbiAgICAgICAgfSkpKSk7XG4gICAgfVxuICAgIHRpKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuc3RvcmUoXCJ0YXJnZXRzXCIpO1xuICAgICAgICByZXR1cm4gZS5YKCgodCwgbikgPT4ge1xuICAgICAgICAgICAgY29uc3QgcyA9IG1yKG4pLCBpID0gZ3IodGhpcy5zZXJpYWxpemVyLCBzKTtcbiAgICAgICAgICAgIHJldHVybiBlLnB1dChpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBlaSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlLnN0b3JlKFwicmVtb3RlRG9jdW1lbnRzXCIpLCBzID0gW107XG4gICAgICAgIHJldHVybiBuLlgoKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBpID0gZS5zdG9yZShcInJlbW90ZURvY3VtZW50c1YxNFwiKSwgciA9IChvID0gbiwgby5kb2N1bWVudCA/IG5ldyBodCh1dC5mcm9tU3RyaW5nKG8uZG9jdW1lbnQubmFtZSkucG9wRmlyc3QoNSkpIDogby5ub0RvY3VtZW50ID8gaHQuZnJvbVNlZ21lbnRzKG8ubm9Eb2N1bWVudC5wYXRoKSA6IG8udW5rbm93bkRvY3VtZW50ID8gaHQuZnJvbVNlZ21lbnRzKG8udW5rbm93bkRvY3VtZW50LnBhdGgpIDogJCgpKS5wYXRoLnRvQXJyYXkoKTtcbiAgICAgICAgICAgIHZhciBvO1xuICAgICAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gICAgICAgICAgICBjb25zdCB1ID0ge1xuICAgICAgICAgICAgICAgIHByZWZpeFBhdGg6IHIuc2xpY2UoMCwgci5sZW5ndGggLSAyKSxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uR3JvdXA6IHJbci5sZW5ndGggLSAyXSxcbiAgICAgICAgICAgICAgICBkb2N1bWVudElkOiByW3IubGVuZ3RoIC0gMV0sXG4gICAgICAgICAgICAgICAgcmVhZFRpbWU6IG4ucmVhZFRpbWUgfHwgWyAwLCAwIF0sXG4gICAgICAgICAgICAgICAgdW5rbm93bkRvY3VtZW50OiBuLnVua25vd25Eb2N1bWVudCxcbiAgICAgICAgICAgICAgICBub0RvY3VtZW50OiBuLm5vRG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IG4uZG9jdW1lbnQsXG4gICAgICAgICAgICAgICAgaGFzQ29tbWl0dGVkTXV0YXRpb25zOiAhIW4uaGFzQ29tbWl0dGVkTXV0YXRpb25zXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcy5wdXNoKGkucHV0KHUpKTtcbiAgICAgICAgfSkpLm5leHQoKCgpID0+IHZ0LndhaXRGb3IocykpKTtcbiAgICB9XG4gICAgbmkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gZS5zdG9yZShcIm11dGF0aW9uc1wiKSwgcyA9IFBvKHRoaXMuc2VyaWFsaXplciksIGkgPSBuZXcgS28oUW8uanMsIHRoaXMuc2VyaWFsaXplci5sZSk7XG4gICAgICAgIHJldHVybiBuLmooKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgTWFwO1xuICAgICAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGU7XG4gICAgICAgICAgICAgICAgbGV0IHMgPSBudWxsICE9PSAoZSA9IG4uZ2V0KHQudXNlcklkKSkgJiYgdm9pZCAwICE9PSBlID8gZSA6IGdzKCk7XG4gICAgICAgICAgICAgICAgd3IodGhpcy5zZXJpYWxpemVyLCB0KS5rZXlzKCkuZm9yRWFjaCgodCA9PiBzID0gcy5hZGQodCkpKSwgbi5zZXQodC51c2VySWQsIHMpO1xuICAgICAgICAgICAgfSkpLCB2dC5mb3JFYWNoKG4sICgodCwgbikgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuZXcgVihuKSwgbyA9IHZyLmZlKHRoaXMuc2VyaWFsaXplciwgciksIHUgPSBpLmdldEluZGV4TWFuYWdlcihyKSwgYyA9IG9vLmZlKHIsIHRoaXMuc2VyaWFsaXplciwgdSwgaS5yZWZlcmVuY2VEZWxlZ2F0ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBrbyhzLCBjLCBvLCB1KS5yZWNhbGN1bGF0ZUFuZFNhdmVPdmVybGF5c0ZvckRvY3VtZW50S2V5cyhuZXcgX2UoZSwgJHQuY3QpLCB0KS5uZXh0KCk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIFdvKHQpIHtcbiAgICB0LmNyZWF0ZU9iamVjdFN0b3JlKFwidGFyZ2V0RG9jdW1lbnRzXCIsIHtcbiAgICAgICAga2V5UGF0aDogWnRcbiAgICB9KS5jcmVhdGVJbmRleChcImRvY3VtZW50VGFyZ2V0c0luZGV4XCIsIHRlLCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KTtcbiAgICAvLyBOT1RFOiBUaGlzIGlzIHVuaXF1ZSBvbmx5IGJlY2F1c2UgdGhlIFRhcmdldElkIGlzIHRoZSBzdWZmaXguXG4gICAgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldHNcIiwge1xuICAgICAgICBrZXlQYXRoOiBcInRhcmdldElkXCJcbiAgICB9KS5jcmVhdGVJbmRleChcInF1ZXJ5VGFyZ2V0c0luZGV4XCIsIFh0LCB7XG4gICAgICAgIHVuaXF1ZTogITBcbiAgICB9KSwgdC5jcmVhdGVPYmplY3RTdG9yZShcInRhcmdldEdsb2JhbFwiKTtcbn1cblxuY29uc3QgSG8gPSBcIkZhaWxlZCB0byBvYnRhaW4gZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgcGVyc2lzdGVuY2UgbGF5ZXIuIFRvIGFsbG93IHNoYXJlZCBhY2Nlc3MsIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24gaGFzIHRvIGJlIGVuYWJsZWQgaW4gYWxsIHRhYnMuIElmIHlvdSBhcmUgdXNpbmcgYGV4cGVyaW1lbnRhbEZvcmNlT3duaW5nVGFiOnRydWVgLCBtYWtlIHN1cmUgdGhhdCBvbmx5IG9uZSB0YWIgaGFzIHBlcnNpc3RlbmNlIGVuYWJsZWQgYXQgYW55IGdpdmVuIHRpbWUuXCI7XG5cbi8qKlxuICogT2xkZXN0IGFjY2VwdGFibGUgYWdlIGluIG1pbGxpc2Vjb25kcyBmb3IgY2xpZW50IG1ldGFkYXRhIGJlZm9yZSB0aGUgY2xpZW50XG4gKiBpcyBjb25zaWRlcmVkIGluYWN0aXZlIGFuZCBpdHMgYXNzb2NpYXRlZCBkYXRhIGlzIGdhcmJhZ2UgY29sbGVjdGVkLlxuICovXG4vKipcbiAqIEFuIEluZGV4ZWREQi1iYWNrZWQgaW5zdGFuY2Ugb2YgUGVyc2lzdGVuY2UuIERhdGEgaXMgc3RvcmVkIHBlcnNpc3RlbnRseVxuICogYWNyb3NzIHNlc3Npb25zLlxuICpcbiAqIE9uIFdlYiBvbmx5LCB0aGUgRmlyZXN0b3JlIFNES3Mgc3VwcG9ydCBzaGFyZWQgYWNjZXNzIHRvIGl0cyBwZXJzaXN0ZW5jZVxuICogbGF5ZXIuIFRoaXMgYWxsb3dzIG11bHRpcGxlIGJyb3dzZXIgdGFicyB0byByZWFkIGFuZCB3cml0ZSB0byBJbmRleGVkRGIgYW5kXG4gKiB0byBzeW5jaHJvbml6ZSBzdGF0ZSBldmVuIHdpdGhvdXQgbmV0d29yayBjb25uZWN0aXZpdHkuIFNoYXJlZCBhY2Nlc3MgaXNcbiAqIGN1cnJlbnRseSBvcHRpb25hbCBhbmQgbm90IGVuYWJsZWQgdW5sZXNzIGFsbCBjbGllbnRzIGludm9rZVxuICogYGVuYWJsZVBlcnNpc3RlbmNlKClgIHdpdGggYHtzeW5jaHJvbml6ZVRhYnM6dHJ1ZX1gLlxuICpcbiAqIEluIG11bHRpLXRhYiBtb2RlLCBpZiBtdWx0aXBsZSBjbGllbnRzIGFyZSBhY3RpdmUgYXQgdGhlIHNhbWUgdGltZSwgdGhlIFNES1xuICogd2lsbCBkZXNpZ25hdGUgb25lIGNsaWVudCBhcyB0aGUg4oCccHJpbWFyeSBjbGllbnTigJ0uIEFuIGVmZm9ydCBpcyBtYWRlIHRvIHBpY2tcbiAqIGEgdmlzaWJsZSwgbmV0d29yay1jb25uZWN0ZWQgYW5kIGFjdGl2ZSBjbGllbnQsIGFuZCB0aGlzIGNsaWVudCBpc1xuICogcmVzcG9uc2libGUgZm9yIGxldHRpbmcgb3RoZXIgY2xpZW50cyBrbm93IGFib3V0IGl0cyBwcmVzZW5jZS4gVGhlIHByaW1hcnlcbiAqIGNsaWVudCB3cml0ZXMgYSB1bmlxdWUgY2xpZW50LWdlbmVyYXRlZCBpZGVudGlmaWVyICh0aGUgY2xpZW50IElEKSB0b1xuICogSW5kZXhlZERi4oCZcyDigJxvd25lcuKAnSBzdG9yZSBldmVyeSA0IHNlY29uZHMuIElmIHRoZSBwcmltYXJ5IGNsaWVudCBmYWlscyB0b1xuICogdXBkYXRlIHRoaXMgZW50cnksIGFub3RoZXIgY2xpZW50IGNhbiBhY3F1aXJlIHRoZSBsZWFzZSBhbmQgdGFrZSBvdmVyIGFzXG4gKiBwcmltYXJ5LlxuICpcbiAqIFNvbWUgcGVyc2lzdGVuY2Ugb3BlcmF0aW9ucyBpbiB0aGUgU0RLIGFyZSBkZXNpZ25hdGVkIGFzIHByaW1hcnktY2xpZW50IG9ubHlcbiAqIG9wZXJhdGlvbnMuIFRoaXMgaW5jbHVkZXMgdGhlIGFja25vd2xlZGdtZW50IG9mIG11dGF0aW9ucyBhbmQgYWxsIHVwZGF0ZXMgb2ZcbiAqIHJlbW90ZSBkb2N1bWVudHMuIFRoZSBlZmZlY3RzIG9mIHRoZXNlIG9wZXJhdGlvbnMgYXJlIHdyaXR0ZW4gdG8gcGVyc2lzdGVuY2VcbiAqIGFuZCB0aGVuIGJyb2FkY2FzdCB0byBvdGhlciB0YWJzIHZpYSBMb2NhbFN0b3JhZ2UgKHNlZVxuICogYFdlYlN0b3JhZ2VTaGFyZWRDbGllbnRTdGF0ZWApLCB3aGljaCB0aGVuIHJlZnJlc2ggdGhlaXIgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogU2ltaWxhcmx5LCB0aGUgcHJpbWFyeSBjbGllbnQgbGlzdGVucyB0byBub3RpZmljYXRpb25zIHNlbnQgYnkgc2Vjb25kYXJ5XG4gKiBjbGllbnRzIHRvIGRpc2NvdmVyIHBlcnNpc3RlbmNlIGNoYW5nZXMgd3JpdHRlbiBieSBzZWNvbmRhcnkgY2xpZW50cywgc3VjaCBhc1xuICogdGhlIGFkZGl0aW9uIG9mIG5ldyBtdXRhdGlvbnMgYW5kIHF1ZXJ5IHRhcmdldHMuXG4gKlxuICogSWYgbXVsdGktdGFiIGlzIG5vdCBlbmFibGVkIGFuZCBhbm90aGVyIHRhYiBhbHJlYWR5IG9idGFpbmVkIHRoZSBwcmltYXJ5XG4gKiBsZWFzZSwgSW5kZXhlZERiUGVyc2lzdGVuY2UgZW50ZXJzIGEgZmFpbGVkIHN0YXRlIGFuZCBhbGwgc3Vic2VxdWVudFxuICogb3BlcmF0aW9ucyB3aWxsIGF1dG9tYXRpY2FsbHkgZmFpbC5cbiAqXG4gKiBBZGRpdGlvbmFsbHksIHRoZXJlIGlzIGFuIG9wdGltaXphdGlvbiBzbyB0aGF0IHdoZW4gYSB0YWIgaXMgY2xvc2VkLCB0aGVcbiAqIHByaW1hcnkgbGVhc2UgaXMgcmVsZWFzZWQgaW1tZWRpYXRlbHkgKHRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgdG8gbWFrZVxuICogc3VyZSB0aGF0IGEgcmVmcmVzaGVkIHRhYiBpcyBhYmxlIHRvIGltbWVkaWF0ZWx5IHJlLWFjcXVpcmUgdGhlIHByaW1hcnlcbiAqIGxlYXNlKS4gVW5mb3J0dW5hdGVseSwgSW5kZXhlZERCIGNhbm5vdCBiZSByZWxpYWJseSB1c2VkIGluIHdpbmRvdy51bmxvYWRcbiAqIHNpbmNlIGl0IGlzIGFuIGFzeW5jaHJvbm91cyBBUEkuIFNvIGluIGFkZGl0aW9uIHRvIGF0dGVtcHRpbmcgdG8gZ2l2ZSB1cCB0aGVcbiAqIGxlYXNlLCB0aGUgbGVhc2Vob2xkZXIgd3JpdGVzIGl0cyBjbGllbnQgSUQgdG8gYSBcInpvbWJpZWRDbGllbnRcIiBlbnRyeSBpblxuICogTG9jYWxTdG9yYWdlIHdoaWNoIGFjdHMgYXMgYW4gaW5kaWNhdG9yIHRoYXQgYW5vdGhlciB0YWIgc2hvdWxkIGdvIGFoZWFkIGFuZFxuICogdGFrZSB0aGUgcHJpbWFyeSBsZWFzZSBpbW1lZGlhdGVseSByZWdhcmRsZXNzIG9mIHRoZSBjdXJyZW50IGxlYXNlIHRpbWVzdGFtcC5cbiAqXG4gKiBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIGBzeW5jaHJvbml6ZVRhYnNgIHNlY3Rpb24gd2hlbiBtdWx0aS10YWIgaXMgbm9cbiAqIGxvbmdlciBvcHRpb25hbC5cbiAqL1xuY2xhc3MgSm8ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgdG8gc3luY2hyb25pemUgdGhlIGluLW1lbW9yeSBzdGF0ZSBvZiBtdWx0aXBsZSB0YWJzIGFuZCBzaGFyZVxuICAgICAqIGFjY2VzcyB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAgICAgKi9cbiAgICB0LCBlLCBuLCBzLCBpLCByLCBvLCB1LCBjLCBcbiAgICAvKipcbiAgICAgKiBJZiBzZXQgdG8gdHJ1ZSwgZm9yY2VmdWxseSBvYnRhaW5zIGRhdGFiYXNlIGFjY2Vzcy4gRXhpc3RpbmcgdGFicyB3aWxsXG4gICAgICogbm8gbG9uZ2VyIGJlIGFibGUgdG8gYWNjZXNzIEluZGV4ZWREQi5cbiAgICAgKi9cbiAgICBhLCBoID0gMTUpIHtcbiAgICAgICAgaWYgKHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gPSB0LCB0aGlzLnBlcnNpc3RlbmNlS2V5ID0gZSwgdGhpcy5jbGllbnRJZCA9IG4sIFxuICAgICAgICB0aGlzLnNpID0gaSwgdGhpcy53aW5kb3cgPSByLCB0aGlzLmRvY3VtZW50ID0gbywgdGhpcy5paSA9IGMsIHRoaXMucmkgPSBhLCB0aGlzLm9pID0gaCwgXG4gICAgICAgIHRoaXMuT3MgPSBudWxsLCB0aGlzLiRzID0gITEsIHRoaXMuaXNQcmltYXJ5ID0gITEsIHRoaXMubmV0d29ya0VuYWJsZWQgPSAhMCwgXG4gICAgICAgIC8qKiBPdXIgd2luZG93LnVubG9hZCBoYW5kbGVyLCBpZiByZWdpc3RlcmVkLiAqL1xuICAgICAgICB0aGlzLnVpID0gbnVsbCwgdGhpcy5pbkZvcmVncm91bmQgPSAhMSwgXG4gICAgICAgIC8qKiBPdXIgJ3Zpc2liaWxpdHljaGFuZ2UnIGxpc3RlbmVyIGlmIHJlZ2lzdGVyZWQuICovXG4gICAgICAgIHRoaXMuY2kgPSBudWxsLCBcbiAgICAgICAgLyoqIFRoZSBjbGllbnQgbWV0YWRhdGEgcmVmcmVzaCB0YXNrLiAqL1xuICAgICAgICB0aGlzLmFpID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCB0aW1lIHdlIGdhcmJhZ2UgY29sbGVjdGVkIHRoZSBjbGllbnQgbWV0YWRhdGEgb2JqZWN0IHN0b3JlLiAqL1xuICAgICAgICB0aGlzLmhpID0gTnVtYmVyLk5FR0FUSVZFX0lORklOSVRZLCBcbiAgICAgICAgLyoqIEEgbGlzdGVuZXIgdG8gbm90aWZ5IG9uIHByaW1hcnkgc3RhdGUgY2hhbmdlcy4gKi9cbiAgICAgICAgdGhpcy5saSA9IHQgPT4gUHJvbWlzZS5yZXNvbHZlKCksICFKby5EKCkpIHRocm93IG5ldyBVKHEuVU5JTVBMRU1FTlRFRCwgXCJUaGlzIHBsYXRmb3JtIGlzIGVpdGhlciBtaXNzaW5nIEluZGV4ZWREQiBvciBpcyBrbm93biB0byBoYXZlIGFuIGluY29tcGxldGUgaW1wbGVtZW50YXRpb24uIE9mZmxpbmUgcGVyc2lzdGVuY2UgaGFzIGJlZW4gZGlzYWJsZWQuXCIpO1xuICAgICAgICB0aGlzLnJlZmVyZW5jZURlbGVnYXRlID0gbmV3IEVvKHRoaXMsIHMpLCB0aGlzLmZpID0gZSArIFwibWFpblwiLCB0aGlzLnNlcmlhbGl6ZXIgPSBuZXcgYXIodSksIFxuICAgICAgICB0aGlzLmRpID0gbmV3IGJ0KHRoaXMuZmksIHRoaXMub2ksIG5ldyB6byh0aGlzLnNlcmlhbGl6ZXIpKSwgdGhpcy5GcyA9IG5ldyBmbyh0aGlzLnJlZmVyZW5jZURlbGVnYXRlLCB0aGlzLnNlcmlhbGl6ZXIpLCBcbiAgICAgICAgdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlID0gUG8odGhpcy5zZXJpYWxpemVyKSwgdGhpcy5McyA9IG5ldyBFciwgdGhpcy53aW5kb3cgJiYgdGhpcy53aW5kb3cubG9jYWxTdG9yYWdlID8gdGhpcy5faSA9IHRoaXMud2luZG93LmxvY2FsU3RvcmFnZSA6ICh0aGlzLl9pID0gbnVsbCwgXG4gICAgICAgICExID09PSBhICYmIGsoXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIkxvY2FsU3RvcmFnZSBpcyB1bmF2YWlsYWJsZS4gQXMgYSByZXN1bHQsIHBlcnNpc3RlbmNlIG1heSBub3Qgd29yayByZWxpYWJseS4gSW4gcGFydGljdWxhciBlbmFibGVQZXJzaXN0ZW5jZSgpIGNvdWxkIGZhaWwgaW1tZWRpYXRlbHkgYWZ0ZXIgcmVmcmVzaGluZyB0aGUgcGFnZS5cIikpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0IHRvIHN0YXJ0IEluZGV4ZWREYiBwZXJzaXN0ZW5jZS5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFdoZXRoZXIgcGVyc2lzdGVuY2Ugd2FzIGVuYWJsZWQuXG4gICAgICovICAgIHN0YXJ0KCkge1xuICAgICAgICAvLyBOT1RFOiBUaGlzIGlzIGV4cGVjdGVkIHRvIGZhaWwgc29tZXRpbWVzIChpbiB0aGUgY2FzZSBvZiBhbm90aGVyIHRhYlxuICAgICAgICAvLyBhbHJlYWR5IGhhdmluZyB0aGUgcGVyc2lzdGVuY2UgbG9jayksIHNvIGl0J3MgdGhlIGZpcnN0IHRoaW5nIHdlIHNob3VsZFxuICAgICAgICAvLyBkby5cbiAgICAgICAgcmV0dXJuIHRoaXMud2koKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNQcmltYXJ5ICYmICF0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSBcbiAgICAgICAgICAgIC8vIEZhaWwgYHN0YXJ0KClgIGlmIGBzeW5jaHJvbml6ZVRhYnNgIGlzIGRpc2FibGVkIGFuZCB3ZSBjYW5ub3RcbiAgICAgICAgICAgIC8vIG9idGFpbiB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICAgICAgICAgIHRocm93IG5ldyBVKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgSG8pO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubWkoKSwgdGhpcy5naSgpLCB0aGlzLnlpKCksIHRoaXMucnVuVHJhbnNhY3Rpb24oXCJnZXRIaWdoZXN0TGlzdGVuU2VxdWVuY2VOdW1iZXJcIiwgXCJyZWFkb25seVwiLCAodCA9PiB0aGlzLkZzLmdldEhpZ2hlc3RTZXF1ZW5jZU51bWJlcih0KSkpO1xuICAgICAgICB9KSkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0aGlzLk9zID0gbmV3ICR0KHQsIHRoaXMuaWkpO1xuICAgICAgICB9KSkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4kcyA9ICEwO1xuICAgICAgICB9KSkuY2F0Y2goKHQgPT4gKHRoaXMuZGkgJiYgdGhpcy5kaS5jbG9zZSgpLCBQcm9taXNlLnJlamVjdCh0KSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGEgbGlzdGVuZXIgdGhhdCBnZXRzIGNhbGxlZCB3aGVuIHRoZSBwcmltYXJ5IHN0YXRlIG9mIHRoZVxuICAgICAqIGluc3RhbmNlIGNoYW5nZXMuIFVwb24gcmVnaXN0ZXJpbmcsIHRoaXMgbGlzdGVuZXIgaXMgaW52b2tlZCBpbW1lZGlhdGVseVxuICAgICAqIHdpdGggdGhlIGN1cnJlbnQgcHJpbWFyeSBzdGF0ZS5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIHBpKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubGkgPSBhc3luYyBlID0+IHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN0YXJ0ZWQpIHJldHVybiB0KGUpO1xuICAgICAgICB9LCB0KHRoaXMuaXNQcmltYXJ5KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVnaXN0ZXJzIGEgbGlzdGVuZXIgdGhhdCBnZXRzIGNhbGxlZCB3aGVuIHRoZSBkYXRhYmFzZSByZWNlaXZlcyBhXG4gICAgICogdmVyc2lvbiBjaGFuZ2UgZXZlbnQgaW5kaWNhdGluZyB0aGF0IGl0IGhhcyBkZWxldGVkLlxuICAgICAqXG4gICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgV2ViIG11bHRpLXRhYi5cbiAgICAgKi8gICAgc2V0RGF0YWJhc2VEZWxldGVkTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLmRpLkIoKGFzeW5jIGUgPT4ge1xuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYW4gYXR0ZW1wdCBpcyBtYWRlIHRvIGRlbGV0ZSBJbmRleGVkREIuXG4gICAgICAgICAgICBudWxsID09PSBlLm5ld1ZlcnNpb24gJiYgYXdhaXQgdCgpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFkanVzdHMgdGhlIGN1cnJlbnQgbmV0d29yayBzdGF0ZSBpbiB0aGUgY2xpZW50J3MgbWV0YWRhdGEsIHBvdGVudGlhbGx5XG4gICAgICogYWZmZWN0aW5nIHRoZSBwcmltYXJ5IGxlYXNlLlxuICAgICAqXG4gICAgICogUE9SVElORyBOT1RFOiBUaGlzIGlzIG9ubHkgdXNlZCBmb3IgV2ViIG11bHRpLXRhYi5cbiAgICAgKi8gICAgc2V0TmV0d29ya0VuYWJsZWQodCkge1xuICAgICAgICB0aGlzLm5ldHdvcmtFbmFibGVkICE9PSB0ICYmICh0aGlzLm5ldHdvcmtFbmFibGVkID0gdCwgXG4gICAgICAgIC8vIFNjaGVkdWxlIGEgcHJpbWFyeSBsZWFzZSByZWZyZXNoIGZvciBpbW1lZGlhdGUgZXhlY3V0aW9uLiBUaGUgZXZlbnR1YWxcbiAgICAgICAgLy8gbGVhc2UgdXBkYXRlIHdpbGwgYmUgcHJvcGFnYXRlZCB2aWEgYHByaW1hcnlTdGF0ZUxpc3RlbmVyYC5cbiAgICAgICAgdGhpcy5zaS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXJ0ZWQgJiYgYXdhaXQgdGhpcy53aSgpO1xuICAgICAgICB9KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBVcGRhdGVzIHRoZSBjbGllbnQgbWV0YWRhdGEgaW4gSW5kZXhlZERiIGFuZCBhdHRlbXB0cyB0byBlaXRoZXIgb2J0YWluIG9yXG4gICAgICogZXh0ZW5kIHRoZSBwcmltYXJ5IGxlYXNlIGZvciB0aGUgbG9jYWwgY2xpZW50LiBBc3luY2hyb25vdXNseSBub3RpZmllcyB0aGVcbiAgICAgKiBwcmltYXJ5IHN0YXRlIGxpc3RlbmVyIGlmIHRoZSBjbGllbnQgZWl0aGVyIG5ld2x5IG9idGFpbmVkIG9yIHJlbGVhc2VkIGl0c1xuICAgICAqIHByaW1hcnkgbGVhc2UuXG4gICAgICovICAgIHdpKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ydW5UcmFuc2FjdGlvbihcInVwZGF0ZUNsaWVudE1ldGFkYXRhQW5kVHJ5QmVjb21lUHJpbWFyeVwiLCBcInJlYWR3cml0ZVwiLCAodCA9PiBYbyh0KS5wdXQoe1xuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuY2xpZW50SWQsXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KCksXG4gICAgICAgICAgICBuZXR3b3JrRW5hYmxlZDogdGhpcy5uZXR3b3JrRW5hYmxlZCxcbiAgICAgICAgICAgIGluRm9yZWdyb3VuZDogdGhpcy5pbkZvcmVncm91bmRcbiAgICAgICAgfSkubmV4dCgoKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmltYXJ5KSByZXR1cm4gdGhpcy5JaSh0KS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICB0IHx8ICh0aGlzLmlzUHJpbWFyeSA9ICExLCB0aGlzLnNpLmVucXVldWVSZXRyeWFibGUoKCgpID0+IHRoaXMubGkoITEpKSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkubmV4dCgoKCkgPT4gdGhpcy5UaSh0KSkpLm5leHQoKGUgPT4gdGhpcy5pc1ByaW1hcnkgJiYgIWUgPyB0aGlzLkVpKHQpLm5leHQoKCgpID0+ICExKSkgOiAhIWUgJiYgdGhpcy5BaSh0KS5uZXh0KCgoKSA9PiAhMCkpKSkpKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICBpZiAoRHQodCkpIFxuICAgICAgICAgICAgLy8gUHJvY2VlZCB3aXRoIHRoZSBleGlzdGluZyBzdGF0ZS4gQW55IHN1YnNlcXVlbnQgYWNjZXNzIHRvXG4gICAgICAgICAgICAvLyBJbmRleGVkREIgd2lsbCB2ZXJpZnkgdGhlIGxlYXNlLlxuICAgICAgICAgICAgcmV0dXJuIE4oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIkZhaWxlZCB0byBleHRlbmQgb3duZXIgbGVhc2U6IFwiLCB0KSwgdGhpcy5pc1ByaW1hcnk7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24pIHRocm93IHQ7XG4gICAgICAgICAgICByZXR1cm4gTihcIkluZGV4ZWREYlBlcnNpc3RlbmNlXCIsIFwiUmVsZWFzaW5nIG93bmVyIGxlYXNlIGFmdGVyIGVycm9yIGR1cmluZyBsZWFzZSByZWZyZXNoXCIsIHQpLCBcbiAgICAgICAgICAgIC8qIGlzUHJpbWFyeT0gKi8gITE7XG4gICAgICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuaXNQcmltYXJ5ICE9PSB0ICYmIHRoaXMuc2kuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5saSh0KSkpLCB0aGlzLmlzUHJpbWFyeSA9IHQ7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgSWkodCkge1xuICAgICAgICByZXR1cm4gWW8odCkuZ2V0KFwib3duZXJcIikubmV4dCgodCA9PiB2dC5yZXNvbHZlKHRoaXMuUmkodCkpKSk7XG4gICAgfVxuICAgIHZpKHQpIHtcbiAgICAgICAgcmV0dXJuIFhvKHQpLmRlbGV0ZSh0aGlzLmNsaWVudElkKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSWYgdGhlIGdhcmJhZ2UgY29sbGVjdGlvbiB0aHJlc2hvbGQgaGFzIHBhc3NlZCwgcHJ1bmVzIHRoZVxuICAgICAqIFJlbW90ZURvY3VtZW50Q2hhbmdlcyBhbmQgdGhlIENsaWVudE1ldGFkYXRhIHN0b3JlIGJhc2VkIG9uIHRoZSBsYXN0IHVwZGF0ZVxuICAgICAqIHRpbWUgb2YgYWxsIGNsaWVudHMuXG4gICAgICovICAgIGFzeW5jIFBpKCkge1xuICAgICAgICBpZiAodGhpcy5pc1ByaW1hcnkgJiYgIXRoaXMuYmkodGhpcy5oaSwgMThlNSkpIHtcbiAgICAgICAgICAgIHRoaXMuaGkgPSBEYXRlLm5vdygpO1xuICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IHRoaXMucnVuVHJhbnNhY3Rpb24oXCJtYXliZUdhcmJhZ2VDb2xsZWN0TXVsdGlDbGllbnRTdGF0ZVwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gd2UodCwgXCJjbGllbnRNZXRhZGF0YVwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZS5qKCkubmV4dCgodCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLlZpKHQsIDE4ZTUpLCBzID0gdC5maWx0ZXIoKHQgPT4gLTEgPT09IG4uaW5kZXhPZih0KSkpO1xuICAgICAgICAgICAgICAgICAgICAvLyBEZWxldGUgbWV0YWRhdGEgZm9yIGNsaWVudHMgdGhhdCBhcmUgbm8gbG9uZ2VyIGNvbnNpZGVyZWQgYWN0aXZlLlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdnQuZm9yRWFjaChzLCAodCA9PiBlLmRlbGV0ZSh0LmNsaWVudElkKSkpLm5leHQoKCgpID0+IHMpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSkuY2F0Y2goKCgpID0+IFtdKSk7XG4gICAgICAgICAgICAvLyBEZWxldGUgcG90ZW50aWFsIGxlZnRvdmVyIGVudHJpZXMgdGhhdCBtYXkgY29udGludWUgdG8gbWFyayB0aGVcbiAgICAgICAgICAgIC8vIGluYWN0aXZlIGNsaWVudHMgYXMgem9tYmllZCBpbiBMb2NhbFN0b3JhZ2UuXG4gICAgICAgICAgICAvLyBJZGVhbGx5IHdlJ2QgZGVsZXRlIHRoZSBJbmRleGVkRGIgYW5kIExvY2FsU3RvcmFnZSB6b21iaWUgZW50cmllcyBmb3JcbiAgICAgICAgICAgIC8vIHRoZSBjbGllbnQgYXRvbWljYWxseSwgYnV0IHdlIGNhbid0LiBTbyB3ZSBvcHQgdG8gZGVsZXRlIHRoZSBJbmRleGVkRGJcbiAgICAgICAgICAgIC8vIGVudHJpZXMgZmlyc3QgdG8gYXZvaWQgcG90ZW50aWFsbHkgcmV2aXZpbmcgYSB6b21iaWVkIGNsaWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9pKSBmb3IgKGNvbnN0IGUgb2YgdCkgdGhpcy5faS5yZW1vdmVJdGVtKHRoaXMuU2koZS5jbGllbnRJZCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFNjaGVkdWxlcyBhIHJlY3VycmluZyB0aW1lciB0byB1cGRhdGUgdGhlIGNsaWVudCBtZXRhZGF0YSBhbmQgdG8gZWl0aGVyXG4gICAgICogZXh0ZW5kIG9yIGFjcXVpcmUgdGhlIHByaW1hcnkgbGVhc2UgaWYgdGhlIGNsaWVudCBpcyBlbGlnaWJsZS5cbiAgICAgKi8gICAgeWkoKSB7XG4gICAgICAgIHRoaXMuYWkgPSB0aGlzLnNpLmVucXVldWVBZnRlckRlbGF5KFwiY2xpZW50X21ldGFkYXRhX3JlZnJlc2hcIiAvKiBUaW1lcklkLkNsaWVudE1ldGFkYXRhUmVmcmVzaCAqLyAsIDRlMywgKCgpID0+IHRoaXMud2koKS50aGVuKCgoKSA9PiB0aGlzLlBpKCkpKS50aGVuKCgoKSA9PiB0aGlzLnlpKCkpKSkpO1xuICAgIH1cbiAgICAvKiogQ2hlY2tzIHdoZXRoZXIgYGNsaWVudGAgaXMgdGhlIGxvY2FsIGNsaWVudC4gKi8gICAgUmkodCkge1xuICAgICAgICByZXR1cm4gISF0ICYmIHQub3duZXJJZCA9PT0gdGhpcy5jbGllbnRJZDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRXZhbHVhdGUgdGhlIHN0YXRlIG9mIGFsbCBhY3RpdmUgY2xpZW50cyBhbmQgZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIGxvY2FsXG4gICAgICogY2xpZW50IGlzIG9yIGNhbiBhY3QgYXMgdGhlIGhvbGRlciBvZiB0aGUgcHJpbWFyeSBsZWFzZS4gUmV0dXJucyB3aGV0aGVyXG4gICAgICogdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIGxlYXNlLCBidXQgZG9lcyBub3QgYWN0dWFsbHkgYWNxdWlyZSBpdC5cbiAgICAgKiBNYXkgcmV0dXJuICdmYWxzZScgZXZlbiBpZiB0aGVyZSBpcyBubyBhY3RpdmUgbGVhc2Vob2xkZXIgYW5kIGFub3RoZXJcbiAgICAgKiAoZm9yZWdyb3VuZCkgY2xpZW50IHNob3VsZCBiZWNvbWUgbGVhc2Vob2xkZXIgaW5zdGVhZC5cbiAgICAgKi8gICAgVGkodCkge1xuICAgICAgICBpZiAodGhpcy5yaSkgcmV0dXJuIHZ0LnJlc29sdmUoITApO1xuICAgICAgICByZXR1cm4gWW8odCkuZ2V0KFwib3duZXJcIikubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAvLyBBIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhlIHByaW1hcnkgbGVhc2UgaWY6XG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIHRoZSBjbGllbnQncyB0YWIgaXMgaW4gdGhlIGZvcmVncm91bmQuXG4gICAgICAgICAgICAvLyAtIGl0cyBuZXR3b3JrIGlzIGVuYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpbiB0aGVcbiAgICAgICAgICAgIC8vICAgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gZXZlcnkgY2xpZW50cyBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCB0aGUgY2xpZW50J3MgdGFiIGlzIGluIHRoZVxuICAgICAgICAgICAgLy8gICBmb3JlZ3JvdW5kLlxuICAgICAgICAgICAgLy8gLSBldmVyeSBjbGllbnRzIG5ldHdvcmsgaXMgZGlzYWJsZWQgYW5kIG5vIG90aGVyIGNsaWVudCdzIHRhYiBpcyBpblxuICAgICAgICAgICAgLy8gICB0aGUgZm9yZWdyb3VuZC5cbiAgICAgICAgICAgIC8vIC0gdGhlIGBmb3JjZU93bmluZ1RhYmAgc2V0dGluZyB3YXMgcGFzc2VkIGluLlxuICAgICAgICAgICAgaWYgKG51bGwgIT09IGUgJiYgdGhpcy5iaShlLmxlYXNlVGltZXN0YW1wTXMsIDVlMykgJiYgIXRoaXMuRGkoZS5vd25lcklkKSkge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLlJpKGUpICYmIHRoaXMubmV0d29ya0VuYWJsZWQpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuUmkoZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlLmFsbG93VGFiU3luY2hyb25pemF0aW9uKSBcbiAgICAgICAgICAgICAgICAgICAgLy8gRmFpbCB0aGUgYGNhbkFjdEFzUHJpbWFyeWAgY2hlY2sgaWYgdGhlIGN1cnJlbnQgbGVhc2Vob2xkZXIgaGFzXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vdCBvcHRlZCBpbnRvIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uIElmIHRoaXMgaGFwcGVucyBhdFxuICAgICAgICAgICAgICAgICAgICAvLyBjbGllbnQgc3RhcnR1cCwgd2UgcmVqZWN0IHRoZSBQcm9taXNlIHJldHVybmVkIGJ5XG4gICAgICAgICAgICAgICAgICAgIC8vIGBlbmFibGVQZXJzaXN0ZW5jZSgpYCBhbmQgdGhlIHVzZXIgY2FuIGNvbnRpbnVlIHRvIHVzZSBGaXJlc3RvcmVcbiAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgZmFpbHMgZHVyaW5nIGEgbGVhc2UgcmVmcmVzaCwgd2Ugd2lsbCBpbnN0ZWFkIGJsb2NrIHRoZVxuICAgICAgICAgICAgICAgICAgICAvLyBBc3luY1F1ZXVlIGZyb20gZXhlY3V0aW5nIGZ1cnRoZXIgb3BlcmF0aW9ucy4gTm90ZSB0aGF0IHRoaXMgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gYWNjZXB0YWJsZSBzaW5jZSBtaXhpbmcgJiBtYXRjaGluZyBkaWZmZXJlbnQgYHN5bmNocm9uaXplVGFic2BcbiAgICAgICAgICAgICAgICAgICAgLy8gc2V0dGluZ3MgaXMgbm90IHN1cHBvcnRlZC5cbiAgICAgICAgICAgICAgICAgICAgLy8gVE9ETyhiLzExNDIyNjIzNCk6IFJlbW92ZSB0aGlzIGNoZWNrIHdoZW4gYHN5bmNocm9uaXplVGFic2AgY2FuXG4gICAgICAgICAgICAgICAgICAgIC8vIG5vIGxvbmdlciBiZSB0dXJuZWQgb2ZmLlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIEhvKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICExO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiAhKCF0aGlzLm5ldHdvcmtFbmFibGVkIHx8ICF0aGlzLmluRm9yZWdyb3VuZCkgfHwgWG8odCkuaigpLm5leHQoKHQgPT4gdm9pZCAwID09PSB0aGlzLlZpKHQsIDVlMykuZmluZCgodCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2xpZW50SWQgIT09IHQuY2xpZW50SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9ICF0aGlzLm5ldHdvcmtFbmFibGVkICYmIHQubmV0d29ya0VuYWJsZWQsIG4gPSAhdGhpcy5pbkZvcmVncm91bmQgJiYgdC5pbkZvcmVncm91bmQsIHMgPSB0aGlzLm5ldHdvcmtFbmFibGVkID09PSB0Lm5ldHdvcmtFbmFibGVkO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZSB8fCBuICYmIHMpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuICExO1xuICAgICAgICAgICAgfSkpKSk7XG4gICAgICAgIH0pKS5uZXh0KCh0ID0+ICh0aGlzLmlzUHJpbWFyeSAhPT0gdCAmJiBOKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgYENsaWVudCAke3QgPyBcImlzXCIgOiBcImlzIG5vdFwifSBlbGlnaWJsZSBmb3IgYSBwcmltYXJ5IGxlYXNlLmApLCBcbiAgICAgICAgdCkpKTtcbiAgICB9XG4gICAgYXN5bmMgc2h1dGRvd24oKSB7XG4gICAgICAgIC8vIFRoZSBzaHV0ZG93bigpIG9wZXJhdGlvbnMgYXJlIGlkZW1wb3RlbnQgYW5kIGNhbiBiZSBjYWxsZWQgZXZlbiB3aGVuXG4gICAgICAgIC8vIHN0YXJ0KCkgYWJvcnRlZCAoZS5nLiBiZWNhdXNlIGl0IGNvdWxkbid0IGFjcXVpcmUgdGhlIHBlcnNpc3RlbmNlIGxlYXNlKS5cbiAgICAgICAgdGhpcy4kcyA9ICExLCB0aGlzLkNpKCksIHRoaXMuYWkgJiYgKHRoaXMuYWkuY2FuY2VsKCksIHRoaXMuYWkgPSBudWxsKSwgdGhpcy54aSgpLCBcbiAgICAgICAgdGhpcy5OaSgpLCBcbiAgICAgICAgLy8gVXNlIGBTaW1wbGVEYi5ydW5UcmFuc2FjdGlvbmAgZGlyZWN0bHkgdG8gYXZvaWQgZmFpbGluZyBpZiBhbm90aGVyIHRhYlxuICAgICAgICAvLyBoYXMgb2J0YWluZWQgdGhlIHByaW1hcnkgbGVhc2UuXG4gICAgICAgIGF3YWl0IHRoaXMuZGkucnVuVHJhbnNhY3Rpb24oXCJzaHV0ZG93blwiLCBcInJlYWR3cml0ZVwiLCBbIFwib3duZXJcIiwgXCJjbGllbnRNZXRhZGF0YVwiIF0sICh0ID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgX2UodCwgJHQuY3QpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuRWkoZSkubmV4dCgoKCkgPT4gdGhpcy52aShlKSkpO1xuICAgICAgICB9KSksIHRoaXMuZGkuY2xvc2UoKSwgXG4gICAgICAgIC8vIFJlbW92ZSB0aGUgZW50cnkgbWFya2luZyB0aGUgY2xpZW50IGFzIHpvbWJpZWQgZnJvbSBMb2NhbFN0b3JhZ2Ugc2luY2VcbiAgICAgICAgLy8gd2Ugc3VjY2Vzc2Z1bGx5IGRlbGV0ZWQgaXRzIG1ldGFkYXRhIGZyb20gSW5kZXhlZERiLlxuICAgICAgICB0aGlzLmtpKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgY2xpZW50cyB0aGF0IGFyZSBub3Qgem9tYmllZCBhbmQgaGF2ZSBhbiB1cGRhdGVUaW1lIHdpdGhpbiB0aGVcbiAgICAgKiBwcm92aWRlZCB0aHJlc2hvbGQuXG4gICAgICovICAgIFZpKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHQuZmlsdGVyKCh0ID0+IHRoaXMuYmkodC51cGRhdGVUaW1lTXMsIGUpICYmICF0aGlzLkRpKHQuY2xpZW50SWQpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIElEcyBvZiB0aGUgY2xpZW50cyB0aGF0IGFyZSBjdXJyZW50bHkgYWN0aXZlLiBJZiBtdWx0aS10YWJcbiAgICAgKiBpcyBub3Qgc3VwcG9ydGVkLCByZXR1cm5zIGFuIGFycmF5IHRoYXQgb25seSBjb250YWlucyB0aGUgbG9jYWwgY2xpZW50J3NcbiAgICAgKiBJRC5cbiAgICAgKlxuICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIFdlYiBtdWx0aS10YWIuXG4gICAgICovICAgIE1pKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5ydW5UcmFuc2FjdGlvbihcImdldEFjdGl2ZUNsaWVudHNcIiwgXCJyZWFkb25seVwiLCAodCA9PiBYbyh0KS5qKCkubmV4dCgodCA9PiB0aGlzLlZpKHQsIDE4ZTUpLm1hcCgodCA9PiB0LmNsaWVudElkKSkpKSkpO1xuICAgIH1cbiAgICBnZXQgc3RhcnRlZCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuJHM7XG4gICAgfVxuICAgIGdldE11dGF0aW9uUXVldWUodCwgZSkge1xuICAgICAgICByZXR1cm4gb28uZmUodCwgdGhpcy5zZXJpYWxpemVyLCBlLCB0aGlzLnJlZmVyZW5jZURlbGVnYXRlKTtcbiAgICB9XG4gICAgZ2V0VGFyZ2V0Q2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkZzO1xuICAgIH1cbiAgICBnZXRSZW1vdGVEb2N1bWVudENhY2hlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdGVEb2N1bWVudENhY2hlO1xuICAgIH1cbiAgICBnZXRJbmRleE1hbmFnZXIodCkge1xuICAgICAgICByZXR1cm4gbmV3IEpyKHQsIHRoaXMuc2VyaWFsaXplci5sZS5kYXRhYmFzZUlkKTtcbiAgICB9XG4gICAgZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUodCkge1xuICAgICAgICByZXR1cm4gdnIuZmUodGhpcy5zZXJpYWxpemVyLCB0KTtcbiAgICB9XG4gICAgZ2V0QnVuZGxlQ2FjaGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLkxzO1xuICAgIH1cbiAgICBydW5UcmFuc2FjdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIE4oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIlN0YXJ0aW5nIHRyYW5zYWN0aW9uOlwiLCB0KTtcbiAgICAgICAgY29uc3QgcyA9IFwicmVhZG9ubHlcIiA9PT0gZSA/IFwicmVhZG9ubHlcIiA6IFwicmVhZHdyaXRlXCIsIGkgPSAxNSA9PT0gKHIgPSB0aGlzLm9pKSA/IGRlIDogMTQgPT09IHIgPyBmZSA6IDEzID09PSByID8gbGUgOiAxMiA9PT0gciA/IGhlIDogMTEgPT09IHIgPyBhZSA6IHZvaWQgJCgpO1xuICAgICAgICAvKiogUmV0dXJucyB0aGUgb2JqZWN0IHN0b3JlcyBmb3IgdGhlIHByb3ZpZGVkIHNjaGVtYS4gKi9cbiAgICAgICAgdmFyIHI7XG4gICAgICAgIGxldCBvO1xuICAgICAgICAvLyBEbyBhbGwgdHJhbnNhY3Rpb25zIGFzIHJlYWR3cml0ZSBhZ2FpbnN0IGFsbCBvYmplY3Qgc3RvcmVzLCBzaW5jZSB3ZVxuICAgICAgICAvLyBhcmUgdGhlIG9ubHkgcmVhZGVyL3dyaXRlci5cbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaS5ydW5UcmFuc2FjdGlvbih0LCBzLCBpLCAocyA9PiAobyA9IG5ldyBfZShzLCB0aGlzLk9zID8gdGhpcy5Pcy5uZXh0KCkgOiAkdC5jdCksIFxuICAgICAgICBcInJlYWR3cml0ZS1wcmltYXJ5XCIgPT09IGUgPyB0aGlzLklpKG8pLm5leHQoKHQgPT4gISF0IHx8IHRoaXMuVGkobykpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGlmICghZSkgdGhyb3cgayhgRmFpbGVkIHRvIG9idGFpbiBwcmltYXJ5IGxlYXNlIGZvciBhY3Rpb24gJyR7dH0nLmApLCB0aGlzLmlzUHJpbWFyeSA9ICExLCBcbiAgICAgICAgICAgIHRoaXMuc2kuZW5xdWV1ZVJldHJ5YWJsZSgoKCkgPT4gdGhpcy5saSghMSkpKSwgbmV3IFUocS5GQUlMRURfUFJFQ09ORElUSU9OLCBFdCk7XG4gICAgICAgICAgICByZXR1cm4gbihvKTtcbiAgICAgICAgfSkpLm5leHQoKHQgPT4gdGhpcy5BaShvKS5uZXh0KCgoKSA9PiB0KSkpKSA6IHRoaXMuT2kobykubmV4dCgoKCkgPT4gbihvKSkpKSkpLnRoZW4oKHQgPT4gKG8ucmFpc2VPbkNvbW1pdHRlZEV2ZW50KCksIFxuICAgICAgICB0KSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBWZXJpZmllcyB0aGF0IHRoZSBjdXJyZW50IHRhYiBpcyB0aGUgcHJpbWFyeSBsZWFzZWhvbGRlciBvciBhbHRlcm5hdGl2ZWx5XG4gICAgICogdGhhdCB0aGUgbGVhc2Vob2xkZXIgaGFzIG9wdGVkIGludG8gbXVsdGktdGFiIHN5bmNocm9uaXphdGlvbi5cbiAgICAgKi9cbiAgICAvLyBUT0RPKGIvMTE0MjI2MjM0KTogUmVtb3ZlIHRoaXMgY2hlY2sgd2hlbiBgc3luY2hyb25pemVUYWJzYCBjYW4gbm8gbG9uZ2VyXG4gICAgLy8gYmUgdHVybmVkIG9mZi5cbiAgICBPaSh0KSB7XG4gICAgICAgIHJldHVybiBZbyh0KS5nZXQoXCJvd25lclwiKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSB0ICYmIHRoaXMuYmkodC5sZWFzZVRpbWVzdGFtcE1zLCA1ZTMpICYmICF0aGlzLkRpKHQub3duZXJJZCkgJiYgIXRoaXMuUmkodCkgJiYgISh0aGlzLnJpIHx8IHRoaXMuYWxsb3dUYWJTeW5jaHJvbml6YXRpb24gJiYgdC5hbGxvd1RhYlN5bmNocm9uaXphdGlvbikpIHRocm93IG5ldyBVKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgSG8pO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIE9idGFpbnMgb3IgZXh0ZW5kcyB0aGUgbmV3IHByaW1hcnkgbGVhc2UgZm9yIHRoZSBsb2NhbCBjbGllbnQuIFRoaXNcbiAgICAgKiBtZXRob2QgZG9lcyBub3QgdmVyaWZ5IHRoYXQgdGhlIGNsaWVudCBpcyBlbGlnaWJsZSBmb3IgdGhpcyBsZWFzZS5cbiAgICAgKi8gICAgQWkodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgb3duZXJJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIGFsbG93VGFiU3luY2hyb25pemF0aW9uOiB0aGlzLmFsbG93VGFiU3luY2hyb25pemF0aW9uLFxuICAgICAgICAgICAgbGVhc2VUaW1lc3RhbXBNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gWW8odCkucHV0KFwib3duZXJcIiwgZSk7XG4gICAgfVxuICAgIHN0YXRpYyBEKCkge1xuICAgICAgICByZXR1cm4gYnQuRCgpO1xuICAgIH1cbiAgICAvKiogQ2hlY2tzIHRoZSBwcmltYXJ5IGxlYXNlIGFuZCByZW1vdmVzIGl0IGlmIHdlIGFyZSB0aGUgY3VycmVudCBwcmltYXJ5LiAqLyAgICBFaSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBZbyh0KTtcbiAgICAgICAgcmV0dXJuIGUuZ2V0KFwib3duZXJcIikubmV4dCgodCA9PiB0aGlzLlJpKHQpID8gKE4oXCJJbmRleGVkRGJQZXJzaXN0ZW5jZVwiLCBcIlJlbGVhc2luZyBwcmltYXJ5IGxlYXNlLlwiKSwgXG4gICAgICAgIGUuZGVsZXRlKFwib3duZXJcIikpIDogdnQucmVzb2x2ZSgpKSk7XG4gICAgfVxuICAgIC8qKiBWZXJpZmllcyB0aGF0IGB1cGRhdGVUaW1lTXNgIGlzIHdpdGhpbiBgbWF4QWdlTXNgLiAqLyAgICBiaSh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBEYXRlLm5vdygpO1xuICAgICAgICByZXR1cm4gISh0IDwgbiAtIGUpICYmICghKHQgPiBuKSB8fCAoayhgRGV0ZWN0ZWQgYW4gdXBkYXRlIHRpbWUgdGhhdCBpcyBpbiB0aGUgZnV0dXJlOiAke3R9ID4gJHtufWApLCBcbiAgICAgICAgITEpKTtcbiAgICB9XG4gICAgbWkoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuZG9jdW1lbnQgJiYgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0aGlzLmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIgJiYgKHRoaXMuY2kgPSAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNpLmVucXVldWVBbmRGb3JnZXQoKCgpID0+ICh0aGlzLmluRm9yZWdyb3VuZCA9IFwidmlzaWJsZVwiID09PSB0aGlzLmRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSwgXG4gICAgICAgICAgICB0aGlzLndpKCkpKSk7XG4gICAgICAgIH0sIHRoaXMuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5jaSksIHRoaXMuaW5Gb3JlZ3JvdW5kID0gXCJ2aXNpYmxlXCIgPT09IHRoaXMuZG9jdW1lbnQudmlzaWJpbGl0eVN0YXRlKTtcbiAgICB9XG4gICAgeGkoKSB7XG4gICAgICAgIHRoaXMuY2kgJiYgKHRoaXMuZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5jaSksIHRoaXMuY2kgPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXR0YWNoZXMgYSB3aW5kb3cudW5sb2FkIGhhbmRsZXIgdGhhdCB3aWxsIHN5bmNocm9ub3VzbHkgd3JpdGUgb3VyXG4gICAgICogY2xpZW50SWQgdG8gYSBcInpvbWJpZSBjbGllbnQgaWRcIiBsb2NhdGlvbiBpbiBMb2NhbFN0b3JhZ2UuIFRoaXMgY2FuIGJlIHVzZWRcbiAgICAgKiBieSB0YWJzIHRyeWluZyB0byBhY3F1aXJlIHRoZSBwcmltYXJ5IGxlYXNlIHRvIGRldGVybWluZSB0aGF0IHRoZSBsZWFzZVxuICAgICAqIGlzIG5vIGxvbmdlciB2YWxpZCBldmVuIGlmIHRoZSB0aW1lc3RhbXAgaXMgcmVjZW50LiBUaGlzIGlzIHBhcnRpY3VsYXJseVxuICAgICAqIGltcG9ydGFudCBmb3IgdGhlIHJlZnJlc2ggY2FzZSAoc28gdGhlIHRhYiBjb3JyZWN0bHkgcmUtYWNxdWlyZXMgdGhlXG4gICAgICogcHJpbWFyeSBsZWFzZSkuIExvY2FsU3RvcmFnZSBpcyB1c2VkIGZvciB0aGlzIHJhdGhlciB0aGFuIEluZGV4ZWREYiBiZWNhdXNlXG4gICAgICogaXQgaXMgYSBzeW5jaHJvbm91cyBBUEkgYW5kIHNvIGNhbiBiZSB1c2VkIHJlbGlhYmx5IGZyb20gIGFuIHVubG9hZFxuICAgICAqIGhhbmRsZXIuXG4gICAgICovICAgIGdpKCkge1xuICAgICAgICB2YXIgdDtcbiAgICAgICAgXCJmdW5jdGlvblwiID09IHR5cGVvZiAobnVsbCA9PT0gKHQgPSB0aGlzLndpbmRvdykgfHwgdm9pZCAwID09PSB0ID8gdm9pZCAwIDogdC5hZGRFdmVudExpc3RlbmVyKSAmJiAodGhpcy51aSA9ICgpID0+IHtcbiAgICAgICAgICAgIC8vIE5vdGU6IEluIHRoZW9yeSwgdGhpcyBzaG91bGQgYmUgc2NoZWR1bGVkIG9uIHRoZSBBc3luY1F1ZXVlIHNpbmNlIGl0XG4gICAgICAgICAgICAvLyBhY2Nlc3NlcyBpbnRlcm5hbCBzdGF0ZS4gV2UgZXhlY3V0ZSB0aGlzIGNvZGUgZGlyZWN0bHkgZHVyaW5nIHNodXRkb3duXG4gICAgICAgICAgICAvLyB0byBtYWtlIHN1cmUgaXQgZ2V0cyBhIGNoYW5jZSB0byBydW4uXG4gICAgICAgICAgICB0aGlzLkNpKCk7XG4gICAgICAgICAgICBjb25zdCB0ID0gLyg/OlZlcnNpb258TW9iaWxlKVxcLzFbNDU2XS87XG4gICAgICAgICAgICBpc1NhZmFyaSgpICYmIChuYXZpZ2F0b3IuYXBwVmVyc2lvbi5tYXRjaCh0KSB8fCBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKHQpKSAmJiBcbiAgICAgICAgICAgIC8vIE9uIFNhZmFyaSAxNCwgMTUsIGFuZCAxNiwgd2UgZG8gbm90IHJ1biBhbnkgY2xlYW51cCBhY3Rpb25zIGFzIGl0IG1pZ2h0XG4gICAgICAgICAgICAvLyB0cmlnZ2VyIGEgYnVnIHRoYXQgcHJldmVudHMgU2FmYXJpIGZyb20gcmUtb3BlbmluZyBJbmRleGVkREIgZHVyaW5nXG4gICAgICAgICAgICAvLyB0aGUgbmV4dCBwYWdlIGxvYWQuXG4gICAgICAgICAgICAvLyBTZWUgaHR0cHM6Ly9idWdzLndlYmtpdC5vcmcvc2hvd19idWcuY2dpP2lkPTIyNjU0N1xuICAgICAgICAgICAgdGhpcy5zaS5lbnRlclJlc3RyaWN0ZWRNb2RlKC8qIHB1cmdlRXhpc3RpbmdUYXNrcz0gKi8gITApLCB0aGlzLnNpLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuc2h1dGRvd24oKSkpO1xuICAgICAgICB9LCB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgdGhpcy51aSkpO1xuICAgIH1cbiAgICBOaSgpIHtcbiAgICAgICAgdGhpcy51aSAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBhZ2VoaWRlXCIsIHRoaXMudWkpLCB0aGlzLnVpID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgd2hldGhlciBhIGNsaWVudCBpcyBcInpvbWJpZWRcIiBiYXNlZCBvbiBpdHMgTG9jYWxTdG9yYWdlIGVudHJ5LlxuICAgICAqIENsaWVudHMgYmVjb21lIHpvbWJpZWQgd2hlbiB0aGVpciB0YWIgY2xvc2VzIHdpdGhvdXQgcnVubmluZyBhbGwgb2YgdGhlXG4gICAgICogY2xlYW51cCBsb2dpYyBpbiBgc2h1dGRvd24oKWAuXG4gICAgICovICAgIERpKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBuID0gbnVsbCAhPT0gKG51bGwgPT09IChlID0gdGhpcy5faSkgfHwgdm9pZCAwID09PSBlID8gdm9pZCAwIDogZS5nZXRJdGVtKHRoaXMuU2kodCkpKTtcbiAgICAgICAgICAgIHJldHVybiBOKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgYENsaWVudCAnJHt0fScgJHtuID8gXCJpc1wiIDogXCJpcyBub3RcIn0gem9tYmllZCBpbiBMb2NhbFN0b3JhZ2VgKSwgXG4gICAgICAgICAgICBuO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgIHJldHVybiBrKFwiSW5kZXhlZERiUGVyc2lzdGVuY2VcIiwgXCJGYWlsZWQgdG8gZ2V0IHpvbWJpZWQgY2xpZW50IGlkLlwiLCB0KSwgITE7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVjb3JkIGNsaWVudCBhcyB6b21iaWVkIChhIGNsaWVudCB0aGF0IGhhZCBpdHMgdGFiIGNsb3NlZCkuIFpvbWJpZWRcbiAgICAgKiBjbGllbnRzIGFyZSBpZ25vcmVkIGR1cmluZyBwcmltYXJ5IHRhYiBzZWxlY3Rpb24uXG4gICAgICovICAgIENpKCkge1xuICAgICAgICBpZiAodGhpcy5faSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2kuc2V0SXRlbSh0aGlzLlNpKHRoaXMuY2xpZW50SWQpLCBTdHJpbmcoRGF0ZS5ub3coKSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICAvLyBHcmFjZWZ1bGx5IGhhbmRsZSBpZiBMb2NhbFN0b3JhZ2UgaXNuJ3QgYXZhaWxhYmxlIC8gd29ya2luZy5cbiAgICAgICAgICAgIGsoXCJGYWlsZWQgdG8gc2V0IHpvbWJpZSBjbGllbnQgaWQuXCIsIHQpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKiBSZW1vdmVzIHRoZSB6b21iaWVkIGNsaWVudCBlbnRyeSBpZiBpdCBleGlzdHMuICovICAgIGtpKCkge1xuICAgICAgICBpZiAodGhpcy5faSkgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuX2kucmVtb3ZlSXRlbSh0aGlzLlNpKHRoaXMuY2xpZW50SWQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gSWdub3JlXG4gICAgICAgIH1cbiAgICB9XG4gICAgU2kodCkge1xuICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV96b21iaWVfJHt0aGlzLnBlcnNpc3RlbmNlS2V5fV8ke3R9YDtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIHRvIGdldCBhIHR5cGVkIFNpbXBsZURiU3RvcmUgZm9yIHRoZSBwcmltYXJ5IGNsaWVudCBvYmplY3Qgc3RvcmUuXG4gKi8gZnVuY3Rpb24gWW8odCkge1xuICAgIHJldHVybiB3ZSh0LCBcIm93bmVyXCIpO1xufVxuXG4vKipcbiAqIEhlbHBlciB0byBnZXQgYSB0eXBlZCBTaW1wbGVEYlN0b3JlIGZvciB0aGUgY2xpZW50IG1ldGFkYXRhIG9iamVjdCBzdG9yZS5cbiAqLyBmdW5jdGlvbiBYbyh0KSB7XG4gICAgcmV0dXJuIHdlKHQsIFwiY2xpZW50TWV0YWRhdGFcIik7XG59XG5cbi8qKlxuICogR2VuZXJhdGVzIGEgc3RyaW5nIHVzZWQgYXMgYSBwcmVmaXggd2hlbiBzdG9yaW5nIGRhdGEgaW4gSW5kZXhlZERCIGFuZFxuICogTG9jYWxTdG9yYWdlLlxuICovIGZ1bmN0aW9uIFpvKHQsIGUpIHtcbiAgICAvLyBVc2UgdHdvIGRpZmZlcmVudCBwcmVmaXggZm9ybWF0czpcbiAgICAvLyAgICogZmlyZXN0b3JlIC8gcGVyc2lzdGVuY2VLZXkgLyBwcm9qZWN0SUQgLiBkYXRhYmFzZUlEIC8gLi4uXG4gICAgLy8gICAqIGZpcmVzdG9yZSAvIHBlcnNpc3RlbmNlS2V5IC8gcHJvamVjdElEIC8gLi4uXG4gICAgLy8gcHJvamVjdElEcyBhcmUgRE5TLWNvbXBhdGlibGUgbmFtZXMgYW5kIGNhbm5vdCBjb250YWluIGRvdHNcbiAgICAvLyBzbyB0aGVyZSdzIG5vIGRhbmdlciBvZiBjb2xsaXNpb25zLlxuICAgIGxldCBuID0gdC5wcm9qZWN0SWQ7XG4gICAgcmV0dXJuIHQuaXNEZWZhdWx0RGF0YWJhc2UgfHwgKG4gKz0gXCIuXCIgKyB0LmRhdGFiYXNlKSwgXCJmaXJlc3RvcmUvXCIgKyBlICsgXCIvXCIgKyBuICsgXCIvXCI7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgc2V0IG9mIGNoYW5nZXMgdG8gd2hhdCBkb2N1bWVudHMgYXJlIGN1cnJlbnRseSBpbiB2aWV3IGFuZCBvdXQgb2YgdmlldyBmb3JcbiAqIGEgZ2l2ZW4gcXVlcnkuIFRoZXNlIGNoYW5nZXMgYXJlIHNlbnQgdG8gdGhlIExvY2FsU3RvcmUgYnkgdGhlIFZpZXcgKHZpYVxuICogdGhlIFN5bmNFbmdpbmUpIGFuZCBhcmUgdXNlZCB0byBwaW4gLyB1bnBpbiBkb2N1bWVudHMgYXMgYXBwcm9wcmlhdGUuXG4gKi9cbmNsYXNzIHR1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLmZyb21DYWNoZSA9IGUsIHRoaXMuJGkgPSBuLCB0aGlzLkZpID0gcztcbiAgICB9XG4gICAgc3RhdGljIEJpKHQsIGUpIHtcbiAgICAgICAgbGV0IG4gPSBncygpLCBzID0gZ3MoKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIGUuZG9jQ2hhbmdlcykgc3dpdGNoICh0LnR5cGUpIHtcbiAgICAgICAgICBjYXNlIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA6XG4gICAgICAgICAgICBuID0gbi5hZGQodC5kb2Mua2V5KTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyA6XG4gICAgICAgICAgICBzID0gcy5hZGQodC5kb2Mua2V5KTtcbiAvLyBkbyBub3RoaW5nXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IHR1KHQsIGUuZnJvbUNhY2hlLCBuLCBzKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBGaXJlc3RvcmUgcXVlcnkgZW5naW5lLlxuICpcbiAqIEZpcmVzdG9yZSBxdWVyaWVzIGNhbiBiZSBleGVjdXRlZCBpbiB0aHJlZSBtb2Rlcy4gVGhlIFF1ZXJ5IEVuZ2luZSBkZXRlcm1pbmVzXG4gKiB3aGF0IG1vZGUgdG8gdXNlIGJhc2VkIG9uIHdoYXQgZGF0YSBpcyBwZXJzaXN0ZWQuIFRoZSBtb2RlIG9ubHkgZGV0ZXJtaW5lc1xuICogdGhlIHJ1bnRpbWUgY29tcGxleGl0eSBvZiB0aGUgcXVlcnkgLSB0aGUgcmVzdWx0IHNldCBpcyBlcXVpdmFsZW50IGFjcm9zcyBhbGxcbiAqIGltcGxlbWVudGF0aW9ucy5cbiAqXG4gKiBUaGUgUXVlcnkgZW5naW5lIHdpbGwgdXNlIGluZGV4ZWQtYmFzZWQgZXhlY3V0aW9uIGlmIGEgdXNlciBoYXMgY29uZmlndXJlZFxuICogYW55IGluZGV4IHRoYXQgY2FuIGJlIHVzZWQgdG8gZXhlY3V0ZSBxdWVyeSAodmlhIGBzZXRJbmRleENvbmZpZ3VyYXRpb24oKWApLlxuICogT3RoZXJ3aXNlLCB0aGUgZW5naW5lIHdpbGwgdHJ5IHRvIG9wdGltaXplIHRoZSBxdWVyeSBieSByZS11c2luZyBhIHByZXZpb3VzbHlcbiAqIHBlcnNpc3RlZCBxdWVyeSByZXN1bHQuIElmIHRoYXQgaXMgbm90IHBvc3NpYmxlLCB0aGUgcXVlcnkgd2lsbCBiZSBleGVjdXRlZFxuICogdmlhIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gKlxuICogSW5kZXgtYmFzZWQgZXhlY3V0aW9uIGlzIHRoZSBkZWZhdWx0IHdoZW4gYXZhaWxhYmxlLiBUaGUgcXVlcnkgZW5naW5lXG4gKiBzdXBwb3J0cyBwYXJ0aWFsIGluZGV4ZWQgZXhlY3V0aW9uIGFuZCBtZXJnZXMgdGhlIHJlc3VsdCBmcm9tIHRoZSBpbmRleFxuICogbG9va3VwIHdpdGggZG9jdW1lbnRzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gaW5kZXhlZC4gVGhlIGluZGV4IGV2YWx1YXRpb25cbiAqIG1hdGNoZXMgdGhlIGJhY2tlbmQncyBmb3JtYXQgYW5kIGFzIHN1Y2gsIHRoZSBTREsgY2FuIHVzZSBpbmRleGluZyBmb3IgYWxsXG4gKiBxdWVyaWVzIHRoYXQgdGhlIGJhY2tlbmQgc3VwcG9ydHMuXG4gKlxuICogSWYgbm8gaW5kZXggZXhpc3RzLCB0aGUgcXVlcnkgZW5naW5lIHRyaWVzIHRvIHRha2UgYWR2YW50YWdlIG9mIHRoZSB0YXJnZXRcbiAqIGRvY3VtZW50IG1hcHBpbmcgaW4gdGhlIFRhcmdldENhY2hlLiBUaGVzZSBtYXBwaW5ncyBleGlzdHMgZm9yIGFsbCBxdWVyaWVzXG4gKiB0aGF0IGhhdmUgYmVlbiBzeW5jZWQgd2l0aCB0aGUgYmFja2VuZCBhdCBsZWFzdCBvbmNlIGFuZCBhbGxvdyB0aGUgcXVlcnlcbiAqIGVuZ2luZSB0byBvbmx5IHJlYWQgZG9jdW1lbnRzIHRoYXQgcHJldmlvdXNseSBtYXRjaGVkIGEgcXVlcnkgcGx1cyBhbnlcbiAqIGRvY3VtZW50cyB0aGF0IHdlcmUgZWRpdGVkIGFmdGVyIHRoZSBxdWVyeSB3YXMgbGFzdCBsaXN0ZW5lZCB0by5cbiAqXG4gKiBUaGVyZSBhcmUgc29tZSBjYXNlcyB3aGVuIHRoaXMgb3B0aW1pemF0aW9uIGlzIG5vdCBndWFyYW50ZWVkIHRvIHByb2R1Y2VcbiAqIHRoZSBzYW1lIHJlc3VsdHMgYXMgZnVsbCBjb2xsZWN0aW9uIHNjYW5zLiBJbiB0aGVzZSBjYXNlcywgcXVlcnlcbiAqIHByb2Nlc3NpbmcgZmFsbHMgYmFjayB0byBmdWxsIHNjYW5zLiBUaGVzZSBjYXNlcyBhcmU6XG4gKlxuICogLSBMaW1pdCBxdWVyaWVzIHdoZXJlIGEgZG9jdW1lbnQgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSBwcmV2aW91c2x5IG5vIGxvbmdlclxuICogICBtYXRjaGVzIHRoZSBxdWVyeS5cbiAqXG4gKiAtIExpbWl0IHF1ZXJpZXMgd2hlcmUgYSBkb2N1bWVudCBlZGl0IG1heSBjYXVzZSB0aGUgZG9jdW1lbnQgdG8gc29ydCBiZWxvd1xuICogICBhbm90aGVyIGRvY3VtZW50IHRoYXQgaXMgaW4gdGhlIGxvY2FsIGNhY2hlLlxuICpcbiAqIC0gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgYmVlbiBDVVJSRU5UIG9yIGZyZWUgb2YgbGltYm8gZG9jdW1lbnRzLlxuICovIGNsYXNzIGV1IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5MaSA9ICExO1xuICAgIH1cbiAgICAvKiogU2V0cyB0aGUgZG9jdW1lbnQgdmlldyB0byBxdWVyeSBhZ2FpbnN0LiAqLyAgICBpbml0aWFsaXplKHQsIGUpIHtcbiAgICAgICAgdGhpcy5xaSA9IHQsIHRoaXMuaW5kZXhNYW5hZ2VyID0gZSwgdGhpcy5MaSA9ICEwO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhbGwgbG9jYWwgZG9jdW1lbnRzIG1hdGNoaW5nIHRoZSBzcGVjaWZpZWQgcXVlcnkuICovICAgIGdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodCwgZSwgbiwgcykge1xuICAgICAgICByZXR1cm4gdGhpcy5VaSh0LCBlKS5uZXh0KChpID0+IGkgfHwgdGhpcy5LaSh0LCBlLCBzLCBuKSkpLm5leHQoKG4gPT4gbiB8fCB0aGlzLkdpKHQsIGUpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBlcmZvcm1zIGFuIGluZGV4ZWQgcXVlcnkgdGhhdCBldmFsdWF0ZXMgdGhlIHF1ZXJ5IGJhc2VkIG9uIGEgY29sbGVjdGlvbidzXG4gICAgICogcGVyc2lzdGVkIGluZGV4IHZhbHVlcy4gUmV0dXJucyBgbnVsbGAgaWYgYW4gaW5kZXggaXMgbm90IGF2YWlsYWJsZS5cbiAgICAgKi8gICAgVWkodCwgZSkge1xuICAgICAgICBpZiAoUW4oZSkpIFxuICAgICAgICAvLyBRdWVyaWVzIHRoYXQgbWF0Y2ggYWxsIGRvY3VtZW50cyBkb24ndCBiZW5lZml0IGZyb20gdXNpbmdcbiAgICAgICAgLy8ga2V5LWJhc2VkIGxvb2t1cHMuIEl0IGlzIG1vcmUgZWZmaWNpZW50IHRvIHNjYW4gYWxsIGRvY3VtZW50cyBpbiBhXG4gICAgICAgIC8vIGNvbGxlY3Rpb24sIHJhdGhlciB0aGFuIHRvIHBlcmZvcm0gaW5kaXZpZHVhbCBsb29rdXBzLlxuICAgICAgICByZXR1cm4gdnQucmVzb2x2ZShudWxsKTtcbiAgICAgICAgbGV0IG4gPSBKbihlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5kZXhNYW5hZ2VyLmdldEluZGV4VHlwZSh0LCBuKS5uZXh0KChzID0+IDAgLyogSW5kZXhUeXBlLk5PTkUgKi8gPT09IHMgPyBudWxsIDogKG51bGwgIT09IGUubGltaXQgJiYgMSAvKiBJbmRleFR5cGUuUEFSVElBTCAqLyA9PT0gcyAmJiAoXG4gICAgICAgIC8vIFdlIGNhbm5vdCBhcHBseSBhIGxpbWl0IGZvciB0YXJnZXRzIHRoYXQgYXJlIHNlcnZlZCB1c2luZyBhIHBhcnRpYWxcbiAgICAgICAgLy8gaW5kZXguIElmIGEgcGFydGlhbCBpbmRleCB3aWxsIGJlIHVzZWQgdG8gc2VydmUgdGhlIHRhcmdldCwgdGhlXG4gICAgICAgIC8vIHF1ZXJ5IG1heSByZXR1cm4gYSBzdXBlcnNldCBvZiBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGUgdGFyZ2V0XG4gICAgICAgIC8vIChlLmcuIGlmIHRoZSBpbmRleCBkb2Vzbid0IGluY2x1ZGUgYWxsIHRoZSB0YXJnZXQncyBmaWx0ZXJzKSwgb3JcbiAgICAgICAgLy8gbWF5IHJldHVybiB0aGUgY29ycmVjdCBzZXQgb2YgZG9jdW1lbnRzIGluIHRoZSB3cm9uZyBvcmRlciAoZS5nLiBpZlxuICAgICAgICAvLyB0aGUgaW5kZXggZG9lc24ndCBpbmNsdWRlIGEgc2VnbWVudCBmb3Igb25lIG9mIHRoZSBvcmRlckJ5cykuXG4gICAgICAgIC8vIFRoZXJlZm9yZSwgYSBsaW1pdCBzaG91bGQgbm90IGJlIGFwcGxpZWQgaW4gc3VjaCBjYXNlcy5cbiAgICAgICAgZSA9IFhuKGUsIG51bGwsIFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyksIG4gPSBKbihlKSksIHRoaXMuaW5kZXhNYW5hZ2VyLmdldERvY3VtZW50c01hdGNoaW5nVGFyZ2V0KHQsIG4pLm5leHQoKHMgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGdzKC4uLnMpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucWkuZ2V0RG9jdW1lbnRzKHQsIGkpLm5leHQoKHMgPT4gdGhpcy5pbmRleE1hbmFnZXIuZ2V0TWluT2Zmc2V0KHQsIG4pLm5leHQoKG4gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSB0aGlzLlFpKGUsIHMpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmppKGUsIHIsIGksIG4ucmVhZFRpbWUpID8gdGhpcy5VaSh0LCBYbihlLCBudWxsLCBcIkZcIiAvKiBMaW1pdFR5cGUuRmlyc3QgKi8pKSA6IHRoaXMuemkodCwgciwgZSwgbik7XG4gICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgfSkpKSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQZXJmb3JtcyBhIHF1ZXJ5IGJhc2VkIG9uIHRoZSB0YXJnZXQncyBwZXJzaXN0ZWQgcXVlcnkgbWFwcGluZy4gUmV0dXJuc1xuICAgICAqIGBudWxsYCBpZiB0aGUgbWFwcGluZyBpcyBub3QgYXZhaWxhYmxlIG9yIGNhbm5vdCBiZSB1c2VkLlxuICAgICAqLyAgICBLaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBRbihlKSB8fCBzLmlzRXF1YWwocnQubWluKCkpID8gdGhpcy5HaSh0LCBlKSA6IHRoaXMucWkuZ2V0RG9jdW1lbnRzKHQsIG4pLm5leHQoKGkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9IHRoaXMuUWkoZSwgaSk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5qaShlLCByLCBuLCBzKSA/IHRoaXMuR2kodCwgZSkgOiAoQygpIDw9IExvZ0xldmVsLkRFQlVHICYmIE4oXCJRdWVyeUVuZ2luZVwiLCBcIlJlLXVzaW5nIHByZXZpb3VzIHJlc3VsdCBmcm9tICVzIHRvIGV4ZWN1dGUgcXVlcnk6ICVzXCIsIHMudG9TdHJpbmcoKSwgZXMoZSkpLCBcbiAgICAgICAgICAgIHRoaXMuemkodCwgciwgZSwgeXQocywgLTEpKSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gUXVlcmllcyB0aGF0IGhhdmUgbmV2ZXIgc2VlbiBhIHNuYXBzaG90IHdpdGhvdXQgbGltYm8gZnJlZSBkb2N1bWVudHNcbiAgICAgICAgLy8gc2hvdWxkIGFsc28gYmUgcnVuIGFzIGEgZnVsbCBjb2xsZWN0aW9uIHNjYW4uXG4gICAgICAgIH1cbiAgICAvKiogQXBwbGllcyB0aGUgcXVlcnkgZmlsdGVyIGFuZCBzb3J0aW5nIHRvIHRoZSBwcm92aWRlZCBkb2N1bWVudHMuICAqLyAgICBRaSh0LCBlKSB7XG4gICAgICAgIC8vIFNvcnQgdGhlIGRvY3VtZW50cyBhbmQgcmUtYXBwbHkgdGhlIHF1ZXJ5IGZpbHRlciBzaW5jZSBwcmV2aW91c2x5XG4gICAgICAgIC8vIG1hdGNoaW5nIGRvY3VtZW50cyBkbyBub3QgbmVjZXNzYXJpbHkgc3RpbGwgbWF0Y2ggdGhlIHF1ZXJ5LlxuICAgICAgICBsZXQgbiA9IG5ldyBFZShpcyh0KSk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKChlLCBzKSA9PiB7XG4gICAgICAgICAgICBucyh0LCBzKSAmJiAobiA9IG4uYWRkKHMpKTtcbiAgICAgICAgfSkpLCBuO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIGlmIGEgbGltaXQgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgZnJvbSBjYWNoZSwgbWFraW5nIGl0XG4gICAgICogaW5lbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBleGVjdXRpb24uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkuXG4gICAgICogQHBhcmFtIHNvcnRlZFByZXZpb3VzUmVzdWx0cyAtIFRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaGVkIHRoZSBxdWVyeSB3aGVuIGl0XG4gICAgICogd2FzIGxhc3Qgc3luY2hyb25pemVkLCBzb3J0ZWQgYnkgdGhlIHF1ZXJ5J3MgY29tcGFyYXRvci5cbiAgICAgKiBAcGFyYW0gcmVtb3RlS2V5cyAtIFRoZSBkb2N1bWVudCBrZXlzIHRoYXQgbWF0Y2hlZCB0aGUgcXVlcnkgYXQgdGhlIGxhc3RcbiAgICAgKiBzbmFwc2hvdC5cbiAgICAgKiBAcGFyYW0gbGltYm9GcmVlU25hcHNob3RWZXJzaW9uIC0gVGhlIHZlcnNpb24gb2YgdGhlIHNuYXBzaG90IHdoZW4gdGhlXG4gICAgICogcXVlcnkgd2FzIGxhc3Qgc3luY2hyb25pemVkLlxuICAgICAqLyAgICBqaSh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGlmIChudWxsID09PSB0LmxpbWl0KSBcbiAgICAgICAgLy8gUXVlcmllcyB3aXRob3V0IGxpbWl0cyBkbyBub3QgbmVlZCB0byBiZSByZWZpbGxlZC5cbiAgICAgICAgcmV0dXJuICExO1xuICAgICAgICBpZiAobi5zaXplICE9PSBlLnNpemUpIFxuICAgICAgICAvLyBUaGUgcXVlcnkgbmVlZHMgdG8gYmUgcmVmaWxsZWQgaWYgYSBwcmV2aW91c2x5IG1hdGNoaW5nIGRvY3VtZW50IG5vXG4gICAgICAgIC8vIGxvbmdlciBtYXRjaGVzLlxuICAgICAgICByZXR1cm4gITA7XG4gICAgICAgIC8vIExpbWl0IHF1ZXJpZXMgYXJlIG5vdCBlbGlnaWJsZSBmb3IgaW5kZXgtZnJlZSBxdWVyeSBleGVjdXRpb24gaWYgdGhlcmUgaXNcbiAgICAgICAgLy8gYSBwb3RlbnRpYWwgdGhhdCBhbiBvbGRlciBkb2N1bWVudCBmcm9tIGNhY2hlIG5vdyBzb3J0cyBiZWZvcmUgYSBkb2N1bWVudFxuICAgICAgICAvLyB0aGF0IHdhcyBwcmV2aW91c2x5IHBhcnQgb2YgdGhlIGxpbWl0LiBUaGlzLCBob3dldmVyLCBjYW4gb25seSBoYXBwZW4gaWZcbiAgICAgICAgLy8gdGhlIGRvY3VtZW50IGF0IHRoZSBlZGdlIG9mIHRoZSBsaW1pdCBnb2VzIG91dCBvZiBsaW1pdC5cbiAgICAgICAgLy8gSWYgYSBkb2N1bWVudCB0aGF0IGlzIG5vdCB0aGUgbGltaXQgYm91bmRhcnkgc29ydHMgZGlmZmVyZW50bHksXG4gICAgICAgIC8vIHRoZSBib3VuZGFyeSBvZiB0aGUgbGltaXQgaXRzZWxmIGRpZCBub3QgY2hhbmdlIGFuZCBkb2N1bWVudHMgZnJvbSBjYWNoZVxuICAgICAgICAvLyB3aWxsIGNvbnRpbnVlIHRvIGJlIFwicmVqZWN0ZWRcIiBieSB0aGlzIGJvdW5kYXJ5LiBUaGVyZWZvcmUsIHdlIGNhbiBpZ25vcmVcbiAgICAgICAgLy8gYW55IG1vZGlmaWNhdGlvbnMgdGhhdCBkb24ndCBhZmZlY3QgdGhlIGxhc3QgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyA9PT0gdC5saW1pdFR5cGUgPyBlLmxhc3QoKSA6IGUuZmlyc3QoKTtcbiAgICAgICAgcmV0dXJuICEhaSAmJiAoaS5oYXNQZW5kaW5nV3JpdGVzIHx8IGkudmVyc2lvbi5jb21wYXJlVG8ocykgPiAwKTtcbiAgICB9XG4gICAgR2kodCwgZSkge1xuICAgICAgICByZXR1cm4gQygpIDw9IExvZ0xldmVsLkRFQlVHICYmIE4oXCJRdWVyeUVuZ2luZVwiLCBcIlVzaW5nIGZ1bGwgY29sbGVjdGlvbiBzY2FuIHRvIGV4ZWN1dGUgcXVlcnk6XCIsIGVzKGUpKSwgXG4gICAgICAgIHRoaXMucWkuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBJdC5taW4oKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbWJpbmVzIHRoZSByZXN1bHRzIGZyb20gYW4gaW5kZXhlZCBleGVjdXRpb24gd2l0aCB0aGUgcmVtYWluaW5nIGRvY3VtZW50c1xuICAgICAqIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW4gaW5kZXhlZC5cbiAgICAgKi8gICAgemkodCwgZSwgbiwgcykge1xuICAgICAgICAvLyBSZXRyaWV2ZSBhbGwgcmVzdWx0cyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZSB1cGRhdGVkIHNpbmNlIHRoZSBvZmZzZXQuXG4gICAgICAgIHJldHVybiB0aGlzLnFpLmdldERvY3VtZW50c01hdGNoaW5nUXVlcnkodCwgbiwgcykubmV4dCgodCA9PiAoXG4gICAgICAgIC8vIE1lcmdlIHdpdGggZXhpc3RpbmcgcmVzdWx0c1xuICAgICAgICBlLmZvckVhY2goKGUgPT4ge1xuICAgICAgICAgICAgdCA9IHQuaW5zZXJ0KGUua2V5LCBlKTtcbiAgICAgICAgfSkpLCB0KSkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSW1wbGVtZW50cyBgTG9jYWxTdG9yZWAgaW50ZXJmYWNlLlxuICpcbiAqIE5vdGU6IHNvbWUgZmllbGQgZGVmaW5lZCBpbiB0aGlzIGNsYXNzIG1pZ2h0IGhhdmUgcHVibGljIGFjY2VzcyBsZXZlbCwgYnV0XG4gKiB0aGUgY2xhc3MgaXMgbm90IGV4cG9ydGVkIHNvIHRoZXkgYXJlIG9ubHkgYWNjZXNzaWJsZSBmcm9tIHRoaXMgbW9kdWxlLlxuICogVGhpcyBpcyB1c2VmdWwgdG8gaW1wbGVtZW50IG9wdGlvbmFsIGZlYXR1cmVzIChsaWtlIGJ1bmRsZXMpIGluIGZyZWVcbiAqIGZ1bmN0aW9ucywgc3VjaCB0aGF0IHRoZXkgYXJlIHRyZWUtc2hha2VhYmxlLlxuICovXG5jbGFzcyBudSB7XG4gICAgY29uc3RydWN0b3IoXG4gICAgLyoqIE1hbmFnZXMgb3VyIGluLW1lbW9yeSBvciBkdXJhYmxlIHBlcnNpc3RlbmNlLiAqL1xuICAgIHQsIGUsIG4sIHMpIHtcbiAgICAgICAgdGhpcy5wZXJzaXN0ZW5jZSA9IHQsIHRoaXMuV2kgPSBlLCB0aGlzLnNlcmlhbGl6ZXIgPSBzLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIE1hcHMgYSB0YXJnZXRJRCB0byBkYXRhIGFib3V0IGl0cyB0YXJnZXQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogV2UgYXJlIHVzaW5nIGFuIGltbXV0YWJsZSBkYXRhIHN0cnVjdHVyZSBvbiBXZWIgdG8gbWFrZSByZS1ydW5zXG4gICAgICAgICAqIG9mIGBhcHBseVJlbW90ZUV2ZW50KClgIGlkZW1wb3RlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkhpID0gbmV3IHBlKGV0KSwgXG4gICAgICAgIC8qKiBNYXBzIGEgdGFyZ2V0IHRvIGl0cyB0YXJnZXRJRC4gKi9cbiAgICAgICAgLy8gVE9ETyh3dWFuZHkpOiBFdmFsdWF0ZSBpZiBUYXJnZXRJZCBjYW4gYmUgcGFydCBvZiBUYXJnZXQuXG4gICAgICAgIHRoaXMuSmkgPSBuZXcgb3MoKHQgPT4gT24odCkpLCAkbiksIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBwZXIgY29sbGVjdGlvbiBncm91cCBpbmRleCBvZiB0aGUgbGFzdCByZWFkIHRpbWUgcHJvY2Vzc2VkIGJ5XG4gICAgICAgICAqIGBnZXROZXdEb2N1bWVudENoYW5nZXMoKWAuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogVGhpcyBpcyBvbmx5IHVzZWQgZm9yIG11bHRpLXRhYiBzeW5jaHJvbml6YXRpb24uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLllpID0gbmV3IE1hcCwgdGhpcy5YaSA9IHQuZ2V0UmVtb3RlRG9jdW1lbnRDYWNoZSgpLCB0aGlzLkZzID0gdC5nZXRUYXJnZXRDYWNoZSgpLCBcbiAgICAgICAgdGhpcy5McyA9IHQuZ2V0QnVuZGxlQ2FjaGUoKSwgdGhpcy5aaShuKTtcbiAgICB9XG4gICAgWmkodCkge1xuICAgICAgICAvLyBUT0RPKGluZGV4aW5nKTogQWRkIHNwZWMgdGVzdHMgdGhhdCB0ZXN0IHRoZXNlIGNvbXBvbmVudHMgY2hhbmdlIGFmdGVyIGFcbiAgICAgICAgLy8gdXNlciBjaGFuZ2VcbiAgICAgICAgdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZSA9IHRoaXMucGVyc2lzdGVuY2UuZ2V0RG9jdW1lbnRPdmVybGF5Q2FjaGUodCksIHRoaXMuaW5kZXhNYW5hZ2VyID0gdGhpcy5wZXJzaXN0ZW5jZS5nZXRJbmRleE1hbmFnZXIodCksIFxuICAgICAgICB0aGlzLm11dGF0aW9uUXVldWUgPSB0aGlzLnBlcnNpc3RlbmNlLmdldE11dGF0aW9uUXVldWUodCwgdGhpcy5pbmRleE1hbmFnZXIpLCB0aGlzLmxvY2FsRG9jdW1lbnRzID0gbmV3IGtvKHRoaXMuWGksIHRoaXMubXV0YXRpb25RdWV1ZSwgdGhpcy5kb2N1bWVudE92ZXJsYXlDYWNoZSwgdGhpcy5pbmRleE1hbmFnZXIpLCBcbiAgICAgICAgdGhpcy5YaS5zZXRJbmRleE1hbmFnZXIodGhpcy5pbmRleE1hbmFnZXIpLCB0aGlzLldpLmluaXRpYWxpemUodGhpcy5sb2NhbERvY3VtZW50cywgdGhpcy5pbmRleE1hbmFnZXIpO1xuICAgIH1cbiAgICBjb2xsZWN0R2FyYmFnZSh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQ29sbGVjdCBnYXJiYWdlXCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKGUgPT4gdC5jb2xsZWN0KGUsIHRoaXMuSGkpKSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBzdShcbi8qKiBNYW5hZ2VzIG91ciBpbi1tZW1vcnkgb3IgZHVyYWJsZSBwZXJzaXN0ZW5jZS4gKi9cbnQsIGUsIG4sIHMpIHtcbiAgICByZXR1cm4gbmV3IG51KHQsIGUsIG4sIHMpO1xufVxuXG4vKipcbiAqIFRlbGxzIHRoZSBMb2NhbFN0b3JlIHRoYXQgdGhlIGN1cnJlbnRseSBhdXRoZW50aWNhdGVkIHVzZXIgaGFzIGNoYW5nZWQuXG4gKlxuICogSW4gcmVzcG9uc2UgdGhlIGxvY2FsIHN0b3JlIHN3aXRjaGVzIHRoZSBtdXRhdGlvbiBxdWV1ZSB0byB0aGUgbmV3IHVzZXIgYW5kXG4gKiByZXR1cm5zIGFueSByZXN1bHRpbmcgZG9jdW1lbnQgY2hhbmdlcy5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBBbmRyb2lkIGFuZCBpT1Mgb25seSByZXR1cm4gdGhlIGRvY3VtZW50cyBhZmZlY3RlZCBieSB0aGVcbi8vIGNoYW5nZS5cbmFzeW5jIGZ1bmN0aW9uIGl1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICByZXR1cm4gYXdhaXQgbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkhhbmRsZSB1c2VyIGNoYW5nZVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHtcbiAgICAgICAgLy8gU3dhcCBvdXQgdGhlIG11dGF0aW9uIHF1ZXVlLCBncmFiYmluZyB0aGUgcGVuZGluZyBtdXRhdGlvbiBiYXRjaGVzXG4gICAgICAgIC8vIGJlZm9yZSBhbmQgYWZ0ZXIuXG4gICAgICAgIGxldCBzO1xuICAgICAgICByZXR1cm4gbi5tdXRhdGlvblF1ZXVlLmdldEFsbE11dGF0aW9uQmF0Y2hlcyh0KS5uZXh0KChpID0+IChzID0gaSwgbi5aaShlKSwgbi5tdXRhdGlvblF1ZXVlLmdldEFsbE11dGF0aW9uQmF0Y2hlcyh0KSkpKS5uZXh0KChlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBbXSwgciA9IFtdO1xuICAgICAgICAgICAgLy8gVW5pb24gdGhlIG9sZC9uZXcgY2hhbmdlZCBrZXlzLlxuICAgICAgICAgICAgbGV0IG8gPSBncygpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIHMpIHtcbiAgICAgICAgICAgICAgICBpLnB1c2godC5iYXRjaElkKTtcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdC5tdXRhdGlvbnMpIG8gPSBvLmFkZChlLmtleSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICAgICAgICAgIHIucHVzaCh0LmJhdGNoSWQpO1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZSBvZiB0Lm11dGF0aW9ucykgbyA9IG8uYWRkKGUua2V5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIFJldHVybiB0aGUgc2V0IG9mIGFsbCAocG90ZW50aWFsbHkpIGNoYW5nZWQgZG9jdW1lbnRzIGFuZCB0aGUgbGlzdFxuICAgICAgICAgICAgLy8gb2YgbXV0YXRpb24gYmF0Y2ggSURzIHRoYXQgd2VyZSBhZmZlY3RlZCBieSBjaGFuZ2UuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModCwgbykubmV4dCgodCA9PiAoe1xuICAgICAgICAgICAgICAgIHRyOiB0LFxuICAgICAgICAgICAgICAgIHJlbW92ZWRCYXRjaElkczogaSxcbiAgICAgICAgICAgICAgICBhZGRlZEJhdGNoSWRzOiByXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KSk7XG4gICAgfSkpO1xufVxuXG4vKiBBY2NlcHRzIGxvY2FsbHkgZ2VuZXJhdGVkIE11dGF0aW9ucyBhbmQgY29tbWl0IHRoZW0gdG8gc3RvcmFnZS4gKi9cbi8qKlxuICogQWNrbm93bGVkZ2VzIHRoZSBnaXZlbiBiYXRjaC5cbiAqXG4gKiBPbiB0aGUgaGFwcHkgcGF0aCB3aGVuIGEgYmF0Y2ggaXMgYWNrbm93bGVkZ2VkLCB0aGUgbG9jYWwgc3RvcmUgd2lsbFxuICpcbiAqICArIHJlbW92ZSB0aGUgYmF0Y2ggZnJvbSB0aGUgbXV0YXRpb24gcXVldWU7XG4gKiAgKyBhcHBseSB0aGUgY2hhbmdlcyB0byB0aGUgcmVtb3RlIGRvY3VtZW50IGNhY2hlO1xuICogICsgcmVjYWxjdWxhdGUgdGhlIGxhdGVuY3kgY29tcGVuc2F0ZWQgdmlldyBpbXBsaWVkIGJ5IHRob3NlIGNoYW5nZXMgKHRoZXJlXG4gKiAgICBtYXkgYmUgbXV0YXRpb25zIGluIHRoZSBxdWV1ZSB0aGF0IGFmZmVjdCB0aGUgZG9jdW1lbnRzIGJ1dCBoYXZlbid0IGJlZW5cbiAqICAgIGFja25vd2xlZGdlZCB5ZXQpOyBhbmRcbiAqICArIGdpdmUgdGhlIGNoYW5nZWQgZG9jdW1lbnRzIGJhY2sgdGhlIHN5bmMgZW5naW5lXG4gKlxuICogQHJldHVybnMgVGhlIHJlc3VsdGluZyAobW9kaWZpZWQpIGRvY3VtZW50cy5cbiAqL1xuZnVuY3Rpb24gcnUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWNrbm93bGVkZ2UgYmF0Y2hcIiwgXCJyZWFkd3JpdGUtcHJpbWFyeVwiLCAodCA9PiB7XG4gICAgICAgIGNvbnN0IHMgPSBlLmJhdGNoLmtleXMoKSwgaSA9IG4uWGkubmV3Q2hhbmdlQnVmZmVyKHtcbiAgICAgICAgICAgIHRyYWNrUmVtb3ZhbHM6ICEwXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICAgICAgY29uc3QgaSA9IG4uYmF0Y2gsIHIgPSBpLmtleXMoKTtcbiAgICAgICAgICAgIGxldCBvID0gdnQucmVzb2x2ZSgpO1xuICAgICAgICAgICAgcmV0dXJuIHIuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgbyA9IG8ubmV4dCgoKCkgPT4gcy5nZXRFbnRyeShlLCB0KSkpLm5leHQoKGUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByID0gbi5kb2NWZXJzaW9ucy5nZXQodCk7XG4gICAgICAgICAgICAgICAgICAgIEYobnVsbCAhPT0gciksIGUudmVyc2lvbi5jb21wYXJlVG8ocikgPCAwICYmIChpLmFwcGx5VG9SZW1vdGVEb2N1bWVudChlLCBuKSwgZS5pc1ZhbGlkRG9jdW1lbnQoKSAmJiAoXG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHVzZSB0aGUgY29tbWl0VmVyc2lvbiBhcyB0aGUgcmVhZFRpbWUgcmF0aGVyIHRoYW4gdGhlXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50J3MgdXBkYXRlVGltZSBzaW5jZSB0aGUgdXBkYXRlVGltZSBpcyBub3QgYWR2YW5jZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHVwZGF0ZXMgdGhhdCBkbyBub3QgbW9kaWZ5IHRoZSB1bmRlcmx5aW5nIGRvY3VtZW50LlxuICAgICAgICAgICAgICAgICAgICBlLnNldFJlYWRUaW1lKG4uY29tbWl0VmVyc2lvbiksIHMuYWRkRW50cnkoZSkpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIG8ubmV4dCgoKCkgPT4gdC5tdXRhdGlvblF1ZXVlLnJlbW92ZU11dGF0aW9uQmF0Y2goZSwgaSkpKTtcbiAgICAgICAgfVxuICAgICAgICAvKiogUmV0dXJucyB0aGUgbG9jYWwgdmlldyBvZiB0aGUgZG9jdW1lbnRzIGFmZmVjdGVkIGJ5IGEgbXV0YXRpb24gYmF0Y2guICovXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG4gICAgICAgIChuLCB0LCBlLCBpKS5uZXh0KCgoKSA9PiBpLmFwcGx5KHQpKSkubmV4dCgoKCkgPT4gbi5tdXRhdGlvblF1ZXVlLnBlcmZvcm1Db25zaXN0ZW5jeUNoZWNrKHQpKSkubmV4dCgoKCkgPT4gbi5kb2N1bWVudE92ZXJsYXlDYWNoZS5yZW1vdmVPdmVybGF5c0ZvckJhdGNoSWQodCwgcywgZS5iYXRjaC5iYXRjaElkKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXNGb3JEb2N1bWVudEtleXModCwgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgbGV0IGUgPSBncygpO1xuICAgICAgICAgICAgZm9yIChsZXQgbiA9IDA7IG4gPCB0Lm11dGF0aW9uUmVzdWx0cy5sZW5ndGg7ICsrbikge1xuICAgICAgICAgICAgICAgIHQubXV0YXRpb25SZXN1bHRzW25dLnRyYW5zZm9ybVJlc3VsdHMubGVuZ3RoID4gMCAmJiAoZSA9IGUuYWRkKHQuYmF0Y2gubXV0YXRpb25zW25dLmtleSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBSZW1vdmVzIG11dGF0aW9ucyBmcm9tIHRoZSBNdXRhdGlvblF1ZXVlIGZvciB0aGUgc3BlY2lmaWVkIGJhdGNoO1xuICogTG9jYWxEb2N1bWVudHMgd2lsbCBiZSByZWNhbGN1bGF0ZWQuXG4gKlxuICogQHJldHVybnMgVGhlIHJlc3VsdGluZyBtb2RpZmllZCBkb2N1bWVudHMuXG4gKi8gKGUpKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMuZ2V0RG9jdW1lbnRzKHQsIHMpKSk7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIGxhc3QgY29uc2lzdGVudCBzbmFwc2hvdCBwcm9jZXNzZWQgKHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvXG4gKiBkZXRlcm1pbmUgd2hldGhlciB0byBidWZmZXIgaW5jb21pbmcgc25hcHNob3RzIGZyb20gdGhlIGJhY2tlbmQpLlxuICovXG5mdW5jdGlvbiBvdSh0KSB7XG4gICAgY29uc3QgZSA9IEwodCk7XG4gICAgcmV0dXJuIGUucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgbGFzdCByZW1vdGUgc25hcHNob3QgdmVyc2lvblwiLCBcInJlYWRvbmx5XCIsICh0ID0+IGUuRnMuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KSkpO1xufVxuXG4vKipcbiAqIFVwZGF0ZXMgdGhlIFwiZ3JvdW5kLXN0YXRlXCIgKHJlbW90ZSkgZG9jdW1lbnRzLiBXZSBhc3N1bWUgdGhhdCB0aGUgcmVtb3RlXG4gKiBldmVudCByZWZsZWN0cyBhbnkgd3JpdGUgYmF0Y2hlcyB0aGF0IGhhdmUgYmVlbiBhY2tub3dsZWRnZWQgb3IgcmVqZWN0ZWRcbiAqIChpLmUuIHdlIGRvIG5vdCByZS1hcHBseSBsb2NhbCBtdXRhdGlvbnMgdG8gdXBkYXRlcyBmcm9tIHRoaXMgZXZlbnQpLlxuICpcbiAqIExvY2FsRG9jdW1lbnRzIGFyZSByZS1jYWxjdWxhdGVkIGlmIHRoZXJlIGFyZSByZW1haW5pbmcgbXV0YXRpb25zIGluIHRoZVxuICogcXVldWUuXG4gKi8gZnVuY3Rpb24gdXUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gZS5zbmFwc2hvdFZlcnNpb247XG4gICAgbGV0IGkgPSBuLkhpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQXBwbHkgcmVtb3RlIGV2ZW50XCIsIFwicmVhZHdyaXRlLXByaW1hcnlcIiwgKHQgPT4ge1xuICAgICAgICBjb25zdCByID0gbi5YaS5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICAgICAgdHJhY2tSZW1vdmFsczogITBcbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFJlc2V0IG5ld1RhcmdldERhdGFCeVRhcmdldE1hcCBpbiBjYXNlIHRoaXMgdHJhbnNhY3Rpb24gZ2V0cyByZS1ydW4uXG4gICAgICAgICAgICAgICAgaSA9IG4uSGk7XG4gICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgZS50YXJnZXRDaGFuZ2VzLmZvckVhY2goKChyLCB1KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjID0gaS5nZXQodSk7XG4gICAgICAgICAgICBpZiAoIWMpIHJldHVybjtcbiAgICAgICAgICAgIC8vIE9ubHkgdXBkYXRlIHRoZSByZW1vdGUga2V5cyBpZiB0aGUgdGFyZ2V0IGlzIHN0aWxsIGFjdGl2ZS4gVGhpc1xuICAgICAgICAgICAgLy8gZW5zdXJlcyB0aGF0IHdlIGNhbiBwZXJzaXN0IHRoZSB1cGRhdGVkIHRhcmdldCBkYXRhIGFsb25nIHdpdGhcbiAgICAgICAgICAgIC8vIHRoZSB1cGRhdGVkIGFzc2lnbm1lbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2gobi5Gcy5yZW1vdmVNYXRjaGluZ0tleXModCwgci5yZW1vdmVkRG9jdW1lbnRzLCB1KS5uZXh0KCgoKSA9PiBuLkZzLmFkZE1hdGNoaW5nS2V5cyh0LCByLmFkZGVkRG9jdW1lbnRzLCB1KSkpKTtcbiAgICAgICAgICAgIGxldCBhID0gYy53aXRoU2VxdWVuY2VOdW1iZXIodC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgbnVsbCAhPT0gZS50YXJnZXRNaXNtYXRjaGVzLmdldCh1KSA/IGEgPSBhLndpdGhSZXN1bWVUb2tlbihWZS5FTVBUWV9CWVRFX1NUUklORywgcnQubWluKCkpLndpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKHJ0Lm1pbigpKSA6IHIucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCAmJiAoYSA9IGEud2l0aFJlc3VtZVRva2VuKHIucmVzdW1lVG9rZW4sIHMpKSwgXG4gICAgICAgICAgICBpID0gaS5pbnNlcnQodSwgYSksIFxuICAgICAgICAgICAgLy8gVXBkYXRlIHRoZSB0YXJnZXQgZGF0YSBpZiB0aGVyZSBhcmUgdGFyZ2V0IGNoYW5nZXMgKG9yIGlmXG4gICAgICAgICAgICAvLyBzdWZmaWNpZW50IHRpbWUgaGFzIHBhc3NlZCBzaW5jZSB0aGUgbGFzdCB1cGRhdGUpLlxuICAgICAgICAgICAgLyoqXG4gKiBSZXR1cm5zIHRydWUgaWYgdGhlIG5ld1RhcmdldERhdGEgc2hvdWxkIGJlIHBlcnNpc3RlZCBkdXJpbmcgYW4gdXBkYXRlIG9mXG4gKiBhbiBhY3RpdmUgdGFyZ2V0LiBUYXJnZXREYXRhIHNob3VsZCBhbHdheXMgYmUgcGVyc2lzdGVkIHdoZW4gYSB0YXJnZXQgaXNcbiAqIGJlaW5nIHJlbGVhc2VkIGFuZCBzaG91bGQgbm90IGNhbGwgdGhpcyBmdW5jdGlvbi5cbiAqXG4gKiBXaGlsZSB0aGUgdGFyZ2V0IGlzIGFjdGl2ZSwgVGFyZ2V0RGF0YSB1cGRhdGVzIGNhbiBiZSBvbWl0dGVkIHdoZW4gbm90aGluZ1xuICogYWJvdXQgdGhlIHRhcmdldCBoYXMgY2hhbmdlZCBleGNlcHQgbWV0YWRhdGEgbGlrZSB0aGUgcmVzdW1lIHRva2VuIG9yXG4gKiBzbmFwc2hvdCB2ZXJzaW9uLiBPY2Nhc2lvbmFsbHkgaXQncyB3b3J0aCB0aGUgZXh0cmEgd3JpdGUgdG8gcHJldmVudCB0aGVzZVxuICogdmFsdWVzIGZyb20gZ2V0dGluZyB0b28gc3RhbGUgYWZ0ZXIgYSBjcmFzaCwgYnV0IHRoaXMgZG9lc24ndCBoYXZlIHRvIGJlXG4gKiB0b28gZnJlcXVlbnQuXG4gKi9cbiAgICAgICAgICAgIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgICAgICAvLyBBbHdheXMgcGVyc2lzdCB0YXJnZXQgZGF0YSBpZiB3ZSBkb24ndCBhbHJlYWR5IGhhdmUgYSByZXN1bWUgdG9rZW4uXG4gICAgICAgICAgICAgICAgaWYgKDAgPT09IHQucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpKSByZXR1cm4gITA7XG4gICAgICAgICAgICAgICAgLy8gRG9uJ3QgYWxsb3cgcmVzdW1lIHRva2VuIGNoYW5nZXMgdG8gYmUgYnVmZmVyZWQgaW5kZWZpbml0ZWx5LiBUaGlzXG4gICAgICAgICAgICAgICAgLy8gYWxsb3dzIHVzIHRvIGJlIHJlYXNvbmFibHkgdXAtdG8tZGF0ZSBhZnRlciBhIGNyYXNoIGFuZCBhdm9pZHMgbmVlZGluZ1xuICAgICAgICAgICAgICAgIC8vIHRvIGxvb3Agb3ZlciBhbGwgYWN0aXZlIHF1ZXJpZXMgb24gc2h1dGRvd24uIEVzcGVjaWFsbHkgaW4gdGhlIGJyb3dzZXJcbiAgICAgICAgICAgICAgICAvLyB3ZSBtYXkgbm90IGdldCB0aW1lIHRvIGRvIGFueXRoaW5nIGludGVyZXN0aW5nIHdoaWxlIHRoZSBjdXJyZW50IHRhYiBpc1xuICAgICAgICAgICAgICAgIC8vIGNsb3NpbmcuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlLnNuYXBzaG90VmVyc2lvbi50b01pY3Jvc2Vjb25kcygpIC0gdC5zbmFwc2hvdFZlcnNpb24udG9NaWNyb3NlY29uZHMoKSA+PSAzZTgpIHJldHVybiAhMDtcbiAgICAgICAgICAgICAgICAvLyBPdGhlcndpc2UgaWYgdGhlIG9ubHkgdGhpbmcgdGhhdCBoYXMgY2hhbmdlZCBhYm91dCBhIHRhcmdldCBpcyBpdHMgcmVzdW1lXG4gICAgICAgICAgICAgICAgLy8gdG9rZW4gaXQncyBub3Qgd29ydGggcGVyc2lzdGluZy4gTm90ZSB0aGF0IHRoZSBSZW1vdGVTdG9yZSBrZWVwcyBhblxuICAgICAgICAgICAgICAgIC8vIGluLW1lbW9yeSB2aWV3IG9mIHRoZSBjdXJyZW50bHkgYWN0aXZlIHRhcmdldHMgd2hpY2ggaW5jbHVkZXMgdGhlIGN1cnJlbnRcbiAgICAgICAgICAgICAgICAvLyByZXN1bWUgdG9rZW4sIHNvIHN0cmVhbSBmYWlsdXJlIG9yIHVzZXIgY2hhbmdlcyB3aWxsIHN0aWxsIHVzZSBhblxuICAgICAgICAgICAgICAgIC8vIHVwLXRvLWRhdGUgcmVzdW1lIHRva2VuIHJlZ2FyZGxlc3Mgb2Ygd2hhdCB3ZSBkbyBoZXJlLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbi5hZGRlZERvY3VtZW50cy5zaXplICsgbi5tb2RpZmllZERvY3VtZW50cy5zaXplICsgbi5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBOb3RpZmllcyBsb2NhbCBzdG9yZSBvZiB0aGUgY2hhbmdlZCB2aWV3cyB0byBsb2NhbGx5IHBpbiBkb2N1bWVudHMuXG4gKi8gKGMsIGEsIHIpICYmIG8ucHVzaChuLkZzLnVwZGF0ZVRhcmdldERhdGEodCwgYSkpO1xuICAgICAgICB9KSk7XG4gICAgICAgIGxldCB1ID0gY3MoKSwgYyA9IGdzKCk7XG4gICAgICAgIC8vIEhBQ0s6IFRoZSBvbmx5IHJlYXNvbiB3ZSBhbGxvdyBhIG51bGwgc25hcHNob3QgdmVyc2lvbiBpcyBzbyB0aGF0IHdlXG4gICAgICAgIC8vIGNhbiBzeW50aGVzaXplIHJlbW90ZSBldmVudHMgd2hlbiB3ZSBnZXQgcGVybWlzc2lvbiBkZW5pZWQgZXJyb3JzIHdoaWxlXG4gICAgICAgIC8vIHRyeWluZyB0byByZXNvbHZlIHRoZSBzdGF0ZSBvZiBhIGxvY2FsbHkgY2FjaGVkIGRvY3VtZW50IHRoYXQgaXMgaW5cbiAgICAgICAgLy8gbGltYm8uXG4gICAgICAgIGlmIChlLmRvY3VtZW50VXBkYXRlcy5mb3JFYWNoKChzID0+IHtcbiAgICAgICAgICAgIGUucmVzb2x2ZWRMaW1ib0RvY3VtZW50cy5oYXMocykgJiYgby5wdXNoKG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUudXBkYXRlTGltYm9Eb2N1bWVudCh0LCBzKSk7XG4gICAgICAgIH0pKSwgXG4gICAgICAgIC8vIEVhY2ggbG9vcCBpdGVyYXRpb24gb25seSBhZmZlY3RzIGl0cyBcIm93blwiIGRvYywgc28gaXQncyBzYWZlIHRvIGdldCBhbGxcbiAgICAgICAgLy8gdGhlIHJlbW90ZSBkb2N1bWVudHMgaW4gYWR2YW5jZSBpbiBhIHNpbmdsZSBjYWxsLlxuICAgICAgICBvLnB1c2goY3UodCwgciwgZS5kb2N1bWVudFVwZGF0ZXMpLm5leHQoKHQgPT4ge1xuICAgICAgICAgICAgdSA9IHQuZXIsIGMgPSB0Lm5yO1xuICAgICAgICB9KSkpLCAhcy5pc0VxdWFsKHJ0Lm1pbigpKSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IG4uRnMuZ2V0TGFzdFJlbW90ZVNuYXBzaG90VmVyc2lvbih0KS5uZXh0KChlID0+IG4uRnMuc2V0VGFyZ2V0c01ldGFkYXRhKHQsIHQuY3VycmVudFNlcXVlbmNlTnVtYmVyLCBzKSkpO1xuICAgICAgICAgICAgby5wdXNoKGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2dC53YWl0Rm9yKG8pLm5leHQoKCgpID0+IHIuYXBwbHkodCkpKS5uZXh0KCgoKSA9PiBuLmxvY2FsRG9jdW1lbnRzLmdldExvY2FsVmlld09mRG9jdW1lbnRzKHQsIHUsIGMpKSkubmV4dCgoKCkgPT4gdSkpO1xuICAgIH0pKS50aGVuKCh0ID0+IChuLkhpID0gaSwgdCkpKTtcbn1cblxuLyoqXG4gKiBQb3B1bGF0ZXMgZG9jdW1lbnQgY2hhbmdlIGJ1ZmZlciB3aXRoIGRvY3VtZW50cyBmcm9tIGJhY2tlbmQgb3IgYSBidW5kbGUuXG4gKiBSZXR1cm5zIHRoZSBkb2N1bWVudCBjaGFuZ2VzIHJlc3VsdGluZyBmcm9tIGFwcGx5aW5nIHRob3NlIGRvY3VtZW50cywgYW5kXG4gKiBhbHNvIGEgc2V0IG9mIGRvY3VtZW50cyB3aG9zZSBleGlzdGVuY2Ugc3RhdGUgYXJlIGNoYW5nZWQgYXMgYSByZXN1bHQuXG4gKlxuICogQHBhcmFtIHR4biAtIFRyYW5zYWN0aW9uIHRvIHVzZSB0byByZWFkIGV4aXN0aW5nIGRvY3VtZW50cyBmcm9tIHN0b3JhZ2UuXG4gKiBAcGFyYW0gZG9jdW1lbnRCdWZmZXIgLSBEb2N1bWVudCBidWZmZXIgdG8gY29sbGVjdCB0aGUgcmVzdWx0ZWQgY2hhbmdlcyB0byBiZVxuICogICAgICAgIGFwcGxpZWQgdG8gc3RvcmFnZS5cbiAqIEBwYXJhbSBkb2N1bWVudHMgLSBEb2N1bWVudHMgdG8gYmUgYXBwbGllZC5cbiAqLyBmdW5jdGlvbiBjdSh0LCBlLCBuKSB7XG4gICAgbGV0IHMgPSBncygpLCBpID0gZ3MoKTtcbiAgICByZXR1cm4gbi5mb3JFYWNoKCh0ID0+IHMgPSBzLmFkZCh0KSkpLCBlLmdldEVudHJpZXModCwgcykubmV4dCgodCA9PiB7XG4gICAgICAgIGxldCBzID0gY3MoKTtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgoKG4sIHIpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG8gPSB0LmdldChuKTtcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHNlZSBpZiB0aGVyZSBpcyBhIGV4aXN0ZW5jZSBzdGF0ZSBjaGFuZ2UgZm9yIHRoaXMgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgICAgICAgICByLmlzRm91bmREb2N1bWVudCgpICE9PSBvLmlzRm91bmREb2N1bWVudCgpICYmIChpID0gaS5hZGQobikpLCBcbiAgICAgICAgICAgIC8vIE5vdGU6IFRoZSBvcmRlciBvZiB0aGUgc3RlcHMgYmVsb3cgaXMgaW1wb3J0YW50LCBzaW5jZSB3ZSB3YW50XG4gICAgICAgICAgICAvLyB0byBlbnN1cmUgdGhhdCByZWplY3RlZCBsaW1ibyByZXNvbHV0aW9ucyAod2hpY2ggZmFicmljYXRlXG4gICAgICAgICAgICAvLyBOb0RvY3VtZW50cyB3aXRoIFNuYXBzaG90VmVyc2lvbi5taW4oKSkgbmV2ZXIgYWRkIGRvY3VtZW50cyB0b1xuICAgICAgICAgICAgLy8gY2FjaGUuXG4gICAgICAgICAgICByLmlzTm9Eb2N1bWVudCgpICYmIHIudmVyc2lvbi5pc0VxdWFsKHJ0Lm1pbigpKSA/IChcbiAgICAgICAgICAgIC8vIE5vRG9jdW1lbnRzIHdpdGggU25hcHNob3RWZXJzaW9uLm1pbigpIGFyZSB1c2VkIGluIG1hbnVmYWN0dXJlZFxuICAgICAgICAgICAgLy8gZXZlbnRzLiBXZSByZW1vdmUgdGhlc2UgZG9jdW1lbnRzIGZyb20gY2FjaGUgc2luY2Ugd2UgbG9zdFxuICAgICAgICAgICAgLy8gYWNjZXNzLlxuICAgICAgICAgICAgZS5yZW1vdmVFbnRyeShuLCByLnJlYWRUaW1lKSwgcyA9IHMuaW5zZXJ0KG4sIHIpKSA6ICFvLmlzVmFsaWREb2N1bWVudCgpIHx8IHIudmVyc2lvbi5jb21wYXJlVG8oby52ZXJzaW9uKSA+IDAgfHwgMCA9PT0gci52ZXJzaW9uLmNvbXBhcmVUbyhvLnZlcnNpb24pICYmIG8uaGFzUGVuZGluZ1dyaXRlcyA/IChlLmFkZEVudHJ5KHIpLCBcbiAgICAgICAgICAgIHMgPSBzLmluc2VydChuLCByKSkgOiBOKFwiTG9jYWxTdG9yZVwiLCBcIklnbm9yaW5nIG91dGRhdGVkIHdhdGNoIHVwZGF0ZSBmb3IgXCIsIG4sIFwiLiBDdXJyZW50IHZlcnNpb246XCIsIG8udmVyc2lvbiwgXCIgV2F0Y2ggdmVyc2lvbjpcIiwgci52ZXJzaW9uKTtcbiAgICAgICAgfSkpLCB7XG4gICAgICAgICAgICBlcjogcyxcbiAgICAgICAgICAgIG5yOiBpXG4gICAgICAgIH07XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIEdldHMgdGhlIG11dGF0aW9uIGJhdGNoIGFmdGVyIHRoZSBwYXNzZWQgaW4gYmF0Y2hJZCBpbiB0aGUgbXV0YXRpb24gcXVldWVcbiAqIG9yIG51bGwgaWYgZW1wdHkuXG4gKiBAcGFyYW0gYWZ0ZXJCYXRjaElkIC0gSWYgcHJvdmlkZWQsIHRoZSBiYXRjaCB0byBzZWFyY2ggYWZ0ZXIuXG4gKiBAcmV0dXJucyBUaGUgbmV4dCBtdXRhdGlvbiBvciBudWxsIGlmIHRoZXJlIHdhc24ndCBvbmUuXG4gKi9cbmZ1bmN0aW9uIGF1KHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCBuZXh0IG11dGF0aW9uIGJhdGNoXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gKHZvaWQgMCA9PT0gZSAmJiAoZSA9IC0xKSwgXG4gICAgbi5tdXRhdGlvblF1ZXVlLmdldE5leHRNdXRhdGlvbkJhdGNoQWZ0ZXJCYXRjaElkKHQsIGUpKSkpO1xufVxuXG4vKipcbiAqIFJlYWRzIHRoZSBjdXJyZW50IHZhbHVlIG9mIGEgRG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSBvciBudWxsIGlmIG5vdFxuICogZm91bmQgLSB1c2VkIGZvciB0ZXN0aW5nLlxuICovXG4vKipcbiAqIEFzc2lnbnMgdGhlIGdpdmVuIHRhcmdldCBhbiBpbnRlcm5hbCBJRCBzbyB0aGF0IGl0cyByZXN1bHRzIGNhbiBiZSBwaW5uZWQgc29cbiAqIHRoZXkgZG9uJ3QgZ2V0IEdDJ2QuIEEgdGFyZ2V0IG11c3QgYmUgYWxsb2NhdGVkIGluIHRoZSBsb2NhbCBzdG9yZSBiZWZvcmVcbiAqIHRoZSBzdG9yZSBjYW4gYmUgdXNlZCB0byBtYW5hZ2UgaXRzIHZpZXcuXG4gKlxuICogQWxsb2NhdGluZyBhbiBhbHJlYWR5IGFsbG9jYXRlZCBgVGFyZ2V0YCB3aWxsIHJldHVybiB0aGUgZXhpc3RpbmcgYFRhcmdldERhdGFgXG4gKiBmb3IgdGhhdCBgVGFyZ2V0YC5cbiAqL1xuZnVuY3Rpb24gaHUodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQWxsb2NhdGUgdGFyZ2V0XCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IHtcbiAgICAgICAgbGV0IHM7XG4gICAgICAgIHJldHVybiBuLkZzLmdldFRhcmdldERhdGEodCwgZSkubmV4dCgoaSA9PiBpID8gKFxuICAgICAgICAvLyBUaGlzIHRhcmdldCBoYXMgYmVlbiBsaXN0ZW5lZCB0byBwcmV2aW91c2x5LCBzbyByZXVzZSB0aGVcbiAgICAgICAgLy8gcHJldmlvdXMgdGFyZ2V0SUQuXG4gICAgICAgIC8vIFRPRE8obWNnKTogZnJlc2hlbiBsYXN0IGFjY2Vzc2VkIGRhdGU/XG4gICAgICAgIHMgPSBpLCB2dC5yZXNvbHZlKHMpKSA6IG4uRnMuYWxsb2NhdGVUYXJnZXRJZCh0KS5uZXh0KChpID0+IChzID0gbmV3IGNyKGUsIGksIFwiVGFyZ2V0UHVycG9zZUxpc3RlblwiIC8qIFRhcmdldFB1cnBvc2UuTGlzdGVuICovICwgdC5jdXJyZW50U2VxdWVuY2VOdW1iZXIpLCBcbiAgICAgICAgbi5Gcy5hZGRUYXJnZXREYXRhKHQsIHMpLm5leHQoKCgpID0+IHMpKSkpKSkpO1xuICAgIH0pKS50aGVuKCh0ID0+IHtcbiAgICAgICAgLy8gSWYgTXVsdGktVGFiIGlzIGVuYWJsZWQsIHRoZSBleGlzdGluZyB0YXJnZXQgZGF0YSBtYXkgYmUgbmV3ZXIgdGhhblxuICAgICAgICAvLyB0aGUgaW4tbWVtb3J5IGRhdGFcbiAgICAgICAgY29uc3QgcyA9IG4uSGkuZ2V0KHQudGFyZ2V0SWQpO1xuICAgICAgICByZXR1cm4gKG51bGwgPT09IHMgfHwgdC5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHMuc25hcHNob3RWZXJzaW9uKSA+IDApICYmIChuLkhpID0gbi5IaS5pbnNlcnQodC50YXJnZXRJZCwgdCksIFxuICAgICAgICBuLkppLnNldChlLCB0LnRhcmdldElkKSksIHQ7XG4gICAgfSkpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdGhlIFRhcmdldERhdGEgYXMgc2VlbiBieSB0aGUgTG9jYWxTdG9yZSwgaW5jbHVkaW5nIHVwZGF0ZXMgdGhhdCBtYXlcbiAqIGhhdmUgbm90IHlldCBiZWVuIHBlcnNpc3RlZCB0byB0aGUgVGFyZ2V0Q2FjaGUuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmcuXG4vKipcbiAqIFVucGlucyBhbGwgdGhlIGRvY3VtZW50cyBhc3NvY2lhdGVkIHdpdGggdGhlIGdpdmVuIHRhcmdldC4gSWZcbiAqIGBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YWAgaXMgc2V0IHRvIGZhbHNlIGFuZCBFYWdlciBHQyBlbmFibGVkLCB0aGUgbWV0aG9kXG4gKiBkaXJlY3RseSByZW1vdmVzIHRoZSBhc3NvY2lhdGVkIHRhcmdldCBkYXRhIGZyb20gdGhlIHRhcmdldCBjYWNoZS5cbiAqXG4gKiBSZWxlYXNpbmcgYSBub24tZXhpc3RpbmcgYFRhcmdldGAgaXMgYSBuby1vcC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBga2VlcFBlcnNpc3RlZFRhcmdldERhdGFgIGlzIG11bHRpLXRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gbHUodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBMKHQpLCBpID0gcy5IaS5nZXQoZSksIHIgPSBuID8gXCJyZWFkd3JpdGVcIiA6IFwicmVhZHdyaXRlLXByaW1hcnlcIjtcbiAgICB0cnkge1xuICAgICAgICBuIHx8IGF3YWl0IHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJSZWxlYXNlIHRhcmdldFwiLCByLCAodCA9PiBzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLnJlbW92ZVRhcmdldCh0LCBpKSkpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgaWYgKCFEdCh0KSkgdGhyb3cgdDtcbiAgICAgICAgLy8gQWxsIGByZWxlYXNlVGFyZ2V0YCBkb2VzIGlzIHJlY29yZCB0aGUgZmluYWwgbWV0YWRhdGEgc3RhdGUgZm9yIHRoZVxuICAgICAgICAvLyB0YXJnZXQsIGJ1dCB3ZSd2ZSBiZWVuIHJlY29yZGluZyB0aGlzIHBlcmlvZGljYWxseSBkdXJpbmcgdGFyZ2V0XG4gICAgICAgIC8vIGFjdGl2aXR5LiBJZiB3ZSBsb3NlIHRoaXMgd3JpdGUgdGhpcyBjb3VsZCBjYXVzZSBhIHZlcnkgc2xpZ2h0XG4gICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIG9yZGVyIG9mIHRhcmdldCBkZWxldGlvbiBkdXJpbmcgR0MsIGJ1dCB3ZVxuICAgICAgICAvLyBkb24ndCBkZWZpbmUgZXhhY3QgTFJVIHNlbWFudGljcyBzbyB0aGlzIGlzIGFjY2VwdGFibGUuXG4gICAgICAgIE4oXCJMb2NhbFN0b3JlXCIsIGBGYWlsZWQgdG8gdXBkYXRlIHNlcXVlbmNlIG51bWJlcnMgZm9yIHRhcmdldCAke2V9OiAke3R9YCk7XG4gICAgfVxuICAgIHMuSGkgPSBzLkhpLnJlbW92ZShlKSwgcy5KaS5kZWxldGUoaS50YXJnZXQpO1xufVxuXG4vKipcbiAqIFJ1bnMgdGhlIHNwZWNpZmllZCBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSBhbmQgcmV0dXJucyB0aGUgcmVzdWx0cyxcbiAqIHBvdGVudGlhbGx5IHRha2luZyBhZHZhbnRhZ2Ugb2YgcXVlcnkgZGF0YSBmcm9tIHByZXZpb3VzIGV4ZWN1dGlvbnMgKHN1Y2hcbiAqIGFzIHRoZSBzZXQgb2YgcmVtb3RlIGtleXMpLlxuICpcbiAqIEBwYXJhbSB1c2VQcmV2aW91c1Jlc3VsdHMgLSBXaGV0aGVyIHJlc3VsdHMgZnJvbSBwcmV2aW91cyBleGVjdXRpb25zIGNhblxuICogYmUgdXNlZCB0byBvcHRpbWl6ZSB0aGlzIHF1ZXJ5IGV4ZWN1dGlvbi5cbiAqLyBmdW5jdGlvbiBmdSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEwodCk7XG4gICAgbGV0IGkgPSBydC5taW4oKSwgciA9IGdzKCk7XG4gICAgcmV0dXJuIHMucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJFeGVjdXRlIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gTCh0KSwgaSA9IHMuSmkuZ2V0KG4pO1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSBpID8gdnQucmVzb2x2ZShzLkhpLmdldChpKSkgOiBzLkZzLmdldFRhcmdldERhdGEoZSwgbik7XG4gICAgfShzLCB0LCBKbihlKSkubmV4dCgoZSA9PiB7XG4gICAgICAgIGlmIChlKSByZXR1cm4gaSA9IGUubGFzdExpbWJvRnJlZVNuYXBzaG90VmVyc2lvbiwgcy5Gcy5nZXRNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBlLnRhcmdldElkKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgIHIgPSB0O1xuICAgICAgICB9KSk7XG4gICAgfSkpLm5leHQoKCgpID0+IHMuV2kuZ2V0RG9jdW1lbnRzTWF0Y2hpbmdRdWVyeSh0LCBlLCBuID8gaSA6IHJ0Lm1pbigpLCBuID8gciA6IGdzKCkpKSkubmV4dCgodCA9PiAod3Uocywgc3MoZSksIHQpLCBcbiAgICB7XG4gICAgICAgIGRvY3VtZW50czogdCxcbiAgICAgICAgc3I6IHJcbiAgICB9KSkpKSk7XG59XG5cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5mdW5jdGlvbiBkdSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCksIHMgPSBMKG4uRnMpLCBpID0gbi5IaS5nZXQoZSk7XG4gICAgcmV0dXJuIGkgPyBQcm9taXNlLnJlc29sdmUoaS50YXJnZXQpIDogbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIkdldCB0YXJnZXQgZGF0YVwiLCBcInJlYWRvbmx5XCIsICh0ID0+IHMuaGUodCwgZSkubmV4dCgodCA9PiB0ID8gdC50YXJnZXQgOiBudWxsKSkpKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIHRoZSBzZXQgb2YgZG9jdW1lbnRzIHRoYXQgaGF2ZSBiZWVuIHVwZGF0ZWQgc2luY2UgdGhlIGxhc3QgY2FsbC5cbiAqIElmIHRoaXMgaXMgdGhlIGZpcnN0IGNhbGwsIHJldHVybnMgdGhlIHNldCBvZiBjaGFuZ2VzIHNpbmNlIGNsaWVudFxuICogaW5pdGlhbGl6YXRpb24uIEZ1cnRoZXIgaW52b2NhdGlvbnMgd2lsbCByZXR1cm4gZG9jdW1lbnQgdGhhdCBoYXZlIGNoYW5nZWRcbiAqIHNpbmNlIHRoZSBwcmlvciBjYWxsLlxuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuZnVuY3Rpb24gX3UodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gbi5ZaS5nZXQoZSkgfHwgcnQubWluKCk7XG4gICAgLy8gR2V0IHRoZSBjdXJyZW50IG1heGltdW0gcmVhZCB0aW1lIGZvciB0aGUgY29sbGVjdGlvbi4gVGhpcyBzaG91bGQgYWx3YXlzXG4gICAgLy8gZXhpc3QsIGJ1dCB0byByZWR1Y2UgdGhlIGNoYW5jZSBmb3IgcmVncmVzc2lvbnMgd2UgZGVmYXVsdCB0b1xuICAgIC8vIFNuYXBzaG90VmVyc2lvbi5NaW4oKVxuICAgIC8vIFRPRE8oaW5kZXhpbmcpOiBDb25zaWRlciByZW1vdmluZyB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgbmV3IGRvY3VtZW50IGNoYW5nZXNcIiwgXCJyZWFkb25seVwiLCAodCA9PiBuLlhpLmdldEFsbEZyb21Db2xsZWN0aW9uR3JvdXAodCwgZSwgeXQocywgLTEpLCBcbiAgICAvKiBsaW1pdD0gKi8gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpKSkudGhlbigodCA9PiAod3UobiwgZSwgdCksIHQpKSk7XG59XG5cbi8qKiBTZXRzIHRoZSBjb2xsZWN0aW9uIGdyb3VwJ3MgbWF4aW11bSByZWFkIHRpbWUgZnJvbSB0aGUgZ2l2ZW4gZG9jdW1lbnRzLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIHd1KHQsIGUsIG4pIHtcbiAgICBsZXQgcyA9IHQuWWkuZ2V0KGUpIHx8IHJ0Lm1pbigpO1xuICAgIG4uZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgZS5yZWFkVGltZS5jb21wYXJlVG8ocykgPiAwICYmIChzID0gZS5yZWFkVGltZSk7XG4gICAgfSkpLCB0LllpLnNldChlLCBzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHRhcmdldCB1c2luZyB0aGUgZ2l2ZW4gYnVuZGxlIG5hbWUsIHdoaWNoIHdpbGwgYmUgdXNlZCB0b1xuICogaG9sZCB0aGUga2V5cyBvZiBhbGwgZG9jdW1lbnRzIGZyb20gdGhlIGJ1bmRsZSBpbiBxdWVyeS1kb2N1bWVudCBtYXBwaW5ncy5cbiAqIFRoaXMgZW5zdXJlcyB0aGF0IHRoZSBsb2FkZWQgZG9jdW1lbnRzIGRvIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWRcbiAqIHJpZ2h0IGF3YXkuXG4gKi9cbi8qKlxuICogQXBwbGllcyB0aGUgZG9jdW1lbnRzIGZyb20gYSBidW5kbGUgdG8gdGhlIFwiZ3JvdW5kLXN0YXRlXCIgKHJlbW90ZSlcbiAqIGRvY3VtZW50cy5cbiAqXG4gKiBMb2NhbERvY3VtZW50cyBhcmUgcmUtY2FsY3VsYXRlZCBpZiB0aGVyZSBhcmUgcmVtYWluaW5nIG11dGF0aW9ucyBpbiB0aGVcbiAqIHF1ZXVlLlxuICovXG5hc3luYyBmdW5jdGlvbiBtdSh0LCBlLCBuLCBzKSB7XG4gICAgY29uc3QgaSA9IEwodCk7XG4gICAgbGV0IHIgPSBncygpLCBvID0gY3MoKTtcbiAgICBmb3IgKGNvbnN0IHQgb2Ygbikge1xuICAgICAgICBjb25zdCBuID0gZS5pcih0Lm1ldGFkYXRhLm5hbWUpO1xuICAgICAgICB0LmRvY3VtZW50ICYmIChyID0gci5hZGQobikpO1xuICAgICAgICBjb25zdCBzID0gZS5ycih0KTtcbiAgICAgICAgcy5zZXRSZWFkVGltZShlLnVyKHQubWV0YWRhdGEucmVhZFRpbWUpKSwgbyA9IG8uaW5zZXJ0KG4sIHMpO1xuICAgIH1cbiAgICBjb25zdCB1ID0gaS5YaS5uZXdDaGFuZ2VCdWZmZXIoe1xuICAgICAgICB0cmFja1JlbW92YWxzOiAhMFxuICAgIH0pLCBjID0gYXdhaXQgaHUoaSwgZnVuY3Rpb24odCkge1xuICAgICAgICAvLyBJdCBpcyBPSyB0aGF0IHRoZSBwYXRoIHVzZWQgZm9yIHRoZSBxdWVyeSBpcyBub3QgdmFsaWQsIGJlY2F1c2UgdGhpcyB3aWxsXG4gICAgICAgIC8vIG5vdCBiZSByZWFkIGFuZCBxdWVyaWVkLlxuICAgICAgICByZXR1cm4gSm4oR24odXQuZnJvbVN0cmluZyhgX19idW5kbGVfXy9kb2NzLyR7dH1gKSkpO1xuICAgIH0ocykpO1xuICAgIC8vIEFsbG9jYXRlcyBhIHRhcmdldCB0byBob2xkIGFsbCBkb2N1bWVudCBrZXlzIGZyb20gdGhlIGJ1bmRsZSwgc3VjaCB0aGF0XG4gICAgLy8gdGhleSB3aWxsIG5vdCBnZXQgZ2FyYmFnZSBjb2xsZWN0ZWQgcmlnaHQgYXdheS5cbiAgICAgICAgcmV0dXJuIGkucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJBcHBseSBidW5kbGUgZG9jdW1lbnRzXCIsIFwicmVhZHdyaXRlXCIsICh0ID0+IGN1KHQsIHUsIG8pLm5leHQoKGUgPT4gKHUuYXBwbHkodCksIFxuICAgIGUpKSkubmV4dCgoZSA9PiBpLkZzLnJlbW92ZU1hdGNoaW5nS2V5c0ZvclRhcmdldElkKHQsIGMudGFyZ2V0SWQpLm5leHQoKCgpID0+IGkuRnMuYWRkTWF0Y2hpbmdLZXlzKHQsIHIsIGMudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5sb2NhbERvY3VtZW50cy5nZXRMb2NhbFZpZXdPZkRvY3VtZW50cyh0LCBlLmVyLCBlLm5yKSkpLm5leHQoKCgpID0+IGUuZXIpKSkpKSk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBib29sZWFuIHRvIGluZGljYXRlIGlmIHRoZSBnaXZlbiBidW5kbGUgaGFzIGFscmVhZHlcbiAqIGJlZW4gbG9hZGVkIGFuZCB0aGUgY3JlYXRlIHRpbWUgaXMgbmV3ZXIgdGhhbiB0aGUgY3VycmVudCBsb2FkaW5nIGJ1bmRsZS5cbiAqL1xuLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYE5hbWVkUXVlcnlgIHRvIGxvY2FsIHBlcnNpc3RlbmNlLlxuICovXG5hc3luYyBmdW5jdGlvbiBndSh0LCBlLCBuID0gZ3MoKSkge1xuICAgIC8vIEFsbG9jYXRlIGEgdGFyZ2V0IGZvciB0aGUgbmFtZWQgcXVlcnkgc3VjaCB0aGF0IGl0IGNhbiBiZSByZXN1bWVkXG4gICAgLy8gZnJvbSBhc3NvY2lhdGVkIHJlYWQgdGltZSBpZiB1c2VycyB1c2UgaXQgdG8gbGlzdGVuLlxuICAgIC8vIE5PVEU6IHRoaXMgYWxzbyBtZWFucyBpZiBubyBjb3JyZXNwb25kaW5nIHRhcmdldCBleGlzdHMsIHRoZSBuZXcgdGFyZ2V0XG4gICAgLy8gd2lsbCByZW1haW4gYWN0aXZlIGFuZCB3aWxsIG5vdCBnZXQgY29sbGVjdGVkLCB1bmxlc3MgdXNlcnMgaGFwcGVuIHRvXG4gICAgLy8gdW5saXN0ZW4gdGhlIHF1ZXJ5IHNvbWVob3cuXG4gICAgY29uc3QgcyA9IGF3YWl0IGh1KHQsIEpuKHlyKGUuYnVuZGxlZFF1ZXJ5KSkpLCBpID0gTCh0KTtcbiAgICByZXR1cm4gaS5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlNhdmUgbmFtZWQgcXVlcnlcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4ge1xuICAgICAgICBjb25zdCByID0gTmkoZS5yZWFkVGltZSk7XG4gICAgICAgIC8vIFNpbXBseSBzYXZlIHRoZSBxdWVyeSBpdHNlbGYgaWYgaXQgaXMgb2xkZXIgdGhhbiB3aGF0IHRoZSBTREsgYWxyZWFkeVxuICAgICAgICAvLyBoYXMuXG4gICAgICAgICAgICAgICAgaWYgKHMuc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhyKSA+PSAwKSByZXR1cm4gaS5Mcy5zYXZlTmFtZWRRdWVyeSh0LCBlKTtcbiAgICAgICAgLy8gVXBkYXRlIGV4aXN0aW5nIHRhcmdldCBkYXRhIGJlY2F1c2UgdGhlIHF1ZXJ5IGZyb20gdGhlIGJ1bmRsZSBpcyBuZXdlci5cbiAgICAgICAgICAgICAgICBjb25zdCBvID0gcy53aXRoUmVzdW1lVG9rZW4oVmUuRU1QVFlfQllURV9TVFJJTkcsIHIpO1xuICAgICAgICByZXR1cm4gaS5IaSA9IGkuSGkuaW5zZXJ0KG8udGFyZ2V0SWQsIG8pLCBpLkZzLnVwZGF0ZVRhcmdldERhdGEodCwgbykubmV4dCgoKCkgPT4gaS5Gcy5yZW1vdmVNYXRjaGluZ0tleXNGb3JUYXJnZXRJZCh0LCBzLnRhcmdldElkKSkpLm5leHQoKCgpID0+IGkuRnMuYWRkTWF0Y2hpbmdLZXlzKHQsIG4sIHMudGFyZ2V0SWQpKSkubmV4dCgoKCkgPT4gaS5Mcy5zYXZlTmFtZWRRdWVyeSh0LCBlKSkpO1xuICAgIH0pKTtcbn1cblxuLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiB5dSh0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfY2xpZW50c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgZm9ybWF0IG9mIHRoZSBXZWJTdG9yYWdlIGtleSB0aGF0IHN0b3JlcyB0aGUgbXV0YXRpb24gc3RhdGUgaXM6XG4vLyAgICAgZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+XG4vLyAgICAgKGZvciB1bmF1dGhlbnRpY2F0ZWQgdXNlcnMpXG4vLyBvcjogZmlyZXN0b3JlX211dGF0aW9uc188cGVyc2lzdGVuY2VfcHJlZml4Pl88YmF0Y2hfaWQ+Xzx1c2VyX3VpZD5cblxuLy8gJ3VzZXJfdWlkJyBpcyBsYXN0IHRvIGF2b2lkIG5lZWRpbmcgdG8gZXNjYXBlICdfJyBjaGFyYWN0ZXJzIHRoYXQgaXQgbWlnaHRcbi8vIGNvbnRhaW4uXG4vKiogQXNzZW1ibGVzIHRoZSBrZXkgZm9yIGEgbXV0YXRpb24gYmF0Y2ggaW4gV2ViU3RvcmFnZSAqL1xuZnVuY3Rpb24gcHUodCwgZSwgbikge1xuICAgIGxldCBzID0gYGZpcmVzdG9yZV9tdXRhdGlvbnNfJHt0fV8ke259YDtcbiAgICByZXR1cm4gZS5pc0F1dGhlbnRpY2F0ZWQoKSAmJiAocyArPSBgXyR7ZS51aWR9YCksIHM7XG59XG5cbi8vIFRoZSBmb3JtYXQgb2YgdGhlIFdlYlN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIGEgcXVlcnkgdGFyZ2V0J3MgbWV0YWRhdGEgaXM6XG4vLyAgICAgZmlyZXN0b3JlX3RhcmdldHNfPHBlcnNpc3RlbmNlX3ByZWZpeD5fPHRhcmdldF9pZD5cbi8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgYSBxdWVyeSBzdGF0ZSBpbiBXZWJTdG9yYWdlICovXG5mdW5jdGlvbiBJdSh0LCBlKSB7XG4gICAgcmV0dXJuIGBmaXJlc3RvcmVfdGFyZ2V0c18ke3R9XyR7ZX1gO1xufVxuXG4vLyBUaGUgV2ViU3RvcmFnZSBwcmVmaXggdGhhdCBzdG9yZXMgdGhlIHByaW1hcnkgdGFiJ3Mgb25saW5lIHN0YXRlLiBUaGVcbi8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuLy8gICAgIGZpcmVzdG9yZV9vbmxpbmVfc3RhdGVfPHBlcnNpc3RlbmNlX3ByZWZpeD5cbi8qKlxuICogSG9sZHMgdGhlIHN0YXRlIG9mIGEgbXV0YXRpb24gYmF0Y2gsIGluY2x1ZGluZyBpdHMgdXNlciBJRCwgYmF0Y2ggSUQgYW5kXG4gKiB3aGV0aGVyIHRoZSBiYXRjaCBpcyAncGVuZGluZycsICdhY2tub3dsZWRnZWQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIFR1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMudXNlciA9IHQsIHRoaXMuYmF0Y2hJZCA9IGUsIHRoaXMuc3RhdGUgPSBuLCB0aGlzLmVycm9yID0gcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgTXV0YXRpb25NZXRhZGF0YSBmcm9tIGl0cyBKU09OIHJlcHJlc2VudGF0aW9uIGluIFdlYlN0b3JhZ2UuXG4gICAgICogTG9ncyBhIHdhcm5pbmcgYW5kIHJldHVybnMgbnVsbCBpZiB0aGUgZm9ybWF0IG9mIHRoZSBkYXRhIGlzIG5vdCB2YWxpZC5cbiAgICAgKi8gICAgc3RhdGljIGNyKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEpTT04ucGFyc2Uobik7XG4gICAgICAgIGxldCBpLCByID0gXCJvYmplY3RcIiA9PSB0eXBlb2YgcyAmJiAtMSAhPT0gWyBcInBlbmRpbmdcIiwgXCJhY2tub3dsZWRnZWRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihzLnN0YXRlKSAmJiAodm9pZCAwID09PSBzLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIHMuZXJyb3IpO1xuICAgICAgICByZXR1cm4gciAmJiBzLmVycm9yICYmIChyID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIHMuZXJyb3IuY29kZSwgXG4gICAgICAgIHIgJiYgKGkgPSBuZXcgVShzLmVycm9yLmNvZGUsIHMuZXJyb3IubWVzc2FnZSkpKSwgciA/IG5ldyBUdSh0LCBlLCBzLnN0YXRlLCBpKSA6IChrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBtdXRhdGlvbiBzdGF0ZSBmb3IgSUQgJyR7ZX0nOiAke259YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG4gICAgYXIoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBzdGF0ZTogdGhpcy5zdGF0ZSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdGhpcy5lcnJvciAmJiAodC5lcnJvciA9IHtcbiAgICAgICAgICAgIGNvZGU6IHRoaXMuZXJyb3IuY29kZSxcbiAgICAgICAgICAgIG1lc3NhZ2U6IHRoaXMuZXJyb3IubWVzc2FnZVxuICAgICAgICB9KSwgSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEhvbGRzIHRoZSBzdGF0ZSBvZiBhIHF1ZXJ5IHRhcmdldCwgaW5jbHVkaW5nIGl0cyB0YXJnZXQgSUQgYW5kIHdoZXRoZXIgdGhlXG4gKiB0YXJnZXQgaXMgJ25vdC1jdXJyZW50JywgJ2N1cnJlbnQnIG9yICdyZWplY3RlZCcuXG4gKi9cbi8vIFZpc2libGUgZm9yIHRlc3RpbmdcbmNsYXNzIEV1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMudGFyZ2V0SWQgPSB0LCB0aGlzLnN0YXRlID0gZSwgdGhpcy5lcnJvciA9IG47XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFF1ZXJ5VGFyZ2V0TWV0YWRhdGEgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyBjcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBKU09OLnBhcnNlKGUpO1xuICAgICAgICBsZXQgcywgaSA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4gJiYgLTEgIT09IFsgXCJub3QtY3VycmVudFwiLCBcImN1cnJlbnRcIiwgXCJyZWplY3RlZFwiIF0uaW5kZXhPZihuLnN0YXRlKSAmJiAodm9pZCAwID09PSBuLmVycm9yIHx8IFwib2JqZWN0XCIgPT0gdHlwZW9mIG4uZXJyb3IpO1xuICAgICAgICByZXR1cm4gaSAmJiBuLmVycm9yICYmIChpID0gXCJzdHJpbmdcIiA9PSB0eXBlb2Ygbi5lcnJvci5tZXNzYWdlICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIG4uZXJyb3IuY29kZSwgXG4gICAgICAgIGkgJiYgKHMgPSBuZXcgVShuLmVycm9yLmNvZGUsIG4uZXJyb3IubWVzc2FnZSkpKSwgaSA/IG5ldyBFdSh0LCBuLnN0YXRlLCBzKSA6IChrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSB0YXJnZXQgc3RhdGUgZm9yIElEICcke3R9JzogJHtlfWApLCBcbiAgICAgICAgbnVsbCk7XG4gICAgfVxuICAgIGFyKCkge1xuICAgICAgICBjb25zdCB0ID0ge1xuICAgICAgICAgICAgc3RhdGU6IHRoaXMuc3RhdGUsXG4gICAgICAgICAgICB1cGRhdGVUaW1lTXM6IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3IgJiYgKHQuZXJyb3IgPSB7XG4gICAgICAgICAgICBjb2RlOiB0aGlzLmVycm9yLmNvZGUsXG4gICAgICAgICAgICBtZXNzYWdlOiB0aGlzLmVycm9yLm1lc3NhZ2VcbiAgICAgICAgfSksIEpTT04uc3RyaW5naWZ5KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBUaGlzIGNsYXNzIHJlcHJlc2VudHMgdGhlIGltbXV0YWJsZSBDbGllbnRTdGF0ZSBmb3IgYSBjbGllbnQgcmVhZCBmcm9tXG4gKiBXZWJTdG9yYWdlLCBjb250YWluaW5nIHRoZSBsaXN0IG9mIGFjdGl2ZSBxdWVyeSB0YXJnZXRzLlxuICovIGNsYXNzIEF1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IGU7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIFJlbW90ZUNsaWVudFN0YXRlIGZyb20gdGhlIEpTT04gcmVwcmVzZW50YXRpb24gaW4gV2ViU3RvcmFnZS5cbiAgICAgKiBMb2dzIGEgd2FybmluZyBhbmQgcmV0dXJucyBudWxsIGlmIHRoZSBmb3JtYXQgb2YgdGhlIGRhdGEgaXMgbm90IHZhbGlkLlxuICAgICAqLyAgICBzdGF0aWMgY3IodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZShlKTtcbiAgICAgICAgbGV0IHMgPSBcIm9iamVjdFwiID09IHR5cGVvZiBuICYmIG4uYWN0aXZlVGFyZ2V0SWRzIGluc3RhbmNlb2YgQXJyYXksIGkgPSBwcygpO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgcyAmJiB0IDwgbi5hY3RpdmVUYXJnZXRJZHMubGVuZ3RoOyArK3QpIHMgPSBMdChuLmFjdGl2ZVRhcmdldElkc1t0XSksIFxuICAgICAgICBpID0gaS5hZGQobi5hY3RpdmVUYXJnZXRJZHNbdF0pO1xuICAgICAgICByZXR1cm4gcyA/IG5ldyBBdSh0LCBpKSA6IChrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYEZhaWxlZCB0byBwYXJzZSBjbGllbnQgZGF0YSBmb3IgaW5zdGFuY2UgJyR7dH0nOiAke2V9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogVGhpcyBjbGFzcyByZXByZXNlbnRzIHRoZSBvbmxpbmUgc3RhdGUgZm9yIGFsbCBjbGllbnRzIHBhcnRpY2lwYXRpbmcgaW5cbiAqIG11bHRpLXRhYi4gVGhlIG9ubGluZSBzdGF0ZSBpcyBvbmx5IHdyaXR0ZW4gdG8gYnkgdGhlIHByaW1hcnkgY2xpZW50LCBhbmRcbiAqIHVzZWQgaW4gc2Vjb25kYXJ5IGNsaWVudHMgdG8gdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzLlxuICovIGNsYXNzIFJ1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuY2xpZW50SWQgPSB0LCB0aGlzLm9ubGluZVN0YXRlID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgU2hhcmVkT25saW5lU3RhdGUgZnJvbSBpdHMgSlNPTiByZXByZXNlbnRhdGlvbiBpbiBXZWJTdG9yYWdlLlxuICAgICAqIExvZ3MgYSB3YXJuaW5nIGFuZCByZXR1cm5zIG51bGwgaWYgdGhlIGZvcm1hdCBvZiB0aGUgZGF0YSBpcyBub3QgdmFsaWQuXG4gICAgICovICAgIHN0YXRpYyBjcih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBKU09OLnBhcnNlKHQpO1xuICAgICAgICByZXR1cm4gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSAmJiAtMSAhPT0gWyBcIlVua25vd25cIiwgXCJPbmxpbmVcIiwgXCJPZmZsaW5lXCIgXS5pbmRleE9mKGUub25saW5lU3RhdGUpICYmIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUuY2xpZW50SWQgPyBuZXcgUnUoZS5jbGllbnRJZCwgZS5vbmxpbmVTdGF0ZSkgOiAoayhcIlNoYXJlZENsaWVudFN0YXRlXCIsIGBGYWlsZWQgdG8gcGFyc2Ugb25saW5lIHN0YXRlOiAke3R9YCksIFxuICAgICAgICBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogTWV0YWRhdGEgc3RhdGUgb2YgdGhlIGxvY2FsIGNsaWVudC4gVW5saWtlIGBSZW1vdGVDbGllbnRTdGF0ZWAsIHRoaXMgY2xhc3MgaXNcbiAqIG11dGFibGUgYW5kIGtlZXBzIHRyYWNrIG9mIGFsbCBwZW5kaW5nIG11dGF0aW9ucywgd2hpY2ggYWxsb3dzIHVzIHRvXG4gKiB1cGRhdGUgdGhlIHJhbmdlIG9mIHBlbmRpbmcgbXV0YXRpb24gYmF0Y2ggSURzIGFzIG5ldyBtdXRhdGlvbnMgYXJlIGFkZGVkIG9yXG4gKiByZW1vdmVkLlxuICpcbiAqIFRoZSBkYXRhIGluIGBMb2NhbENsaWVudFN0YXRlYCBpcyBub3QgcmVhZCBmcm9tIFdlYlN0b3JhZ2UgYW5kIGluc3RlYWRcbiAqIHVwZGF0ZWQgdmlhIGl0cyBpbnN0YW5jZSBtZXRob2RzLiBUaGUgdXBkYXRlZCBzdGF0ZSBjYW4gYmUgc2VyaWFsaXplZCB2aWFcbiAqIGB0b1dlYlN0b3JhZ2VKU09OKClgLlxuICovXG4vLyBWaXNpYmxlIGZvciB0ZXN0aW5nLlxuY2xhc3MgdnUge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmFjdGl2ZVRhcmdldElkcyA9IHBzKCk7XG4gICAgfVxuICAgIGhyKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5hZGQodCk7XG4gICAgfVxuICAgIGxyKHQpIHtcbiAgICAgICAgdGhpcy5hY3RpdmVUYXJnZXRJZHMgPSB0aGlzLmFjdGl2ZVRhcmdldElkcy5kZWxldGUodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENvbnZlcnRzIHRoaXMgZW50cnkgaW50byBhIEpTT04tZW5jb2RlZCBmb3JtYXQgd2UgY2FuIHVzZSBmb3IgV2ViU3RvcmFnZS5cbiAgICAgKiBEb2VzIG5vdCBlbmNvZGUgYGNsaWVudElkYCBhcyBpdCBpcyBwYXJ0IG9mIHRoZSBrZXkgaW4gV2ViU3RvcmFnZS5cbiAgICAgKi8gICAgYXIoKSB7XG4gICAgICAgIGNvbnN0IHQgPSB7XG4gICAgICAgICAgICBhY3RpdmVUYXJnZXRJZHM6IHRoaXMuYWN0aXZlVGFyZ2V0SWRzLnRvQXJyYXkoKSxcbiAgICAgICAgICAgIHVwZGF0ZVRpbWVNczogRGF0ZS5ub3coKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIHVzZXMgV2ViU3RvcmFnZSAod2luZG93LmxvY2FsU3RvcmFnZSkgYXMgdGhlXG4gKiBiYWNraW5nIHN0b3JlIGZvciB0aGUgU2hhcmVkQ2xpZW50U3RhdGUuIEl0IGtlZXBzIHRyYWNrIG9mIGFsbCBhY3RpdmVcbiAqIGNsaWVudHMgYW5kIHN1cHBvcnRzIG1vZGlmaWNhdGlvbnMgb2YgdGhlIGxvY2FsIGNsaWVudCdzIGRhdGEuXG4gKi8gY2xhc3MgUHUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgdGhpcy53aW5kb3cgPSB0LCB0aGlzLnNpID0gZSwgdGhpcy5wZXJzaXN0ZW5jZUtleSA9IG4sIHRoaXMuZHIgPSBzLCB0aGlzLnN5bmNFbmdpbmUgPSBudWxsLCBcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZUhhbmRsZXIgPSBudWxsLCB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlciA9IG51bGwsIHRoaXMuX3IgPSB0aGlzLndyLmJpbmQodGhpcyksIFxuICAgICAgICB0aGlzLm1yID0gbmV3IHBlKGV0KSwgdGhpcy5zdGFydGVkID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQ2FwdHVyZXMgV2ViU3RvcmFnZSBldmVudHMgdGhhdCBvY2N1ciBiZWZvcmUgYHN0YXJ0KClgIGlzIGNhbGxlZC4gVGhlc2VcbiAgICAgICAgICogZXZlbnRzIGFyZSByZXBsYXllZCBvbmNlIGBXZWJTdG9yYWdlU2hhcmVkQ2xpZW50U3RhdGVgIGlzIHN0YXJ0ZWQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmdyID0gW107XG4gICAgICAgIC8vIEVzY2FwZSB0aGUgc3BlY2lhbCBjaGFyYWN0ZXJzIG1lbnRpb25lZCBoZXJlOlxuICAgICAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9KYXZhU2NyaXB0L0d1aWRlL1JlZ3VsYXJfRXhwcmVzc2lvbnNcbiAgICAgICAgY29uc3QgciA9IG4ucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csIFwiXFxcXCQmXCIpO1xuICAgICAgICB0aGlzLnN0b3JhZ2UgPSB0aGlzLndpbmRvdy5sb2NhbFN0b3JhZ2UsIHRoaXMuY3VycmVudFVzZXIgPSBpLCB0aGlzLnlyID0geXUodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5kciksIFxuICAgICAgICB0aGlzLnByID0gXG4gICAgICAgIC8qKiBBc3NlbWJsZXMgdGhlIGtleSBmb3IgdGhlIGN1cnJlbnQgc2VxdWVuY2UgbnVtYmVyLiAqL1xuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9zZXF1ZW5jZV9udW1iZXJfJHt0fWA7XG4gICAgICAgIH1cbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHRoaXMucGVyc2lzdGVuY2VLZXkpLCB0aGlzLm1yID0gdGhpcy5tci5pbnNlcnQodGhpcy5kciwgbmV3IHZ1KSwgdGhpcy5JciA9IG5ldyBSZWdFeHAoYF5maXJlc3RvcmVfY2xpZW50c18ke3J9XyhbXl9dKikkYCksIFxuICAgICAgICB0aGlzLlRyID0gbmV3IFJlZ0V4cChgXmZpcmVzdG9yZV9tdXRhdGlvbnNfJHtyfV8oXFxcXGQrKSg/Ol8oLiopKT8kYCksIHRoaXMuRXIgPSBuZXcgUmVnRXhwKGBeZmlyZXN0b3JlX3RhcmdldHNfJHtyfV8oXFxcXGQrKSRgKSwgXG4gICAgICAgIHRoaXMuQXIgPSBcbiAgICAgICAgLyoqIEFzc2VtYmxlcyB0aGUga2V5IGZvciB0aGUgb25saW5lIHN0YXRlIG9mIHRoZSBwcmltYXJ5IHRhYi4gKi9cbiAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgcmV0dXJuIGBmaXJlc3RvcmVfb25saW5lX3N0YXRlXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIHByZWZpeCB0aGF0IHBsYXlzIGFzIGEgZXZlbnQgdG8gaW5kaWNhdGUgdGhlIHJlbW90ZSBkb2N1bWVudHNcbiAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkIGR1ZSB0byBzb21lIHNlY29uZGFyeSB0YWJzIGxvYWRpbmcgYSBidW5kbGUuXG4gICAgICAgIC8vIGZvcm1hdCBvZiB0aGUga2V5IGlzOlxuICAgICAgICAvLyAgICAgZmlyZXN0b3JlX2J1bmRsZV9sb2FkZWRfdjJfPHBlcnNpc3RlbmNlS2V5PlxuICAgICAgICAvLyBUaGUgdmVyc2lvbiBlbmRpbmcgd2l0aCBcInYyXCIgc3RvcmVzIHRoZSBsaXN0IG9mIG1vZGlmaWVkIGNvbGxlY3Rpb24gZ3JvdXBzLlxuICAgICAgICAodGhpcy5wZXJzaXN0ZW5jZUtleSksIHRoaXMuUnIgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICByZXR1cm4gYGZpcmVzdG9yZV9idW5kbGVfbG9hZGVkX3YyXyR7dH1gO1xuICAgICAgICB9XG4gICAgICAgIC8vIFRoZSBXZWJTdG9yYWdlIGtleSBwcmVmaXggZm9yIHRoZSBrZXkgdGhhdCBzdG9yZXMgdGhlIGxhc3Qgc2VxdWVuY2UgbnVtYmVyIGFsbG9jYXRlZC4gVGhlIGtleVxuICAgICAgICAvLyBsb29rcyBsaWtlICdmaXJlc3RvcmVfc2VxdWVuY2VfbnVtYmVyXzxwZXJzaXN0ZW5jZV9wcmVmaXg+Jy5cbiAgICAgICAgKHRoaXMucGVyc2lzdGVuY2VLZXkpLCBcbiAgICAgICAgLy8gUmF0aGVyIHRoYW4gYWRkaW5nIHRoZSBzdG9yYWdlIG9ic2VydmVyIGR1cmluZyBzdGFydCgpLCB3ZSBhZGQgdGhlXG4gICAgICAgIC8vIHN0b3JhZ2Ugb2JzZXJ2ZXIgZHVyaW5nIGluaXRpYWxpemF0aW9uLiBUaGlzIGVuc3VyZXMgdGhhdCB3ZSBjb2xsZWN0XG4gICAgICAgIC8vIGV2ZW50cyBiZWZvcmUgb3RoZXIgY29tcG9uZW50cyBwb3B1bGF0ZSB0aGVpciBpbml0aWFsIHN0YXRlIChkdXJpbmcgdGhlaXJcbiAgICAgICAgLy8gcmVzcGVjdGl2ZSBzdGFydCgpIGNhbGxzKS4gT3RoZXJ3aXNlLCB3ZSBtaWdodCBmb3IgZXhhbXBsZSBtaXNzIGFcbiAgICAgICAgLy8gbXV0YXRpb24gdGhhdCBpcyBhZGRlZCBhZnRlciBMb2NhbFN0b3JlJ3Mgc3RhcnQoKSBwcm9jZXNzZWQgdGhlIGV4aXN0aW5nXG4gICAgICAgIC8vIG11dGF0aW9ucyBidXQgYmVmb3JlIHdlIG9ic2VydmUgV2ViU3RvcmFnZSBldmVudHMuXG4gICAgICAgIHRoaXMud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzdG9yYWdlXCIsIHRoaXMuX3IpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgV2ViU3RvcmFnZSBpcyBhdmFpbGFibGUgaW4gdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQuICovICAgIHN0YXRpYyBEKHQpIHtcbiAgICAgICAgcmV0dXJuICEoIXQgfHwgIXQubG9jYWxTdG9yYWdlKTtcbiAgICB9XG4gICAgYXN5bmMgc3RhcnQoKSB7XG4gICAgICAgIC8vIFJldHJpZXZlIHRoZSBsaXN0IG9mIGV4aXN0aW5nIGNsaWVudHMgdG8gYmFja2ZpbGwgdGhlIGRhdGEgaW5cbiAgICAgICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB0aGlzLnN5bmNFbmdpbmUuTWkoKTtcbiAgICAgICAgZm9yIChjb25zdCBlIG9mIHQpIHtcbiAgICAgICAgICAgIGlmIChlID09PSB0aGlzLmRyKSBjb250aW51ZTtcbiAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLmdldEl0ZW0oeXUodGhpcy5wZXJzaXN0ZW5jZUtleSwgZSkpO1xuICAgICAgICAgICAgaWYgKHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gQXUuY3IoZSwgdCk7XG4gICAgICAgICAgICAgICAgbiAmJiAodGhpcy5tciA9IHRoaXMubXIuaW5zZXJ0KG4uY2xpZW50SWQsIG4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZyKCk7XG4gICAgICAgIC8vIENoZWNrIGlmIHRoZXJlIGlzIGFuIGV4aXN0aW5nIG9ubGluZSBzdGF0ZSBhbmQgY2FsbCB0aGUgY2FsbGJhY2sgaGFuZGxlclxuICAgICAgICAvLyBpZiBhcHBsaWNhYmxlLlxuICAgICAgICBjb25zdCBlID0gdGhpcy5zdG9yYWdlLmdldEl0ZW0odGhpcy5Bcik7XG4gICAgICAgIGlmIChlKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5QcihlKTtcbiAgICAgICAgICAgIHQgJiYgdGhpcy5icih0KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5ncikgdGhpcy53cih0KTtcbiAgICAgICAgdGhpcy5nciA9IFtdLCBcbiAgICAgICAgLy8gUmVnaXN0ZXIgYSB3aW5kb3cgdW5sb2FkIGhvb2sgdG8gcmVtb3ZlIHRoZSBjbGllbnQgbWV0YWRhdGEgZW50cnkgZnJvbVxuICAgICAgICAvLyBXZWJTdG9yYWdlIGV2ZW4gaWYgYHNodXRkb3duKClgIHdhcyBub3QgY2FsbGVkLlxuICAgICAgICB0aGlzLndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicGFnZWhpZGVcIiwgKCgpID0+IHRoaXMuc2h1dGRvd24oKSkpLCB0aGlzLnN0YXJ0ZWQgPSAhMDtcbiAgICB9XG4gICAgd3JpdGVTZXF1ZW5jZU51bWJlcih0KSB7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLnByLCBKU09OLnN0cmluZ2lmeSh0KSk7XG4gICAgfVxuICAgIGdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuVnIodGhpcy5tcik7XG4gICAgfVxuICAgIGlzQWN0aXZlUXVlcnlUYXJnZXQodCkge1xuICAgICAgICBsZXQgZSA9ICExO1xuICAgICAgICByZXR1cm4gdGhpcy5tci5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgcy5hY3RpdmVUYXJnZXRJZHMuaGFzKHQpICYmIChlID0gITApO1xuICAgICAgICB9KSksIGU7XG4gICAgfVxuICAgIGFkZFBlbmRpbmdNdXRhdGlvbih0KSB7XG4gICAgICAgIHRoaXMuU3IodCwgXCJwZW5kaW5nXCIpO1xuICAgIH1cbiAgICB1cGRhdGVNdXRhdGlvblN0YXRlKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5Tcih0LCBlLCBuKSwgXG4gICAgICAgIC8vIE9uY2UgYSBmaW5hbCBtdXRhdGlvbiByZXN1bHQgaXMgb2JzZXJ2ZWQgYnkgb3RoZXIgY2xpZW50cywgdGhleSBubyBsb25nZXJcbiAgICAgICAgLy8gYWNjZXNzIHRoZSBtdXRhdGlvbidzIG1ldGFkYXRhIGVudHJ5LiBTaW5jZSBXZWJTdG9yYWdlIHJlcGxheXMgZXZlbnRzXG4gICAgICAgIC8vIGluIG9yZGVyLCBpdCBpcyBzYWZlIHRvIGRlbGV0ZSB0aGUgZW50cnkgcmlnaHQgYWZ0ZXIgdXBkYXRpbmcgaXQuXG4gICAgICAgIHRoaXMuRHIodCk7XG4gICAgfVxuICAgIGFkZExvY2FsUXVlcnlUYXJnZXQodCkge1xuICAgICAgICBsZXQgZSA9IFwibm90LWN1cnJlbnRcIjtcbiAgICAgICAgLy8gTG9va3VwIGFuIGV4aXN0aW5nIHF1ZXJ5IHN0YXRlIGlmIHRoZSB0YXJnZXQgSUQgd2FzIGFscmVhZHkgcmVnaXN0ZXJlZFxuICAgICAgICAvLyBieSBhbm90aGVyIHRhYlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQWN0aXZlUXVlcnlUYXJnZXQodCkpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbShJdSh0aGlzLnBlcnNpc3RlbmNlS2V5LCB0KSk7XG4gICAgICAgICAgICBpZiAobikge1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBFdS5jcih0LCBuKTtcbiAgICAgICAgICAgICAgICBzICYmIChlID0gcy5zdGF0ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuQ3IuaHIodCksIHRoaXMudnIoKSwgZTtcbiAgICB9XG4gICAgcmVtb3ZlTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHRoaXMuQ3IubHIodCksIHRoaXMudnIoKTtcbiAgICB9XG4gICAgaXNMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuQ3IuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KTtcbiAgICB9XG4gICAgY2xlYXJRdWVyeVN0YXRlKHQpIHtcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKEl1KHRoaXMucGVyc2lzdGVuY2VLZXksIHQpKTtcbiAgICB9XG4gICAgdXBkYXRlUXVlcnlTdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuTnIodCwgZSwgbik7XG4gICAgfVxuICAgIGhhbmRsZVVzZXJDaGFuZ2UodCwgZSwgbikge1xuICAgICAgICBlLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy5Ecih0KTtcbiAgICAgICAgfSkpLCB0aGlzLmN1cnJlbnRVc2VyID0gdCwgbi5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHRoaXMuYWRkUGVuZGluZ011dGF0aW9uKHQpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIHNldE9ubGluZVN0YXRlKHQpIHtcbiAgICAgICAgdGhpcy5rcih0KTtcbiAgICB9XG4gICAgbm90aWZ5QnVuZGxlTG9hZGVkKHQpIHtcbiAgICAgICAgdGhpcy5Ncih0KTtcbiAgICB9XG4gICAgc2h1dGRvd24oKSB7XG4gICAgICAgIHRoaXMuc3RhcnRlZCAmJiAodGhpcy53aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN0b3JhZ2VcIiwgdGhpcy5fciksIHRoaXMucmVtb3ZlSXRlbSh0aGlzLnlyKSwgXG4gICAgICAgIHRoaXMuc3RhcnRlZCA9ICExKTtcbiAgICB9XG4gICAgZ2V0SXRlbSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnN0b3JhZ2UuZ2V0SXRlbSh0KTtcbiAgICAgICAgcmV0dXJuIE4oXCJTaGFyZWRDbGllbnRTdGF0ZVwiLCBcIlJFQURcIiwgdCwgZSksIGU7XG4gICAgfVxuICAgIHNldEl0ZW0odCwgZSkge1xuICAgICAgICBOKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJTRVRcIiwgdCwgZSksIHRoaXMuc3RvcmFnZS5zZXRJdGVtKHQsIGUpO1xuICAgIH1cbiAgICByZW1vdmVJdGVtKHQpIHtcbiAgICAgICAgTihcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiUkVNT1ZFXCIsIHQpLCB0aGlzLnN0b3JhZ2UucmVtb3ZlSXRlbSh0KTtcbiAgICB9XG4gICAgd3IodCkge1xuICAgICAgICAvLyBOb3RlOiBUaGUgZnVuY3Rpb24gaXMgdHlwZWQgdG8gdGFrZSBFdmVudCB0byBiZSBpbnRlcmZhY2UtY29tcGF0aWJsZSB3aXRoXG4gICAgICAgIC8vIGBXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcmAuXG4gICAgICAgIGNvbnN0IGUgPSB0O1xuICAgICAgICBpZiAoZS5zdG9yYWdlQXJlYSA9PT0gdGhpcy5zdG9yYWdlKSB7XG4gICAgICAgICAgICBpZiAoTihcIlNoYXJlZENsaWVudFN0YXRlXCIsIFwiRVZFTlRcIiwgZS5rZXksIGUubmV3VmFsdWUpLCBlLmtleSA9PT0gdGhpcy55cikgcmV0dXJuIHZvaWQgayhcIlJlY2VpdmVkIFdlYlN0b3JhZ2Ugbm90aWZpY2F0aW9uIGZvciBsb2NhbCBjaGFuZ2UuIEFub3RoZXIgY2xpZW50IG1pZ2h0IGhhdmUgZ2FyYmFnZS1jb2xsZWN0ZWQgb3VyIHN0YXRlXCIpO1xuICAgICAgICAgICAgdGhpcy5zaS5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhcnRlZCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPT0gZS5rZXkpIGlmICh0aGlzLklyLnRlc3QoZS5rZXkpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCA9PSBlLm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuT3IoZS5rZXkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLiRyKHQsIG51bGwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSB0aGlzLkZyKGUua2V5LCBlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMuJHIodC5jbGllbnRJZCwgdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5Uci50ZXN0KGUua2V5KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5CcihlLmtleSwgZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHQpIHJldHVybiB0aGlzLkxyKHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuRXIudGVzdChlLmtleSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChudWxsICE9PSBlLm5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMucXIoZS5rZXksIGUubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0KSByZXR1cm4gdGhpcy5Vcih0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5Bcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG51bGwgIT09IGUubmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5QcihlLm5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodCkgcmV0dXJuIHRoaXMuYnIodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5rZXkgPT09IHRoaXMucHIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGUgPSAkdC5jdDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobnVsbCAhPSB0KSB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuID0gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRihcIm51bWJlclwiID09IHR5cGVvZiBuKSwgZSA9IG47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBrKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgXCJGYWlsZWQgdG8gcmVhZCBzZXF1ZW5jZSBudW1iZXIgZnJvbSBXZWJTdG9yYWdlXCIsIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qKlxuICogYE1lbW9yeVNoYXJlZENsaWVudFN0YXRlYCBpcyBhIHNpbXBsZSBpbXBsZW1lbnRhdGlvbiBvZiBTaGFyZWRDbGllbnRTdGF0ZSBmb3JcbiAqIGNsaWVudHMgdXNpbmcgbWVtb3J5IHBlcnNpc3RlbmNlLiBUaGUgc3RhdGUgaW4gdGhpcyBjbGFzcyByZW1haW5zIGZ1bGx5XG4gKiBpc29sYXRlZCBhbmQgbm8gc3luY2hyb25pemF0aW9uIGlzIHBlcmZvcm1lZC5cbiAqLyAoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ICE9PSAkdC5jdCAmJiB0aGlzLnNlcXVlbmNlTnVtYmVySGFuZGxlcih0KTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmtleSA9PT0gdGhpcy5Scikge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IHRoaXMuS3IoZS5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBQcm9taXNlLmFsbCh0Lm1hcCgodCA9PiB0aGlzLnN5bmNFbmdpbmUuR3IodCkpKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2UgdGhpcy5nci5wdXNoKGUpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldCBDcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubXIuZ2V0KHRoaXMuZHIpO1xuICAgIH1cbiAgICB2cigpIHtcbiAgICAgICAgdGhpcy5zZXRJdGVtKHRoaXMueXIsIHRoaXMuQ3IuYXIoKSk7XG4gICAgfVxuICAgIFNyKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IG5ldyBUdSh0aGlzLmN1cnJlbnRVc2VyLCB0LCBlLCBuKSwgaSA9IHB1KHRoaXMucGVyc2lzdGVuY2VLZXksIHRoaXMuY3VycmVudFVzZXIsIHQpO1xuICAgICAgICB0aGlzLnNldEl0ZW0oaSwgcy5hcigpKTtcbiAgICB9XG4gICAgRHIodCkge1xuICAgICAgICBjb25zdCBlID0gcHUodGhpcy5wZXJzaXN0ZW5jZUtleSwgdGhpcy5jdXJyZW50VXNlciwgdCk7XG4gICAgICAgIHRoaXMucmVtb3ZlSXRlbShlKTtcbiAgICB9XG4gICAga3IodCkge1xuICAgICAgICBjb25zdCBlID0ge1xuICAgICAgICAgICAgY2xpZW50SWQ6IHRoaXMuZHIsXG4gICAgICAgICAgICBvbmxpbmVTdGF0ZTogdFxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnN0b3JhZ2Uuc2V0SXRlbSh0aGlzLkFyLCBKU09OLnN0cmluZ2lmeShlKSk7XG4gICAgfVxuICAgIE5yKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEl1KHRoaXMucGVyc2lzdGVuY2VLZXksIHQpLCBpID0gbmV3IEV1KHQsIGUsIG4pO1xuICAgICAgICB0aGlzLnNldEl0ZW0ocywgaS5hcigpKTtcbiAgICB9XG4gICAgTXIodCkge1xuICAgICAgICBjb25zdCBlID0gSlNPTi5zdHJpbmdpZnkoQXJyYXkuZnJvbSh0KSk7XG4gICAgICAgIHRoaXMuc2V0SXRlbSh0aGlzLlJyLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGEgY2xpZW50IHN0YXRlIGtleSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zIG51bGwgaWYgdGhlIGtleSBkb2VzIG5vdFxuICAgICAqIG1hdGNoIHRoZSBleHBlY3RlZCBrZXkgZm9ybWF0LlxuICAgICAqLyAgICBPcih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLklyLmV4ZWModCk7XG4gICAgICAgIHJldHVybiBlID8gZVsxXSA6IG51bGw7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIGNsaWVudCBzdGF0ZSBpbiBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWUgY291bGQgbm90XG4gICAgICogYmUgcGFyc2VkLlxuICAgICAqLyAgICBGcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLk9yKHQpO1xuICAgICAgICByZXR1cm4gQXUuY3IobiwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFBhcnNlcyBhIG11dGF0aW9uIGJhdGNoIHN0YXRlIGluIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIEJyKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuVHIuZXhlYyh0KSwgcyA9IE51bWJlcihuWzFdKSwgaSA9IHZvaWQgMCAhPT0gblsyXSA/IG5bMl0gOiBudWxsO1xuICAgICAgICByZXR1cm4gVHUuY3IobmV3IFYoaSksIHMsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQYXJzZXMgYSBxdWVyeSB0YXJnZXQgc3RhdGUgZnJvbSBXZWJTdG9yYWdlLiBSZXR1cm5zICdudWxsJyBpZiB0aGUgdmFsdWVcbiAgICAgKiBjb3VsZCBub3QgYmUgcGFyc2VkLlxuICAgICAqLyAgICBxcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLkVyLmV4ZWModCksIHMgPSBOdW1iZXIoblsxXSk7XG4gICAgICAgIHJldHVybiBFdS5jcihzLCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUGFyc2VzIGFuIG9ubGluZSBzdGF0ZSBmcm9tIFdlYlN0b3JhZ2UuIFJldHVybnMgJ251bGwnIGlmIHRoZSB2YWx1ZVxuICAgICAqIGNvdWxkIG5vdCBiZSBwYXJzZWQuXG4gICAgICovICAgIFByKHQpIHtcbiAgICAgICAgcmV0dXJuIFJ1LmNyKHQpO1xuICAgIH1cbiAgICBLcih0KSB7XG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHQpO1xuICAgIH1cbiAgICBhc3luYyBMcih0KSB7XG4gICAgICAgIGlmICh0LnVzZXIudWlkID09PSB0aGlzLmN1cnJlbnRVc2VyLnVpZCkgcmV0dXJuIHRoaXMuc3luY0VuZ2luZS5Rcih0LmJhdGNoSWQsIHQuc3RhdGUsIHQuZXJyb3IpO1xuICAgICAgICBOKFwiU2hhcmVkQ2xpZW50U3RhdGVcIiwgYElnbm9yaW5nIG11dGF0aW9uIGZvciBub24tYWN0aXZlIHVzZXIgJHt0LnVzZXIudWlkfWApO1xuICAgIH1cbiAgICBVcih0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN5bmNFbmdpbmUuanIodC50YXJnZXRJZCwgdC5zdGF0ZSwgdC5lcnJvcik7XG4gICAgfVxuICAgICRyKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IGUgPyB0aGlzLm1yLmluc2VydCh0LCBlKSA6IHRoaXMubXIucmVtb3ZlKHQpLCBzID0gdGhpcy5Wcih0aGlzLm1yKSwgaSA9IHRoaXMuVnIobiksIHIgPSBbXSwgbyA9IFtdO1xuICAgICAgICByZXR1cm4gaS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHMuaGFzKHQpIHx8IHIucHVzaCh0KTtcbiAgICAgICAgfSkpLCBzLmZvckVhY2goKHQgPT4ge1xuICAgICAgICAgICAgaS5oYXModCkgfHwgby5wdXNoKHQpO1xuICAgICAgICB9KSksIHRoaXMuc3luY0VuZ2luZS56cihyLCBvKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLm1yID0gbjtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBicih0KSB7XG4gICAgICAgIC8vIFdlIGNoZWNrIHdoZXRoZXIgdGhlIGNsaWVudCB0aGF0IHdyb3RlIHRoaXMgb25saW5lIHN0YXRlIGlzIHN0aWxsIGFjdGl2ZVxuICAgICAgICAvLyBieSBjb21wYXJpbmcgaXRzIGNsaWVudCBJRCB0byB0aGUgbGlzdCBvZiBjbGllbnRzIGtlcHQgYWN0aXZlIGluXG4gICAgICAgIC8vIEluZGV4ZWREYi4gSWYgYSBjbGllbnQgZG9lcyBub3QgdXBkYXRlIHRoZWlyIEluZGV4ZWREYiBjbGllbnQgc3RhdGVcbiAgICAgICAgLy8gd2l0aGluIDUgc2Vjb25kcywgaXQgaXMgY29uc2lkZXJlZCBpbmFjdGl2ZSBhbmQgd2UgZG9uJ3QgZW1pdCBhbiBvbmxpbmVcbiAgICAgICAgLy8gc3RhdGUgZXZlbnQuXG4gICAgICAgIHRoaXMubXIuZ2V0KHQuY2xpZW50SWQpICYmIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKHQub25saW5lU3RhdGUpO1xuICAgIH1cbiAgICBWcih0KSB7XG4gICAgICAgIGxldCBlID0gcHMoKTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgIGUgPSBlLnVuaW9uV2l0aChuLmFjdGl2ZVRhcmdldElkcyk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG59XG5cbmNsYXNzIGJ1IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5XciA9IG5ldyB2dSwgdGhpcy5IciA9IHt9LCB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IG51bGwsIHRoaXMuc2VxdWVuY2VOdW1iZXJIYW5kbGVyID0gbnVsbDtcbiAgICB9XG4gICAgYWRkUGVuZGluZ011dGF0aW9uKHQpIHtcbiAgICAgICAgLy8gTm8gb3AuXG4gICAgfVxuICAgIHVwZGF0ZU11dGF0aW9uU3RhdGUodCwgZSwgbikge1xuICAgICAgICAvLyBObyBvcC5cbiAgICB9XG4gICAgYWRkTG9jYWxRdWVyeVRhcmdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLldyLmhyKHQpLCB0aGlzLkhyW3RdIHx8IFwibm90LWN1cnJlbnRcIjtcbiAgICB9XG4gICAgdXBkYXRlUXVlcnlTdGF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuSHJbdF0gPSBlO1xuICAgIH1cbiAgICByZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgdGhpcy5Xci5scih0KTtcbiAgICB9XG4gICAgaXNMb2NhbFF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuV3IuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KTtcbiAgICB9XG4gICAgY2xlYXJRdWVyeVN0YXRlKHQpIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuSHJbdF07XG4gICAgfVxuICAgIGdldEFsbEFjdGl2ZVF1ZXJ5VGFyZ2V0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuV3IuYWN0aXZlVGFyZ2V0SWRzO1xuICAgIH1cbiAgICBpc0FjdGl2ZVF1ZXJ5VGFyZ2V0KHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuV3IuYWN0aXZlVGFyZ2V0SWRzLmhhcyh0KTtcbiAgICB9XG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLldyID0gbmV3IHZ1LCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG4gICAgaGFuZGxlVXNlckNoYW5nZSh0LCBlLCBuKSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzZXRPbmxpbmVTdGF0ZSh0KSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbiAgICBzaHV0ZG93bigpIHt9XG4gICAgd3JpdGVTZXF1ZW5jZU51bWJlcih0KSB7fVxuICAgIG5vdGlmeUJ1bmRsZUxvYWRlZCh0KSB7XG4gICAgICAgIC8vIE5vIG9wLlxuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY2xhc3MgVnUge1xuICAgIEpyKHQpIHtcbiAgICAgICAgLy8gTm8tb3AuXG4gICAgfVxuICAgIHNodXRkb3duKCkge1xuICAgICAgICAvLyBOby1vcC5cbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE5IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBSZWZlcmVuY2VzIHRvIGB3aW5kb3dgIGFyZSBndWFyZGVkIGJ5IEJyb3dzZXJDb25uZWN0aXZpdHlNb25pdG9yLmlzQXZhaWxhYmxlKClcbi8qIGVzbGludC1kaXNhYmxlIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscyAqL1xuLyoqXG4gKiBCcm93c2VyIGltcGxlbWVudGF0aW9uIG9mIENvbm5lY3Rpdml0eU1vbml0b3IuXG4gKi9cbmNsYXNzIFN1IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5ZciA9ICgpID0+IHRoaXMuWHIoKSwgdGhpcy5aciA9ICgpID0+IHRoaXMuZW8oKSwgdGhpcy5ubyA9IFtdLCB0aGlzLnNvKCk7XG4gICAgfVxuICAgIEpyKHQpIHtcbiAgICAgICAgdGhpcy5uby5wdXNoKHQpO1xuICAgIH1cbiAgICBzaHV0ZG93bigpIHtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJvbmxpbmVcIiwgdGhpcy5ZciksIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwib2ZmbGluZVwiLCB0aGlzLlpyKTtcbiAgICB9XG4gICAgc28oKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwib25saW5lXCIsIHRoaXMuWXIpLCB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9mZmxpbmVcIiwgdGhpcy5acik7XG4gICAgfVxuICAgIFhyKCkge1xuICAgICAgICBOKFwiQ29ubmVjdGl2aXR5TW9uaXRvclwiLCBcIk5ldHdvcmsgY29ubmVjdGl2aXR5IGNoYW5nZWQ6IEFWQUlMQUJMRVwiKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMubm8pIHQoMCAvKiBOZXR3b3JrU3RhdHVzLkFWQUlMQUJMRSAqLyk7XG4gICAgfVxuICAgIGVvKCkge1xuICAgICAgICBOKFwiQ29ubmVjdGl2aXR5TW9uaXRvclwiLCBcIk5ldHdvcmsgY29ubmVjdGl2aXR5IGNoYW5nZWQ6IFVOQVZBSUxBQkxFXCIpO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5ubykgdCgxIC8qIE5ldHdvcmtTdGF0dXMuVU5BVkFJTEFCTEUgKi8pO1xuICAgIH1cbiAgICAvLyBUT0RPKGNoZW5icmlhbik6IENvbnNpZGVyIHBhc3NpbmcgaW4gd2luZG93IGVpdGhlciBpbnRvIHRoaXMgY29tcG9uZW50IG9yXG4gICAgLy8gaGVyZSBmb3IgdGVzdGluZyB2aWEgRmFrZVdpbmRvdy5cbiAgICAvKiogQ2hlY2tzIHRoYXQgYWxsIHVzZWQgYXR0cmlidXRlcyBvZiB3aW5kb3cgYXJlIGF2YWlsYWJsZS4gKi9cbiAgICBzdGF0aWMgRCgpIHtcbiAgICAgICAgcmV0dXJuIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyAmJiB2b2lkIDAgIT09IHdpbmRvdy5hZGRFdmVudExpc3RlbmVyICYmIHZvaWQgMCAhPT0gd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXI7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUaGUgdmFsdWUgcmV0dXJuZWQgZnJvbSB0aGUgbW9zdCByZWNlbnQgaW52b2NhdGlvbiBvZlxuICogYGdlbmVyYXRlVW5pcXVlRGVidWdJZCgpYCwgb3IgbnVsbCBpZiBpdCBoYXMgbmV2ZXIgYmVlbiBpbnZva2VkLlxuICovIGxldCBEdSA9IG51bGw7XG5cbi8qKlxuICogR2VuZXJhdGVzIGFuZCByZXR1cm5zIGFuIGluaXRpYWwgdmFsdWUgZm9yIGBsYXN0VW5pcXVlRGVidWdJZGAuXG4gKlxuICogVGhlIHJldHVybmVkIHZhbHVlIGlzIHJhbmRvbWx5IHNlbGVjdGVkIGZyb20gYSByYW5nZSBvZiBpbnRlZ2VycyB0aGF0IGFyZVxuICogcmVwcmVzZW50ZWQgYXMgOCBoZXhhZGVjaW1hbCBkaWdpdHMuIFRoaXMgbWVhbnMgdGhhdCAod2l0aGluIHJlYXNvbikgYW55XG4gKiBudW1iZXJzIGdlbmVyYXRlZCBieSBpbmNyZW1lbnRpbmcgdGhlIHJldHVybmVkIG51bWJlciBieSAxIHdpbGwgYWxzbyBiZVxuICogcmVwcmVzZW50ZWQgYnkgOCBoZXhhZGVjaW1hbCBkaWdpdHMuIFRoaXMgbGVhZHMgdG8gYWxsIFwiSURzXCIgaGF2aW5nIHRoZSBzYW1lXG4gKiBsZW5ndGggd2hlbiBjb252ZXJ0ZWQgdG8gYSBoZXhhZGVjaW1hbCBzdHJpbmcsIG1ha2luZyByZWFkaW5nIGxvZ3MgY29udGFpbmluZ1xuICogdGhlc2UgSURzIGVhc2llciB0byBmb2xsb3cuIEFuZCBzaW5jZSB0aGUgcmV0dXJuIHZhbHVlIGlzIHJhbmRvbWx5IHNlbGVjdGVkXG4gKiBpdCB3aWxsIGhlbHAgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGxvZ3MgZnJvbSBkaWZmZXJlbnQgZXhlY3V0aW9ucy5cbiAqL1xuLyoqXG4gKiBHZW5lcmF0ZXMgYW5kIHJldHVybnMgYSB1bmlxdWUgSUQgYXMgYSBoZXhhZGVjaW1hbCBzdHJpbmcuXG4gKlxuICogVGhlIHJldHVybmVkIElEIGlzIGludGVuZGVkIHRvIGJlIHVzZWQgaW4gZGVidWcgbG9nZ2luZyBtZXNzYWdlcyB0byBoZWxwXG4gKiBjb3JyZWxhdGUgbG9nIG1lc3NhZ2VzIHRoYXQgbWF5IGJlIHNwYXRpYWxseSBzZXBhcmF0ZWQgaW4gdGhlIGxvZ3MsIGJ1dFxuICogbG9naWNhbGx5IHJlbGF0ZWQuIEZvciBleGFtcGxlLCBhIG5ldHdvcmsgY29ubmVjdGlvbiBjb3VsZCBpbmNsdWRlIHRoZSBzYW1lXG4gKiBcImRlYnVnIElEXCIgc3RyaW5nIGluIGFsbCBvZiBpdHMgbG9nIG1lc3NhZ2VzIHRvIGhlbHAgdHJhY2UgYSBzcGVjaWZpY1xuICogY29ubmVjdGlvbiBvdmVyIHRpbWUuXG4gKlxuICogQHJldHVybiB0aGUgMTAtY2hhcmFjdGVyIGdlbmVyYXRlZCBJRCAoZS5nLiBcIjB4YTFiMmMzZDRcIikuXG4gKi9cbmZ1bmN0aW9uIEN1KCkge1xuICAgIHJldHVybiBudWxsID09PSBEdSA/IER1ID0gMjY4NDM1NDU2ICsgTWF0aC5yb3VuZCgyMTQ3NDgzNjQ4ICogTWF0aC5yYW5kb20oKSkgOiBEdSsrLCBcbiAgICBcIjB4XCIgKyBEdS50b1N0cmluZygxNik7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IHh1ID0ge1xuICAgIEJhdGNoR2V0RG9jdW1lbnRzOiBcImJhdGNoR2V0XCIsXG4gICAgQ29tbWl0OiBcImNvbW1pdFwiLFxuICAgIFJ1blF1ZXJ5OiBcInJ1blF1ZXJ5XCIsXG4gICAgUnVuQWdncmVnYXRpb25RdWVyeTogXCJydW5BZ2dyZWdhdGlvblF1ZXJ5XCJcbn07XG5cbi8qKlxuICogTWFwcyBSUEMgbmFtZXMgdG8gdGhlIGNvcnJlc3BvbmRpbmcgUkVTVCBlbmRwb2ludCBuYW1lLlxuICpcbiAqIFdlIHVzZSBhcnJheSBub3RhdGlvbiB0byBhdm9pZCBtYW5nbGluZy5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUHJvdmlkZXMgYSBzaW1wbGUgaGVscGVyIGNsYXNzIHRoYXQgaW1wbGVtZW50cyB0aGUgU3RyZWFtIGludGVyZmFjZSB0b1xuICogYnJpZGdlIHRvIG90aGVyIGltcGxlbWVudGF0aW9ucyB0aGF0IGFyZSBzdHJlYW1zIGJ1dCBkbyBub3QgaW1wbGVtZW50IHRoZVxuICogaW50ZXJmYWNlLiBUaGUgc3RyZWFtIGNhbGxiYWNrcyBhcmUgaW52b2tlZCB3aXRoIHRoZSBjYWxsT24uLi4gbWV0aG9kcy5cbiAqL1xuY2xhc3MgTnUge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5pbyA9IHQuaW8sIHRoaXMucm8gPSB0LnJvO1xuICAgIH1cbiAgICBvbyh0KSB7XG4gICAgICAgIHRoaXMudW8gPSB0O1xuICAgIH1cbiAgICBjbyh0KSB7XG4gICAgICAgIHRoaXMuYW8gPSB0O1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICB0aGlzLmhvID0gdDtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMucm8oKTtcbiAgICB9XG4gICAgc2VuZCh0KSB7XG4gICAgICAgIHRoaXMuaW8odCk7XG4gICAgfVxuICAgIGxvKCkge1xuICAgICAgICB0aGlzLnVvKCk7XG4gICAgfVxuICAgIGZvKHQpIHtcbiAgICAgICAgdGhpcy5hbyh0KTtcbiAgICB9XG4gICAgX28odCkge1xuICAgICAgICB0aGlzLmhvKHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gY29uc3Qga3UgPSBcIldlYkNoYW5uZWxDb25uZWN0aW9uXCI7XG5cbmNsYXNzIE11IGV4dGVuZHMgXG4vKipcbiAqIEJhc2UgY2xhc3MgZm9yIGFsbCBSZXN0LWJhc2VkIGNvbm5lY3Rpb25zIHRvIHRoZSBiYWNrZW5kIChXZWJDaGFubmVsIGFuZFxuICogSFRUUCkuXG4gKi9cbmNsYXNzIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZGF0YWJhc2VJbmZvID0gdCwgdGhpcy5kYXRhYmFzZUlkID0gdC5kYXRhYmFzZUlkO1xuICAgICAgICBjb25zdCBlID0gdC5zc2wgPyBcImh0dHBzXCIgOiBcImh0dHBcIjtcbiAgICAgICAgdGhpcy53byA9IGUgKyBcIjovL1wiICsgdC5ob3N0LCB0aGlzLm1vID0gXCJwcm9qZWN0cy9cIiArIHRoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWQgKyBcIi9kYXRhYmFzZXMvXCIgKyB0aGlzLmRhdGFiYXNlSWQuZGF0YWJhc2UgKyBcIi9kb2N1bWVudHNcIjtcbiAgICB9XG4gICAgZ2V0IHlvKCkge1xuICAgICAgICAvLyBCb3RoIGBpbnZva2VSUEMoKWAgYW5kIGBpbnZva2VTdHJlYW1pbmdSUEMoKWAgdXNlIHRoZWlyIGBwYXRoYCBhcmd1bWVudHMgdG8gZGV0ZXJtaW5lXG4gICAgICAgIC8vIHdoZXJlIHRvIHJ1biB0aGUgcXVlcnksIGFuZCBleHBlY3QgdGhlIGByZXF1ZXN0YCB0byBOT1Qgc3BlY2lmeSB0aGUgXCJwYXRoXCIuXG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgcG8odCwgZSwgbiwgcywgaSkge1xuICAgICAgICBjb25zdCByID0gQ3UoKSwgbyA9IHRoaXMuSW8odCwgZSk7XG4gICAgICAgIE4oXCJSZXN0Q29ubmVjdGlvblwiLCBgU2VuZGluZyBSUEMgJyR7dH0nICR7cn06YCwgbywgbik7XG4gICAgICAgIGNvbnN0IHUgPSB7fTtcbiAgICAgICAgcmV0dXJuIHRoaXMuVG8odSwgcywgaSksIHRoaXMuRW8odCwgbywgdSwgbikudGhlbigoZSA9PiAoTihcIlJlc3RDb25uZWN0aW9uXCIsIGBSZWNlaXZlZCBSUEMgJyR7dH0nICR7cn06IGAsIGUpLCBcbiAgICAgICAgZSkpLCAoZSA9PiB7XG4gICAgICAgICAgICB0aHJvdyBNKFwiUmVzdENvbm5lY3Rpb25cIiwgYFJQQyAnJHt0fScgJHtyfSBmYWlsZWQgd2l0aCBlcnJvcjogYCwgZSwgXCJ1cmw6IFwiLCBvLCBcInJlcXVlc3Q6XCIsIG4pLCBcbiAgICAgICAgICAgIGU7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgQW8odCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICAvLyBUaGUgUkVTVCBBUEkgYXV0b21hdGljYWxseSBhZ2dyZWdhdGVzIGFsbCBvZiB0aGUgc3RyZWFtZWQgcmVzdWx0cywgc28gd2VcbiAgICAgICAgLy8gY2FuIGp1c3QgdXNlIHRoZSBub3JtYWwgaW52b2tlKCkgbWV0aG9kLlxuICAgICAgICByZXR1cm4gdGhpcy5wbyh0LCBlLCBuLCBzLCBpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTW9kaWZpZXMgdGhlIGhlYWRlcnMgZm9yIGEgcmVxdWVzdCwgYWRkaW5nIGFueSBhdXRob3JpemF0aW9uIHRva2VuIGlmXG4gICAgICogcHJlc2VudCBhbmQgYW55IGFkZGl0aW9uYWwgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3QuXG4gICAgICovICAgIFRvKHQsIGUsIG4pIHtcbiAgICAgICAgdFtcIlgtR29vZy1BcGktQ2xpZW50XCJdID0gXCJnbC1qcy8gZmlyZS9cIiArIFMsIFxuICAgICAgICAvLyBDb250ZW50LVR5cGU6IHRleHQvcGxhaW4gd2lsbCBhdm9pZCBwcmVmbGlnaHQgcmVxdWVzdHMgd2hpY2ggbWlnaHRcbiAgICAgICAgLy8gbWVzcyB3aXRoIENPUlMgYW5kIHJlZGlyZWN0cyBieSBwcm94aWVzLiBJZiB3ZSBhZGQgY3VzdG9tIGhlYWRlcnNcbiAgICAgICAgLy8gd2Ugd2lsbCBuZWVkIHRvIGNoYW5nZSB0aGlzIGNvZGUgdG8gcG90ZW50aWFsbHkgdXNlIHRoZSAkaHR0cE92ZXJ3cml0ZVxuICAgICAgICAvLyBwYXJhbWV0ZXIgc3VwcG9ydGVkIGJ5IEVTRiB0byBhdm9pZCB0cmlnZ2VyaW5nIHByZWZsaWdodCByZXF1ZXN0cy5cbiAgICAgICAgdFtcIkNvbnRlbnQtVHlwZVwiXSA9IFwidGV4dC9wbGFpblwiLCB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCAmJiAodFtcIlgtRmlyZWJhc2UtR01QSURcIl0gPSB0aGlzLmRhdGFiYXNlSW5mby5hcHBJZCksIFxuICAgICAgICBlICYmIGUuaGVhZGVycy5mb3JFYWNoKCgoZSwgbikgPT4gdFtuXSA9IGUpKSwgbiAmJiBuLmhlYWRlcnMuZm9yRWFjaCgoKGUsIG4pID0+IHRbbl0gPSBlKSk7XG4gICAgfVxuICAgIElvKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHh1W3RdO1xuICAgICAgICByZXR1cm4gYCR7dGhpcy53b30vdjEvJHtlfToke259YDtcbiAgICB9XG59IHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKHQpLCB0aGlzLmZvcmNlTG9uZ1BvbGxpbmcgPSB0LmZvcmNlTG9uZ1BvbGxpbmcsIHRoaXMuYXV0b0RldGVjdExvbmdQb2xsaW5nID0gdC5hdXRvRGV0ZWN0TG9uZ1BvbGxpbmcsIFxuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyA9IHQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBFbyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIGNvbnN0IGkgPSBDdSgpO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKChyLCBvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB1ID0gbmV3IFhocklvO1xuICAgICAgICAgICAgdS5zZXRXaXRoQ3JlZGVudGlhbHMoITApLCB1Lmxpc3Rlbk9uY2UoRXZlbnRUeXBlLkNPTVBMRVRFLCAoKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAodS5nZXRMYXN0RXJyb3JDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICBjYXNlIEVycm9yQ29kZS5OT19FUlJPUjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSB1LmdldFJlc3BvbnNlSnNvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTihrdSwgYFhIUiBmb3IgUlBDICcke3R9JyAke2l9IHJlY2VpdmVkOmAsIEpTT04uc3RyaW5naWZ5KGUpKSwgcihlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBFcnJvckNvZGUuVElNRU9VVDpcbiAgICAgICAgICAgICAgICAgICAgICAgIE4oa3UsIGBSUEMgJyR7dH0nICR7aX0gdGltZWQgb3V0YCksIG8obmV3IFUocS5ERUFETElORV9FWENFRURFRCwgXCJSZXF1ZXN0IHRpbWUgb3V0XCIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgY2FzZSBFcnJvckNvZGUuSFRUUF9FUlJPUjpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB1LmdldFN0YXR1cygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE4oa3UsIGBSUEMgJyR7dH0nICR7aX0gZmFpbGVkIHdpdGggc3RhdHVzOmAsIG4sIFwicmVzcG9uc2UgdGV4dDpcIiwgdS5nZXRSZXNwb25zZVRleHQoKSksIFxuICAgICAgICAgICAgICAgICAgICAgICAgbiA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdCA9IHUuZ2V0UmVzcG9uc2VKc29uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheSh0KSAmJiAodCA9IHRbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBudWxsID09IHQgPyB2b2lkIDAgOiB0LmVycm9yO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChlICYmIGUuc3RhdHVzICYmIGUubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB0ID0gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZSA9IHQudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9fL2csIFwiLVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHEpLmluZGV4T2YoZSkgPj0gMCA/IGUgOiBxLlVOS05PV047XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0oZS5zdGF0dXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvKG5ldyBVKHQsIGUubWVzc2FnZSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBvKG5ldyBVKHEuVU5LTk9XTiwgXCJTZXJ2ZXIgcmVzcG9uZGVkIHdpdGggc3RhdHVzIFwiICsgdS5nZXRTdGF0dXMoKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgcmVjZWl2ZWQgYW4gSFRUUF9FUlJPUiBidXQgdGhlcmUncyBubyBzdGF0dXMgY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGl0J3MgbW9zdCBwcm9iYWJseSBhIGNvbm5lY3Rpb24gaXNzdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG8obmV3IFUocS5VTkFWQUlMQUJMRSwgXCJDb25uZWN0aW9uIGZhaWxlZC5cIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICAgICAgJCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgTihrdSwgYFJQQyAnJHt0fScgJHtpfSBjb21wbGV0ZWQuYCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgY29uc3QgYyA9IEpTT04uc3RyaW5naWZ5KHMpO1xuICAgICAgICAgICAgTihrdSwgYFJQQyAnJHt0fScgJHtpfSBzZW5kaW5nIHJlcXVlc3Q6YCwgcyksIHUuc2VuZChlLCBcIlBPU1RcIiwgYywgbiwgMTUpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFJvKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEN1KCksIGkgPSBbIHRoaXMud28sIFwiL1wiLCBcImdvb2dsZS5maXJlc3RvcmUudjEuRmlyZXN0b3JlXCIsIFwiL1wiLCB0LCBcIi9jaGFubmVsXCIgXSwgciA9IGNyZWF0ZVdlYkNoYW5uZWxUcmFuc3BvcnQoKSwgbyA9IGdldFN0YXRFdmVudFRhcmdldCgpLCB1ID0ge1xuICAgICAgICAgICAgLy8gUmVxdWlyZWQgZm9yIGJhY2tlbmQgc3RpY2tpbmVzcywgcm91dGluZyBiZWhhdmlvciBpcyBiYXNlZCBvbiB0aGlzXG4gICAgICAgICAgICAvLyBwYXJhbWV0ZXIuXG4gICAgICAgICAgICBodHRwU2Vzc2lvbklkUGFyYW06IFwiZ3Nlc3Npb25pZFwiLFxuICAgICAgICAgICAgaW5pdE1lc3NhZ2VIZWFkZXJzOiB7fSxcbiAgICAgICAgICAgIG1lc3NhZ2VVcmxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBUaGlzIHBhcmFtIGlzIHVzZWQgdG8gaW1wcm92ZSByb3V0aW5nIGFuZCBwcm9qZWN0IGlzb2xhdGlvbiBieSB0aGVcbiAgICAgICAgICAgICAgICAvLyBiYWNrZW5kIGFuZCBtdXN0IGJlIGluY2x1ZGVkIGluIGV2ZXJ5IHJlcXVlc3QuXG4gICAgICAgICAgICAgICAgZGF0YWJhc2U6IGBwcm9qZWN0cy8ke3RoaXMuZGF0YWJhc2VJZC5wcm9qZWN0SWR9L2RhdGFiYXNlcy8ke3RoaXMuZGF0YWJhc2VJZC5kYXRhYmFzZX1gXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2VuZFJhd0pzb246ICEwLFxuICAgICAgICAgICAgc3VwcG9ydHNDcm9zc0RvbWFpblhocjogITAsXG4gICAgICAgICAgICBpbnRlcm5hbENoYW5uZWxQYXJhbXM6IHtcbiAgICAgICAgICAgICAgICAvLyBPdmVycmlkZSB0aGUgZGVmYXVsdCB0aW1lb3V0IChyYW5kb21pemVkIGJldHdlZW4gMTAtMjAgc2Vjb25kcykgc2luY2VcbiAgICAgICAgICAgICAgICAvLyBhIGxhcmdlIHdyaXRlIGJhdGNoIG9uIGEgc2xvdyBpbnRlcm5ldCBjb25uZWN0aW9uIG1heSB0YWtlIGEgbG9uZ1xuICAgICAgICAgICAgICAgIC8vIHRpbWUgdG8gc2VuZCB0byB0aGUgYmFja2VuZC4gUmF0aGVyIHRoYW4gaGF2ZSBXZWJDaGFubmVsIGltcG9zZSBhXG4gICAgICAgICAgICAgICAgLy8gdGlnaHQgdGltZW91dCB3aGljaCBjb3VsZCBsZWFkIHRvIGluZmluaXRlIHRpbWVvdXRzIGFuZCByZXRyaWVzLCB3ZVxuICAgICAgICAgICAgICAgIC8vIHNldCBpdCB2ZXJ5IGxhcmdlICg1LTEwIG1pbnV0ZXMpIGFuZCByZWx5IG9uIHRoZSBicm93c2VyJ3MgYnVpbHRpblxuICAgICAgICAgICAgICAgIC8vIHRpbWVvdXRzIHRvIGtpY2sgaW4gaWYgdGhlIHJlcXVlc3QgaXNuJ3Qgd29ya2luZy5cbiAgICAgICAgICAgICAgICBmb3J3YXJkQ2hhbm5lbFJlcXVlc3RUaW1lb3V0TXM6IDZlNVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZvcmNlTG9uZ1BvbGxpbmc6IHRoaXMuZm9yY2VMb25nUG9sbGluZyxcbiAgICAgICAgICAgIGRldGVjdEJ1ZmZlcmluZ1Byb3h5OiB0aGlzLmF1dG9EZXRlY3RMb25nUG9sbGluZ1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnVzZUZldGNoU3RyZWFtcyAmJiAodS54bWxIdHRwRmFjdG9yeSA9IG5ldyBGZXRjaFhtbEh0dHBGYWN0b3J5KHt9KSksIHRoaXMuVG8odS5pbml0TWVzc2FnZUhlYWRlcnMsIGUsIG4pLCBcbiAgICAgICAgLy8gU2VuZGluZyB0aGUgY3VzdG9tIGhlYWRlcnMgd2UganVzdCBhZGRlZCB0byByZXF1ZXN0LmluaXRNZXNzYWdlSGVhZGVyc1xuICAgICAgICAvLyAoQXV0aG9yaXphdGlvbiwgZXRjLikgd2lsbCB0cmlnZ2VyIHRoZSBicm93c2VyIHRvIG1ha2UgYSBDT1JTIHByZWZsaWdodFxuICAgICAgICAvLyByZXF1ZXN0IGJlY2F1c2UgdGhlIFhIUiB3aWxsIG5vIGxvbmdlciBtZWV0IHRoZSBjcml0ZXJpYSBmb3IgYSBcInNpbXBsZVwiXG4gICAgICAgIC8vIENPUlMgcmVxdWVzdDpcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvSFRUUC9DT1JTI1NpbXBsZV9yZXF1ZXN0c1xuICAgICAgICAvLyBUaGVyZWZvcmUgdG8gYXZvaWQgdGhlIENPUlMgcHJlZmxpZ2h0IHJlcXVlc3QgKGFuIGV4dHJhIG5ldHdvcmtcbiAgICAgICAgLy8gcm91bmR0cmlwKSwgd2UgdXNlIHRoZSBlbmNvZGVJbml0TWVzc2FnZUhlYWRlcnMgb3B0aW9uIHRvIHNwZWNpZnkgdGhhdFxuICAgICAgICAvLyB0aGUgaGVhZGVycyBzaG91bGQgaW5zdGVhZCBiZSBlbmNvZGVkIGluIHRoZSByZXF1ZXN0J3MgUE9TVCBwYXlsb2FkLFxuICAgICAgICAvLyB3aGljaCBpcyByZWNvZ25pemVkIGJ5IHRoZSB3ZWJjaGFubmVsIGJhY2tlbmQuXG4gICAgICAgIHUuZW5jb2RlSW5pdE1lc3NhZ2VIZWFkZXJzID0gITA7XG4gICAgICAgIGNvbnN0IGMgPSBpLmpvaW4oXCJcIik7XG4gICAgICAgIE4oa3UsIGBDcmVhdGluZyBSUEMgJyR7dH0nIHN0cmVhbSAke3N9OiAke2N9YCwgdSk7XG4gICAgICAgIGNvbnN0IGEgPSByLmNyZWF0ZVdlYkNoYW5uZWwoYywgdSk7XG4gICAgICAgIC8vIFdlYkNoYW5uZWwgc3VwcG9ydHMgc2VuZGluZyB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBoYW5kc2hha2UgLSBzYXZpbmdcbiAgICAgICAgLy8gYSBuZXR3b3JrIHJvdW5kIHRyaXAuIEhvd2V2ZXIsIGl0IHdpbGwgaGF2ZSB0byBjYWxsIHNlbmQgaW4gdGhlIHNhbWVcbiAgICAgICAgLy8gSlMgZXZlbnQgbG9vcCBhcyBvcGVuLiBJbiBvcmRlciB0byBlbmZvcmNlIHRoaXMsIHdlIGRlbGF5IGFjdHVhbGx5XG4gICAgICAgIC8vIG9wZW5pbmcgdGhlIFdlYkNoYW5uZWwgdW50aWwgc2VuZCBpcyBjYWxsZWQuIFdoZXRoZXIgd2UgaGF2ZSBjYWxsZWRcbiAgICAgICAgLy8gb3BlbiBpcyB0cmFja2VkIHdpdGggdGhpcyB2YXJpYWJsZS5cbiAgICAgICAgICAgICAgICBsZXQgaCA9ICExLCBsID0gITE7XG4gICAgICAgIC8vIEEgZmxhZyB0byBkZXRlcm1pbmUgd2hldGhlciB0aGUgc3RyZWFtIHdhcyBjbG9zZWQgKGJ5IHVzIG9yIHRocm91Z2ggYW5cbiAgICAgICAgLy8gZXJyb3IvY2xvc2UgZXZlbnQpIHRvIGF2b2lkIGRlbGl2ZXJpbmcgbXVsdGlwbGUgY2xvc2UgZXZlbnRzIG9yIHNlbmRpbmdcbiAgICAgICAgLy8gb24gYSBjbG9zZWQgc3RyZWFtXG4gICAgICAgICAgICAgICAgY29uc3QgZiA9IG5ldyBOdSh7XG4gICAgICAgICAgICBpbzogZSA9PiB7XG4gICAgICAgICAgICAgICAgbCA/IE4oa3UsIGBOb3Qgc2VuZGluZyBiZWNhdXNlIFJQQyAnJHt0fScgc3RyZWFtICR7c30gaXMgY2xvc2VkOmAsIGUpIDogKGggfHwgKE4oa3UsIGBPcGVuaW5nIFJQQyAnJHt0fScgc3RyZWFtICR7c30gdHJhbnNwb3J0LmApLCBcbiAgICAgICAgICAgICAgICBhLm9wZW4oKSwgaCA9ICEwKSwgTihrdSwgYFJQQyAnJHt0fScgc3RyZWFtICR7c30gc2VuZGluZzpgLCBlKSwgYS5zZW5kKGUpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBybzogKCkgPT4gYS5jbG9zZSgpXG4gICAgICAgIH0pLCBkID0gKHQsIGUsIG4pID0+IHtcbiAgICAgICAgICAgIC8vIFRPRE8oZGltb25kKTogY2xvc3VyZSB0eXBpbmcgc2VlbXMgYnJva2VuIGJlY2F1c2UgV2ViQ2hhbm5lbCBkb2VzXG4gICAgICAgICAgICAvLyBub3QgaW1wbGVtZW50IGdvb2cuZXZlbnRzLkxpc3RlbmFibGVcbiAgICAgICAgICAgIHQubGlzdGVuKGUsICh0ID0+IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBuKHQpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgdDtcbiAgICAgICAgICAgICAgICAgICAgfSksIDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gQ2xvc3VyZSBldmVudHMgYXJlIGd1YXJkZWQgYW5kIGV4Y2VwdGlvbnMgYXJlIHN3YWxsb3dlZCwgc28gY2F0Y2ggYW55XG4gICAgICAgIC8vIGV4Y2VwdGlvbiBhbmQgcmV0aHJvdyB1c2luZyBhIHNldFRpbWVvdXQgc28gdGhleSBiZWNvbWUgdmlzaWJsZSBhZ2Fpbi5cbiAgICAgICAgLy8gTm90ZSB0aGF0IGV2ZW50dWFsbHkgdGhpcyBmdW5jdGlvbiBjb3VsZCBnbyBhd2F5IGlmIHdlIGFyZSBjb25maWRlbnRcbiAgICAgICAgLy8gZW5vdWdoIHRoZSBjb2RlIGlzIGV4Y2VwdGlvbiBmcmVlLlxuICAgICAgICAgICAgICAgIHJldHVybiBkKGEsIFdlYkNoYW5uZWwuRXZlbnRUeXBlLk9QRU4sICgoKSA9PiB7XG4gICAgICAgICAgICBsIHx8IE4oa3UsIGBSUEMgJyR7dH0nIHN0cmVhbSAke3N9IHRyYW5zcG9ydCBvcGVuZWQuYCk7XG4gICAgICAgIH0pKSwgZChhLCBXZWJDaGFubmVsLkV2ZW50VHlwZS5DTE9TRSwgKCgpID0+IHtcbiAgICAgICAgICAgIGwgfHwgKGwgPSAhMCwgTihrdSwgYFJQQyAnJHt0fScgc3RyZWFtICR7c30gdHJhbnNwb3J0IGNsb3NlZGApLCBmLmZvKCkpO1xuICAgICAgICB9KSksIGQoYSwgV2ViQ2hhbm5lbC5FdmVudFR5cGUuRVJST1IsIChlID0+IHtcbiAgICAgICAgICAgIGwgfHwgKGwgPSAhMCwgTShrdSwgYFJQQyAnJHt0fScgc3RyZWFtICR7c30gdHJhbnNwb3J0IGVycm9yZWQ6YCwgZSksIGYuZm8obmV3IFUocS5VTkFWQUlMQUJMRSwgXCJUaGUgb3BlcmF0aW9uIGNvdWxkIG5vdCBiZSBjb21wbGV0ZWRcIikpKTtcbiAgICAgICAgfSkpLCBkKGEsIFdlYkNoYW5uZWwuRXZlbnRUeXBlLk1FU1NBR0UsIChlID0+IHtcbiAgICAgICAgICAgIHZhciBuO1xuICAgICAgICAgICAgaWYgKCFsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaSA9IGUuZGF0YVswXTtcbiAgICAgICAgICAgICAgICBGKCEhaSk7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzM1MTQzODkxKTogVGhlcmUgaXMgYSBidWcgaW4gT25lIFBsYXRmb3JtIHRoYXQgY2F1c2VkIGVycm9yc1xuICAgICAgICAgICAgICAgIC8vIChhbmQgb25seSBlcnJvcnMpIHRvIGJlIHdyYXBwZWQgaW4gYW4gZXh0cmEgYXJyYXkuIFRvIGJlIGZvcndhcmRcbiAgICAgICAgICAgICAgICAvLyBjb21wYXRpYmxlIHdpdGggdGhlIGJ1ZyB3ZSBuZWVkIHRvIGNoZWNrIGVpdGhlciBjb25kaXRpb24uIFRoZSBsYXR0ZXJcbiAgICAgICAgICAgICAgICAvLyBjYW4gYmUgcmVtb3ZlZCBvbmNlIHRoZSBmaXggaGFzIGJlZW4gcm9sbGVkIG91dC5cbiAgICAgICAgICAgICAgICAvLyBVc2UgYW55IGJlY2F1c2UgbXNnRGF0YS5lcnJvciBpcyBub3QgdHlwZWQuXG4gICAgICAgICAgICAgICAgY29uc3QgciA9IGksIG8gPSByLmVycm9yIHx8IChudWxsID09PSAobiA9IHJbMF0pIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4uZXJyb3IpO1xuICAgICAgICAgICAgICAgIGlmIChvKSB7XG4gICAgICAgICAgICAgICAgICAgIE4oa3UsIGBSUEMgJyR7dH0nIHN0cmVhbSAke3N9IHJlY2VpdmVkIGVycm9yOmAsIG8pO1xuICAgICAgICAgICAgICAgICAgICAvLyBlcnJvci5zdGF0dXMgd2lsbCBiZSBhIHN0cmluZyBsaWtlICdPSycgb3IgJ05PVF9GT1VORCcuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBvLnN0YXR1cztcbiAgICAgICAgICAgICAgICAgICAgbGV0IG4gPSBcbiAgICAgICAgICAgICAgICAgICAgLyoqXG4gKiBNYXBzIGFuIGVycm9yIENvZGUgZnJvbSBhIEdSUEMgc3RhdHVzIGlkZW50aWZpZXIgbGlrZSAnTk9UX0ZPVU5EJy5cbiAqXG4gKiBAcmV0dXJucyBUaGUgQ29kZSBlcXVpdmFsZW50IHRvIHRoZSBnaXZlbiBzdGF0dXMgc3RyaW5nIG9yIHVuZGVmaW5lZCBpZlxuICogICAgIHRoZXJlIGlzIG5vIG1hdGNoLlxuICovXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxvb2t1cCBieSBzdHJpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBlID0gaWlbdF07XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodm9pZCAwICE9PSBlKSByZXR1cm4gdWkoZSk7XG4gICAgICAgICAgICAgICAgICAgIH0oZSksIGkgPSBvLm1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgICAgIHZvaWQgMCA9PT0gbiAmJiAobiA9IHEuSU5URVJOQUwsIGkgPSBcIlVua25vd24gZXJyb3Igc3RhdHVzOiBcIiArIGUgKyBcIiB3aXRoIG1lc3NhZ2UgXCIgKyBvLm1lc3NhZ2UpLCBcbiAgICAgICAgICAgICAgICAgICAgLy8gTWFyayBjbG9zZWQgc28gbm8gZnVydGhlciBldmVudHMgYXJlIHByb3BhZ2F0ZWRcbiAgICAgICAgICAgICAgICAgICAgbCA9ICEwLCBmLmZvKG5ldyBVKG4sIGkpKSwgYS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBOKGt1LCBgUlBDICcke3R9JyBzdHJlYW0gJHtzfSByZWNlaXZlZDpgLCBpKSwgZi5fbyhpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkpLCBkKG8sIEV2ZW50LlNUQVRfRVZFTlQsIChlID0+IHtcbiAgICAgICAgICAgIGUuc3RhdCA9PT0gU3RhdC5QUk9YWSA/IE4oa3UsIGBSUEMgJyR7dH0nIHN0cmVhbSAke3N9IGRldGVjdGVkIGJ1ZmZlcmluZyBwcm94eWApIDogZS5zdGF0ID09PSBTdGF0Lk5PUFJPWFkgJiYgTihrdSwgYFJQQyAnJHt0fScgc3RyZWFtICR7c30gZGV0ZWN0ZWQgbm8gYnVmZmVyaW5nIHByb3h5YCk7XG4gICAgICAgIH0pKSwgc2V0VGltZW91dCgoKCkgPT4ge1xuICAgICAgICAgICAgLy8gVGVjaG5pY2FsbHkgd2UgY291bGQvc2hvdWxkIHdhaXQgZm9yIHRoZSBXZWJDaGFubmVsIG9wZW5lZCBldmVudCxcbiAgICAgICAgICAgIC8vIGJ1dCBiZWNhdXNlIHdlIHdhbnQgdG8gc2VuZCB0aGUgZmlyc3QgbWVzc2FnZSB3aXRoIHRoZSBXZWJDaGFubmVsXG4gICAgICAgICAgICAvLyBoYW5kc2hha2Ugd2UgcHJldGVuZCB0aGUgY2hhbm5lbCBvcGVuZWQgaGVyZSAoYXN5bmNocm9ub3VzbHkpLCBhbmRcbiAgICAgICAgICAgIC8vIHRoZW4gZGVsYXkgdGhlIGFjdHVhbCBvcGVuIHVudGlsIHRoZSBmaXJzdCBtZXNzYWdlIGlzIHNlbnQuXG4gICAgICAgICAgICBmLmxvKCk7XG4gICAgICAgIH0pLCAwKSwgZjtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogSW5pdGlhbGl6ZXMgdGhlIFdlYkNoYW5uZWxDb25uZWN0aW9uIGZvciB0aGUgYnJvd3Nlci4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ3dpbmRvdycgaW1wbGVtZW50YXRpb24gb3IgbnVsbCBpZiBub3QgYXZhaWxhYmxlLiAqL1xuZnVuY3Rpb24gT3UoKSB7XG4gICAgLy8gYHdpbmRvd2AgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB3aW5kb3cgPyB3aW5kb3cgOiBudWxsO1xufVxuXG4vKiogVGhlIFBsYXRmb3JtJ3MgJ2RvY3VtZW50JyBpbXBsZW1lbnRhdGlvbiBvciBudWxsIGlmIG5vdCBhdmFpbGFibGUuICovIGZ1bmN0aW9uICR1KCkge1xuICAgIC8vIGBkb2N1bWVudGAgaXMgbm90IGFsd2F5cyBhdmFpbGFibGUsIGUuZy4gaW4gUmVhY3ROYXRpdmUgYW5kIFdlYldvcmtlcnMuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHJldHVybiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBkb2N1bWVudCA/IGRvY3VtZW50IDogbnVsbDtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gZnVuY3Rpb24gRnUodCkge1xuICAgIHJldHVybiBuZXcgVmkodCwgLyogdXNlUHJvdG8zSnNvbj0gKi8gITApO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBIGhlbHBlciBmb3IgcnVubmluZyBkZWxheWVkIHRhc2tzIGZvbGxvd2luZyBhbiBleHBvbmVudGlhbCBiYWNrb2ZmIGN1cnZlXG4gKiBiZXR3ZWVuIGF0dGVtcHRzLlxuICpcbiAqIEVhY2ggZGVsYXkgaXMgbWFkZSB1cCBvZiBhIFwiYmFzZVwiIGRlbGF5IHdoaWNoIGZvbGxvd3MgdGhlIGV4cG9uZW50aWFsXG4gKiBiYWNrb2ZmIGN1cnZlLCBhbmQgYSArLy0gNTAlIFwiaml0dGVyXCIgdGhhdCBpcyBjYWxjdWxhdGVkIGFuZCBhZGRlZCB0byB0aGVcbiAqIGJhc2UgZGVsYXkuIFRoaXMgcHJldmVudHMgY2xpZW50cyBmcm9tIGFjY2lkZW50YWxseSBzeW5jaHJvbml6aW5nIHRoZWlyXG4gKiBkZWxheXMgY2F1c2luZyBzcGlrZXMgb2YgbG9hZCB0byB0aGUgYmFja2VuZC5cbiAqL1xuY2xhc3MgQnUge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKlxuICAgICAqIFRoZSBBc3luY1F1ZXVlIHRvIHJ1biBiYWNrb2ZmIG9wZXJhdGlvbnMgb24uXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqXG4gICAgICogVGhlIElEIHRvIHVzZSB3aGVuIHNjaGVkdWxpbmcgYmFja29mZiBvcGVyYXRpb25zIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAqL1xuICAgIGUsIFxuICAgIC8qKlxuICAgICAqIFRoZSBpbml0aWFsIGRlbGF5ICh1c2VkIGFzIHRoZSBiYXNlIGRlbGF5IG9uIHRoZSBmaXJzdCByZXRyeSBhdHRlbXB0KS5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIGxpdHRsZSBhcyAwLjUqaW5pdGlhbERlbGF5TXMuXG4gICAgICovXG4gICAgbiA9IDFlM1xuICAgIC8qKlxuICAgICAqIFRoZSBtdWx0aXBsaWVyIHRvIHVzZSB0byBkZXRlcm1pbmUgdGhlIGV4dGVuZGVkIGJhc2UgZGVsYXkgYWZ0ZXIgZWFjaFxuICAgICAqIGF0dGVtcHQuXG4gICAgICovICwgcyA9IDEuNVxuICAgIC8qKlxuICAgICAqIFRoZSBtYXhpbXVtIGJhc2UgZGVsYXkgYWZ0ZXIgd2hpY2ggbm8gZnVydGhlciBiYWNrb2ZmIGlzIHBlcmZvcm1lZC5cbiAgICAgKiBOb3RlIHRoYXQgaml0dGVyIHdpbGwgc3RpbGwgYmUgYXBwbGllZCwgc28gdGhlIGFjdHVhbCBkZWxheSBjb3VsZCBiZSBhc1xuICAgICAqIG11Y2ggYXMgMS41Km1heERlbGF5TXMuXG4gICAgICovICwgaSA9IDZlNCkge1xuICAgICAgICB0aGlzLnNpID0gdCwgdGhpcy50aW1lcklkID0gZSwgdGhpcy52byA9IG4sIHRoaXMuUG8gPSBzLCB0aGlzLmJvID0gaSwgdGhpcy5WbyA9IDAsIFxuICAgICAgICB0aGlzLlNvID0gbnVsbCwgXG4gICAgICAgIC8qKiBUaGUgbGFzdCBiYWNrb2ZmIGF0dGVtcHQsIGFzIGVwb2NoIG1pbGxpc2Vjb25kcy4gKi9cbiAgICAgICAgdGhpcy5EbyA9IERhdGUubm93KCksIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVzZXRzIHRoZSBiYWNrb2ZmIGRlbGF5LlxuICAgICAqXG4gICAgICogVGhlIHZlcnkgbmV4dCBiYWNrb2ZmQW5kV2FpdCgpIHdpbGwgaGF2ZSBubyBkZWxheS4gSWYgaXQgaXMgY2FsbGVkIGFnYWluXG4gICAgICogKGkuZS4gZHVlIHRvIGFuIGVycm9yKSwgaW5pdGlhbERlbGF5TXMgKHBsdXMgaml0dGVyKSB3aWxsIGJlIHVzZWQsIGFuZFxuICAgICAqIHN1YnNlcXVlbnQgb25lcyB3aWxsIGluY3JlYXNlIGFjY29yZGluZyB0byB0aGUgYmFja29mZkZhY3Rvci5cbiAgICAgKi8gICAgcmVzZXQoKSB7XG4gICAgICAgIHRoaXMuVm8gPSAwO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXNldHMgdGhlIGJhY2tvZmYgZGVsYXkgdG8gdGhlIG1heGltdW0gZGVsYXkgKGUuZy4gZm9yIHVzZSBhZnRlciBhXG4gICAgICogUkVTT1VSQ0VfRVhIQVVTVEVEIGVycm9yKS5cbiAgICAgKi8gICAgQ28oKSB7XG4gICAgICAgIHRoaXMuVm8gPSB0aGlzLmJvO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIGFmdGVyIGN1cnJlbnREZWxheU1zLCBhbmQgaW5jcmVhc2VzIHRoZVxuICAgICAqIGRlbGF5IGZvciBhbnkgc3Vic2VxdWVudCBhdHRlbXB0cy4gSWYgdGhlcmUgd2FzIGEgcGVuZGluZyBiYWNrb2ZmIG9wZXJhdGlvblxuICAgICAqIGFscmVhZHksIGl0IHdpbGwgYmUgY2FuY2VsZWQuXG4gICAgICovICAgIHhvKHQpIHtcbiAgICAgICAgLy8gQ2FuY2VsIGFueSBwZW5kaW5nIGJhY2tvZmYgb3BlcmF0aW9uLlxuICAgICAgICB0aGlzLmNhbmNlbCgpO1xuICAgICAgICAvLyBGaXJzdCBzY2hlZHVsZSB1c2luZyB0aGUgY3VycmVudCBiYXNlICh3aGljaCBtYXkgYmUgMCBhbmQgc2hvdWxkIGJlXG4gICAgICAgIC8vIGhvbm9yZWQgYXMgc3VjaCkuXG4gICAgICAgIGNvbnN0IGUgPSBNYXRoLmZsb29yKHRoaXMuVm8gKyB0aGlzLk5vKCkpLCBuID0gTWF0aC5tYXgoMCwgRGF0ZS5ub3coKSAtIHRoaXMuRG8pLCBzID0gTWF0aC5tYXgoMCwgZSAtIG4pO1xuICAgICAgICAvLyBHdWFyZCBhZ2FpbnN0IGxhc3RBdHRlbXB0VGltZSBiZWluZyBpbiB0aGUgZnV0dXJlIGR1ZSB0byBhIGNsb2NrIGNoYW5nZS5cbiAgICAgICAgICAgICAgICBzID4gMCAmJiBOKFwiRXhwb25lbnRpYWxCYWNrb2ZmXCIsIGBCYWNraW5nIG9mZiBmb3IgJHtzfSBtcyAoYmFzZSBkZWxheTogJHt0aGlzLlZvfSBtcywgZGVsYXkgd2l0aCBqaXR0ZXI6ICR7ZX0gbXMsIGxhc3QgYXR0ZW1wdDogJHtufSBtcyBhZ28pYCksIFxuICAgICAgICB0aGlzLlNvID0gdGhpcy5zaS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLnRpbWVySWQsIHMsICgoKSA9PiAodGhpcy5EbyA9IERhdGUubm93KCksIFxuICAgICAgICB0KCkpKSksIFxuICAgICAgICAvLyBBcHBseSBiYWNrb2ZmIGZhY3RvciB0byBkZXRlcm1pbmUgbmV4dCBkZWxheSBhbmQgZW5zdXJlIGl0IGlzIHdpdGhpblxuICAgICAgICAvLyBib3VuZHMuXG4gICAgICAgIHRoaXMuVm8gKj0gdGhpcy5QbywgdGhpcy5WbyA8IHRoaXMudm8gJiYgKHRoaXMuVm8gPSB0aGlzLnZvKSwgdGhpcy5WbyA+IHRoaXMuYm8gJiYgKHRoaXMuVm8gPSB0aGlzLmJvKTtcbiAgICB9XG4gICAga28oKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuU28gJiYgKHRoaXMuU28uc2tpcERlbGF5KCksIHRoaXMuU28gPSBudWxsKTtcbiAgICB9XG4gICAgY2FuY2VsKCkge1xuICAgICAgICBudWxsICE9PSB0aGlzLlNvICYmICh0aGlzLlNvLmNhbmNlbCgpLCB0aGlzLlNvID0gbnVsbCk7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgcmFuZG9tIHZhbHVlIGluIHRoZSByYW5nZSBbLWN1cnJlbnRCYXNlTXMvMiwgY3VycmVudEJhc2VNcy8yXSAqLyAgICBObygpIHtcbiAgICAgICAgcmV0dXJuIChNYXRoLnJhbmRvbSgpIC0gLjUpICogdGhpcy5WbztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgUGVyc2lzdGVudFN0cmVhbSBpcyBhbiBhYnN0cmFjdCBiYXNlIGNsYXNzIHRoYXQgcmVwcmVzZW50cyBhIHN0cmVhbWluZyBSUENcbiAqIHRvIHRoZSBGaXJlc3RvcmUgYmFja2VuZC4gSXQncyBidWlsdCBvbiB0b3Agb2YgdGhlIGNvbm5lY3Rpb25zIG93biBzdXBwb3J0XG4gKiBmb3Igc3RyZWFtaW5nIFJQQ3MsIGFuZCBhZGRzIHNldmVyYWwgY3JpdGljYWwgZmVhdHVyZXMgZm9yIG91ciBjbGllbnRzOlxuICpcbiAqICAgLSBFeHBvbmVudGlhbCBiYWNrb2ZmIG9uIGZhaWx1cmVcbiAqICAgLSBBdXRoZW50aWNhdGlvbiB2aWEgQ3JlZGVudGlhbHNQcm92aWRlclxuICogICAtIERpc3BhdGNoaW5nIGFsbCBjYWxsYmFja3MgaW50byB0aGUgc2hhcmVkIHdvcmtlciBxdWV1ZVxuICogICAtIENsb3NpbmcgaWRsZSBzdHJlYW1zIGFmdGVyIDYwIHNlY29uZHMgb2YgaW5hY3Rpdml0eVxuICpcbiAqIFN1YmNsYXNzZXMgb2YgUGVyc2lzdGVudFN0cmVhbSBpbXBsZW1lbnQgc2VyaWFsaXphdGlvbiBvZiBtb2RlbHMgdG8gYW5kXG4gKiBmcm9tIHRoZSBKU09OIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBwcm90b2NvbCBidWZmZXJzIGZvciBhIHNwZWNpZmljXG4gKiBzdHJlYW1pbmcgUlBDLlxuICpcbiAqICMjIFN0YXJ0aW5nIGFuZCBTdG9wcGluZ1xuICpcbiAqIFN0cmVhbWluZyBSUENzIGFyZSBzdGF0ZWZ1bCBhbmQgbmVlZCB0byBiZSBzdGFydCgpZWQgYmVmb3JlIG1lc3NhZ2VzIGNhblxuICogYmUgc2VudCBhbmQgcmVjZWl2ZWQuIFRoZSBQZXJzaXN0ZW50U3RyZWFtIHdpbGwgY2FsbCB0aGUgb25PcGVuKCkgZnVuY3Rpb25cbiAqIG9mIHRoZSBsaXN0ZW5lciBvbmNlIHRoZSBzdHJlYW0gaXMgcmVhZHkgdG8gYWNjZXB0IHJlcXVlc3RzLlxuICpcbiAqIFNob3VsZCBhIHN0YXJ0KCkgZmFpbCwgUGVyc2lzdGVudFN0cmVhbSB3aWxsIGNhbGwgdGhlIHJlZ2lzdGVyZWQgb25DbG9zZSgpXG4gKiBsaXN0ZW5lciB3aXRoIGEgRmlyZXN0b3JlRXJyb3IgaW5kaWNhdGluZyB3aGF0IHdlbnQgd3JvbmcuXG4gKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIGNhbiBiZSBzdGFydGVkIGFuZCBzdG9wcGVkIHJlcGVhdGVkbHkuXG4gKlxuICogR2VuZXJpYyB0eXBlczpcbiAqICBTZW5kVHlwZTogVGhlIHR5cGUgb2YgdGhlIG91dGdvaW5nIG1lc3NhZ2Ugb2YgdGhlIHVuZGVybHlpbmdcbiAqICAgIGNvbm5lY3Rpb24gc3RyZWFtXG4gKiAgUmVjZWl2ZVR5cGU6IFRoZSB0eXBlIG9mIHRoZSBpbmNvbWluZyBtZXNzYWdlIG9mIHRoZSB1bmRlcmx5aW5nXG4gKiAgICBjb25uZWN0aW9uIHN0cmVhbVxuICogIExpc3RlbmVyVHlwZTogVGhlIHR5cGUgb2YgdGhlIGxpc3RlbmVyIHRoYXQgd2lsbCBiZSB1c2VkIGZvciBjYWxsYmFja3NcbiAqL1xuY2xhc3MgTHUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIsIG8sIHUpIHtcbiAgICAgICAgdGhpcy5zaSA9IHQsIHRoaXMuTW8gPSBuLCB0aGlzLk9vID0gcywgdGhpcy5jb25uZWN0aW9uID0gaSwgdGhpcy5hdXRoQ3JlZGVudGlhbHNQcm92aWRlciA9IHIsIFxuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlciA9IG8sIHRoaXMubGlzdGVuZXIgPSB1LCB0aGlzLnN0YXRlID0gMCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCAqLyAsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBjbG9zZSBjb3VudCB0aGF0J3MgaW5jcmVtZW50ZWQgZXZlcnkgdGltZSB0aGUgc3RyZWFtIGlzIGNsb3NlZDsgdXNlZCBieVxuICAgICAgICAgKiBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyKCkgdG8gaW52YWxpZGF0ZSBjYWxsYmFja3MgdGhhdCBoYXBwZW4gYWZ0ZXJcbiAgICAgICAgICogY2xvc2UuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLiRvID0gMCwgdGhpcy5GbyA9IG51bGwsIHRoaXMuQm8gPSBudWxsLCB0aGlzLnN0cmVhbSA9IG51bGwsIHRoaXMuTG8gPSBuZXcgQnUodCwgZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiBzdGFydCgpIGhhcyBiZWVuIGNhbGxlZCBhbmQgbm8gZXJyb3IgaGFzIG9jY3VycmVkLiBUcnVlXG4gICAgICogaW5kaWNhdGVzIHRoZSBzdHJlYW0gaXMgb3BlbiBvciBpbiB0aGUgcHJvY2VzcyBvZiBvcGVuaW5nICh3aGljaFxuICAgICAqIGVuY29tcGFzc2VzIHJlc3BlY3RpbmcgYmFja29mZiwgZ2V0dGluZyBhdXRoIHRva2VucywgYW5kIHN0YXJ0aW5nIHRoZVxuICAgICAqIGFjdHVhbCBSUEMpLiBVc2UgaXNPcGVuKCkgdG8gZGV0ZXJtaW5lIGlmIHRoZSBzdHJlYW0gaXMgb3BlbiBhbmQgcmVhZHkgZm9yXG4gICAgICogb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIHFvKCkge1xuICAgICAgICByZXR1cm4gMSAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuU3RhcnRpbmcgKi8gPT09IHRoaXMuc3RhdGUgfHwgNSAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuQmFja29mZiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCB0aGlzLlVvKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGUgdW5kZXJseWluZyBSUEMgaXMgb3BlbiAodGhlIG9uT3BlbigpIGxpc3RlbmVyIGhhcyBiZWVuXG4gICAgICogY2FsbGVkKSBhbmQgdGhlIHN0cmVhbSBpcyByZWFkeSBmb3Igb3V0Ym91bmQgcmVxdWVzdHMuXG4gICAgICovICAgIFVvKCkge1xuICAgICAgICByZXR1cm4gMiAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuT3BlbiAqLyA9PT0gdGhpcy5zdGF0ZSB8fCAzIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5IZWFsdGh5ICovID09PSB0aGlzLnN0YXRlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTdGFydHMgdGhlIFJQQy4gT25seSBhbGxvd2VkIGlmIGlzU3RhcnRlZCgpIHJldHVybnMgZmFsc2UuIFRoZSBzdHJlYW0gaXNcbiAgICAgKiBub3QgaW1tZWRpYXRlbHkgcmVhZHkgZm9yIHVzZTogb25PcGVuKCkgd2lsbCBiZSBpbnZva2VkIHdoZW4gdGhlIFJQQyBpc1xuICAgICAqIHJlYWR5IGZvciBvdXRib3VuZCByZXF1ZXN0cywgYXQgd2hpY2ggcG9pbnQgaXNPcGVuKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKlxuICAgICAqIFdoZW4gc3RhcnQgcmV0dXJucywgaXNTdGFydGVkKCkgd2lsbCByZXR1cm4gdHJ1ZS5cbiAgICAgKi8gICAgc3RhcnQoKSB7XG4gICAgICAgIDQgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yICovICE9PSB0aGlzLnN0YXRlID8gdGhpcy5hdXRoKCkgOiB0aGlzLktvKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0b3BzIHRoZSBSUEMuIFRoaXMgY2FsbCBpcyBpZGVtcG90ZW50IGFuZCBhbGxvd2VkIHJlZ2FyZGxlc3Mgb2YgdGhlXG4gICAgICogY3VycmVudCBpc1N0YXJ0ZWQoKSBzdGF0ZS5cbiAgICAgKlxuICAgICAqIFdoZW4gc3RvcCByZXR1cm5zLCBpc1N0YXJ0ZWQoKSBhbmQgaXNPcGVuKCkgd2lsbCBib3RoIHJldHVybiBmYWxzZS5cbiAgICAgKi8gICAgYXN5bmMgc3RvcCgpIHtcbiAgICAgICAgdGhpcy5xbygpICYmIGF3YWl0IHRoaXMuY2xvc2UoMCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCAqLyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEFmdGVyIGFuIGVycm9yIHRoZSBzdHJlYW0gd2lsbCB1c3VhbGx5IGJhY2sgb2ZmIG9uIHRoZSBuZXh0IGF0dGVtcHQgdG9cbiAgICAgKiBzdGFydCBpdC4gSWYgdGhlIGVycm9yIHdhcnJhbnRzIGFuIGltbWVkaWF0ZSByZXN0YXJ0IG9mIHRoZSBzdHJlYW0sIHRoZVxuICAgICAqIHNlbmRlciBjYW4gdXNlIHRoaXMgdG8gaW5kaWNhdGUgdGhhdCB0aGUgcmVjZWl2ZXIgc2hvdWxkIG5vdCBiYWNrIG9mZi5cbiAgICAgKlxuICAgICAqIEVhY2ggZXJyb3Igd2lsbCBjYWxsIHRoZSBvbkNsb3NlKCkgbGlzdGVuZXIuIFRoYXQgZnVuY3Rpb24gY2FuIGRlY2lkZSB0b1xuICAgICAqIGluaGliaXQgYmFja29mZiBpZiByZXF1aXJlZC5cbiAgICAgKi8gICAgR28oKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSAwIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5Jbml0aWFsICovICwgdGhpcy5Mby5yZXNldCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBNYXJrcyB0aGlzIHN0cmVhbSBhcyBpZGxlLiBJZiBubyBmdXJ0aGVyIGFjdGlvbnMgYXJlIHBlcmZvcm1lZCBvbiB0aGVcbiAgICAgKiBzdHJlYW0gZm9yIG9uZSBtaW51dGUsIHRoZSBzdHJlYW0gd2lsbCBhdXRvbWF0aWNhbGx5IGNsb3NlIGl0c2VsZiBhbmRcbiAgICAgKiBub3RpZnkgdGhlIHN0cmVhbSdzIG9uQ2xvc2UoKSBoYW5kbGVyIHdpdGggU3RhdHVzLk9LLiBUaGUgc3RyZWFtIHdpbGwgdGhlblxuICAgICAqIGJlIGluIGEgIWlzU3RhcnRlZCgpIHN0YXRlLCByZXF1aXJpbmcgdGhlIGNhbGxlciB0byBzdGFydCB0aGUgc3RyZWFtIGFnYWluXG4gICAgICogYmVmb3JlIGZ1cnRoZXIgdXNlLlxuICAgICAqXG4gICAgICogT25seSBzdHJlYW1zIHRoYXQgYXJlIGluIHN0YXRlICdPcGVuJyBjYW4gYmUgbWFya2VkIGlkbGUsIGFzIGFsbCBvdGhlclxuICAgICAqIHN0YXRlcyBpbXBseSBwZW5kaW5nIG5ldHdvcmsgb3BlcmF0aW9ucy5cbiAgICAgKi8gICAgUW8oKSB7XG4gICAgICAgIC8vIFN0YXJ0cyB0aGUgaWRsZSB0aW1lIGlmIHdlIGFyZSBpbiBzdGF0ZSAnT3BlbicgYW5kIGFyZSBub3QgeWV0IGFscmVhZHlcbiAgICAgICAgLy8gcnVubmluZyBhIHRpbWVyIChpbiB3aGljaCBjYXNlIHRoZSBwcmV2aW91cyBpZGxlIHRpbWVvdXQgc3RpbGwgYXBwbGllcykuXG4gICAgICAgIHRoaXMuVW8oKSAmJiBudWxsID09PSB0aGlzLkZvICYmICh0aGlzLkZvID0gdGhpcy5zaS5lbnF1ZXVlQWZ0ZXJEZWxheSh0aGlzLk1vLCA2ZTQsICgoKSA9PiB0aGlzLmpvKCkpKSk7XG4gICAgfVxuICAgIC8qKiBTZW5kcyBhIG1lc3NhZ2UgdG8gdGhlIHVuZGVybHlpbmcgc3RyZWFtLiAqLyAgICB6byh0KSB7XG4gICAgICAgIHRoaXMuV28oKSwgdGhpcy5zdHJlYW0uc2VuZCh0KTtcbiAgICB9XG4gICAgLyoqIENhbGxlZCBieSB0aGUgaWRsZSB0aW1lciB3aGVuIHRoZSBzdHJlYW0gc2hvdWxkIGNsb3NlIGR1ZSB0byBpbmFjdGl2aXR5LiAqLyAgICBhc3luYyBqbygpIHtcbiAgICAgICAgaWYgKHRoaXMuVW8oKSkgXG4gICAgICAgIC8vIFdoZW4gdGltaW5nIG91dCBhbiBpZGxlIHN0cmVhbSB0aGVyZSdzIG5vIHJlYXNvbiB0byBmb3JjZSB0aGUgc3RyZWFtIGludG8gYmFja29mZiB3aGVuXG4gICAgICAgIC8vIGl0IHJlc3RhcnRzIHNvIHNldCB0aGUgc3RyZWFtIHN0YXRlIHRvIEluaXRpYWwgaW5zdGVhZCBvZiBFcnJvci5cbiAgICAgICAgcmV0dXJuIHRoaXMuY2xvc2UoMCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCAqLyk7XG4gICAgfVxuICAgIC8qKiBNYXJrcyB0aGUgc3RyZWFtIGFzIGFjdGl2ZSBhZ2Fpbi4gKi8gICAgV28oKSB7XG4gICAgICAgIHRoaXMuRm8gJiYgKHRoaXMuRm8uY2FuY2VsKCksIHRoaXMuRm8gPSBudWxsKTtcbiAgICB9XG4gICAgLyoqIENhbmNlbHMgdGhlIGhlYWx0aCBjaGVjayBkZWxheWVkIG9wZXJhdGlvbi4gKi8gICAgSG8oKSB7XG4gICAgICAgIHRoaXMuQm8gJiYgKHRoaXMuQm8uY2FuY2VsKCksIHRoaXMuQm8gPSBudWxsKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2xvc2VzIHRoZSBzdHJlYW0gYW5kIGNsZWFucyB1cCBhcyBuZWNlc3Nhcnk6XG4gICAgICpcbiAgICAgKiAqIGNsb3NlcyB0aGUgdW5kZXJseWluZyBHUlBDIHN0cmVhbTtcbiAgICAgKiAqIGNhbGxzIHRoZSBvbkNsb3NlIGhhbmRsZXIgd2l0aCB0aGUgZ2l2ZW4gJ2Vycm9yJztcbiAgICAgKiAqIHNldHMgaW50ZXJuYWwgc3RyZWFtIHN0YXRlIHRvICdmaW5hbFN0YXRlJztcbiAgICAgKiAqIGFkanVzdHMgdGhlIGJhY2tvZmYgdGltZXIgYmFzZWQgb24gdGhlIGVycm9yXG4gICAgICpcbiAgICAgKiBBIG5ldyBzdHJlYW0gY2FuIGJlIG9wZW5lZCBieSBjYWxsaW5nIHN0YXJ0KCkuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmluYWxTdGF0ZSAtIHRoZSBpbnRlbmRlZCBzdGF0ZSBvZiB0aGUgc3RyZWFtIGFmdGVyIGNsb3NpbmcuXG4gICAgICogQHBhcmFtIGVycm9yIC0gdGhlIGVycm9yIHRoZSBjb25uZWN0aW9uIHdhcyBjbG9zZWQgd2l0aC5cbiAgICAgKi8gICAgYXN5bmMgY2xvc2UodCwgZSkge1xuICAgICAgICAvLyBDYW5jZWwgYW55IG91dHN0YW5kaW5nIHRpbWVycyAodGhleSdyZSBndWFyYW50ZWVkIG5vdCB0byBleGVjdXRlKS5cbiAgICAgICAgdGhpcy5XbygpLCB0aGlzLkhvKCksIHRoaXMuTG8uY2FuY2VsKCksIFxuICAgICAgICAvLyBJbnZhbGlkYXRlcyBhbnkgc3RyZWFtLXJlbGF0ZWQgY2FsbGJhY2tzIChlLmcuIGZyb20gYXV0aCBvciB0aGVcbiAgICAgICAgLy8gdW5kZXJseWluZyBzdHJlYW0pLCBndWFyYW50ZWVpbmcgdGhleSB3b24ndCBleGVjdXRlLlxuICAgICAgICB0aGlzLiRvKyssIDQgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkVycm9yICovICE9PSB0ID8gXG4gICAgICAgIC8vIElmIHRoaXMgaXMgYW4gaW50ZW50aW9uYWwgY2xvc2UgZW5zdXJlIHdlIGRvbid0IGRlbGF5IG91ciBuZXh0IGNvbm5lY3Rpb24gYXR0ZW1wdC5cbiAgICAgICAgdGhpcy5Mby5yZXNldCgpIDogZSAmJiBlLmNvZGUgPT09IHEuUkVTT1VSQ0VfRVhIQVVTVEVEID8gKFxuICAgICAgICAvLyBMb2cgdGhlIGVycm9yLiAoUHJvYmFibHkgZWl0aGVyICdxdW90YSBleGNlZWRlZCcgb3IgJ21heCBxdWV1ZSBsZW5ndGggcmVhY2hlZCcuKVxuICAgICAgICBrKGUudG9TdHJpbmcoKSksIGsoXCJVc2luZyBtYXhpbXVtIGJhY2tvZmYgZGVsYXkgdG8gcHJldmVudCBvdmVybG9hZGluZyB0aGUgYmFja2VuZC5cIiksIFxuICAgICAgICB0aGlzLkxvLkNvKCkpIDogZSAmJiBlLmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmIDMgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkhlYWx0aHkgKi8gIT09IHRoaXMuc3RhdGUgJiYgKFxuICAgICAgICAvLyBcInVuYXV0aGVudGljYXRlZFwiIGVycm9yIG1lYW5zIHRoZSB0b2tlbiB3YXMgcmVqZWN0ZWQuIFRoaXMgc2hvdWxkIHJhcmVseVxuICAgICAgICAvLyBoYXBwZW4gc2luY2UgYm90aCBBdXRoIGFuZCBBcHBDaGVjayBlbnN1cmUgYSBzdWZmaWNpZW50IFRUTCB3aGVuIHdlXG4gICAgICAgIC8vIHJlcXVlc3QgYSB0b2tlbi4gSWYgYSB1c2VyIG1hbnVhbGx5IHJlc2V0cyB0aGVpciBzeXN0ZW0gY2xvY2sgdGhpcyBjYW5cbiAgICAgICAgLy8gZmFpbCwgaG93ZXZlci4gSW4gdGhpcyBjYXNlLCB3ZSBzaG91bGQgZ2V0IGEgQ29kZS5VTkFVVEhFTlRJQ0FURUQgZXJyb3JcbiAgICAgICAgLy8gYmVmb3JlIHdlIHJlY2VpdmVkIHRoZSBmaXJzdCBtZXNzYWdlIGFuZCB3ZSBuZWVkIHRvIGludmFsaWRhdGUgdGhlIHRva2VuXG4gICAgICAgIC8vIHRvIGVuc3VyZSB0aGF0IHdlIGZldGNoIGEgbmV3IHRva2VuLlxuICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFsc1Byb3ZpZGVyLmludmFsaWRhdGVUb2tlbigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHNQcm92aWRlci5pbnZhbGlkYXRlVG9rZW4oKSksIFxuICAgICAgICAvLyBDbGVhbiB1cCB0aGUgdW5kZXJseWluZyBzdHJlYW0gYmVjYXVzZSB3ZSBhcmUgbm8gbG9uZ2VyIGludGVyZXN0ZWQgaW4gZXZlbnRzLlxuICAgICAgICBudWxsICE9PSB0aGlzLnN0cmVhbSAmJiAodGhpcy5KbygpLCB0aGlzLnN0cmVhbS5jbG9zZSgpLCB0aGlzLnN0cmVhbSA9IG51bGwpLCBcbiAgICAgICAgLy8gVGhpcyBzdGF0ZSBtdXN0IGJlIGFzc2lnbmVkIGJlZm9yZSBjYWxsaW5nIG9uQ2xvc2UoKSB0byBhbGxvdyB0aGUgY2FsbGJhY2sgdG9cbiAgICAgICAgLy8gaW5oaWJpdCBiYWNrb2ZmIG9yIG90aGVyd2lzZSBtYW5pcHVsYXRlIHRoZSBzdGF0ZSBpbiBpdHMgbm9uLXN0YXJ0ZWQgc3RhdGUuXG4gICAgICAgIHRoaXMuc3RhdGUgPSB0LCBcbiAgICAgICAgLy8gTm90aWZ5IHRoZSBsaXN0ZW5lciB0aGF0IHRoZSBzdHJlYW0gY2xvc2VkLlxuICAgICAgICBhd2FpdCB0aGlzLmxpc3RlbmVyLmNvKGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDYW4gYmUgb3ZlcnJpZGRlbiB0byBwZXJmb3JtIGFkZGl0aW9uYWwgY2xlYW51cCBiZWZvcmUgdGhlIHN0cmVhbSBpcyBjbG9zZWQuXG4gICAgICogQ2FsbGluZyBzdXBlci50ZWFyRG93bigpIGlzIG5vdCByZXF1aXJlZC5cbiAgICAgKi8gICAgSm8oKSB7fVxuICAgIGF1dGgoKSB7XG4gICAgICAgIHRoaXMuc3RhdGUgPSAxIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5TdGFydGluZyAqLztcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuWW8odGhpcy4kbyksIGUgPSB0aGlzLiRvO1xuICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IEp1c3QgdXNlIGRpc3BhdGNoSWZOb3RDbG9zZWQsIGJ1dCBzZWUgVE9ETyBiZWxvdy5cbiAgICAgICAgICAgICAgICBQcm9taXNlLmFsbChbIHRoaXMuYXV0aENyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzUHJvdmlkZXIuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW3QsIG5dKSA9PiB7XG4gICAgICAgICAgICAvLyBTdHJlYW0gY2FuIGJlIHN0b3BwZWQgd2hpbGUgd2FpdGluZyBmb3IgYXV0aGVudGljYXRpb24uXG4gICAgICAgICAgICAvLyBUT0RPKG1pa2VsZWhlbik6IFdlIHJlYWxseSBzaG91bGQganVzdCB1c2UgZGlzcGF0Y2hJZk5vdENsb3NlZFxuICAgICAgICAgICAgLy8gYW5kIGxldCB0aGlzIGRpc3BhdGNoIG9udG8gdGhlIHF1ZXVlLCBidXQgdGhhdCBvcGVuZWQgYSBzcGVjIHRlc3QgY2FuXG4gICAgICAgICAgICAvLyBvZiB3b3JtcyB0aGF0IEkgZG9uJ3Qgd2FudCB0byBkZWFsIHdpdGggaW4gdGhpcyBQUi5cbiAgICAgICAgICAgIHRoaXMuJG8gPT09IGUgJiYgXG4gICAgICAgICAgICAvLyBOb3JtYWxseSB3ZSdkIGhhdmUgdG8gc2NoZWR1bGUgdGhlIGNhbGxiYWNrIG9uIHRoZSBBc3luY1F1ZXVlLlxuICAgICAgICAgICAgLy8gSG93ZXZlciwgdGhlIGZvbGxvd2luZyBjYWxscyBhcmUgc2FmZSB0byBiZSBjYWxsZWQgb3V0c2lkZSB0aGVcbiAgICAgICAgICAgIC8vIEFzeW5jUXVldWUgc2luY2UgdGhleSBkb24ndCBjaGFpbiBhc3luY2hyb25vdXMgY2FsbHNcbiAgICAgICAgICAgIHRoaXMuWG8odCwgbik7XG4gICAgICAgIH0pLCAoZSA9PiB7XG4gICAgICAgICAgICB0KCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG5ldyBVKHEuVU5LTk9XTiwgXCJGZXRjaGluZyBhdXRoIHRva2VuIGZhaWxlZDogXCIgKyBlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLlpvKHQpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIFhvKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHRoaXMuWW8odGhpcy4kbyk7XG4gICAgICAgIHRoaXMuc3RyZWFtID0gdGhpcy50dSh0LCBlKSwgdGhpcy5zdHJlYW0ub28oKCgpID0+IHtcbiAgICAgICAgICAgIG4oKCgpID0+ICh0aGlzLnN0YXRlID0gMiAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuT3BlbiAqLyAsIHRoaXMuQm8gPSB0aGlzLnNpLmVucXVldWVBZnRlckRlbGF5KHRoaXMuT28sIDFlNCwgKCgpID0+ICh0aGlzLlVvKCkgJiYgKHRoaXMuc3RhdGUgPSAzIC8qIFBlcnNpc3RlbnRTdHJlYW1TdGF0ZS5IZWFsdGh5ICovKSwgXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKSwgdGhpcy5saXN0ZW5lci5vbygpKSkpO1xuICAgICAgICB9KSksIHRoaXMuc3RyZWFtLmNvKCh0ID0+IHtcbiAgICAgICAgICAgIG4oKCgpID0+IHRoaXMuWm8odCkpKTtcbiAgICAgICAgfSkpLCB0aGlzLnN0cmVhbS5vbk1lc3NhZ2UoKHQgPT4ge1xuICAgICAgICAgICAgbigoKCkgPT4gdGhpcy5vbk1lc3NhZ2UodCkpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBLbygpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IDUgLyogUGVyc2lzdGVudFN0cmVhbVN0YXRlLkJhY2tvZmYgKi8gLCB0aGlzLkxvLnhvKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnN0YXRlID0gMCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuSW5pdGlhbCAqLyAsIHRoaXMuc3RhcnQoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICAvLyBWaXNpYmxlIGZvciB0ZXN0c1xuICAgIFpvKHQpIHtcbiAgICAgICAgLy8gSW4gdGhlb3J5IHRoZSBzdHJlYW0gY291bGQgY2xvc2UgY2xlYW5seSwgaG93ZXZlciwgaW4gb3VyIGN1cnJlbnQgbW9kZWxcbiAgICAgICAgLy8gd2UgbmV2ZXIgZXhwZWN0IHRoaXMgdG8gaGFwcGVuIGJlY2F1c2UgaWYgd2Ugc3RvcCBhIHN0cmVhbSBvdXJzZWx2ZXMsXG4gICAgICAgIC8vIHRoaXMgY2FsbGJhY2sgd2lsbCBuZXZlciBiZSBjYWxsZWQuIFRvIHByZXZlbnQgY2FzZXMgd2hlcmUgd2UgcmV0cnlcbiAgICAgICAgLy8gd2l0aG91dCBhIGJhY2tvZmYgYWNjaWRlbnRhbGx5LCB3ZSBzZXQgdGhlIHN0cmVhbSB0byBlcnJvciBpbiBhbGwgY2FzZXMuXG4gICAgICAgIHJldHVybiBOKFwiUGVyc2lzdGVudFN0cmVhbVwiLCBgY2xvc2Ugd2l0aCBlcnJvcjogJHt0fWApLCB0aGlzLnN0cmVhbSA9IG51bGwsIHRoaXMuY2xvc2UoNCAvKiBQZXJzaXN0ZW50U3RyZWFtU3RhdGUuRXJyb3IgKi8gLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIFwiZGlzcGF0Y2hlclwiIGZ1bmN0aW9uIHRoYXQgZGlzcGF0Y2hlcyBvcGVyYXRpb25zIG9udG8gdGhlXG4gICAgICogQXN5bmNRdWV1ZSBidXQgb25seSBydW5zIHRoZW0gaWYgY2xvc2VDb3VudCByZW1haW5zIHVuY2hhbmdlZC4gVGhpcyBhbGxvd3NcbiAgICAgKiB1cyB0byB0dXJuIGF1dGggLyBzdHJlYW0gY2FsbGJhY2tzIGludG8gbm8tb3BzIGlmIHRoZSBzdHJlYW0gaXMgY2xvc2VkIC9cbiAgICAgKiByZS1vcGVuZWQsIGV0Yy5cbiAgICAgKi8gICAgWW8odCkge1xuICAgICAgICByZXR1cm4gZSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNpLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHRoaXMuJG8gPT09IHQgPyBlKCkgOiAoTihcIlBlcnNpc3RlbnRTdHJlYW1cIiwgXCJzdHJlYW0gY2FsbGJhY2sgc2tpcHBlZCBieSBnZXRDbG9zZUd1YXJkZWREaXNwYXRjaGVyLlwiKSwgXG4gICAgICAgICAgICBQcm9taXNlLnJlc29sdmUoKSkpKTtcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBQZXJzaXN0ZW50U3RyZWFtIHRoYXQgaW1wbGVtZW50cyB0aGUgTGlzdGVuIFJQQy5cbiAqXG4gKiBPbmNlIHRoZSBMaXN0ZW4gc3RyZWFtIGhhcyBjYWxsZWQgdGhlIG9uT3BlbigpIGxpc3RlbmVyLCBhbnkgbnVtYmVyIG9mXG4gKiBsaXN0ZW4oKSBhbmQgdW5saXN0ZW4oKSBjYWxscyBjYW4gYmUgbWFkZSB0byBjb250cm9sIHdoYXQgY2hhbmdlcyB3aWxsIGJlXG4gKiBzZW50IGZyb20gdGhlIHNlcnZlciBmb3IgTGlzdGVuUmVzcG9uc2VzLlxuICovIGNsYXNzIHF1IGV4dGVuZHMgTHUge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgc3VwZXIodCwgXCJsaXN0ZW5fc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIFRpbWVySWQuTGlzdGVuU3RyZWFtQ29ubmVjdGlvbkJhY2tvZmYgKi8gLCBcImxpc3Rlbl9zdHJlYW1faWRsZVwiIC8qIFRpbWVySWQuTGlzdGVuU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBUaW1lcklkLkhlYWx0aENoZWNrVGltZW91dCAqLyAsIGUsIG4sIHMsIHIpLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gaTtcbiAgICB9XG4gICAgdHUodCwgZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25uZWN0aW9uLlJvKFwiTGlzdGVuXCIsIHQsIGUpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICAvLyBBIHN1Y2Nlc3NmdWwgcmVzcG9uc2UgbWVhbnMgdGhlIHN0cmVhbSBpcyBoZWFsdGh5XG4gICAgICAgIHRoaXMuTG8ucmVzZXQoKTtcbiAgICAgICAgY29uc3QgZSA9IFFpKHRoaXMuc2VyaWFsaXplciwgdCksIG4gPSBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAvLyBXZSBoYXZlIG9ubHkgcmVhY2hlZCBhIGNvbnNpc3RlbnQgc25hcHNob3QgZm9yIHRoZSBlbnRpcmUgc3RyZWFtIGlmIHRoZXJlXG4gICAgICAgICAgICAvLyBpcyBhIHJlYWRfdGltZSBzZXQgYW5kIGl0IGFwcGxpZXMgdG8gYWxsIHRhcmdldHMgKGkuZS4gdGhlIGxpc3Qgb2ZcbiAgICAgICAgICAgIC8vIHRhcmdldHMgaXMgZW1wdHkpLiBUaGUgYmFja2VuZCBpcyBndWFyYW50ZWVkIHRvIHNlbmQgc3VjaCByZXNwb25zZXMuXG4gICAgICAgICAgICBpZiAoIShcInRhcmdldENoYW5nZVwiIGluIHQpKSByZXR1cm4gcnQubWluKCk7XG4gICAgICAgICAgICBjb25zdCBlID0gdC50YXJnZXRDaGFuZ2U7XG4gICAgICAgICAgICByZXR1cm4gZS50YXJnZXRJZHMgJiYgZS50YXJnZXRJZHMubGVuZ3RoID8gcnQubWluKCkgOiBlLnJlYWRUaW1lID8gTmkoZS5yZWFkVGltZSkgOiBydC5taW4oKTtcbiAgICAgICAgfSh0KTtcbiAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIuZXUoZSwgbik7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBpbnRlcmVzdCBpbiB0aGUgcmVzdWx0cyBvZiB0aGUgZ2l2ZW4gdGFyZ2V0LiBJZiB0aGUgdGFyZ2V0XG4gICAgICogaW5jbHVkZXMgYSByZXN1bWVUb2tlbiBpdCB3aWxsIGJlIGluY2x1ZGVkIGluIHRoZSByZXF1ZXN0LiBSZXN1bHRzIHRoYXRcbiAgICAgKiBhZmZlY3QgdGhlIHRhcmdldCB3aWxsIGJlIHN0cmVhbWVkIGJhY2sgYXMgV2F0Y2hDaGFuZ2UgbWVzc2FnZXMgdGhhdFxuICAgICAqIHJlZmVyZW5jZSB0aGUgdGFyZ2V0SWQuXG4gICAgICovICAgIG51KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHt9O1xuICAgICAgICBlLmRhdGFiYXNlID0gTGkodGhpcy5zZXJpYWxpemVyKSwgZS5hZGRUYXJnZXQgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBsZXQgbjtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLnRhcmdldDtcbiAgICAgICAgICAgIGlmIChuID0gRm4ocykgPyB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBIaSh0LCBzKVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBxdWVyeTogSmkodCwgcylcbiAgICAgICAgICAgIH0sIG4udGFyZ2V0SWQgPSBlLnRhcmdldElkLCBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApIHtcbiAgICAgICAgICAgICAgICBuLnJlc3VtZVRva2VuID0gQ2kodCwgZS5yZXN1bWVUb2tlbik7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IFNpKHQsIGUuZXhwZWN0ZWRDb3VudCk7XG4gICAgICAgICAgICAgICAgbnVsbCAhPT0gcyAmJiAobi5leHBlY3RlZENvdW50ID0gcyk7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKGUuc25hcHNob3RWZXJzaW9uLmNvbXBhcmVUbyhydC5taW4oKSkgPiAwKSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyh3dWFuZHkpOiBDb25zaWRlciByZW1vdmluZyBhYm92ZSBjaGVjayBiZWNhdXNlIGl0IGlzIG1vc3QgbGlrZWx5IHRydWUuXG4gICAgICAgICAgICAgICAgLy8gUmlnaHQgbm93LCBtYW55IHRlc3RzIGRlcGVuZCBvbiB0aGlzIGJlaGF2aW91ciB0aG91Z2ggKGxlYXZpbmcgbWluKCkgb3V0XG4gICAgICAgICAgICAgICAgLy8gb2Ygc2VyaWFsaXphdGlvbikuXG4gICAgICAgICAgICAgICAgbi5yZWFkVGltZSA9IERpKHQsIGUuc25hcHNob3RWZXJzaW9uLnRvVGltZXN0YW1wKCkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBTaSh0LCBlLmV4cGVjdGVkQ291bnQpO1xuICAgICAgICAgICAgICAgIG51bGwgIT09IHMgJiYgKG4uZXhwZWN0ZWRDb3VudCA9IHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG47XG4gICAgICAgIH0odGhpcy5zZXJpYWxpemVyLCB0KTtcbiAgICAgICAgY29uc3QgbiA9IFhpKHRoaXMuc2VyaWFsaXplciwgdCk7XG4gICAgICAgIG4gJiYgKGUubGFiZWxzID0gbiksIHRoaXMuem8oZSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVucmVnaXN0ZXJzIGludGVyZXN0IGluIHRoZSByZXN1bHRzIG9mIHRoZSB0YXJnZXQgYXNzb2NpYXRlZCB3aXRoIHRoZVxuICAgICAqIGdpdmVuIHRhcmdldElkLlxuICAgICAqLyAgICBzdSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB7fTtcbiAgICAgICAgZS5kYXRhYmFzZSA9IExpKHRoaXMuc2VyaWFsaXplciksIGUucmVtb3ZlVGFyZ2V0ID0gdCwgdGhpcy56byhlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBTdHJlYW0gdGhhdCBpbXBsZW1lbnRzIHRoZSBXcml0ZSBSUEMuXG4gKlxuICogVGhlIFdyaXRlIFJQQyByZXF1aXJlcyB0aGUgY2FsbGVyIHRvIG1haW50YWluIHNwZWNpYWwgc3RyZWFtVG9rZW5cbiAqIHN0YXRlIGluIGJldHdlZW4gY2FsbHMsIHRvIGhlbHAgdGhlIHNlcnZlciB1bmRlcnN0YW5kIHdoaWNoIHJlc3BvbnNlcyB0aGVcbiAqIGNsaWVudCBoYXMgcHJvY2Vzc2VkIGJ5IHRoZSB0aW1lIHRoZSBuZXh0IHJlcXVlc3QgaXMgbWFkZS4gRXZlcnkgcmVzcG9uc2VcbiAqIHdpbGwgY29udGFpbiBhIHN0cmVhbVRva2VuOyB0aGlzIHZhbHVlIG11c3QgYmUgcGFzc2VkIHRvIHRoZSBuZXh0XG4gKiByZXF1ZXN0LlxuICpcbiAqIEFmdGVyIGNhbGxpbmcgc3RhcnQoKSBvbiB0aGlzIHN0cmVhbSwgdGhlIG5leHQgcmVxdWVzdCBtdXN0IGJlIGEgaGFuZHNoYWtlLFxuICogY29udGFpbmluZyB3aGF0ZXZlciBzdHJlYW1Ub2tlbiBpcyBvbiBoYW5kLiBPbmNlIGEgcmVzcG9uc2UgdG8gdGhpc1xuICogcmVxdWVzdCBpcyByZWNlaXZlZCwgYWxsIHBlbmRpbmcgbXV0YXRpb25zIG1heSBiZSBzdWJtaXR0ZWQuIFdoZW5cbiAqIHN1Ym1pdHRpbmcgbXVsdGlwbGUgYmF0Y2hlcyBvZiBtdXRhdGlvbnMgYXQgdGhlIHNhbWUgdGltZSwgaXQnc1xuICogb2theSB0byB1c2UgdGhlIHNhbWUgc3RyZWFtVG9rZW4gZm9yIHRoZSBjYWxscyB0byB3cml0ZU11dGF0aW9ucy5cbiAqXG4gKiBUT0RPKGIvMzMyNzEyMzUpOiBVc2UgcHJvdG8gdHlwZXNcbiAqLyBjbGFzcyBVdSBleHRlbmRzIEx1IHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByKSB7XG4gICAgICAgIHN1cGVyKHQsIFwid3JpdGVfc3RyZWFtX2Nvbm5lY3Rpb25fYmFja29mZlwiIC8qIFRpbWVySWQuV3JpdGVTdHJlYW1Db25uZWN0aW9uQmFja29mZiAqLyAsIFwid3JpdGVfc3RyZWFtX2lkbGVcIiAvKiBUaW1lcklkLldyaXRlU3RyZWFtSWRsZSAqLyAsIFwiaGVhbHRoX2NoZWNrX3RpbWVvdXRcIiAvKiBUaW1lcklkLkhlYWx0aENoZWNrVGltZW91dCAqLyAsIGUsIG4sIHMsIHIpLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gaSwgdGhpcy5pdSA9ICExO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUcmFja3Mgd2hldGhlciBvciBub3QgYSBoYW5kc2hha2UgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGV4Y2hhbmdlZCBhbmRcbiAgICAgKiB0aGUgc3RyZWFtIGlzIHJlYWR5IHRvIGFjY2VwdCBtdXRhdGlvbnMuXG4gICAgICovICAgIGdldCBydSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXU7XG4gICAgfVxuICAgIC8vIE92ZXJyaWRlIG9mIFBlcnNpc3RlbnRTdHJlYW0uc3RhcnRcbiAgICBzdGFydCgpIHtcbiAgICAgICAgdGhpcy5pdSA9ICExLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHZvaWQgMCwgc3VwZXIuc3RhcnQoKTtcbiAgICB9XG4gICAgSm8oKSB7XG4gICAgICAgIHRoaXMuaXUgJiYgdGhpcy5vdShbXSk7XG4gICAgfVxuICAgIHR1KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbi5SbyhcIldyaXRlXCIsIHQsIGUpO1xuICAgIH1cbiAgICBvbk1lc3NhZ2UodCkge1xuICAgICAgICBpZiAoXG4gICAgICAgIC8vIEFsd2F5cyBjYXB0dXJlIHRoZSBsYXN0IHN0cmVhbSB0b2tlbi5cbiAgICAgICAgRighIXQuc3RyZWFtVG9rZW4pLCB0aGlzLmxhc3RTdHJlYW1Ub2tlbiA9IHQuc3RyZWFtVG9rZW4sIHRoaXMuaXUpIHtcbiAgICAgICAgICAgIC8vIEEgc3VjY2Vzc2Z1bCBmaXJzdCB3cml0ZSByZXNwb25zZSBtZWFucyB0aGUgc3RyZWFtIGlzIGhlYWx0aHksXG4gICAgICAgICAgICAvLyBOb3RlLCB0aGF0IHdlIGNvdWxkIGNvbnNpZGVyIGEgc3VjY2Vzc2Z1bCBoYW5kc2hha2UgaGVhbHRoeSwgaG93ZXZlcixcbiAgICAgICAgICAgIC8vIHRoZSB3cml0ZSBpdHNlbGYgbWlnaHQgYmUgY2F1c2luZyBhbiBlcnJvciB3ZSB3YW50IHRvIGJhY2sgb2ZmIGZyb20uXG4gICAgICAgICAgICB0aGlzLkxvLnJlc2V0KCk7XG4gICAgICAgICAgICBjb25zdCBlID0gV2kodC53cml0ZVJlc3VsdHMsIHQuY29tbWl0VGltZSksIG4gPSBOaSh0LmNvbW1pdFRpbWUpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubGlzdGVuZXIudXUobiwgZSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gVGhlIGZpcnN0IHJlc3BvbnNlIGlzIGFsd2F5cyB0aGUgaGFuZHNoYWtlIHJlc3BvbnNlXG4gICAgICAgIHJldHVybiBGKCF0LndyaXRlUmVzdWx0cyB8fCAwID09PSB0LndyaXRlUmVzdWx0cy5sZW5ndGgpLCB0aGlzLml1ID0gITAsIHRoaXMubGlzdGVuZXIuY3UoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogU2VuZHMgYW4gaW5pdGlhbCBzdHJlYW1Ub2tlbiB0byB0aGUgc2VydmVyLCBwZXJmb3JtaW5nIHRoZSBoYW5kc2hha2VcbiAgICAgKiByZXF1aXJlZCB0byBtYWtlIHRoZSBTdHJlYW1pbmdXcml0ZSBSUEMgd29yay4gU3Vic2VxdWVudFxuICAgICAqIGNhbGxzIHNob3VsZCB3YWl0IHVudGlsIG9uSGFuZHNoYWtlQ29tcGxldGUgd2FzIGNhbGxlZC5cbiAgICAgKi8gICAgYXUoKSB7XG4gICAgICAgIC8vIFRPRE8oZGltb25kKTogU3VwcG9ydCBzdHJlYW0gcmVzdW1wdGlvbi4gV2UgaW50ZW50aW9uYWxseSBkbyBub3Qgc2V0IHRoZVxuICAgICAgICAvLyBzdHJlYW0gdG9rZW4gb24gdGhlIGhhbmRzaGFrZSwgaWdub3JpbmcgYW55IHN0cmVhbSB0b2tlbiB3ZSBtaWdodCBoYXZlLlxuICAgICAgICBjb25zdCB0ID0ge307XG4gICAgICAgIHQuZGF0YWJhc2UgPSBMaSh0aGlzLnNlcmlhbGl6ZXIpLCB0aGlzLnpvKHQpO1xuICAgIH1cbiAgICAvKiogU2VuZHMgYSBncm91cCBvZiBtdXRhdGlvbnMgdG8gdGhlIEZpcmVzdG9yZSBiYWNrZW5kIHRvIGFwcGx5LiAqLyAgICBvdSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB7XG4gICAgICAgICAgICBzdHJlYW1Ub2tlbjogdGhpcy5sYXN0U3RyZWFtVG9rZW4sXG4gICAgICAgICAgICB3cml0ZXM6IHQubWFwKCh0ID0+IGppKHRoaXMuc2VyaWFsaXplciwgdCkpKVxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnpvKGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRGF0YXN0b3JlIGFuZCBpdHMgcmVsYXRlZCBtZXRob2RzIGFyZSBhIHdyYXBwZXIgYXJvdW5kIHRoZSBleHRlcm5hbCBHb29nbGVcbiAqIENsb3VkIERhdGFzdG9yZSBncnBjIEFQSSwgd2hpY2ggcHJvdmlkZXMgYW4gaW50ZXJmYWNlIHRoYXQgaXMgbW9yZSBjb252ZW5pZW50XG4gKiBmb3IgdGhlIHJlc3Qgb2YgdGhlIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlIHRvIGNvbnN1bWUuXG4gKi9cbi8qKlxuICogQW4gaW1wbGVtZW50YXRpb24gb2YgRGF0YXN0b3JlIHRoYXQgZXhwb3NlcyBhZGRpdGlvbmFsIHN0YXRlIGZvciBpbnRlcm5hbFxuICogY29uc3VtcHRpb24uXG4gKi9cbmNsYXNzIEt1IGV4dGVuZHMgY2xhc3Mge30ge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5hdXRoQ3JlZGVudGlhbHMgPSB0LCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMgPSBlLCB0aGlzLmNvbm5lY3Rpb24gPSBuLCBcbiAgICAgICAgdGhpcy5zZXJpYWxpemVyID0gcywgdGhpcy5odSA9ICExO1xuICAgIH1cbiAgICBsdSgpIHtcbiAgICAgICAgaWYgKHRoaXMuaHUpIHRocm93IG5ldyBVKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJUaGUgY2xpZW50IGhhcyBhbHJlYWR5IGJlZW4gdGVybWluYXRlZC5cIik7XG4gICAgfVxuICAgIC8qKiBJbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBhdXRoIGFuZCBBcHBDaGVjayB0b2tlbnMuICovICAgIHBvKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubHUoKSwgUHJvbWlzZS5hbGwoWyB0aGlzLmF1dGhDcmVkZW50aWFscy5nZXRUb2tlbigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSBdKS50aGVuKCgoW3MsIGldKSA9PiB0aGlzLmNvbm5lY3Rpb24ucG8odCwgZSwgbiwgcywgaSkpKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICB0aHJvdyBcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lID8gKHQuY29kZSA9PT0gcS5VTkFVVEhFTlRJQ0FURUQgJiYgKHRoaXMuYXV0aENyZWRlbnRpYWxzLmludmFsaWRhdGVUb2tlbigpLCBcbiAgICAgICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSksIHQpIDogbmV3IFUocS5VTktOT1dOLCB0LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSk7XG4gICAgfVxuICAgIC8qKiBJbnZva2VzIHRoZSBwcm92aWRlZCBSUEMgd2l0aCBzdHJlYW1lZCByZXN1bHRzIHdpdGggYXV0aCBhbmQgQXBwQ2hlY2sgdG9rZW5zLiAqLyAgICBBbyh0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmx1KCksIFByb21pc2UuYWxsKFsgdGhpcy5hdXRoQ3JlZGVudGlhbHMuZ2V0VG9rZW4oKSwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzLmdldFRva2VuKCkgXSkudGhlbigoKFtpLCByXSkgPT4gdGhpcy5jb25uZWN0aW9uLkFvKHQsIGUsIG4sIGksIHIsIHMpKSkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhyb3cgXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/ICh0LmNvZGUgPT09IHEuVU5BVVRIRU5USUNBVEVEICYmICh0aGlzLmF1dGhDcmVkZW50aWFscy5pbnZhbGlkYXRlVG9rZW4oKSwgXG4gICAgICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuaW52YWxpZGF0ZVRva2VuKCkpLCB0KSA6IG5ldyBVKHEuVU5LTk9XTiwgdC50b1N0cmluZygpKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICB0ZXJtaW5hdGUoKSB7XG4gICAgICAgIHRoaXMuaHUgPSAhMDtcbiAgICB9XG59XG5cbi8vIFRPRE8oZmlyZXN0b3JleHApOiBNYWtlIHN1cmUgdGhlcmUgaXMgb25seSBvbmUgRGF0YXN0b3JlIGluc3RhbmNlIHBlclxuLy8gZmlyZXN0b3JlLWV4cCBjbGllbnQuXG5hc3luYyBmdW5jdGlvbiBHdSh0LCBlLCBuKSB7XG4gICAgdmFyIHM7XG4gICAgY29uc3QgaSA9IEwodCksIHtyZXF1ZXN0OiByLCBmdTogb30gPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBKaSh0LCBlKSwgaSA9IHt9LCByID0gW107XG4gICAgICAgIGxldCBvID0gMDtcbiAgICAgICAgcmV0dXJuIG4uZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAvLyBNYXAgYWxsIGNsaWVudC1zaWRlIGFsaWFzZXMgdG8gYSB1bmlxdWUgc2hvcnQtZm9ybVxuICAgICAgICAgICAgLy8gYWxpYXMuIFRoaXMgYXZvaWRzIGlzc3VlcyB3aXRoIGNsaWVudC1zaWRlIGFsaWFzZXMgdGhhdFxuICAgICAgICAgICAgLy8gZXhjZWVkIHRoZSAxNTAwLWJ5dGUgc3RyaW5nIHNpemUgbGltaXQuXG4gICAgICAgICAgICBjb25zdCBlID0gXCJhZ2dyZWdhdGVfXCIgKyBvKys7XG4gICAgICAgICAgICBpW2VdID0gdC5hbGlhcywgXCJjb3VudFwiID09PSB0Lmd0ID8gci5wdXNoKHtcbiAgICAgICAgICAgICAgICBhbGlhczogZSxcbiAgICAgICAgICAgICAgICBjb3VudDoge31cbiAgICAgICAgICAgIH0pIDogXCJhdmdcIiA9PT0gdC5ndCA/IHIucHVzaCh7XG4gICAgICAgICAgICAgICAgYWxpYXM6IGUsXG4gICAgICAgICAgICAgICAgYXZnOiB7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkOiBzcih0LmZpZWxkUGF0aClcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KSA6IFwic3VtXCIgPT09IHQuZ3QgJiYgci5wdXNoKHtcbiAgICAgICAgICAgICAgICBhbGlhczogZSxcbiAgICAgICAgICAgICAgICBzdW06IHtcbiAgICAgICAgICAgICAgICAgICAgZmllbGQ6IHNyKHQuZmllbGRQYXRoKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIHtcbiAgICAgICAgICAgIHJlcXVlc3Q6IHtcbiAgICAgICAgICAgICAgICBzdHJ1Y3R1cmVkQWdncmVnYXRpb25RdWVyeToge1xuICAgICAgICAgICAgICAgICAgICBhZ2dyZWdhdGlvbnM6IHIsXG4gICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZWRRdWVyeTogcy5zdHJ1Y3R1cmVkUXVlcnlcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBhcmVudDogcy5wYXJlbnRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmdTogaVxuICAgICAgICB9O1xuICAgIH0oaS5zZXJpYWxpemVyLCBKbihlKSwgbiksIHUgPSByLnBhcmVudDtcbiAgICBpLmNvbm5lY3Rpb24ueW8gfHwgZGVsZXRlIHIucGFyZW50O1xuICAgIGNvbnN0IGMgPSAoYXdhaXQgaS5BbyhcIlJ1bkFnZ3JlZ2F0aW9uUXVlcnlcIiwgdSwgciwgLypleHBlY3RlZFJlc3BvbnNlQ291bnQ9Ki8gMSkpLmZpbHRlcigodCA9PiAhIXQucmVzdWx0KSk7XG4gICAgLy8gT21pdCBSdW5BZ2dyZWdhdGlvblF1ZXJ5UmVzcG9uc2UgdGhhdCBvbmx5IGNvbnRhaW4gcmVhZFRpbWVzLlxuICAgICAgICBGKDEgPT09IGMubGVuZ3RoKTtcbiAgICAvLyBSZW1hcCB0aGUgc2hvcnQtZm9ybSBhbGlhc2VzIHRoYXQgd2VyZSBzZW50IHRvIHRoZSBzZXJ2ZXJcbiAgICAvLyB0byB0aGUgY2xpZW50LXNpZGUgYWxpYXNlcy4gVXNlcnMgd2lsbCBhY2Nlc3MgdGhlIHJlc3VsdHNcbiAgICAvLyB1c2luZyB0aGUgY2xpZW50LXNpZGUgYWxpYXMuXG4gICAgY29uc3QgYSA9IG51bGwgPT09IChzID0gY1swXS5yZXN1bHQpIHx8IHZvaWQgMCA9PT0gcyA/IHZvaWQgMCA6IHMuYWdncmVnYXRlRmllbGRzO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhhKS5yZWR1Y2UoKCh0LCBlKSA9PiAodFtvW2VdXSA9IGFbZV0sIHQpKSwge30pO1xufVxuXG4vKipcbiAqIEEgY29tcG9uZW50IHVzZWQgYnkgdGhlIFJlbW90ZVN0b3JlIHRvIHRyYWNrIHRoZSBPbmxpbmVTdGF0ZSAodGhhdCBpcyxcbiAqIHdoZXRoZXIgb3Igbm90IHRoZSBjbGllbnQgYXMgYSB3aG9sZSBzaG91bGQgYmUgY29uc2lkZXJlZCB0byBiZSBvbmxpbmUgb3JcbiAqIG9mZmxpbmUpLCBpbXBsZW1lbnRpbmcgdGhlIGFwcHJvcHJpYXRlIGhldXJpc3RpY3MuXG4gKlxuICogSW4gcGFydGljdWxhciwgd2hlbiB0aGUgY2xpZW50IGlzIHRyeWluZyB0byBjb25uZWN0IHRvIHRoZSBiYWNrZW5kLCB3ZVxuICogYWxsb3cgdXAgdG8gTUFYX1dBVENIX1NUUkVBTV9GQUlMVVJFUyB3aXRoaW4gT05MSU5FX1NUQVRFX1RJTUVPVVRfTVMgZm9yXG4gKiBhIGNvbm5lY3Rpb24gdG8gc3VjY2VlZC4gSWYgd2UgaGF2ZSB0b28gbWFueSBmYWlsdXJlcyBvciB0aGUgdGltZW91dCBlbGFwc2VzLFxuICogdGhlbiB3ZSBzZXQgdGhlIE9ubGluZVN0YXRlIHRvIE9mZmxpbmUsIGFuZCB0aGUgY2xpZW50IHdpbGwgYmVoYXZlIGFzIGlmXG4gKiBpdCBpcyBvZmZsaW5lIChnZXQoKXMgd2lsbCByZXR1cm4gY2FjaGVkIGRhdGEsIGV0Yy4pLlxuICovXG5jbGFzcyBRdSB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLm9ubGluZVN0YXRlSGFuZGxlciA9IGUsIFxuICAgICAgICAvKiogVGhlIGN1cnJlbnQgT25saW5lU3RhdGUuICovXG4gICAgICAgIHRoaXMuc3RhdGUgPSBcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovICwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGNvdW50IG9mIGNvbnNlY3V0aXZlIGZhaWx1cmVzIHRvIG9wZW4gdGhlIHN0cmVhbS4gSWYgaXQgcmVhY2hlcyB0aGVcbiAgICAgICAgICogbWF4aW11bSBkZWZpbmVkIGJ5IE1BWF9XQVRDSF9TVFJFQU1fRkFJTFVSRVMsIHdlJ2xsIHNldCB0aGUgT25saW5lU3RhdGUgdG9cbiAgICAgICAgICogT2ZmbGluZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZHUgPSAwLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgdGltZXIgdGhhdCBlbGFwc2VzIGFmdGVyIE9OTElORV9TVEFURV9USU1FT1VUX01TLCBhdCB3aGljaCBwb2ludCB3ZVxuICAgICAgICAgKiB0cmFuc2l0aW9uIGZyb20gT25saW5lU3RhdGUuVW5rbm93biB0byBPbmxpbmVTdGF0ZS5PZmZsaW5lIHdpdGhvdXQgd2FpdGluZ1xuICAgICAgICAgKiBmb3IgdGhlIHN0cmVhbSB0byBhY3R1YWxseSBmYWlsIChNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTIHRpbWVzKS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuX3UgPSBudWxsLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFdoZXRoZXIgdGhlIGNsaWVudCBzaG91bGQgbG9nIGEgd2FybmluZyBtZXNzYWdlIGlmIGl0IGZhaWxzIHRvIGNvbm5lY3QgdG9cbiAgICAgICAgICogdGhlIGJhY2tlbmQgKGluaXRpYWxseSB0cnVlLCBjbGVhcmVkIGFmdGVyIGEgc3VjY2Vzc2Z1bCBzdHJlYW0sIG9yIGlmIHdlJ3ZlXG4gICAgICAgICAqIGxvZ2dlZCB0aGUgbWVzc2FnZSBhbHJlYWR5KS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud3UgPSAhMDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGJ5IFJlbW90ZVN0b3JlIHdoZW4gYSB3YXRjaCBzdHJlYW0gaXMgc3RhcnRlZCAoaW5jbHVkaW5nIG9uIGVhY2hcbiAgICAgKiBiYWNrb2ZmIGF0dGVtcHQpLlxuICAgICAqXG4gICAgICogSWYgdGhpcyBpcyB0aGUgZmlyc3QgYXR0ZW1wdCwgaXQgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gVW5rbm93biBhbmQgc3RhcnRzXG4gICAgICogdGhlIG9ubGluZVN0YXRlVGltZXIuXG4gICAgICovICAgIG11KCkge1xuICAgICAgICAwID09PSB0aGlzLmR1ICYmICh0aGlzLmd1KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pLCB0aGlzLl91ID0gdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBZnRlckRlbGF5KFwib25saW5lX3N0YXRlX3RpbWVvdXRcIiAvKiBUaW1lcklkLk9ubGluZVN0YXRlVGltZW91dCAqLyAsIDFlNCwgKCgpID0+ICh0aGlzLl91ID0gbnVsbCwgXG4gICAgICAgIHRoaXMueXUoXCJCYWNrZW5kIGRpZG4ndCByZXNwb25kIHdpdGhpbiAxMCBzZWNvbmRzLlwiKSwgdGhpcy5ndShcIk9mZmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PZmZsaW5lICovKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyBvdXIgT25saW5lU3RhdGUgYXMgYXBwcm9wcmlhdGUgYWZ0ZXIgdGhlIHdhdGNoIHN0cmVhbSByZXBvcnRzIGFcbiAgICAgKiBmYWlsdXJlLiBUaGUgZmlyc3QgZmFpbHVyZSBtb3ZlcyB1cyB0byB0aGUgJ1Vua25vd24nIHN0YXRlLiBXZSB0aGVuIG1heVxuICAgICAqIGFsbG93IG11bHRpcGxlIGZhaWx1cmVzIChiYXNlZCBvbiBNQVhfV0FUQ0hfU1RSRUFNX0ZBSUxVUkVTKSBiZWZvcmUgd2VcbiAgICAgKiBhY3R1YWxseSB0cmFuc2l0aW9uIHRvIHRoZSAnT2ZmbGluZScgc3RhdGUuXG4gICAgICovICAgIHB1KHQpIHtcbiAgICAgICAgXCJPbmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PbmxpbmUgKi8gPT09IHRoaXMuc3RhdGUgPyB0aGlzLmd1KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pIDogKHRoaXMuZHUrKywgXG4gICAgICAgIHRoaXMuZHUgPj0gMSAmJiAodGhpcy5JdSgpLCB0aGlzLnl1KGBDb25uZWN0aW9uIGZhaWxlZCAxIHRpbWVzLiBNb3N0IHJlY2VudCBlcnJvcjogJHt0LnRvU3RyaW5nKCl9YCksIFxuICAgICAgICB0aGlzLmd1KFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8pKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEV4cGxpY2l0bHkgc2V0cyB0aGUgT25saW5lU3RhdGUgdG8gdGhlIHNwZWNpZmllZCBzdGF0ZS5cbiAgICAgKlxuICAgICAqIE5vdGUgdGhhdCB0aGlzIHJlc2V0cyBvdXIgdGltZXJzIC8gZmFpbHVyZSBjb3VudGVycywgZXRjLiB1c2VkIGJ5IG91clxuICAgICAqIE9mZmxpbmUgaGV1cmlzdGljcywgc28gbXVzdCBub3QgYmUgdXNlZCBpbiBwbGFjZSBvZlxuICAgICAqIGhhbmRsZVdhdGNoU3RyZWFtU3RhcnQoKSBhbmQgaGFuZGxlV2F0Y2hTdHJlYW1GYWlsdXJlKCkuXG4gICAgICovICAgIHNldCh0KSB7XG4gICAgICAgIHRoaXMuSXUoKSwgdGhpcy5kdSA9IDAsIFwiT25saW5lXCIgLyogT25saW5lU3RhdGUuT25saW5lICovID09PSB0ICYmIChcbiAgICAgICAgLy8gV2UndmUgY29ubmVjdGVkIHRvIHdhdGNoIGF0IGxlYXN0IG9uY2UuIERvbid0IHdhcm4gdGhlIGRldmVsb3BlclxuICAgICAgICAvLyBhYm91dCBiZWluZyBvZmZsaW5lIGdvaW5nIGZvcndhcmQuXG4gICAgICAgIHRoaXMud3UgPSAhMSksIHRoaXMuZ3UodCk7XG4gICAgfVxuICAgIGd1KHQpIHtcbiAgICAgICAgdCAhPT0gdGhpcy5zdGF0ZSAmJiAodGhpcy5zdGF0ZSA9IHQsIHRoaXMub25saW5lU3RhdGVIYW5kbGVyKHQpKTtcbiAgICB9XG4gICAgeXUodCkge1xuICAgICAgICBjb25zdCBlID0gYENvdWxkIG5vdCByZWFjaCBDbG91ZCBGaXJlc3RvcmUgYmFja2VuZC4gJHt0fVxcblRoaXMgdHlwaWNhbGx5IGluZGljYXRlcyB0aGF0IHlvdXIgZGV2aWNlIGRvZXMgbm90IGhhdmUgYSBoZWFsdGh5IEludGVybmV0IGNvbm5lY3Rpb24gYXQgdGhlIG1vbWVudC4gVGhlIGNsaWVudCB3aWxsIG9wZXJhdGUgaW4gb2ZmbGluZSBtb2RlIHVudGlsIGl0IGlzIGFibGUgdG8gc3VjY2Vzc2Z1bGx5IGNvbm5lY3QgdG8gdGhlIGJhY2tlbmQuYDtcbiAgICAgICAgdGhpcy53dSA/IChrKGUpLCB0aGlzLnd1ID0gITEpIDogTihcIk9ubGluZVN0YXRlVHJhY2tlclwiLCBlKTtcbiAgICB9XG4gICAgSXUoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMuX3UgJiYgKHRoaXMuX3UuY2FuY2VsKCksIHRoaXMuX3UgPSBudWxsKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNsYXNzIGp1IHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgbG9jYWwgc3RvcmUsIHVzZWQgdG8gZmlsbCB0aGUgd3JpdGUgcGlwZWxpbmUgd2l0aCBvdXRib3VuZCBtdXRhdGlvbnMuXG4gICAgICovXG4gICAgdCwgXG4gICAgLyoqIFRoZSBjbGllbnQtc2lkZSBwcm94eSBmb3IgaW50ZXJhY3Rpbmcgd2l0aCB0aGUgYmFja2VuZC4gKi9cbiAgICBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IHQsIHRoaXMuZGF0YXN0b3JlID0gZSwgdGhpcy5hc3luY1F1ZXVlID0gbiwgdGhpcy5yZW1vdGVTeW5jZXIgPSB7fSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIGxpc3Qgb2YgdXAgdG8gTUFYX1BFTkRJTkdfV1JJVEVTIHdyaXRlcyB0aGF0IHdlIGhhdmUgZmV0Y2hlZCBmcm9tIHRoZVxuICAgICAgICAgKiBMb2NhbFN0b3JlIHZpYSBmaWxsV3JpdGVQaXBlbGluZSgpIGFuZCBoYXZlIG9yIHdpbGwgc2VuZCB0byB0aGUgd3JpdGVcbiAgICAgICAgICogc3RyZWFtLlxuICAgICAgICAgKlxuICAgICAgICAgKiBXaGVuZXZlciB3cml0ZVBpcGVsaW5lLmxlbmd0aCA+IDAgdGhlIFJlbW90ZVN0b3JlIHdpbGwgYXR0ZW1wdCB0byBzdGFydCBvclxuICAgICAgICAgKiByZXN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0uIFdoZW4gdGhlIHN0cmVhbSBpcyBlc3RhYmxpc2hlZCB0aGUgd3JpdGVzIGluIHRoZVxuICAgICAgICAgKiBwaXBlbGluZSB3aWxsIGJlIHNlbnQgaW4gb3JkZXIuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlcyByZW1haW4gaW4gd3JpdGVQaXBlbGluZSB1bnRpbCB0aGV5IGFyZSBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmRcbiAgICAgICAgICogYW5kIHRodXMgd2lsbCBhdXRvbWF0aWNhbGx5IGJlIHJlLXNlbnQgaWYgdGhlIHN0cmVhbSBpcyBpbnRlcnJ1cHRlZCAvXG4gICAgICAgICAqIHJlc3RhcnRlZCBiZWZvcmUgdGhleSdyZSBhY2tub3dsZWRnZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFdyaXRlIHJlc3BvbnNlcyBmcm9tIHRoZSBiYWNrZW5kIGFyZSBsaW5rZWQgdG8gdGhlaXIgb3JpZ2luYXRpbmcgcmVxdWVzdFxuICAgICAgICAgKiBwdXJlbHkgYmFzZWQgb24gb3JkZXIsIGFuZCBzbyB3ZSBjYW4ganVzdCBzaGlmdCgpIHdyaXRlcyBmcm9tIHRoZSBmcm9udCBvZlxuICAgICAgICAgKiB0aGUgd3JpdGVQaXBlbGluZSBhcyB3ZSByZWNlaXZlIHJlc3BvbnNlcy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuVHUgPSBbXSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIG1hcHBpbmcgb2Ygd2F0Y2hlZCB0YXJnZXRzIHRoYXQgdGhlIGNsaWVudCBjYXJlcyBhYm91dCB0cmFja2luZyBhbmQgdGhlXG4gICAgICAgICAqIHVzZXIgaGFzIGV4cGxpY2l0bHkgY2FsbGVkIGEgJ2xpc3RlbicgZm9yIHRoaXMgdGFyZ2V0LlxuICAgICAgICAgKlxuICAgICAgICAgKiBUaGVzZSB0YXJnZXRzIG1heSBvciBtYXkgbm90IGhhdmUgYmVlbiBzZW50IHRvIG9yIGFja25vd2xlZGdlZCBieSB0aGVcbiAgICAgICAgICogc2VydmVyLiBPbiByZS1lc3RhYmxpc2hpbmcgdGhlIGxpc3RlbiBzdHJlYW0sIHRoZXNlIHRhcmdldHMgc2hvdWxkIGJlIHNlbnRcbiAgICAgICAgICogdG8gdGhlIHNlcnZlci4gVGhlIHRhcmdldHMgcmVtb3ZlZCB3aXRoIHVubGlzdGVucyBhcmUgcmVtb3ZlZCBlYWdlcmx5XG4gICAgICAgICAqIHdpdGhvdXQgd2FpdGluZyBmb3IgY29uZmlybWF0aW9uIGZyb20gdGhlIGxpc3RlbiBzdHJlYW0uXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLkV1ID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBIHNldCBvZiByZWFzb25zIGZvciB3aHkgdGhlIFJlbW90ZVN0b3JlIG1heSBiZSBvZmZsaW5lLiBJZiBlbXB0eSwgdGhlXG4gICAgICAgICAqIFJlbW90ZVN0b3JlIG1heSBzdGFydCBpdHMgbmV0d29yayBjb25uZWN0aW9ucy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuQXUgPSBuZXcgU2V0LCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEV2ZW50IGhhbmRsZXJzIHRoYXQgZ2V0IGNhbGxlZCB3aGVuIHRoZSBuZXR3b3JrIGlzIGRpc2FibGVkIG9yIGVuYWJsZWQuXG4gICAgICAgICAqXG4gICAgICAgICAqIFBPUlRJTkcgTk9URTogVGhlc2UgZnVuY3Rpb25zIGFyZSB1c2VkIG9uIHRoZSBXZWIgY2xpZW50IHRvIGNyZWF0ZSB0aGVcbiAgICAgICAgICogdW5kZXJseWluZyBzdHJlYW1zICh0byBzdXBwb3J0IHRyZWUtc2hha2VhYmxlIHN0cmVhbXMpLiBPbiBBbmRyb2lkIGFuZCBpT1MsXG4gICAgICAgICAqIHRoZSBzdHJlYW1zIGFyZSBjcmVhdGVkIGR1cmluZyBjb25zdHJ1Y3Rpb24gb2YgUmVtb3RlU3RvcmUuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLlJ1ID0gW10sIHRoaXMudnUgPSBpLCB0aGlzLnZ1LkpyKCh0ID0+IHtcbiAgICAgICAgICAgIG4uZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIC8vIFBvcnRpbmcgTm90ZTogVW5saWtlIGlPUywgYHJlc3RhcnROZXR3b3JrKClgIGlzIGNhbGxlZCBldmVuIHdoZW4gdGhlXG4gICAgICAgICAgICAgICAgLy8gbmV0d29yayBiZWNvbWVzIHVucmVhY2hhYmxlIGFzIHdlIGRvbid0IGhhdmUgYW55IG90aGVyIHdheSB0byB0ZWFyXG4gICAgICAgICAgICAgICAgLy8gZG93biBvdXIgc3RyZWFtcy5cbiAgICAgICAgICAgICAgICBlYyh0aGlzKSAmJiAoTihcIlJlbW90ZVN0b3JlXCIsIFwiUmVzdGFydGluZyBzdHJlYW1zIGZvciBuZXR3b3JrIHJlYWNoYWJpbGl0eSBjaGFuZ2UuXCIpLCBcbiAgICAgICAgICAgICAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBMKHQpO1xuICAgICAgICAgICAgICAgICAgICBlLkF1LmFkZCg0IC8qIE9mZmxpbmVDYXVzZS5Db25uZWN0aXZpdHlDaGFuZ2UgKi8pLCBhd2FpdCBXdShlKSwgZS5QdS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLyksIFxuICAgICAgICAgICAgICAgICAgICBlLkF1LmRlbGV0ZSg0IC8qIE9mZmxpbmVDYXVzZS5Db25uZWN0aXZpdHlDaGFuZ2UgKi8pLCBhd2FpdCB6dShlKTtcbiAgICAgICAgICAgICAgICB9KHRoaXMpKTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpLCB0aGlzLlB1ID0gbmV3IFF1KG4sIHMpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24genUodCkge1xuICAgIGlmIChlYyh0KSkgZm9yIChjb25zdCBlIG9mIHQuUnUpIGF3YWl0IGUoLyogZW5hYmxlZD0gKi8gITApO1xufVxuXG4vKipcbiAqIFRlbXBvcmFyaWx5IGRpc2FibGVzIHRoZSBuZXR3b3JrLiBUaGUgbmV0d29yayBjYW4gYmUgcmUtZW5hYmxlZCB1c2luZ1xuICogZW5hYmxlTmV0d29yaygpLlxuICovIGFzeW5jIGZ1bmN0aW9uIFd1KHQpIHtcbiAgICBmb3IgKGNvbnN0IGUgb2YgdC5SdSkgYXdhaXQgZSgvKiBlbmFibGVkPSAqLyAhMSk7XG59XG5cbi8qKlxuICogU3RhcnRzIG5ldyBsaXN0ZW4gZm9yIHRoZSBnaXZlbiB0YXJnZXQuIFVzZXMgcmVzdW1lIHRva2VuIGlmIHByb3ZpZGVkLiBJdFxuICogaXMgYSBuby1vcCBpZiB0aGUgdGFyZ2V0IG9mIGdpdmVuIGBUYXJnZXREYXRhYCBpcyBhbHJlYWR5IGJlaW5nIGxpc3RlbmVkIHRvLlxuICovXG5mdW5jdGlvbiBIdSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCk7XG4gICAgbi5FdS5oYXMoZS50YXJnZXRJZCkgfHwgKFxuICAgIC8vIE1hcmsgdGhpcyBhcyBzb21ldGhpbmcgdGhlIGNsaWVudCBpcyBjdXJyZW50bHkgbGlzdGVuaW5nIGZvci5cbiAgICBuLkV1LnNldChlLnRhcmdldElkLCBlKSwgdGMobikgPyBcbiAgICAvLyBUaGUgbGlzdGVuIHdpbGwgYmUgc2VudCBpbiBvbldhdGNoU3RyZWFtT3BlblxuICAgIFp1KG4pIDogcGMobikuVW8oKSAmJiBZdShuLCBlKSk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyB0aGUgbGlzdGVuIGZyb20gc2VydmVyLiBJdCBpcyBhIG5vLW9wIGlmIHRoZSBnaXZlbiB0YXJnZXQgaWQgaXNcbiAqIG5vdCBiZWluZyBsaXN0ZW5lZCB0by5cbiAqLyBmdW5jdGlvbiBKdSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCksIHMgPSBwYyhuKTtcbiAgICBuLkV1LmRlbGV0ZShlKSwgcy5VbygpICYmIFh1KG4sIGUpLCAwID09PSBuLkV1LnNpemUgJiYgKHMuVW8oKSA/IHMuUW8oKSA6IGVjKG4pICYmIFxuICAgIC8vIFJldmVydCB0byBPbmxpbmVTdGF0ZS5Vbmtub3duIGlmIHRoZSB3YXRjaCBzdHJlYW0gaXMgbm90IG9wZW4gYW5kIHdlXG4gICAgLy8gaGF2ZSBubyBsaXN0ZW5lcnMsIHNpbmNlIHdpdGhvdXQgYW55IGxpc3RlbnMgdG8gc2VuZCB3ZSBjYW5ub3RcbiAgICAvLyBjb25maXJtIGlmIHRoZSBzdHJlYW0gaXMgaGVhbHRoeSBhbmQgdXBncmFkZSB0byBPbmxpbmVTdGF0ZS5PbmxpbmUuXG4gICAgbi5QdS5zZXQoXCJVbmtub3duXCIgLyogT25saW5lU3RhdGUuVW5rbm93biAqLykpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSB0aGUgZXhwZWN0ZWQgbnVtYmVyIG9mIHBlbmRpbmcgcmVzcG9uc2VzIHdlJ3JlIGR1ZVxuICogZnJvbSB3YXRjaCBzbyB3ZSB3YWl0IGZvciB0aGUgYWNrIHRvIHByb2Nlc3MgYW55IG1lc3NhZ2VzIGZyb20gdGhpcyB0YXJnZXQuXG4gKi8gZnVuY3Rpb24gWXUodCwgZSkge1xuICAgIGlmICh0LmJ1Lkx0KGUudGFyZ2V0SWQpLCBlLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDAgfHwgZS5zbmFwc2hvdFZlcnNpb24uY29tcGFyZVRvKHJ0Lm1pbigpKSA+IDApIHtcbiAgICAgICAgY29uc3QgbiA9IHQucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQoZS50YXJnZXRJZCkuc2l6ZTtcbiAgICAgICAgZSA9IGUud2l0aEV4cGVjdGVkQ291bnQobik7XG4gICAgfVxuICAgIHBjKHQpLm51KGUpO1xufVxuXG4vKipcbiAqIFdlIG5lZWQgdG8gaW5jcmVtZW50IHRoZSBleHBlY3RlZCBudW1iZXIgb2YgcGVuZGluZyByZXNwb25zZXMgd2UncmUgZHVlXG4gKiBmcm9tIHdhdGNoIHNvIHdlIHdhaXQgZm9yIHRoZSByZW1vdmFsIG9uIHRoZSBzZXJ2ZXIgYmVmb3JlIHdlIHByb2Nlc3MgYW55XG4gKiBtZXNzYWdlcyBmcm9tIHRoaXMgdGFyZ2V0LlxuICovIGZ1bmN0aW9uIFh1KHQsIGUpIHtcbiAgICB0LmJ1Lkx0KGUpLCBwYyh0KS5zdShlKTtcbn1cblxuZnVuY3Rpb24gWnUodCkge1xuICAgIHQuYnUgPSBuZXcgRWkoe1xuICAgICAgICBnZXRSZW1vdGVLZXlzRm9yVGFyZ2V0OiBlID0+IHQucmVtb3RlU3luY2VyLmdldFJlbW90ZUtleXNGb3JUYXJnZXQoZSksXG4gICAgICAgIGhlOiBlID0+IHQuRXUuZ2V0KGUpIHx8IG51bGwsXG4gICAgICAgIG9lOiAoKSA9PiB0LmRhdGFzdG9yZS5zZXJpYWxpemVyLmRhdGFiYXNlSWRcbiAgICB9KSwgcGModCkuc3RhcnQoKSwgdC5QdS5tdSgpO1xufVxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciB0aGUgd2F0Y2ggc3RyZWFtIHNob3VsZCBiZSBzdGFydGVkIGJlY2F1c2UgaXQncyBuZWNlc3NhcnlcbiAqIGFuZCBoYXMgbm90IHlldCBiZWVuIHN0YXJ0ZWQuXG4gKi8gZnVuY3Rpb24gdGModCkge1xuICAgIHJldHVybiBlYyh0KSAmJiAhcGModCkucW8oKSAmJiB0LkV1LnNpemUgPiAwO1xufVxuXG5mdW5jdGlvbiBlYyh0KSB7XG4gICAgcmV0dXJuIDAgPT09IEwodCkuQXUuc2l6ZTtcbn1cblxuZnVuY3Rpb24gbmModCkge1xuICAgIHQuYnUgPSB2b2lkIDA7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHNjKHQpIHtcbiAgICB0LkV1LmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgIFl1KHQsIGUpO1xuICAgIH0pKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gaWModCwgZSkge1xuICAgIG5jKHQpLCBcbiAgICAvLyBJZiB3ZSBzdGlsbCBuZWVkIHRoZSB3YXRjaCBzdHJlYW0sIHJldHJ5IHRoZSBjb25uZWN0aW9uLlxuICAgIHRjKHQpID8gKHQuUHUucHUoZSksIFp1KHQpKSA6IFxuICAgIC8vIE5vIG5lZWQgdG8gcmVzdGFydCB3YXRjaCBzdHJlYW0gYmVjYXVzZSB0aGVyZSBhcmUgbm8gYWN0aXZlIHRhcmdldHMuXG4gICAgLy8gVGhlIG9ubGluZSBzdGF0ZSBpcyBzZXQgdG8gdW5rbm93biBiZWNhdXNlIHRoZXJlIGlzIG5vIGFjdGl2ZSBhdHRlbXB0XG4gICAgLy8gYXQgZXN0YWJsaXNoaW5nIGEgY29ubmVjdGlvblxuICAgIHQuUHUuc2V0KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pO1xufVxuXG5hc3luYyBmdW5jdGlvbiByYyh0LCBlLCBuKSB7XG4gICAgaWYgKFxuICAgIC8vIE1hcmsgdGhlIGNsaWVudCBhcyBvbmxpbmUgc2luY2Ugd2UgZ290IGEgbWVzc2FnZSBmcm9tIHRoZSBzZXJ2ZXJcbiAgICB0LlB1LnNldChcIk9ubGluZVwiIC8qIE9ubGluZVN0YXRlLk9ubGluZSAqLyksIGUgaW5zdGFuY2VvZiBJaSAmJiAyIC8qIFdhdGNoVGFyZ2V0Q2hhbmdlU3RhdGUuUmVtb3ZlZCAqLyA9PT0gZS5zdGF0ZSAmJiBlLmNhdXNlKSBcbiAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gYSB0YXJnZXQsIGRvbid0IHdhaXQgZm9yIGEgY29uc2lzdGVudCBzbmFwc2hvdFxuICAgIC8vIHRvIHJhaXNlIGV2ZW50c1xuICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IFxuICAgICAgICAvKiogSGFuZGxlcyBhbiBlcnJvciBvbiBhIHRhcmdldCAqL1xuICAgICAgICBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gZS5jYXVzZTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgcyBvZiBlLnRhcmdldElkcykgXG4gICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICB0LkV1LmhhcyhzKSAmJiAoYXdhaXQgdC5yZW1vdGVTeW5jZXIucmVqZWN0TGlzdGVuKHMsIG4pLCB0LkV1LmRlbGV0ZShzKSwgdC5idS5yZW1vdmVUYXJnZXQocykpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQXR0ZW1wdHMgdG8gZmlsbCBvdXIgd3JpdGUgcGlwZWxpbmUgd2l0aCB3cml0ZXMgZnJvbSB0aGUgTG9jYWxTdG9yZS5cbiAqXG4gKiBDYWxsZWQgaW50ZXJuYWxseSB0byBib290c3RyYXAgb3IgcmVmaWxsIHRoZSB3cml0ZSBwaXBlbGluZSBhbmQgYnlcbiAqIFN5bmNFbmdpbmUgd2hlbmV2ZXIgdGhlcmUgYXJlIG5ldyBtdXRhdGlvbnMgdG8gcHJvY2Vzcy5cbiAqXG4gKiBTdGFydHMgdGhlIHdyaXRlIHN0cmVhbSBpZiBuZWNlc3NhcnkuXG4gKi8gKHQsIGUpO1xuICAgIH0gY2F0Y2ggKG4pIHtcbiAgICAgICAgTihcIlJlbW90ZVN0b3JlXCIsIFwiRmFpbGVkIHRvIHJlbW92ZSB0YXJnZXRzICVzOiAlcyBcIiwgZS50YXJnZXRJZHMuam9pbihcIixcIiksIG4pLCBcbiAgICAgICAgYXdhaXQgb2ModCwgbik7XG4gICAgfSBlbHNlIGlmIChlIGluc3RhbmNlb2YgeWkgPyB0LmJ1Lld0KGUpIDogZSBpbnN0YW5jZW9mIHBpID8gdC5idS5lZShlKSA6IHQuYnUuWXQoZSksIFxuICAgICFuLmlzRXF1YWwocnQubWluKCkpKSB0cnkge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgb3UodC5sb2NhbFN0b3JlKTtcbiAgICAgICAgbi5jb21wYXJlVG8oZSkgPj0gMCAmJiBcbiAgICAgICAgLy8gV2UgaGF2ZSByZWNlaXZlZCBhIHRhcmdldCBjaGFuZ2Ugd2l0aCBhIGdsb2JhbCBzbmFwc2hvdCBpZiB0aGUgc25hcHNob3RcbiAgICAgICAgLy8gdmVyc2lvbiBpcyBub3QgZXF1YWwgdG8gU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICAgICAgICBhd2FpdCBcbiAgICAgICAgLyoqXG4gKiBUYWtlcyBhIGJhdGNoIG9mIGNoYW5nZXMgZnJvbSB0aGUgRGF0YXN0b3JlLCByZXBhY2thZ2VzIHRoZW0gYXMgYVxuICogUmVtb3RlRXZlbnQsIGFuZCBwYXNzZXMgdGhhdCBvbiB0byB0aGUgbGlzdGVuZXIsIHdoaWNoIGlzIHR5cGljYWxseSB0aGVcbiAqIFN5bmNFbmdpbmUuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IHQuYnUudWUoZSk7XG4gICAgICAgICAgICAvLyBVcGRhdGUgaW4tbWVtb3J5IHJlc3VtZSB0b2tlbnMuIExvY2FsU3RvcmUgd2lsbCB1cGRhdGUgdGhlXG4gICAgICAgICAgICAvLyBwZXJzaXN0ZW50IHZpZXcgb2YgdGhlc2Ugd2hlbiBhcHBseWluZyB0aGUgY29tcGxldGVkIFJlbW90ZUV2ZW50LlxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4udGFyZ2V0Q2hhbmdlcy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChuLnJlc3VtZVRva2VuLmFwcHJveGltYXRlQnl0ZVNpemUoKSA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaSA9IHQuRXUuZ2V0KHMpO1xuICAgICAgICAgICAgICAgICAgICAvLyBBIHdhdGNoZWQgdGFyZ2V0IG1pZ2h0IGhhdmUgYmVlbiByZW1vdmVkIGFscmVhZHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaSAmJiB0LkV1LnNldChzLCBpLndpdGhSZXN1bWVUb2tlbihuLnJlc3VtZVRva2VuLCBlKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkpLCBcbiAgICAgICAgICAgIC8vIFJlLWVzdGFibGlzaCBsaXN0ZW5zIGZvciB0aGUgdGFyZ2V0cyB0aGF0IGhhdmUgYmVlbiBpbnZhbGlkYXRlZCBieVxuICAgICAgICAgICAgLy8gZXhpc3RlbmNlIGZpbHRlciBtaXNtYXRjaGVzLlxuICAgICAgICAgICAgbi50YXJnZXRNaXNtYXRjaGVzLmZvckVhY2goKChlLCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHQuRXUuZ2V0KGUpO1xuICAgICAgICAgICAgICAgIGlmICghcykgXG4gICAgICAgICAgICAgICAgLy8gQSB3YXRjaGVkIHRhcmdldCBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCBhbHJlYWR5LlxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAvLyBDbGVhciB0aGUgcmVzdW1lIHRva2VuIGZvciB0aGUgdGFyZ2V0LCBzaW5jZSB3ZSdyZSBpbiBhIGtub3duIG1pc21hdGNoXG4gICAgICAgICAgICAgICAgLy8gc3RhdGUuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHQuRXUuc2V0KGUsIHMud2l0aFJlc3VtZVRva2VuKFZlLkVNUFRZX0JZVEVfU1RSSU5HLCBzLnNuYXBzaG90VmVyc2lvbikpLCBcbiAgICAgICAgICAgICAgICAvLyBDYXVzZSBhIGhhcmQgcmVzZXQgYnkgdW53YXRjaGluZyBhbmQgcmV3YXRjaGluZyBpbW1lZGlhdGVseSwgYnV0XG4gICAgICAgICAgICAgICAgLy8gZGVsaWJlcmF0ZWx5IGRvbid0IHNlbmQgYSByZXN1bWUgdG9rZW4gc28gdGhhdCB3ZSBnZXQgYSBmdWxsIHVwZGF0ZS5cbiAgICAgICAgICAgICAgICBYdSh0LCBlKTtcbiAgICAgICAgICAgICAgICAvLyBNYXJrIHRoZSB0YXJnZXQgd2Ugc2VuZCBhcyBiZWluZyBvbiBiZWhhbGYgb2YgYW4gZXhpc3RlbmNlIGZpbHRlclxuICAgICAgICAgICAgICAgIC8vIG1pc21hdGNoLCBidXQgZG9uJ3QgYWN0dWFsbHkgcmV0YWluIHRoYXQgaW4gbGlzdGVuVGFyZ2V0cy4gVGhpcyBlbnN1cmVzXG4gICAgICAgICAgICAgICAgLy8gdGhhdCB3ZSBmbGFnIHRoZSBmaXJzdCByZS1saXN0ZW4gdGhpcyB3YXkgd2l0aG91dCBpbXBhY3RpbmcgZnV0dXJlXG4gICAgICAgICAgICAgICAgLy8gbGlzdGVucyBvZiB0aGlzIHRhcmdldCAodGhhdCBtaWdodCBoYXBwZW4gZS5nLiBvbiByZWNvbm5lY3QpLlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgY3Iocy50YXJnZXQsIGUsIG4sIHMuc2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgICAgIFl1KHQsIGkpO1xuICAgICAgICAgICAgfSkpLCB0LnJlbW90ZVN5bmNlci5hcHBseVJlbW90ZUV2ZW50KG4pO1xuICAgICAgICB9KHQsIG4pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgTihcIlJlbW90ZVN0b3JlXCIsIFwiRmFpbGVkIHRvIHJhaXNlIHNuYXBzaG90OlwiLCBlKSwgYXdhaXQgb2ModCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlY292ZXJ5IGxvZ2ljIGZvciBJbmRleGVkREIgZXJyb3JzIHRoYXQgdGFrZXMgdGhlIG5ldHdvcmsgb2ZmbGluZSB1bnRpbFxuICogYG9wYCBzdWNjZWVkcy4gUmV0cmllcyBhcmUgc2NoZWR1bGVkIHdpdGggYmFja29mZiB1c2luZ1xuICogYGVucXVldWVSZXRyeWFibGUoKWAuIElmIGBvcCgpYCBpcyBub3QgcHJvdmlkZWQsIEluZGV4ZWREQiBhY2Nlc3MgaXNcbiAqIHZhbGlkYXRlZCB2aWEgYSBnZW5lcmljIG9wZXJhdGlvbi5cbiAqXG4gKiBUaGUgcmV0dXJuZWQgUHJvbWlzZSBpcyByZXNvbHZlZCBvbmNlIHRoZSBuZXR3b3JrIGlzIGRpc2FibGVkIGFuZCBiZWZvcmVcbiAqIGFueSByZXRyeSBhdHRlbXB0LlxuICovIGFzeW5jIGZ1bmN0aW9uIG9jKHQsIGUsIG4pIHtcbiAgICBpZiAoIUR0KGUpKSB0aHJvdyBlO1xuICAgIHQuQXUuYWRkKDEgLyogT2ZmbGluZUNhdXNlLkluZGV4ZWREYkZhaWxlZCAqLyksIFxuICAgIC8vIERpc2FibGUgbmV0d29yayBhbmQgcmFpc2Ugb2ZmbGluZSBzbmFwc2hvdHNcbiAgICBhd2FpdCBXdSh0KSwgdC5QdS5zZXQoXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyksIG4gfHwgKFxuICAgIC8vIFVzZSBhIHNpbXBsZSByZWFkIG9wZXJhdGlvbiB0byBkZXRlcm1pbmUgaWYgSW5kZXhlZERCIHJlY292ZXJlZC5cbiAgICAvLyBJZGVhbGx5LCB3ZSB3b3VsZCBleHBvc2UgYSBoZWFsdGggY2hlY2sgZGlyZWN0bHkgb24gU2ltcGxlRGIsIGJ1dFxuICAgIC8vIFJlbW90ZVN0b3JlIG9ubHkgaGFzIGFjY2VzcyB0byBwZXJzaXN0ZW5jZSB0aHJvdWdoIExvY2FsU3RvcmUuXG4gICAgbiA9ICgpID0+IG91KHQubG9jYWxTdG9yZSkpLCBcbiAgICAvLyBQcm9iZSBJbmRleGVkREIgcGVyaW9kaWNhbGx5IGFuZCByZS1lbmFibGUgbmV0d29ya1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlUmV0cnlhYmxlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIE4oXCJSZW1vdGVTdG9yZVwiLCBcIlJldHJ5aW5nIEluZGV4ZWREQiBhY2Nlc3NcIiksIGF3YWl0IG4oKSwgdC5BdS5kZWxldGUoMSAvKiBPZmZsaW5lQ2F1c2UuSW5kZXhlZERiRmFpbGVkICovKSwgXG4gICAgICAgIGF3YWl0IHp1KHQpO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyBgb3BgLiBJZiBgb3BgIGZhaWxzLCB0YWtlcyB0aGUgbmV0d29yayBvZmZsaW5lIHVudGlsIGBvcGBcbiAqIHN1Y2NlZWRzLiBSZXR1cm5zIGFmdGVyIHRoZSBmaXJzdCBhdHRlbXB0LlxuICovIGZ1bmN0aW9uIHVjKHQsIGUpIHtcbiAgICByZXR1cm4gZSgpLmNhdGNoKChuID0+IG9jKHQsIG4sIGUpKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNjKHQpIHtcbiAgICBjb25zdCBlID0gTCh0KSwgbiA9IEljKGUpO1xuICAgIGxldCBzID0gZS5UdS5sZW5ndGggPiAwID8gZS5UdVtlLlR1Lmxlbmd0aCAtIDFdLmJhdGNoSWQgOiAtMTtcbiAgICBmb3IgKDthYyhlKTsgKSB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgYXUoZS5sb2NhbFN0b3JlLCBzKTtcbiAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgIDAgPT09IGUuVHUubGVuZ3RoICYmIG4uUW8oKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHMgPSB0LmJhdGNoSWQsIGhjKGUsIHQpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgb2MoZSwgdCk7XG4gICAgfVxuICAgIGxjKGUpICYmIGZjKGUpO1xufVxuXG4vKipcbiAqIFJldHVybnMgdHJ1ZSBpZiB3ZSBjYW4gYWRkIHRvIHRoZSB3cml0ZSBwaXBlbGluZSAoaS5lLiB0aGUgbmV0d29yayBpc1xuICogZW5hYmxlZCBhbmQgdGhlIHdyaXRlIHBpcGVsaW5lIGlzIG5vdCBmdWxsKS5cbiAqLyBmdW5jdGlvbiBhYyh0KSB7XG4gICAgcmV0dXJuIGVjKHQpICYmIHQuVHUubGVuZ3RoIDwgMTA7XG59XG5cbi8qKlxuICogUXVldWVzIGFkZGl0aW9uYWwgd3JpdGVzIHRvIGJlIHNlbnQgdG8gdGhlIHdyaXRlIHN0cmVhbSwgc2VuZGluZyB0aGVtXG4gKiBpbW1lZGlhdGVseSBpZiB0aGUgd3JpdGUgc3RyZWFtIGlzIGVzdGFibGlzaGVkLlxuICovIGZ1bmN0aW9uIGhjKHQsIGUpIHtcbiAgICB0LlR1LnB1c2goZSk7XG4gICAgY29uc3QgbiA9IEljKHQpO1xuICAgIG4uVW8oKSAmJiBuLnJ1ICYmIG4ub3UoZS5tdXRhdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBsYyh0KSB7XG4gICAgcmV0dXJuIGVjKHQpICYmICFJYyh0KS5xbygpICYmIHQuVHUubGVuZ3RoID4gMDtcbn1cblxuZnVuY3Rpb24gZmModCkge1xuICAgIEljKHQpLnN0YXJ0KCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGRjKHQpIHtcbiAgICBJYyh0KS5hdSgpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBfYyh0KSB7XG4gICAgY29uc3QgZSA9IEljKHQpO1xuICAgIC8vIFNlbmQgdGhlIHdyaXRlIHBpcGVsaW5lIG5vdyB0aGF0IHRoZSBzdHJlYW0gaXMgZXN0YWJsaXNoZWQuXG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0LlR1KSBlLm91KG4ubXV0YXRpb25zKTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gd2ModCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSB0LlR1LnNoaWZ0KCksIGkgPSB0aS5mcm9tKHMsIGUsIG4pO1xuICAgIGF3YWl0IHVjKHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5hcHBseVN1Y2Nlc3NmdWxXcml0ZShpKSkpLCBcbiAgICAvLyBJdCdzIHBvc3NpYmxlIHRoYXQgd2l0aCB0aGUgY29tcGxldGlvbiBvZiB0aGlzIG11dGF0aW9uIGFub3RoZXJcbiAgICAvLyBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICBhd2FpdCBjYyh0KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gbWModCwgZSkge1xuICAgIC8vIElmIHRoZSB3cml0ZSBzdHJlYW0gY2xvc2VkIGFmdGVyIHRoZSB3cml0ZSBoYW5kc2hha2UgY29tcGxldGVzLCBhIHdyaXRlXG4gICAgLy8gb3BlcmF0aW9uIGZhaWxlZCBhbmQgd2UgZmFpbCB0aGUgcGVuZGluZyBvcGVyYXRpb24uXG4gICAgZSAmJiBJYyh0KS5ydSAmJiBcbiAgICAvLyBUaGlzIGVycm9yIGFmZmVjdHMgdGhlIGFjdHVhbCB3cml0ZS5cbiAgICBhd2FpdCBhc3luYyBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIE9ubHkgaGFuZGxlIHBlcm1hbmVudCBlcnJvcnMgaGVyZS4gSWYgaXQncyB0cmFuc2llbnQsIGp1c3QgbGV0IHRoZSByZXRyeVxuICAgICAgICAvLyBsb2dpYyBraWNrIGluLlxuICAgICAgICBpZiAobiA9IGUuY29kZSwgb2kobikgJiYgbiAhPT0gcS5BQk9SVEVEKSB7XG4gICAgICAgICAgICAvLyBUaGlzIHdhcyBhIHBlcm1hbmVudCBlcnJvciwgdGhlIHJlcXVlc3QgaXRzZWxmIHdhcyB0aGUgcHJvYmxlbVxuICAgICAgICAgICAgLy8gc28gaXQncyBub3QgZ29pbmcgdG8gc3VjY2VlZCBpZiB3ZSByZXNlbmQgaXQuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5UdS5zaGlmdCgpO1xuICAgICAgICAgICAgLy8gSW4gdGhpcyBjYXNlIGl0J3MgYWxzbyB1bmxpa2VseSB0aGF0IHRoZSBzZXJ2ZXIgaXRzZWxmIGlzIG1lbHRpbmdcbiAgICAgICAgICAgIC8vIGRvd24gLS0gdGhpcyB3YXMganVzdCBhIGJhZCByZXF1ZXN0IHNvIGluaGliaXQgYmFja29mZiBvbiB0aGUgbmV4dFxuICAgICAgICAgICAgLy8gcmVzdGFydC5cbiAgICAgICAgICAgICAgICAgICAgICAgIEljKHQpLkdvKCksIGF3YWl0IHVjKHQsICgoKSA9PiB0LnJlbW90ZVN5bmNlci5yZWplY3RGYWlsZWRXcml0ZShuLmJhdGNoSWQsIGUpKSksIFxuICAgICAgICAgICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHdpdGggdGhlIGNvbXBsZXRpb24gb2YgdGhpcyBtdXRhdGlvblxuICAgICAgICAgICAgLy8gYW5vdGhlciBzbG90IGhhcyBmcmVlZCB1cC5cbiAgICAgICAgICAgIGF3YWl0IGNjKHQpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuO1xuICAgIH0odCwgZSksIFxuICAgIC8vIFRoZSB3cml0ZSBzdHJlYW0gbWlnaHQgaGF2ZSBiZWVuIHN0YXJ0ZWQgYnkgcmVmaWxsaW5nIHRoZSB3cml0ZVxuICAgIC8vIHBpcGVsaW5lIGZvciBmYWlsZWQgd3JpdGVzXG4gICAgbGModCkgJiYgZmModCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICBuLmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBOKFwiUmVtb3RlU3RvcmVcIiwgXCJSZW1vdGVTdG9yZSByZWNlaXZlZCBuZXcgY3JlZGVudGlhbHNcIik7XG4gICAgY29uc3QgcyA9IGVjKG4pO1xuICAgIC8vIFRlYXIgZG93biBhbmQgcmUtY3JlYXRlIG91ciBuZXR3b3JrIHN0cmVhbXMuIFRoaXMgd2lsbCBlbnN1cmUgd2UgZ2V0IGFcbiAgICAvLyBmcmVzaCBhdXRoIHRva2VuIGZvciB0aGUgbmV3IHVzZXIgYW5kIHJlLWZpbGwgdGhlIHdyaXRlIHBpcGVsaW5lIHdpdGhcbiAgICAvLyBuZXcgbXV0YXRpb25zIGZyb20gdGhlIExvY2FsU3RvcmUgKHNpbmNlIG11dGF0aW9ucyBhcmUgcGVyLXVzZXIpLlxuICAgICAgICBuLkF1LmFkZCgzIC8qIE9mZmxpbmVDYXVzZS5DcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgV3UobiksIHMgJiYgXG4gICAgLy8gRG9uJ3Qgc2V0IHRoZSBuZXR3b3JrIHN0YXR1cyB0byBVbmtub3duIGlmIHdlIGFyZSBvZmZsaW5lLlxuICAgIG4uUHUuc2V0KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pLCBhd2FpdCBuLnJlbW90ZVN5bmNlci5oYW5kbGVDcmVkZW50aWFsQ2hhbmdlKGUpLCBcbiAgICBuLkF1LmRlbGV0ZSgzIC8qIE9mZmxpbmVDYXVzZS5DcmVkZW50aWFsQ2hhbmdlICovKSwgYXdhaXQgenUobik7XG59XG5cbi8qKlxuICogVG9nZ2xlcyB0aGUgbmV0d29yayBzdGF0ZSB3aGVuIHRoZSBjbGllbnQgZ2FpbnMgb3IgbG9zZXMgaXRzIHByaW1hcnkgbGVhc2UuXG4gKi8gYXN5bmMgZnVuY3Rpb24geWModCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgIGUgPyAobi5BdS5kZWxldGUoMiAvKiBPZmZsaW5lQ2F1c2UuSXNTZWNvbmRhcnkgKi8pLCBhd2FpdCB6dShuKSkgOiBlIHx8IChuLkF1LmFkZCgyIC8qIE9mZmxpbmVDYXVzZS5Jc1NlY29uZGFyeSAqLyksIFxuICAgIGF3YWl0IFd1KG4pLCBuLlB1LnNldChcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovKSk7XG59XG5cbi8qKlxuICogSWYgbm90IHlldCBpbml0aWFsaXplZCwgcmVnaXN0ZXJzIHRoZSBXYXRjaFN0cmVhbSBhbmQgaXRzIG5ldHdvcmsgc3RhdGVcbiAqIGNhbGxiYWNrIHdpdGggYHJlbW90ZVN0b3JlSW1wbGAuIFJldHVybnMgdGhlIGV4aXN0aW5nIHN0cmVhbSBpZiBvbmUgaXNcbiAqIGFscmVhZHkgYXZhaWxhYmxlLlxuICpcbiAqIFBPUlRJTkcgTk9URTogT24gaU9TIGFuZCBBbmRyb2lkLCB0aGUgV2F0Y2hTdHJlYW0gZ2V0cyByZWdpc3RlcmVkIG9uIHN0YXJ0dXAuXG4gKiBUaGlzIGlzIG5vdCBkb25lIG9uIFdlYiB0byBhbGxvdyBpdCB0byBiZSB0cmVlLXNoYWtlbi5cbiAqLyBmdW5jdGlvbiBwYyh0KSB7XG4gICAgcmV0dXJuIHQuVnUgfHwgKFxuICAgIC8vIENyZWF0ZSBzdHJlYW0gKGJ1dCBub3RlIHRoYXQgaXQgaXMgbm90IHN0YXJ0ZWQgeWV0KS5cbiAgICB0LlZ1ID0gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gTCh0KTtcbiAgICAgICAgcmV0dXJuIHMubHUoKSwgbmV3IHF1KGUsIHMuY29ubmVjdGlvbiwgcy5hdXRoQ3JlZGVudGlhbHMsIHMuYXBwQ2hlY2tDcmVkZW50aWFscywgcy5zZXJpYWxpemVyLCBuKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTggR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi8gKHQuZGF0YXN0b3JlLCB0LmFzeW5jUXVldWUsIHtcbiAgICAgICAgb286IHNjLmJpbmQobnVsbCwgdCksXG4gICAgICAgIGNvOiBpYy5iaW5kKG51bGwsIHQpLFxuICAgICAgICBldTogcmMuYmluZChudWxsLCB0KVxuICAgIH0pLCB0LlJ1LnB1c2goKGFzeW5jIGUgPT4ge1xuICAgICAgICBlID8gKHQuVnUuR28oKSwgdGModCkgPyBadSh0KSA6IHQuUHUuc2V0KFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8pKSA6IChhd2FpdCB0LlZ1LnN0b3AoKSwgXG4gICAgICAgIG5jKHQpKTtcbiAgICB9KSkpLCB0LlZ1O1xufVxuXG4vKipcbiAqIElmIG5vdCB5ZXQgaW5pdGlhbGl6ZWQsIHJlZ2lzdGVycyB0aGUgV3JpdGVTdHJlYW0gYW5kIGl0cyBuZXR3b3JrIHN0YXRlXG4gKiBjYWxsYmFjayB3aXRoIGByZW1vdGVTdG9yZUltcGxgLiBSZXR1cm5zIHRoZSBleGlzdGluZyBzdHJlYW0gaWYgb25lIGlzXG4gKiBhbHJlYWR5IGF2YWlsYWJsZS5cbiAqXG4gKiBQT1JUSU5HIE5PVEU6IE9uIGlPUyBhbmQgQW5kcm9pZCwgdGhlIFdyaXRlU3RyZWFtIGdldHMgcmVnaXN0ZXJlZCBvbiBzdGFydHVwLlxuICogVGhpcyBpcyBub3QgZG9uZSBvbiBXZWIgdG8gYWxsb3cgaXQgdG8gYmUgdHJlZS1zaGFrZW4uXG4gKi8gZnVuY3Rpb24gSWModCkge1xuICAgIHJldHVybiB0LlN1IHx8IChcbiAgICAvLyBDcmVhdGUgc3RyZWFtIChidXQgbm90ZSB0aGF0IGl0IGlzIG5vdCBzdGFydGVkIHlldCkuXG4gICAgdC5TdSA9IGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgY29uc3QgcyA9IEwodCk7XG4gICAgICAgIHJldHVybiBzLmx1KCksIG5ldyBVdShlLCBzLmNvbm5lY3Rpb24sIHMuYXV0aENyZWRlbnRpYWxzLCBzLmFwcENoZWNrQ3JlZGVudGlhbHMsIHMuc2VyaWFsaXplciwgbik7XG4gICAgfSh0LmRhdGFzdG9yZSwgdC5hc3luY1F1ZXVlLCB7XG4gICAgICAgIG9vOiBkYy5iaW5kKG51bGwsIHQpLFxuICAgICAgICBjbzogbWMuYmluZChudWxsLCB0KSxcbiAgICAgICAgY3U6IF9jLmJpbmQobnVsbCwgdCksXG4gICAgICAgIHV1OiB3Yy5iaW5kKG51bGwsIHQpXG4gICAgfSksIHQuUnUucHVzaCgoYXN5bmMgZSA9PiB7XG4gICAgICAgIGUgPyAodC5TdS5HbygpLCBcbiAgICAgICAgLy8gVGhpcyB3aWxsIHN0YXJ0IHRoZSB3cml0ZSBzdHJlYW0gaWYgbmVjZXNzYXJ5LlxuICAgICAgICBhd2FpdCBjYyh0KSkgOiAoYXdhaXQgdC5TdS5zdG9wKCksIHQuVHUubGVuZ3RoID4gMCAmJiAoTihcIlJlbW90ZVN0b3JlXCIsIGBTdG9wcGluZyB3cml0ZSBzdHJlYW0gd2l0aCAke3QuVHUubGVuZ3RofSBwZW5kaW5nIHdyaXRlc2ApLCBcbiAgICAgICAgdC5UdSA9IFtdKSk7XG4gICAgfSkpKSwgdC5TdTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhbiBvcGVyYXRpb24gc2NoZWR1bGVkIHRvIGJlIHJ1biBpbiB0aGUgZnV0dXJlIG9uIGFuIEFzeW5jUXVldWUuXG4gKlxuICogSXQgaXMgY3JlYXRlZCB2aWEgRGVsYXllZE9wZXJhdGlvbi5jcmVhdGVBbmRTY2hlZHVsZSgpLlxuICpcbiAqIFN1cHBvcnRzIGNhbmNlbGxhdGlvbiAodmlhIGNhbmNlbCgpKSBhbmQgZWFybHkgZXhlY3V0aW9uICh2aWEgc2tpcERlbGF5KCkpLlxuICpcbiAqIE5vdGU6IFdlIGltcGxlbWVudCBgUHJvbWlzZUxpa2VgIGluc3RlYWQgb2YgYFByb21pc2VgLCBhcyB0aGUgYFByb21pc2VgIHR5cGVcbiAqIGluIG5ld2VyIHZlcnNpb25zIG9mIFR5cGVTY3JpcHQgZGVmaW5lcyBgZmluYWxseWAsIHdoaWNoIGlzIG5vdCBhdmFpbGFibGUgaW5cbiAqIElFLlxuICovXG5jbGFzcyBUYyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSkge1xuICAgICAgICB0aGlzLmFzeW5jUXVldWUgPSB0LCB0aGlzLnRpbWVySWQgPSBlLCB0aGlzLnRhcmdldFRpbWVNcyA9IG4sIHRoaXMub3AgPSBzLCB0aGlzLnJlbW92YWxDYWxsYmFjayA9IGksIFxuICAgICAgICB0aGlzLmRlZmVycmVkID0gbmV3IEssIHRoaXMudGhlbiA9IHRoaXMuZGVmZXJyZWQucHJvbWlzZS50aGVuLmJpbmQodGhpcy5kZWZlcnJlZC5wcm9taXNlKSwgXG4gICAgICAgIC8vIEl0J3Mgbm9ybWFsIGZvciB0aGUgZGVmZXJyZWQgcHJvbWlzZSB0byBiZSBjYW5jZWxlZCAoZHVlIHRvIGNhbmNlbGxhdGlvbilcbiAgICAgICAgLy8gYW5kIHNvIHdlIGF0dGFjaCBhIGR1bW15IGNhdGNoIGNhbGxiYWNrIHRvIGF2b2lkXG4gICAgICAgIC8vICdVbmhhbmRsZWRQcm9taXNlUmVqZWN0aW9uV2FybmluZycgbG9nIHNwYW0uXG4gICAgICAgIHRoaXMuZGVmZXJyZWQucHJvbWlzZS5jYXRjaCgodCA9PiB7fSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgRGVsYXllZE9wZXJhdGlvbiB0aGF0IGhhcyBiZWVuIHNjaGVkdWxlZCB0byBiZVxuICAgICAqIGV4ZWN1dGVkIG9uIHRoZSBwcm92aWRlZCBhc3luY1F1ZXVlIGFmdGVyIHRoZSBwcm92aWRlZCBkZWxheU1zLlxuICAgICAqXG4gICAgICogQHBhcmFtIGFzeW5jUXVldWUgLSBUaGUgcXVldWUgdG8gc2NoZWR1bGUgdGhlIG9wZXJhdGlvbiBvbi5cbiAgICAgKiBAcGFyYW0gaWQgLSBBIFRpbWVyIElEIGlkZW50aWZ5aW5nIHRoZSB0eXBlIG9mIG9wZXJhdGlvbiB0aGlzIGlzLlxuICAgICAqIEBwYXJhbSBkZWxheU1zIC0gVGhlIGRlbGF5IChtcykgYmVmb3JlIHRoZSBvcGVyYXRpb24gc2hvdWxkIGJlIHNjaGVkdWxlZC5cbiAgICAgKiBAcGFyYW0gb3AgLSBUaGUgb3BlcmF0aW9uIHRvIHJ1bi5cbiAgICAgKiBAcGFyYW0gcmVtb3ZhbENhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgc3luY2hyb25vdXNseSBvbmNlIHRoZVxuICAgICAqICAgb3BlcmF0aW9uIGlzIGV4ZWN1dGVkIG9yIGNhbmNlbGVkLCBub3RpZnlpbmcgdGhlIEFzeW5jUXVldWUgdG8gcmVtb3ZlIGl0XG4gICAgICogICBmcm9tIGl0cyBkZWxheWVkT3BlcmF0aW9ucyBsaXN0LlxuICAgICAqICAgUE9SVElORyBOT1RFOiBUaGlzIGV4aXN0cyB0byBwcmV2ZW50IG1ha2luZyByZW1vdmVEZWxheWVkT3BlcmF0aW9uKCkgYW5kXG4gICAgICogICB0aGUgRGVsYXllZE9wZXJhdGlvbiBjbGFzcyBwdWJsaWMuXG4gICAgICovICAgIHN0YXRpYyBjcmVhdGVBbmRTY2hlZHVsZSh0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBEYXRlLm5vdygpICsgbiwgbyA9IG5ldyBUYyh0LCBlLCByLCBzLCBpKTtcbiAgICAgICAgcmV0dXJuIG8uc3RhcnQobiksIG87XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFN0YXJ0cyB0aGUgdGltZXIuIFRoaXMgaXMgY2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIGNvbnN0cnVjdGlvbiBieVxuICAgICAqIGNyZWF0ZUFuZFNjaGVkdWxlKCkuXG4gICAgICovICAgIHN0YXJ0KHQpIHtcbiAgICAgICAgdGhpcy50aW1lckhhbmRsZSA9IHNldFRpbWVvdXQoKCgpID0+IHRoaXMuaGFuZGxlRGVsYXlFbGFwc2VkKCkpLCB0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUXVldWVzIHRoZSBvcGVyYXRpb24gdG8gcnVuIGltbWVkaWF0ZWx5IChpZiBpdCBoYXNuJ3QgYWxyZWFkeSBiZWVuIHJ1biBvclxuICAgICAqIGNhbmNlbGVkKS5cbiAgICAgKi8gICAgc2tpcERlbGF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5oYW5kbGVEZWxheUVsYXBzZWQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2FuY2VscyB0aGUgb3BlcmF0aW9uIGlmIGl0IGhhc24ndCBhbHJlYWR5IGJlZW4gZXhlY3V0ZWQgb3IgY2FuY2VsZWQuIFRoZVxuICAgICAqIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZC5cbiAgICAgKlxuICAgICAqIEFzIGxvbmcgYXMgdGhlIG9wZXJhdGlvbiBoYXMgbm90IHlldCBiZWVuIHJ1biwgY2FsbGluZyBjYW5jZWwoKSBwcm92aWRlcyBhXG4gICAgICogZ3VhcmFudGVlIHRoYXQgdGhlIG9wZXJhdGlvbiB3aWxsIG5vdCBiZSBydW4uXG4gICAgICovICAgIGNhbmNlbCh0KSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMuY2xlYXJUaW1lb3V0KCksIHRoaXMuZGVmZXJyZWQucmVqZWN0KG5ldyBVKHEuQ0FOQ0VMTEVELCBcIk9wZXJhdGlvbiBjYW5jZWxsZWRcIiArICh0ID8gXCI6IFwiICsgdCA6IFwiXCIpKSkpO1xuICAgIH1cbiAgICBoYW5kbGVEZWxheUVsYXBzZWQoKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBudWxsICE9PSB0aGlzLnRpbWVySGFuZGxlID8gKHRoaXMuY2xlYXJUaW1lb3V0KCksIFxuICAgICAgICB0aGlzLm9wKCkudGhlbigodCA9PiB0aGlzLmRlZmVycmVkLnJlc29sdmUodCkpKSkgOiBQcm9taXNlLnJlc29sdmUoKSkpO1xuICAgIH1cbiAgICBjbGVhclRpbWVvdXQoKSB7XG4gICAgICAgIG51bGwgIT09IHRoaXMudGltZXJIYW5kbGUgJiYgKHRoaXMucmVtb3ZhbENhbGxiYWNrKHRoaXMpLCBjbGVhclRpbWVvdXQodGhpcy50aW1lckhhbmRsZSksIFxuICAgICAgICB0aGlzLnRpbWVySGFuZGxlID0gbnVsbCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBGaXJlc3RvcmVFcnJvciB0aGF0IGNhbiBiZSBzdXJmYWNlZCB0byB0aGUgdXNlciBpZiB0aGUgcHJvdmlkZWRcbiAqIGVycm9yIGlzIGFuIEluZGV4ZWREYlRyYW5zYWN0aW9uRXJyb3IuIFJlLXRocm93cyB0aGUgZXJyb3Igb3RoZXJ3aXNlLlxuICovIGZ1bmN0aW9uIEVjKHQsIGUpIHtcbiAgICBpZiAoayhcIkFzeW5jUXVldWVcIiwgYCR7ZX06ICR7dH1gKSwgRHQodCkpIHJldHVybiBuZXcgVShxLlVOQVZBSUxBQkxFLCBgJHtlfTogJHt0fWApO1xuICAgIHRocm93IHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIERvY3VtZW50U2V0IGlzIGFuIGltbXV0YWJsZSAoY29weS1vbi13cml0ZSkgY29sbGVjdGlvbiB0aGF0IGhvbGRzIGRvY3VtZW50c1xuICogaW4gb3JkZXIgc3BlY2lmaWVkIGJ5IHRoZSBwcm92aWRlZCBjb21wYXJhdG9yLiBXZSBhbHdheXMgYWRkIGEgZG9jdW1lbnQga2V5XG4gKiBjb21wYXJhdG9yIG9uIHRvcCBvZiB3aGF0IGlzIHByb3ZpZGVkIHRvIGd1YXJhbnRlZSBkb2N1bWVudCBlcXVhbGl0eSBiYXNlZCBvblxuICogdGhlIGtleS5cbiAqLyBjbGFzcyBBYyB7XG4gICAgLyoqIFRoZSBkZWZhdWx0IG9yZGVyaW5nIGlzIGJ5IGtleSBpZiB0aGUgY29tcGFyYXRvciBpcyBvbWl0dGVkICovXG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICAvLyBXZSBhcmUgYWRkaW5nIGRvY3VtZW50IGtleSBjb21wYXJhdG9yIHRvIHRoZSBlbmQgYXMgaXQncyB0aGUgb25seVxuICAgICAgICAvLyBndWFyYW50ZWVkIHVuaXF1ZSBwcm9wZXJ0eSBvZiBhIGRvY3VtZW50LlxuICAgICAgICB0aGlzLmNvbXBhcmF0b3IgPSB0ID8gKGUsIG4pID0+IHQoZSwgbikgfHwgaHQuY29tcGFyYXRvcihlLmtleSwgbi5rZXkpIDogKHQsIGUpID0+IGh0LmNvbXBhcmF0b3IodC5rZXksIGUua2V5KSwgXG4gICAgICAgIHRoaXMua2V5ZWRNYXAgPSBocygpLCB0aGlzLnNvcnRlZFNldCA9IG5ldyBwZSh0aGlzLmNvbXBhcmF0b3IpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGFuIGVtcHR5IGNvcHkgb2YgdGhlIGV4aXN0aW5nIERvY3VtZW50U2V0LCB1c2luZyB0aGUgc2FtZVxuICAgICAqIGNvbXBhcmF0b3IuXG4gICAgICovICAgIHN0YXRpYyBlbXB0eVNldCh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgQWModC5jb21wYXJhdG9yKTtcbiAgICB9XG4gICAgaGFzKHQpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT0gdGhpcy5rZXllZE1hcC5nZXQodCk7XG4gICAgfVxuICAgIGdldCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmtleWVkTWFwLmdldCh0KTtcbiAgICB9XG4gICAgZmlyc3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5taW5LZXkoKTtcbiAgICB9XG4gICAgbGFzdCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuc29ydGVkU2V0Lm1heEtleSgpO1xuICAgIH1cbiAgICBpc0VtcHR5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zb3J0ZWRTZXQuaXNFbXB0eSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBpbmRleCBvZiB0aGUgcHJvdmlkZWQga2V5IGluIHRoZSBkb2N1bWVudCBzZXQsIG9yIC0xIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IGtleSBpcyBub3QgcHJlc2VudCBpbiB0aGUgc2V0O1xuICAgICAqLyAgICBpbmRleE9mKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMua2V5ZWRNYXAuZ2V0KHQpO1xuICAgICAgICByZXR1cm4gZSA/IHRoaXMuc29ydGVkU2V0LmluZGV4T2YoZSkgOiAtMTtcbiAgICB9XG4gICAgZ2V0IHNpemUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFNldC5zaXplO1xuICAgIH1cbiAgICAvKiogSXRlcmF0ZXMgZG9jdW1lbnRzIGluIG9yZGVyIGRlZmluZWQgYnkgXCJjb21wYXJhdG9yXCIgKi8gICAgZm9yRWFjaCh0KSB7XG4gICAgICAgIHRoaXMuc29ydGVkU2V0Lmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiAodChlKSwgITEpKSk7XG4gICAgfVxuICAgIC8qKiBJbnNlcnRzIG9yIHVwZGF0ZXMgYSBkb2N1bWVudCB3aXRoIHRoZSBzYW1lIGtleSAqLyAgICBhZGQodCkge1xuICAgICAgICAvLyBGaXJzdCByZW1vdmUgdGhlIGVsZW1lbnQgaWYgd2UgaGF2ZSBpdC5cbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZGVsZXRlKHQua2V5KTtcbiAgICAgICAgcmV0dXJuIGUuY29weShlLmtleWVkTWFwLmluc2VydCh0LmtleSwgdCksIGUuc29ydGVkU2V0Lmluc2VydCh0LCBudWxsKSk7XG4gICAgfVxuICAgIC8qKiBEZWxldGVzIGEgZG9jdW1lbnQgd2l0aCBhIGdpdmVuIGtleSAqLyAgICBkZWxldGUodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5nZXQodCk7XG4gICAgICAgIHJldHVybiBlID8gdGhpcy5jb3B5KHRoaXMua2V5ZWRNYXAucmVtb3ZlKHQpLCB0aGlzLnNvcnRlZFNldC5yZW1vdmUoZSkpIDogdGhpcztcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIGlmICghKHQgaW5zdGFuY2VvZiBBYykpIHJldHVybiAhMTtcbiAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gdC5zaXplKSByZXR1cm4gITE7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnNvcnRlZFNldC5nZXRJdGVyYXRvcigpLCBuID0gdC5zb3J0ZWRTZXQuZ2V0SXRlcmF0b3IoKTtcbiAgICAgICAgZm9yICg7ZS5oYXNOZXh0KCk7ICkge1xuICAgICAgICAgICAgY29uc3QgdCA9IGUuZ2V0TmV4dCgpLmtleSwgcyA9IG4uZ2V0TmV4dCgpLmtleTtcbiAgICAgICAgICAgIGlmICghdC5pc0VxdWFsKHMpKSByZXR1cm4gITE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbiAgICB0b1N0cmluZygpIHtcbiAgICAgICAgY29uc3QgdCA9IFtdO1xuICAgICAgICByZXR1cm4gdGhpcy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQucHVzaChlLnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIDAgPT09IHQubGVuZ3RoID8gXCJEb2N1bWVudFNldCAoKVwiIDogXCJEb2N1bWVudFNldCAoXFxuICBcIiArIHQuam9pbihcIiAgXFxuXCIpICsgXCJcXG4pXCI7XG4gICAgfVxuICAgIGNvcHkodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gbmV3IEFjO1xuICAgICAgICByZXR1cm4gbi5jb21wYXJhdG9yID0gdGhpcy5jb21wYXJhdG9yLCBuLmtleWVkTWFwID0gdCwgbi5zb3J0ZWRTZXQgPSBlLCBuO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRG9jdW1lbnRDaGFuZ2VTZXQga2VlcHMgdHJhY2sgb2YgYSBzZXQgb2YgY2hhbmdlcyB0byBkb2NzIGluIGEgcXVlcnksIG1lcmdpbmdcbiAqIGR1cGxpY2F0ZSBldmVudHMgZm9yIHRoZSBzYW1lIGRvYy5cbiAqLyBjbGFzcyBSYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuRHUgPSBuZXcgcGUoaHQuY29tcGFyYXRvcik7XG4gICAgfVxuICAgIHRyYWNrKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHQuZG9jLmtleSwgbiA9IHRoaXMuRHUuZ2V0KGUpO1xuICAgICAgICBuID8gXG4gICAgICAgIC8vIE1lcmdlIHRoZSBuZXcgY2hhbmdlIHdpdGggdGhlIGV4aXN0aW5nIGNoYW5nZS5cbiAgICAgICAgMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovICE9PSB0LnR5cGUgJiYgMyAvKiBDaGFuZ2VUeXBlLk1ldGFkYXRhICovID09PSBuLnR5cGUgPyB0aGlzLkR1ID0gdGhpcy5EdS5pbnNlcnQoZSwgdCkgOiAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gPT09IHQudHlwZSAmJiAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyAhPT0gbi50eXBlID8gdGhpcy5EdSA9IHRoaXMuRHUuaW5zZXJ0KGUsIHtcbiAgICAgICAgICAgIHR5cGU6IG4udHlwZSxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gPT09IHQudHlwZSAmJiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuRHUgPSB0aGlzLkR1Lmluc2VydChlLCB7XG4gICAgICAgICAgICB0eXBlOiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiB0LmRvY1xuICAgICAgICB9KSA6IDIgLyogQ2hhbmdlVHlwZS5Nb2RpZmllZCAqLyA9PT0gdC50eXBlICYmIDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA9PT0gbi50eXBlID8gdGhpcy5EdSA9IHRoaXMuRHUuaW5zZXJ0KGUsIHtcbiAgICAgICAgICAgIHR5cGU6IDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyAsXG4gICAgICAgICAgICBkb2M6IHQuZG9jXG4gICAgICAgIH0pIDogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gPT09IHQudHlwZSAmJiAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi8gPT09IG4udHlwZSA/IHRoaXMuRHUgPSB0aGlzLkR1LnJlbW92ZShlKSA6IDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovID09PSB0LnR5cGUgJiYgMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovID09PSBuLnR5cGUgPyB0aGlzLkR1ID0gdGhpcy5EdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgZG9jOiBuLmRvY1xuICAgICAgICB9KSA6IDAgLyogQ2hhbmdlVHlwZS5BZGRlZCAqLyA9PT0gdC50eXBlICYmIDEgLyogQ2hhbmdlVHlwZS5SZW1vdmVkICovID09PSBuLnR5cGUgPyB0aGlzLkR1ID0gdGhpcy5EdS5pbnNlcnQoZSwge1xuICAgICAgICAgICAgdHlwZTogMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovICxcbiAgICAgICAgICAgIGRvYzogdC5kb2NcbiAgICAgICAgfSkgOiBcbiAgICAgICAgLy8gVGhpcyBpbmNsdWRlcyB0aGVzZSBjYXNlcywgd2hpY2ggZG9uJ3QgbWFrZSBzZW5zZTpcbiAgICAgICAgLy8gQWRkZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPlJlbW92ZWRcbiAgICAgICAgLy8gTW9kaWZpZWQtPkFkZGVkXG4gICAgICAgIC8vIFJlbW92ZWQtPk1vZGlmaWVkXG4gICAgICAgIC8vIE1ldGFkYXRhLT5BZGRlZFxuICAgICAgICAvLyBSZW1vdmVkLT5NZXRhZGF0YVxuICAgICAgICAkKCkgOiB0aGlzLkR1ID0gdGhpcy5EdS5pbnNlcnQoZSwgdCk7XG4gICAgfVxuICAgIEN1KCkge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIHJldHVybiB0aGlzLkR1Lmlub3JkZXJUcmF2ZXJzYWwoKChlLCBuKSA9PiB7XG4gICAgICAgICAgICB0LnB1c2gobik7XG4gICAgICAgIH0pKSwgdDtcbiAgICB9XG59XG5cbmNsYXNzIHZjIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpLCByLCBvLCB1LCBjKSB7XG4gICAgICAgIHRoaXMucXVlcnkgPSB0LCB0aGlzLmRvY3MgPSBlLCB0aGlzLm9sZERvY3MgPSBuLCB0aGlzLmRvY0NoYW5nZXMgPSBzLCB0aGlzLm11dGF0ZWRLZXlzID0gaSwgXG4gICAgICAgIHRoaXMuZnJvbUNhY2hlID0gciwgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID0gbywgdGhpcy5leGNsdWRlc01ldGFkYXRhQ2hhbmdlcyA9IHUsIFxuICAgICAgICB0aGlzLmhhc0NhY2hlZFJlc3VsdHMgPSBjO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIHZpZXcgc25hcHNob3QgYXMgaWYgYWxsIGRvY3VtZW50cyBpbiB0aGUgc25hcHNob3Qgd2VyZSBhZGRlZC4gKi8gICAgc3RhdGljIGZyb21Jbml0aWFsRG9jdW1lbnRzKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgY29uc3QgciA9IFtdO1xuICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgIHIucHVzaCh7XG4gICAgICAgICAgICAgICAgdHlwZTogMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovICxcbiAgICAgICAgICAgICAgICBkb2M6IHRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSksIG5ldyB2Yyh0LCBlLCBBYy5lbXB0eVNldChlKSwgciwgbiwgcywgXG4gICAgICAgIC8qIHN5bmNTdGF0ZUNoYW5nZWQ9ICovICEwLCBcbiAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICExLCBpKTtcbiAgICB9XG4gICAgZ2V0IGhhc1BlbmRpbmdXcml0ZXMoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5tdXRhdGVkS2V5cy5pc0VtcHR5KCk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICBpZiAoISh0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGUgJiYgdGhpcy5oYXNDYWNoZWRSZXN1bHRzID09PSB0Lmhhc0NhY2hlZFJlc3VsdHMgJiYgdGhpcy5zeW5jU3RhdGVDaGFuZ2VkID09PSB0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgdGhpcy5tdXRhdGVkS2V5cy5pc0VxdWFsKHQubXV0YXRlZEtleXMpICYmIFpuKHRoaXMucXVlcnksIHQucXVlcnkpICYmIHRoaXMuZG9jcy5pc0VxdWFsKHQuZG9jcykgJiYgdGhpcy5vbGREb2NzLmlzRXF1YWwodC5vbGREb2NzKSkpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuZG9jQ2hhbmdlcywgbiA9IHQuZG9jQ2hhbmdlcztcbiAgICAgICAgaWYgKGUubGVuZ3RoICE9PSBuLmxlbmd0aCkgcmV0dXJuICExO1xuICAgICAgICBmb3IgKGxldCB0ID0gMDsgdCA8IGUubGVuZ3RoOyB0KyspIGlmIChlW3RdLnR5cGUgIT09IG5bdF0udHlwZSB8fCAhZVt0XS5kb2MuaXNFcXVhbChuW3RdLmRvYykpIHJldHVybiAhMTtcbiAgICAgICAgcmV0dXJuICEwO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogSG9sZHMgdGhlIGxpc3RlbmVycyBhbmQgdGhlIGxhc3QgcmVjZWl2ZWQgVmlld1NuYXBzaG90IGZvciBhIHF1ZXJ5IGJlaW5nXG4gKiB0cmFja2VkIGJ5IEV2ZW50TWFuYWdlci5cbiAqLyBjbGFzcyBQYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMueHUgPSB2b2lkIDAsIHRoaXMubGlzdGVuZXJzID0gW107XG4gICAgfVxufVxuXG5jbGFzcyBiYyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMucXVlcmllcyA9IG5ldyBvcygodCA9PiB0cyh0KSksIFpuKSwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8gLCBcbiAgICAgICAgdGhpcy5OdSA9IG5ldyBTZXQ7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBWYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCksIHMgPSBlLnF1ZXJ5O1xuICAgIGxldCBpID0gITEsIHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyIHx8IChpID0gITAsIHIgPSBuZXcgUGMpLCBpKSB0cnkge1xuICAgICAgICByLnh1ID0gYXdhaXQgbi5vbkxpc3RlbihzKTtcbiAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgIGNvbnN0IG4gPSBFYyh0LCBgSW5pdGlhbGl6YXRpb24gb2YgcXVlcnkgJyR7ZXMoZS5xdWVyeSl9JyBmYWlsZWRgKTtcbiAgICAgICAgcmV0dXJuIHZvaWQgZS5vbkVycm9yKG4pO1xuICAgIH1cbiAgICBpZiAobi5xdWVyaWVzLnNldChzLCByKSwgci5saXN0ZW5lcnMucHVzaChlKSwgXG4gICAgLy8gUnVuIGdsb2JhbCBzbmFwc2hvdCBsaXN0ZW5lcnMgaWYgYSBjb25zaXN0ZW50IHNuYXBzaG90IGhhcyBiZWVuIGVtaXR0ZWQuXG4gICAgZS5rdShuLm9ubGluZVN0YXRlKSwgci54dSkge1xuICAgICAgICBlLk11KHIueHUpICYmIHhjKG4pO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gU2ModCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gZS5xdWVyeTtcbiAgICBsZXQgaSA9ICExO1xuICAgIGNvbnN0IHIgPSBuLnF1ZXJpZXMuZ2V0KHMpO1xuICAgIGlmIChyKSB7XG4gICAgICAgIGNvbnN0IHQgPSByLmxpc3RlbmVycy5pbmRleE9mKGUpO1xuICAgICAgICB0ID49IDAgJiYgKHIubGlzdGVuZXJzLnNwbGljZSh0LCAxKSwgaSA9IDAgPT09IHIubGlzdGVuZXJzLmxlbmd0aCk7XG4gICAgfVxuICAgIGlmIChpKSByZXR1cm4gbi5xdWVyaWVzLmRlbGV0ZShzKSwgbi5vblVubGlzdGVuKHMpO1xufVxuXG5mdW5jdGlvbiBEYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCk7XG4gICAgbGV0IHMgPSAhMTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICBjb25zdCBlID0gdC5xdWVyeSwgaSA9IG4ucXVlcmllcy5nZXQoZSk7XG4gICAgICAgIGlmIChpKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgaS5saXN0ZW5lcnMpIGUuTXUodCkgJiYgKHMgPSAhMCk7XG4gICAgICAgICAgICBpLnh1ID0gdDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzICYmIHhjKG4pO1xufVxuXG5mdW5jdGlvbiBDYyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEwodCksIGkgPSBzLnF1ZXJpZXMuZ2V0KGUpO1xuICAgIGlmIChpKSBmb3IgKGNvbnN0IHQgb2YgaS5saXN0ZW5lcnMpIHQub25FcnJvcihuKTtcbiAgICAvLyBSZW1vdmUgYWxsIGxpc3RlbmVycy4gTk9URTogV2UgZG9uJ3QgbmVlZCB0byBjYWxsIHN5bmNFbmdpbmUudW5saXN0ZW4oKVxuICAgIC8vIGFmdGVyIGFuIGVycm9yLlxuICAgICAgICBzLnF1ZXJpZXMuZGVsZXRlKGUpO1xufVxuXG4vLyBDYWxsIGFsbCBnbG9iYWwgc25hcHNob3QgbGlzdGVuZXJzIHRoYXQgaGF2ZSBiZWVuIHNldC5cbmZ1bmN0aW9uIHhjKHQpIHtcbiAgICB0Lk51LmZvckVhY2goKHQgPT4ge1xuICAgICAgICB0Lm5leHQoKTtcbiAgICB9KSk7XG59XG5cbi8qKlxuICogUXVlcnlMaXN0ZW5lciB0YWtlcyBhIHNlcmllcyBvZiBpbnRlcm5hbCB2aWV3IHNuYXBzaG90cyBhbmQgZGV0ZXJtaW5lc1xuICogd2hlbiB0byByYWlzZSB0aGUgZXZlbnQuXG4gKlxuICogSXQgdXNlcyBhbiBPYnNlcnZlciB0byBkaXNwYXRjaCBldmVudHMuXG4gKi8gY2xhc3MgTmMge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMuT3UgPSBlLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRpYWwgc25hcHNob3RzIChlLmcuIGZyb20gY2FjaGUpIG1heSBub3QgYmUgcHJvcGFnYXRlZCB0byB0aGUgd3JhcHBlZFxuICAgICAgICAgKiBvYnNlcnZlci4gVGhpcyBmbGFnIGlzIHNldCB0byB0cnVlIG9uY2Ugd2UndmUgYWN0dWFsbHkgcmFpc2VkIGFuIGV2ZW50LlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy4kdSA9ICExLCB0aGlzLkZ1ID0gbnVsbCwgdGhpcy5vbmxpbmVTdGF0ZSA9IFwiVW5rbm93blwiIC8qIE9ubGluZVN0YXRlLlVua25vd24gKi8gLCBcbiAgICAgICAgdGhpcy5vcHRpb25zID0gbiB8fCB7fTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyB0aGUgbmV3IFZpZXdTbmFwc2hvdCB0byB0aGlzIGxpc3RlbmVyLCByYWlzaW5nIGEgdXNlci1mYWNpbmcgZXZlbnRcbiAgICAgKiBpZiBhcHBsaWNhYmxlIChkZXBlbmRpbmcgb24gd2hhdCBjaGFuZ2VkLCB3aGV0aGVyIHRoZSB1c2VyIGhhcyBvcHRlZCBpbnRvXG4gICAgICogbWV0YWRhdGEtb25seSBjaGFuZ2VzLCBldGMuKS4gUmV0dXJucyB0cnVlIGlmIGEgdXNlci1mYWNpbmcgZXZlbnQgd2FzXG4gICAgICogaW5kZWVkIHJhaXNlZC5cbiAgICAgKi8gICAgTXUodCkge1xuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5pbmNsdWRlTWV0YWRhdGFDaGFuZ2VzKSB7XG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIG1ldGFkYXRhIG9ubHkgY2hhbmdlcy5cbiAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiB0LmRvY0NoYW5nZXMpIDMgLyogQ2hhbmdlVHlwZS5NZXRhZGF0YSAqLyAhPT0gbi50eXBlICYmIGUucHVzaChuKTtcbiAgICAgICAgICAgIHQgPSBuZXcgdmModC5xdWVyeSwgdC5kb2NzLCB0Lm9sZERvY3MsIGUsIHQubXV0YXRlZEtleXMsIHQuZnJvbUNhY2hlLCB0LnN5bmNTdGF0ZUNoYW5nZWQsIFxuICAgICAgICAgICAgLyogZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXM9ICovICEwLCB0Lmhhc0NhY2hlZFJlc3VsdHMpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBlID0gITE7XG4gICAgICAgIHJldHVybiB0aGlzLiR1ID8gdGhpcy5CdSh0KSAmJiAodGhpcy5PdS5uZXh0KHQpLCBlID0gITApIDogdGhpcy5MdSh0LCB0aGlzLm9ubGluZVN0YXRlKSAmJiAodGhpcy5xdSh0KSwgXG4gICAgICAgIGUgPSAhMCksIHRoaXMuRnUgPSB0LCBlO1xuICAgIH1cbiAgICBvbkVycm9yKHQpIHtcbiAgICAgICAgdGhpcy5PdS5lcnJvcih0KTtcbiAgICB9XG4gICAgLyoqIFJldHVybnMgd2hldGhlciBhIHNuYXBzaG90IHdhcyByYWlzZWQuICovICAgIGt1KHQpIHtcbiAgICAgICAgdGhpcy5vbmxpbmVTdGF0ZSA9IHQ7XG4gICAgICAgIGxldCBlID0gITE7XG4gICAgICAgIHJldHVybiB0aGlzLkZ1ICYmICF0aGlzLiR1ICYmIHRoaXMuTHUodGhpcy5GdSwgdCkgJiYgKHRoaXMucXUodGhpcy5GdSksIGUgPSAhMCksIFxuICAgICAgICBlO1xuICAgIH1cbiAgICBMdSh0LCBlKSB7XG4gICAgICAgIC8vIEFsd2F5cyByYWlzZSB0aGUgZmlyc3QgZXZlbnQgd2hlbiB3ZSdyZSBzeW5jZWRcbiAgICAgICAgaWYgKCF0LmZyb21DYWNoZSkgcmV0dXJuICEwO1xuICAgICAgICAvLyBOT1RFOiBXZSBjb25zaWRlciBPbmxpbmVTdGF0ZS5Vbmtub3duIGFzIG9ubGluZSAoaXQgc2hvdWxkIGJlY29tZSBPZmZsaW5lXG4gICAgICAgIC8vIG9yIE9ubGluZSBpZiB3ZSB3YWl0IGxvbmcgZW5vdWdoKS5cbiAgICAgICAgICAgICAgICBjb25zdCBuID0gXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyAhPT0gZTtcbiAgICAgICAgLy8gRG9uJ3QgcmFpc2UgdGhlIGV2ZW50IGlmIHdlJ3JlIG9ubGluZSwgYXJlbid0IHN5bmNlZCB5ZXQgKGNoZWNrZWRcbiAgICAgICAgLy8gYWJvdmUpIGFuZCBhcmUgd2FpdGluZyBmb3IgYSBzeW5jLlxuICAgICAgICAgICAgICAgIHJldHVybiAoIXRoaXMub3B0aW9ucy5VdSB8fCAhbikgJiYgKCF0LmRvY3MuaXNFbXB0eSgpIHx8IHQuaGFzQ2FjaGVkUmVzdWx0cyB8fCBcIk9mZmxpbmVcIiAvKiBPbmxpbmVTdGF0ZS5PZmZsaW5lICovID09PSBlKTtcbiAgICAgICAgLy8gUmFpc2UgZGF0YSBmcm9tIGNhY2hlIGlmIHdlIGhhdmUgYW55IGRvY3VtZW50cywgaGF2ZSBjYWNoZWQgcmVzdWx0cyBiZWZvcmUsXG4gICAgICAgIC8vIG9yIHdlIGFyZSBvZmZsaW5lLlxuICAgICAgICB9XG4gICAgQnUodCkge1xuICAgICAgICAvLyBXZSBkb24ndCBuZWVkIHRvIGhhbmRsZSBpbmNsdWRlRG9jdW1lbnRNZXRhZGF0YUNoYW5nZXMgaGVyZSBiZWNhdXNlXG4gICAgICAgIC8vIHRoZSBNZXRhZGF0YSBvbmx5IGNoYW5nZXMgaGF2ZSBhbHJlYWR5IGJlZW4gc3RyaXBwZWQgb3V0IGlmIG5lZWRlZC5cbiAgICAgICAgLy8gQXQgdGhpcyBwb2ludCB0aGUgb25seSBjaGFuZ2VzIHdlIHdpbGwgc2VlIGFyZSB0aGUgb25lcyB3ZSBzaG91bGRcbiAgICAgICAgLy8gcHJvcGFnYXRlLlxuICAgICAgICBpZiAodC5kb2NDaGFuZ2VzLmxlbmd0aCA+IDApIHJldHVybiAhMDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuRnUgJiYgdGhpcy5GdS5oYXNQZW5kaW5nV3JpdGVzICE9PSB0Lmhhc1BlbmRpbmdXcml0ZXM7XG4gICAgICAgIHJldHVybiAhKCF0LnN5bmNTdGF0ZUNoYW5nZWQgJiYgIWUpICYmICEwID09PSB0aGlzLm9wdGlvbnMuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgLy8gR2VuZXJhbGx5IHdlIHNob3VsZCBoYXZlIGhpdCBvbmUgb2YgdGhlIGNhc2VzIGFib3ZlLCBidXQgaXQncyBwb3NzaWJsZVxuICAgICAgICAvLyB0byBnZXQgaGVyZSBpZiB0aGVyZSB3ZXJlIG9ubHkgbWV0YWRhdGEgZG9jQ2hhbmdlcyBhbmQgdGhleSBnb3RcbiAgICAgICAgLy8gc3RyaXBwZWQgb3V0LlxuICAgICAgICB9XG4gICAgcXUodCkge1xuICAgICAgICB0ID0gdmMuZnJvbUluaXRpYWxEb2N1bWVudHModC5xdWVyeSwgdC5kb2NzLCB0Lm11dGF0ZWRLZXlzLCB0LmZyb21DYWNoZSwgdC5oYXNDYWNoZWRSZXN1bHRzKSwgXG4gICAgICAgIHRoaXMuJHUgPSAhMCwgdGhpcy5PdS5uZXh0KHQpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjb21wbGV0ZSBlbGVtZW50IGluIHRoZSBidW5kbGUgc3RyZWFtLCB0b2dldGhlciB3aXRoIHRoZSBieXRlIGxlbmd0aCBpdFxuICogb2NjdXBpZXMgaW4gdGhlIHN0cmVhbS5cbiAqLyBjbGFzcyBrYyB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLy8gSG93IG1hbnkgYnl0ZXMgdGhpcyBlbGVtZW50IHRha2VzIHRvIHN0b3JlIGluIHRoZSBidW5kbGUuXG4gICAgZSkge1xuICAgICAgICB0aGlzLkt1ID0gdCwgdGhpcy5ieXRlTGVuZ3RoID0gZTtcbiAgICB9XG4gICAgR3UoKSB7XG4gICAgICAgIHJldHVybiBcIm1ldGFkYXRhXCIgaW4gdGhpcy5LdTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhlbHBlciB0byBjb252ZXJ0IG9iamVjdHMgZnJvbSBidW5kbGVzIHRvIG1vZGVsIG9iamVjdHMgaW4gdGhlIFNESy5cbiAqLyBjbGFzcyBNYyB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSB0O1xuICAgIH1cbiAgICBpcih0KSB7XG4gICAgICAgIHJldHVybiAkaSh0aGlzLnNlcmlhbGl6ZXIsIHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0cyBhIEJ1bmRsZURvY3VtZW50IHRvIGEgTXV0YWJsZURvY3VtZW50LlxuICAgICAqLyAgICBycih0KSB7XG4gICAgICAgIHJldHVybiB0Lm1ldGFkYXRhLmV4aXN0cyA/IEtpKHRoaXMuc2VyaWFsaXplciwgdC5kb2N1bWVudCwgITEpIDogYW4ubmV3Tm9Eb2N1bWVudCh0aGlzLmlyKHQubWV0YWRhdGEubmFtZSksIHRoaXMudXIodC5tZXRhZGF0YS5yZWFkVGltZSkpO1xuICAgIH1cbiAgICB1cih0KSB7XG4gICAgICAgIHJldHVybiBOaSh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBjbGFzcyB0byBwcm9jZXNzIHRoZSBlbGVtZW50cyBmcm9tIGEgYnVuZGxlLCBsb2FkIHRoZW0gaW50byBsb2NhbFxuICogc3RvcmFnZSBhbmQgcHJvdmlkZSBwcm9ncmVzcyB1cGRhdGUgd2hpbGUgbG9hZGluZy5cbiAqLyBjbGFzcyBPYyB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLlF1ID0gdCwgdGhpcy5sb2NhbFN0b3JlID0gZSwgdGhpcy5zZXJpYWxpemVyID0gbiwgXG4gICAgICAgIC8qKiBCYXRjaGVkIHF1ZXJpZXMgdG8gYmUgc2F2ZWQgaW50byBzdG9yYWdlICovXG4gICAgICAgIHRoaXMucXVlcmllcyA9IFtdLCBcbiAgICAgICAgLyoqIEJhdGNoZWQgZG9jdW1lbnRzIHRvIGJlIHNhdmVkIGludG8gc3RvcmFnZSAqL1xuICAgICAgICB0aGlzLmRvY3VtZW50cyA9IFtdLCBcbiAgICAgICAgLyoqIFRoZSBjb2xsZWN0aW9uIGdyb3VwcyBhZmZlY3RlZCBieSB0aGlzIGJ1bmRsZS4gKi9cbiAgICAgICAgdGhpcy5jb2xsZWN0aW9uR3JvdXBzID0gbmV3IFNldCwgdGhpcy5wcm9ncmVzcyA9ICRjKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGFuIGVsZW1lbnQgZnJvbSB0aGUgYnVuZGxlIHRvIHRoZSBsb2FkZXIuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgbmV3IHByb2dyZXNzIGlmIGFkZGluZyB0aGUgZWxlbWVudCBsZWFkcyB0byBhIG5ldyBwcm9ncmVzcyxcbiAgICAgKiBvdGhlcndpc2UgcmV0dXJucyBudWxsLlxuICAgICAqLyAgICBqdSh0KSB7XG4gICAgICAgIHRoaXMucHJvZ3Jlc3MuYnl0ZXNMb2FkZWQgKz0gdC5ieXRlTGVuZ3RoO1xuICAgICAgICBsZXQgZSA9IHRoaXMucHJvZ3Jlc3MuZG9jdW1lbnRzTG9hZGVkO1xuICAgICAgICBpZiAodC5LdS5uYW1lZFF1ZXJ5KSB0aGlzLnF1ZXJpZXMucHVzaCh0Lkt1Lm5hbWVkUXVlcnkpOyBlbHNlIGlmICh0Lkt1LmRvY3VtZW50TWV0YWRhdGEpIHtcbiAgICAgICAgICAgIHRoaXMuZG9jdW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiB0Lkt1LmRvY3VtZW50TWV0YWRhdGFcbiAgICAgICAgICAgIH0pLCB0Lkt1LmRvY3VtZW50TWV0YWRhdGEuZXhpc3RzIHx8ICsrZTtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB1dC5mcm9tU3RyaW5nKHQuS3UuZG9jdW1lbnRNZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIHRoaXMuY29sbGVjdGlvbkdyb3Vwcy5hZGQobi5nZXQobi5sZW5ndGggLSAyKSk7XG4gICAgICAgIH0gZWxzZSB0Lkt1LmRvY3VtZW50ICYmICh0aGlzLmRvY3VtZW50c1t0aGlzLmRvY3VtZW50cy5sZW5ndGggLSAxXS5kb2N1bWVudCA9IHQuS3UuZG9jdW1lbnQsIFxuICAgICAgICArK2UpO1xuICAgICAgICByZXR1cm4gZSAhPT0gdGhpcy5wcm9ncmVzcy5kb2N1bWVudHNMb2FkZWQgPyAodGhpcy5wcm9ncmVzcy5kb2N1bWVudHNMb2FkZWQgPSBlLCBcbiAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5wcm9ncmVzcykpIDogbnVsbDtcbiAgICB9XG4gICAgenUodCkge1xuICAgICAgICBjb25zdCBlID0gbmV3IE1hcCwgbiA9IG5ldyBNYyh0aGlzLnNlcmlhbGl6ZXIpO1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2YgdCkgaWYgKHMubWV0YWRhdGEucXVlcmllcykge1xuICAgICAgICAgICAgY29uc3QgdCA9IG4uaXIocy5tZXRhZGF0YS5uYW1lKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgbiBvZiBzLm1ldGFkYXRhLnF1ZXJpZXMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzID0gKGUuZ2V0KG4pIHx8IGdzKCkpLmFkZCh0KTtcbiAgICAgICAgICAgICAgICBlLnNldChuLCBzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBwcm9ncmVzcyB0byAnU3VjY2VzcycgYW5kIHJldHVybiB0aGUgdXBkYXRlZCBwcm9ncmVzcy5cbiAgICAgKi8gICAgYXN5bmMgY29tcGxldGUoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBtdSh0aGlzLmxvY2FsU3RvcmUsIG5ldyBNYyh0aGlzLnNlcmlhbGl6ZXIpLCB0aGlzLmRvY3VtZW50cywgdGhpcy5RdS5pZCksIGUgPSB0aGlzLnp1KHRoaXMuZG9jdW1lbnRzKTtcbiAgICAgICAgZm9yIChjb25zdCB0IG9mIHRoaXMucXVlcmllcykgYXdhaXQgZ3UodGhpcy5sb2NhbFN0b3JlLCB0LCBlLmdldCh0Lm5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvZ3Jlc3MudGFza1N0YXRlID0gXCJTdWNjZXNzXCIsIHtcbiAgICAgICAgICAgIHByb2dyZXNzOiB0aGlzLnByb2dyZXNzLFxuICAgICAgICAgICAgV3U6IHRoaXMuY29sbGVjdGlvbkdyb3VwcyxcbiAgICAgICAgICAgIEh1OiB0XG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBgTG9hZEJ1bmRsZVRhc2tQcm9ncmVzc2AgcmVwcmVzZW50aW5nIHRoZSBpbml0aWFsIHByb2dyZXNzIG9mXG4gKiBsb2FkaW5nIGEgYnVuZGxlLlxuICovIGZ1bmN0aW9uICRjKHQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB0YXNrU3RhdGU6IFwiUnVubmluZ1wiLFxuICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IDAsXG4gICAgICAgIGJ5dGVzTG9hZGVkOiAwLFxuICAgICAgICB0b3RhbERvY3VtZW50czogdC50b3RhbERvY3VtZW50cyxcbiAgICAgICAgdG90YWxCeXRlczogdC50b3RhbEJ5dGVzXG4gICAgfTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgYExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3NgIHJlcHJlc2VudGluZyB0aGUgcHJvZ3Jlc3MgdGhhdCB0aGUgbG9hZGluZ1xuICogaGFzIHN1Y2NlZWRlZC5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbmNsYXNzIEZjIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua2V5ID0gdDtcbiAgICB9XG59XG5cbmNsYXNzIEJjIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua2V5ID0gdDtcbiAgICB9XG59XG5cbi8qKlxuICogVmlldyBpcyByZXNwb25zaWJsZSBmb3IgY29tcHV0aW5nIHRoZSBmaW5hbCBtZXJnZWQgdHJ1dGggb2Ygd2hhdCBkb2NzIGFyZSBpblxuICogYSBxdWVyeS4gSXQgZ2V0cyBub3RpZmllZCBvZiBsb2NhbCBhbmQgcmVtb3RlIGNoYW5nZXMgdG8gZG9jcywgYW5kIGFwcGxpZXNcbiAqIHRoZSBxdWVyeSBmaWx0ZXJzIGFuZCBsaW1pdHMgdG8gZGV0ZXJtaW5lIHRoZSBtb3N0IGNvcnJlY3QgcG9zc2libGUgcmVzdWx0cy5cbiAqLyBjbGFzcyBMYyB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqIERvY3VtZW50cyBpbmNsdWRlZCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xuICAgIGUpIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMuSnUgPSBlLCB0aGlzLll1ID0gbnVsbCwgdGhpcy5oYXNDYWNoZWRSZXN1bHRzID0gITEsIFxuICAgICAgICAvKipcbiAgICAgICAgICogQSBmbGFnIHdoZXRoZXIgdGhlIHZpZXcgaXMgY3VycmVudCB3aXRoIHRoZSBiYWNrZW5kLiBBIHZpZXcgaXMgY29uc2lkZXJlZFxuICAgICAgICAgKiBjdXJyZW50IGFmdGVyIGl0IGhhcyBzZWVuIHRoZSBjdXJyZW50IGZsYWcgZnJvbSB0aGUgYmFja2VuZCBhbmQgZGlkIG5vdFxuICAgICAgICAgKiBsb3NlIGNvbnNpc3RlbmN5IHdpdGhpbiB0aGUgd2F0Y2ggc3RyZWFtIChlLmcuIGJlY2F1c2Ugb2YgYW4gZXhpc3RlbmNlXG4gICAgICAgICAqIGZpbHRlciBtaXNtYXRjaCkuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmN1cnJlbnQgPSAhMSwgXG4gICAgICAgIC8qKiBEb2N1bWVudHMgaW4gdGhlIHZpZXcgYnV0IG5vdCBpbiB0aGUgcmVtb3RlIHRhcmdldCAqL1xuICAgICAgICB0aGlzLlh1ID0gZ3MoKSwgXG4gICAgICAgIC8qKiBEb2N1bWVudCBLZXlzIHRoYXQgaGF2ZSBsb2NhbCBjaGFuZ2VzICovXG4gICAgICAgIHRoaXMubXV0YXRlZEtleXMgPSBncygpLCB0aGlzLlp1ID0gaXModCksIHRoaXMudGMgPSBuZXcgQWModGhpcy5adSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBzZXQgb2YgcmVtb3RlIGRvY3VtZW50cyB0aGF0IHRoZSBzZXJ2ZXIgaGFzIHRvbGQgdXMgYmVsb25ncyB0byB0aGUgdGFyZ2V0IGFzc29jaWF0ZWQgd2l0aFxuICAgICAqIHRoaXMgdmlldy5cbiAgICAgKi8gICAgZ2V0IGVjKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5KdTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSXRlcmF0ZXMgb3ZlciBhIHNldCBvZiBkb2MgY2hhbmdlcywgYXBwbGllcyB0aGUgcXVlcnkgbGltaXQsIGFuZCBjb21wdXRlc1xuICAgICAqIHdoYXQgdGhlIG5ldyByZXN1bHRzIHNob3VsZCBiZSwgd2hhdCB0aGUgY2hhbmdlcyB3ZXJlLCBhbmQgd2hldGhlciB3ZSBtYXlcbiAgICAgKiBuZWVkIHRvIGdvIGJhY2sgdG8gdGhlIGxvY2FsIGNhY2hlIGZvciBtb3JlIHJlc3VsdHMuIERvZXMgbm90IG1ha2UgYW55XG4gICAgICogY2hhbmdlcyB0byB0aGUgdmlldy5cbiAgICAgKiBAcGFyYW0gZG9jQ2hhbmdlcyAtIFRoZSBkb2MgY2hhbmdlcyB0byBhcHBseSB0byB0aGlzIHZpZXcuXG4gICAgICogQHBhcmFtIHByZXZpb3VzQ2hhbmdlcyAtIElmIHRoaXMgaXMgYmVpbmcgY2FsbGVkIHdpdGggYSByZWZpbGwsIHRoZW4gc3RhcnRcbiAgICAgKiAgICAgICAgd2l0aCB0aGlzIHNldCBvZiBkb2NzIGFuZCBjaGFuZ2VzIGluc3RlYWQgb2YgdGhlIGN1cnJlbnQgdmlldy5cbiAgICAgKiBAcmV0dXJucyBhIG5ldyBzZXQgb2YgZG9jcywgY2hhbmdlcywgYW5kIHJlZmlsbCBmbGFnLlxuICAgICAqLyAgICBuYyh0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBlID8gZS5zYyA6IG5ldyBSYywgcyA9IGUgPyBlLnRjIDogdGhpcy50YztcbiAgICAgICAgbGV0IGkgPSBlID8gZS5tdXRhdGVkS2V5cyA6IHRoaXMubXV0YXRlZEtleXMsIHIgPSBzLCBvID0gITE7XG4gICAgICAgIC8vIFRyYWNrIHRoZSBsYXN0IGRvYyBpbiBhIChmdWxsKSBsaW1pdC4gVGhpcyBpcyBuZWNlc3NhcnksIGJlY2F1c2Ugc29tZVxuICAgICAgICAvLyB1cGRhdGUgKGEgZGVsZXRlLCBvciBhbiB1cGRhdGUgbW92aW5nIGEgZG9jIHBhc3QgdGhlIG9sZCBsaW1pdCkgbWlnaHRcbiAgICAgICAgLy8gbWVhbiB0aGVyZSBpcyBzb21lIG90aGVyIGRvY3VtZW50IGluIHRoZSBsb2NhbCBjYWNoZSB0aGF0IGVpdGhlciBzaG91bGRcbiAgICAgICAgLy8gY29tZSAoMSkgYmV0d2VlbiB0aGUgb2xkIGxhc3QgbGltaXQgZG9jIGFuZCB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZVxuICAgICAgICAvLyBjYXNlIG9mIHVwZGF0ZXMsIG9yICgyKSBhZnRlciB0aGUgbmV3IGxhc3QgZG9jdW1lbnQsIGluIHRoZSBjYXNlIG9mXG4gICAgICAgIC8vIGRlbGV0ZXMuIFNvIHdlIGtlZXAgdGhpcyBkb2MgYXQgdGhlIG9sZCBsaW1pdCB0byBjb21wYXJlIHRoZSB1cGRhdGVzIHRvLlxuICAgICAgICAvLyBOb3RlIHRoYXQgdGhpcyBzaG91bGQgbmV2ZXIgZ2V0IHVzZWQgaW4gYSByZWZpbGwgKHdoZW4gcHJldmlvdXNDaGFuZ2VzIGlzXG4gICAgICAgIC8vIHNldCksIGJlY2F1c2UgdGhlcmUgd2lsbCBvbmx5IGJlIGFkZHMgLS0gbm8gZGVsZXRlcyBvciB1cGRhdGVzLlxuICAgICAgICBjb25zdCB1ID0gXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovID09PSB0aGlzLnF1ZXJ5LmxpbWl0VHlwZSAmJiBzLnNpemUgPT09IHRoaXMucXVlcnkubGltaXQgPyBzLmxhc3QoKSA6IG51bGwsIGMgPSBcIkxcIiAvKiBMaW1pdFR5cGUuTGFzdCAqLyA9PT0gdGhpcy5xdWVyeS5saW1pdFR5cGUgJiYgcy5zaXplID09PSB0aGlzLnF1ZXJ5LmxpbWl0ID8gcy5maXJzdCgpIDogbnVsbDtcbiAgICAgICAgLy8gRHJvcCBkb2N1bWVudHMgb3V0IHRvIG1lZXQgbGltaXQvbGltaXRUb0xhc3QgcmVxdWlyZW1lbnQuXG4gICAgICAgIGlmICh0Lmlub3JkZXJUcmF2ZXJzYWwoKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBhID0gcy5nZXQodCksIGggPSBucyh0aGlzLnF1ZXJ5LCBlKSA/IGUgOiBudWxsLCBsID0gISFhICYmIHRoaXMubXV0YXRlZEtleXMuaGFzKGEua2V5KSwgZiA9ICEhaCAmJiAoaC5oYXNMb2NhbE11dGF0aW9ucyB8fCBcbiAgICAgICAgICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgY29tbWl0dGVkIG11dGF0aW9ucyBmb3IgZG9jdW1lbnRzIHRoYXQgd2VyZVxuICAgICAgICAgICAgLy8gbXV0YXRlZCBkdXJpbmcgdGhlIGxpZmV0aW1lIG9mIHRoZSB2aWV3LlxuICAgICAgICAgICAgdGhpcy5tdXRhdGVkS2V5cy5oYXMoaC5rZXkpICYmIGguaGFzQ29tbWl0dGVkTXV0YXRpb25zKTtcbiAgICAgICAgICAgIGxldCBkID0gITE7XG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgY2hhbmdlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYSAmJiBoKSB7XG4gICAgICAgICAgICAgICAgYS5kYXRhLmlzRXF1YWwoaC5kYXRhKSA/IGwgIT09IGYgJiYgKG4udHJhY2soe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAzIC8qIENoYW5nZVR5cGUuTWV0YWRhdGEgKi8gLFxuICAgICAgICAgICAgICAgICAgICBkb2M6IGhcbiAgICAgICAgICAgICAgICB9KSwgZCA9ICEwKSA6IHRoaXMuaWMoYSwgaCkgfHwgKG4udHJhY2soe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiAyIC8qIENoYW5nZVR5cGUuTW9kaWZpZWQgKi8gLFxuICAgICAgICAgICAgICAgICAgICBkb2M6IGhcbiAgICAgICAgICAgICAgICB9KSwgZCA9ICEwLCAodSAmJiB0aGlzLlp1KGgsIHUpID4gMCB8fCBjICYmIHRoaXMuWnUoaCwgYykgPCAwKSAmJiAoXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBkb2MgbW92ZWQgZnJvbSBpbnNpZGUgdGhlIGxpbWl0IHRvIG91dHNpZGUgdGhlIGxpbWl0LlxuICAgICAgICAgICAgICAgIC8vIFRoYXQgbWVhbnMgdGhlcmUgbWF5IGJlIHNvbWUgb3RoZXIgZG9jIGluIHRoZSBsb2NhbCBjYWNoZVxuICAgICAgICAgICAgICAgIC8vIHRoYXQgc2hvdWxkIGJlIGluY2x1ZGVkIGluc3RlYWQuXG4gICAgICAgICAgICAgICAgbyA9ICEwKSk7XG4gICAgICAgICAgICB9IGVsc2UgIWEgJiYgaCA/IChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogaFxuICAgICAgICAgICAgfSksIGQgPSAhMCkgOiBhICYmICFoICYmIChuLnRyYWNrKHtcbiAgICAgICAgICAgICAgICB0eXBlOiAxIC8qIENoYW5nZVR5cGUuUmVtb3ZlZCAqLyAsXG4gICAgICAgICAgICAgICAgZG9jOiBhXG4gICAgICAgICAgICB9KSwgZCA9ICEwLCAodSB8fCBjKSAmJiAoXG4gICAgICAgICAgICAvLyBBIGRvYyB3YXMgcmVtb3ZlZCBmcm9tIGEgZnVsbCBsaW1pdCBxdWVyeS4gV2UnbGwgbmVlZCB0b1xuICAgICAgICAgICAgLy8gcmVxdWVyeSBmcm9tIHRoZSBsb2NhbCBjYWNoZSB0byBzZWUgaWYgd2Uga25vdyBhYm91dCBzb21lIG90aGVyXG4gICAgICAgICAgICAvLyBkb2MgdGhhdCBzaG91bGQgYmUgaW4gdGhlIHJlc3VsdHMuXG4gICAgICAgICAgICBvID0gITApKTtcbiAgICAgICAgICAgIGQgJiYgKGggPyAociA9IHIuYWRkKGgpLCBpID0gZiA/IGkuYWRkKHQpIDogaS5kZWxldGUodCkpIDogKHIgPSByLmRlbGV0ZSh0KSwgaSA9IGkuZGVsZXRlKHQpKSk7XG4gICAgICAgIH0pKSwgbnVsbCAhPT0gdGhpcy5xdWVyeS5saW1pdCkgZm9yICg7ci5zaXplID4gdGhpcy5xdWVyeS5saW1pdDsgKSB7XG4gICAgICAgICAgICBjb25zdCB0ID0gXCJGXCIgLyogTGltaXRUeXBlLkZpcnN0ICovID09PSB0aGlzLnF1ZXJ5LmxpbWl0VHlwZSA/IHIubGFzdCgpIDogci5maXJzdCgpO1xuICAgICAgICAgICAgciA9IHIuZGVsZXRlKHQua2V5KSwgaSA9IGkuZGVsZXRlKHQua2V5KSwgbi50cmFjayh7XG4gICAgICAgICAgICAgICAgdHlwZTogMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gLFxuICAgICAgICAgICAgICAgIGRvYzogdFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRjOiByLFxuICAgICAgICAgICAgc2M6IG4sXG4gICAgICAgICAgICBqaTogbyxcbiAgICAgICAgICAgIG11dGF0ZWRLZXlzOiBpXG4gICAgICAgIH07XG4gICAgfVxuICAgIGljKHQsIGUpIHtcbiAgICAgICAgLy8gV2Ugc3VwcHJlc3MgdGhlIGluaXRpYWwgY2hhbmdlIGV2ZW50IGZvciBkb2N1bWVudHMgdGhhdCB3ZXJlIG1vZGlmaWVkIGFzXG4gICAgICAgIC8vIHBhcnQgb2YgYSB3cml0ZSBhY2tub3dsZWRnbWVudCAoZS5nLiB3aGVuIHRoZSB2YWx1ZSBvZiBhIHNlcnZlciB0cmFuc2Zvcm1cbiAgICAgICAgLy8gaXMgYXBwbGllZCkgYXMgV2F0Y2ggd2lsbCBzZW5kIHVzIHRoZSBzYW1lIGRvY3VtZW50IGFnYWluLlxuICAgICAgICAvLyBCeSBzdXBwcmVzc2luZyB0aGUgZXZlbnQsIHdlIG9ubHkgcmFpc2UgdHdvIHVzZXIgdmlzaWJsZSBldmVudHMgKG9uZSB3aXRoXG4gICAgICAgIC8vIGBoYXNQZW5kaW5nV3JpdGVzYCBhbmQgdGhlIGZpbmFsIHN0YXRlIG9mIHRoZSBkb2N1bWVudCkgaW5zdGVhZCBvZiB0aHJlZVxuICAgICAgICAvLyAob25lIHdpdGggYGhhc1BlbmRpbmdXcml0ZXNgLCB0aGUgbW9kaWZpZWQgZG9jdW1lbnQgd2l0aFxuICAgICAgICAvLyBgaGFzUGVuZGluZ1dyaXRlc2AgYW5kIHRoZSBmaW5hbCBzdGF0ZSBvZiB0aGUgZG9jdW1lbnQpLlxuICAgICAgICByZXR1cm4gdC5oYXNMb2NhbE11dGF0aW9ucyAmJiBlLmhhc0NvbW1pdHRlZE11dGF0aW9ucyAmJiAhZS5oYXNMb2NhbE11dGF0aW9ucztcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlcyB0aGUgdmlldyB3aXRoIHRoZSBnaXZlbiBWaWV3RG9jdW1lbnRDaGFuZ2VzIGFuZCBvcHRpb25hbGx5IHVwZGF0ZXNcbiAgICAgKiBsaW1ibyBkb2NzIGFuZCBzeW5jIHN0YXRlIGZyb20gdGhlIHByb3ZpZGVkIHRhcmdldCBjaGFuZ2UuXG4gICAgICogQHBhcmFtIGRvY0NoYW5nZXMgLSBUaGUgc2V0IG9mIGNoYW5nZXMgdG8gbWFrZSB0byB0aGUgdmlldydzIGRvY3MuXG4gICAgICogQHBhcmFtIHVwZGF0ZUxpbWJvRG9jdW1lbnRzIC0gV2hldGhlciB0byB1cGRhdGUgbGltYm8gZG9jdW1lbnRzIGJhc2VkIG9uXG4gICAgICogICAgICAgIHRoaXMgY2hhbmdlLlxuICAgICAqIEBwYXJhbSB0YXJnZXRDaGFuZ2UgLSBBIHRhcmdldCBjaGFuZ2UgdG8gYXBwbHkgZm9yIGNvbXB1dGluZyBsaW1ibyBkb2NzIGFuZFxuICAgICAqICAgICAgICBzeW5jIHN0YXRlLlxuICAgICAqIEByZXR1cm5zIEEgbmV3IFZpZXdDaGFuZ2Ugd2l0aCB0aGUgZ2l2ZW4gZG9jcywgY2hhbmdlcywgYW5kIHN5bmMgc3RhdGUuXG4gICAgICovXG4gICAgLy8gUE9SVElORyBOT1RFOiBUaGUgaU9TL0FuZHJvaWQgY2xpZW50cyBhbHdheXMgY29tcHV0ZSBsaW1ibyBkb2N1bWVudCBjaGFuZ2VzLlxuICAgIGFwcGx5Q2hhbmdlcyh0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLnRjO1xuICAgICAgICB0aGlzLnRjID0gdC50YywgdGhpcy5tdXRhdGVkS2V5cyA9IHQubXV0YXRlZEtleXM7XG4gICAgICAgIC8vIFNvcnQgY2hhbmdlcyBiYXNlZCBvbiB0eXBlIGFuZCBxdWVyeSBjb21wYXJhdG9yXG4gICAgICAgIGNvbnN0IGkgPSB0LnNjLkN1KCk7XG4gICAgICAgIGkuc29ydCgoKHQsIGUpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0ID0+IHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICAgIGNhc2UgMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovIDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG5cbiAgICAgICAgICAgICAgICAgIGNhc2UgMiAvKiBDaGFuZ2VUeXBlLk1vZGlmaWVkICovIDpcbiAgICAgICAgICAgICAgICAgIGNhc2UgMyAvKiBDaGFuZ2VUeXBlLk1ldGFkYXRhICovIDpcbiAgICAgICAgICAgICAgICAgICAgLy8gQSBtZXRhZGF0YSBjaGFuZ2UgaXMgY29udmVydGVkIHRvIGEgbW9kaWZpZWQgY2hhbmdlIGF0IHRoZSBwdWJsaWNcbiAgICAgICAgICAgICAgICAgICAgLy8gYXBpIGxheWVyLiAgU2luY2Ugd2Ugc29ydCBieSBkb2N1bWVudCBrZXkgYW5kIHRoZW4gY2hhbmdlIHR5cGUsXG4gICAgICAgICAgICAgICAgICAgIC8vIG1ldGFkYXRhIGFuZCBtb2RpZmllZCBjaGFuZ2VzIG11c3QgYmUgc29ydGVkIGVxdWl2YWxlbnRseS5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDI7XG5cbiAgICAgICAgICAgICAgICAgIGNhc2UgMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gOlxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcblxuICAgICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgcmV0dXJuIG4odCkgLSBuKGUpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovICh0LnR5cGUsIGUudHlwZSkgfHwgdGhpcy5adSh0LmRvYywgZS5kb2MpKSksIHRoaXMucmMobik7XG4gICAgICAgIGNvbnN0IHIgPSBlID8gdGhpcy5vYygpIDogW10sIG8gPSAwID09PSB0aGlzLlh1LnNpemUgJiYgdGhpcy5jdXJyZW50ID8gMSAvKiBTeW5jU3RhdGUuU3luY2VkICovIDogMCAvKiBTeW5jU3RhdGUuTG9jYWwgKi8gLCB1ID0gbyAhPT0gdGhpcy5ZdTtcbiAgICAgICAgaWYgKHRoaXMuWXUgPSBvLCAwICE9PSBpLmxlbmd0aCB8fCB1KSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHNuYXBzaG90OiBuZXcgdmModGhpcy5xdWVyeSwgdC50YywgcywgaSwgdC5tdXRhdGVkS2V5cywgMCAvKiBTeW5jU3RhdGUuTG9jYWwgKi8gPT09IG8sIHUsIFxuICAgICAgICAgICAgICAgIC8qIGV4Y2x1ZGVzTWV0YWRhdGFDaGFuZ2VzPSAqLyAhMSwgISFuICYmIG4ucmVzdW1lVG9rZW4uYXBwcm94aW1hdGVCeXRlU2l6ZSgpID4gMCksXG4gICAgICAgICAgICAgICAgdWM6IHJcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgLy8gbm8gY2hhbmdlc1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdWM6IHJcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQXBwbGllcyBhbiBPbmxpbmVTdGF0ZSBjaGFuZ2UgdG8gdGhlIHZpZXcsIHBvdGVudGlhbGx5IGdlbmVyYXRpbmcgYVxuICAgICAqIFZpZXdDaGFuZ2UgaWYgdGhlIHZpZXcncyBzeW5jU3RhdGUgY2hhbmdlcyBhcyBhIHJlc3VsdC5cbiAgICAgKi8gICAga3UodCkge1xuICAgICAgICByZXR1cm4gdGhpcy5jdXJyZW50ICYmIFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8gPT09IHQgPyAoXG4gICAgICAgIC8vIElmIHdlJ3JlIG9mZmxpbmUsIHNldCBgY3VycmVudGAgdG8gZmFsc2UgYW5kIHRoZW4gY2FsbCBhcHBseUNoYW5nZXMoKVxuICAgICAgICAvLyB0byByZWZyZXNoIG91ciBzeW5jU3RhdGUgYW5kIGdlbmVyYXRlIGEgVmlld0NoYW5nZSBhcyBhcHByb3ByaWF0ZS4gV2VcbiAgICAgICAgLy8gYXJlIGd1YXJhbnRlZWQgdG8gZ2V0IGEgbmV3IFRhcmdldENoYW5nZSB0aGF0IHNldHMgYGN1cnJlbnRgIGJhY2sgdG9cbiAgICAgICAgLy8gdHJ1ZSBvbmNlIHRoZSBjbGllbnQgaXMgYmFjayBvbmxpbmUuXG4gICAgICAgIHRoaXMuY3VycmVudCA9ICExLCB0aGlzLmFwcGx5Q2hhbmdlcyh7XG4gICAgICAgICAgICB0YzogdGhpcy50YyxcbiAgICAgICAgICAgIHNjOiBuZXcgUmMsXG4gICAgICAgICAgICBtdXRhdGVkS2V5czogdGhpcy5tdXRhdGVkS2V5cyxcbiAgICAgICAgICAgIGppOiAhMVxuICAgICAgICB9LCBcbiAgICAgICAgLyogdXBkYXRlTGltYm9Eb2N1bWVudHM9ICovICExKSkgOiB7XG4gICAgICAgICAgICB1YzogW11cbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB3aGV0aGVyIHRoZSBkb2MgZm9yIHRoZSBnaXZlbiBrZXkgc2hvdWxkIGJlIGluIGxpbWJvLlxuICAgICAqLyAgICBjYyh0KSB7XG4gICAgICAgIC8vIElmIHRoZSByZW1vdGUgZW5kIHNheXMgaXQncyBwYXJ0IG9mIHRoaXMgcXVlcnksIGl0J3Mgbm90IGluIGxpbWJvLlxuICAgICAgICByZXR1cm4gIXRoaXMuSnUuaGFzKHQpICYmIChcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIGRvZXNuJ3QgdGhpbmsgaXQncyBhIHJlc3VsdCwgc28gaXQgc2hvdWxkbid0IGJlIGluIGxpbWJvLlxuICAgICAgICAhIXRoaXMudGMuaGFzKHQpICYmICF0aGlzLnRjLmdldCh0KS5oYXNMb2NhbE11dGF0aW9ucyk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFVwZGF0ZXMgc3luY2VkRG9jdW1lbnRzLCBjdXJyZW50LCBhbmQgbGltYm8gZG9jcyBiYXNlZCBvbiB0aGUgZ2l2ZW4gY2hhbmdlLlxuICAgICAqIFJldHVybnMgdGhlIGxpc3Qgb2YgY2hhbmdlcyB0byB3aGljaCBkb2NzIGFyZSBpbiBsaW1iby5cbiAgICAgKi8gICAgcmModCkge1xuICAgICAgICB0ICYmICh0LmFkZGVkRG9jdW1lbnRzLmZvckVhY2goKHQgPT4gdGhpcy5KdSA9IHRoaXMuSnUuYWRkKHQpKSksIHQubW9kaWZpZWREb2N1bWVudHMuZm9yRWFjaCgodCA9PiB7fSkpLCBcbiAgICAgICAgdC5yZW1vdmVkRG9jdW1lbnRzLmZvckVhY2goKHQgPT4gdGhpcy5KdSA9IHRoaXMuSnUuZGVsZXRlKHQpKSksIHRoaXMuY3VycmVudCA9IHQuY3VycmVudCk7XG4gICAgfVxuICAgIG9jKCkge1xuICAgICAgICAvLyBXZSBjYW4gb25seSBkZXRlcm1pbmUgbGltYm8gZG9jdW1lbnRzIHdoZW4gd2UncmUgaW4tc3luYyB3aXRoIHRoZSBzZXJ2ZXIuXG4gICAgICAgIGlmICghdGhpcy5jdXJyZW50KSByZXR1cm4gW107XG4gICAgICAgIC8vIFRPRE8oa2xpbXQpOiBEbyB0aGlzIGluY3JlbWVudGFsbHkgc28gdGhhdCBpdCdzIG5vdCBxdWFkcmF0aWMgd2hlblxuICAgICAgICAvLyB1cGRhdGluZyBtYW55IGRvY3VtZW50cy5cbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gdGhpcy5YdTtcbiAgICAgICAgdGhpcy5YdSA9IGdzKCksIHRoaXMudGMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLmNjKHQua2V5KSAmJiAodGhpcy5YdSA9IHRoaXMuWHUuYWRkKHQua2V5KSk7XG4gICAgICAgIH0pKTtcbiAgICAgICAgLy8gRGlmZiB0aGUgbmV3IGxpbWJvIGRvY3Mgd2l0aCB0aGUgb2xkIGxpbWJvIGRvY3MuXG4gICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgcmV0dXJuIHQuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICB0aGlzLlh1Lmhhcyh0KSB8fCBlLnB1c2gobmV3IEJjKHQpKTtcbiAgICAgICAgfSkpLCB0aGlzLlh1LmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgdC5oYXMobikgfHwgZS5wdXNoKG5ldyBGYyhuKSk7XG4gICAgICAgIH0pKSwgZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVXBkYXRlIHRoZSBpbi1tZW1vcnkgc3RhdGUgb2YgdGhlIGN1cnJlbnQgdmlldyB3aXRoIHRoZSBzdGF0ZSByZWFkIGZyb21cbiAgICAgKiBwZXJzaXN0ZW5jZS5cbiAgICAgKlxuICAgICAqIFdlIHVwZGF0ZSB0aGUgcXVlcnkgdmlldyB3aGVuZXZlciBhIGNsaWVudCdzIHByaW1hcnkgc3RhdHVzIGNoYW5nZXM6XG4gICAgICogLSBXaGVuIGEgY2xpZW50IHRyYW5zaXRpb25zIGZyb20gcHJpbWFyeSB0byBzZWNvbmRhcnksIGl0IGNhbiBtaXNzXG4gICAgICogICBMb2NhbFN0b3JhZ2UgdXBkYXRlcyBhbmQgaXRzIHF1ZXJ5IHZpZXdzIG1heSB0ZW1wb3JhcmlseSBub3QgYmVcbiAgICAgKiAgIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzdGF0ZSBvbiBkaXNrLlxuICAgICAqIC0gRm9yIHNlY29uZGFyeSB0byBwcmltYXJ5IHRyYW5zaXRpb25zLCB0aGUgY2xpZW50IG5lZWRzIHRvIHVwZGF0ZSB0aGUgbGlzdFxuICAgICAqICAgb2YgYHN5bmNlZERvY3VtZW50c2Agc2luY2Ugc2Vjb25kYXJ5IGNsaWVudHMgdXBkYXRlIHRoZWlyIHF1ZXJ5IHZpZXdzXG4gICAgICogICBiYXNlZCBwdXJlbHkgb24gc3ludGhlc2l6ZWQgUmVtb3RlRXZlbnRzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHF1ZXJ5UmVzdWx0LmRvY3VtZW50cyAtIFRoZSBkb2N1bWVudHMgdGhhdCBtYXRjaCB0aGUgcXVlcnkgYWNjb3JkaW5nXG4gICAgICogdG8gdGhlIExvY2FsU3RvcmUuXG4gICAgICogQHBhcmFtIHF1ZXJ5UmVzdWx0LnJlbW90ZUtleXMgLSBUaGUga2V5cyBvZiB0aGUgZG9jdW1lbnRzIHRoYXQgbWF0Y2ggdGhlXG4gICAgICogcXVlcnkgYWNjb3JkaW5nIHRvIHRoZSBiYWNrZW5kLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFZpZXdDaGFuZ2UgdGhhdCByZXN1bHRlZCBmcm9tIHRoaXMgc3luY2hyb25pemF0aW9uLlxuICAgICAqL1xuICAgIC8vIFBPUlRJTkcgTk9URTogTXVsdGktdGFiIG9ubHkuXG4gICAgYWModCkge1xuICAgICAgICB0aGlzLkp1ID0gdC5zciwgdGhpcy5YdSA9IGdzKCk7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLm5jKHQuZG9jdW1lbnRzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYXBwbHlDaGFuZ2VzKGUsIC8qdXBkYXRlTGltYm9Eb2N1bWVudHM9Ki8gITApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIGEgdmlldyBzbmFwc2hvdCBhcyBpZiB0aGlzIHF1ZXJ5IHdhcyBqdXN0IGxpc3RlbmVkIHRvLiBDb250YWluc1xuICAgICAqIGEgZG9jdW1lbnQgYWRkIGZvciBldmVyeSBleGlzdGluZyBkb2N1bWVudCBhbmQgdGhlIGBmcm9tQ2FjaGVgIGFuZFxuICAgICAqIGBoYXNQZW5kaW5nV3JpdGVzYCBzdGF0dXMgb2YgdGhlIGFscmVhZHkgZXN0YWJsaXNoZWQgdmlldy5cbiAgICAgKi9cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLXRhYiBvbmx5LlxuICAgIGhjKCkge1xuICAgICAgICByZXR1cm4gdmMuZnJvbUluaXRpYWxEb2N1bWVudHModGhpcy5xdWVyeSwgdGhpcy50YywgdGhpcy5tdXRhdGVkS2V5cywgMCAvKiBTeW5jU3RhdGUuTG9jYWwgKi8gPT09IHRoaXMuWXUsIHRoaXMuaGFzQ2FjaGVkUmVzdWx0cyk7XG4gICAgfVxufVxuXG4vKipcbiAqIFF1ZXJ5VmlldyBjb250YWlucyBhbGwgb2YgdGhlIGRhdGEgdGhhdCBTeW5jRW5naW5lIG5lZWRzIHRvIGtlZXAgdHJhY2sgb2YgZm9yXG4gKiBhIHBhcnRpY3VsYXIgcXVlcnkuXG4gKi9cbmNsYXNzIHFjIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKipcbiAgICAgKiBUaGUgcXVlcnkgaXRzZWxmLlxuICAgICAqL1xuICAgIHQsIFxuICAgIC8qKlxuICAgICAqIFRoZSB0YXJnZXQgbnVtYmVyIGNyZWF0ZWQgYnkgdGhlIGNsaWVudCB0aGF0IGlzIHVzZWQgaW4gdGhlIHdhdGNoXG4gICAgICogc3RyZWFtIHRvIGlkZW50aWZ5IHRoaXMgcXVlcnkuXG4gICAgICovXG4gICAgZSwgXG4gICAgLyoqXG4gICAgICogVGhlIHZpZXcgaXMgcmVzcG9uc2libGUgZm9yIGNvbXB1dGluZyB0aGUgZmluYWwgbWVyZ2VkIHRydXRoIG9mIHdoYXRcbiAgICAgKiBkb2NzIGFyZSBpbiB0aGUgcXVlcnkuIEl0IGdldHMgbm90aWZpZWQgb2YgbG9jYWwgYW5kIHJlbW90ZSBjaGFuZ2VzLFxuICAgICAqIGFuZCBhcHBsaWVzIHRoZSBxdWVyeSBmaWx0ZXJzIGFuZCBsaW1pdHMgdG8gZGV0ZXJtaW5lIHRoZSBtb3N0IGNvcnJlY3RcbiAgICAgKiBwb3NzaWJsZSByZXN1bHRzLlxuICAgICAqL1xuICAgIG4pIHtcbiAgICAgICAgdGhpcy5xdWVyeSA9IHQsIHRoaXMudGFyZ2V0SWQgPSBlLCB0aGlzLnZpZXcgPSBuO1xuICAgIH1cbn1cblxuLyoqIFRyYWNrcyBhIGxpbWJvIHJlc29sdXRpb24uICovIGNsYXNzIFVjIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua2V5ID0gdCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTZXQgdG8gdHJ1ZSBvbmNlIHdlJ3ZlIHJlY2VpdmVkIGEgZG9jdW1lbnQuIFRoaXMgaXMgdXNlZCBpblxuICAgICAgICAgKiBnZXRSZW1vdGVLZXlzRm9yVGFyZ2V0KCkgYW5kIHVsdGltYXRlbHkgdXNlZCBieSBXYXRjaENoYW5nZUFnZ3JlZ2F0b3IgdG9cbiAgICAgICAgICogZGVjaWRlIHdoZXRoZXIgaXQgbmVlZHMgdG8gbWFudWZhY3R1cmUgYSBkZWxldGUgZXZlbnQgZm9yIHRoZSB0YXJnZXQgb25jZVxuICAgICAgICAgKiB0aGUgdGFyZ2V0IGlzIENVUlJFTlQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmxjID0gITE7XG4gICAgfVxufVxuXG4vKipcbiAqIEFuIGltcGxlbWVudGF0aW9uIG9mIGBTeW5jRW5naW5lYCBjb29yZGluYXRpbmcgd2l0aCBvdGhlciBwYXJ0cyBvZiBTREsuXG4gKlxuICogVGhlIHBhcnRzIG9mIFN5bmNFbmdpbmUgdGhhdCBhY3QgYXMgYSBjYWxsYmFjayB0byBSZW1vdGVTdG9yZSBuZWVkIHRvIGJlXG4gKiByZWdpc3RlcmVkIGluZGl2aWR1YWxseS4gVGhpcyBpcyBkb25lIGluIGBzeW5jRW5naW5lV3JpdGUoKWAgYW5kXG4gKiBgc3luY0VuZ2luZUxpc3RlbigpYCAoYXMgd2VsbCBhcyBgYXBwbHlQcmltYXJ5U3RhdGUoKWApIGFzIHRoZXNlIG1ldGhvZHNcbiAqIHNlcnZlIGFzIGVudHJ5IHBvaW50cyB0byBSZW1vdGVTdG9yZSdzIGZ1bmN0aW9uYWxpdHkuXG4gKlxuICogTm90ZTogc29tZSBmaWVsZCBkZWZpbmVkIGluIHRoaXMgY2xhc3MgbWlnaHQgaGF2ZSBwdWJsaWMgYWNjZXNzIGxldmVsLCBidXRcbiAqIHRoZSBjbGFzcyBpcyBub3QgZXhwb3J0ZWQgc28gdGhleSBhcmUgb25seSBhY2Nlc3NpYmxlIGZyb20gdGhpcyBtb2R1bGUuXG4gKiBUaGlzIGlzIHVzZWZ1bCB0byBpbXBsZW1lbnQgb3B0aW9uYWwgZmVhdHVyZXMgKGxpa2UgYnVuZGxlcykgaW4gZnJlZVxuICogZnVuY3Rpb25zLCBzdWNoIHRoYXQgdGhleSBhcmUgdHJlZS1zaGFrZWFibGUuXG4gKi8gY2xhc3MgS2Mge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIFxuICAgIC8vIFBPUlRJTkcgTk9URTogTWFuYWdlcyBzdGF0ZSBzeW5jaHJvbml6YXRpb24gaW4gbXVsdGktdGFiIGVudmlyb25tZW50cy5cbiAgICBzLCBpLCByKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSA9IHQsIHRoaXMucmVtb3RlU3RvcmUgPSBlLCB0aGlzLmV2ZW50TWFuYWdlciA9IG4sIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgPSBzLCBcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IGksIHRoaXMubWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnMgPSByLCB0aGlzLmZjID0ge30sIHRoaXMuZGMgPSBuZXcgb3MoKHQgPT4gdHModCkpLCBabiksIFxuICAgICAgICB0aGlzLl9jID0gbmV3IE1hcCwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUga2V5cyBvZiBkb2N1bWVudHMgdGhhdCBhcmUgaW4gbGltYm8gZm9yIHdoaWNoIHdlIGhhdmVuJ3QgeWV0IHN0YXJ0ZWQgYVxuICAgICAgICAgKiBsaW1ibyByZXNvbHV0aW9uIHF1ZXJ5LiBUaGUgc3RyaW5ncyBpbiB0aGlzIHNldCBhcmUgdGhlIHJlc3VsdCBvZiBjYWxsaW5nXG4gICAgICAgICAqIGBrZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKWAgd2hlcmUgYGtleWAgaXMgYSBgRG9jdW1lbnRLZXlgIG9iamVjdC5cbiAgICAgICAgICpcbiAgICAgICAgICogVGhlIGBTZXRgIHR5cGUgd2FzIGNob3NlbiBiZWNhdXNlIGl0IHByb3ZpZGVzIGVmZmljaWVudCBsb29rdXAgYW5kIHJlbW92YWxcbiAgICAgICAgICogb2YgYXJiaXRyYXJ5IGVsZW1lbnRzIGFuZCBpdCBhbHNvIG1haW50YWlucyBpbnNlcnRpb24gb3JkZXIsIHByb3ZpZGluZyB0aGVcbiAgICAgICAgICogZGVzaXJlZCBxdWV1ZS1saWtlIEZJRk8gc2VtYW50aWNzLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy53YyA9IG5ldyBTZXQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIHRhcmdldCBJRCBmb3IgZWFjaCBkb2N1bWVudCB0aGF0IGlzIGluIGxpbWJvIHdpdGggYW5cbiAgICAgICAgICogYWN0aXZlIHRhcmdldC5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubWMgPSBuZXcgcGUoaHQuY29tcGFyYXRvciksIFxuICAgICAgICAvKipcbiAgICAgICAgICogS2VlcHMgdHJhY2sgb2YgdGhlIGluZm9ybWF0aW9uIGFib3V0IGFuIGFjdGl2ZSBsaW1ibyByZXNvbHV0aW9uIGZvciBlYWNoXG4gICAgICAgICAqIGFjdGl2ZSB0YXJnZXQgSUQgdGhhdCB3YXMgc3RhcnRlZCBmb3IgdGhlIHB1cnBvc2Ugb2YgbGltYm8gcmVzb2x1dGlvbi5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuZ2MgPSBuZXcgTWFwLCB0aGlzLnljID0gbmV3ICRvLCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNvbXBsZXRpb24gaGFuZGxlcnMsIGluZGV4ZWQgYnkgVXNlciBhbmQgQmF0Y2hJZC4gKi9cbiAgICAgICAgdGhpcy5JYyA9IHt9LCBcbiAgICAgICAgLyoqIFN0b3JlcyB1c2VyIGNhbGxiYWNrcyB3YWl0aW5nIGZvciBhbGwgcGVuZGluZyB3cml0ZXMgdG8gYmUgYWNrbm93bGVkZ2VkLiAqL1xuICAgICAgICB0aGlzLlRjID0gbmV3IE1hcCwgdGhpcy5FYyA9IGxvLmtuKCksIHRoaXMub25saW5lU3RhdGUgPSBcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovICwgXG4gICAgICAgIC8vIFRoZSBwcmltYXJ5IHN0YXRlIGlzIHNldCB0byBgdHJ1ZWAgb3IgYGZhbHNlYCBpbW1lZGlhdGVseSBhZnRlciBGaXJlc3RvcmVcbiAgICAgICAgLy8gc3RhcnR1cC4gSW4gdGhlIGludGVyaW0sIGEgY2xpZW50IHNob3VsZCBvbmx5IGJlIGNvbnNpZGVyZWQgcHJpbWFyeSBpZlxuICAgICAgICAvLyBgaXNQcmltYXJ5YCBpcyB0cnVlLlxuICAgICAgICB0aGlzLkFjID0gdm9pZCAwO1xuICAgIH1cbiAgICBnZXQgaXNQcmltYXJ5Q2xpZW50KCkge1xuICAgICAgICByZXR1cm4gITAgPT09IHRoaXMuQWM7XG4gICAgfVxufVxuXG4vKipcbiAqIEluaXRpYXRlcyB0aGUgbmV3IGxpc3RlbiwgcmVzb2x2ZXMgcHJvbWlzZSB3aGVuIGxpc3RlbiBlbnF1ZXVlZCB0byB0aGVcbiAqIHNlcnZlci4gQWxsIHRoZSBzdWJzZXF1ZW50IHZpZXcgc25hcHNob3RzIG9yIGVycm9ycyBhcmUgc2VudCB0byB0aGVcbiAqIHN1YnNjcmliZWQgaGFuZGxlcnMuIFJldHVybnMgdGhlIGluaXRpYWwgc25hcHNob3QuXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIEdjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gcGEodCk7XG4gICAgbGV0IHMsIGk7XG4gICAgY29uc3QgciA9IG4uZGMuZ2V0KGUpO1xuICAgIGlmIChyKSBcbiAgICAvLyBQT1JUSU5HIE5PVEU6IFdpdGggTXVsdGktVGFiIFdlYiwgaXQgaXMgcG9zc2libGUgdGhhdCBhIHF1ZXJ5IHZpZXdcbiAgICAvLyBhbHJlYWR5IGV4aXN0cyB3aGVuIEV2ZW50TWFuYWdlciBjYWxscyB1cyBmb3IgdGhlIGZpcnN0IHRpbWUuIFRoaXNcbiAgICAvLyBoYXBwZW5zIHdoZW4gdGhlIHByaW1hcnkgdGFiIGlzIGFscmVhZHkgbGlzdGVuaW5nIHRvIHRoaXMgcXVlcnkgb25cbiAgICAvLyBiZWhhbGYgb2YgYW5vdGhlciB0YWIgYW5kIHRoZSB1c2VyIG9mIHRoZSBwcmltYXJ5IGFsc28gc3RhcnRzIGxpc3RlbmluZ1xuICAgIC8vIHRvIHRoZSBxdWVyeS4gRXZlbnRNYW5hZ2VyIHdpbGwgbm90IGhhdmUgYW4gYXNzaWduZWQgdGFyZ2V0IElEIGluIHRoaXNcbiAgICAvLyBjYXNlIGFuZCBjYWxscyBgbGlzdGVuYCB0byBvYnRhaW4gdGhpcyBJRC5cbiAgICBzID0gci50YXJnZXRJZCwgbi5zaGFyZWRDbGllbnRTdGF0ZS5hZGRMb2NhbFF1ZXJ5VGFyZ2V0KHMpLCBpID0gci52aWV3LmhjKCk7IGVsc2Uge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgaHUobi5sb2NhbFN0b3JlLCBKbihlKSksIHIgPSBuLnNoYXJlZENsaWVudFN0YXRlLmFkZExvY2FsUXVlcnlUYXJnZXQodC50YXJnZXRJZCk7XG4gICAgICAgIHMgPSB0LnRhcmdldElkLCBpID0gYXdhaXQgUWMobiwgZSwgcywgXCJjdXJyZW50XCIgPT09IHIsIHQucmVzdW1lVG9rZW4pLCBuLmlzUHJpbWFyeUNsaWVudCAmJiBIdShuLnJlbW90ZVN0b3JlLCB0KTtcbiAgICB9XG4gICAgcmV0dXJuIGk7XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgdmlldyBmb3IgYSBwcmV2aW91c2x5IHVua25vd24gcXVlcnkgYW5kIGNvbXB1dGVzIGl0cyBpbml0aWFsXG4gKiBzbmFwc2hvdC5cbiAqLyBhc3luYyBmdW5jdGlvbiBRYyh0LCBlLCBuLCBzLCBpKSB7XG4gICAgLy8gUE9SVElORyBOT1RFOiBPbiBXZWIgb25seSwgd2UgaW5qZWN0IHRoZSBjb2RlIHRoYXQgcmVnaXN0ZXJzIG5ldyBMaW1ib1xuICAgIC8vIHRhcmdldHMgYmFzZWQgb24gdmlldyBjaGFuZ2VzLiBUaGlzIGFsbG93cyB1cyB0byBvbmx5IGRlcGVuZCBvbiBMaW1ib1xuICAgIC8vIGNoYW5nZXMgd2hlbiB1c2VyIGNvZGUgaW5jbHVkZXMgcXVlcmllcy5cbiAgICB0LlJjID0gKGUsIG4sIHMpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4sIHMpIHtcbiAgICAgICAgbGV0IGkgPSBlLnZpZXcubmMobik7XG4gICAgICAgIGkuamkgJiYgKFxuICAgICAgICAvLyBUaGUgcXVlcnkgaGFzIGEgbGltaXQgYW5kIHNvbWUgZG9jcyB3ZXJlIHJlbW92ZWQsIHNvIHdlIG5lZWRcbiAgICAgICAgLy8gdG8gcmUtcnVuIHRoZSBxdWVyeSBhZ2FpbnN0IHRoZSBsb2NhbCBzdG9yZSB0byBtYWtlIHN1cmUgd2VcbiAgICAgICAgLy8gZGlkbid0IGxvc2UgYW55IGdvb2QgZG9jcyB0aGF0IGhhZCBiZWVuIHBhc3QgdGhlIGxpbWl0LlxuICAgICAgICBpID0gYXdhaXQgZnUodC5sb2NhbFN0b3JlLCBlLnF1ZXJ5LCBcbiAgICAgICAgLyogdXNlUHJldmlvdXNSZXN1bHRzPSAqLyAhMSkudGhlbigoKHtkb2N1bWVudHM6IHR9KSA9PiBlLnZpZXcubmModCwgaSkpKSk7XG4gICAgICAgIGNvbnN0IHIgPSBzICYmIHMudGFyZ2V0Q2hhbmdlcy5nZXQoZS50YXJnZXRJZCksIG8gPSBlLnZpZXcuYXBwbHlDaGFuZ2VzKGksIFxuICAgICAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gdC5pc1ByaW1hcnlDbGllbnQsIHIpO1xuICAgICAgICByZXR1cm4gaWEodCwgZS50YXJnZXRJZCwgby51YyksIG8uc25hcHNob3Q7XG4gICAgfSh0LCBlLCBuLCBzKTtcbiAgICBjb25zdCByID0gYXdhaXQgZnUodC5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiB1c2VQcmV2aW91c1Jlc3VsdHM9ICovICEwKSwgbyA9IG5ldyBMYyhlLCByLnNyKSwgdSA9IG8ubmMoci5kb2N1bWVudHMpLCBjID0gZ2kuY3JlYXRlU3ludGhlc2l6ZWRUYXJnZXRDaGFuZ2VGb3JDdXJyZW50Q2hhbmdlKG4sIHMgJiYgXCJPZmZsaW5lXCIgLyogT25saW5lU3RhdGUuT2ZmbGluZSAqLyAhPT0gdC5vbmxpbmVTdGF0ZSwgaSksIGEgPSBvLmFwcGx5Q2hhbmdlcyh1LCBcbiAgICAvKiB1cGRhdGVMaW1ib0RvY3VtZW50cz0gKi8gdC5pc1ByaW1hcnlDbGllbnQsIGMpO1xuICAgIGlhKHQsIG4sIGEudWMpO1xuICAgIGNvbnN0IGggPSBuZXcgcWMoZSwgbiwgbyk7XG4gICAgcmV0dXJuIHQuZGMuc2V0KGUsIGgpLCB0Ll9jLmhhcyhuKSA/IHQuX2MuZ2V0KG4pLnB1c2goZSkgOiB0Ll9jLnNldChuLCBbIGUgXSksIGEuc25hcHNob3Q7XG59XG5cbi8qKiBTdG9wcyBsaXN0ZW5pbmcgdG8gdGhlIHF1ZXJ5LiAqLyBhc3luYyBmdW5jdGlvbiBqYyh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCksIHMgPSBuLmRjLmdldChlKSwgaSA9IG4uX2MuZ2V0KHMudGFyZ2V0SWQpO1xuICAgIGlmIChpLmxlbmd0aCA+IDEpIHJldHVybiBuLl9jLnNldChzLnRhcmdldElkLCBpLmZpbHRlcigodCA9PiAhWm4odCwgZSkpKSksIHZvaWQgbi5kYy5kZWxldGUoZSk7XG4gICAgLy8gTm8gb3RoZXIgcXVlcmllcyBhcmUgbWFwcGVkIHRvIHRoZSB0YXJnZXQsIGNsZWFuIHVwIHRoZSBxdWVyeSBhbmQgdGhlIHRhcmdldC5cbiAgICAgICAgaWYgKG4uaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gcmVtb3ZlIHRoZSBsb2NhbCBxdWVyeSB0YXJnZXQgZmlyc3QgdG8gYWxsb3cgdXMgdG8gdmVyaWZ5XG4gICAgICAgIC8vIHdoZXRoZXIgYW55IG90aGVyIGNsaWVudCBpcyBzdGlsbCBpbnRlcmVzdGVkIGluIHRoaXMgdGFyZ2V0LlxuICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLnJlbW92ZUxvY2FsUXVlcnlUYXJnZXQocy50YXJnZXRJZCk7XG4gICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaXNBY3RpdmVRdWVyeVRhcmdldChzLnRhcmdldElkKSB8fCBhd2FpdCBsdShuLmxvY2FsU3RvcmUsIHMudGFyZ2V0SWQsIFxuICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICExKS50aGVuKCgoKSA9PiB7XG4gICAgICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLmNsZWFyUXVlcnlTdGF0ZShzLnRhcmdldElkKSwgSnUobi5yZW1vdGVTdG9yZSwgcy50YXJnZXRJZCksIFxuICAgICAgICAgICAgbmEobiwgcy50YXJnZXRJZCk7XG4gICAgICAgIH0pKS5jYXRjaChSdCk7XG4gICAgfSBlbHNlIG5hKG4sIHMudGFyZ2V0SWQpLCBhd2FpdCBsdShuLmxvY2FsU3RvcmUsIHMudGFyZ2V0SWQsIFxuICAgIC8qa2VlcFBlcnNpc3RlZFRhcmdldERhdGE9Ki8gITApO1xufVxuXG4vKipcbiAqIEluaXRpYXRlcyB0aGUgd3JpdGUgb2YgbG9jYWwgbXV0YXRpb24gYmF0Y2ggd2hpY2ggaW52b2x2ZXMgYWRkaW5nIHRoZVxuICogd3JpdGVzIHRvIHRoZSBtdXRhdGlvbiBxdWV1ZSwgbm90aWZ5aW5nIHRoZSByZW1vdGUgc3RvcmUgYWJvdXQgbmV3XG4gKiBtdXRhdGlvbnMgYW5kIHJhaXNpbmcgZXZlbnRzIGZvciBhbnkgY2hhbmdlcyB0aGlzIHdyaXRlIGNhdXNlZC5cbiAqXG4gKiBUaGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGlzIGNhbGwgaXMgcmVzb2x2ZWQgd2hlbiB0aGUgYWJvdmUgc3RlcHNcbiAqIGhhdmUgY29tcGxldGVkLCAqbm90KiB3aGVuIHRoZSB3cml0ZSB3YXMgYWNrZWQgYnkgdGhlIGJhY2tlbmQuIFRoZVxuICogdXNlckNhbGxiYWNrIGlzIHJlc29sdmVkIG9uY2UgdGhlIHdyaXRlIHdhcyBhY2tlZC9yZWplY3RlZCBieSB0aGVcbiAqIGJhY2tlbmQgKG9yIGZhaWxlZCBsb2NhbGx5IGZvciBhbnkgb3RoZXIgcmVhc29uKS5cbiAqLyBhc3luYyBmdW5jdGlvbiB6Yyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IElhKHQpO1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBjb25zdCBuID0gTCh0KSwgcyA9IGl0Lm5vdygpLCBpID0gZS5yZWR1Y2UoKCh0LCBlKSA9PiB0LmFkZChlLmtleSkpLCBncygpKTtcbiAgICAgICAgICAgIGxldCByLCBvO1xuICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJMb2NhbGx5IHdyaXRlIG11dGF0aW9uc1wiLCBcInJlYWR3cml0ZVwiLCAodCA9PiB7XG4gICAgICAgICAgICAgICAgLy8gRmlndXJlIG91dCB3aGljaCBrZXlzIGRvIG5vdCBoYXZlIGEgcmVtb3RlIHZlcnNpb24gaW4gdGhlIGNhY2hlLCB0aGlzXG4gICAgICAgICAgICAgICAgLy8gaXMgbmVlZGVkIHRvIGNyZWF0ZSB0aGUgcmlnaHQgb3ZlcmxheSBtdXRhdGlvbjogaWYgbm8gcmVtb3RlIHZlcnNpb25cbiAgICAgICAgICAgICAgICAvLyBwcmVzZW50cywgd2UgZG8gbm90IG5lZWQgdG8gY3JlYXRlIG92ZXJsYXlzIGFzIHBhdGNoIG11dGF0aW9ucy5cbiAgICAgICAgICAgICAgICAvLyBUT0RPKE92ZXJsYXkpOiBJcyB0aGVyZSBhIGJldHRlciB3YXkgdG8gZGV0ZXJtaW5lIHRoaXM/IFVzaW5nIHRoZVxuICAgICAgICAgICAgICAgIC8vICBkb2N1bWVudCB2ZXJzaW9uIGRvZXMgbm90IHdvcmsgYmVjYXVzZSBsb2NhbCBtdXRhdGlvbnMgc2V0IHRoZW0gYmFja1xuICAgICAgICAgICAgICAgIC8vICB0byAwLlxuICAgICAgICAgICAgICAgIGxldCB1ID0gY3MoKSwgYyA9IGdzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4uWGkuZ2V0RW50cmllcyh0LCBpKS5uZXh0KCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdSA9IHQsIHUuZm9yRWFjaCgoKHQsIGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuaXNWYWxpZERvY3VtZW50KCkgfHwgKGMgPSBjLmFkZCh0KSk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgoKCkgPT4gbi5sb2NhbERvY3VtZW50cy5nZXRPdmVybGF5ZWREb2N1bWVudHModCwgdSkpKS5uZXh0KChpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgciA9IGk7XG4gICAgICAgICAgICAgICAgICAgIC8vIEZvciBub24taWRlbXBvdGVudCBtdXRhdGlvbnMgKHN1Y2ggYXMgYEZpZWxkVmFsdWUuaW5jcmVtZW50KClgKSxcbiAgICAgICAgICAgICAgICAgICAgLy8gd2UgcmVjb3JkIHRoZSBiYXNlIHN0YXRlIGluIGEgc2VwYXJhdGUgcGF0Y2ggbXV0YXRpb24uIFRoaXMgaXNcbiAgICAgICAgICAgICAgICAgICAgLy8gbGF0ZXIgdXNlZCB0byBndWFyYW50ZWUgY29uc2lzdGVudCB2YWx1ZXMgYW5kIHByZXZlbnRzIGZsaWNrZXJcbiAgICAgICAgICAgICAgICAgICAgLy8gZXZlbiBpZiB0aGUgYmFja2VuZCBzZW5kcyB1cyBhbiB1cGRhdGUgdGhhdCBhbHJlYWR5IGluY2x1ZGVzIG91clxuICAgICAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0uXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG8gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBHcyh0LCByLmdldCh0LmtleSkub3ZlcmxheWVkRG9jdW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbCAhPSBlICYmIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTk9URTogVGhlIGJhc2Ugc3RhdGUgc2hvdWxkIG9ubHkgYmUgYXBwbGllZCBpZiB0aGVyZSdzIHNvbWVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4aXN0aW5nIGRvY3VtZW50IHRvIG92ZXJyaWRlLCBzbyB1c2UgYSBQcmVjb25kaXRpb24gb2ZcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4aXN0cz10cnVlXG4gICAgICAgICAgICAgICAgICAgICAgICBvLnB1c2gobmV3IHpzKHQua2V5LCBlLCBjbihlLnZhbHVlLm1hcFZhbHVlKSwgRnMuZXhpc3RzKCEwKSkpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLm11dGF0aW9uUXVldWUuYWRkTXV0YXRpb25CYXRjaCh0LCBzLCBvLCBlKTtcbiAgICAgICAgICAgICAgICB9KSkubmV4dCgoZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG8gPSBlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzID0gZS5hcHBseVRvTG9jYWxEb2N1bWVudFNldChyLCBjKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG4uZG9jdW1lbnRPdmVybGF5Q2FjaGUuc2F2ZU92ZXJsYXlzKHQsIGUuYmF0Y2hJZCwgcyk7XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfSkpLnRoZW4oKCgpID0+ICh7XG4gICAgICAgICAgICAgICAgYmF0Y2hJZDogby5iYXRjaElkLFxuICAgICAgICAgICAgICAgIGNoYW5nZXM6IGxzKHIpXG4gICAgICAgICAgICB9KSkpO1xuICAgICAgICB9KHMubG9jYWxTdG9yZSwgZSk7XG4gICAgICAgIHMuc2hhcmVkQ2xpZW50U3RhdGUuYWRkUGVuZGluZ011dGF0aW9uKHQuYmF0Y2hJZCksIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgICAgIGxldCBzID0gdC5JY1t0LmN1cnJlbnRVc2VyLnRvS2V5KCldO1xuICAgICAgICAgICAgcyB8fCAocyA9IG5ldyBwZShldCkpO1xuICAgICAgICAgICAgcyA9IHMuaW5zZXJ0KGUsIG4pLCB0LkljW3QuY3VycmVudFVzZXIudG9LZXkoKV0gPSBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmVzb2x2ZXMgb3IgcmVqZWN0cyB0aGUgdXNlciBjYWxsYmFjayBmb3IgdGhlIGdpdmVuIGJhdGNoIGFuZCB0aGVuIGRpc2NhcmRzXG4gKiBpdC5cbiAqLyAocywgdC5iYXRjaElkLCBuKSwgYXdhaXQgdWEocywgdC5jaGFuZ2VzKSwgYXdhaXQgY2Mocy5yZW1vdGVTdG9yZSk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICAvLyBJZiB3ZSBjYW4ndCBwZXJzaXN0IHRoZSBtdXRhdGlvbiwgd2UgcmVqZWN0IHRoZSB1c2VyIGNhbGxiYWNrIGFuZFxuICAgICAgICAvLyBkb24ndCBzZW5kIHRoZSBtdXRhdGlvbi4gVGhlIHVzZXIgY2FuIHRoZW4gcmV0cnkgdGhlIHdyaXRlLlxuICAgICAgICBjb25zdCBlID0gRWModCwgXCJGYWlsZWQgdG8gcGVyc2lzdCB3cml0ZVwiKTtcbiAgICAgICAgbi5yZWplY3QoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgb25lIHJlbW90ZSBldmVudCB0byB0aGUgc3luYyBlbmdpbmUsIG5vdGlmeWluZyBhbnkgdmlld3Mgb2YgdGhlXG4gKiBjaGFuZ2VzLCBhbmQgcmVsZWFzaW5nIGFueSBwZW5kaW5nIG11dGF0aW9uIGJhdGNoZXMgdGhhdCB3b3VsZCBiZWNvbWVcbiAqIHZpc2libGUgYmVjYXVzZSBvZiB0aGUgc25hcHNob3QgdmVyc2lvbiB0aGUgcmVtb3RlIGV2ZW50IGNvbnRhaW5zLlxuICovIGFzeW5jIGZ1bmN0aW9uIFdjKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdXUobi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVXBkYXRlIGByZWNlaXZlZERvY3VtZW50YCBhcyBhcHByb3ByaWF0ZSBmb3IgYW55IGxpbWJvIHRhcmdldHMuXG4gICAgICAgICAgICAgICAgZS50YXJnZXRDaGFuZ2VzLmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzID0gbi5nYy5nZXQoZSk7XG4gICAgICAgICAgICBzICYmIChcbiAgICAgICAgICAgIC8vIFNpbmNlIHRoaXMgaXMgYSBsaW1ibyByZXNvbHV0aW9uIGxvb2t1cCwgaXQncyBmb3IgYSBzaW5nbGUgZG9jdW1lbnRcbiAgICAgICAgICAgIC8vIGFuZCBpdCBjb3VsZCBiZSBhZGRlZCwgbW9kaWZpZWQsIG9yIHJlbW92ZWQsIGJ1dCBub3QgYSBjb21iaW5hdGlvbi5cbiAgICAgICAgICAgIEYodC5hZGRlZERvY3VtZW50cy5zaXplICsgdC5tb2RpZmllZERvY3VtZW50cy5zaXplICsgdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPD0gMSksIFxuICAgICAgICAgICAgdC5hZGRlZERvY3VtZW50cy5zaXplID4gMCA/IHMubGMgPSAhMCA6IHQubW9kaWZpZWREb2N1bWVudHMuc2l6ZSA+IDAgPyBGKHMubGMpIDogdC5yZW1vdmVkRG9jdW1lbnRzLnNpemUgPiAwICYmIChGKHMubGMpLCBcbiAgICAgICAgICAgIHMubGMgPSAhMSkpO1xuICAgICAgICB9KSksIGF3YWl0IHVhKG4sIHQsIGUpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgYXdhaXQgUnQodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEFwcGxpZXMgYW4gT25saW5lU3RhdGUgY2hhbmdlIHRvIHRoZSBzeW5jIGVuZ2luZSBhbmQgbm90aWZpZXMgYW55IHZpZXdzIG9mXG4gKiB0aGUgY2hhbmdlLlxuICovIGZ1bmN0aW9uIEhjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gTCh0KTtcbiAgICAvLyBJZiB3ZSBhcmUgdGhlIHNlY29uZGFyeSBjbGllbnQsIHdlIGV4cGxpY2l0bHkgaWdub3JlIHRoZSByZW1vdGUgc3RvcmUnc1xuICAgIC8vIG9ubGluZSBzdGF0ZSAodGhlIGxvY2FsIGNsaWVudCBtYXkgZ28gb2ZmbGluZSwgZXZlbiB0aG91Z2ggdGhlIHByaW1hcnlcbiAgICAvLyB0YWIgcmVtYWlucyBvbmxpbmUpIGFuZCBvbmx5IGFwcGx5IHRoZSBwcmltYXJ5IHRhYidzIG9ubGluZSBzdGF0ZSBmcm9tXG4gICAgLy8gU2hhcmVkQ2xpZW50U3RhdGUuXG4gICAgICAgIGlmIChzLmlzUHJpbWFyeUNsaWVudCAmJiAwIC8qIE9ubGluZVN0YXRlU291cmNlLlJlbW90ZVN0b3JlICovID09PSBuIHx8ICFzLmlzUHJpbWFyeUNsaWVudCAmJiAxIC8qIE9ubGluZVN0YXRlU291cmNlLlNoYXJlZENsaWVudFN0YXRlICovID09PSBuKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcy5kYy5mb3JFYWNoKCgobiwgcykgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IHMudmlldy5rdShlKTtcbiAgICAgICAgICAgIGkuc25hcHNob3QgJiYgdC5wdXNoKGkuc25hcHNob3QpO1xuICAgICAgICB9KSksIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgICAgICAgICAgbi5vbmxpbmVTdGF0ZSA9IGU7XG4gICAgICAgICAgICBsZXQgcyA9ICExO1xuICAgICAgICAgICAgbi5xdWVyaWVzLmZvckVhY2goKCh0LCBuKSA9PiB7XG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4ubGlzdGVuZXJzKSBcbiAgICAgICAgICAgICAgICAvLyBSdW4gZ2xvYmFsIHNuYXBzaG90IGxpc3RlbmVycyBpZiBhIGNvbnNpc3RlbnQgc25hcHNob3QgaGFzIGJlZW4gZW1pdHRlZC5cbiAgICAgICAgICAgICAgICB0Lmt1KGUpICYmIChzID0gITApO1xuICAgICAgICAgICAgfSkpLCBzICYmIHhjKG4pO1xuICAgICAgICB9KHMuZXZlbnRNYW5hZ2VyLCBlKSwgdC5sZW5ndGggJiYgcy5mYy5ldSh0KSwgcy5vbmxpbmVTdGF0ZSA9IGUsIHMuaXNQcmltYXJ5Q2xpZW50ICYmIHMuc2hhcmVkQ2xpZW50U3RhdGUuc2V0T25saW5lU3RhdGUoZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlamVjdHMgdGhlIGxpc3RlbiBmb3IgdGhlIGdpdmVuIHRhcmdldElELiBUaGlzIGNhbiBiZSB0cmlnZ2VyZWQgYnkgdGhlXG4gKiBiYWNrZW5kIGZvciBhbnkgYWN0aXZlIHRhcmdldC5cbiAqXG4gKiBAcGFyYW0gc3luY0VuZ2luZSAtIFRoZSBzeW5jIGVuZ2luZSBpbXBsZW1lbnRhdGlvbi5cbiAqIEBwYXJhbSB0YXJnZXRJZCAtIFRoZSB0YXJnZXRJRCBjb3JyZXNwb25kcyB0byBvbmUgcHJldmlvdXNseSBpbml0aWF0ZWQgYnkgdGhlXG4gKiB1c2VyIGFzIHBhcnQgb2YgVGFyZ2V0RGF0YSBwYXNzZWQgdG8gbGlzdGVuKCkgb24gUmVtb3RlU3RvcmUuXG4gKiBAcGFyYW0gZXJyIC0gQSBkZXNjcmlwdGlvbiBvZiB0aGUgY29uZGl0aW9uIHRoYXQgaGFzIGZvcmNlZCB0aGUgcmVqZWN0aW9uLlxuICogTmVhcmx5IGFsd2F5cyB0aGlzIHdpbGwgYmUgYW4gaW5kaWNhdGlvbiB0aGF0IHRoZSB1c2VyIGlzIG5vIGxvbmdlclxuICogYXV0aG9yaXplZCB0byBzZWUgdGhlIGRhdGEgbWF0Y2hpbmcgdGhlIHRhcmdldC5cbiAqLyBhc3luYyBmdW5jdGlvbiBKYyh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEwodCk7XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS10YWIgb25seS5cbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKGUsIFwicmVqZWN0ZWRcIiwgbik7XG4gICAgY29uc3QgaSA9IHMuZ2MuZ2V0KGUpLCByID0gaSAmJiBpLmtleTtcbiAgICBpZiAocikge1xuICAgICAgICAvLyBUT0RPKGtsaW10KTogV2UgcmVhbGx5IG9ubHkgc2hvdWxkIGRvIHRoZSBmb2xsb3dpbmcgb24gcGVybWlzc2lvblxuICAgICAgICAvLyBkZW5pZWQgZXJyb3JzLCBidXQgd2UgZG9uJ3QgaGF2ZSB0aGUgY2F1c2UgY29kZSBoZXJlLlxuICAgICAgICAvLyBJdCdzIGEgbGltYm8gZG9jLiBDcmVhdGUgYSBzeW50aGV0aWMgZXZlbnQgc2F5aW5nIGl0IHdhcyBkZWxldGVkLlxuICAgICAgICAvLyBUaGlzIGlzIGtpbmQgb2YgYSBoYWNrLiBJZGVhbGx5LCB3ZSB3b3VsZCBoYXZlIGEgbWV0aG9kIGluIHRoZSBsb2NhbFxuICAgICAgICAvLyBzdG9yZSB0byBwdXJnZSBhIGRvY3VtZW50LiBIb3dldmVyLCBpdCB3b3VsZCBiZSB0cmlja3kgdG8ga2VlcCBhbGwgb2ZcbiAgICAgICAgLy8gdGhlIGxvY2FsIHN0b3JlJ3MgaW52YXJpYW50cyB3aXRoIGFub3RoZXIgbWV0aG9kLlxuICAgICAgICBsZXQgdCA9IG5ldyBwZShodC5jb21wYXJhdG9yKTtcbiAgICAgICAgLy8gVE9ETyhiLzIxNzE4OTIxNik6IFRoaXMgbGltYm8gZG9jdW1lbnQgc2hvdWxkIGlkZWFsbHkgaGF2ZSBhIHJlYWQgdGltZSxcbiAgICAgICAgLy8gc28gdGhhdCBpdCBpcyBwaWNrZWQgdXAgYnkgYW55IHJlYWQtdGltZSBiYXNlZCBzY2Fucy4gVGhlIGJhY2tlbmQsXG4gICAgICAgIC8vIGhvd2V2ZXIsIGRvZXMgbm90IHNlbmQgYSByZWFkIHRpbWUgZm9yIHRhcmdldCByZW1vdmFscy5cbiAgICAgICAgICAgICAgICB0ID0gdC5pbnNlcnQociwgYW4ubmV3Tm9Eb2N1bWVudChyLCBydC5taW4oKSkpO1xuICAgICAgICBjb25zdCBuID0gZ3MoKS5hZGQociksIGkgPSBuZXcgbWkocnQubWluKCksIFxuICAgICAgICAvKiB0YXJnZXRDaGFuZ2VzPSAqLyBuZXcgTWFwLCBcbiAgICAgICAgLyogdGFyZ2V0TWlzbWF0Y2hlcz0gKi8gbmV3IHBlKGV0KSwgdCwgbik7XG4gICAgICAgIGF3YWl0IFdjKHMsIGkpLCBcbiAgICAgICAgLy8gU2luY2UgdGhpcyBxdWVyeSBmYWlsZWQsIHdlIHdvbid0IHdhbnQgdG8gbWFudWFsbHkgdW5saXN0ZW4gdG8gaXQuXG4gICAgICAgIC8vIFdlIG9ubHkgcmVtb3ZlIGl0IGZyb20gYm9va2tlZXBpbmcgYWZ0ZXIgd2Ugc3VjY2Vzc2Z1bGx5IGFwcGxpZWQgdGhlXG4gICAgICAgIC8vIFJlbW90ZUV2ZW50LiBJZiBgYXBwbHlSZW1vdGVFdmVudCgpYCB0aHJvd3MsIHdlIHdhbnQgdG8gcmUtbGlzdGVuIHRvXG4gICAgICAgIC8vIHRoaXMgcXVlcnkgd2hlbiB0aGUgUmVtb3RlU3RvcmUgcmVzdGFydHMgdGhlIFdhdGNoIHN0cmVhbSwgd2hpY2ggc2hvdWxkXG4gICAgICAgIC8vIHJlLXRyaWdnZXIgdGhlIHRhcmdldCBmYWlsdXJlLlxuICAgICAgICBzLm1jID0gcy5tYy5yZW1vdmUociksIHMuZ2MuZGVsZXRlKGUpLCBvYShzKTtcbiAgICB9IGVsc2UgYXdhaXQgbHUocy5sb2NhbFN0b3JlLCBlLCBcbiAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4gbmEocywgZSwgbikpKS5jYXRjaChSdCk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFljKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KSwgcyA9IGUuYmF0Y2guYmF0Y2hJZDtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgcnUobi5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHRcbiAgICAgICAgLy8gdXApLCBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlblxuICAgICAgICAvLyBiZWZvcmUgbGlzdGVuIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBlYShuLCBzLCAvKmVycm9yPSovIG51bGwpLCB0YShuLCBzKSwgbi5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVNdXRhdGlvblN0YXRlKHMsIFwiYWNrbm93bGVkZ2VkXCIpLCBcbiAgICAgICAgYXdhaXQgdWEobiwgdCk7XG4gICAgfSBjYXRjaCAodCkge1xuICAgICAgICBhd2FpdCBSdCh0KTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIFhjKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gTCh0KTtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IEwodCk7XG4gICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcIlJlamVjdCBiYXRjaFwiLCBcInJlYWR3cml0ZS1wcmltYXJ5XCIsICh0ID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgcztcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5tdXRhdGlvblF1ZXVlLmxvb2t1cE11dGF0aW9uQmF0Y2godCwgZSkubmV4dCgoZSA9PiAoRihudWxsICE9PSBlKSwgcyA9IGUua2V5cygpLCBcbiAgICAgICAgICAgICAgICBuLm11dGF0aW9uUXVldWUucmVtb3ZlTXV0YXRpb25CYXRjaCh0LCBlKSkpKS5uZXh0KCgoKSA9PiBuLm11dGF0aW9uUXVldWUucGVyZm9ybUNvbnNpc3RlbmN5Q2hlY2sodCkpKS5uZXh0KCgoKSA9PiBuLmRvY3VtZW50T3ZlcmxheUNhY2hlLnJlbW92ZU92ZXJsYXlzRm9yQmF0Y2hJZCh0LCBzLCBlKSkpLm5leHQoKCgpID0+IG4ubG9jYWxEb2N1bWVudHMucmVjYWxjdWxhdGVBbmRTYXZlT3ZlcmxheXNGb3JEb2N1bWVudEtleXModCwgcykpKS5uZXh0KCgoKSA9PiBuLmxvY2FsRG9jdW1lbnRzLmdldERvY3VtZW50cyh0LCBzKSkpO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogUmV0dXJucyB0aGUgbGFyZ2VzdCAobGF0ZXN0KSBiYXRjaCBpZCBpbiBtdXRhdGlvbiBxdWV1ZSB0aGF0IGlzIHBlbmRpbmdcbiAqIHNlcnZlciByZXNwb25zZS5cbiAqXG4gKiBSZXR1cm5zIGBCQVRDSElEX1VOS05PV05gIGlmIHRoZSBxdWV1ZSBpcyBlbXB0eS5cbiAqLyAocy5sb2NhbFN0b3JlLCBlKTtcbiAgICAgICAgLy8gVGhlIGxvY2FsIHN0b3JlIG1heSBvciBtYXkgbm90IGJlIGFibGUgdG8gYXBwbHkgdGhlIHdyaXRlIHJlc3VsdCBhbmRcbiAgICAgICAgLy8gcmFpc2UgZXZlbnRzIGltbWVkaWF0ZWx5IChkZXBlbmRpbmcgb24gd2hldGhlciB0aGUgd2F0Y2hlciBpcyBjYXVnaHQgdXApLFxuICAgICAgICAvLyBzbyB3ZSByYWlzZSB1c2VyIGNhbGxiYWNrcyBmaXJzdCBzbyB0aGF0IHRoZXkgY29uc2lzdGVudGx5IGhhcHBlbiBiZWZvcmVcbiAgICAgICAgLy8gbGlzdGVuIGV2ZW50cy5cbiAgICAgICAgICAgICAgICBlYShzLCBlLCBuKSwgdGEocywgZSksIHMuc2hhcmVkQ2xpZW50U3RhdGUudXBkYXRlTXV0YXRpb25TdGF0ZShlLCBcInJlamVjdGVkXCIsIG4pLCBcbiAgICAgICAgYXdhaXQgdWEocywgdCk7XG4gICAgfSBjYXRjaCAobikge1xuICAgICAgICBhd2FpdCBSdChuKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmVnaXN0ZXJzIGEgdXNlciBjYWxsYmFjayB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHBlbmRpbmcgbXV0YXRpb25zIGF0IHRoZSBtb21lbnQgb2YgY2FsbGluZ1xuICogYXJlIGFja25vd2xlZGdlZCAuXG4gKi8gYXN5bmMgZnVuY3Rpb24gWmModCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgIGVjKG4ucmVtb3RlU3RvcmUpIHx8IE4oXCJTeW5jRW5naW5lXCIsIFwiVGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQuIFRoZSB0YXNrIHJldHVybmVkIGJ5ICdhd2FpdFBlbmRpbmdXcml0ZXMoKScgd2lsbCBub3QgY29tcGxldGUgdW50aWwgdGhlIG5ldHdvcmsgaXMgZW5hYmxlZC5cIik7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBMKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGUucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJHZXQgaGlnaGVzdCB1bmFja25vd2xlZGdlZCBiYXRjaCBpZFwiLCBcInJlYWRvbmx5XCIsICh0ID0+IGUubXV0YXRpb25RdWV1ZS5nZXRIaWdoZXN0VW5hY2tub3dsZWRnZWRCYXRjaElkKHQpKSk7XG4gICAgICAgIH0obi5sb2NhbFN0b3JlKTtcbiAgICAgICAgaWYgKC0xID09PSB0KSBcbiAgICAgICAgLy8gVHJpZ2dlciB0aGUgY2FsbGJhY2sgcmlnaHQgYXdheSBpZiB0aGVyZSBpcyBubyBwZW5kaW5nIHdyaXRlcyBhdCB0aGUgbW9tZW50LlxuICAgICAgICByZXR1cm4gdm9pZCBlLnJlc29sdmUoKTtcbiAgICAgICAgY29uc3QgcyA9IG4uVGMuZ2V0KHQpIHx8IFtdO1xuICAgICAgICBzLnB1c2goZSksIG4uVGMuc2V0KHQsIHMpO1xuICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgY29uc3QgbiA9IEVjKHQsIFwiSW5pdGlhbGl6YXRpb24gb2Ygd2FpdEZvclBlbmRpbmdXcml0ZXMoKSBvcGVyYXRpb24gZmFpbGVkXCIpO1xuICAgICAgICBlLnJlamVjdChuKTtcbiAgICB9XG59XG5cbi8qKlxuICogVHJpZ2dlcnMgdGhlIGNhbGxiYWNrcyB0aGF0IGFyZSB3YWl0aW5nIGZvciB0aGlzIGJhdGNoIGlkIHRvIGdldCBhY2tub3dsZWRnZWQgYnkgc2VydmVyLFxuICogaWYgdGhlcmUgYXJlIGFueS5cbiAqLyBmdW5jdGlvbiB0YSh0LCBlKSB7XG4gICAgKHQuVGMuZ2V0KGUpIHx8IFtdKS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgdC5yZXNvbHZlKCk7XG4gICAgfSkpLCB0LlRjLmRlbGV0ZShlKTtcbn1cblxuLyoqIFJlamVjdCBhbGwgb3V0c3RhbmRpbmcgY2FsbGJhY2tzIHdhaXRpbmcgZm9yIHBlbmRpbmcgd3JpdGVzIHRvIGNvbXBsZXRlLiAqLyBmdW5jdGlvbiBlYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEwodCk7XG4gICAgbGV0IGkgPSBzLkljW3MuY3VycmVudFVzZXIudG9LZXkoKV07XG4gICAgLy8gTk9URTogTXV0YXRpb25zIHJlc3RvcmVkIGZyb20gcGVyc2lzdGVuY2Ugd29uJ3QgaGF2ZSBjYWxsYmFja3MsIHNvIGl0J3NcbiAgICAvLyBva2F5IGZvciB0aGVyZSB0byBiZSBubyBjYWxsYmFjayBmb3IgdGhpcyBJRC5cbiAgICAgICAgaWYgKGkpIHtcbiAgICAgICAgY29uc3QgdCA9IGkuZ2V0KGUpO1xuICAgICAgICB0ICYmIChuID8gdC5yZWplY3QobikgOiB0LnJlc29sdmUoKSwgaSA9IGkucmVtb3ZlKGUpKSwgcy5JY1tzLmN1cnJlbnRVc2VyLnRvS2V5KCldID0gaTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG5hKHQsIGUsIG4gPSBudWxsKSB7XG4gICAgdC5zaGFyZWRDbGllbnRTdGF0ZS5yZW1vdmVMb2NhbFF1ZXJ5VGFyZ2V0KGUpO1xuICAgIGZvciAoY29uc3QgcyBvZiB0Ll9jLmdldChlKSkgdC5kYy5kZWxldGUocyksIG4gJiYgdC5mYy52YyhzLCBuKTtcbiAgICBpZiAodC5fYy5kZWxldGUoZSksIHQuaXNQcmltYXJ5Q2xpZW50KSB7XG4gICAgICAgIHQueWMucHMoZSkuZm9yRWFjaCgoZSA9PiB7XG4gICAgICAgICAgICB0LnljLmNvbnRhaW5zS2V5KGUpIHx8IFxuICAgICAgICAgICAgLy8gV2UgcmVtb3ZlZCB0aGUgbGFzdCByZWZlcmVuY2UgZm9yIHRoaXMga2V5XG4gICAgICAgICAgICBzYSh0LCBlKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2EodCwgZSkge1xuICAgIHQud2MuZGVsZXRlKGUucGF0aC5jYW5vbmljYWxTdHJpbmcoKSk7XG4gICAgLy8gSXQncyBwb3NzaWJsZSB0aGF0IHRoZSB0YXJnZXQgYWxyZWFkeSBnb3QgcmVtb3ZlZCBiZWNhdXNlIHRoZSBxdWVyeSBmYWlsZWQuIEluIHRoYXQgY2FzZSxcbiAgICAvLyB0aGUga2V5IHdvbid0IGV4aXN0IGluIGBsaW1ib1RhcmdldHNCeUtleWAuIE9ubHkgZG8gdGhlIGNsZWFudXAgaWYgd2Ugc3RpbGwgaGF2ZSB0aGUgdGFyZ2V0LlxuICAgIGNvbnN0IG4gPSB0Lm1jLmdldChlKTtcbiAgICBudWxsICE9PSBuICYmIChKdSh0LnJlbW90ZVN0b3JlLCBuKSwgdC5tYyA9IHQubWMucmVtb3ZlKGUpLCB0LmdjLmRlbGV0ZShuKSwgb2EodCkpO1xufVxuXG5mdW5jdGlvbiBpYSh0LCBlLCBuKSB7XG4gICAgZm9yIChjb25zdCBzIG9mIG4pIGlmIChzIGluc3RhbmNlb2YgRmMpIHQueWMuYWRkUmVmZXJlbmNlKHMua2V5LCBlKSwgcmEodCwgcyk7IGVsc2UgaWYgKHMgaW5zdGFuY2VvZiBCYykge1xuICAgICAgICBOKFwiU3luY0VuZ2luZVwiLCBcIkRvY3VtZW50IG5vIGxvbmdlciBpbiBsaW1ibzogXCIgKyBzLmtleSksIHQueWMucmVtb3ZlUmVmZXJlbmNlKHMua2V5LCBlKTtcbiAgICAgICAgdC55Yy5jb250YWluc0tleShzLmtleSkgfHwgXG4gICAgICAgIC8vIFdlIHJlbW92ZWQgdGhlIGxhc3QgcmVmZXJlbmNlIGZvciB0aGlzIGtleVxuICAgICAgICBzYSh0LCBzLmtleSk7XG4gICAgfSBlbHNlICQoKTtcbn1cblxuZnVuY3Rpb24gcmEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBlLmtleSwgcyA9IG4ucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB0Lm1jLmdldChuKSB8fCB0LndjLmhhcyhzKSB8fCAoTihcIlN5bmNFbmdpbmVcIiwgXCJOZXcgZG9jdW1lbnQgaW4gbGltYm86IFwiICsgbiksIHQud2MuYWRkKHMpLCBcbiAgICBvYSh0KSk7XG59XG5cbi8qKlxuICogU3RhcnRzIGxpc3RlbnMgZm9yIGRvY3VtZW50cyBpbiBsaW1ibyB0aGF0IGFyZSBlbnF1ZXVlZCBmb3IgcmVzb2x1dGlvbixcbiAqIHN1YmplY3QgdG8gYSBtYXhpbXVtIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLlxuICpcbiAqIFdpdGhvdXQgYm91bmRpbmcgdGhlIG51bWJlciBvZiBjb25jdXJyZW50IHJlc29sdXRpb25zLCB0aGUgc2VydmVyIGNhbiBmYWlsXG4gKiB3aXRoIFwicmVzb3VyY2UgZXhoYXVzdGVkXCIgZXJyb3JzIHdoaWNoIGNhbiBsZWFkIHRvIHBhdGhvbG9naWNhbCBjbGllbnRcbiAqIGJlaGF2aW9yIGFzIHNlZW4gaW4gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9pc3N1ZXMvMjY4My5cbiAqLyBmdW5jdGlvbiBvYSh0KSB7XG4gICAgZm9yICg7dC53Yy5zaXplID4gMCAmJiB0Lm1jLnNpemUgPCB0Lm1heENvbmN1cnJlbnRMaW1ib1Jlc29sdXRpb25zOyApIHtcbiAgICAgICAgY29uc3QgZSA9IHQud2MudmFsdWVzKCkubmV4dCgpLnZhbHVlO1xuICAgICAgICB0LndjLmRlbGV0ZShlKTtcbiAgICAgICAgY29uc3QgbiA9IG5ldyBodCh1dC5mcm9tU3RyaW5nKGUpKSwgcyA9IHQuRWMubmV4dCgpO1xuICAgICAgICB0LmdjLnNldChzLCBuZXcgVWMobikpLCB0Lm1jID0gdC5tYy5pbnNlcnQobiwgcyksIEh1KHQucmVtb3RlU3RvcmUsIG5ldyBjcihKbihHbihuLnBhdGgpKSwgcywgXCJUYXJnZXRQdXJwb3NlTGltYm9SZXNvbHV0aW9uXCIgLyogVGFyZ2V0UHVycG9zZS5MaW1ib1Jlc29sdXRpb24gKi8gLCAkdC5jdCkpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gdWEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBMKHQpLCBpID0gW10sIHIgPSBbXSwgbyA9IFtdO1xuICAgIHMuZGMuaXNFbXB0eSgpIHx8IChzLmRjLmZvckVhY2goKCh0LCB1KSA9PiB7XG4gICAgICAgIG8ucHVzaChzLlJjKHUsIGUsIG4pLnRoZW4oKHQgPT4ge1xuICAgICAgICAgICAgLy8gVXBkYXRlIHZpZXdzIGlmIHRoZXJlIGFyZSBhY3R1YWwgY2hhbmdlcy5cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBjaGFuZ2VzLCBvciB3ZSBhcmUgaGFuZGxpbmcgYSBnbG9iYWwgc25hcHNob3QsIG5vdGlmeVxuICAgICAgICAgICAgLy8gc2Vjb25kYXJ5IGNsaWVudHMgdG8gdXBkYXRlIHF1ZXJ5IHN0YXRlLlxuICAgICAgICAgICAgKHQgfHwgbikgJiYgcy5pc1ByaW1hcnlDbGllbnQgJiYgcy5zaGFyZWRDbGllbnRTdGF0ZS51cGRhdGVRdWVyeVN0YXRlKHUudGFyZ2V0SWQsIChudWxsID09IHQgPyB2b2lkIDAgOiB0LmZyb21DYWNoZSkgPyBcIm5vdC1jdXJyZW50XCIgOiBcImN1cnJlbnRcIiksIFxuICAgICAgICAgICAgdCkge1xuICAgICAgICAgICAgICAgIGkucHVzaCh0KTtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gdHUuQmkodS50YXJnZXRJZCwgdCk7XG4gICAgICAgICAgICAgICAgci5wdXNoKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSkpO1xuICAgIH0pKSwgYXdhaXQgUHJvbWlzZS5hbGwobyksIHMuZmMuZXUoaSksIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEwodCk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwibm90aWZ5TG9jYWxWaWV3Q2hhbmdlc1wiLCBcInJlYWR3cml0ZVwiLCAodCA9PiB2dC5mb3JFYWNoKGUsIChlID0+IHZ0LmZvckVhY2goZS4kaSwgKHMgPT4gbi5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5hZGRSZWZlcmVuY2UodCwgZS50YXJnZXRJZCwgcykpKS5uZXh0KCgoKSA9PiB2dC5mb3JFYWNoKGUuRmksIChzID0+IG4ucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUucmVtb3ZlUmVmZXJlbmNlKHQsIGUudGFyZ2V0SWQsIHMpKSkpKSkpKSk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGlmICghRHQodCkpIHRocm93IHQ7XG4gICAgICAgICAgICAvLyBJZiBgbm90aWZ5TG9jYWxWaWV3Q2hhbmdlc2AgZmFpbHMsIHdlIGRpZCBub3QgYWR2YW5jZSB0aGUgc2VxdWVuY2VcbiAgICAgICAgICAgIC8vIG51bWJlciBmb3IgdGhlIGRvY3VtZW50cyB0aGF0IHdlcmUgaW5jbHVkZWQgaW4gdGhpcyB0cmFuc2FjdGlvbi5cbiAgICAgICAgICAgIC8vIFRoaXMgbWlnaHQgdHJpZ2dlciB0aGVtIHRvIGJlIGRlbGV0ZWQgZWFybGllciB0aGFuIHRoZXkgb3RoZXJ3aXNlXG4gICAgICAgICAgICAvLyB3b3VsZCBoYXZlLCBidXQgaXQgc2hvdWxkIG5vdCBpbnZhbGlkYXRlIHRoZSBpbnRlZ3JpdHkgb2YgdGhlIGRhdGEuXG4gICAgICAgICAgICBOKFwiTG9jYWxTdG9yZVwiLCBcIkZhaWxlZCB0byB1cGRhdGUgc2VxdWVuY2UgbnVtYmVyczogXCIgKyB0KTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICAgICAgY29uc3QgZSA9IHQudGFyZ2V0SWQ7XG4gICAgICAgICAgICBpZiAoIXQuZnJvbUNhY2hlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IG4uSGkuZ2V0KGUpLCBzID0gdC5zbmFwc2hvdFZlcnNpb24sIGkgPSB0LndpdGhMYXN0TGltYm9GcmVlU25hcHNob3RWZXJzaW9uKHMpO1xuICAgICAgICAgICAgICAgIC8vIEFkdmFuY2UgdGhlIGxhc3QgbGltYm8gZnJlZSBzbmFwc2hvdCB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG4uSGkgPSBuLkhpLmluc2VydChlLCBpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0ocy5sb2NhbFN0b3JlLCByKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICBpZiAoIW4uY3VycmVudFVzZXIuaXNFcXVhbChlKSkge1xuICAgICAgICBOKFwiU3luY0VuZ2luZVwiLCBcIlVzZXIgY2hhbmdlLiBOZXcgdXNlcjpcIiwgZS50b0tleSgpKTtcbiAgICAgICAgY29uc3QgdCA9IGF3YWl0IGl1KG4ubG9jYWxTdG9yZSwgZSk7XG4gICAgICAgIG4uY3VycmVudFVzZXIgPSBlLCBcbiAgICAgICAgLy8gRmFpbHMgdGFza3Mgd2FpdGluZyBmb3IgcGVuZGluZyB3cml0ZXMgcmVxdWVzdGVkIGJ5IHByZXZpb3VzIHVzZXIuXG4gICAgICAgIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHQuVGMuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdC5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdC5yZWplY3QobmV3IFUocS5DQU5DRUxMRUQsIGUpKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICB9KSksIHQuVGMuY2xlYXIoKTtcbiAgICAgICAgfShuLCBcIid3YWl0Rm9yUGVuZGluZ1dyaXRlcycgcHJvbWlzZSBpcyByZWplY3RlZCBkdWUgdG8gYSB1c2VyIGNoYW5nZS5cIiksIFxuICAgICAgICAvLyBUT0RPKGIvMTE0MjI2NDE3KTogQ29uc2lkZXIgY2FsbGluZyB0aGlzIG9ubHkgaW4gdGhlIHByaW1hcnkgdGFiLlxuICAgICAgICBuLnNoYXJlZENsaWVudFN0YXRlLmhhbmRsZVVzZXJDaGFuZ2UoZSwgdC5yZW1vdmVkQmF0Y2hJZHMsIHQuYWRkZWRCYXRjaElkcyksIGF3YWl0IHVhKG4sIHQudHIpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gbi5nYy5nZXQoZSk7XG4gICAgaWYgKHMgJiYgcy5sYykgcmV0dXJuIGdzKCkuYWRkKHMua2V5KTtcbiAgICB7XG4gICAgICAgIGxldCB0ID0gZ3MoKTtcbiAgICAgICAgY29uc3QgcyA9IG4uX2MuZ2V0KGUpO1xuICAgICAgICBpZiAoIXMpIHJldHVybiB0O1xuICAgICAgICBmb3IgKGNvbnN0IGUgb2Ygcykge1xuICAgICAgICAgICAgY29uc3QgcyA9IG4uZGMuZ2V0KGUpO1xuICAgICAgICAgICAgdCA9IHQudW5pb25XaXRoKHMudmlldy5lYyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIFJlY29uY2lsZSB0aGUgbGlzdCBvZiBzeW5jZWQgZG9jdW1lbnRzIGluIGFuIGV4aXN0aW5nIHZpZXcgd2l0aCB0aG9zZVxuICogZnJvbSBwZXJzaXN0ZW5jZS5cbiAqLyBhc3luYyBmdW5jdGlvbiBoYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IEwodCksIHMgPSBhd2FpdCBmdShuLmxvY2FsU3RvcmUsIGUucXVlcnksIFxuICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gZS52aWV3LmFjKHMpO1xuICAgIHJldHVybiBuLmlzUHJpbWFyeUNsaWVudCAmJiBpYShuLCBlLnRhcmdldElkLCBpLnVjKSwgaTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZXMgbmV3bHkgY2hhbmdlZCBkb2N1bWVudHMgZnJvbSByZW1vdGUgZG9jdW1lbnQgY2FjaGUgYW5kIHJhaXNlc1xuICogc25hcHNob3RzIGlmIG5lZWRlZC5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIGxhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICByZXR1cm4gX3Uobi5sb2NhbFN0b3JlLCBlKS50aGVuKCh0ID0+IHVhKG4sIHQpKSk7XG59XG5cbi8qKiBBcHBsaWVzIGEgbXV0YXRpb24gc3RhdGUgdG8gYW4gZXhpc3RpbmcgYmF0Y2guICAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIGZhKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gTCh0KSwgciA9IGF3YWl0IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEwodCksIHMgPSBMKG4ubXV0YXRpb25RdWV1ZSk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiTG9va3VwIG11dGF0aW9uIGRvY3VtZW50c1wiLCBcInJlYWRvbmx5XCIsICh0ID0+IHMuVm4odCwgZSkubmV4dCgoZSA9PiBlID8gbi5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudHModCwgZSkgOiB2dC5yZXNvbHZlKG51bGwpKSkpKTtcbiAgICB9XG4gICAgLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbiAgICAoaS5sb2NhbFN0b3JlLCBlKTtcbiAgICBudWxsICE9PSByID8gKFwicGVuZGluZ1wiID09PSBuID8gXG4gICAgLy8gSWYgd2UgYXJlIHRoZSBwcmltYXJ5IGNsaWVudCwgd2UgbmVlZCB0byBzZW5kIHRoaXMgd3JpdGUgdG8gdGhlXG4gICAgLy8gYmFja2VuZC4gU2Vjb25kYXJ5IGNsaWVudHMgd2lsbCBpZ25vcmUgdGhlc2Ugd3JpdGVzIHNpbmNlIHRoZWlyIHJlbW90ZVxuICAgIC8vIGNvbm5lY3Rpb24gaXMgZGlzYWJsZWQuXG4gICAgYXdhaXQgY2MoaS5yZW1vdGVTdG9yZSkgOiBcImFja25vd2xlZGdlZFwiID09PSBuIHx8IFwicmVqZWN0ZWRcIiA9PT0gbiA/IChcbiAgICAvLyBOT1RFOiBCb3RoIHRoZXNlIG1ldGhvZHMgYXJlIG5vLW9wcyBmb3IgYmF0Y2hlcyB0aGF0IG9yaWdpbmF0ZWQgZnJvbVxuICAgIC8vIG90aGVyIGNsaWVudHMuXG4gICAgZWEoaSwgZSwgcyB8fCBudWxsKSwgdGEoaSwgZSksIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgTChMKHQpLm11dGF0aW9uUXVldWUpLkRuKGUpO1xuICAgIH1cbiAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgIChpLmxvY2FsU3RvcmUsIGUpKSA6ICQoKSwgYXdhaXQgdWEoaSwgcikpIDogXG4gICAgLy8gQSB0aHJvdHRsZWQgdGFiIG1heSBub3QgaGF2ZSBzZWVuIHRoZSBtdXRhdGlvbiBiZWZvcmUgaXQgd2FzIGNvbXBsZXRlZFxuICAgIC8vIGFuZCByZW1vdmVkIGZyb20gdGhlIG11dGF0aW9uIHF1ZXVlLCBpbiB3aGljaCBjYXNlIHdlIHdvbid0IGhhdmUgY2FjaGVkXG4gICAgLy8gdGhlIGFmZmVjdGVkIGRvY3VtZW50cy4gSW4gdGhpcyBjYXNlIHdlIGNhbiBzYWZlbHkgaWdub3JlIHRoZSB1cGRhdGVcbiAgICAvLyBzaW5jZSB0aGF0IG1lYW5zIHdlIGRpZG4ndCBhcHBseSB0aGUgbXV0YXRpb24gbG9jYWxseSBhdCBhbGwgKGlmIHdlXG4gICAgLy8gaGFkLCB3ZSB3b3VsZCBoYXZlIGNhY2hlZCB0aGUgYWZmZWN0ZWQgZG9jdW1lbnRzKSwgYW5kIHNvIHdlIHdpbGwganVzdFxuICAgIC8vIHNlZSBhbnkgcmVzdWx0aW5nIGRvY3VtZW50IGNoYW5nZXMgdmlhIG5vcm1hbCByZW1vdGUgZG9jdW1lbnQgdXBkYXRlc1xuICAgIC8vIGFzIGFwcGxpY2FibGUuXG4gICAgTihcIlN5bmNFbmdpbmVcIiwgXCJDYW5ub3QgYXBwbHkgbXV0YXRpb24gYmF0Y2ggd2l0aCBpZDogXCIgKyBlKTtcbn1cblxuLyoqIEFwcGxpZXMgYSBxdWVyeSB0YXJnZXQgY2hhbmdlIGZyb20gYSBkaWZmZXJlbnQgdGFiLiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmFzeW5jIGZ1bmN0aW9uIGRhKHQsIGUpIHtcbiAgICBjb25zdCBuID0gTCh0KTtcbiAgICBpZiAocGEobiksIElhKG4pLCAhMCA9PT0gZSAmJiAhMCAhPT0gbi5BYykge1xuICAgICAgICAvLyBTZWNvbmRhcnkgdGFicyBvbmx5IG1haW50YWluIFZpZXdzIGZvciB0aGVpciBsb2NhbCBsaXN0ZW5lcnMgYW5kIHRoZVxuICAgICAgICAvLyBWaWV3cyBpbnRlcm5hbCBzdGF0ZSBtYXkgbm90IGJlIDEwMCUgcG9wdWxhdGVkIChpbiBwYXJ0aWN1bGFyXG4gICAgICAgIC8vIHNlY29uZGFyeSB0YWJzIGRvbid0IHRyYWNrIHN5bmNlZERvY3VtZW50cywgdGhlIHNldCBvZiBkb2N1bWVudHMgdGhlXG4gICAgICAgIC8vIHNlcnZlciBjb25zaWRlcnMgdG8gYmUgaW4gdGhlIHRhcmdldCkuIFNvIHdoZW4gYSBzZWNvbmRhcnkgYmVjb21lc1xuICAgICAgICAvLyBwcmltYXJ5LCB3ZSBuZWVkIHRvIG5lZWQgdG8gbWFrZSBzdXJlIHRoYXQgYWxsIHZpZXdzIGZvciBhbGwgdGFyZ2V0c1xuICAgICAgICAvLyBtYXRjaCB0aGUgc3RhdGUgb24gZGlzay5cbiAgICAgICAgY29uc3QgdCA9IG4uc2hhcmVkQ2xpZW50U3RhdGUuZ2V0QWxsQWN0aXZlUXVlcnlUYXJnZXRzKCksIGUgPSBhd2FpdCBfYShuLCB0LnRvQXJyYXkoKSk7XG4gICAgICAgIG4uQWMgPSAhMCwgYXdhaXQgeWMobi5yZW1vdGVTdG9yZSwgITApO1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkgSHUobi5yZW1vdGVTdG9yZSwgdCk7XG4gICAgfSBlbHNlIGlmICghMSA9PT0gZSAmJiAhMSAhPT0gbi5BYykge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIGxldCBlID0gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgIG4uX2MuZm9yRWFjaCgoKHMsIGkpID0+IHtcbiAgICAgICAgICAgIG4uc2hhcmVkQ2xpZW50U3RhdGUuaXNMb2NhbFF1ZXJ5VGFyZ2V0KGkpID8gdC5wdXNoKGkpIDogZSA9IGUudGhlbigoKCkgPT4gKG5hKG4sIGkpLCBcbiAgICAgICAgICAgIGx1KG4ubG9jYWxTdG9yZSwgaSwgXG4gICAgICAgICAgICAvKmtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhPSovICEwKSkpKSwgSnUobi5yZW1vdGVTdG9yZSwgaSk7XG4gICAgICAgIH0pKSwgYXdhaXQgZSwgYXdhaXQgX2EobiwgdCksIFxuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gTCh0KTtcbiAgICAgICAgICAgIGUuZ2MuZm9yRWFjaCgoKHQsIG4pID0+IHtcbiAgICAgICAgICAgICAgICBKdShlLnJlbW90ZVN0b3JlLCBuKTtcbiAgICAgICAgICAgIH0pKSwgZS55Yy5JcygpLCBlLmdjID0gbmV3IE1hcCwgZS5tYyA9IG5ldyBwZShodC5jb21wYXJhdG9yKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFJlY29uY2lsZSB0aGUgcXVlcnkgdmlld3Mgb2YgdGhlIHByb3ZpZGVkIHF1ZXJ5IHRhcmdldHMgd2l0aCB0aGUgc3RhdGUgZnJvbVxuICogcGVyc2lzdGVuY2UuIFJhaXNlcyBzbmFwc2hvdHMgZm9yIGFueSBjaGFuZ2VzIHRoYXQgYWZmZWN0IHRoZSBsb2NhbFxuICogY2xpZW50IGFuZCByZXR1cm5zIHRoZSB1cGRhdGVkIHN0YXRlIG9mIGFsbCB0YXJnZXQncyBxdWVyeSBkYXRhLlxuICpcbiAqIEBwYXJhbSBzeW5jRW5naW5lIC0gVGhlIHN5bmMgZW5naW5lIGltcGxlbWVudGF0aW9uXG4gKiBAcGFyYW0gdGFyZ2V0cyAtIHRoZSBsaXN0IG9mIHRhcmdldHMgd2l0aCB2aWV3cyB0aGF0IG5lZWQgdG8gYmUgcmVjb21wdXRlZFxuICogQHBhcmFtIHRyYW5zaXRpb25Ub1ByaW1hcnkgLSBgdHJ1ZWAgaWZmIHRoZSB0YWIgdHJhbnNpdGlvbnMgZnJvbSBhIHNlY29uZGFyeVxuICogdGFiIHRvIGEgcHJpbWFyeSB0YWJcbiAqL1xuICAgICAgICAvLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuICAgICAgICAobiksIG4uQWMgPSAhMSwgYXdhaXQgeWMobi5yZW1vdGVTdG9yZSwgITEpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gX2EodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBMKHQpLCBpID0gW10sIHIgPSBbXTtcbiAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICBsZXQgZTtcbiAgICAgICAgY29uc3QgbiA9IHMuX2MuZ2V0KHQpO1xuICAgICAgICBpZiAobiAmJiAwICE9PSBuLmxlbmd0aCkge1xuICAgICAgICAgICAgLy8gRm9yIHF1ZXJpZXMgdGhhdCBoYXZlIGEgbG9jYWwgVmlldywgd2UgZmV0Y2ggdGhlaXIgY3VycmVudCBzdGF0ZVxuICAgICAgICAgICAgLy8gZnJvbSBMb2NhbFN0b3JlIChhcyB0aGUgcmVzdW1lIHRva2VuIGFuZCB0aGUgc25hcHNob3QgdmVyc2lvblxuICAgICAgICAgICAgLy8gbWlnaHQgaGF2ZSBjaGFuZ2VkKSBhbmQgcmVjb25jaWxlIHRoZWlyIHZpZXdzIHdpdGggdGhlIHBlcnNpc3RlZFxuICAgICAgICAgICAgLy8gc3RhdGUgKHRoZSBsaXN0IG9mIHN5bmNlZERvY3VtZW50cyBtYXkgaGF2ZSBnb3R0ZW4gb3V0IG9mIHN5bmMpLlxuICAgICAgICAgICAgZSA9IGF3YWl0IGh1KHMubG9jYWxTdG9yZSwgSm4oblswXSkpO1xuICAgICAgICAgICAgZm9yIChjb25zdCB0IG9mIG4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gcy5kYy5nZXQodCksIG4gPSBhd2FpdCBoYShzLCBlKTtcbiAgICAgICAgICAgICAgICBuLnNuYXBzaG90ICYmIHIucHVzaChuLnNuYXBzaG90KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIEZvciBxdWVyaWVzIHRoYXQgbmV2ZXIgZXhlY3V0ZWQgb24gdGhpcyBjbGllbnQsIHdlIG5lZWQgdG9cbiAgICAgICAgICAgIC8vIGFsbG9jYXRlIHRoZSB0YXJnZXQgaW4gTG9jYWxTdG9yZSBhbmQgaW5pdGlhbGl6ZSBhIG5ldyBWaWV3LlxuICAgICAgICAgICAgY29uc3QgbiA9IGF3YWl0IGR1KHMubG9jYWxTdG9yZSwgdCk7XG4gICAgICAgICAgICBlID0gYXdhaXQgaHUocy5sb2NhbFN0b3JlLCBuKSwgYXdhaXQgUWMocywgd2EobiksIHQsIFxuICAgICAgICAgICAgLypjdXJyZW50PSovICExLCBlLnJlc3VtZVRva2VuKTtcbiAgICAgICAgfVxuICAgICAgICBpLnB1c2goZSk7XG4gICAgfVxuICAgIHJldHVybiBzLmZjLmV1KHIpLCBpO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBgUXVlcnlgIG9iamVjdCBmcm9tIHRoZSBzcGVjaWZpZWQgYFRhcmdldGAuIFRoZXJlIGlzIG5vIHdheSB0b1xuICogb2J0YWluIHRoZSBvcmlnaW5hbCBgUXVlcnlgLCBzbyB3ZSBzeW50aGVzaXplIGEgYFF1ZXJ5YCBmcm9tIHRoZSBgVGFyZ2V0YFxuICogb2JqZWN0LlxuICpcbiAqIFRoZSBzeW50aGVzaXplZCByZXN1bHQgbWlnaHQgYmUgZGlmZmVyZW50IGZyb20gdGhlIG9yaWdpbmFsIGBRdWVyeWAsIGJ1dFxuICogc2luY2UgdGhlIHN5bnRoZXNpemVkIGBRdWVyeWAgc2hvdWxkIHJldHVybiB0aGUgc2FtZSByZXN1bHRzIGFzIHRoZVxuICogb3JpZ2luYWwgb25lIChvbmx5IHRoZSBwcmVzZW50YXRpb24gb2YgcmVzdWx0cyBtaWdodCBkaWZmZXIpLCB0aGUgcG90ZW50aWFsXG4gKiBkaWZmZXJlbmNlIHdpbGwgbm90IGNhdXNlIGlzc3Vlcy5cbiAqL1xuLy8gUE9SVElORyBOT1RFOiBNdWx0aS1UYWIgb25seS5cbmZ1bmN0aW9uIHdhKHQpIHtcbiAgICByZXR1cm4gS24odC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5vcmRlckJ5LCB0LmZpbHRlcnMsIHQubGltaXQsIFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyAsIHQuc3RhcnRBdCwgdC5lbmRBdCk7XG59XG5cbi8qKiBSZXR1cm5zIHRoZSBJRHMgb2YgdGhlIGNsaWVudHMgdGhhdCBhcmUgY3VycmVudGx5IGFjdGl2ZS4gKi9cbi8vIFBPUlRJTkcgTk9URTogTXVsdGktVGFiIG9ubHkuXG5mdW5jdGlvbiBtYSh0KSB7XG4gICAgY29uc3QgZSA9IEwodCk7XG4gICAgcmV0dXJuIEwoTChlLmxvY2FsU3RvcmUpLnBlcnNpc3RlbmNlKS5NaSgpO1xufVxuXG4vKiogQXBwbGllcyBhIHF1ZXJ5IHRhcmdldCBjaGFuZ2UgZnJvbSBhIGRpZmZlcmVudCB0YWIuICovXG4vLyBQT1JUSU5HIE5PVEU6IE11bHRpLVRhYiBvbmx5LlxuYXN5bmMgZnVuY3Rpb24gZ2EodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSBMKHQpO1xuICAgIGlmIChpLkFjKSBcbiAgICAvLyBJZiB3ZSByZWNlaXZlIGEgdGFyZ2V0IHN0YXRlIG5vdGlmaWNhdGlvbiB2aWEgV2ViU3RvcmFnZSwgd2UgYXJlXG4gICAgLy8gZWl0aGVyIGFscmVhZHkgc2Vjb25kYXJ5IG9yIGFub3RoZXIgdGFiIGhhcyB0YWtlbiB0aGUgcHJpbWFyeSBsZWFzZS5cbiAgICByZXR1cm4gdm9pZCBOKFwiU3luY0VuZ2luZVwiLCBcIklnbm9yaW5nIHVuZXhwZWN0ZWQgcXVlcnkgc3RhdGUgbm90aWZpY2F0aW9uLlwiKTtcbiAgICBjb25zdCByID0gaS5fYy5nZXQoZSk7XG4gICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSBzd2l0Y2ggKG4pIHtcbiAgICAgIGNhc2UgXCJjdXJyZW50XCI6XG4gICAgICBjYXNlIFwibm90LWN1cnJlbnRcIjpcbiAgICAgICAge1xuICAgICAgICAgICAgY29uc3QgdCA9IGF3YWl0IF91KGkubG9jYWxTdG9yZSwgc3MoclswXSkpLCBzID0gbWkuY3JlYXRlU3ludGhlc2l6ZWRSZW1vdGVFdmVudEZvckN1cnJlbnRDaGFuZ2UoZSwgXCJjdXJyZW50XCIgPT09IG4sIFZlLkVNUFRZX0JZVEVfU1RSSU5HKTtcbiAgICAgICAgICAgIGF3YWl0IHVhKGksIHQsIHMpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cblxuICAgICAgY2FzZSBcInJlamVjdGVkXCI6XG4gICAgICAgIGF3YWl0IGx1KGkubG9jYWxTdG9yZSwgZSwgXG4gICAgICAgIC8qIGtlZXBQZXJzaXN0ZWRUYXJnZXREYXRhICovICEwKSwgbmEoaSwgZSwgcyk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICAkKCk7XG4gICAgfVxufVxuXG4vKiogQWRkcyBvciByZW1vdmVzIFdhdGNoIHRhcmdldHMgZm9yIHF1ZXJpZXMgZnJvbSBkaWZmZXJlbnQgdGFicy4gKi8gYXN5bmMgZnVuY3Rpb24geWEodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBwYSh0KTtcbiAgICBpZiAocy5BYykge1xuICAgICAgICBmb3IgKGNvbnN0IHQgb2YgZSkge1xuICAgICAgICAgICAgaWYgKHMuX2MuaGFzKHQpKSB7XG4gICAgICAgICAgICAgICAgLy8gQSB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuIGFkZGVkIGluIGEgcHJldmlvdXMgYXR0ZW1wdFxuICAgICAgICAgICAgICAgIE4oXCJTeW5jRW5naW5lXCIsIFwiQWRkaW5nIGFuIGFscmVhZHkgYWN0aXZlIHRhcmdldCBcIiArIHQpO1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgZSA9IGF3YWl0IGR1KHMubG9jYWxTdG9yZSwgdCksIG4gPSBhd2FpdCBodShzLmxvY2FsU3RvcmUsIGUpO1xuICAgICAgICAgICAgYXdhaXQgUWMocywgd2EoZSksIG4udGFyZ2V0SWQsIFxuICAgICAgICAgICAgLypjdXJyZW50PSovICExLCBuLnJlc3VtZVRva2VuKSwgSHUocy5yZW1vdGVTdG9yZSwgbik7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCB0IG9mIG4pIFxuICAgICAgICAvLyBDaGVjayB0aGF0IHRoZSB0YXJnZXQgaXMgc3RpbGwgYWN0aXZlIHNpbmNlIHRoZSB0YXJnZXQgbWlnaHQgaGF2ZSBiZWVuXG4gICAgICAgIC8vIHJlbW92ZWQgaWYgaXQgaGFzIGJlZW4gcmVqZWN0ZWQgYnkgdGhlIGJhY2tlbmQuXG4gICAgICAgIHMuX2MuaGFzKHQpICYmIFxuICAgICAgICAvLyBSZWxlYXNlIHF1ZXJpZXMgdGhhdCBhcmUgc3RpbGwgYWN0aXZlLlxuICAgICAgICBhd2FpdCBsdShzLmxvY2FsU3RvcmUsIHQsIFxuICAgICAgICAvKiBrZWVwUGVyc2lzdGVkVGFyZ2V0RGF0YSAqLyAhMSkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgSnUocy5yZW1vdGVTdG9yZSwgdCksIG5hKHMsIHQpO1xuICAgICAgICB9KSkuY2F0Y2goUnQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcGEodCkge1xuICAgIGNvbnN0IGUgPSBMKHQpO1xuICAgIHJldHVybiBlLnJlbW90ZVN0b3JlLnJlbW90ZVN5bmNlci5hcHBseVJlbW90ZUV2ZW50ID0gV2MuYmluZChudWxsLCBlKSwgZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIuZ2V0UmVtb3RlS2V5c0ZvclRhcmdldCA9IGFhLmJpbmQobnVsbCwgZSksIFxuICAgIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLnJlamVjdExpc3RlbiA9IEpjLmJpbmQobnVsbCwgZSksIGUuZmMuZXUgPSBEYy5iaW5kKG51bGwsIGUuZXZlbnRNYW5hZ2VyKSwgXG4gICAgZS5mYy52YyA9IENjLmJpbmQobnVsbCwgZS5ldmVudE1hbmFnZXIpLCBlO1xufVxuXG5mdW5jdGlvbiBJYSh0KSB7XG4gICAgY29uc3QgZSA9IEwodCk7XG4gICAgcmV0dXJuIGUucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmFwcGx5U3VjY2Vzc2Z1bFdyaXRlID0gWWMuYmluZChudWxsLCBlKSwgZS5yZW1vdGVTdG9yZS5yZW1vdGVTeW5jZXIucmVqZWN0RmFpbGVkV3JpdGUgPSBYYy5iaW5kKG51bGwsIGUpLCBcbiAgICBlO1xufVxuXG4vKipcbiAqIExvYWRzIGEgRmlyZXN0b3JlIGJ1bmRsZSBpbnRvIHRoZSBTREsuIFRoZSByZXR1cm5lZCBwcm9taXNlIHJlc29sdmVzIHdoZW5cbiAqIHRoZSBidW5kbGUgZmluaXNoZWQgbG9hZGluZy5cbiAqXG4gKiBAcGFyYW0gc3luY0VuZ2luZSAtIFN5bmNFbmdpbmUgdG8gdXNlLlxuICogQHBhcmFtIGJ1bmRsZVJlYWRlciAtIEJ1bmRsZSB0byBsb2FkIGludG8gdGhlIFNESy5cbiAqIEBwYXJhbSB0YXNrIC0gTG9hZEJ1bmRsZVRhc2sgdXNlZCB0byB1cGRhdGUgdGhlIGxvYWRpbmcgcHJvZ3Jlc3MgdG8gcHVibGljIEFQSS5cbiAqLyBmdW5jdGlvbiBUYSh0LCBlLCBuKSB7XG4gICAgY29uc3QgcyA9IEwodCk7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICAoXG4gICAgLyoqIExvYWRzIGEgYnVuZGxlIGFuZCByZXR1cm5zIHRoZSBsaXN0IG9mIGFmZmVjdGVkIGNvbGxlY3Rpb24gZ3JvdXBzLiAqL1xuICAgIGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBlLmdldE1ldGFkYXRhKCk7XG4gICAgICAgICAgICBpZiAoYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gTmkoZS5jcmVhdGVUaW1lKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbi5wZXJzaXN0ZW5jZS5ydW5UcmFuc2FjdGlvbihcImhhc05ld2VyQnVuZGxlXCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5Mcy5nZXRCdW5kbGVNZXRhZGF0YSh0LCBlLmlkKSkpLnRoZW4oKHQgPT4gISF0ICYmIHQuY3JlYXRlVGltZS5jb21wYXJlVG8ocykgPj0gMCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBTYXZlcyB0aGUgZ2l2ZW4gYEJ1bmRsZU1ldGFkYXRhYCB0byBsb2NhbCBwZXJzaXN0ZW5jZS5cbiAqLyAodC5sb2NhbFN0b3JlLCBzKSkgcmV0dXJuIGF3YWl0IGUuY2xvc2UoKSwgbi5fY29tcGxldGVXaXRoKGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICB0YXNrU3RhdGU6IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudHNMb2FkZWQ6IHQudG90YWxEb2N1bWVudHMsXG4gICAgICAgICAgICAgICAgICAgIGJ5dGVzTG9hZGVkOiB0LnRvdGFsQnl0ZXMsXG4gICAgICAgICAgICAgICAgICAgIHRvdGFsRG9jdW1lbnRzOiB0LnRvdGFsRG9jdW1lbnRzLFxuICAgICAgICAgICAgICAgICAgICB0b3RhbEJ5dGVzOiB0LnRvdGFsQnl0ZXNcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfShzKSksIFByb21pc2UucmVzb2x2ZShuZXcgU2V0KTtcbiAgICAgICAgICAgIG4uX3VwZGF0ZVByb2dyZXNzKCRjKHMpKTtcbiAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgT2MocywgdC5sb2NhbFN0b3JlLCBlLnNlcmlhbGl6ZXIpO1xuICAgICAgICAgICAgbGV0IHIgPSBhd2FpdCBlLlBjKCk7XG4gICAgICAgICAgICBmb3IgKDtyOyApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gYXdhaXQgaS5qdShyKTtcbiAgICAgICAgICAgICAgICB0ICYmIG4uX3VwZGF0ZVByb2dyZXNzKHQpLCByID0gYXdhaXQgZS5QYygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgbyA9IGF3YWl0IGkuY29tcGxldGUoKTtcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB1YSh0LCBvLkh1LCBcbiAgICAgICAgICAgIC8qIHJlbW90ZUV2ZW50ICovIHZvaWQgMCksIFxuICAgICAgICAgICAgLy8gU2F2ZSBtZXRhZGF0YSwgc28gbG9hZGluZyB0aGUgc2FtZSBidW5kbGUgd2lsbCBza2lwLlxuICAgICAgICAgICAgYXdhaXQgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG4gPSBMKHQpO1xuICAgICAgICAgICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiU2F2ZSBidW5kbGVcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gbi5Mcy5zYXZlQnVuZGxlTWV0YWRhdGEodCwgZSkpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8qKlxuICogUmV0dXJucyBhIHByb21pc2Ugb2YgYSBgTmFtZWRRdWVyeWAgYXNzb2NpYXRlZCB3aXRoIGdpdmVuIHF1ZXJ5IG5hbWUuIFByb21pc2VcbiAqIHJlc29sdmVzIHRvIHVuZGVmaW5lZCBpZiBubyBwZXJzaXN0ZWQgZGF0YSBjYW4gYmUgZm91bmQuXG4gKi8gKHQubG9jYWxTdG9yZSwgcyksIG4uX2NvbXBsZXRlV2l0aChvLnByb2dyZXNzKSwgUHJvbWlzZS5yZXNvbHZlKG8uV3UpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICByZXR1cm4gTShcIlN5bmNFbmdpbmVcIiwgYExvYWRpbmcgYnVuZGxlIGZhaWxlZCB3aXRoICR7dH1gKSwgbi5fZmFpbFdpdGgodCksIFByb21pc2UucmVzb2x2ZShuZXcgU2V0KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgIC8qKlxuICogUHJvdmlkZXMgYWxsIGNvbXBvbmVudHMgbmVlZGVkIGZvciBGaXJlc3RvcmUgd2l0aCBpbi1tZW1vcnkgcGVyc2lzdGVuY2UuXG4gKiBVc2VzIEVhZ2VyR0MgZ2FyYmFnZSBjb2xsZWN0aW9uLlxuICovKShzLCBlLCBuKS50aGVuKCh0ID0+IHtcbiAgICAgICAgcy5zaGFyZWRDbGllbnRTdGF0ZS5ub3RpZnlCdW5kbGVMb2FkZWQodCk7XG4gICAgfSkpO1xufVxuXG5jbGFzcyBFYSB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuc3luY2hyb25pemVUYWJzID0gITE7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICB0aGlzLnNlcmlhbGl6ZXIgPSBGdSh0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkKSwgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZSA9IHRoaXMuY3JlYXRlU2hhcmVkQ2xpZW50U3RhdGUodCksIFxuICAgICAgICB0aGlzLnBlcnNpc3RlbmNlID0gdGhpcy5jcmVhdGVQZXJzaXN0ZW5jZSh0KSwgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zdGFydCgpLCB0aGlzLmxvY2FsU3RvcmUgPSB0aGlzLmNyZWF0ZUxvY2FsU3RvcmUodCksIFxuICAgICAgICB0aGlzLmdjU2NoZWR1bGVyID0gdGhpcy5jcmVhdGVHYXJiYWdlQ29sbGVjdGlvblNjaGVkdWxlcih0LCB0aGlzLmxvY2FsU3RvcmUpLCB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlciA9IHRoaXMuY3JlYXRlSW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyKHQsIHRoaXMubG9jYWxTdG9yZSk7XG4gICAgfVxuICAgIGNyZWF0ZUdhcmJhZ2VDb2xsZWN0aW9uU2NoZWR1bGVyKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNyZWF0ZUluZGV4QmFja2ZpbGxlclNjaGVkdWxlcih0LCBlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjcmVhdGVMb2NhbFN0b3JlKHQpIHtcbiAgICAgICAgcmV0dXJuIHN1KHRoaXMucGVyc2lzdGVuY2UsIG5ldyBldSwgdC5pbml0aWFsVXNlciwgdGhpcy5zZXJpYWxpemVyKTtcbiAgICB9XG4gICAgY3JlYXRlUGVyc2lzdGVuY2UodCkge1xuICAgICAgICByZXR1cm4gbmV3IEtvKFFvLmpzLCB0aGlzLnNlcmlhbGl6ZXIpO1xuICAgIH1cbiAgICBjcmVhdGVTaGFyZWRDbGllbnRTdGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgYnU7XG4gICAgfVxuICAgIGFzeW5jIHRlcm1pbmF0ZSgpIHtcbiAgICAgICAgdGhpcy5nY1NjaGVkdWxlciAmJiB0aGlzLmdjU2NoZWR1bGVyLnN0b3AoKSwgYXdhaXQgdGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zaHV0ZG93bigpLCBcbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5zaHV0ZG93bigpO1xuICAgIH1cbn1cblxuY2xhc3MgQWEgZXh0ZW5kcyBFYSB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gdDtcbiAgICB9XG4gICAgY3JlYXRlR2FyYmFnZUNvbGxlY3Rpb25TY2hlZHVsZXIodCwgZSkge1xuICAgICAgICBGKHRoaXMucGVyc2lzdGVuY2UucmVmZXJlbmNlRGVsZWdhdGUgaW5zdGFuY2VvZiBqbyk7XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnBlcnNpc3RlbmNlLnJlZmVyZW5jZURlbGVnYXRlLmdhcmJhZ2VDb2xsZWN0b3I7XG4gICAgICAgIHJldHVybiBuZXcgcG8obiwgdC5hc3luY1F1ZXVlLCBlKTtcbiAgICB9XG4gICAgY3JlYXRlUGVyc2lzdGVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdm9pZCAwICE9PSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID8gc28ud2l0aENhY2hlU2l6ZSh0aGlzLmNhY2hlU2l6ZUJ5dGVzKSA6IHNvLkRFRkFVTFQ7XG4gICAgICAgIHJldHVybiBuZXcgS28oKHQgPT4gam8uanModCwgZSkpLCB0aGlzLnNlcmlhbGl6ZXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBQcm92aWRlcyBhbGwgY29tcG9uZW50cyBuZWVkZWQgZm9yIEZpcmVzdG9yZSB3aXRoIEluZGV4ZWREQiBwZXJzaXN0ZW5jZS5cbiAqLyBjbGFzcyBSYSBleHRlbmRzIEVhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuYmMgPSB0LCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZSwgdGhpcy5mb3JjZU93bmVyc2hpcCA9IG4sIHRoaXMuc3luY2hyb25pemVUYWJzID0gITE7XG4gICAgfVxuICAgIGFzeW5jIGluaXRpYWxpemUodCkge1xuICAgICAgICBhd2FpdCBzdXBlci5pbml0aWFsaXplKHQpLCBhd2FpdCB0aGlzLmJjLmluaXRpYWxpemUodGhpcywgdCksIFxuICAgICAgICAvLyBFbnF1ZXVlIHdyaXRlcyBmcm9tIGEgcHJldmlvdXMgc2Vzc2lvblxuICAgICAgICBhd2FpdCBJYSh0aGlzLmJjLnN5bmNFbmdpbmUpLCBhd2FpdCBjYyh0aGlzLmJjLnJlbW90ZVN0b3JlKSwgXG4gICAgICAgIC8vIE5PVEU6IFRoaXMgd2lsbCBpbW1lZGlhdGVseSBjYWxsIHRoZSBsaXN0ZW5lciwgc28gd2UgbWFrZSBzdXJlIHRvXG4gICAgICAgIC8vIHNldCBpdCBhZnRlciBsb2NhbFN0b3JlIC8gcmVtb3RlU3RvcmUgYXJlIHN0YXJ0ZWQuXG4gICAgICAgIGF3YWl0IHRoaXMucGVyc2lzdGVuY2UucGkoKCgpID0+ICh0aGlzLmdjU2NoZWR1bGVyICYmICF0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0ZWQgJiYgdGhpcy5nY1NjaGVkdWxlci5zdGFydCgpLCBcbiAgICAgICAgdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIgJiYgIXRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyLnN0YXJ0ZWQgJiYgdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIuc3RhcnQoKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpO1xuICAgIH1cbiAgICBjcmVhdGVMb2NhbFN0b3JlKHQpIHtcbiAgICAgICAgcmV0dXJuIHN1KHRoaXMucGVyc2lzdGVuY2UsIG5ldyBldSwgdC5pbml0aWFsVXNlciwgdGhpcy5zZXJpYWxpemVyKTtcbiAgICB9XG4gICAgY3JlYXRlR2FyYmFnZUNvbGxlY3Rpb25TY2hlZHVsZXIodCwgZSkge1xuICAgICAgICBjb25zdCBuID0gdGhpcy5wZXJzaXN0ZW5jZS5yZWZlcmVuY2VEZWxlZ2F0ZS5nYXJiYWdlQ29sbGVjdG9yO1xuICAgICAgICByZXR1cm4gbmV3IHBvKG4sIHQuYXN5bmNRdWV1ZSwgZSk7XG4gICAgfVxuICAgIGNyZWF0ZUluZGV4QmFja2ZpbGxlclNjaGVkdWxlcih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgT3QoZSwgdGhpcy5wZXJzaXN0ZW5jZSk7XG4gICAgICAgIHJldHVybiBuZXcgTXQodC5hc3luY1F1ZXVlLCBuKTtcbiAgICB9XG4gICAgY3JlYXRlUGVyc2lzdGVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gWm8odC5kYXRhYmFzZUluZm8uZGF0YWJhc2VJZCwgdC5kYXRhYmFzZUluZm8ucGVyc2lzdGVuY2VLZXkpLCBuID0gdm9pZCAwICE9PSB0aGlzLmNhY2hlU2l6ZUJ5dGVzID8gc28ud2l0aENhY2hlU2l6ZSh0aGlzLmNhY2hlU2l6ZUJ5dGVzKSA6IHNvLkRFRkFVTFQ7XG4gICAgICAgIHJldHVybiBuZXcgSm8odGhpcy5zeW5jaHJvbml6ZVRhYnMsIGUsIHQuY2xpZW50SWQsIG4sIHQuYXN5bmNRdWV1ZSwgT3UoKSwgJHUoKSwgdGhpcy5zZXJpYWxpemVyLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLCAhIXRoaXMuZm9yY2VPd25lcnNoaXApO1xuICAgIH1cbiAgICBjcmVhdGVTaGFyZWRDbGllbnRTdGF0ZSh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgYnU7XG4gICAgfVxufVxuXG4vKipcbiAqIFByb3ZpZGVzIGFsbCBjb21wb25lbnRzIG5lZWRlZCBmb3IgRmlyZXN0b3JlIHdpdGggbXVsdGktdGFiIEluZGV4ZWREQlxuICogcGVyc2lzdGVuY2UuXG4gKlxuICogSW4gdGhlIGxlZ2FjeSBjbGllbnQsIHRoaXMgcHJvdmlkZXIgaXMgdXNlZCB0byBwcm92aWRlIGJvdGggbXVsdGktdGFiIGFuZFxuICogbm9uLW11bHRpLXRhYiBwZXJzaXN0ZW5jZSBzaW5jZSB3ZSBjYW5ub3QgdGVsbCBhdCBidWlsZCB0aW1lIHdoZXRoZXJcbiAqIGBzeW5jaHJvbml6ZVRhYnNgIHdpbGwgYmUgZW5hYmxlZC5cbiAqLyBjbGFzcyB2YSBleHRlbmRzIFJhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIC8qIGZvcmNlT3duZXJzaGlwPSAqLyAhMSksIHRoaXMuYmMgPSB0LCB0aGlzLmNhY2hlU2l6ZUJ5dGVzID0gZSwgdGhpcy5zeW5jaHJvbml6ZVRhYnMgPSAhMDtcbiAgICB9XG4gICAgYXN5bmMgaW5pdGlhbGl6ZSh0KSB7XG4gICAgICAgIGF3YWl0IHN1cGVyLmluaXRpYWxpemUodCk7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmJjLnN5bmNFbmdpbmU7XG4gICAgICAgIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUgaW5zdGFuY2VvZiBQdSAmJiAodGhpcy5zaGFyZWRDbGllbnRTdGF0ZS5zeW5jRW5naW5lID0ge1xuICAgICAgICAgICAgUXI6IGZhLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBqcjogZ2EuYmluZChudWxsLCBlKSxcbiAgICAgICAgICAgIHpyOiB5YS5iaW5kKG51bGwsIGUpLFxuICAgICAgICAgICAgTWk6IG1hLmJpbmQobnVsbCwgZSksXG4gICAgICAgICAgICBHcjogbGEuYmluZChudWxsLCBlKVxuICAgICAgICB9LCBhd2FpdCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLnN0YXJ0KCkpLCBcbiAgICAgICAgLy8gTk9URTogVGhpcyB3aWxsIGltbWVkaWF0ZWx5IGNhbGwgdGhlIGxpc3RlbmVyLCBzbyB3ZSBtYWtlIHN1cmUgdG9cbiAgICAgICAgLy8gc2V0IGl0IGFmdGVyIGxvY2FsU3RvcmUgLyByZW1vdGVTdG9yZSBhcmUgc3RhcnRlZC5cbiAgICAgICAgYXdhaXQgdGhpcy5wZXJzaXN0ZW5jZS5waSgoYXN5bmMgdCA9PiB7XG4gICAgICAgICAgICBhd2FpdCBkYSh0aGlzLmJjLnN5bmNFbmdpbmUsIHQpLCB0aGlzLmdjU2NoZWR1bGVyICYmICh0ICYmICF0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0ZWQgPyB0aGlzLmdjU2NoZWR1bGVyLnN0YXJ0KCkgOiB0IHx8IHRoaXMuZ2NTY2hlZHVsZXIuc3RvcCgpKSwgXG4gICAgICAgICAgICB0aGlzLmluZGV4QmFja2ZpbGxlclNjaGVkdWxlciAmJiAodCAmJiAhdGhpcy5pbmRleEJhY2tmaWxsZXJTY2hlZHVsZXIuc3RhcnRlZCA/IHRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyLnN0YXJ0KCkgOiB0IHx8IHRoaXMuaW5kZXhCYWNrZmlsbGVyU2NoZWR1bGVyLnN0b3AoKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgY3JlYXRlU2hhcmVkQ2xpZW50U3RhdGUodCkge1xuICAgICAgICBjb25zdCBlID0gT3UoKTtcbiAgICAgICAgaWYgKCFQdS5EKGUpKSB0aHJvdyBuZXcgVShxLlVOSU1QTEVNRU5URUQsIFwiSW5kZXhlZERCIHBlcnNpc3RlbmNlIGlzIG9ubHkgYXZhaWxhYmxlIG9uIHBsYXRmb3JtcyB0aGF0IHN1cHBvcnQgTG9jYWxTdG9yYWdlLlwiKTtcbiAgICAgICAgY29uc3QgbiA9IFpvKHQuZGF0YWJhc2VJbmZvLmRhdGFiYXNlSWQsIHQuZGF0YWJhc2VJbmZvLnBlcnNpc3RlbmNlS2V5KTtcbiAgICAgICAgcmV0dXJuIG5ldyBQdShlLCB0LmFzeW5jUXVldWUsIG4sIHQuY2xpZW50SWQsIHQuaW5pdGlhbFVzZXIpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBJbml0aWFsaXplcyBhbmQgd2lyZXMgdGhlIGNvbXBvbmVudHMgdGhhdCBhcmUgbmVlZGVkIHRvIGludGVyZmFjZSB3aXRoIHRoZVxuICogbmV0d29yay5cbiAqLyBjbGFzcyBQYSB7XG4gICAgYXN5bmMgaW5pdGlhbGl6ZSh0LCBlKSB7XG4gICAgICAgIHRoaXMubG9jYWxTdG9yZSB8fCAodGhpcy5sb2NhbFN0b3JlID0gdC5sb2NhbFN0b3JlLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlID0gdC5zaGFyZWRDbGllbnRTdGF0ZSwgXG4gICAgICAgIHRoaXMuZGF0YXN0b3JlID0gdGhpcy5jcmVhdGVEYXRhc3RvcmUoZSksIHRoaXMucmVtb3RlU3RvcmUgPSB0aGlzLmNyZWF0ZVJlbW90ZVN0b3JlKGUpLCBcbiAgICAgICAgdGhpcy5ldmVudE1hbmFnZXIgPSB0aGlzLmNyZWF0ZUV2ZW50TWFuYWdlcihlKSwgdGhpcy5zeW5jRW5naW5lID0gdGhpcy5jcmVhdGVTeW5jRW5naW5lKGUsIFxuICAgICAgICAvKiBzdGFydEFzUHJpbWFyeT0qLyAhdC5zeW5jaHJvbml6ZVRhYnMpLCB0aGlzLnNoYXJlZENsaWVudFN0YXRlLm9ubGluZVN0YXRlSGFuZGxlciA9IHQgPT4gSGModGhpcy5zeW5jRW5naW5lLCB0LCAxIC8qIE9ubGluZVN0YXRlU291cmNlLlNoYXJlZENsaWVudFN0YXRlICovKSwgXG4gICAgICAgIHRoaXMucmVtb3RlU3RvcmUucmVtb3RlU3luY2VyLmhhbmRsZUNyZWRlbnRpYWxDaGFuZ2UgPSBjYS5iaW5kKG51bGwsIHRoaXMuc3luY0VuZ2luZSksIFxuICAgICAgICBhd2FpdCB5Yyh0aGlzLnJlbW90ZVN0b3JlLCB0aGlzLnN5bmNFbmdpbmUuaXNQcmltYXJ5Q2xpZW50KSk7XG4gICAgfVxuICAgIGNyZWF0ZUV2ZW50TWFuYWdlcih0KSB7XG4gICAgICAgIHJldHVybiBuZXcgYmM7XG4gICAgfVxuICAgIGNyZWF0ZURhdGFzdG9yZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBGdSh0LmRhdGFiYXNlSW5mby5kYXRhYmFzZUlkKSwgbiA9IChzID0gdC5kYXRhYmFzZUluZm8sIG5ldyBNdShzKSk7XG4gICAgICAgIHZhciBzO1xuICAgICAgICAvKiogUmV0dXJuIHRoZSBQbGF0Zm9ybS1zcGVjaWZpYyBjb25uZWN0aXZpdHkgbW9uaXRvci4gKi8gICAgICAgIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEt1KHQsIGUsIG4sIHMpO1xuICAgICAgICB9KHQuYXV0aENyZWRlbnRpYWxzLCB0LmFwcENoZWNrQ3JlZGVudGlhbHMsIG4sIGUpO1xuICAgIH1cbiAgICBjcmVhdGVSZW1vdGVTdG9yZSh0KSB7XG4gICAgICAgIHJldHVybiBlID0gdGhpcy5sb2NhbFN0b3JlLCBuID0gdGhpcy5kYXRhc3RvcmUsIHMgPSB0LmFzeW5jUXVldWUsIGkgPSB0ID0+IEhjKHRoaXMuc3luY0VuZ2luZSwgdCwgMCAvKiBPbmxpbmVTdGF0ZVNvdXJjZS5SZW1vdGVTdG9yZSAqLyksIFxuICAgICAgICByID0gU3UuRCgpID8gbmV3IFN1IDogbmV3IFZ1LCBuZXcganUoZSwgbiwgcywgaSwgcik7XG4gICAgICAgIHZhciBlLCBuLCBzLCBpLCByO1xuICAgICAgICAvKiogUmUtZW5hYmxlcyB0aGUgbmV0d29yay4gSWRlbXBvdGVudC4gKi8gICAgfVxuICAgIGNyZWF0ZVN5bmNFbmdpbmUodCwgZSkge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgXG4gICAgICAgIC8vIFBPUlRJTkcgTk9URTogTWFuYWdlcyBzdGF0ZSBzeW5jaHJvbml6YXRpb24gaW4gbXVsdGktdGFiIGVudmlyb25tZW50cy5cbiAgICAgICAgcywgaSwgciwgbykge1xuICAgICAgICAgICAgY29uc3QgdSA9IG5ldyBLYyh0LCBlLCBuLCBzLCBpLCByKTtcbiAgICAgICAgICAgIHJldHVybiBvICYmICh1LkFjID0gITApLCB1O1xuICAgICAgICB9KHRoaXMubG9jYWxTdG9yZSwgdGhpcy5yZW1vdGVTdG9yZSwgdGhpcy5ldmVudE1hbmFnZXIsIHRoaXMuc2hhcmVkQ2xpZW50U3RhdGUsIHQuaW5pdGlhbFVzZXIsIHQubWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnMsIGUpO1xuICAgIH1cbiAgICB0ZXJtaW5hdGUoKSB7XG4gICAgICAgIHJldHVybiBhc3luYyBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gTCh0KTtcbiAgICAgICAgICAgIE4oXCJSZW1vdGVTdG9yZVwiLCBcIlJlbW90ZVN0b3JlIHNodXR0aW5nIGRvd24uXCIpLCBlLkF1LmFkZCg1IC8qIE9mZmxpbmVDYXVzZS5TaHV0ZG93biAqLyksIFxuICAgICAgICAgICAgYXdhaXQgV3UoZSksIGUudnUuc2h1dGRvd24oKSwgXG4gICAgICAgICAgICAvLyBTZXQgdGhlIE9ubGluZVN0YXRlIHRvIFVua25vd24gKHJhdGhlciB0aGFuIE9mZmxpbmUpIHRvIGF2b2lkIHBvdGVudGlhbGx5XG4gICAgICAgICAgICAvLyB0cmlnZ2VyaW5nIHNwdXJpb3VzIGxpc3RlbmVyIGV2ZW50cyB3aXRoIGNhY2hlZCBkYXRhLCBldGMuXG4gICAgICAgICAgICBlLlB1LnNldChcIlVua25vd25cIiAvKiBPbmxpbmVTdGF0ZS5Vbmtub3duICovKTtcbiAgICAgICAgfSh0aGlzLnJlbW90ZVN0b3JlKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEhvdyBtYW55IGJ5dGVzIHRvIHJlYWQgZWFjaCB0aW1lIHdoZW4gYFJlYWRhYmxlU3RyZWFtUmVhZGVyLnJlYWQoKWAgaXNcbiAqIGNhbGxlZC4gT25seSBhcHBsaWNhYmxlIGZvciBieXRlIHN0cmVhbXMgdGhhdCB3ZSBjb250cm9sIChlLmcuIHRob3NlIGJhY2tlZFxuICogYnkgYW4gVUludDhBcnJheSkuXG4gKi9cbi8qKlxuICogQnVpbGRzIGEgYEJ5dGVTdHJlYW1SZWFkZXJgIGZyb20gYSBVSW50OEFycmF5LlxuICogQHBhcmFtIHNvdXJjZSAtIFRoZSBkYXRhIHNvdXJjZSB0byB1c2UuXG4gKiBAcGFyYW0gYnl0ZXNQZXJSZWFkIC0gSG93IG1hbnkgYnl0ZXMgZWFjaCBgcmVhZCgpYCBmcm9tIHRoZSByZXR1cm5lZCByZWFkZXJcbiAqICAgICAgICB3aWxsIHJlYWQuXG4gKi9cbmZ1bmN0aW9uIGJhKHQsIGUgPSAxMDI0MCkge1xuICAgIGxldCBuID0gMDtcbiAgICAvLyBUaGUgVHlwZVNjcmlwdCBkZWZpbml0aW9uIGZvciBSZWFkYWJsZVN0cmVhbVJlYWRlciBjaGFuZ2VkLiBXZSB1c2VcbiAgICAvLyBgYW55YCBoZXJlIHRvIGFsbG93IHRoaXMgY29kZSB0byBjb21waWxlIHdpdGggZGlmZmVyZW50IHZlcnNpb25zLlxuICAgIC8vIFNlZSBodHRwczovL2dpdGh1Yi5jb20vbWljcm9zb2Z0L1R5cGVTY3JpcHQvaXNzdWVzLzQyOTcwXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgYXN5bmMgcmVhZCgpIHtcbiAgICAgICAgICAgIGlmIChuIDwgdC5ieXRlTGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHQuc2xpY2UobiwgbiArIGUpLFxuICAgICAgICAgICAgICAgICAgICBkb25lOiAhMVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4gKz0gZSwgcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgZG9uZTogITBcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIGNhbmNlbCgpIHt9LFxuICAgICAgICByZWxlYXNlTG9jaygpIHt9LFxuICAgICAgICBjbG9zZWQ6IFByb21pc2UucmVzb2x2ZSgpXG4gICAgfTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogT24gd2ViLCBhIGBSZWFkYWJsZVN0cmVhbWAgaXMgd3JhcHBlZCBhcm91bmQgYnkgYSBgQnl0ZVN0cmVhbVJlYWRlcmAuXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKlxuICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIE9ic2VydmVyPFQ+IHRoYXQgd2lsbCBkaXNwYXRjaCBldmVudHNcbiAqIGFzeW5jaHJvbm91c2x5LiBUbyBhbGxvdyBpbW1lZGlhdGUgc2lsZW5jaW5nLCBhIG11dGUgY2FsbCBpcyBhZGRlZCB3aGljaFxuICogY2F1c2VzIGV2ZW50cyBzY2hlZHVsZWQgdG8gbm8gbG9uZ2VyIGJlIHJhaXNlZC5cbiAqL1xuY2xhc3MgVmEge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlciA9IHQsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hlbiBzZXQgdG8gdHJ1ZSwgd2lsbCBub3QgcmFpc2UgZnV0dXJlIGV2ZW50cy4gTmVjZXNzYXJ5IHRvIGRlYWwgd2l0aFxuICAgICAgICAgKiBhc3luYyBkZXRhY2htZW50IG9mIGxpc3RlbmVyLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5tdXRlZCA9ICExO1xuICAgIH1cbiAgICBuZXh0KHQpIHtcbiAgICAgICAgdGhpcy5vYnNlcnZlci5uZXh0ICYmIHRoaXMuVmModGhpcy5vYnNlcnZlci5uZXh0LCB0KTtcbiAgICB9XG4gICAgZXJyb3IodCkge1xuICAgICAgICB0aGlzLm9ic2VydmVyLmVycm9yID8gdGhpcy5WYyh0aGlzLm9ic2VydmVyLmVycm9yLCB0KSA6IGsoXCJVbmNhdWdodCBFcnJvciBpbiBzbmFwc2hvdCBsaXN0ZW5lcjpcIiwgdC50b1N0cmluZygpKTtcbiAgICB9XG4gICAgU2MoKSB7XG4gICAgICAgIHRoaXMubXV0ZWQgPSAhMDtcbiAgICB9XG4gICAgVmModCwgZSkge1xuICAgICAgICB0aGlzLm11dGVkIHx8IHNldFRpbWVvdXQoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMubXV0ZWQgfHwgdChlKTtcbiAgICAgICAgfSksIDApO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBjbGFzcyByZXByZXNlbnRpbmcgYSBidW5kbGUuXG4gKlxuICogVGFrZXMgYSBidW5kbGUgc3RyZWFtIG9yIGJ1ZmZlciwgYW5kIHByZXNlbnRzIGFic3RyYWN0aW9ucyB0byByZWFkIGJ1bmRsZWRcbiAqIGVsZW1lbnRzIG91dCBvZiB0aGUgdW5kZXJseWluZyBjb250ZW50LlxuICovIGNsYXNzIFNhIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHJlYWRlciB0byByZWFkIGZyb20gdW5kZXJseWluZyBiaW5hcnkgYnVuZGxlIGRhdGEgc291cmNlLiAqL1xuICAgIHQsIGUpIHtcbiAgICAgICAgdGhpcy5EYyA9IHQsIHRoaXMuc2VyaWFsaXplciA9IGUsIFxuICAgICAgICAvKiogQ2FjaGVkIGJ1bmRsZSBtZXRhZGF0YS4gKi9cbiAgICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBLLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEludGVybmFsIGJ1ZmZlciB0byBob2xkIGJ1bmRsZSBjb250ZW50LCBhY2N1bXVsYXRpbmcgaW5jb21wbGV0ZSBlbGVtZW50XG4gICAgICAgICAqIGNvbnRlbnQuXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmJ1ZmZlciA9IG5ldyBVaW50OEFycmF5LCB0aGlzLkNjID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIiksIFxuICAgICAgICAvLyBSZWFkIHRoZSBtZXRhZGF0YSAod2hpY2ggaXMgdGhlIGZpcnN0IGVsZW1lbnQpLlxuICAgICAgICB0aGlzLnhjKCkudGhlbigodCA9PiB7XG4gICAgICAgICAgICB0ICYmIHQuR3UoKSA/IHRoaXMubWV0YWRhdGEucmVzb2x2ZSh0Lkt1Lm1ldGFkYXRhKSA6IHRoaXMubWV0YWRhdGEucmVqZWN0KG5ldyBFcnJvcihgVGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGJ1bmRsZSBpcyBub3QgYSBtZXRhZGF0YSwgaXQgaXNcXG4gICAgICAgICAgICAgJHtKU09OLnN0cmluZ2lmeShudWxsID09IHQgPyB2b2lkIDAgOiB0Lkt1KX1gKSk7XG4gICAgICAgIH0pLCAodCA9PiB0aGlzLm1ldGFkYXRhLnJlamVjdCh0KSkpO1xuICAgIH1cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuRGMuY2FuY2VsKCk7XG4gICAgfVxuICAgIGFzeW5jIGdldE1ldGFkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tZXRhZGF0YS5wcm9taXNlO1xuICAgIH1cbiAgICBhc3luYyBQYygpIHtcbiAgICAgICAgLy8gTWFrZXMgc3VyZSBtZXRhZGF0YSBpcyByZWFkIGJlZm9yZSBwcm9jZWVkaW5nLlxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5nZXRNZXRhZGF0YSgpLCB0aGlzLnhjKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIGZyb20gdGhlIGhlYWQgb2YgaW50ZXJuYWwgYnVmZmVyLCBhbmQgcHVsbGluZyBtb3JlIGRhdGEgZnJvbVxuICAgICAqIHVuZGVybHlpbmcgc3RyZWFtIGlmIGEgY29tcGxldGUgZWxlbWVudCBjYW5ub3QgYmUgZm91bmQsIHVudGlsIGFuXG4gICAgICogZWxlbWVudChpbmNsdWRpbmcgdGhlIHByZWZpeGVkIGxlbmd0aCBhbmQgdGhlIEpTT04gc3RyaW5nKSBpcyBmb3VuZC5cbiAgICAgKlxuICAgICAqIE9uY2UgYSBjb21wbGV0ZSBlbGVtZW50IGlzIHJlYWQsIGl0IGlzIGRyb3BwZWQgZnJvbSBpbnRlcm5hbCBidWZmZXIuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGVpdGhlciB0aGUgYnVuZGxlZCBlbGVtZW50LCBvciBudWxsIGlmIHdlIGhhdmUgcmVhY2hlZCB0aGUgZW5kIG9mXG4gICAgICogdGhlIHN0cmVhbS5cbiAgICAgKi8gICAgYXN5bmMgeGMoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBhd2FpdCB0aGlzLk5jKCk7XG4gICAgICAgIGlmIChudWxsID09PSB0KSByZXR1cm4gbnVsbDtcbiAgICAgICAgY29uc3QgZSA9IHRoaXMuQ2MuZGVjb2RlKHQpLCBuID0gTnVtYmVyKGUpO1xuICAgICAgICBpc05hTihuKSAmJiB0aGlzLmtjKGBsZW5ndGggc3RyaW5nICgke2V9KSBpcyBub3QgdmFsaWQgbnVtYmVyYCk7XG4gICAgICAgIGNvbnN0IHMgPSBhd2FpdCB0aGlzLk1jKG4pO1xuICAgICAgICByZXR1cm4gbmV3IGtjKEpTT04ucGFyc2UocyksIHQubGVuZ3RoICsgbik7XG4gICAgfVxuICAgIC8qKiBGaXJzdCBpbmRleCBvZiAneycgZnJvbSB0aGUgdW5kZXJseWluZyBidWZmZXIuICovICAgIE9jKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5idWZmZXIuZmluZEluZGV4KCh0ID0+IHQgPT09IFwie1wiLmNoYXJDb2RlQXQoMCkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmVhZHMgZnJvbSB0aGUgYmVnaW5uaW5nIG9mIHRoZSBpbnRlcm5hbCBidWZmZXIsIHVudGlsIHRoZSBmaXJzdCAneycsIGFuZFxuICAgICAqIHJldHVybiB0aGUgY29udGVudC5cbiAgICAgKlxuICAgICAqIElmIHJlYWNoZWQgZW5kIG9mIHRoZSBzdHJlYW0sIHJldHVybnMgYSBudWxsLlxuICAgICAqLyAgICBhc3luYyBOYygpIHtcbiAgICAgICAgZm9yICg7dGhpcy5PYygpIDwgMDsgKSB7XG4gICAgICAgICAgICBpZiAoYXdhaXQgdGhpcy4kYygpKSBicmVhaztcbiAgICAgICAgfVxuICAgICAgICAvLyBCcm9rZSBvdXQgb2YgdGhlIGxvb3AgYmVjYXVzZSB1bmRlcmx5aW5nIHN0cmVhbSBpcyBjbG9zZWQsIGFuZCB0aGVyZVxuICAgICAgICAvLyBoYXBwZW5zIHRvIGJlIG5vIG1vcmUgZGF0YSB0byBwcm9jZXNzLlxuICAgICAgICAgICAgICAgIGlmICgwID09PSB0aGlzLmJ1ZmZlci5sZW5ndGgpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5PYygpO1xuICAgICAgICAvLyBCcm9rZSBvdXQgb2YgdGhlIGxvb3AgYmVjYXVzZSB1bmRlcmx5aW5nIHN0cmVhbSBpcyBjbG9zZWQsIGJ1dCBzdGlsbFxuICAgICAgICAvLyBjYW5ub3QgZmluZCBhbiBvcGVuIGJyYWNrZXQuXG4gICAgICAgICAgICAgICAgdCA8IDAgJiYgdGhpcy5rYyhcIlJlYWNoZWQgdGhlIGVuZCBvZiBidW5kbGUgd2hlbiBhIGxlbmd0aCBzdHJpbmcgaXMgZXhwZWN0ZWQuXCIpO1xuICAgICAgICBjb25zdCBlID0gdGhpcy5idWZmZXIuc2xpY2UoMCwgdCk7XG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgaW50ZXJuYWwgYnVmZmVyIHRvIGRyb3AgdGhlIHJlYWQgbGVuZ3RoLlxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmJ1ZmZlciA9IHRoaXMuYnVmZmVyLnNsaWNlKHQpLCBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyBmcm9tIGEgc3BlY2lmaWVkIHBvc2l0aW9uIGZyb20gdGhlIGludGVybmFsIGJ1ZmZlciwgZm9yIGEgc3BlY2lmaWVkXG4gICAgICogbnVtYmVyIG9mIGJ5dGVzLCBwdWxsaW5nIG1vcmUgZGF0YSBmcm9tIHRoZSB1bmRlcmx5aW5nIHN0cmVhbSBpZiBuZWVkZWQuXG4gICAgICpcbiAgICAgKiBSZXR1cm5zIGEgc3RyaW5nIGRlY29kZWQgZnJvbSB0aGUgcmVhZCBieXRlcy5cbiAgICAgKi8gICAgYXN5bmMgTWModCkge1xuICAgICAgICBmb3IgKDt0aGlzLmJ1ZmZlci5sZW5ndGggPCB0OyApIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuJGMoKSAmJiB0aGlzLmtjKFwiUmVhY2hlZCB0aGUgZW5kIG9mIGJ1bmRsZSB3aGVuIG1vcmUgaXMgZXhwZWN0ZWQuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLkNjLmRlY29kZSh0aGlzLmJ1ZmZlci5zbGljZSgwLCB0KSk7XG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgaW50ZXJuYWwgYnVmZmVyIHRvIGRyb3AgdGhlIHJlYWQganNvbiBzdHJpbmcuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuc2xpY2UodCksIGU7XG4gICAgfVxuICAgIGtjKHQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aHJvdyB0aGlzLkRjLmNhbmNlbCgpLCBuZXcgRXJyb3IoYEludmFsaWQgYnVuZGxlIGZvcm1hdDogJHt0fWApO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBQdWxscyBtb3JlIGRhdGEgZnJvbSB1bmRlcmx5aW5nIHN0cmVhbSB0byBpbnRlcm5hbCBidWZmZXIuXG4gICAgICogUmV0dXJucyBhIGJvb2xlYW4gaW5kaWNhdGluZyB3aGV0aGVyIHRoZSBzdHJlYW0gaXMgZmluaXNoZWQuXG4gICAgICovICAgIGFzeW5jICRjKCkge1xuICAgICAgICBjb25zdCB0ID0gYXdhaXQgdGhpcy5EYy5yZWFkKCk7XG4gICAgICAgIGlmICghdC5kb25lKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5idWZmZXIubGVuZ3RoICsgdC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICAgICAgZS5zZXQodGhpcy5idWZmZXIpLCBlLnNldCh0LnZhbHVlLCB0aGlzLmJ1ZmZlci5sZW5ndGgpLCB0aGlzLmJ1ZmZlciA9IGU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQuZG9uZTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEludGVybmFsIHRyYW5zYWN0aW9uIG9iamVjdCByZXNwb25zaWJsZSBmb3IgYWNjdW11bGF0aW5nIHRoZSBtdXRhdGlvbnMgdG9cbiAqIHBlcmZvcm0gYW5kIHRoZSBiYXNlIHZlcnNpb25zIGZvciBhbnkgZG9jdW1lbnRzIHJlYWQuXG4gKi9cbmNsYXNzIERhIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZGF0YXN0b3JlID0gdCwgXG4gICAgICAgIC8vIFRoZSB2ZXJzaW9uIG9mIGVhY2ggZG9jdW1lbnQgdGhhdCB3YXMgcmVhZCBkdXJpbmcgdGhpcyB0cmFuc2FjdGlvbi5cbiAgICAgICAgdGhpcy5yZWFkVmVyc2lvbnMgPSBuZXcgTWFwLCB0aGlzLm11dGF0aW9ucyA9IFtdLCB0aGlzLmNvbW1pdHRlZCA9ICExLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgZGVmZXJyZWQgdXNhZ2UgZXJyb3IgdGhhdCBvY2N1cnJlZCBwcmV2aW91c2x5IGluIHRoaXMgdHJhbnNhY3Rpb24gdGhhdFxuICAgICAgICAgKiB3aWxsIGNhdXNlIHRoZSB0cmFuc2FjdGlvbiB0byBmYWlsIG9uY2UgaXQgYWN0dWFsbHkgY29tbWl0cy5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMubGFzdFdyaXRlRXJyb3IgPSBudWxsLCBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFNldCBvZiBkb2N1bWVudHMgdGhhdCBoYXZlIGJlZW4gd3JpdHRlbiBpbiB0aGUgdHJhbnNhY3Rpb24uXG4gICAgICAgICAqXG4gICAgICAgICAqIFdoZW4gdGhlcmUncyBtb3JlIHRoYW4gb25lIHdyaXRlIHRvIHRoZSBzYW1lIGtleSBpbiBhIHRyYW5zYWN0aW9uLCBhbnlcbiAgICAgICAgICogd3JpdGVzIGFmdGVyIHRoZSBmaXJzdCBhcmUgaGFuZGxlZCBkaWZmZXJlbnRseS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMud3JpdHRlbkRvY3MgPSBuZXcgU2V0O1xuICAgIH1cbiAgICBhc3luYyBsb29rdXAodCkge1xuICAgICAgICBpZiAodGhpcy5lbnN1cmVDb21taXROb3RDYWxsZWQoKSwgdGhpcy5tdXRhdGlvbnMubGVuZ3RoID4gMCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkZpcmVzdG9yZSB0cmFuc2FjdGlvbnMgcmVxdWlyZSBhbGwgcmVhZHMgdG8gYmUgZXhlY3V0ZWQgYmVmb3JlIGFsbCB3cml0ZXMuXCIpO1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IEwodCksIHMgPSBMaShuLnNlcmlhbGl6ZXIpICsgXCIvZG9jdW1lbnRzXCIsIGkgPSB7XG4gICAgICAgICAgICAgICAgZG9jdW1lbnRzOiBlLm1hcCgodCA9PiBPaShuLnNlcmlhbGl6ZXIsIHQpKSlcbiAgICAgICAgICAgIH0sIHIgPSBhd2FpdCBuLkFvKFwiQmF0Y2hHZXREb2N1bWVudHNcIiwgcywgaSwgZS5sZW5ndGgpLCBvID0gbmV3IE1hcDtcbiAgICAgICAgICAgIHIuZm9yRWFjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IEdpKG4uc2VyaWFsaXplciwgdCk7XG4gICAgICAgICAgICAgICAgby5zZXQoZS5rZXkudG9TdHJpbmcoKSwgZSk7XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICBjb25zdCB1ID0gW107XG4gICAgICAgICAgICByZXR1cm4gZS5mb3JFYWNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBlID0gby5nZXQodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgICAgICBGKCEhZSksIHUucHVzaChlKTtcbiAgICAgICAgICAgIH0pKSwgdTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdCk7XG4gICAgICAgIHJldHVybiBlLmZvckVhY2goKHQgPT4gdGhpcy5yZWNvcmRWZXJzaW9uKHQpKSksIGU7XG4gICAgfVxuICAgIHNldCh0LCBlKSB7XG4gICAgICAgIHRoaXMud3JpdGUoZS50b011dGF0aW9uKHQsIHRoaXMucHJlY29uZGl0aW9uKHQpKSksIHRoaXMud3JpdHRlbkRvY3MuYWRkKHQudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB0aGlzLndyaXRlKGUudG9NdXRhdGlvbih0LCB0aGlzLnByZWNvbmRpdGlvbkZvclVwZGF0ZSh0KSkpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICB0aGlzLmxhc3RXcml0ZUVycm9yID0gdDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLndyaXRlKG5ldyBZcyh0LCB0aGlzLnByZWNvbmRpdGlvbih0KSkpLCB0aGlzLndyaXR0ZW5Eb2NzLmFkZCh0LnRvU3RyaW5nKCkpO1xuICAgIH1cbiAgICBhc3luYyBjb21taXQoKSB7XG4gICAgICAgIGlmICh0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLmxhc3RXcml0ZUVycm9yKSB0aHJvdyB0aGlzLmxhc3RXcml0ZUVycm9yO1xuICAgICAgICBjb25zdCB0ID0gdGhpcy5yZWFkVmVyc2lvbnM7XG4gICAgICAgIC8vIEZvciBlYWNoIG11dGF0aW9uLCBub3RlIHRoYXQgdGhlIGRvYyB3YXMgd3JpdHRlbi5cbiAgICAgICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5mb3JFYWNoKChlID0+IHtcbiAgICAgICAgICAgIHQuZGVsZXRlKGUua2V5LnRvU3RyaW5nKCkpO1xuICAgICAgICB9KSksIFxuICAgICAgICAvLyBGb3IgZWFjaCBkb2N1bWVudCB0aGF0IHdhcyByZWFkIGJ1dCBub3Qgd3JpdHRlbiB0bywgd2Ugd2FudCB0byBwZXJmb3JtXG4gICAgICAgIC8vIGEgYHZlcmlmeWAgb3BlcmF0aW9uLlxuICAgICAgICB0LmZvckVhY2goKCh0LCBlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuID0gaHQuZnJvbVBhdGgoZSk7XG4gICAgICAgICAgICB0aGlzLm11dGF0aW9ucy5wdXNoKG5ldyBYcyhuLCB0aGlzLnByZWNvbmRpdGlvbihuKSkpO1xuICAgICAgICB9KSksIGF3YWl0IGFzeW5jIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBMKHQpLCBzID0gTGkobi5zZXJpYWxpemVyKSArIFwiL2RvY3VtZW50c1wiLCBpID0ge1xuICAgICAgICAgICAgICAgIHdyaXRlczogZS5tYXAoKHQgPT4gamkobi5zZXJpYWxpemVyLCB0KSkpXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgYXdhaXQgbi5wbyhcIkNvbW1pdFwiLCBzLCBpKTtcbiAgICAgICAgfSh0aGlzLmRhdGFzdG9yZSwgdGhpcy5tdXRhdGlvbnMpLCB0aGlzLmNvbW1pdHRlZCA9ICEwO1xuICAgIH1cbiAgICByZWNvcmRWZXJzaW9uKHQpIHtcbiAgICAgICAgbGV0IGU7XG4gICAgICAgIGlmICh0LmlzRm91bmREb2N1bWVudCgpKSBlID0gdC52ZXJzaW9uOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICghdC5pc05vRG9jdW1lbnQoKSkgdGhyb3cgJCgpO1xuICAgICAgICAgICAgLy8gUmVwcmVzZW50IGEgZGVsZXRlZCBkb2MgdXNpbmcgU25hcHNob3RWZXJzaW9uLm1pbigpLlxuICAgICAgICAgICAgZSA9IHJ0Lm1pbigpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IG4gPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQodC5rZXkudG9TdHJpbmcoKSk7XG4gICAgICAgIGlmIChuKSB7XG4gICAgICAgICAgICBpZiAoIWUuaXNFcXVhbChuKSkgXG4gICAgICAgICAgICAvLyBUaGlzIHRyYW5zYWN0aW9uIHdpbGwgZmFpbCBubyBtYXR0ZXIgd2hhdC5cbiAgICAgICAgICAgIHRocm93IG5ldyBVKHEuQUJPUlRFRCwgXCJEb2N1bWVudCB2ZXJzaW9uIGNoYW5nZWQgYmV0d2VlbiB0d28gcmVhZHMuXCIpO1xuICAgICAgICB9IGVsc2UgdGhpcy5yZWFkVmVyc2lvbnMuc2V0KHQua2V5LnRvU3RyaW5nKCksIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSB2ZXJzaW9uIG9mIHRoaXMgZG9jdW1lbnQgd2hlbiBpdCB3YXMgcmVhZCBpbiB0aGlzIHRyYW5zYWN0aW9uLFxuICAgICAqIGFzIGEgcHJlY29uZGl0aW9uLCBvciBubyBwcmVjb25kaXRpb24gaWYgaXQgd2FzIG5vdCByZWFkLlxuICAgICAqLyAgICBwcmVjb25kaXRpb24odCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5yZWFkVmVyc2lvbnMuZ2V0KHQudG9TdHJpbmcoKSk7XG4gICAgICAgIHJldHVybiAhdGhpcy53cml0dGVuRG9jcy5oYXModC50b1N0cmluZygpKSAmJiBlID8gZS5pc0VxdWFsKHJ0Lm1pbigpKSA/IEZzLmV4aXN0cyghMSkgOiBGcy51cGRhdGVUaW1lKGUpIDogRnMubm9uZSgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSBwcmVjb25kaXRpb24gZm9yIGEgZG9jdW1lbnQgaWYgdGhlIG9wZXJhdGlvbiBpcyBhbiB1cGRhdGUuXG4gICAgICovICAgIHByZWNvbmRpdGlvbkZvclVwZGF0ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLnJlYWRWZXJzaW9ucy5nZXQodC50b1N0cmluZygpKTtcbiAgICAgICAgLy8gVGhlIGZpcnN0IHRpbWUgYSBkb2N1bWVudCBpcyB3cml0dGVuLCB3ZSB3YW50IHRvIHRha2UgaW50byBhY2NvdW50IHRoZVxuICAgICAgICAvLyByZWFkIHRpbWUgYW5kIGV4aXN0ZW5jZVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy53cml0dGVuRG9jcy5oYXModC50b1N0cmluZygpKSAmJiBlKSB7XG4gICAgICAgICAgICBpZiAoZS5pc0VxdWFsKHJ0Lm1pbigpKSkgXG4gICAgICAgICAgICAvLyBUaGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdCwgc28gZmFpbCB0aGUgdHJhbnNhY3Rpb24uXG4gICAgICAgICAgICAvLyBUaGlzIGhhcyB0byBiZSB2YWxpZGF0ZWQgbG9jYWxseSBiZWNhdXNlIHlvdSBjYW4ndCBzZW5kIGFcbiAgICAgICAgICAgIC8vIHByZWNvbmRpdGlvbiB0aGF0IGEgZG9jdW1lbnQgZG9lcyBub3QgZXhpc3Qgd2l0aG91dCBjaGFuZ2luZyB0aGVcbiAgICAgICAgICAgIC8vIHNlbWFudGljcyBvZiB0aGUgYmFja2VuZCB3cml0ZSB0byBiZSBhbiBpbnNlcnQuIFRoaXMgaXMgdGhlIHJldmVyc2VcbiAgICAgICAgICAgIC8vIG9mIHdoYXQgd2Ugd2FudCwgc2luY2Ugd2Ugd2FudCB0byBhc3NlcnQgdGhhdCB0aGUgZG9jdW1lbnQgZG9lc24ndFxuICAgICAgICAgICAgLy8gZXhpc3QgYnV0IHRoZW4gc2VuZCB0aGUgdXBkYXRlIGFuZCBoYXZlIGl0IGZhaWwuIFNpbmNlIHdlIGNhbid0XG4gICAgICAgICAgICAvLyBleHByZXNzIHRoYXQgdG8gdGhlIGJhY2tlbmQsIHdlIGhhdmUgdG8gdmFsaWRhdGUgbG9jYWxseS5cbiAgICAgICAgICAgIC8vIE5vdGU6IHRoaXMgY2FuIGNoYW5nZSBvbmNlIHdlIGNhbiBzZW5kIHNlcGFyYXRlIHZlcmlmeSB3cml0ZXMgaW4gdGhlXG4gICAgICAgICAgICAvLyB0cmFuc2FjdGlvbi5cbiAgICAgICAgICAgIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJDYW4ndCB1cGRhdGUgYSBkb2N1bWVudCB0aGF0IGRvZXNuJ3QgZXhpc3QuXCIpO1xuICAgICAgICAgICAgLy8gRG9jdW1lbnQgZXhpc3RzLCBiYXNlIHByZWNvbmRpdGlvbiBvbiBkb2N1bWVudCB1cGRhdGUgdGltZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBGcy51cGRhdGVUaW1lKGUpO1xuICAgICAgICB9XG4gICAgICAgIC8vIERvY3VtZW50IHdhcyBub3QgcmVhZCwgc28gd2UganVzdCB1c2UgdGhlIHByZWNvbmRpdGlvbnMgZm9yIGEgYmxpbmRcbiAgICAgICAgLy8gdXBkYXRlLlxuICAgICAgICByZXR1cm4gRnMuZXhpc3RzKCEwKTtcbiAgICB9XG4gICAgd3JpdGUodCkge1xuICAgICAgICB0aGlzLmVuc3VyZUNvbW1pdE5vdENhbGxlZCgpLCB0aGlzLm11dGF0aW9ucy5wdXNoKHQpO1xuICAgIH1cbiAgICBlbnN1cmVDb21taXROb3RDYWxsZWQoKSB7fVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxOSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBUcmFuc2FjdGlvblJ1bm5lciBlbmNhcHN1bGF0ZXMgdGhlIGxvZ2ljIG5lZWRlZCB0byBydW4gYW5kIHJldHJ5IHRyYW5zYWN0aW9uc1xuICogd2l0aCBiYWNrb2ZmLlxuICovIGNsYXNzIENhIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZSA9IHQsIHRoaXMuZGF0YXN0b3JlID0gZSwgdGhpcy5vcHRpb25zID0gbiwgdGhpcy51cGRhdGVGdW5jdGlvbiA9IHMsIFxuICAgICAgICB0aGlzLmRlZmVycmVkID0gaSwgdGhpcy5GYyA9IG4ubWF4QXR0ZW1wdHMsIHRoaXMuTG8gPSBuZXcgQnUodGhpcy5hc3luY1F1ZXVlLCBcInRyYW5zYWN0aW9uX3JldHJ5XCIgLyogVGltZXJJZC5UcmFuc2FjdGlvblJldHJ5ICovKTtcbiAgICB9XG4gICAgLyoqIFJ1bnMgdGhlIHRyYW5zYWN0aW9uIGFuZCBzZXRzIHRoZSByZXN1bHQgb24gZGVmZXJyZWQuICovICAgIHJ1bigpIHtcbiAgICAgICAgdGhpcy5GYyAtPSAxLCB0aGlzLkJjKCk7XG4gICAgfVxuICAgIEJjKCkge1xuICAgICAgICB0aGlzLkxvLnhvKChhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ID0gbmV3IERhKHRoaXMuZGF0YXN0b3JlKSwgZSA9IHRoaXMuTGModCk7XG4gICAgICAgICAgICBlICYmIGUudGhlbigoZSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IHQuY29tbWl0KCkudGhlbigoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlZmVycmVkLnJlc29sdmUoZSk7XG4gICAgICAgICAgICAgICAgfSkpLmNhdGNoKCh0ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xYyh0KTtcbiAgICAgICAgICAgICAgICB9KSkpKTtcbiAgICAgICAgICAgIH0pKS5jYXRjaCgodCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5xYyh0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBMYyh0KSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy51cGRhdGVGdW5jdGlvbih0KTtcbiAgICAgICAgICAgIHJldHVybiAhRnQoZSkgJiYgZS5jYXRjaCAmJiBlLnRoZW4gPyBlIDogKHRoaXMuZGVmZXJyZWQucmVqZWN0KEVycm9yKFwiVHJhbnNhY3Rpb24gY2FsbGJhY2sgbXVzdCByZXR1cm4gYSBQcm9taXNlXCIpKSwgXG4gICAgICAgICAgICBudWxsKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgLy8gRG8gbm90IHJldHJ5IGVycm9ycyB0aHJvd24gYnkgdXNlciBwcm92aWRlZCB1cGRhdGVGdW5jdGlvbi5cbiAgICAgICAgICAgIHJldHVybiB0aGlzLmRlZmVycmVkLnJlamVjdCh0KSwgbnVsbDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxYyh0KSB7XG4gICAgICAgIHRoaXMuRmMgPiAwICYmIHRoaXMuVWModCkgPyAodGhpcy5GYyAtPSAxLCB0aGlzLmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoKCkgPT4gKHRoaXMuQmMoKSwgXG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpKSkpKSA6IHRoaXMuZGVmZXJyZWQucmVqZWN0KHQpO1xuICAgIH1cbiAgICBVYyh0KSB7XG4gICAgICAgIGlmIChcIkZpcmViYXNlRXJyb3JcIiA9PT0gdC5uYW1lKSB7XG4gICAgICAgICAgICAvLyBJbiB0cmFuc2FjdGlvbnMsIHRoZSBiYWNrZW5kIHdpbGwgZmFpbCBvdXRkYXRlZCByZWFkcyB3aXRoIEZBSUxFRF9QUkVDT05ESVRJT04gYW5kXG4gICAgICAgICAgICAvLyBub24tbWF0Y2hpbmcgZG9jdW1lbnQgdmVyc2lvbnMgd2l0aCBBQk9SVEVELiBUaGVzZSBlcnJvcnMgc2hvdWxkIGJlIHJldHJpZWQuXG4gICAgICAgICAgICBjb25zdCBlID0gdC5jb2RlO1xuICAgICAgICAgICAgcmV0dXJuIFwiYWJvcnRlZFwiID09PSBlIHx8IFwiZmFpbGVkLXByZWNvbmRpdGlvblwiID09PSBlIHx8IFwiYWxyZWFkeS1leGlzdHNcIiA9PT0gZSB8fCAhb2koZSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICExO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogRmlyZXN0b3JlQ2xpZW50IGlzIGEgdG9wLWxldmVsIGNsYXNzIHRoYXQgY29uc3RydWN0cyBhbmQgb3ducyBhbGwgb2YgdGhlIC8vXG4gKiBwaWVjZXMgb2YgdGhlIGNsaWVudCBTREsgYXJjaGl0ZWN0dXJlLiBJdCBpcyByZXNwb25zaWJsZSBmb3IgY3JlYXRpbmcgdGhlIC8vXG4gKiBhc3luYyBxdWV1ZSB0aGF0IGlzIHNoYXJlZCBieSBhbGwgb2YgdGhlIG90aGVyIGNvbXBvbmVudHMgaW4gdGhlIHN5c3RlbS4gLy9cbiAqL1xuY2xhc3MgeGEge1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIFxuICAgIC8qKlxuICAgICAqIEFzeW5jaHJvbm91cyBxdWV1ZSByZXNwb25zaWJsZSBmb3IgYWxsIG9mIG91ciBpbnRlcm5hbCBwcm9jZXNzaW5nLiBXaGVuXG4gICAgICogd2UgZ2V0IGluY29taW5nIHdvcmsgZnJvbSB0aGUgdXNlciAodmlhIHB1YmxpYyBBUEkpIG9yIHRoZSBuZXR3b3JrXG4gICAgICogKGluY29taW5nIEdSUEMgbWVzc2FnZXMpLCB3ZSBzaG91bGQgYWx3YXlzIHNjaGVkdWxlIG9udG8gdGhpcyBxdWV1ZS5cbiAgICAgKiBUaGlzIGVuc3VyZXMgYWxsIG9mIG91ciB3b3JrIGlzIHByb3Blcmx5IHNlcmlhbGl6ZWQgKGUuZy4gd2UgZG9uJ3RcbiAgICAgKiBzdGFydCBwcm9jZXNzaW5nIGEgbmV3IG9wZXJhdGlvbiB3aGlsZSB0aGUgcHJldmlvdXMgb25lIGlzIHdhaXRpbmcgZm9yXG4gICAgICogYW4gYXN5bmMgSS9PIHRvIGNvbXBsZXRlKS5cbiAgICAgKi9cbiAgICBuLCBzKSB7XG4gICAgICAgIHRoaXMuYXV0aENyZWRlbnRpYWxzID0gdCwgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxzID0gZSwgdGhpcy5hc3luY1F1ZXVlID0gbiwgdGhpcy5kYXRhYmFzZUluZm8gPSBzLCBcbiAgICAgICAgdGhpcy51c2VyID0gVi5VTkFVVEhFTlRJQ0FURUQsIHRoaXMuY2xpZW50SWQgPSB0dC5BKCksIHRoaXMuYXV0aENyZWRlbnRpYWxMaXN0ZW5lciA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLCBcbiAgICAgICAgdGhpcy5hcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciA9ICgpID0+IFByb21pc2UucmVzb2x2ZSgpLCB0aGlzLmF1dGhDcmVkZW50aWFscy5zdGFydChuLCAoYXN5bmMgdCA9PiB7XG4gICAgICAgICAgICBOKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiUmVjZWl2ZWQgdXNlcj1cIiwgdC51aWQpLCBhd2FpdCB0aGlzLmF1dGhDcmVkZW50aWFsTGlzdGVuZXIodCksIFxuICAgICAgICAgICAgdGhpcy51c2VyID0gdDtcbiAgICAgICAgfSkpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuc3RhcnQobiwgKHQgPT4gKE4oXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJSZWNlaXZlZCBuZXcgYXBwIGNoZWNrIHRva2VuPVwiLCB0KSwgXG4gICAgICAgIHRoaXMuYXBwQ2hlY2tDcmVkZW50aWFsTGlzdGVuZXIodCwgdGhpcy51c2VyKSkpKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0Q29uZmlndXJhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGFzeW5jUXVldWU6IHRoaXMuYXN5bmNRdWV1ZSxcbiAgICAgICAgICAgIGRhdGFiYXNlSW5mbzogdGhpcy5kYXRhYmFzZUluZm8sXG4gICAgICAgICAgICBjbGllbnRJZDogdGhpcy5jbGllbnRJZCxcbiAgICAgICAgICAgIGF1dGhDcmVkZW50aWFsczogdGhpcy5hdXRoQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICBhcHBDaGVja0NyZWRlbnRpYWxzOiB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMsXG4gICAgICAgICAgICBpbml0aWFsVXNlcjogdGhpcy51c2VyLFxuICAgICAgICAgICAgbWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnM6IDEwMFxuICAgICAgICB9O1xuICAgIH1cbiAgICBzZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFsTGlzdGVuZXIgPSB0O1xuICAgIH1cbiAgICBzZXRBcHBDaGVja1Rva2VuQ2hhbmdlTGlzdGVuZXIodCkge1xuICAgICAgICB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbExpc3RlbmVyID0gdDtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQ2hlY2tzIHRoYXQgdGhlIGNsaWVudCBoYXMgbm90IGJlZW4gdGVybWluYXRlZC4gRW5zdXJlcyB0aGF0IG90aGVyIG1ldGhvZHMgb24gLy9cbiAgICAgKiB0aGlzIGNsYXNzIGNhbm5vdCBiZSBjYWxsZWQgYWZ0ZXIgdGhlIGNsaWVudCBpcyB0ZXJtaW5hdGVkLiAvL1xuICAgICAqLyAgICB2ZXJpZnlOb3RUZXJtaW5hdGVkKCkge1xuICAgICAgICBpZiAodGhpcy5hc3luY1F1ZXVlLmlzU2h1dHRpbmdEb3duKSB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiVGhlIGNsaWVudCBoYXMgYWxyZWFkeSBiZWVuIHRlcm1pbmF0ZWQuXCIpO1xuICAgIH1cbiAgICB0ZXJtaW5hdGUoKSB7XG4gICAgICAgIHRoaXMuYXN5bmNRdWV1ZS5lbnRlclJlc3RyaWN0ZWRNb2RlKCk7XG4gICAgICAgIGNvbnN0IHQgPSBuZXcgSztcbiAgICAgICAgcmV0dXJuIHRoaXMuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9vbmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMuX29ubGluZUNvbXBvbmVudHMudGVybWluYXRlKCksIHRoaXMuX29mZmxpbmVDb21wb25lbnRzICYmIGF3YWl0IHRoaXMuX29mZmxpbmVDb21wb25lbnRzLnRlcm1pbmF0ZSgpLCBcbiAgICAgICAgICAgICAgICAvLyBUaGUgY3JlZGVudGlhbHMgcHJvdmlkZXIgbXVzdCBiZSB0ZXJtaW5hdGVkIGFmdGVyIHNodXR0aW5nIGRvd24gdGhlXG4gICAgICAgICAgICAgICAgLy8gUmVtb3RlU3RvcmUgYXMgaXQgd2lsbCBwcmV2ZW50IHRoZSBSZW1vdGVTdG9yZSBmcm9tIHJldHJpZXZpbmcgYXV0aFxuICAgICAgICAgICAgICAgIC8vIHRva2Vucy5cbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhDcmVkZW50aWFscy5zaHV0ZG93bigpLCB0aGlzLmFwcENoZWNrQ3JlZGVudGlhbHMuc2h1dGRvd24oKSwgdC5yZXNvbHZlKCk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEVjKGUsIFwiRmFpbGVkIHRvIHNodXRkb3duIHBlcnNpc3RlbmNlXCIpO1xuICAgICAgICAgICAgICAgIHQucmVqZWN0KG4pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHQucHJvbWlzZTtcbiAgICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIE5hKHQsIGUpIHtcbiAgICB0LmFzeW5jUXVldWUudmVyaWZ5T3BlcmF0aW9uSW5Qcm9ncmVzcygpLCBOKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiSW5pdGlhbGl6aW5nIE9mZmxpbmVDb21wb25lbnRQcm92aWRlclwiKTtcbiAgICBjb25zdCBuID0gYXdhaXQgdC5nZXRDb25maWd1cmF0aW9uKCk7XG4gICAgYXdhaXQgZS5pbml0aWFsaXplKG4pO1xuICAgIGxldCBzID0gbi5pbml0aWFsVXNlcjtcbiAgICB0LnNldENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lcigoYXN5bmMgdCA9PiB7XG4gICAgICAgIHMuaXNFcXVhbCh0KSB8fCAoYXdhaXQgaXUoZS5sb2NhbFN0b3JlLCB0KSwgcyA9IHQpO1xuICAgIH0pKSwgXG4gICAgLy8gV2hlbiBhIHVzZXIgY2FsbHMgY2xlYXJQZXJzaXN0ZW5jZSgpIGluIG9uZSBjbGllbnQsIGFsbCBvdGhlciBjbGllbnRzXG4gICAgLy8gbmVlZCB0byBiZSB0ZXJtaW5hdGVkIHRvIGFsbG93IHRoZSBkZWxldGUgdG8gc3VjY2VlZC5cbiAgICBlLnBlcnNpc3RlbmNlLnNldERhdGFiYXNlRGVsZXRlZExpc3RlbmVyKCgoKSA9PiB0LnRlcm1pbmF0ZSgpKSksIHQuX29mZmxpbmVDb21wb25lbnRzID0gZTtcbn1cblxuYXN5bmMgZnVuY3Rpb24ga2EodCwgZSkge1xuICAgIHQuYXN5bmNRdWV1ZS52ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCk7XG4gICAgY29uc3QgbiA9IGF3YWl0IE9hKHQpO1xuICAgIE4oXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJJbml0aWFsaXppbmcgT25saW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgY29uc3QgcyA9IGF3YWl0IHQuZ2V0Q29uZmlndXJhdGlvbigpO1xuICAgIGF3YWl0IGUuaW5pdGlhbGl6ZShuLCBzKSwgXG4gICAgLy8gVGhlIENyZWRlbnRpYWxDaGFuZ2VMaXN0ZW5lciBvZiB0aGUgb25saW5lIGNvbXBvbmVudCBwcm92aWRlciB0YWtlc1xuICAgIC8vIHByZWNlZGVuY2Ugb3ZlciB0aGUgb2ZmbGluZSBjb21wb25lbnQgcHJvdmlkZXIuXG4gICAgdC5zZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIoKHQgPT4gZ2MoZS5yZW1vdGVTdG9yZSwgdCkpKSwgdC5zZXRBcHBDaGVja1Rva2VuQ2hhbmdlTGlzdGVuZXIoKCh0LCBuKSA9PiBnYyhlLnJlbW90ZVN0b3JlLCBuKSkpLCBcbiAgICB0Ll9vbmxpbmVDb21wb25lbnRzID0gZTtcbn1cblxuLyoqXG4gKiBEZWNpZGVzIHdoZXRoZXIgdGhlIHByb3ZpZGVkIGVycm9yIGFsbG93cyB1cyB0byBncmFjZWZ1bGx5IGRpc2FibGVcbiAqIHBlcnNpc3RlbmNlIChhcyBvcHBvc2VkIHRvIGNyYXNoaW5nIHRoZSBjbGllbnQpLlxuICovIGZ1bmN0aW9uIE1hKHQpIHtcbiAgICByZXR1cm4gXCJGaXJlYmFzZUVycm9yXCIgPT09IHQubmFtZSA/IHQuY29kZSA9PT0gcS5GQUlMRURfUFJFQ09ORElUSU9OIHx8IHQuY29kZSA9PT0gcS5VTklNUExFTUVOVEVEIDogIShcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBET01FeGNlcHRpb24gJiYgdCBpbnN0YW5jZW9mIERPTUV4Y2VwdGlvbikgfHwgKFxuICAgIC8vIFdoZW4gdGhlIGJyb3dzZXIgaXMgb3V0IG9mIHF1b3RhIHdlIGNvdWxkIGdldCBlaXRoZXIgcXVvdGEgZXhjZWVkZWRcbiAgICAvLyBvciBhbiBhYm9ydGVkIGVycm9yIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBlcnJvciBoYXBwZW5lZCBkdXJpbmdcbiAgICAvLyBzY2hlbWEgbWlncmF0aW9uLlxuICAgIDIyID09PSB0LmNvZGUgfHwgMjAgPT09IHQuY29kZSB8fCBcbiAgICAvLyBGaXJlZm94IFByaXZhdGUgQnJvd3NpbmcgbW9kZSBkaXNhYmxlcyBJbmRleGVkRGIgYW5kIHJldHVybnNcbiAgICAvLyBJTlZBTElEX1NUQVRFIGZvciBhbnkgdXNhZ2UuXG4gICAgMTEgPT09IHQuY29kZSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIE9hKHQpIHtcbiAgICBpZiAoIXQuX29mZmxpbmVDb21wb25lbnRzKSBpZiAodC5fdW5pbml0aWFsaXplZENvbXBvbmVudHNQcm92aWRlcikge1xuICAgICAgICBOKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiVXNpbmcgdXNlciBwcm92aWRlZCBPZmZsaW5lQ29tcG9uZW50UHJvdmlkZXJcIik7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBOYSh0LCB0Ll91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyLl9vZmZsaW5lKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IGU7XG4gICAgICAgICAgICBpZiAoIU1hKG4pKSB0aHJvdyBuO1xuICAgICAgICAgICAgTShcIkVycm9yIHVzaW5nIHVzZXIgcHJvdmlkZWQgY2FjaGUuIEZhbGxpbmcgYmFjayB0byBtZW1vcnkgY2FjaGU6IFwiICsgbiksIGF3YWl0IE5hKHQsIG5ldyBFYSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2UgTihcIkZpcmVzdG9yZUNsaWVudFwiLCBcIlVzaW5nIGRlZmF1bHQgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBhd2FpdCBOYSh0LCBuZXcgRWEpO1xuICAgIHJldHVybiB0Ll9vZmZsaW5lQ29tcG9uZW50cztcbn1cblxuYXN5bmMgZnVuY3Rpb24gJGEodCkge1xuICAgIHJldHVybiB0Ll9vbmxpbmVDb21wb25lbnRzIHx8ICh0Ll91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyID8gKE4oXCJGaXJlc3RvcmVDbGllbnRcIiwgXCJVc2luZyB1c2VyIHByb3ZpZGVkIE9ubGluZUNvbXBvbmVudFByb3ZpZGVyXCIpLCBcbiAgICBhd2FpdCBrYSh0LCB0Ll91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyLl9vbmxpbmUpKSA6IChOKFwiRmlyZXN0b3JlQ2xpZW50XCIsIFwiVXNpbmcgZGVmYXVsdCBPbmxpbmVDb21wb25lbnRQcm92aWRlclwiKSwgXG4gICAgYXdhaXQga2EodCwgbmV3IFBhKSkpLCB0Ll9vbmxpbmVDb21wb25lbnRzO1xufVxuXG5mdW5jdGlvbiBGYSh0KSB7XG4gICAgcmV0dXJuIE9hKHQpLnRoZW4oKHQgPT4gdC5wZXJzaXN0ZW5jZSkpO1xufVxuXG5mdW5jdGlvbiBCYSh0KSB7XG4gICAgcmV0dXJuIE9hKHQpLnRoZW4oKHQgPT4gdC5sb2NhbFN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIExhKHQpIHtcbiAgICByZXR1cm4gJGEodCkudGhlbigodCA9PiB0LnJlbW90ZVN0b3JlKSk7XG59XG5cbmZ1bmN0aW9uIHFhKHQpIHtcbiAgICByZXR1cm4gJGEodCkudGhlbigodCA9PiB0LnN5bmNFbmdpbmUpKTtcbn1cblxuZnVuY3Rpb24gVWEodCkge1xuICAgIHJldHVybiAkYSh0KS50aGVuKCh0ID0+IHQuZGF0YXN0b3JlKSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIEthKHQpIHtcbiAgICBjb25zdCBlID0gYXdhaXQgJGEodCksIG4gPSBlLmV2ZW50TWFuYWdlcjtcbiAgICByZXR1cm4gbi5vbkxpc3RlbiA9IEdjLmJpbmQobnVsbCwgZS5zeW5jRW5naW5lKSwgbi5vblVubGlzdGVuID0gamMuYmluZChudWxsLCBlLnN5bmNFbmdpbmUpLCBcbiAgICBuO1xufVxuXG4vKiogRW5hYmxlcyB0aGUgbmV0d29yayBjb25uZWN0aW9uIGFuZCByZS1lbnF1ZXVlcyBhbGwgcGVuZGluZyBvcGVyYXRpb25zLiAqLyBmdW5jdGlvbiBHYSh0KSB7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGUgPSBhd2FpdCBGYSh0KSwgbiA9IGF3YWl0IExhKHQpO1xuICAgICAgICByZXR1cm4gZS5zZXROZXR3b3JrRW5hYmxlZCghMCksIGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBMKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGUuQXUuZGVsZXRlKDAgLyogT2ZmbGluZUNhdXNlLlVzZXJEaXNhYmxlZCAqLyksIHp1KGUpO1xuICAgICAgICB9KG4pO1xuICAgIH0pKTtcbn1cblxuLyoqIERpc2FibGVzIHRoZSBuZXR3b3JrIGNvbm5lY3Rpb24uIFBlbmRpbmcgb3BlcmF0aW9ucyB3aWxsIG5vdCBjb21wbGV0ZS4gKi8gZnVuY3Rpb24gUWEodCkge1xuICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCBlID0gYXdhaXQgRmEodCksIG4gPSBhd2FpdCBMYSh0KTtcbiAgICAgICAgcmV0dXJuIGUuc2V0TmV0d29ya0VuYWJsZWQoITEpLCBhc3luYyBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gTCh0KTtcbiAgICAgICAgICAgIGUuQXUuYWRkKDAgLyogT2ZmbGluZUNhdXNlLlVzZXJEaXNhYmxlZCAqLyksIGF3YWl0IFd1KGUpLCBcbiAgICAgICAgICAgIC8vIFNldCB0aGUgT25saW5lU3RhdGUgdG8gT2ZmbGluZSBzbyBnZXQoKXMgcmV0dXJuIGZyb20gY2FjaGUsIGV0Yy5cbiAgICAgICAgICAgIGUuUHUuc2V0KFwiT2ZmbGluZVwiIC8qIE9ubGluZVN0YXRlLk9mZmxpbmUgKi8pO1xuICAgICAgICB9KG4pO1xuICAgIH0pKTtcbn1cblxuLyoqXG4gKiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IHJlc29sdmVzIHdoZW4gYWxsIHdyaXRlcyB0aGF0IHdlcmUgcGVuZGluZyBhdCB0aGUgdGltZVxuICogdGhpcyBtZXRob2Qgd2FzIGNhbGxlZCByZWNlaXZlZCBzZXJ2ZXIgYWNrbm93bGVkZ2VtZW50LiBBbiBhY2tub3dsZWRnZW1lbnRcbiAqIGNhbiBiZSBlaXRoZXIgYWNjZXB0YW5jZSBvciByZWplY3Rpb24uXG4gKi8gZnVuY3Rpb24gamEodCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgSztcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbiA9IEwodCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG4ucGVyc2lzdGVuY2UucnVuVHJhbnNhY3Rpb24oXCJyZWFkIGRvY3VtZW50XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5sb2NhbERvY3VtZW50cy5nZXREb2N1bWVudCh0LCBlKSkpO1xuICAgICAgICAgICAgfSh0LCBlKTtcbiAgICAgICAgICAgIHMuaXNGb3VuZERvY3VtZW50KCkgPyBuLnJlc29sdmUocykgOiBzLmlzTm9Eb2N1bWVudCgpID8gbi5yZXNvbHZlKG51bGwpIDogbi5yZWplY3QobmV3IFUocS5VTkFWQUlMQUJMRSwgXCJGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gY2FjaGUuIChIb3dldmVyLCB0aGlzIGRvY3VtZW50IG1heSBleGlzdCBvbiB0aGUgc2VydmVyLiBSdW4gYWdhaW4gd2l0aG91dCBzZXR0aW5nICdzb3VyY2UnIGluIHRoZSBHZXRPcHRpb25zIHRvIGF0dGVtcHQgdG8gcmV0cmlldmUgdGhlIGRvY3VtZW50IGZyb20gdGhlIHNlcnZlci4pXCIpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgY29uc3QgcyA9IEVjKHQsIGBGYWlsZWQgdG8gZ2V0IGRvY3VtZW50ICcke2V9IGZyb20gY2FjaGVgKTtcbiAgICAgICAgICAgIG4ucmVqZWN0KHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICogUmV0cmlldmVzIGEgbGF0ZW5jeS1jb21wZW5zYXRlZCBkb2N1bWVudCBmcm9tIHRoZSBiYWNrZW5kIHZpYSBhXG4gKiBTbmFwc2hvdExpc3RlbmVyLlxuICovIChhd2FpdCBCYSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiB6YSh0LCBlLCBuID0ge30pIHtcbiAgICBjb25zdCBzID0gbmV3IEs7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGNvbnN0IHIgPSBuZXcgVmEoe1xuICAgICAgICAgICAgbmV4dDogciA9PiB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHF1ZXJ5IGZpcnN0IGJlZm9yZSBwYXNzaW5nIGV2ZW50IHRvIHVzZXIgdG8gYXZvaWRcbiAgICAgICAgICAgICAgICAvLyB1c2VyIGFjdGlvbnMgYWZmZWN0aW5nIHRoZSBub3cgc3RhbGUgcXVlcnkuXG4gICAgICAgICAgICAgICAgZS5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiBTYyh0LCBvKSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHUgPSByLmRvY3MuaGFzKG4pO1xuICAgICAgICAgICAgICAgICF1ICYmIHIuZnJvbUNhY2hlID8gXG4gICAgICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiBJZiB3ZSdyZSBvbmxpbmUgYW5kIHRoZSBkb2N1bWVudCBkb2Vzbid0XG4gICAgICAgICAgICAgICAgLy8gZXhpc3QgdGhlbiB3ZSByZXNvbHZlIHdpdGggYSBkb2MuZXhpc3RzIHNldCB0byBmYWxzZS4gSWZcbiAgICAgICAgICAgICAgICAvLyB3ZSdyZSBvZmZsaW5lIGhvd2V2ZXIsIHdlIHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGlzXG4gICAgICAgICAgICAgICAgLy8gY2FzZS4gVHdvIG9wdGlvbnM6IDEpIENhY2hlIHRoZSBuZWdhdGl2ZSByZXNwb25zZSBmcm9tXG4gICAgICAgICAgICAgICAgLy8gdGhlIHNlcnZlciBzbyB3ZSBjYW4gZGVsaXZlciB0aGF0IGV2ZW4gd2hlbiB5b3UncmVcbiAgICAgICAgICAgICAgICAvLyBvZmZsaW5lIDIpIEFjdHVhbGx5IHJlamVjdCB0aGUgUHJvbWlzZSBpbiB0aGUgb25saW5lIGNhc2VcbiAgICAgICAgICAgICAgICAvLyBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgICAgICAgICAgICBpLnJlamVjdChuZXcgVShxLlVOQVZBSUxBQkxFLCBcIkZhaWxlZCB0byBnZXQgZG9jdW1lbnQgYmVjYXVzZSB0aGUgY2xpZW50IGlzIG9mZmxpbmUuXCIpKSA6IHUgJiYgci5mcm9tQ2FjaGUgJiYgcyAmJiBcInNlcnZlclwiID09PSBzLnNvdXJjZSA/IGkucmVqZWN0KG5ldyBVKHEuVU5BVkFJTEFCTEUsICdGYWlsZWQgdG8gZ2V0IGRvY3VtZW50IGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhpcyBkb2N1bWVudCBkb2VzIGV4aXN0IGluIHRoZSBsb2NhbCBjYWNoZS4gUnVuIGFnYWluIHdpdGhvdXQgc2V0dGluZyBzb3VyY2UgdG8gXCJzZXJ2ZXJcIiB0byByZXRyaWV2ZSB0aGUgY2FjaGVkIGRvY3VtZW50LiknKSkgOiBpLnJlc29sdmUocik7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IHQgPT4gaS5yZWplY3QodClcbiAgICAgICAgfSksIG8gPSBuZXcgTmMoR24obi5wYXRoKSwgciwge1xuICAgICAgICAgICAgaW5jbHVkZU1ldGFkYXRhQ2hhbmdlczogITAsXG4gICAgICAgICAgICBVdTogITBcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBWYyh0LCBvKTtcbiAgICB9KGF3YWl0IEthKHQpLCB0LmFzeW5jUXVldWUsIGUsIG4sIHMpKSksIHMucHJvbWlzZTtcbn1cblxuZnVuY3Rpb24gV2EodCwgZSkge1xuICAgIGNvbnN0IG4gPSBuZXcgSztcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGFzeW5jIGZ1bmN0aW9uKHQsIGUsIG4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBhd2FpdCBmdSh0LCBlLCBcbiAgICAgICAgICAgIC8qIHVzZVByZXZpb3VzUmVzdWx0cz0gKi8gITApLCBpID0gbmV3IExjKGUsIHMuc3IpLCByID0gaS5uYyhzLmRvY3VtZW50cyksIG8gPSBpLmFwcGx5Q2hhbmdlcyhyLCBcbiAgICAgICAgICAgIC8qIHVwZGF0ZUxpbWJvRG9jdW1lbnRzPSAqLyAhMSk7XG4gICAgICAgICAgICBuLnJlc29sdmUoby5zbmFwc2hvdCk7XG4gICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBFYyh0LCBgRmFpbGVkIHRvIGV4ZWN1dGUgcXVlcnkgJyR7ZX0gYWdhaW5zdCBjYWNoZWApO1xuICAgICAgICAgICAgbi5yZWplY3Qocyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gKiBSZXRyaWV2ZXMgYSBsYXRlbmN5LWNvbXBlbnNhdGVkIHF1ZXJ5IHNuYXBzaG90IGZyb20gdGhlIGJhY2tlbmQgdmlhIGFcbiAqIFNuYXBzaG90TGlzdGVuZXIuXG4gKi8gKGF3YWl0IEJhKHQpLCBlLCBuKSkpLCBuLnByb21pc2U7XG59XG5cbmZ1bmN0aW9uIEhhKHQsIGUsIG4gPSB7fSkge1xuICAgIGNvbnN0IHMgPSBuZXcgSztcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGkpIHtcbiAgICAgICAgY29uc3QgciA9IG5ldyBWYSh7XG4gICAgICAgICAgICBuZXh0OiBuID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgcXVlcnkgZmlyc3QgYmVmb3JlIHBhc3NpbmcgZXZlbnQgdG8gdXNlciB0byBhdm9pZFxuICAgICAgICAgICAgICAgIC8vIHVzZXIgYWN0aW9ucyBhZmZlY3RpbmcgdGhlIG5vdyBzdGFsZSBxdWVyeS5cbiAgICAgICAgICAgICAgICBlLmVucXVldWVBbmRGb3JnZXQoKCgpID0+IFNjKHQsIG8pKSksIG4uZnJvbUNhY2hlICYmIFwic2VydmVyXCIgPT09IHMuc291cmNlID8gaS5yZWplY3QobmV3IFUocS5VTkFWQUlMQUJMRSwgJ0ZhaWxlZCB0byBnZXQgZG9jdW1lbnRzIGZyb20gc2VydmVyLiAoSG93ZXZlciwgdGhlc2UgZG9jdW1lbnRzIG1heSBleGlzdCBpbiB0aGUgbG9jYWwgY2FjaGUuIFJ1biBhZ2FpbiB3aXRob3V0IHNldHRpbmcgc291cmNlIHRvIFwic2VydmVyXCIgdG8gcmV0cmlldmUgdGhlIGNhY2hlZCBkb2N1bWVudHMuKScpKSA6IGkucmVzb2x2ZShuKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogdCA9PiBpLnJlamVjdCh0KVxuICAgICAgICB9KSwgbyA9IG5ldyBOYyhuLCByLCB7XG4gICAgICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMCxcbiAgICAgICAgICAgIFV1OiAhMFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFZjKHQsIG8pO1xuICAgIH0oYXdhaXQgS2EodCksIHQuYXN5bmNRdWV1ZSwgZSwgbiwgcykpKSwgcy5wcm9taXNlO1xufVxuXG5mdW5jdGlvbiBKYSh0LCBlKSB7XG4gICAgY29uc3QgbiA9IG5ldyBWYShlKTtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgTCh0KS5OdS5hZGQoZSksIFxuICAgICAgICAvLyBJbW1lZGlhdGVseSBmaXJlIGFuIGluaXRpYWwgZXZlbnQsIGluZGljYXRpbmcgYWxsIGV4aXN0aW5nIGxpc3RlbmVyc1xuICAgICAgICAvLyBhcmUgaW4tc3luYy5cbiAgICAgICAgZS5uZXh0KCk7XG4gICAgfShhd2FpdCBLYSh0KSwgbikpKSwgKCkgPT4ge1xuICAgICAgICBuLlNjKCksIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICBMKHQpLk51LmRlbGV0ZShlKTtcbiAgICAgICAgfShhd2FpdCBLYSh0KSwgbikpKTtcbiAgICB9O1xufVxuXG4vKipcbiAqIFRha2VzIGFuIHVwZGF0ZUZ1bmN0aW9uIGluIHdoaWNoIGEgc2V0IG9mIHJlYWRzIGFuZCB3cml0ZXMgY2FuIGJlIHBlcmZvcm1lZFxuICogYXRvbWljYWxseS4gSW4gdGhlIHVwZGF0ZUZ1bmN0aW9uLCB0aGUgY2xpZW50IGNhbiByZWFkIGFuZCB3cml0ZSB2YWx1ZXNcbiAqIHVzaW5nIHRoZSBzdXBwbGllZCB0cmFuc2FjdGlvbiBvYmplY3QuIEFmdGVyIHRoZSB1cGRhdGVGdW5jdGlvbiwgYWxsXG4gKiBjaGFuZ2VzIHdpbGwgYmUgY29tbWl0dGVkLiBJZiBhIHJldHJ5YWJsZSBlcnJvciBvY2N1cnMgKGV4OiBzb21lIG90aGVyXG4gKiBjbGllbnQgaGFzIGNoYW5nZWQgYW55IG9mIHRoZSBkYXRhIHJlZmVyZW5jZWQpLCB0aGVuIHRoZSB1cGRhdGVGdW5jdGlvblxuICogd2lsbCBiZSBjYWxsZWQgYWdhaW4gYWZ0ZXIgYSBiYWNrb2ZmLiBJZiB0aGUgdXBkYXRlRnVuY3Rpb24gc3RpbGwgZmFpbHNcbiAqIGFmdGVyIGFsbCByZXRyaWVzLCB0aGVuIHRoZSB0cmFuc2FjdGlvbiB3aWxsIGJlIHJlamVjdGVkLlxuICpcbiAqIFRoZSB0cmFuc2FjdGlvbiBvYmplY3QgcGFzc2VkIHRvIHRoZSB1cGRhdGVGdW5jdGlvbiBjb250YWlucyBtZXRob2RzIGZvclxuICogYWNjZXNzaW5nIGRvY3VtZW50cyBhbmQgY29sbGVjdGlvbnMuIFVubGlrZSBvdGhlciBkYXRhc3RvcmUgYWNjZXNzLCBkYXRhXG4gKiBhY2Nlc3NlZCB3aXRoIHRoZSB0cmFuc2FjdGlvbiB3aWxsIG5vdCByZWZsZWN0IGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdFxuICogYmVlbiBjb21taXR0ZWQuIEZvciB0aGlzIHJlYXNvbiwgaXQgaXMgcmVxdWlyZWQgdGhhdCBhbGwgcmVhZHMgYXJlXG4gKiBwZXJmb3JtZWQgYmVmb3JlIGFueSB3cml0ZXMuIFRyYW5zYWN0aW9ucyBtdXN0IGJlIHBlcmZvcm1lZCB3aGlsZSBvbmxpbmUuXG4gKi8gZnVuY3Rpb24gWWEodCwgZSwgbiwgcykge1xuICAgIGNvbnN0IGkgPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGxldCBuO1xuICAgICAgICBuID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCA/IGhpKCkuZW5jb2RlKHQpIDogdDtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgU2EodCwgZSk7XG4gICAgICAgIH0oZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSByZXR1cm4gYmEodCwgZSk7XG4gICAgICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSByZXR1cm4gYmEobmV3IFVpbnQ4QXJyYXkodCksIGUpO1xuICAgICAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBSZWFkYWJsZVN0cmVhbSkgcmV0dXJuIHQuZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJTb3VyY2Ugb2YgYHRvQnl0ZVN0cmVhbVJlYWRlcmAgaGFzIHRvIGJlIGEgQXJyYXlCdWZmZXIgb3IgUmVhZGFibGVTdHJlYW1cIik7XG4gICAgICAgIH0obiksIGUpO1xuICAgIH0obiwgRnUoZSkpO1xuICAgIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB7XG4gICAgICAgIFRhKGF3YWl0IHFhKHQpLCBpLCBzKTtcbiAgICB9KSk7XG59XG5cbmZ1bmN0aW9uIFhhKHQsIGUpIHtcbiAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWUoKGFzeW5jICgpID0+IGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IEwodCk7XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiR2V0IG5hbWVkIHF1ZXJ5XCIsIFwicmVhZG9ubHlcIiwgKHQgPT4gbi5Mcy5nZXROYW1lZFF1ZXJ5KHQsIGUpKSk7XG4gICAgfShhd2FpdCBCYSh0KSwgZSkpKTtcbn1cblxuZnVuY3Rpb24gWmEodCwgZSkge1xuICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZSgoYXN5bmMgKCkgPT4gYXN5bmMgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gTCh0KSwgcyA9IG4uaW5kZXhNYW5hZ2VyLCBpID0gW107XG4gICAgICAgIHJldHVybiBuLnBlcnNpc3RlbmNlLnJ1blRyYW5zYWN0aW9uKFwiQ29uZmlndXJlIGluZGV4ZXNcIiwgXCJyZWFkd3JpdGVcIiwgKHQgPT4gcy5nZXRGaWVsZEluZGV4ZXModCkubmV4dCgobiA9PiBcbiAgICAgICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTcgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAgICAgLyoqXG4gKiBDb21wYXJlcyB0d28gYXJyYXkgZm9yIGVxdWFsaXR5IHVzaW5nIGNvbXBhcmF0b3IuIFRoZSBtZXRob2QgY29tcHV0ZXMgdGhlXG4gKiBpbnRlcnNlY3Rpb24gYW5kIGludm9rZXMgYG9uQWRkYCBmb3IgZXZlcnkgZWxlbWVudCB0aGF0IGlzIGluIGBhZnRlcmAgYnV0IG5vdFxuICogYGJlZm9yZWAuIGBvblJlbW92ZWAgaXMgaW52b2tlZCBmb3IgZXZlcnkgZWxlbWVudCBpbiBgYmVmb3JlYCBidXQgbWlzc2luZ1xuICogZnJvbSBgYWZ0ZXJgLlxuICpcbiAqIFRoZSBtZXRob2QgY3JlYXRlcyBhIGNvcHkgb2YgYm90aCBgYmVmb3JlYCBhbmQgYGFmdGVyYCBhbmQgcnVucyBpbiBPKG4gbG9nXG4gKiBuKSwgd2hlcmUgbiBpcyB0aGUgc2l6ZSBvZiB0aGUgdHdvIGxpc3RzLlxuICpcbiAqIEBwYXJhbSBiZWZvcmUgLSBUaGUgZWxlbWVudHMgdGhhdCBleGlzdCBpbiB0aGUgb3JpZ2luYWwgYXJyYXkuXG4gKiBAcGFyYW0gYWZ0ZXIgLSBUaGUgZWxlbWVudHMgdG8gZGlmZiBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBhcnJheS5cbiAqIEBwYXJhbSBjb21wYXJhdG9yIC0gVGhlIGNvbXBhcmF0b3IgZm9yIHRoZSBlbGVtZW50cyBpbiBiZWZvcmUgYW5kIGFmdGVyLlxuICogQHBhcmFtIG9uQWRkIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mIGBcbiAqIGFmdGVyYCBidXQgbm90IGBiZWZvcmVgLlxuICogQHBhcmFtIG9uUmVtb3ZlIC0gQSBmdW5jdGlvbiB0byBpbnZva2UgZm9yIGV2ZXJ5IGVsZW1lbnQgdGhhdCBpcyBwYXJ0IG9mXG4gKiBgYmVmb3JlYCBidXQgbm90IGBhZnRlcmAuXG4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSwgbiwgcywgaSkge1xuICAgICAgICAgICAgdCA9IFsgLi4udCBdLCBlID0gWyAuLi5lIF0sIHQuc29ydChuKSwgZS5zb3J0KG4pO1xuICAgICAgICAgICAgY29uc3QgciA9IHQubGVuZ3RoLCBvID0gZS5sZW5ndGg7XG4gICAgICAgICAgICBsZXQgdSA9IDAsIGMgPSAwO1xuICAgICAgICAgICAgZm9yICg7dSA8IG8gJiYgYyA8IHI7ICkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHIgPSBuKHRbY10sIGVbdV0pO1xuICAgICAgICAgICAgICAgIHIgPCAwID8gXG4gICAgICAgICAgICAgICAgLy8gVGhlIGVsZW1lbnQgd2FzIHJlbW92ZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZFxuICAgICAgICAgICAgICAgIC8vIHdhbGt0aHJvdWdoIGlzIG9ubHkgaW4gYGJlZm9yZWAuXG4gICAgICAgICAgICAgICAgaSh0W2MrK10pIDogciA+IDAgPyBcbiAgICAgICAgICAgICAgICAvLyBUaGUgZWxlbWVudCB3YXMgYWRkZWQgaWYgdGhlIG5leHQgZWxlbWVudCBpbiBvdXIgb3JkZXJlZCB3YWxrdGhyb3VnaFxuICAgICAgICAgICAgICAgIC8vIGlzIG9ubHkgaW4gYGFmdGVyYC5cbiAgICAgICAgICAgICAgICBzKGVbdSsrXSkgOiAodSsrLCBjKyspO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICg7dSA8IG87ICkgcyhlW3UrK10pO1xuICAgICAgICAgICAgZm9yICg7YyA8IHI7ICkgaSh0W2MrK10pO1xuICAgICAgICB9KG4sIGUsIF90LCAoZSA9PiB7XG4gICAgICAgICAgICBpLnB1c2gocy5hZGRGaWVsZEluZGV4KHQsIGUpKTtcbiAgICAgICAgfSksIChlID0+IHtcbiAgICAgICAgICAgIGkucHVzaChzLmRlbGV0ZUZpZWxkSW5kZXgodCwgZSkpO1xuICAgICAgICB9KSkpKS5uZXh0KCgoKSA9PiB2dC53YWl0Rm9yKGkpKSkpKTtcbiAgICB9XG4gICAgLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMTkgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbiAgICAvLyBUaGUgZm9ybWF0IG9mIHRoZSBMb2NhbFN0b3JhZ2Uga2V5IHRoYXQgc3RvcmVzIHRoZSBjbGllbnQgc3RhdGUgaXM6XG4gICAgLy8gICAgIGZpcmVzdG9yZV9jbGllbnRzXzxwZXJzaXN0ZW5jZV9wcmVmaXg+XzxpbnN0YW5jZV9rZXk+XG4gICAgKGF3YWl0IEJhKHQpLCBlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCB0aCA9IG5ldyBNYXA7XG5cbi8qKlxuICogQW4gaW5zdGFuY2UgbWFwIHRoYXQgZW5zdXJlcyBvbmx5IG9uZSBEYXRhc3RvcmUgZXhpc3RzIHBlciBGaXJlc3RvcmVcbiAqIGluc3RhbmNlLlxuICovXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuZnVuY3Rpb24gZWgodCwgZSwgbikge1xuICAgIGlmICghbikgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgRnVuY3Rpb24gJHt0fSgpIGNhbm5vdCBiZSBjYWxsZWQgd2l0aCBhbiBlbXB0eSAke2V9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IHR3byBib29sZWFuIG9wdGlvbnMgYXJlIG5vdCBzZXQgYXQgdGhlIHNhbWUgdGltZS5cbiAqIEBpbnRlcm5hbFxuICovIGZ1bmN0aW9uIG5oKHQsIGUsIG4sIHMpIHtcbiAgICBpZiAoITAgPT09IGUgJiYgITAgPT09IHMpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYCR7dH0gYW5kICR7bn0gY2Fubm90IGJlIHVzZWQgdG9nZXRoZXIuYCk7XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgYHBhdGhgIHJlZmVycyB0byBhIGRvY3VtZW50IChpbmRpY2F0ZWQgYnkgdGhlIGZhY3QgaXQgY29udGFpbnNcbiAqIGFuIGV2ZW4gbnVtYmVycyBvZiBzZWdtZW50cykuXG4gKi8gZnVuY3Rpb24gc2godCkge1xuICAgIGlmICghaHQuaXNEb2N1bWVudEtleSh0KSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBkb2N1bWVudCByZWZlcmVuY2UuIERvY3VtZW50IHJlZmVyZW5jZXMgbXVzdCBoYXZlIGFuIGV2ZW4gbnVtYmVyIG9mIHNlZ21lbnRzLCBidXQgJHt0fSBoYXMgJHt0Lmxlbmd0aH0uYCk7XG59XG5cbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgYHBhdGhgIHJlZmVycyB0byBhIGNvbGxlY3Rpb24gKGluZGljYXRlZCBieSB0aGUgZmFjdCBpdFxuICogY29udGFpbnMgYW4gb2RkIG51bWJlcnMgb2Ygc2VnbWVudHMpLlxuICovIGZ1bmN0aW9uIGloKHQpIHtcbiAgICBpZiAoaHQuaXNEb2N1bWVudEtleSh0KSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBjb2xsZWN0aW9uIHJlZmVyZW5jZS4gQ29sbGVjdGlvbiByZWZlcmVuY2VzIG11c3QgaGF2ZSBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzLCBidXQgJHt0fSBoYXMgJHt0Lmxlbmd0aH0uYCk7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIGl0J3MgYSBub24tbnVsbCBvYmplY3Qgd2l0aG91dCBhIGN1c3RvbSBwcm90b3R5cGVcbiAqIChpLmUuIGV4Y2x1ZGVzIEFycmF5LCBEYXRlLCBldGMuKS5cbiAqL1xuLyoqIFJldHVybnMgYSBzdHJpbmcgZGVzY3JpYmluZyB0aGUgdHlwZSAvIHZhbHVlIG9mIHRoZSBwcm92aWRlZCBpbnB1dC4gKi9cbmZ1bmN0aW9uIHJoKHQpIHtcbiAgICBpZiAodm9pZCAwID09PSB0KSByZXR1cm4gXCJ1bmRlZmluZWRcIjtcbiAgICBpZiAobnVsbCA9PT0gdCkgcmV0dXJuIFwibnVsbFwiO1xuICAgIGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0KSByZXR1cm4gdC5sZW5ndGggPiAyMCAmJiAodCA9IGAke3Quc3Vic3RyaW5nKDAsIDIwKX0uLi5gKSwgXG4gICAgSlNPTi5zdHJpbmdpZnkodCk7XG4gICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIHQgfHwgXCJib29sZWFuXCIgPT0gdHlwZW9mIHQpIHJldHVybiBcIlwiICsgdDtcbiAgICBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgdCkge1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIEFycmF5KSByZXR1cm4gXCJhbiBhcnJheVwiO1xuICAgICAgICB7XG4gICAgICAgICAgICBjb25zdCBlID0gXG4gICAgICAgICAgICAvKiogdHJ5IHRvIGdldCB0aGUgY29uc3RydWN0b3IgbmFtZSBmb3IgYW4gb2JqZWN0LiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGlmICh0LmNvbnN0cnVjdG9yKSByZXR1cm4gdC5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLyoqXG4gKiBDYXN0cyBgb2JqYCB0byBgVGAsIG9wdGlvbmFsbHkgdW53cmFwcGluZyBDb21wYXQgdHlwZXMgdG8gZXhwb3NlIHRoZVxuICogdW5kZXJseWluZyBpbnN0YW5jZS4gVGhyb3dzIGlmICBgb2JqYCBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgYFRgLlxuICpcbiAqIFRoaXMgY2FzdCBpcyB1c2VkIGluIHRoZSBMaXRlIGFuZCBGdWxsIFNESyB0byB2ZXJpZnkgaW5zdGFuY2UgdHlwZXMgZm9yXG4gKiBhcmd1bWVudHMgcGFzc2VkIHRvIHRoZSBwdWJsaWMgQVBJLlxuICogQGludGVybmFsXG4gKi8gKHQpO1xuICAgICAgICAgICAgcmV0dXJuIGUgPyBgYSBjdXN0b20gJHtlfSBvYmplY3RgIDogXCJhbiBvYmplY3RcIjtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gXCJmdW5jdGlvblwiID09IHR5cGVvZiB0ID8gXCJhIGZ1bmN0aW9uXCIgOiAkKCk7XG59XG5cbmZ1bmN0aW9uIG9oKHQsIFxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbmUpIHtcbiAgICBpZiAoXCJfZGVsZWdhdGVcIiBpbiB0ICYmIChcbiAgICAvLyBVbndyYXAgQ29tcGF0IHR5cGVzXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICB0ID0gdC5fZGVsZWdhdGUpLCAhKHQgaW5zdGFuY2VvZiBlKSkge1xuICAgICAgICBpZiAoZS5uYW1lID09PSB0LmNvbnN0cnVjdG9yLm5hbWUpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJUeXBlIGRvZXMgbm90IG1hdGNoIHRoZSBleHBlY3RlZCBpbnN0YW5jZS4gRGlkIHlvdSBwYXNzIGEgcmVmZXJlbmNlIGZyb20gYSBkaWZmZXJlbnQgRmlyZXN0b3JlIFNESz9cIik7XG4gICAgICAgIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSByaCh0KTtcbiAgICAgICAgICAgIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEV4cGVjdGVkIHR5cGUgJyR7ZS5uYW1lfScsIGJ1dCBpdCB3YXM6ICR7bn1gKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdDtcbn1cblxuZnVuY3Rpb24gdWgodCwgZSkge1xuICAgIGlmIChlIDw9IDApIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7dH0oKSByZXF1aXJlcyBhIHBvc2l0aXZlIG51bWJlciwgYnV0IGl0IHdhczogJHtlfS5gKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8vIHNldHRpbmdzKCkgZGVmYXVsdHM6XG4vKipcbiAqIEEgY29uY3JldGUgdHlwZSBkZXNjcmliaW5nIGFsbCB0aGUgdmFsdWVzIHRoYXQgY2FuIGJlIGFwcGxpZWQgdmlhIGFcbiAqIHVzZXItc3VwcGxpZWQgYEZpcmVzdG9yZVNldHRpbmdzYCBvYmplY3QuIFRoaXMgaXMgYSBzZXBhcmF0ZSB0eXBlIHNvIHRoYXRcbiAqIGRlZmF1bHRzIGNhbiBiZSBzdXBwbGllZCBhbmQgdGhlIHZhbHVlIGNhbiBiZSBjaGVja2VkIGZvciBlcXVhbGl0eS5cbiAqL1xuY2xhc3MgY2gge1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdmFyIGU7XG4gICAgICAgIGlmICh2b2lkIDAgPT09IHQuaG9zdCkge1xuICAgICAgICAgICAgaWYgKHZvaWQgMCAhPT0gdC5zc2wpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJDYW4ndCBwcm92aWRlIHNzbCBvcHRpb24gaWYgaG9zdCBvcHRpb24gaXMgbm90IHNldFwiKTtcbiAgICAgICAgICAgIHRoaXMuaG9zdCA9IFwiZmlyZXN0b3JlLmdvb2dsZWFwaXMuY29tXCIsIHRoaXMuc3NsID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHRoaXMuaG9zdCA9IHQuaG9zdCwgdGhpcy5zc2wgPSBudWxsID09PSAoZSA9IHQuc3NsKSB8fCB2b2lkIDAgPT09IGUgfHwgZTtcbiAgICAgICAgaWYgKHRoaXMuY3JlZGVudGlhbHMgPSB0LmNyZWRlbnRpYWxzLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSAhIXQuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcywgXG4gICAgICAgIHRoaXMuY2FjaGUgPSB0LmxvY2FsQ2FjaGUsIHZvaWQgMCA9PT0gdC5jYWNoZVNpemVCeXRlcykgdGhpcy5jYWNoZVNpemVCeXRlcyA9IDQxOTQzMDQwOyBlbHNlIHtcbiAgICAgICAgICAgIGlmICgtMSAhPT0gdC5jYWNoZVNpemVCeXRlcyAmJiB0LmNhY2hlU2l6ZUJ5dGVzIDwgMTA0ODU3NikgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcImNhY2hlU2l6ZUJ5dGVzIG11c3QgYmUgYXQgbGVhc3QgMTA0ODU3NlwiKTtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVTaXplQnl0ZXMgPSB0LmNhY2hlU2l6ZUJ5dGVzO1xuICAgICAgICB9XG4gICAgICAgIG5oKFwiZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZ1wiLCB0LmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcsIFwiZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nXCIsIHQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nKSwgXG4gICAgICAgIHRoaXMuZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyA9ICEhdC5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCB0aGlzLmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgPyB0aGlzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA9ICExIDogdm9pZCAwID09PSB0LmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyA/IHRoaXMuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nID0gZmFsc2UgOiBcbiAgICAgICAgLy8gRm9yIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5LCBjb2VyY2UgdGhlIHZhbHVlIHRvIGJvb2xlYW4gZXZlbiB0aG91Z2hcbiAgICAgICAgLy8gdGhlIFR5cGVTY3JpcHQgY29tcGlsZXIgaGFzIG5hcnJvd2VkIHRoZSB0eXBlIHRvIGJvb2xlYW4gYWxyZWFkeS5cbiAgICAgICAgLy8gbm9pbnNwZWN0aW9uIFBvaW50bGVzc0Jvb2xlYW5FeHByZXNzaW9uSlNcbiAgICAgICAgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPSAhIXQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nLCBcbiAgICAgICAgdGhpcy51c2VGZXRjaFN0cmVhbXMgPSAhIXQudXNlRmV0Y2hTdHJlYW1zO1xuICAgIH1cbiAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaG9zdCA9PT0gdC5ob3N0ICYmIHRoaXMuc3NsID09PSB0LnNzbCAmJiB0aGlzLmNyZWRlbnRpYWxzID09PSB0LmNyZWRlbnRpYWxzICYmIHRoaXMuY2FjaGVTaXplQnl0ZXMgPT09IHQuY2FjaGVTaXplQnl0ZXMgJiYgdGhpcy5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nID09PSB0LmV4cGVyaW1lbnRhbEZvcmNlTG9uZ1BvbGxpbmcgJiYgdGhpcy5leHBlcmltZW50YWxBdXRvRGV0ZWN0TG9uZ1BvbGxpbmcgPT09IHQuZXhwZXJpbWVudGFsQXV0b0RldGVjdExvbmdQb2xsaW5nICYmIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9PT0gdC5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzICYmIHRoaXMudXNlRmV0Y2hTdHJlYW1zID09PSB0LnVzZUZldGNoU3RyZWFtcztcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIFRoZSBDbG91ZCBGaXJlc3RvcmUgc2VydmljZSBpbnRlcmZhY2UuXG4gKlxuICogRG8gbm90IGNhbGwgdGhpcyBjb25zdHJ1Y3RvciBkaXJlY3RseS4gSW5zdGVhZCwgdXNlIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfS5cbiAqLyBjbGFzcyBhaCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHRoaXMuX2F1dGhDcmVkZW50aWFscyA9IHQsIHRoaXMuX2FwcENoZWNrQ3JlZGVudGlhbHMgPSBlLCB0aGlzLl9kYXRhYmFzZUlkID0gbiwgXG4gICAgICAgIHRoaXMuX2FwcCA9IHMsIFxuICAgICAgICAvKipcbiAgICAgICAgICogV2hldGhlciBpdCdzIGEgRmlyZXN0b3JlIG9yIEZpcmVzdG9yZSBMaXRlIGluc3RhbmNlLlxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJmaXJlc3RvcmUtbGl0ZVwiLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IFwiKGxpdGUpXCIsIHRoaXMuX3NldHRpbmdzID0gbmV3IGNoKHt9KSwgXG4gICAgICAgIHRoaXMuX3NldHRpbmdzRnJvemVuID0gITE7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSB7QGxpbmsgQGZpcmViYXNlL2FwcCNGaXJlYmFzZUFwcH0gYXNzb2NpYXRlZCB3aXRoIHRoaXMgYEZpcmVzdG9yZWAgc2VydmljZVxuICAgICAqIGluc3RhbmNlLlxuICAgICAqLyAgICBnZXQgYXBwKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2FwcCkgdGhyb3cgbmV3IFUocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSB3YXMgbm90IGluaXRpYWxpemVkIHVzaW5nIHRoZSBGaXJlYmFzZSBTREsuICdhcHAnIGlzIG5vdCBhdmFpbGFibGVcIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9hcHA7XG4gICAgfVxuICAgIGdldCBfaW5pdGlhbGl6ZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbjtcbiAgICB9XG4gICAgZ2V0IF90ZXJtaW5hdGVkKCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLl90ZXJtaW5hdGVUYXNrO1xuICAgIH1cbiAgICBfc2V0U2V0dGluZ3ModCkge1xuICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3NGcm96ZW4pIHRocm93IG5ldyBVKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJGaXJlc3RvcmUgaGFzIGFscmVhZHkgYmVlbiBzdGFydGVkIGFuZCBpdHMgc2V0dGluZ3MgY2FuIG5vIGxvbmdlciBiZSBjaGFuZ2VkLiBZb3UgY2FuIG9ubHkgbW9kaWZ5IHNldHRpbmdzIGJlZm9yZSBjYWxsaW5nIGFueSBvdGhlciBtZXRob2RzIG9uIGEgRmlyZXN0b3JlIG9iamVjdC5cIik7XG4gICAgICAgIHRoaXMuX3NldHRpbmdzID0gbmV3IGNoKHQpLCB2b2lkIDAgIT09IHQuY3JlZGVudGlhbHMgJiYgKHRoaXMuX2F1dGhDcmVkZW50aWFscyA9IGZ1bmN0aW9uKHQpIHtcbiAgICAgICAgICAgIGlmICghdCkgcmV0dXJuIG5ldyBRO1xuICAgICAgICAgICAgc3dpdGNoICh0LnR5cGUpIHtcbiAgICAgICAgICAgICAgY2FzZSBcImZpcnN0UGFydHlcIjpcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEgodC5zZXNzaW9uSW5kZXggfHwgXCIwXCIsIHQuaWFtVG9rZW4gfHwgbnVsbCwgdC5hdXRoVG9rZW5GYWN0b3J5IHx8IG51bGwpO1xuXG4gICAgICAgICAgICAgIGNhc2UgXCJwcm92aWRlclwiOlxuICAgICAgICAgICAgICAgIHJldHVybiB0LmNsaWVudDtcblxuICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJtYWtlQXV0aENyZWRlbnRpYWxzUHJvdmlkZXIgZmFpbGVkIGR1ZSB0byBpbnZhbGlkIGNyZWRlbnRpYWwgdHlwZVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSh0LmNyZWRlbnRpYWxzKSk7XG4gICAgfVxuICAgIF9nZXRTZXR0aW5ncygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3NldHRpbmdzO1xuICAgIH1cbiAgICBfZnJlZXplU2V0dGluZ3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9zZXR0aW5nc0Zyb3plbiA9ICEwLCB0aGlzLl9zZXR0aW5ncztcbiAgICB9XG4gICAgX2RlbGV0ZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rlcm1pbmF0ZVRhc2sgfHwgKHRoaXMuX3Rlcm1pbmF0ZVRhc2sgPSB0aGlzLl90ZXJtaW5hdGUoKSksIHRoaXMuX3Rlcm1pbmF0ZVRhc2s7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBgRmlyZXN0b3JlYCBpbnN0YW5jZS4gKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYXBwOiB0aGlzLl9hcHAsXG4gICAgICAgICAgICBkYXRhYmFzZUlkOiB0aGlzLl9kYXRhYmFzZUlkLFxuICAgICAgICAgICAgc2V0dGluZ3M6IHRoaXMuX3NldHRpbmdzXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRlcm1pbmF0ZXMgYWxsIGNvbXBvbmVudHMgdXNlZCBieSB0aGlzIGNsaWVudC4gU3ViY2xhc3NlcyBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIG1ldGhvZCB0byBjbGVhbiB1cCB0aGVpciBvd24gZGVwZW5kZW5jaWVzLCBidXQgbXVzdCBhbHNvIGNhbGwgdGhpc1xuICAgICAqIG1ldGhvZC5cbiAgICAgKlxuICAgICAqIE9ubHkgZXZlciBjYWxsZWQgb25jZS5cbiAgICAgKi8gICAgX3Rlcm1pbmF0ZSgpIHtcbiAgICAgICAgLyoqXG4gKiBSZW1vdmVzIGFsbCBjb21wb25lbnRzIGFzc29jaWF0ZWQgd2l0aCB0aGUgcHJvdmlkZWQgaW5zdGFuY2UuIE11c3QgYmUgY2FsbGVkXG4gKiB3aGVuIHRoZSBgRmlyZXN0b3JlYCBpbnN0YW5jZSBpcyB0ZXJtaW5hdGVkLlxuICovXG4gICAgICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGguZ2V0KHQpO1xuICAgICAgICAgICAgZSAmJiAoTihcIkNvbXBvbmVudFByb3ZpZGVyXCIsIFwiUmVtb3ZpbmcgRGF0YXN0b3JlXCIpLCB0aC5kZWxldGUodCksIGUudGVybWluYXRlKCkpO1xuICAgICAgICB9KHRoaXMpLCBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogTW9kaWZ5IHRoaXMgaW5zdGFuY2UgdG8gY29tbXVuaWNhdGUgd2l0aCB0aGUgQ2xvdWQgRmlyZXN0b3JlIGVtdWxhdG9yLlxuICpcbiAqIE5vdGU6IFRoaXMgbXVzdCBiZSBjYWxsZWQgYmVmb3JlIHRoaXMgaW5zdGFuY2UgaGFzIGJlZW4gdXNlZCB0byBkbyBhbnlcbiAqIG9wZXJhdGlvbnMuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSBgRmlyZXN0b3JlYCBpbnN0YW5jZSB0byBjb25maWd1cmUgdG8gY29ubmVjdCB0byB0aGVcbiAqIGVtdWxhdG9yLlxuICogQHBhcmFtIGhvc3QgLSB0aGUgZW11bGF0b3IgaG9zdCAoZXg6IGxvY2FsaG9zdCkuXG4gKiBAcGFyYW0gcG9ydCAtIHRoZSBlbXVsYXRvciBwb3J0IChleDogOTAwMCkuXG4gKiBAcGFyYW0gb3B0aW9ucy5tb2NrVXNlclRva2VuIC0gdGhlIG1vY2sgYXV0aCB0b2tlbiB0byB1c2UgZm9yIHVuaXQgdGVzdGluZ1xuICogU2VjdXJpdHkgUnVsZXMuXG4gKi8gZnVuY3Rpb24gaGgodCwgZSwgbiwgcyA9IHt9KSB7XG4gICAgdmFyIGk7XG4gICAgY29uc3QgciA9ICh0ID0gb2godCwgYWgpKS5fZ2V0U2V0dGluZ3MoKTtcbiAgICBpZiAoXCJmaXJlc3RvcmUuZ29vZ2xlYXBpcy5jb21cIiAhPT0gci5ob3N0ICYmIHIuaG9zdCAhPT0gZSAmJiBNKFwiSG9zdCBoYXMgYmVlbiBzZXQgaW4gYm90aCBzZXR0aW5ncygpIGFuZCB1c2VFbXVsYXRvcigpLCBlbXVsYXRvciBob3N0IHdpbGwgYmUgdXNlZFwiKSwgXG4gICAgdC5fc2V0U2V0dGluZ3MoT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCByKSwge1xuICAgICAgICBob3N0OiBgJHtlfToke259YCxcbiAgICAgICAgc3NsOiAhMVxuICAgIH0pKSwgcy5tb2NrVXNlclRva2VuKSB7XG4gICAgICAgIGxldCBlLCBuO1xuICAgICAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2Ygcy5tb2NrVXNlclRva2VuKSBlID0gcy5tb2NrVXNlclRva2VuLCBuID0gVi5NT0NLX1VTRVI7IGVsc2Uge1xuICAgICAgICAgICAgLy8gTGV0IGNyZWF0ZU1vY2tVc2VyVG9rZW4gdmFsaWRhdGUgZmlyc3QgKGNhdGNoZXMgY29tbW9uIG1pc3Rha2VzIGxpa2VcbiAgICAgICAgICAgIC8vIGludmFsaWQgZmllbGQgXCJ1aWRcIiBhbmQgbWlzc2luZyBmaWVsZCBcInN1YlwiIC8gXCJ1c2VyX2lkXCIuKVxuICAgICAgICAgICAgZSA9IGNyZWF0ZU1vY2tVc2VyVG9rZW4ocy5tb2NrVXNlclRva2VuLCBudWxsID09PSAoaSA9IHQuX2FwcCkgfHwgdm9pZCAwID09PSBpID8gdm9pZCAwIDogaS5vcHRpb25zLnByb2plY3RJZCk7XG4gICAgICAgICAgICBjb25zdCByID0gcy5tb2NrVXNlclRva2VuLnN1YiB8fCBzLm1vY2tVc2VyVG9rZW4udXNlcl9pZDtcbiAgICAgICAgICAgIGlmICghcikgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIm1vY2tVc2VyVG9rZW4gbXVzdCBjb250YWluICdzdWInIG9yICd1c2VyX2lkJyBmaWVsZCFcIik7XG4gICAgICAgICAgICBuID0gbmV3IFYocik7XG4gICAgICAgIH1cbiAgICAgICAgdC5fYXV0aENyZWRlbnRpYWxzID0gbmV3IGoobmV3IEcoZSwgbikpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBgRG9jdW1lbnRSZWZlcmVuY2VgIHJlZmVycyB0byBhIGRvY3VtZW50IGxvY2F0aW9uIGluIGEgRmlyZXN0b3JlIGRhdGFiYXNlXG4gKiBhbmQgY2FuIGJlIHVzZWQgdG8gd3JpdGUsIHJlYWQsIG9yIGxpc3RlbiB0byB0aGUgbG9jYXRpb24uIFRoZSBkb2N1bWVudCBhdFxuICogdGhlIHJlZmVyZW5jZWQgbG9jYXRpb24gbWF5IG9yIG1heSBub3QgZXhpc3QuXG4gKi8gY2xhc3MgbGgge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogSWYgcHJvdmlkZWQsIHRoZSBgRmlyZXN0b3JlRGF0YUNvbnZlcnRlcmAgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmNvbnZlcnRlciA9IGUsIHRoaXMuX2tleSA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImRvY3VtZW50XCIsIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgZ2V0IF9wYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGg7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFRoZSBkb2N1bWVudCdzIGlkZW50aWZpZXIgd2l0aGluIGl0cyBjb2xsZWN0aW9uLlxuICAgICAqLyAgICBnZXQgaWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgZG9jdW1lbnQgKHJlbGF0aXZlXG4gICAgICogdG8gdGhlIHJvb3Qgb2YgdGhlIGRhdGFiYXNlKS5cbiAgICAgKi8gICAgZ2V0IHBhdGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9rZXkucGF0aC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGNvbGxlY3Rpb24gdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGJlbG9uZ3MgdG8uXG4gICAgICovICAgIGdldCBwYXJlbnQoKSB7XG4gICAgICAgIHJldHVybiBuZXcgZGgodGhpcy5maXJlc3RvcmUsIHRoaXMuY29udmVydGVyLCB0aGlzLl9rZXkucGF0aC5wb3BMYXN0KCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBsaCh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fa2V5KTtcbiAgICB9XG59XG5cbi8qKlxuICogQSBgUXVlcnlgIHJlZmVycyB0byBhIHF1ZXJ5IHdoaWNoIHlvdSBjYW4gcmVhZCBvciBsaXN0ZW4gdG8uIFlvdSBjYW4gYWxzb1xuICogY29uc3RydWN0IHJlZmluZWQgYFF1ZXJ5YCBvYmplY3RzIGJ5IGFkZGluZyBmaWx0ZXJzIGFuZCBvcmRlcmluZy5cbiAqLyBjbGFzcyBmaCB7XG4gICAgLy8gVGhpcyBpcyB0aGUgbGl0ZSB2ZXJzaW9uIG9mIHRoZSBRdWVyeSBjbGFzcyBpbiB0aGUgbWFpbiBTREsuXG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLyoqXG4gICAgICogSWYgcHJvdmlkZWQsIHRoZSBgRmlyZXN0b3JlRGF0YUNvbnZlcnRlcmAgYXNzb2NpYXRlZCB3aXRoIHRoaXMgaW5zdGFuY2UuXG4gICAgICovXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmNvbnZlcnRlciA9IGUsIHRoaXMuX3F1ZXJ5ID0gbiwgXG4gICAgICAgIC8qKiBUaGUgdHlwZSBvZiB0aGlzIEZpcmVzdG9yZSByZWZlcmVuY2UuICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwicXVlcnlcIiwgdGhpcy5maXJlc3RvcmUgPSB0O1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBmaCh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcXVlcnkpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBBIGBDb2xsZWN0aW9uUmVmZXJlbmNlYCBvYmplY3QgY2FuIGJlIHVzZWQgZm9yIGFkZGluZyBkb2N1bWVudHMsIGdldHRpbmdcbiAqIGRvY3VtZW50IHJlZmVyZW5jZXMsIGFuZCBxdWVyeWluZyBmb3IgZG9jdW1lbnRzICh1c2luZyB7QGxpbmsgKHF1ZXJ5OjEpfSkuXG4gKi8gY2xhc3MgZGggZXh0ZW5kcyBmaCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKHQsIGUsIEduKG4pKSwgdGhpcy5fcGF0aCA9IG4sIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBGaXJlc3RvcmUgcmVmZXJlbmNlLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcImNvbGxlY3Rpb25cIjtcbiAgICB9XG4gICAgLyoqIFRoZSBjb2xsZWN0aW9uJ3MgaWRlbnRpZmllci4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcXVlcnkucGF0aC5sYXN0U2VnbWVudCgpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBIHN0cmluZyByZXByZXNlbnRpbmcgdGhlIHBhdGggb2YgdGhlIHJlZmVyZW5jZWQgY29sbGVjdGlvbiAocmVsYXRpdmVcbiAgICAgKiB0byB0aGUgcm9vdCBvZiB0aGUgZGF0YWJhc2UpLlxuICAgICAqLyAgICBnZXQgcGF0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3F1ZXJ5LnBhdGguY2Fub25pY2FsU3RyaW5nKCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEEgcmVmZXJlbmNlIHRvIHRoZSBjb250YWluaW5nIGBEb2N1bWVudFJlZmVyZW5jZWAgaWYgdGhpcyBpcyBhXG4gICAgICogc3ViY29sbGVjdGlvbi4gSWYgdGhpcyBpc24ndCBhIHN1YmNvbGxlY3Rpb24sIHRoZSByZWZlcmVuY2UgaXMgbnVsbC5cbiAgICAgKi8gICAgZ2V0IHBhcmVudCgpIHtcbiAgICAgICAgY29uc3QgdCA9IHRoaXMuX3BhdGgucG9wTGFzdCgpO1xuICAgICAgICByZXR1cm4gdC5pc0VtcHR5KCkgPyBudWxsIDogbmV3IGxoKHRoaXMuZmlyZXN0b3JlLCBcbiAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsLCBuZXcgaHQodCkpO1xuICAgIH1cbiAgICB3aXRoQ29udmVydGVyKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBkaCh0aGlzLmZpcmVzdG9yZSwgdCwgdGhpcy5fcGF0aCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBfaCh0LCBlLCAuLi5uKSB7XG4gICAgaWYgKHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCksIGVoKFwiY29sbGVjdGlvblwiLCBcInBhdGhcIiwgZSksIHQgaW5zdGFuY2VvZiBhaCkge1xuICAgICAgICBjb25zdCBzID0gdXQuZnJvbVN0cmluZyhlLCAuLi5uKTtcbiAgICAgICAgcmV0dXJuIGloKHMpLCBuZXcgZGgodCwgLyogY29udmVydGVyPSAqLyBudWxsLCBzKTtcbiAgICB9XG4gICAge1xuICAgICAgICBpZiAoISh0IGluc3RhbmNlb2YgbGggfHwgdCBpbnN0YW5jZW9mIGRoKSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkV4cGVjdGVkIGZpcnN0IGFyZ3VtZW50IHRvIGNvbGxlY3Rpb24oKSB0byBiZSBhIENvbGxlY3Rpb25SZWZlcmVuY2UsIGEgRG9jdW1lbnRSZWZlcmVuY2Ugb3IgRmlyZWJhc2VGaXJlc3RvcmVcIik7XG4gICAgICAgIGNvbnN0IHMgPSB0Ll9wYXRoLmNoaWxkKHV0LmZyb21TdHJpbmcoZSwgLi4ubikpO1xuICAgICAgICByZXR1cm4gaWgocyksIG5ldyBkaCh0LmZpcmVzdG9yZSwgXG4gICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgcyk7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZWxpdGUpOiBDb25zaWRlciB1c2luZyBFcnJvckZhY3RvcnkgLVxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2ZpcmViYXNlL2ZpcmViYXNlLWpzLXNkay9ibG9iLzAxMzFlMWYvcGFja2FnZXMvdXRpbC9zcmMvZXJyb3JzLnRzI0wxMDZcbi8qKlxuICogQ3JlYXRlcyBhbmQgcmV0dXJucyBhIG5ldyBgUXVlcnlgIGluc3RhbmNlIHRoYXQgaW5jbHVkZXMgYWxsIGRvY3VtZW50cyBpbiB0aGVcbiAqIGRhdGFiYXNlIHRoYXQgYXJlIGNvbnRhaW5lZCBpbiBhIGNvbGxlY3Rpb24gb3Igc3ViY29sbGVjdGlvbiB3aXRoIHRoZVxuICogZ2l2ZW4gYGNvbGxlY3Rpb25JZGAuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSByb290IGBGaXJlc3RvcmVgIGluc3RhbmNlLlxuICogQHBhcmFtIGNvbGxlY3Rpb25JZCAtIElkZW50aWZpZXMgdGhlIGNvbGxlY3Rpb25zIHRvIHF1ZXJ5IG92ZXIuIEV2ZXJ5XG4gKiBjb2xsZWN0aW9uIG9yIHN1YmNvbGxlY3Rpb24gd2l0aCB0aGlzIElEIGFzIHRoZSBsYXN0IHNlZ21lbnQgb2YgaXRzIHBhdGhcbiAqIHdpbGwgYmUgaW5jbHVkZWQuIENhbm5vdCBjb250YWluIGEgc2xhc2guXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCBgUXVlcnlgLlxuICovIGZ1bmN0aW9uIHdoKHQsIGUpIHtcbiAgICBpZiAodCA9IG9oKHQsIGFoKSwgZWgoXCJjb2xsZWN0aW9uR3JvdXBcIiwgXCJjb2xsZWN0aW9uIGlkXCIsIGUpLCBlLmluZGV4T2YoXCIvXCIpID49IDApIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgY29sbGVjdGlvbiBJRCAnJHtlfScgcGFzc2VkIHRvIGZ1bmN0aW9uIGNvbGxlY3Rpb25Hcm91cCgpLiBDb2xsZWN0aW9uIElEcyBtdXN0IG5vdCBjb250YWluICcvJy5gKTtcbiAgICByZXR1cm4gbmV3IGZoKHQsIFxuICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgZnVuY3Rpb24odCkge1xuICAgICAgICByZXR1cm4gbmV3IFVuKHV0LmVtcHR5UGF0aCgpLCB0KTtcbiAgICB9KGUpKTtcbn1cblxuZnVuY3Rpb24gbWgodCwgZSwgLi4ubikge1xuICAgIGlmICh0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBcbiAgICAvLyBXZSBhbGxvdyBvbWlzc2lvbiBvZiAncGF0aFN0cmluZycgYnV0IGV4cGxpY2l0bHkgcHJvaGliaXQgcGFzc2luZyBpbiBib3RoXG4gICAgLy8gJ3VuZGVmaW5lZCcgYW5kICdudWxsJy5cbiAgICAxID09PSBhcmd1bWVudHMubGVuZ3RoICYmIChlID0gdHQuQSgpKSwgZWgoXCJkb2NcIiwgXCJwYXRoXCIsIGUpLCB0IGluc3RhbmNlb2YgYWgpIHtcbiAgICAgICAgY29uc3QgcyA9IHV0LmZyb21TdHJpbmcoZSwgLi4ubik7XG4gICAgICAgIHJldHVybiBzaChzKSwgbmV3IGxoKHQsIFxuICAgICAgICAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIG5ldyBodChzKSk7XG4gICAgfVxuICAgIHtcbiAgICAgICAgaWYgKCEodCBpbnN0YW5jZW9mIGxoIHx8IHQgaW5zdGFuY2VvZiBkaCkpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJFeHBlY3RlZCBmaXJzdCBhcmd1bWVudCB0byBjb2xsZWN0aW9uKCkgdG8gYmUgYSBDb2xsZWN0aW9uUmVmZXJlbmNlLCBhIERvY3VtZW50UmVmZXJlbmNlIG9yIEZpcmViYXNlRmlyZXN0b3JlXCIpO1xuICAgICAgICBjb25zdCBzID0gdC5fcGF0aC5jaGlsZCh1dC5mcm9tU3RyaW5nKGUsIC4uLm4pKTtcbiAgICAgICAgcmV0dXJuIHNoKHMpLCBuZXcgbGgodC5maXJlc3RvcmUsIHQgaW5zdGFuY2VvZiBkaCA/IHQuY29udmVydGVyIDogbnVsbCwgbmV3IGh0KHMpKTtcbiAgICB9XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCByZWZlcmVuY2VzIGFyZSBlcXVhbC5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgcmVmZXJlbmNlIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBBIHJlZmVyZW5jZSB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgcmVmZXJlbmNlcyBwb2ludCB0byB0aGUgc2FtZSBsb2NhdGlvbiBpbiB0aGUgc2FtZVxuICogRmlyZXN0b3JlIGRhdGFiYXNlLlxuICovIGZ1bmN0aW9uIGdoKHQsIGUpIHtcbiAgICByZXR1cm4gdCA9IGdldE1vZHVsYXJJbnN0YW5jZSh0KSwgZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSwgKHQgaW5zdGFuY2VvZiBsaCB8fCB0IGluc3RhbmNlb2YgZGgpICYmIChlIGluc3RhbmNlb2YgbGggfHwgZSBpbnN0YW5jZW9mIGRoKSAmJiAodC5maXJlc3RvcmUgPT09IGUuZmlyZXN0b3JlICYmIHQucGF0aCA9PT0gZS5wYXRoICYmIHQuY29udmVydGVyID09PSBlLmNvbnZlcnRlcik7XG59XG5cbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBxdWVyaWVzIHBvaW50IHRvIHRoZSBzYW1lIGNvbGxlY3Rpb24gYW5kIGFwcGx5XG4gKiB0aGUgc2FtZSBjb25zdHJhaW50cy5cbiAqXG4gKiBAcGFyYW0gbGVmdCAtIEEgYFF1ZXJ5YCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBgUXVlcnlgIHRvIGNvbXBhcmUuXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSByZWZlcmVuY2VzIHBvaW50IHRvIHRoZSBzYW1lIGxvY2F0aW9uIGluIHRoZSBzYW1lXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UuXG4gKi8gZnVuY3Rpb24geWgodCwgZSkge1xuICAgIHJldHVybiB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpLCBlID0gZ2V0TW9kdWxhckluc3RhbmNlKGUpLCB0IGluc3RhbmNlb2YgZmggJiYgZSBpbnN0YW5jZW9mIGZoICYmICh0LmZpcmVzdG9yZSA9PT0gZS5maXJlc3RvcmUgJiYgWm4odC5fcXVlcnksIGUuX3F1ZXJ5KSAmJiB0LmNvbnZlcnRlciA9PT0gZS5jb252ZXJ0ZXIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjbGFzcyBwaCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIFRoZSBsYXN0IHByb21pc2UgaW4gdGhlIHF1ZXVlLlxuICAgICAgICB0aGlzLktjID0gUHJvbWlzZS5yZXNvbHZlKCksIFxuICAgICAgICAvLyBBIGxpc3Qgb2YgcmV0cnlhYmxlIG9wZXJhdGlvbnMuIFJldHJ5YWJsZSBvcGVyYXRpb25zIGFyZSBydW4gaW4gb3JkZXIgYW5kXG4gICAgICAgIC8vIHJldHJpZWQgd2l0aCBiYWNrb2ZmLlxuICAgICAgICB0aGlzLkdjID0gW10sIFxuICAgICAgICAvLyBJcyB0aGlzIEFzeW5jUXVldWUgYmVpbmcgc2h1dCBkb3duPyBPbmNlIGl0IGlzIHNldCB0byB0cnVlLCBpdCB3aWxsIG5vdFxuICAgICAgICAvLyBiZSBjaGFuZ2VkIGFnYWluLlxuICAgICAgICB0aGlzLlFjID0gITEsIFxuICAgICAgICAvLyBPcGVyYXRpb25zIHNjaGVkdWxlZCB0byBiZSBxdWV1ZWQgaW4gdGhlIGZ1dHVyZS4gT3BlcmF0aW9ucyBhcmVcbiAgICAgICAgLy8gYXV0b21hdGljYWxseSByZW1vdmVkIGFmdGVyIHRoZXkgYXJlIHJ1biBvciBjYW5jZWxlZC5cbiAgICAgICAgdGhpcy5qYyA9IFtdLCBcbiAgICAgICAgLy8gdmlzaWJsZSBmb3IgdGVzdGluZ1xuICAgICAgICB0aGlzLnpjID0gbnVsbCwgXG4gICAgICAgIC8vIEZsYWcgc2V0IHdoaWxlIHRoZXJlJ3MgYW4gb3V0c3RhbmRpbmcgQXN5bmNRdWV1ZSBvcGVyYXRpb24sIHVzZWQgZm9yXG4gICAgICAgIC8vIGFzc2VydGlvbiBzYW5pdHktY2hlY2tzLlxuICAgICAgICB0aGlzLldjID0gITEsIFxuICAgICAgICAvLyBFbmFibGVkIGR1cmluZyBzaHV0ZG93biBvbiBTYWZhcmkgdG8gcHJldmVudCBmdXR1cmUgYWNjZXNzIHRvIEluZGV4ZWREQi5cbiAgICAgICAgdGhpcy5IYyA9ICExLCBcbiAgICAgICAgLy8gTGlzdCBvZiBUaW1lcklkcyB0byBmYXN0LWZvcndhcmQgZGVsYXlzIGZvci5cbiAgICAgICAgdGhpcy5KYyA9IFtdLCBcbiAgICAgICAgLy8gQmFja29mZiB0aW1lciB1c2VkIHRvIHNjaGVkdWxlIHJldHJpZXMgZm9yIHJldHJ5YWJsZSBvcGVyYXRpb25zXG4gICAgICAgIHRoaXMuTG8gPSBuZXcgQnUodGhpcywgXCJhc3luY19xdWV1ZV9yZXRyeVwiIC8qIFRpbWVySWQuQXN5bmNRdWV1ZVJldHJ5ICovKSwgXG4gICAgICAgIC8vIFZpc2liaWxpdHkgaGFuZGxlciB0aGF0IHRyaWdnZXJzIGFuIGltbWVkaWF0ZSByZXRyeSBvZiBhbGwgcmV0cnlhYmxlXG4gICAgICAgIC8vIG9wZXJhdGlvbnMuIE1lYW50IHRvIHNwZWVkIHVwIHJlY292ZXJ5IHdoZW4gd2UgcmVnYWluIGZpbGUgc3lzdGVtIGFjY2Vzc1xuICAgICAgICAvLyBhZnRlciBwYWdlIGNvbWVzIGludG8gZm9yZWdyb3VuZC5cbiAgICAgICAgdGhpcy5ZYyA9ICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSAkdSgpO1xuICAgICAgICAgICAgdCAmJiBOKFwiQXN5bmNRdWV1ZVwiLCBcIlZpc2liaWxpdHkgc3RhdGUgY2hhbmdlZCB0byBcIiArIHQudmlzaWJpbGl0eVN0YXRlKSwgdGhpcy5Mby5rbygpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCB0ID0gJHUoKTtcbiAgICAgICAgdCAmJiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQuYWRkRXZlbnRMaXN0ZW5lciAmJiB0LmFkZEV2ZW50TGlzdGVuZXIoXCJ2aXNpYmlsaXR5Y2hhbmdlXCIsIHRoaXMuWWMpO1xuICAgIH1cbiAgICBnZXQgaXNTaHV0dGluZ0Rvd24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLlFjO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBZGRzIGEgbmV3IG9wZXJhdGlvbiB0byB0aGUgcXVldWUgd2l0aG91dCB3YWl0aW5nIGZvciBpdCB0byBjb21wbGV0ZSAoaS5lLlxuICAgICAqIHdlIGlnbm9yZSB0aGUgUHJvbWlzZSByZXN1bHQpLlxuICAgICAqLyAgICBlbnF1ZXVlQW5kRm9yZ2V0KHQpIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLmVucXVldWUodCk7XG4gICAgfVxuICAgIGVucXVldWVBbmRGb3JnZXRFdmVuV2hpbGVSZXN0cmljdGVkKHQpIHtcbiAgICAgICAgdGhpcy5YYygpLCBcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlc1xuICAgICAgICB0aGlzLlpjKHQpO1xuICAgIH1cbiAgICBlbnRlclJlc3RyaWN0ZWRNb2RlKHQpIHtcbiAgICAgICAgaWYgKCF0aGlzLlFjKSB7XG4gICAgICAgICAgICB0aGlzLlFjID0gITAsIHRoaXMuSGMgPSB0IHx8ICExO1xuICAgICAgICAgICAgY29uc3QgZSA9ICR1KCk7XG4gICAgICAgICAgICBlICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZS5yZW1vdmVFdmVudExpc3RlbmVyICYmIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInZpc2liaWxpdHljaGFuZ2VcIiwgdGhpcy5ZYyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgZW5xdWV1ZSh0KSB7XG4gICAgICAgIGlmICh0aGlzLlhjKCksIHRoaXMuUWMpIFxuICAgICAgICAvLyBSZXR1cm4gYSBQcm9taXNlIHdoaWNoIG5ldmVyIHJlc29sdmVzLlxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKCgpID0+IHt9KSk7XG4gICAgICAgIC8vIENyZWF0ZSBhIGRlZmVycmVkIFByb21pc2UgdGhhdCB3ZSBjYW4gcmV0dXJuIHRvIHRoZSBjYWxsZWUuIFRoaXNcbiAgICAgICAgLy8gYWxsb3dzIHVzIHRvIHJldHVybiBhIFwiaGFuZ2luZyBQcm9taXNlXCIgb25seSB0byB0aGUgY2FsbGVlIGFuZCBzdGlsbFxuICAgICAgICAvLyBhZHZhbmNlIHRoZSBxdWV1ZSBldmVuIHdoZW4gdGhlIG9wZXJhdGlvbiBpcyBub3QgcnVuLlxuICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBuZXcgSztcbiAgICAgICAgcmV0dXJuIHRoaXMuWmMoKCgpID0+IHRoaXMuUWMgJiYgdGhpcy5IYyA/IFByb21pc2UucmVzb2x2ZSgpIDogKHQoKS50aGVuKGUucmVzb2x2ZSwgZS5yZWplY3QpLCBcbiAgICAgICAgZS5wcm9taXNlKSkpLnRoZW4oKCgpID0+IGUucHJvbWlzZSkpO1xuICAgIH1cbiAgICBlbnF1ZXVlUmV0cnlhYmxlKHQpIHtcbiAgICAgICAgdGhpcy5lbnF1ZXVlQW5kRm9yZ2V0KCgoKSA9PiAodGhpcy5HYy5wdXNoKHQpLCB0aGlzLnRhKCkpKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJ1bnMgdGhlIG5leHQgb3BlcmF0aW9uIGZyb20gdGhlIHJldHJ5YWJsZSBxdWV1ZS4gSWYgdGhlIG9wZXJhdGlvbiBmYWlscyxcbiAgICAgKiByZXNjaGVkdWxlcyB3aXRoIGJhY2tvZmYuXG4gICAgICovICAgIGFzeW5jIHRhKCkge1xuICAgICAgICBpZiAoMCAhPT0gdGhpcy5HYy5sZW5ndGgpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5HY1swXSgpLCB0aGlzLkdjLnNoaWZ0KCksIHRoaXMuTG8ucmVzZXQoKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUR0KHQpKSB0aHJvdyB0O1xuIC8vIEZhaWx1cmUgd2lsbCBiZSBoYW5kbGVkIGJ5IEFzeW5jUXVldWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTihcIkFzeW5jUXVldWVcIiwgXCJPcGVyYXRpb24gZmFpbGVkIHdpdGggcmV0cnlhYmxlIGVycm9yOiBcIiArIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5HYy5sZW5ndGggPiAwICYmIFxuICAgICAgICAgICAgLy8gSWYgdGhlcmUgYXJlIGFkZGl0aW9uYWwgb3BlcmF0aW9ucywgd2UgcmUtc2NoZWR1bGUgYHJldHJ5TmV4dE9wKClgLlxuICAgICAgICAgICAgLy8gVGhpcyBpcyBuZWNlc3NhcnkgdG8gcnVuIHJldHJ5YWJsZSBvcGVyYXRpb25zIHRoYXQgZmFpbGVkIGR1cmluZ1xuICAgICAgICAgICAgLy8gdGhlaXIgaW5pdGlhbCBhdHRlbXB0IHNpbmNlIHdlIGRvbid0IGtub3cgd2hldGhlciB0aGV5IGFyZSBhbHJlYWR5XG4gICAgICAgICAgICAvLyBlbnF1ZXVlZC4gSWYsIGZvciBleGFtcGxlLCBgb3AxYCwgYG9wMmAsIGBvcDNgIGFyZSBlbnF1ZXVlZCBhbmQgYG9wMWBcbiAgICAgICAgICAgIC8vIG5lZWRzIHRvICBiZSByZS1ydW4sIHdlIHdpbGwgcnVuIGBvcDFgLCBgb3AxYCwgYG9wMmAgdXNpbmcgdGhlXG4gICAgICAgICAgICAvLyBhbHJlYWR5IGVucXVldWVkIGNhbGxzIHRvIGByZXRyeU5leHRPcCgpYC4gYG9wMygpYCB3aWxsIHRoZW4gcnVuIGluIHRoZVxuICAgICAgICAgICAgLy8gY2FsbCBzY2hlZHVsZWQgaGVyZS5cbiAgICAgICAgICAgIC8vIFNpbmNlIGBiYWNrb2ZmQW5kUnVuKClgIGNhbmNlbHMgYW4gZXhpc3RpbmcgYmFja29mZiBhbmQgc2NoZWR1bGVzIGFcbiAgICAgICAgICAgIC8vIG5ldyBiYWNrb2ZmIG9uIGV2ZXJ5IGNhbGwsIHRoZXJlIGlzIG9ubHkgZXZlciBhIHNpbmdsZSBhZGRpdGlvbmFsXG4gICAgICAgICAgICAvLyBvcGVyYXRpb24gaW4gdGhlIHF1ZXVlLlxuICAgICAgICAgICAgdGhpcy5Mby54bygoKCkgPT4gdGhpcy50YSgpKSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgWmModCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5LYy50aGVuKCgoKSA9PiAodGhpcy5XYyA9ICEwLCB0KCkuY2F0Y2goKHQgPT4ge1xuICAgICAgICAgICAgdGhpcy56YyA9IHQsIHRoaXMuV2MgPSAhMTtcbiAgICAgICAgICAgIGNvbnN0IGUgPSBcbiAgICAgICAgICAgIC8qKlxuICogQ2hyb21lIGluY2x1ZGVzIEVycm9yLm1lc3NhZ2UgaW4gRXJyb3Iuc3RhY2suIE90aGVyIGJyb3dzZXJzIGRvIG5vdC5cbiAqIFRoaXMgcmV0dXJucyBleHBlY3RlZCBvdXRwdXQgb2YgbWVzc2FnZSArIHN0YWNrIHdoZW4gYXZhaWxhYmxlLlxuICogQHBhcmFtIGVycm9yIC0gRXJyb3Igb3IgRmlyZXN0b3JlRXJyb3JcbiAqL1xuICAgICAgICAgICAgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGxldCBlID0gdC5tZXNzYWdlIHx8IFwiXCI7XG4gICAgICAgICAgICAgICAgdC5zdGFjayAmJiAoZSA9IHQuc3RhY2suaW5jbHVkZXModC5tZXNzYWdlKSA/IHQuc3RhY2sgOiB0Lm1lc3NhZ2UgKyBcIlxcblwiICsgdC5zdGFjayk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyAodCk7XG4gICAgICAgICAgICAvLyBSZS10aHJvdyB0aGUgZXJyb3Igc28gdGhhdCB0aGlzLnRhaWwgYmVjb21lcyBhIHJlamVjdGVkIFByb21pc2UgYW5kXG4gICAgICAgICAgICAvLyBhbGwgZnVydGhlciBhdHRlbXB0cyB0byBjaGFpbiAodmlhIC50aGVuKSB3aWxsIGp1c3Qgc2hvcnQtY2lyY3VpdFxuICAgICAgICAgICAgLy8gYW5kIHJldHVybiB0aGUgcmVqZWN0ZWQgUHJvbWlzZS5cbiAgICAgICAgICAgIHRocm93IGsoXCJJTlRFUk5BTCBVTkhBTkRMRUQgRVJST1I6IFwiLCBlKSwgdDtcbiAgICAgICAgfSkpLnRoZW4oKHQgPT4gKHRoaXMuV2MgPSAhMSwgdCkpKSkpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuS2MgPSBlLCBlO1xuICAgIH1cbiAgICBlbnF1ZXVlQWZ0ZXJEZWxheSh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuWGMoKSwgXG4gICAgICAgIC8vIEZhc3QtZm9yd2FyZCBkZWxheXMgZm9yIHRpbWVySWRzIHRoYXQgaGF2ZSBiZWVuIG92ZXJyaWRlbi5cbiAgICAgICAgdGhpcy5KYy5pbmRleE9mKHQpID4gLTEgJiYgKGUgPSAwKTtcbiAgICAgICAgY29uc3QgcyA9IFRjLmNyZWF0ZUFuZFNjaGVkdWxlKHRoaXMsIHQsIGUsIG4sICh0ID0+IHRoaXMuZWEodCkpKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuamMucHVzaChzKSwgcztcbiAgICB9XG4gICAgWGMoKSB7XG4gICAgICAgIHRoaXMuemMgJiYgJCgpO1xuICAgIH1cbiAgICB2ZXJpZnlPcGVyYXRpb25JblByb2dyZXNzKCkge31cbiAgICAvKipcbiAgICAgKiBXYWl0cyB1bnRpbCBhbGwgY3VycmVudGx5IHF1ZXVlZCB0YXNrcyBhcmUgZmluaXNoZWQgZXhlY3V0aW5nLiBEZWxheWVkXG4gICAgICogb3BlcmF0aW9ucyBhcmUgbm90IHJ1bi5cbiAgICAgKi8gICAgYXN5bmMgbmEoKSB7XG4gICAgICAgIC8vIE9wZXJhdGlvbnMgaW4gdGhlIHF1ZXVlIHByaW9yIHRvIGRyYWluaW5nIG1heSBoYXZlIGVucXVldWVkIGFkZGl0aW9uYWxcbiAgICAgICAgLy8gb3BlcmF0aW9ucy4gS2VlcCBkcmFpbmluZyB0aGUgcXVldWUgdW50aWwgdGhlIHRhaWwgaXMgbm8gbG9uZ2VyIGFkdmFuY2VkLFxuICAgICAgICAvLyB3aGljaCBpbmRpY2F0ZXMgdGhhdCBubyBtb3JlIG5ldyBvcGVyYXRpb25zIHdlcmUgZW5xdWV1ZWQgYW5kIHRoYXQgYWxsXG4gICAgICAgIC8vIG9wZXJhdGlvbnMgd2VyZSBleGVjdXRlZC5cbiAgICAgICAgbGV0IHQ7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHQgPSB0aGlzLktjLCBhd2FpdCB0O1xuICAgICAgICB9IHdoaWxlICh0ICE9PSB0aGlzLktjKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9yIFRlc3RzOiBEZXRlcm1pbmUgaWYgYSBkZWxheWVkIG9wZXJhdGlvbiB3aXRoIGEgcGFydGljdWxhciBUaW1lcklkXG4gICAgICogZXhpc3RzLlxuICAgICAqLyAgICBzYSh0KSB7XG4gICAgICAgIGZvciAoY29uc3QgZSBvZiB0aGlzLmpjKSBpZiAoZS50aW1lcklkID09PSB0KSByZXR1cm4gITA7XG4gICAgICAgIHJldHVybiAhMTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9yIFRlc3RzOiBSdW5zIHNvbWUgb3IgYWxsIGRlbGF5ZWQgb3BlcmF0aW9ucyBlYXJseS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBsYXN0VGltZXJJZCAtIERlbGF5ZWQgb3BlcmF0aW9ucyB1cCB0byBhbmQgaW5jbHVkaW5nIHRoaXMgVGltZXJJZFxuICAgICAqIHdpbGwgYmUgZHJhaW5lZC4gUGFzcyBUaW1lcklkLkFsbCB0byBydW4gYWxsIGRlbGF5ZWQgb3BlcmF0aW9ucy5cbiAgICAgKiBAcmV0dXJucyBhIFByb21pc2UgdGhhdCByZXNvbHZlcyBvbmNlIGFsbCBvcGVyYXRpb25zIGhhdmUgYmVlbiBydW4uXG4gICAgICovICAgIGlhKHQpIHtcbiAgICAgICAgLy8gTm90ZSB0aGF0IGRyYWluaW5nIG1heSBnZW5lcmF0ZSBtb3JlIGRlbGF5ZWQgb3BzLCBzbyB3ZSBkbyB0aGF0IGZpcnN0LlxuICAgICAgICByZXR1cm4gdGhpcy5uYSgpLnRoZW4oKCgpID0+IHtcbiAgICAgICAgICAgIC8vIFJ1biBvcHMgaW4gdGhlIHNhbWUgb3JkZXIgdGhleSdkIHJ1biBpZiB0aGV5IHJhbiBuYXR1cmFsbHkuXG4gICAgICAgICAgICB0aGlzLmpjLnNvcnQoKCh0LCBlKSA9PiB0LnRhcmdldFRpbWVNcyAtIGUudGFyZ2V0VGltZU1zKSk7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGUgb2YgdGhpcy5qYykgaWYgKGUuc2tpcERlbGF5KCksIFwiYWxsXCIgLyogVGltZXJJZC5BbGwgKi8gIT09IHQgJiYgZS50aW1lcklkID09PSB0KSBicmVhaztcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm5hKCk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRm9yIFRlc3RzOiBTa2lwIGFsbCBzdWJzZXF1ZW50IGRlbGF5cyBmb3IgYSB0aW1lciBpZC5cbiAgICAgKi8gICAgcmEodCkge1xuICAgICAgICB0aGlzLkpjLnB1c2godCk7XG4gICAgfVxuICAgIC8qKiBDYWxsZWQgb25jZSBhIERlbGF5ZWRPcGVyYXRpb24gaXMgcnVuIG9yIGNhbmNlbGVkLiAqLyAgICBlYSh0KSB7XG4gICAgICAgIC8vIE5PVEU6IGluZGV4T2YgLyBzbGljZSBhcmUgTyhuKSwgYnV0IGRlbGF5ZWRPcGVyYXRpb25zIGlzIGV4cGVjdGVkIHRvIGJlIHNtYWxsLlxuICAgICAgICBjb25zdCBlID0gdGhpcy5qYy5pbmRleE9mKHQpO1xuICAgICAgICB0aGlzLmpjLnNwbGljZShlLCAxKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEloKHQpIHtcbiAgICAvKipcbiAqIFJldHVybnMgdHJ1ZSBpZiBvYmogaXMgYW4gb2JqZWN0IGFuZCBjb250YWlucyBhdCBsZWFzdCBvbmUgb2YgdGhlIHNwZWNpZmllZFxuICogbWV0aG9kcy5cbiAqL1xuICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGlmIChcIm9iamVjdFwiICE9IHR5cGVvZiB0IHx8IG51bGwgPT09IHQpIHJldHVybiAhMTtcbiAgICAgICAgY29uc3QgbiA9IHQ7XG4gICAgICAgIGZvciAoY29uc3QgdCBvZiBlKSBpZiAodCBpbiBuICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2Ygblt0XSkgcmV0dXJuICEwO1xuICAgICAgICByZXR1cm4gITE7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4gICAgLyoqXG4gKiBSZXByZXNlbnRzIHRoZSB0YXNrIG9mIGxvYWRpbmcgYSBGaXJlc3RvcmUgYnVuZGxlLiBJdCBwcm92aWRlcyBwcm9ncmVzcyBvZiBidW5kbGVcbiAqIGxvYWRpbmcsIGFzIHdlbGwgYXMgdGFzayBjb21wbGV0aW9uIGFuZCBlcnJvciBldmVudHMuXG4gKlxuICogVGhlIEFQSSBpcyBjb21wYXRpYmxlIHdpdGggYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz5gLlxuICovICh0LCBbIFwibmV4dFwiLCBcImVycm9yXCIsIFwiY29tcGxldGVcIiBdKTtcbn1cblxuY2xhc3MgVGgge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLl9wcm9ncmVzc09ic2VydmVyID0ge30sIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIgPSBuZXcgSywgdGhpcy5fbGFzdFByb2dyZXNzID0ge1xuICAgICAgICAgICAgdGFza1N0YXRlOiBcIlJ1bm5pbmdcIixcbiAgICAgICAgICAgIHRvdGFsQnl0ZXM6IDAsXG4gICAgICAgICAgICB0b3RhbERvY3VtZW50czogMCxcbiAgICAgICAgICAgIGJ5dGVzTG9hZGVkOiAwLFxuICAgICAgICAgICAgZG9jdW1lbnRzTG9hZGVkOiAwXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBmdW5jdGlvbnMgdG8gbGlzdGVuIHRvIGJ1bmRsZSBsb2FkaW5nIHByb2dyZXNzIGV2ZW50cy5cbiAgICAgKiBAcGFyYW0gbmV4dCAtIENhbGxlZCB3aGVuIHRoZXJlIGlzIGEgcHJvZ3Jlc3MgdXBkYXRlIGZyb20gYnVuZGxlIGxvYWRpbmcuIFR5cGljYWxseSBgbmV4dGAgY2FsbHMgb2NjdXJcbiAgICAgKiAgIGVhY2ggdGltZSBhIEZpcmVzdG9yZSBkb2N1bWVudCBpcyBsb2FkZWQgZnJvbSB0aGUgYnVuZGxlLlxuICAgICAqIEBwYXJhbSBlcnJvciAtIENhbGxlZCB3aGVuIGFuIGVycm9yIG9jY3VycyBkdXJpbmcgYnVuZGxlIGxvYWRpbmcuIFRoZSB0YXNrIGFib3J0cyBhZnRlciByZXBvcnRpbmcgdGhlXG4gICAgICogICBlcnJvciwgYW5kIHRoZXJlIHNob3VsZCBiZSBubyBtb3JlIHVwZGF0ZXMgYWZ0ZXIgdGhpcy5cbiAgICAgKiBAcGFyYW0gY29tcGxldGUgLSBDYWxsZWQgd2hlbiB0aGUgbG9hZGluZyB0YXNrIGlzIGNvbXBsZXRlLlxuICAgICAqLyAgICBvblByb2dyZXNzKHQsIGUsIG4pIHtcbiAgICAgICAgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlciA9IHtcbiAgICAgICAgICAgIG5leHQ6IHQsXG4gICAgICAgICAgICBlcnJvcjogZSxcbiAgICAgICAgICAgIGNvbXBsZXRlOiBuXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEltcGxlbWVudHMgdGhlIGBQcm9taXNlPExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3M+LmNhdGNoYCBpbnRlcmZhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb25SZWplY3RlZCAtIENhbGxlZCB3aGVuIGFuIGVycm9yIG9jY3VycyBkdXJpbmcgYnVuZGxlIGxvYWRpbmcuXG4gICAgICovICAgIGNhdGNoKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Rhc2tDb21wbGV0aW9uUmVzb2x2ZXIucHJvbWlzZS5jYXRjaCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogSW1wbGVtZW50cyB0aGUgYFByb21pc2U8TG9hZEJ1bmRsZVRhc2tQcm9ncmVzcz4udGhlbmAgaW50ZXJmYWNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIG9uRnVsZmlsbGVkIC0gQ2FsbGVkIG9uIHRoZSBjb21wbGV0aW9uIG9mIHRoZSBsb2FkaW5nIHRhc2sgd2l0aCBhIGZpbmFsIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCB1cGRhdGUuXG4gICAgICogICBUaGUgdXBkYXRlIHdpbGwgYWx3YXlzIGhhdmUgaXRzIGB0YXNrU3RhdGVgIHNldCB0byBgXCJTdWNjZXNzXCJgLlxuICAgICAqIEBwYXJhbSBvblJlamVjdGVkIC0gQ2FsbGVkIHdoZW4gYW4gZXJyb3Igb2NjdXJzIGR1cmluZyBidW5kbGUgbG9hZGluZy5cbiAgICAgKi8gICAgdGhlbih0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnByb21pc2UudGhlbih0LCBlKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgYWxsIG9ic2VydmVycyB0aGF0IGJ1bmRsZSBsb2FkaW5nIGhhcyBjb21wbGV0ZWQsIHdpdGggYSBwcm92aWRlZFxuICAgICAqIGBMb2FkQnVuZGxlVGFza1Byb2dyZXNzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcHJpdmF0ZVxuICAgICAqLyAgICBfY29tcGxldGVXaXRoKHQpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlUHJvZ3Jlc3ModCksIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIuY29tcGxldGUgJiYgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5jb21wbGV0ZSgpLCBcbiAgICAgICAgdGhpcy5fdGFza0NvbXBsZXRpb25SZXNvbHZlci5yZXNvbHZlKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBOb3RpZmllcyBhbGwgb2JzZXJ2ZXJzIHRoYXQgYnVuZGxlIGxvYWRpbmcgaGFzIGZhaWxlZCwgd2l0aCBhIHByb3ZpZGVkXG4gICAgICogYEVycm9yYCBhcyB0aGUgcmVhc29uLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi8gICAgX2ZhaWxXaXRoKHQpIHtcbiAgICAgICAgdGhpcy5fbGFzdFByb2dyZXNzLnRhc2tTdGF0ZSA9IFwiRXJyb3JcIiwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0ICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIubmV4dCh0aGlzLl9sYXN0UHJvZ3Jlc3MpLCBcbiAgICAgICAgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5lcnJvciAmJiB0aGlzLl9wcm9ncmVzc09ic2VydmVyLmVycm9yKHQpLCB0aGlzLl90YXNrQ29tcGxldGlvblJlc29sdmVyLnJlamVjdCh0KTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogTm90aWZpZXMgYSBwcm9ncmVzcyB1cGRhdGUgb2YgbG9hZGluZyBhIGJ1bmRsZS5cbiAgICAgKiBAcGFyYW0gcHJvZ3Jlc3MgLSBUaGUgbmV3IHByb2dyZXNzLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi8gICAgX3VwZGF0ZVByb2dyZXNzKHQpIHtcbiAgICAgICAgdGhpcy5fbGFzdFByb2dyZXNzID0gdCwgdGhpcy5fcHJvZ3Jlc3NPYnNlcnZlci5uZXh0ICYmIHRoaXMuX3Byb2dyZXNzT2JzZXJ2ZXIubmV4dCh0KTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIENvbnN0YW50IHVzZWQgdG8gaW5kaWNhdGUgdGhlIExSVSBnYXJiYWdlIGNvbGxlY3Rpb24gc2hvdWxkIGJlIGRpc2FibGVkLlxuICogU2V0IHRoaXMgdmFsdWUgYXMgdGhlIGBjYWNoZVNpemVCeXRlc2Agb24gdGhlIHNldHRpbmdzIHBhc3NlZCB0byB0aGVcbiAqIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICovIGNvbnN0IEVoID0gLTE7XG5cbi8qKlxuICogVGhlIENsb3VkIEZpcmVzdG9yZSBzZXJ2aWNlIGludGVyZmFjZS5cbiAqXG4gKiBEbyBub3QgY2FsbCB0aGlzIGNvbnN0cnVjdG9yIGRpcmVjdGx5LiBJbnN0ZWFkLCB1c2Uge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9LlxuICovIGNsYXNzIEFoIGV4dGVuZHMgYWgge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICBzdXBlcih0LCBlLCBuLCBzKSwgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBXaGV0aGVyIGl0J3MgYSB7QGxpbmsgRmlyZXN0b3JlfSBvciBGaXJlc3RvcmUgTGl0ZSBpbnN0YW5jZS5cbiAgICAgICAgICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwiZmlyZXN0b3JlXCIsIHRoaXMuX3F1ZXVlID0gbmV3IHBoLCB0aGlzLl9wZXJzaXN0ZW5jZUtleSA9IChudWxsID09IHMgPyB2b2lkIDAgOiBzLm5hbWUpIHx8IFwiW0RFRkFVTFRdXCI7XG4gICAgfVxuICAgIF90ZXJtaW5hdGUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9maXJlc3RvcmVDbGllbnQgfHwgXG4gICAgICAgIC8vIFRoZSBjbGllbnQgbXVzdCBiZSBpbml0aWFsaXplZCB0byBlbnN1cmUgdGhhdCBhbGwgc3Vic2VxdWVudCBBUElcbiAgICAgICAgLy8gdXNhZ2UgdGhyb3dzIGFuIGV4Y2VwdGlvbi5cbiAgICAgICAgYmgodGhpcyksIHRoaXMuX2ZpcmVzdG9yZUNsaWVudC50ZXJtaW5hdGUoKTtcbiAgICB9XG59XG5cbi8qKlxuICogSW5pdGlhbGl6ZXMgYSBuZXcgaW5zdGFuY2Ugb2Yge0BsaW5rIEZpcmVzdG9yZX0gd2l0aCB0aGUgcHJvdmlkZWQgc2V0dGluZ3MuXG4gKiBDYW4gb25seSBiZSBjYWxsZWQgYmVmb3JlIGFueSBvdGhlciBmdW5jdGlvbiwgaW5jbHVkaW5nXG4gKiB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0uIElmIHRoZSBjdXN0b20gc2V0dGluZ3MgYXJlIGVtcHR5LCB0aGlzIGZ1bmN0aW9uIGlzXG4gKiBlcXVpdmFsZW50IHRvIGNhbGxpbmcge0BsaW5rIChnZXRGaXJlc3RvcmU6MSl9LlxuICpcbiAqIEBwYXJhbSBhcHAgLSBUaGUge0BsaW5rIEBmaXJlYmFzZS9hcHAjRmlyZWJhc2VBcHB9IHdpdGggd2hpY2ggdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIHdpbGxcbiAqIGJlIGFzc29jaWF0ZWQuXG4gKiBAcGFyYW0gc2V0dGluZ3MgLSBBIHNldHRpbmdzIG9iamVjdCB0byBjb25maWd1cmUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlLlxuICogQHBhcmFtIGRhdGFiYXNlSWQgLSBUaGUgbmFtZSBvZiBkYXRhYmFzZS5cbiAqIEByZXR1cm5zIEEgbmV3bHkgaW5pdGlhbGl6ZWQge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKi8gZnVuY3Rpb24gUmgodCwgZSwgbikge1xuICAgIG4gfHwgKG4gPSBcIihkZWZhdWx0KVwiKTtcbiAgICBjb25zdCBzID0gX2dldFByb3ZpZGVyKHQsIFwiZmlyZXN0b3JlXCIpO1xuICAgIGlmIChzLmlzSW5pdGlhbGl6ZWQobikpIHtcbiAgICAgICAgY29uc3QgdCA9IHMuZ2V0SW1tZWRpYXRlKHtcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IG5cbiAgICAgICAgfSksIGkgPSBzLmdldE9wdGlvbnMobik7XG4gICAgICAgIGlmIChkZWVwRXF1YWwoaSwgZSkpIHJldHVybiB0O1xuICAgICAgICB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIGhhcyBhbHJlYWR5IGJlZW4gY2FsbGVkIHdpdGggZGlmZmVyZW50IG9wdGlvbnMuIFRvIGF2b2lkIHRoaXMgZXJyb3IsIGNhbGwgaW5pdGlhbGl6ZUZpcmVzdG9yZSgpIHdpdGggdGhlIHNhbWUgb3B0aW9ucyBhcyB3aGVuIGl0IHdhcyBvcmlnaW5hbGx5IGNhbGxlZCwgb3IgY2FsbCBnZXRGaXJlc3RvcmUoKSB0byByZXR1cm4gdGhlIGFscmVhZHkgaW5pdGlhbGl6ZWQgaW5zdGFuY2UuXCIpO1xuICAgIH1cbiAgICBpZiAodm9pZCAwICE9PSBlLmNhY2hlU2l6ZUJ5dGVzICYmIHZvaWQgMCAhPT0gZS5sb2NhbENhY2hlKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiY2FjaGUgYW5kIGNhY2hlU2l6ZUJ5dGVzIGNhbm5vdCBiZSBzcGVjaWZpZWQgYXQgdGhlIHNhbWUgdGltZSBhcyBjYWNoZVNpemVCeXRlcyB3aWxsYmUgZGVwcmVjYXRlZC4gSW5zdGVhZCwgc3BlY2lmeSB0aGUgY2FjaGUgc2l6ZSBpbiB0aGUgY2FjaGUgb2JqZWN0XCIpO1xuICAgIGlmICh2b2lkIDAgIT09IGUuY2FjaGVTaXplQnl0ZXMgJiYgLTEgIT09IGUuY2FjaGVTaXplQnl0ZXMgJiYgZS5jYWNoZVNpemVCeXRlcyA8IDEwNDg1NzYpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJjYWNoZVNpemVCeXRlcyBtdXN0IGJlIGF0IGxlYXN0IDEwNDg1NzZcIik7XG4gICAgcmV0dXJuIHMuaW5pdGlhbGl6ZSh7XG4gICAgICAgIG9wdGlvbnM6IGUsXG4gICAgICAgIGluc3RhbmNlSWRlbnRpZmllcjogblxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiB2aChlLCBuKSB7XG4gICAgY29uc3QgcyA9IFwib2JqZWN0XCIgPT0gdHlwZW9mIGUgPyBlIDogZ2V0QXBwKCksIGkgPSBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gZSA6IG4gfHwgXCIoZGVmYXVsdClcIiwgciA9IF9nZXRQcm92aWRlcihzLCBcImZpcmVzdG9yZVwiKS5nZXRJbW1lZGlhdGUoe1xuICAgICAgICBpZGVudGlmaWVyOiBpXG4gICAgfSk7XG4gICAgaWYgKCFyLl9pbml0aWFsaXplZCkge1xuICAgICAgICBjb25zdCB0ID0gZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdG5hbWVBbmRQb3J0KFwiZmlyZXN0b3JlXCIpO1xuICAgICAgICB0ICYmIGhoKHIsIC4uLnQpO1xuICAgIH1cbiAgICByZXR1cm4gcjtcbn1cblxuLyoqXG4gKiBAaW50ZXJuYWxcbiAqLyBmdW5jdGlvbiBQaCh0KSB7XG4gICAgcmV0dXJuIHQuX2ZpcmVzdG9yZUNsaWVudCB8fCBiaCh0KSwgdC5fZmlyZXN0b3JlQ2xpZW50LnZlcmlmeU5vdFRlcm1pbmF0ZWQoKSwgdC5fZmlyZXN0b3JlQ2xpZW50O1xufVxuXG5mdW5jdGlvbiBiaCh0KSB7XG4gICAgdmFyIGUsIG4sIHM7XG4gICAgY29uc3QgaSA9IHQuX2ZyZWV6ZVNldHRpbmdzKCksIHIgPSBmdW5jdGlvbih0LCBlLCBuLCBzKSB7XG4gICAgICAgIHJldHVybiBuZXcgT2UodCwgZSwgbiwgcy5ob3N0LCBzLnNzbCwgcy5leHBlcmltZW50YWxGb3JjZUxvbmdQb2xsaW5nLCBzLmV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZywgcy51c2VGZXRjaFN0cmVhbXMpO1xuICAgIH0odC5fZGF0YWJhc2VJZCwgKG51bGwgPT09IChlID0gdC5fYXBwKSB8fCB2b2lkIDAgPT09IGUgPyB2b2lkIDAgOiBlLm9wdGlvbnMuYXBwSWQpIHx8IFwiXCIsIHQuX3BlcnNpc3RlbmNlS2V5LCBpKTtcbiAgICB0Ll9maXJlc3RvcmVDbGllbnQgPSBuZXcgeGEodC5fYXV0aENyZWRlbnRpYWxzLCB0Ll9hcHBDaGVja0NyZWRlbnRpYWxzLCB0Ll9xdWV1ZSwgciksIFxuICAgIChudWxsID09PSAobiA9IGkuY2FjaGUpIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4uX29mZmxpbmVDb21wb25lbnRQcm92aWRlcikgJiYgKG51bGwgPT09IChzID0gaS5jYWNoZSkgfHwgdm9pZCAwID09PSBzID8gdm9pZCAwIDogcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIpICYmICh0Ll9maXJlc3RvcmVDbGllbnQuX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIgPSB7XG4gICAgICAgIF9vZmZsaW5lS2luZDogaS5jYWNoZS5raW5kLFxuICAgICAgICBfb2ZmbGluZTogaS5jYWNoZS5fb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyLFxuICAgICAgICBfb25saW5lOiBpLmNhY2hlLl9vbmxpbmVDb21wb25lbnRQcm92aWRlclxuICAgIH0pO1xufVxuXG4vKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBwZXJzaXN0ZW50IHN0b3JhZ2UsIGlmIHBvc3NpYmxlLlxuICpcbiAqIE11c3QgYmUgY2FsbGVkIGJlZm9yZSBhbnkgb3RoZXIgZnVuY3Rpb25zIChvdGhlciB0aGFuXG4gKiB7QGxpbmsgaW5pdGlhbGl6ZUZpcmVzdG9yZX0sIHtAbGluayAoZ2V0RmlyZXN0b3JlOjEpfSBvclxuICoge0BsaW5rIGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2V9LlxuICpcbiAqIElmIHRoaXMgZmFpbHMsIGBlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCB3aWxsIHJlamVjdCB0aGUgcHJvbWlzZSBpdFxuICogcmV0dXJucy4gTm90ZSB0aGF0IGV2ZW4gYWZ0ZXIgdGhpcyBmYWlsdXJlLCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogcmVtYWluIHVzYWJsZSwgaG93ZXZlciBvZmZsaW5lIHBlcnNpc3RlbmNlIHdpbGwgYmUgZGlzYWJsZWQuXG4gKlxuICogVGhlcmUgYXJlIHNldmVyYWwgcmVhc29ucyB3aHkgdGhpcyBjYW4gZmFpbCwgd2hpY2ggY2FuIGJlIGlkZW50aWZpZWQgYnlcbiAqIHRoZSBgY29kZWAgb24gdGhlIGVycm9yLlxuICpcbiAqICAgKiBmYWlsZWQtcHJlY29uZGl0aW9uOiBUaGUgYXBwIGlzIGFscmVhZHkgb3BlbiBpbiBhbm90aGVyIGJyb3dzZXIgdGFiLlxuICogICAqIHVuaW1wbGVtZW50ZWQ6IFRoZSBicm93c2VyIGlzIGluY29tcGF0aWJsZSB3aXRoIHRoZSBvZmZsaW5lXG4gKiAgICAgcGVyc2lzdGVuY2UgaW1wbGVtZW50YXRpb24uXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byBlbmFibGUgcGVyc2lzdGVuY2UgZm9yLlxuICogQHBhcmFtIHBlcnNpc3RlbmNlU2V0dGluZ3MgLSBPcHRpb25hbCBzZXR0aW5ncyBvYmplY3QgdG8gY29uZmlndXJlXG4gKiBwZXJzaXN0ZW5jZS5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVwcmVzZW50cyBzdWNjZXNzZnVsbHkgZW5hYmxpbmcgcGVyc2lzdGVudCBzdG9yYWdlLlxuICogQGRlcHJlY2F0ZWQgVGhpcyBmdW5jdGlvbiB3aWxsIGJlIHJlbW92ZWQgaW4gYSBmdXR1cmUgbWFqb3IgcmVsZWFzZS4gSW5zdGVhZCwgc2V0XG4gKiBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgIHRvIGFuIGluc3RhbmNlIG9mIGBJbmRleGVkRGJMb2NhbENhY2hlYCB0b1xuICogdHVybiBvbiBJbmRleGVkRGIgY2FjaGUuIENhbGxpbmcgdGhpcyBmdW5jdGlvbiB3aGVuIGBGaXJlc3RvcmVTZXR0aW5ncy5jYWNoZWBcbiAqIGlzIGFscmVhZHkgc3BlY2lmaWVkIHdpbGwgdGhyb3cgYW4gZXhjZXB0aW9uLlxuICovIGZ1bmN0aW9uIFZoKHQsIGUpIHtcbiAgICBGaCh0ID0gb2godCwgQWgpKTtcbiAgICBjb25zdCBuID0gUGgodCk7XG4gICAgaWYgKG4uX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIpIHRocm93IG5ldyBVKHEuRkFJTEVEX1BSRUNPTkRJVElPTiwgXCJTREsgY2FjaGUgaXMgYWxyZWFkeSBzcGVjaWZpZWQuXCIpO1xuICAgIE0oXCJlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSgpIHdpbGwgYmUgZGVwcmVjYXRlZCBpbiB0aGUgZnV0dXJlLCB5b3UgY2FuIHVzZSBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgIGluc3RlYWQuXCIpO1xuICAgIGNvbnN0IHMgPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBpID0gbmV3IFBhO1xuICAgIHJldHVybiBEaChuLCBpLCBuZXcgUmEoaSwgcy5jYWNoZVNpemVCeXRlcywgbnVsbCA9PSBlID8gdm9pZCAwIDogZS5mb3JjZU93bmVyc2hpcCkpO1xufVxuXG4vKipcbiAqIEF0dGVtcHRzIHRvIGVuYWJsZSBtdWx0aS10YWIgcGVyc2lzdGVudCBzdG9yYWdlLCBpZiBwb3NzaWJsZS4gSWYgZW5hYmxlZFxuICogYWNyb3NzIGFsbCB0YWJzLCBhbGwgb3BlcmF0aW9ucyBzaGFyZSBhY2Nlc3MgdG8gbG9jYWwgcGVyc2lzdGVuY2UsIGluY2x1ZGluZ1xuICogc2hhcmVkIGV4ZWN1dGlvbiBvZiBxdWVyaWVzIGFuZCBsYXRlbmN5LWNvbXBlbnNhdGVkIGxvY2FsIGRvY3VtZW50IHVwZGF0ZXNcbiAqIGFjcm9zcyBhbGwgY29ubmVjdGVkIGluc3RhbmNlcy5cbiAqXG4gKiBJZiB0aGlzIGZhaWxzLCBgZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCB3aWxsIHJlamVjdCB0aGUgcHJvbWlzZVxuICogaXQgcmV0dXJucy4gTm90ZSB0aGF0IGV2ZW4gYWZ0ZXIgdGhpcyBmYWlsdXJlLCB0aGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2Ugd2lsbFxuICogcmVtYWluIHVzYWJsZSwgaG93ZXZlciBvZmZsaW5lIHBlcnNpc3RlbmNlIHdpbGwgYmUgZGlzYWJsZWQuXG4gKlxuICogVGhlcmUgYXJlIHNldmVyYWwgcmVhc29ucyB3aHkgdGhpcyBjYW4gZmFpbCwgd2hpY2ggY2FuIGJlIGlkZW50aWZpZWQgYnlcbiAqIHRoZSBgY29kZWAgb24gdGhlIGVycm9yLlxuICpcbiAqICAgKiBmYWlsZWQtcHJlY29uZGl0aW9uOiBUaGUgYXBwIGlzIGFscmVhZHkgb3BlbiBpbiBhbm90aGVyIGJyb3dzZXIgdGFiIGFuZFxuICogICAgIG11bHRpLXRhYiBpcyBub3QgZW5hYmxlZC5cbiAqICAgKiB1bmltcGxlbWVudGVkOiBUaGUgYnJvd3NlciBpcyBpbmNvbXBhdGlibGUgd2l0aCB0aGUgb2ZmbGluZVxuICogICAgIHBlcnNpc3RlbmNlIGltcGxlbWVudGF0aW9uLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gZW5hYmxlIHBlcnNpc3RlbmNlIGZvci5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHRoYXQgcmVwcmVzZW50cyBzdWNjZXNzZnVsbHkgZW5hYmxpbmcgcGVyc2lzdGVudFxuICogc3RvcmFnZS5cbiAqIEBkZXByZWNhdGVkIFRoaXMgZnVuY3Rpb24gd2lsbCBiZSByZW1vdmVkIGluIGEgZnV0dXJlIG1ham9yIHJlbGVhc2UuIEluc3RlYWQsIHNldFxuICogYEZpcmVzdG9yZVNldHRpbmdzLmNhY2hlYCB0byBhbiBpbnN0YW5jZSBvZiBgSW5kZXhlZERiTG9jYWxDYWNoZWAgdG9cbiAqIHR1cm4gb24gaW5kZXhlZGRiIGNhY2hlLiBDYWxsaW5nIHRoaXMgZnVuY3Rpb24gd2hlbiBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgXG4gKiBpcyBhbHJlYWR5IHNwZWNpZmllZCB3aWxsIHRocm93IGFuIGV4Y2VwdGlvbi5cbiAqLyBmdW5jdGlvbiBTaCh0KSB7XG4gICAgRmgodCA9IG9oKHQsIEFoKSk7XG4gICAgY29uc3QgZSA9IFBoKHQpO1xuICAgIGlmIChlLl91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyKSB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiU0RLIGNhY2hlIGlzIGFscmVhZHkgc3BlY2lmaWVkLlwiKTtcbiAgICBNKFwiZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpIHdpbGwgYmUgZGVwcmVjYXRlZCBpbiB0aGUgZnV0dXJlLCB5b3UgY2FuIHVzZSBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgIGluc3RlYWQuXCIpO1xuICAgIGNvbnN0IG4gPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBzID0gbmV3IFBhO1xuICAgIHJldHVybiBEaChlLCBzLCBuZXcgdmEocywgbi5jYWNoZVNpemVCeXRlcykpO1xufVxuXG4vKipcbiAqIFJlZ2lzdGVycyBib3RoIHRoZSBgT2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyYCBhbmQgYE9ubGluZUNvbXBvbmVudFByb3ZpZGVyYC5cbiAqIElmIHRoZSBvcGVyYXRpb24gZmFpbHMgd2l0aCBhIHJlY292ZXJhYmxlIGVycm9yIChzZWVcbiAqIGBjYW5SZWNvdmVyRnJvbUluZGV4ZWREYkVycm9yKClgIGJlbG93KSwgdGhlIHJldHVybmVkIFByb21pc2UgaXMgcmVqZWN0ZWRcbiAqIGJ1dCB0aGUgY2xpZW50IHJlbWFpbnMgdXNhYmxlLlxuICovIGZ1bmN0aW9uIERoKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gbmV3IEs7XG4gICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlKChhc3luYyAoKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCBOYSh0LCBuKSwgYXdhaXQga2EodCwgZSksIHMucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdDtcbiAgICAgICAgICAgIGlmICghTWEoZSkpIHRocm93IGU7XG4gICAgICAgICAgICBNKFwiRXJyb3IgZW5hYmxpbmcgaW5kZXhlZGRiIGNhY2hlLiBGYWxsaW5nIGJhY2sgdG8gbWVtb3J5IGNhY2hlOiBcIiArIGUpLCBzLnJlamVjdChlKTtcbiAgICAgICAgfVxuICAgIH0pKS50aGVuKCgoKSA9PiBzLnByb21pc2UpKTtcbn1cblxuLyoqXG4gKiBDbGVhcnMgdGhlIHBlcnNpc3RlbnQgc3RvcmFnZS4gVGhpcyBpbmNsdWRlcyBwZW5kaW5nIHdyaXRlcyBhbmQgY2FjaGVkXG4gKiBkb2N1bWVudHMuXG4gKlxuICogTXVzdCBiZSBjYWxsZWQgd2hpbGUgdGhlIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGlzIG5vdCBzdGFydGVkIChhZnRlciB0aGUgYXBwIGlzXG4gKiB0ZXJtaW5hdGVkIG9yIHdoZW4gdGhlIGFwcCBpcyBmaXJzdCBpbml0aWFsaXplZCkuIE9uIHN0YXJ0dXAsIHRoaXMgZnVuY3Rpb25cbiAqIG11c3QgYmUgY2FsbGVkIGJlZm9yZSBvdGhlciBmdW5jdGlvbnMgKG90aGVyIHRoYW4ge0BsaW5rXG4gKiBpbml0aWFsaXplRmlyZXN0b3JlfSBvciB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0pKS4gSWYgdGhlIHtAbGluayBGaXJlc3RvcmV9XG4gKiBpbnN0YW5jZSBpcyBzdGlsbCBydW5uaW5nLCB0aGUgcHJvbWlzZSB3aWxsIGJlIHJlamVjdGVkIHdpdGggdGhlIGVycm9yIGNvZGVcbiAqIG9mIGBmYWlsZWQtcHJlY29uZGl0aW9uYC5cbiAqXG4gKiBOb3RlOiBgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSgpYCBpcyBwcmltYXJpbHkgaW50ZW5kZWQgdG8gaGVscCB3cml0ZVxuICogcmVsaWFibGUgdGVzdHMgdGhhdCB1c2UgQ2xvdWQgRmlyZXN0b3JlLiBJdCB1c2VzIGFuIGVmZmljaWVudCBtZWNoYW5pc20gZm9yXG4gKiBkcm9wcGluZyBleGlzdGluZyBkYXRhIGJ1dCBkb2VzIG5vdCBhdHRlbXB0IHRvIHNlY3VyZWx5IG92ZXJ3cml0ZSBvclxuICogb3RoZXJ3aXNlIG1ha2UgY2FjaGVkIGRhdGEgdW5yZWNvdmVyYWJsZS4gRm9yIGFwcGxpY2F0aW9ucyB0aGF0IGFyZSBzZW5zaXRpdmVcbiAqIHRvIHRoZSBkaXNjbG9zdXJlIG9mIGNhY2hlZCBkYXRhIGluIGJldHdlZW4gdXNlciBzZXNzaW9ucywgd2Ugc3Ryb25nbHlcbiAqIHJlY29tbWVuZCBub3QgZW5hYmxpbmcgcGVyc2lzdGVuY2UgYXQgYWxsLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gY2xlYXIgcGVyc2lzdGVuY2UgZm9yLlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBwZXJzaXN0ZW50IHN0b3JhZ2UgaXNcbiAqIGNsZWFyZWQuIE90aGVyd2lzZSwgdGhlIHByb21pc2UgaXMgcmVqZWN0ZWQgd2l0aCBhbiBlcnJvci5cbiAqLyBmdW5jdGlvbiBDaCh0KSB7XG4gICAgaWYgKHQuX2luaXRpYWxpemVkICYmICF0Ll90ZXJtaW5hdGVkKSB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiUGVyc2lzdGVuY2UgY2FuIG9ubHkgYmUgY2xlYXJlZCBiZWZvcmUgYSBGaXJlc3RvcmUgaW5zdGFuY2UgaXMgaW5pdGlhbGl6ZWQgb3IgYWZ0ZXIgaXQgaXMgdGVybWluYXRlZC5cIik7XG4gICAgY29uc3QgZSA9IG5ldyBLO1xuICAgIHJldHVybiB0Ll9xdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0RXZlbldoaWxlUmVzdHJpY3RlZCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgYXN5bmMgZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgICAgIGlmICghYnQuRCgpKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZSA9IHQgKyBcIm1haW5cIjtcbiAgICAgICAgICAgICAgICBhd2FpdCBidC5kZWxldGUoZSk7XG4gICAgICAgICAgICB9KFpvKHQuX2RhdGFiYXNlSWQsIHQuX3BlcnNpc3RlbmNlS2V5KSksIGUucmVzb2x2ZSgpO1xuICAgICAgICB9IGNhdGNoICh0KSB7XG4gICAgICAgICAgICBlLnJlamVjdCh0KTtcbiAgICAgICAgfVxuICAgIH0pKSwgZS5wcm9taXNlO1xufVxuXG4vKipcbiAqIFdhaXRzIHVudGlsIGFsbCBjdXJyZW50bHkgcGVuZGluZyB3cml0ZXMgZm9yIHRoZSBhY3RpdmUgdXNlciBoYXZlIGJlZW5cbiAqIGFja25vd2xlZGdlZCBieSB0aGUgYmFja2VuZC5cbiAqXG4gKiBUaGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcyBpbW1lZGlhdGVseSBpZiB0aGVyZSBhcmUgbm8gb3V0c3RhbmRpbmcgd3JpdGVzLlxuICogT3RoZXJ3aXNlLCB0aGUgcHJvbWlzZSB3YWl0cyBmb3IgYWxsIHByZXZpb3VzbHkgaXNzdWVkIHdyaXRlcyAoaW5jbHVkaW5nXG4gKiB0aG9zZSB3cml0dGVuIGluIGEgcHJldmlvdXMgYXBwIHNlc3Npb24pLCBidXQgaXQgZG9lcyBub3Qgd2FpdCBmb3Igd3JpdGVzXG4gKiB0aGF0IHdlcmUgYWRkZWQgYWZ0ZXIgdGhlIGZ1bmN0aW9uIGlzIGNhbGxlZC4gSWYgeW91IHdhbnQgdG8gd2FpdCBmb3JcbiAqIGFkZGl0aW9uYWwgd3JpdGVzLCBjYWxsIGB3YWl0Rm9yUGVuZGluZ1dyaXRlcygpYCBhZ2Fpbi5cbiAqXG4gKiBBbnkgb3V0c3RhbmRpbmcgYHdhaXRGb3JQZW5kaW5nV3JpdGVzKClgIHByb21pc2VzIGFyZSByZWplY3RlZCBkdXJpbmcgdXNlclxuICogY2hhbmdlcy5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB3aGljaCByZXNvbHZlcyB3aGVuIGFsbCBjdXJyZW50bHkgcGVuZGluZyB3cml0ZXMgaGF2ZSBiZWVuXG4gKiBhY2tub3dsZWRnZWQgYnkgdGhlIGJhY2tlbmQuXG4gKi8gZnVuY3Rpb24geGgodCkge1xuICAgIHJldHVybiBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBuZXcgSztcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBaYyhhd2FpdCBxYSh0KSwgZSkpKSwgZS5wcm9taXNlO1xuICAgIH0oUGgodCA9IG9oKHQsIEFoKSkpO1xufVxuXG4vKipcbiAqIFJlLWVuYWJsZXMgdXNlIG9mIHRoZSBuZXR3b3JrIGZvciB0aGlzIHtAbGluayBGaXJlc3RvcmV9IGluc3RhbmNlIGFmdGVyIGEgcHJpb3JcbiAqIGNhbGwgdG8ge0BsaW5rIGRpc2FibGVOZXR3b3JrfS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaGFzIGJlZW4gZW5hYmxlZC5cbiAqLyBmdW5jdGlvbiBOaCh0KSB7XG4gICAgcmV0dXJuIEdhKFBoKHQgPSBvaCh0LCBBaCkpKTtcbn1cblxuLyoqXG4gKiBEaXNhYmxlcyBuZXR3b3JrIHVzYWdlIGZvciB0aGlzIGluc3RhbmNlLiBJdCBjYW4gYmUgcmUtZW5hYmxlZCB2aWEge0BsaW5rXG4gKiBlbmFibGVOZXR3b3JrfS4gV2hpbGUgdGhlIG5ldHdvcmsgaXMgZGlzYWJsZWQsIGFueSBzbmFwc2hvdCBsaXN0ZW5lcnMsXG4gKiBgZ2V0RG9jKClgIG9yIGBnZXREb2NzKClgIGNhbGxzIHdpbGwgcmV0dXJuIHJlc3VsdHMgZnJvbSBjYWNoZSwgYW5kIGFueSB3cml0ZVxuICogb3BlcmF0aW9ucyB3aWxsIGJlIHF1ZXVlZCB1bnRpbCB0aGUgbmV0d29yayBpcyByZXN0b3JlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIG9uY2UgdGhlIG5ldHdvcmsgaGFzIGJlZW4gZGlzYWJsZWQuXG4gKi8gZnVuY3Rpb24ga2godCkge1xuICAgIHJldHVybiBRYShQaCh0ID0gb2godCwgQWgpKSk7XG59XG5cbi8qKlxuICogVGVybWluYXRlcyB0aGUgcHJvdmlkZWQge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UuXG4gKlxuICogQWZ0ZXIgY2FsbGluZyBgdGVybWluYXRlKClgIG9ubHkgdGhlIGBjbGVhckluZGV4ZWREYlBlcnNpc3RlbmNlKClgIGZ1bmN0aW9uXG4gKiBtYXkgYmUgdXNlZC4gQW55IG90aGVyIGZ1bmN0aW9uIHdpbGwgdGhyb3cgYSBgRmlyZXN0b3JlRXJyb3JgLlxuICpcbiAqIFRvIHJlc3RhcnQgYWZ0ZXIgdGVybWluYXRpb24sIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBGaXJlYmFzZUZpcmVzdG9yZSB3aXRoXG4gKiB7QGxpbmsgKGdldEZpcmVzdG9yZToxKX0uXG4gKlxuICogVGVybWluYXRpb24gZG9lcyBub3QgY2FuY2VsIGFueSBwZW5kaW5nIHdyaXRlcywgYW5kIGFueSBwcm9taXNlcyB0aGF0IGFyZVxuICogYXdhaXRpbmcgYSByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXIgd2lsbCBub3QgYmUgcmVzb2x2ZWQuIElmIHlvdSBoYXZlXG4gKiBwZXJzaXN0ZW5jZSBlbmFibGVkLCB0aGUgbmV4dCB0aW1lIHlvdSBzdGFydCB0aGlzIGluc3RhbmNlLCBpdCB3aWxsIHJlc3VtZVxuICogc2VuZGluZyB0aGVzZSB3cml0ZXMgdG8gdGhlIHNlcnZlci5cbiAqXG4gKiBOb3RlOiBVbmRlciBub3JtYWwgY2lyY3Vtc3RhbmNlcywgY2FsbGluZyBgdGVybWluYXRlKClgIGlzIG5vdCByZXF1aXJlZC4gVGhpc1xuICogZnVuY3Rpb24gaXMgdXNlZnVsIG9ubHkgd2hlbiB5b3Ugd2FudCB0byBmb3JjZSB0aGlzIGluc3RhbmNlIHRvIHJlbGVhc2UgYWxsXG4gKiBvZiBpdHMgcmVzb3VyY2VzIG9yIGluIGNvbWJpbmF0aW9uIHdpdGggYGNsZWFySW5kZXhlZERiUGVyc2lzdGVuY2UoKWAgdG9cbiAqIGVuc3VyZSB0aGF0IGFsbCBsb2NhbCBzdGF0ZSBpcyBkZXN0cm95ZWQgYmV0d2VlbiB0ZXN0IHJ1bnMuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgdGhhdCBpcyByZXNvbHZlZCB3aGVuIHRoZSBpbnN0YW5jZSBoYXMgYmVlbiBzdWNjZXNzZnVsbHlcbiAqIHRlcm1pbmF0ZWQuXG4gKi8gZnVuY3Rpb24gTWgodCkge1xuICAgIHJldHVybiBfcmVtb3ZlU2VydmljZUluc3RhbmNlKHQuYXBwLCBcImZpcmVzdG9yZVwiLCB0Ll9kYXRhYmFzZUlkLmRhdGFiYXNlKSwgdC5fZGVsZXRlKCk7XG59XG5cbi8qKlxuICogTG9hZHMgYSBGaXJlc3RvcmUgYnVuZGxlIGludG8gdGhlIGxvY2FsIGNhY2hlLlxuICpcbiAqIEBwYXJhbSBmaXJlc3RvcmUgLSBUaGUge0BsaW5rIEZpcmVzdG9yZX0gaW5zdGFuY2UgdG8gbG9hZCBidW5kbGVzIGZvci5cbiAqIEBwYXJhbSBidW5kbGVEYXRhIC0gQW4gb2JqZWN0IHJlcHJlc2VudGluZyB0aGUgYnVuZGxlIHRvIGJlIGxvYWRlZC4gVmFsaWRcbiAqIG9iamVjdHMgYXJlIGBBcnJheUJ1ZmZlcmAsIGBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5PmAgb3IgYHN0cmluZ2AuXG4gKlxuICogQHJldHVybnMgQSBgTG9hZEJ1bmRsZVRhc2tgIG9iamVjdCwgd2hpY2ggbm90aWZpZXMgY2FsbGVycyB3aXRoIHByb2dyZXNzXG4gKiB1cGRhdGVzLCBhbmQgY29tcGxldGlvbiBvciBlcnJvciBldmVudHMuIEl0IGNhbiBiZSB1c2VkIGFzIGFcbiAqIGBQcm9taXNlPExvYWRCdW5kbGVUYXNrUHJvZ3Jlc3M+YC5cbiAqLyBmdW5jdGlvbiBPaCh0LCBlKSB7XG4gICAgY29uc3QgbiA9IFBoKHQgPSBvaCh0LCBBaCkpLCBzID0gbmV3IFRoO1xuICAgIHJldHVybiBZYShuLCB0Ll9kYXRhYmFzZUlkLCBlLCBzKSwgcztcbn1cblxuLyoqXG4gKiBSZWFkcyBhIEZpcmVzdG9yZSB7QGxpbmsgUXVlcnl9IGZyb20gbG9jYWwgY2FjaGUsIGlkZW50aWZpZWQgYnkgdGhlIGdpdmVuXG4gKiBuYW1lLlxuICpcbiAqIFRoZSBuYW1lZCBxdWVyaWVzIGFyZSBwYWNrYWdlZCAgaW50byBidW5kbGVzIG9uIHRoZSBzZXJ2ZXIgc2lkZSAoYWxvbmdcbiAqIHdpdGggcmVzdWx0aW5nIGRvY3VtZW50cyksIGFuZCBsb2FkZWQgdG8gbG9jYWwgY2FjaGUgdXNpbmcgYGxvYWRCdW5kbGVgLiBPbmNlXG4gKiBpbiBsb2NhbCBjYWNoZSwgdXNlIHRoaXMgbWV0aG9kIHRvIGV4dHJhY3QgYSB7QGxpbmsgUXVlcnl9IGJ5IG5hbWUuXG4gKlxuICogQHBhcmFtIGZpcmVzdG9yZSAtIFRoZSB7QGxpbmsgRmlyZXN0b3JlfSBpbnN0YW5jZSB0byByZWFkIHRoZSBxdWVyeSBmcm9tLlxuICogQHBhcmFtIG5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgcXVlcnkuXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IGlzIHJlc29sdmVkIHdpdGggdGhlIFF1ZXJ5IG9yIGBudWxsYC5cbiAqLyBmdW5jdGlvbiAkaCh0LCBlKSB7XG4gICAgcmV0dXJuIFhhKFBoKHQgPSBvaCh0LCBBaCkpLCBlKS50aGVuKChlID0+IGUgPyBuZXcgZmgodCwgbnVsbCwgZS5xdWVyeSkgOiBudWxsKSk7XG59XG5cbmZ1bmN0aW9uIEZoKHQpIHtcbiAgICBpZiAodC5faW5pdGlhbGl6ZWQgfHwgdC5fdGVybWluYXRlZCkgdGhyb3cgbmV3IFUocS5GQUlMRURfUFJFQ09ORElUSU9OLCBcIkZpcmVzdG9yZSBoYXMgYWxyZWFkeSBiZWVuIHN0YXJ0ZWQgYW5kIHBlcnNpc3RlbmNlIGNhbiBubyBsb25nZXIgYmUgZW5hYmxlZC4gWW91IGNhbiBvbmx5IGVuYWJsZSBwZXJzaXN0ZW5jZSBiZWZvcmUgY2FsbGluZyBhbnkgb3RoZXIgbWV0aG9kcyBvbiBhIEZpcmVzdG9yZSBvYmplY3QuXCIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjIgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVwcmVzZW50cyBhbiBhZ2dyZWdhdGlvbiB0aGF0IGNhbiBiZSBwZXJmb3JtZWQgYnkgRmlyZXN0b3JlLlxuICovXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzXG5jbGFzcyBCaCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IEFnZ3JlZ2F0ZUZpZWxkPFQ+XG4gICAgICogQHBhcmFtIF9hZ2dyZWdhdGVUeXBlIFNwZWNpZmllcyB0aGUgdHlwZSBvZiBhZ2dyZWdhdGlvbiBvcGVyYXRpb24gdG8gcGVyZm9ybS5cbiAgICAgKiBAcGFyYW0gX2ludGVybmFsRmllbGRQYXRoIE9wdGlvbmFsbHkgc3BlY2lmaWVzIHRoZSBmaWVsZCB0aGF0IGlzIGFnZ3JlZ2F0ZWQuXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoXG4gICAgLy8gVE9ETyAoc3VtL2F2ZykgbWFrZSBhZ2dyZWdhdGVUeXBlIHB1YmxpYyB3aGVuIHRoZSBmZWF0dXJlIGlzIHN1cHBvcnRlZFxuICAgIHQgPSBcImNvdW50XCIsIGUpIHtcbiAgICAgICAgdGhpcy5fYWdncmVnYXRlVHlwZSA9IHQsIHRoaXMuX2ludGVybmFsRmllbGRQYXRoID0gZSwgXG4gICAgICAgIC8qKiBBIHR5cGUgc3RyaW5nIHRvIHVuaXF1ZWx5IGlkZW50aWZ5IGluc3RhbmNlcyBvZiB0aGlzIGNsYXNzLiAqL1xuICAgICAgICB0aGlzLnR5cGUgPSBcIkFnZ3JlZ2F0ZUZpZWxkXCI7XG4gICAgfVxufVxuXG4vKipcbiAqIFRoZSByZXN1bHRzIG9mIGV4ZWN1dGluZyBhbiBhZ2dyZWdhdGlvbiBxdWVyeS5cbiAqLyBjbGFzcyBMaCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuX3VzZXJEYXRhV3JpdGVyID0gZSwgdGhpcy5fZGF0YSA9IG4sIFxuICAgICAgICAvKiogQSB0eXBlIHN0cmluZyB0byB1bmlxdWVseSBpZGVudGlmeSBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcy4gKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJBZ2dyZWdhdGVRdWVyeVNuYXBzaG90XCIsIHRoaXMucXVlcnkgPSB0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXN1bHRzIG9mIHRoZSBhZ2dyZWdhdGlvbnMgcGVyZm9ybWVkIG92ZXIgdGhlIHVuZGVybHlpbmdcbiAgICAgKiBxdWVyeS5cbiAgICAgKlxuICAgICAqIFRoZSBrZXlzIG9mIHRoZSByZXR1cm5lZCBvYmplY3Qgd2lsbCBiZSB0aGUgc2FtZSBhcyB0aG9zZSBvZiB0aGVcbiAgICAgKiBgQWdncmVnYXRlU3BlY2Agb2JqZWN0IHNwZWNpZmllZCB0byB0aGUgYWdncmVnYXRpb24gbWV0aG9kLCBhbmQgdGhlIHZhbHVlc1xuICAgICAqIHdpbGwgYmUgdGhlIGNvcnJlc3BvbmRpbmcgYWdncmVnYXRpb24gcmVzdWx0LlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIHJlc3VsdHMgb2YgdGhlIGFnZ3JlZ2F0aW9ucyBwZXJmb3JtZWQgb3ZlciB0aGUgdW5kZXJseWluZ1xuICAgICAqIHF1ZXJ5LlxuICAgICAqLyAgICBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydE9iamVjdE1hcCh0aGlzLl9kYXRhKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEFuIGltbXV0YWJsZSBvYmplY3QgcmVwcmVzZW50aW5nIGFuIGFycmF5IG9mIGJ5dGVzLlxuICovIGNsYXNzIHFoIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5fYnl0ZVN0cmluZyA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIENyZWF0ZXMgYSBuZXcgYEJ5dGVzYCBvYmplY3QgZnJvbSB0aGUgZ2l2ZW4gQmFzZTY0IHN0cmluZywgY29udmVydGluZyBpdCB0b1xuICAgICAqIGJ5dGVzLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJhc2U2NCAtIFRoZSBCYXNlNjQgc3RyaW5nIHVzZWQgdG8gY3JlYXRlIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgc3RhdGljIGZyb21CYXNlNjRTdHJpbmcodCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBxaChWZS5mcm9tQmFzZTY0U3RyaW5nKHQpKTtcbiAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkZhaWxlZCB0byBjb25zdHJ1Y3QgZGF0YSBmcm9tIEJhc2U2NCBzdHJpbmc6IFwiICsgdCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBgQnl0ZXNgIG9iamVjdCBmcm9tIHRoZSBnaXZlbiBVaW50OEFycmF5LlxuICAgICAqXG4gICAgICogQHBhcmFtIGFycmF5IC0gVGhlIFVpbnQ4QXJyYXkgdXNlZCB0byBjcmVhdGUgdGhlIGBCeXRlc2Agb2JqZWN0LlxuICAgICAqLyAgICBzdGF0aWMgZnJvbVVpbnQ4QXJyYXkodCkge1xuICAgICAgICByZXR1cm4gbmV3IHFoKFZlLmZyb21VaW50OEFycmF5KHQpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgdW5kZXJseWluZyBieXRlcyBhcyBhIEJhc2U2NC1lbmNvZGVkIHN0cmluZy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIFRoZSBCYXNlNjQtZW5jb2RlZCBzdHJpbmcgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9CYXNlNjQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9ieXRlU3RyaW5nLnRvQmFzZTY0KCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdGhlIHVuZGVybHlpbmcgYnl0ZXMgaW4gYSBuZXcgYFVpbnQ4QXJyYXlgLlxuICAgICAqXG4gICAgICogQHJldHVybnMgVGhlIFVpbnQ4QXJyYXkgY3JlYXRlZCBmcm9tIHRoZSBgQnl0ZXNgIG9iamVjdC5cbiAgICAgKi8gICAgdG9VaW50OEFycmF5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYnl0ZVN0cmluZy50b1VpbnQ4QXJyYXkoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyBBIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgYEJ5dGVzYCBvYmplY3QuXG4gICAgICovICAgIHRvU3RyaW5nKCkge1xuICAgICAgICByZXR1cm4gXCJCeXRlcyhiYXNlNjQ6IFwiICsgdGhpcy50b0Jhc2U2NCgpICsgXCIpXCI7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBCeXRlc2Agb2JqZWN0IGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEJ5dGVzYCBvYmplY3QgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgQnl0ZXNgIG9iamVjdCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2J5dGVTdHJpbmcuaXNFcXVhbCh0Ll9ieXRlU3RyaW5nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgYEZpZWxkUGF0aGAgcmVmZXJzIHRvIGEgZmllbGQgaW4gYSBkb2N1bWVudC4gVGhlIHBhdGggbWF5IGNvbnNpc3Qgb2YgYVxuICogc2luZ2xlIGZpZWxkIG5hbWUgKHJlZmVycmluZyB0byBhIHRvcC1sZXZlbCBmaWVsZCBpbiB0aGUgZG9jdW1lbnQpLCBvciBhXG4gKiBsaXN0IG9mIGZpZWxkIG5hbWVzIChyZWZlcnJpbmcgdG8gYSBuZXN0ZWQgZmllbGQgaW4gdGhlIGRvY3VtZW50KS5cbiAqXG4gKiBDcmVhdGUgYSBgRmllbGRQYXRoYCBieSBwcm92aWRpbmcgZmllbGQgbmFtZXMuIElmIG1vcmUgdGhhbiBvbmUgZmllbGRcbiAqIG5hbWUgaXMgcHJvdmlkZWQsIHRoZSBwYXRoIHdpbGwgcG9pbnQgdG8gYSBuZXN0ZWQgZmllbGQgaW4gYSBkb2N1bWVudC5cbiAqLyBjbGFzcyBVaCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIGBGaWVsZFBhdGhgIGZyb20gdGhlIHByb3ZpZGVkIGZpZWxkIG5hbWVzLiBJZiBtb3JlIHRoYW4gb25lIGZpZWxkXG4gICAgICogbmFtZSBpcyBwcm92aWRlZCwgdGhlIHBhdGggd2lsbCBwb2ludCB0byBhIG5lc3RlZCBmaWVsZCBpbiBhIGRvY3VtZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIGZpZWxkTmFtZXMgLSBBIGxpc3Qgb2YgZmllbGQgbmFtZXMuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoLi4udCkge1xuICAgICAgICBmb3IgKGxldCBlID0gMDsgZSA8IHQubGVuZ3RoOyArK2UpIGlmICgwID09PSB0W2VdLmxlbmd0aCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgZmllbGQgbmFtZSBhdCBhcmd1bWVudCAkKGkgKyAxKS4gRmllbGQgbmFtZXMgbXVzdCBub3QgYmUgZW1wdHkuXCIpO1xuICAgICAgICB0aGlzLl9pbnRlcm5hbFBhdGggPSBuZXcgYXQodCk7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBGaWVsZFBhdGhgIGlzIGVxdWFsIHRvIHRoZSBwcm92aWRlZCBvbmUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gb3RoZXIgLSBUaGUgYEZpZWxkUGF0aGAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgRmllbGRQYXRoYCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2ludGVybmFsUGF0aC5pc0VxdWFsKHQuX2ludGVybmFsUGF0aCk7XG4gICAgfVxufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHNlbnRpbmVsIGBGaWVsZFBhdGhgIHRvIHJlZmVyIHRvIHRoZSBJRCBvZiBhIGRvY3VtZW50LlxuICogSXQgY2FuIGJlIHVzZWQgaW4gcXVlcmllcyB0byBzb3J0IG9yIGZpbHRlciBieSB0aGUgZG9jdW1lbnQgSUQuXG4gKi8gZnVuY3Rpb24gS2goKSB7XG4gICAgcmV0dXJuIG5ldyBVaChcIl9fbmFtZV9fXCIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBTZW50aW5lbCB2YWx1ZXMgdGhhdCBjYW4gYmUgdXNlZCB3aGVuIHdyaXRpbmcgZG9jdW1lbnQgZmllbGRzIHdpdGggYHNldCgpYFxuICogb3IgYHVwZGF0ZSgpYC5cbiAqLyBjbGFzcyBHaCB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIF9tZXRob2ROYW1lIC0gVGhlIHB1YmxpYyBBUEkgZW5kcG9pbnQgdGhhdCByZXR1cm5zIHRoaXMgY2xhc3MuXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQpIHtcbiAgICAgICAgdGhpcy5fbWV0aG9kTmFtZSA9IHQ7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAxNyBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBBbiBpbW11dGFibGUgb2JqZWN0IHJlcHJlc2VudGluZyBhIGdlb2dyYXBoaWMgbG9jYXRpb24gaW4gRmlyZXN0b3JlLiBUaGVcbiAqIGxvY2F0aW9uIGlzIHJlcHJlc2VudGVkIGFzIGxhdGl0dWRlL2xvbmdpdHVkZSBwYWlyLlxuICpcbiAqIExhdGl0dWRlIHZhbHVlcyBhcmUgaW4gdGhlIHJhbmdlIG9mIFstOTAsIDkwXS5cbiAqIExvbmdpdHVkZSB2YWx1ZXMgYXJlIGluIHRoZSByYW5nZSBvZiBbLTE4MCwgMTgwXS5cbiAqLyBjbGFzcyBRaCB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlcyBhIG5ldyBpbW11dGFibGUgYEdlb1BvaW50YCBvYmplY3Qgd2l0aCB0aGUgcHJvdmlkZWQgbGF0aXR1ZGUgYW5kXG4gICAgICogbG9uZ2l0dWRlIHZhbHVlcy5cbiAgICAgKiBAcGFyYW0gbGF0aXR1ZGUgLSBUaGUgbGF0aXR1ZGUgYXMgbnVtYmVyIGJldHdlZW4gLTkwIGFuZCA5MC5cbiAgICAgKiBAcGFyYW0gbG9uZ2l0dWRlIC0gVGhlIGxvbmdpdHVkZSBhcyBudW1iZXIgYmV0d2VlbiAtMTgwIGFuZCAxODAuXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBpZiAoIWlzRmluaXRlKHQpIHx8IHQgPCAtOTAgfHwgdCA+IDkwKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiTGF0aXR1ZGUgbXVzdCBiZSBhIG51bWJlciBiZXR3ZWVuIC05MCBhbmQgOTAsIGJ1dCB3YXM6IFwiICsgdCk7XG4gICAgICAgIGlmICghaXNGaW5pdGUoZSkgfHwgZSA8IC0xODAgfHwgZSA+IDE4MCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkxvbmdpdHVkZSBtdXN0IGJlIGEgbnVtYmVyIGJldHdlZW4gLTE4MCBhbmQgMTgwLCBidXQgd2FzOiBcIiArIGUpO1xuICAgICAgICB0aGlzLl9sYXQgPSB0LCB0aGlzLl9sb25nID0gZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGxhdGl0dWRlIG9mIHRoaXMgYEdlb1BvaW50YCBpbnN0YW5jZS5cbiAgICAgKi8gICAgZ2V0IGxhdGl0dWRlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbGF0O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBUaGUgbG9uZ2l0dWRlIG9mIHRoaXMgYEdlb1BvaW50YCBpbnN0YW5jZS5cbiAgICAgKi8gICAgZ2V0IGxvbmdpdHVkZSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xvbmc7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIGBHZW9Qb2ludGAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgR2VvUG9pbnRgIHRvIGNvbXBhcmUgYWdhaW5zdC5cbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoaXMgYEdlb1BvaW50YCBpcyBlcXVhbCB0byB0aGUgcHJvdmlkZWQgb25lLlxuICAgICAqLyAgICBpc0VxdWFsKHQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2xhdCA9PT0gdC5fbGF0ICYmIHRoaXMuX2xvbmcgPT09IHQuX2xvbmc7XG4gICAgfVxuICAgIC8qKiBSZXR1cm5zIGEgSlNPTi1zZXJpYWxpemFibGUgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBHZW9Qb2ludC4gKi8gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGF0aXR1ZGU6IHRoaXMuX2xhdCxcbiAgICAgICAgICAgIGxvbmdpdHVkZTogdGhpcy5fbG9uZ1xuICAgICAgICB9O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBBY3R1YWxseSBwcml2YXRlIHRvIEpTIGNvbnN1bWVycyBvZiBvdXIgQVBJLCBzbyB0aGlzIGZ1bmN0aW9uIGlzIHByZWZpeGVkXG4gICAgICogd2l0aCBhbiB1bmRlcnNjb3JlLlxuICAgICAqLyAgICBfY29tcGFyZVRvKHQpIHtcbiAgICAgICAgcmV0dXJuIGV0KHRoaXMuX2xhdCwgdC5fbGF0KSB8fCBldCh0aGlzLl9sb25nLCB0Ll9sb25nKTtcbiAgICB9XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDE3IEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGNvbnN0IGpoID0gL15fXy4qX18kLztcblxuLyoqIFRoZSByZXN1bHQgb2YgcGFyc2luZyBkb2N1bWVudCBkYXRhIChlLmcuIGZvciBhIHNldERhdGEgY2FsbCkuICovIGNsYXNzIHpoIHtcbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuZGF0YSA9IHQsIHRoaXMuZmllbGRNYXNrID0gZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBuO1xuICAgIH1cbiAgICB0b011dGF0aW9uKHQsIGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuZmllbGRNYXNrID8gbmV3IHpzKHQsIHRoaXMuZGF0YSwgdGhpcy5maWVsZE1hc2ssIGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKSA6IG5ldyBqcyh0LCB0aGlzLmRhdGEsIGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zKTtcbiAgICB9XG59XG5cbi8qKiBUaGUgcmVzdWx0IG9mIHBhcnNpbmcgXCJ1cGRhdGVcIiBkYXRhIChpLmUuIGZvciBhbiB1cGRhdGVEYXRhIGNhbGwpLiAqLyBjbGFzcyBXaCB7XG4gICAgY29uc3RydWN0b3IodCwgXG4gICAgLy8gVGhlIGZpZWxkTWFzayBkb2VzIG5vdCBpbmNsdWRlIGRvY3VtZW50IHRyYW5zZm9ybXMuXG4gICAgZSwgbikge1xuICAgICAgICB0aGlzLmRhdGEgPSB0LCB0aGlzLmZpZWxkTWFzayA9IGUsIHRoaXMuZmllbGRUcmFuc2Zvcm1zID0gbjtcbiAgICB9XG4gICAgdG9NdXRhdGlvbih0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgenModCwgdGhpcy5kYXRhLCB0aGlzLmZpZWxkTWFzaywgZSwgdGhpcy5maWVsZFRyYW5zZm9ybXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gSGgodCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSAwIC8qIFVzZXJEYXRhU291cmNlLlNldCAqLyA6XG4gLy8gZmFsbCB0aHJvdWdoXG4gICAgICAgICAgICAgIGNhc2UgMiAvKiBVc2VyRGF0YVNvdXJjZS5NZXJnZVNldCAqLyA6XG4gLy8gZmFsbCB0aHJvdWdoXG4gICAgICAgICAgICAgIGNhc2UgMSAvKiBVc2VyRGF0YVNvdXJjZS5VcGRhdGUgKi8gOlxuICAgICAgICByZXR1cm4gITA7XG5cbiAgICAgIGNhc2UgMyAvKiBVc2VyRGF0YVNvdXJjZS5Bcmd1bWVudCAqLyA6XG4gICAgICBjYXNlIDQgLyogVXNlckRhdGFTb3VyY2UuQXJyYXlBcmd1bWVudCAqLyA6XG4gICAgICAgIHJldHVybiAhMTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgJCgpO1xuICAgIH1cbn1cblxuLyoqIEEgXCJjb250ZXh0XCIgb2JqZWN0IHBhc3NlZCBhcm91bmQgd2hpbGUgcGFyc2luZyB1c2VyIGRhdGEuICovIGNsYXNzIEpoIHtcbiAgICAvKipcbiAgICAgKiBJbml0aWFsaXplcyBhIFBhcnNlQ29udGV4dCB3aXRoIHRoZSBnaXZlbiBzb3VyY2UgYW5kIHBhdGguXG4gICAgICpcbiAgICAgKiBAcGFyYW0gc2V0dGluZ3MgLSBUaGUgc2V0dGluZ3MgZm9yIHRoZSBwYXJzZXIuXG4gICAgICogQHBhcmFtIGRhdGFiYXNlSWQgLSBUaGUgZGF0YWJhc2UgSUQgb2YgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZS5cbiAgICAgKiBAcGFyYW0gc2VyaWFsaXplciAtIFRoZSBzZXJpYWxpemVyIHRvIHVzZSB0byBnZW5lcmF0ZSB0aGUgVmFsdWUgcHJvdG8uXG4gICAgICogQHBhcmFtIGlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgLSBXaGV0aGVyIHRvIGlnbm9yZSB1bmRlZmluZWQgcHJvcGVydGllc1xuICAgICAqIHJhdGhlciB0aGFuIHRocm93LlxuICAgICAqIEBwYXJhbSBmaWVsZFRyYW5zZm9ybXMgLSBBIG11dGFibGUgbGlzdCBvZiBmaWVsZCB0cmFuc2Zvcm1zIGVuY291bnRlcmVkXG4gICAgICogd2hpbGUgcGFyc2luZyB0aGUgZGF0YS5cbiAgICAgKiBAcGFyYW0gZmllbGRNYXNrIC0gQSBtdXRhYmxlIGxpc3Qgb2YgZmllbGQgcGF0aHMgZW5jb3VudGVyZWQgd2hpbGUgcGFyc2luZ1xuICAgICAqIHRoZSBkYXRhLlxuICAgICAqXG4gICAgICogVE9ETyhiLzM0ODcxMTMxKTogV2UgZG9uJ3Qgc3VwcG9ydCBhcnJheSBwYXRocyByaWdodCBub3csIHNvIHBhdGggY2FuIGJlXG4gICAgICogbnVsbCB0byBpbmRpY2F0ZSB0aGUgY29udGV4dCByZXByZXNlbnRzIGFueSBsb2NhdGlvbiB3aXRoaW4gYW4gYXJyYXkgKGluXG4gICAgICogd2hpY2ggY2FzZSBjZXJ0YWluIGZlYXR1cmVzIHdpbGwgbm90IHdvcmsgYW5kIGVycm9ycyB3aWxsIGJlIHNvbWV3aGF0XG4gICAgICogY29tcHJvbWlzZWQpLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHQsIHRoaXMuZGF0YWJhc2VJZCA9IGUsIHRoaXMuc2VyaWFsaXplciA9IG4sIHRoaXMuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyA9IHMsIFxuICAgICAgICAvLyBNaW5vciBoYWNrOiBJZiBmaWVsZFRyYW5zZm9ybXMgaXMgdW5kZWZpbmVkLCB3ZSBhc3N1bWUgdGhpcyBpcyBhblxuICAgICAgICAvLyBleHRlcm5hbCBjYWxsIGFuZCB3ZSBuZWVkIHRvIHZhbGlkYXRlIHRoZSBlbnRpcmUgcGF0aC5cbiAgICAgICAgdm9pZCAwID09PSBpICYmIHRoaXMub2EoKSwgdGhpcy5maWVsZFRyYW5zZm9ybXMgPSBpIHx8IFtdLCB0aGlzLmZpZWxkTWFzayA9IHIgfHwgW107XG4gICAgfVxuICAgIGdldCBwYXRoKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zZXR0aW5ncy5wYXRoO1xuICAgIH1cbiAgICBnZXQgdWEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnNldHRpbmdzLnVhO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyBhIG5ldyBjb250ZXh0IHdpdGggdGhlIHNwZWNpZmllZCBzZXR0aW5ncyBvdmVyd3JpdHRlbi4gKi8gICAgY2EodCkge1xuICAgICAgICByZXR1cm4gbmV3IEpoKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZXR0aW5ncyksIHQpLCB0aGlzLmRhdGFiYXNlSWQsIHRoaXMuc2VyaWFsaXplciwgdGhpcy5pZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzLCB0aGlzLmZpZWxkVHJhbnNmb3JtcywgdGhpcy5maWVsZE1hc2spO1xuICAgIH1cbiAgICBhYSh0KSB7XG4gICAgICAgIHZhciBlO1xuICAgICAgICBjb25zdCBuID0gbnVsbCA9PT0gKGUgPSB0aGlzLnBhdGgpIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuY2hpbGQodCksIHMgPSB0aGlzLmNhKHtcbiAgICAgICAgICAgIHBhdGg6IG4sXG4gICAgICAgICAgICBoYTogITFcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzLmxhKHQpLCBzO1xuICAgIH1cbiAgICBmYSh0KSB7XG4gICAgICAgIHZhciBlO1xuICAgICAgICBjb25zdCBuID0gbnVsbCA9PT0gKGUgPSB0aGlzLnBhdGgpIHx8IHZvaWQgMCA9PT0gZSA/IHZvaWQgMCA6IGUuY2hpbGQodCksIHMgPSB0aGlzLmNhKHtcbiAgICAgICAgICAgIHBhdGg6IG4sXG4gICAgICAgICAgICBoYTogITFcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBzLm9hKCksIHM7XG4gICAgfVxuICAgIGRhKHQpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogV2UgZG9uJ3Qgc3VwcG9ydCBhcnJheSBwYXRocyByaWdodCBub3c7IHNvIG1ha2UgcGF0aFxuICAgICAgICAvLyB1bmRlZmluZWQuXG4gICAgICAgIHJldHVybiB0aGlzLmNhKHtcbiAgICAgICAgICAgIHBhdGg6IHZvaWQgMCxcbiAgICAgICAgICAgIGhhOiAhMFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgX2EodCkge1xuICAgICAgICByZXR1cm4gbWwodCwgdGhpcy5zZXR0aW5ncy5tZXRob2ROYW1lLCB0aGlzLnNldHRpbmdzLndhIHx8ICExLCB0aGlzLnBhdGgsIHRoaXMuc2V0dGluZ3MubWEpO1xuICAgIH1cbiAgICAvKiogUmV0dXJucyAndHJ1ZScgaWYgJ2ZpZWxkUGF0aCcgd2FzIHRyYXZlcnNlZCB3aGVuIGNyZWF0aW5nIHRoaXMgY29udGV4dC4gKi8gICAgY29udGFpbnModCkge1xuICAgICAgICByZXR1cm4gdm9pZCAwICE9PSB0aGlzLmZpZWxkTWFzay5maW5kKChlID0+IHQuaXNQcmVmaXhPZihlKSkpIHx8IHZvaWQgMCAhPT0gdGhpcy5maWVsZFRyYW5zZm9ybXMuZmluZCgoZSA9PiB0LmlzUHJlZml4T2YoZS5maWVsZCkpKTtcbiAgICB9XG4gICAgb2EoKSB7XG4gICAgICAgIC8vIFRPRE8oYi8zNDg3MTEzMSk6IFJlbW92ZSBudWxsIGNoZWNrIG9uY2Ugd2UgaGF2ZSBwcm9wZXIgcGF0aHMgZm9yIGZpZWxkc1xuICAgICAgICAvLyB3aXRoaW4gYXJyYXlzLlxuICAgICAgICBpZiAodGhpcy5wYXRoKSBmb3IgKGxldCB0ID0gMDsgdCA8IHRoaXMucGF0aC5sZW5ndGg7IHQrKykgdGhpcy5sYSh0aGlzLnBhdGguZ2V0KHQpKTtcbiAgICB9XG4gICAgbGEodCkge1xuICAgICAgICBpZiAoMCA9PT0gdC5sZW5ndGgpIHRocm93IHRoaXMuX2EoXCJEb2N1bWVudCBmaWVsZHMgbXVzdCBub3QgYmUgZW1wdHlcIik7XG4gICAgICAgIGlmIChIaCh0aGlzLnVhKSAmJiBqaC50ZXN0KHQpKSB0aHJvdyB0aGlzLl9hKCdEb2N1bWVudCBmaWVsZHMgY2Fubm90IGJlZ2luIGFuZCBlbmQgd2l0aCBcIl9fXCInKTtcbiAgICB9XG59XG5cbi8qKlxuICogSGVscGVyIGZvciBwYXJzaW5nIHJhdyB1c2VyIGlucHV0IChwcm92aWRlZCB2aWEgdGhlIEFQSSkgaW50byBpbnRlcm5hbCBtb2RlbFxuICogY2xhc3Nlcy5cbiAqLyBjbGFzcyBZaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSwgbikge1xuICAgICAgICB0aGlzLmRhdGFiYXNlSWQgPSB0LCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMgPSBlLCB0aGlzLnNlcmlhbGl6ZXIgPSBuIHx8IEZ1KHQpO1xuICAgIH1cbiAgICAvKiogQ3JlYXRlcyBhIG5ldyB0b3AtbGV2ZWwgcGFyc2UgY29udGV4dC4gKi8gICAgZ2EodCwgZSwgbiwgcyA9ICExKSB7XG4gICAgICAgIHJldHVybiBuZXcgSmgoe1xuICAgICAgICAgICAgdWE6IHQsXG4gICAgICAgICAgICBtZXRob2ROYW1lOiBlLFxuICAgICAgICAgICAgbWE6IG4sXG4gICAgICAgICAgICBwYXRoOiBhdC5lbXB0eVBhdGgoKSxcbiAgICAgICAgICAgIGhhOiAhMSxcbiAgICAgICAgICAgIHdhOiBzXG4gICAgICAgIH0sIHRoaXMuZGF0YWJhc2VJZCwgdGhpcy5zZXJpYWxpemVyLCB0aGlzLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gWGgodCkge1xuICAgIGNvbnN0IGUgPSB0Ll9mcmVlemVTZXR0aW5ncygpLCBuID0gRnUodC5fZGF0YWJhc2VJZCk7XG4gICAgcmV0dXJuIG5ldyBZaCh0Ll9kYXRhYmFzZUlkLCAhIWUuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcywgbik7XG59XG5cbi8qKiBQYXJzZSBkb2N1bWVudCBkYXRhIGZyb20gYSBzZXQoKSBjYWxsLiAqLyBmdW5jdGlvbiBaaCh0LCBlLCBuLCBzLCBpLCByID0ge30pIHtcbiAgICBjb25zdCBvID0gdC5nYShyLm1lcmdlIHx8IHIubWVyZ2VGaWVsZHMgPyAyIC8qIFVzZXJEYXRhU291cmNlLk1lcmdlU2V0ICovIDogMCAvKiBVc2VyRGF0YVNvdXJjZS5TZXQgKi8gLCBlLCBuLCBpKTtcbiAgICBmbChcIkRhdGEgbXVzdCBiZSBhbiBvYmplY3QsIGJ1dCBpdCB3YXM6XCIsIG8sIHMpO1xuICAgIGNvbnN0IHUgPSBobChzLCBvKTtcbiAgICBsZXQgYywgYTtcbiAgICBpZiAoci5tZXJnZSkgYyA9IG5ldyB2ZShvLmZpZWxkTWFzayksIGEgPSBvLmZpZWxkVHJhbnNmb3JtczsgZWxzZSBpZiAoci5tZXJnZUZpZWxkcykge1xuICAgICAgICBjb25zdCB0ID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiByLm1lcmdlRmllbGRzKSB7XG4gICAgICAgICAgICBjb25zdCBpID0gZGwoZSwgcywgbik7XG4gICAgICAgICAgICBpZiAoIW8uY29udGFpbnMoaSkpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZpZWxkICcke2l9JyBpcyBzcGVjaWZpZWQgaW4geW91ciBmaWVsZCBtYXNrIGJ1dCBtaXNzaW5nIGZyb20geW91ciBpbnB1dCBkYXRhLmApO1xuICAgICAgICAgICAgZ2wodCwgaSkgfHwgdC5wdXNoKGkpO1xuICAgICAgICB9XG4gICAgICAgIGMgPSBuZXcgdmUodCksIGEgPSBvLmZpZWxkVHJhbnNmb3Jtcy5maWx0ZXIoKHQgPT4gYy5jb3ZlcnModC5maWVsZCkpKTtcbiAgICB9IGVsc2UgYyA9IG51bGwsIGEgPSBvLmZpZWxkVHJhbnNmb3JtcztcbiAgICByZXR1cm4gbmV3IHpoKG5ldyB1bih1KSwgYywgYSk7XG59XG5cbmNsYXNzIHRsIGV4dGVuZHMgR2gge1xuICAgIF90b0ZpZWxkVHJhbnNmb3JtKHQpIHtcbiAgICAgICAgaWYgKDIgLyogVXNlckRhdGFTb3VyY2UuTWVyZ2VTZXQgKi8gIT09IHQudWEpIHRocm93IDEgLyogVXNlckRhdGFTb3VyY2UuVXBkYXRlICovID09PSB0LnVhID8gdC5fYShgJHt0aGlzLl9tZXRob2ROYW1lfSgpIGNhbiBvbmx5IGFwcGVhciBhdCB0aGUgdG9wIGxldmVsIG9mIHlvdXIgdXBkYXRlIGRhdGFgKSA6IHQuX2EoYCR7dGhpcy5fbWV0aG9kTmFtZX0oKSBjYW5ub3QgYmUgdXNlZCB3aXRoIHNldCgpIHVubGVzcyB5b3UgcGFzcyB7bWVyZ2U6dHJ1ZX1gKTtcbiAgICAgICAgLy8gTm8gdHJhbnNmb3JtIHRvIGFkZCBmb3IgYSBkZWxldGUsIGJ1dCB3ZSBuZWVkIHRvIGFkZCBpdCB0byBvdXJcbiAgICAgICAgLy8gZmllbGRNYXNrIHNvIGl0IGdldHMgZGVsZXRlZC5cbiAgICAgICAgcmV0dXJuIHQuZmllbGRNYXNrLnB1c2godC5wYXRoKSwgbnVsbDtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0IGluc3RhbmNlb2YgdGw7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSBjaGlsZCBjb250ZXh0IGZvciBwYXJzaW5nIFNlcmlhbGl6YWJsZUZpZWxkVmFsdWVzLlxuICpcbiAqIFRoaXMgaXMgZGlmZmVyZW50IHRoYW4gY2FsbGluZyBgUGFyc2VDb250ZXh0LmNvbnRleHRXaXRoYCBiZWNhdXNlIGl0IGtlZXBzXG4gKiB0aGUgZmllbGRUcmFuc2Zvcm1zIGFuZCBmaWVsZE1hc2sgc2VwYXJhdGUuXG4gKlxuICogVGhlIGNyZWF0ZWQgY29udGV4dCBoYXMgaXRzIGBkYXRhU291cmNlYCBzZXQgdG8gYFVzZXJEYXRhU291cmNlLkFyZ3VtZW50YC5cbiAqIEFsdGhvdWdoIHRoZXNlIHZhbHVlcyBhcmUgdXNlZCB3aXRoIHdyaXRlcywgYW55IGVsZW1lbnRzIGluIHRoZXNlIEZpZWxkVmFsdWVzXG4gKiBhcmUgbm90IGNvbnNpZGVyZWQgd3JpdGVzIHNpbmNlIHRoZXkgY2Fubm90IGNvbnRhaW4gYW55IEZpZWxkVmFsdWUgc2VudGluZWxzLFxuICogZXRjLlxuICpcbiAqIEBwYXJhbSBmaWVsZFZhbHVlIC0gVGhlIHNlbnRpbmVsIEZpZWxkVmFsdWUgZm9yIHdoaWNoIHRvIGNyZWF0ZSBhIGNoaWxkXG4gKiAgICAgY29udGV4dC5cbiAqIEBwYXJhbSBjb250ZXh0IC0gVGhlIHBhcmVudCBjb250ZXh0LlxuICogQHBhcmFtIGFycmF5RWxlbWVudCAtIFdoZXRoZXIgb3Igbm90IHRoZSBGaWVsZFZhbHVlIGhhcyBhbiBhcnJheS5cbiAqLyBmdW5jdGlvbiBlbCh0LCBlLCBuKSB7XG4gICAgcmV0dXJuIG5ldyBKaCh7XG4gICAgICAgIHVhOiAzIC8qIFVzZXJEYXRhU291cmNlLkFyZ3VtZW50ICovICxcbiAgICAgICAgbWE6IGUuc2V0dGluZ3MubWEsXG4gICAgICAgIG1ldGhvZE5hbWU6IHQuX21ldGhvZE5hbWUsXG4gICAgICAgIGhhOiBuXG4gICAgfSwgZS5kYXRhYmFzZUlkLCBlLnNlcmlhbGl6ZXIsIGUuaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyk7XG59XG5cbmNsYXNzIG5sIGV4dGVuZHMgR2gge1xuICAgIF90b0ZpZWxkVHJhbnNmb3JtKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBNcyh0LnBhdGgsIG5ldyBicyk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICByZXR1cm4gdCBpbnN0YW5jZW9mIG5sO1xuICAgIH1cbn1cblxuY2xhc3Mgc2wgZXh0ZW5kcyBHaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0KSwgdGhpcy55YSA9IGU7XG4gICAgfVxuICAgIF90b0ZpZWxkVHJhbnNmb3JtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGVsKHRoaXMsIHQsIFxuICAgICAgICAvKmFycmF5PSovICEwKSwgbiA9IHRoaXMueWEubWFwKCh0ID0+IGFsKHQsIGUpKSksIHMgPSBuZXcgVnMobik7XG4gICAgICAgIHJldHVybiBuZXcgTXModC5wYXRoLCBzKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogSW1wbGVtZW50IGlzRXF1YWxzXG4gICAgICAgIHJldHVybiB0aGlzID09PSB0O1xuICAgIH1cbn1cblxuY2xhc3MgaWwgZXh0ZW5kcyBHaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0KSwgdGhpcy55YSA9IGU7XG4gICAgfVxuICAgIF90b0ZpZWxkVHJhbnNmb3JtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IGVsKHRoaXMsIHQsIFxuICAgICAgICAvKmFycmF5PSovICEwKSwgbiA9IHRoaXMueWEubWFwKCh0ID0+IGFsKHQsIGUpKSksIHMgPSBuZXcgRHMobik7XG4gICAgICAgIHJldHVybiBuZXcgTXModC5wYXRoLCBzKTtcbiAgICB9XG4gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIC8vIFRPRE8obXJzY2htaWR0KTogSW1wbGVtZW50IGlzRXF1YWxzXG4gICAgICAgIHJldHVybiB0aGlzID09PSB0O1xuICAgIH1cbn1cblxuY2xhc3MgcmwgZXh0ZW5kcyBHaCB7XG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcih0KSwgdGhpcy5wYSA9IGU7XG4gICAgfVxuICAgIF90b0ZpZWxkVHJhbnNmb3JtKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IG5ldyB4cyh0LnNlcmlhbGl6ZXIsIEVzKHQuc2VyaWFsaXplciwgdGhpcy5wYSkpO1xuICAgICAgICByZXR1cm4gbmV3IE1zKHQucGF0aCwgZSk7XG4gICAgfVxuICAgIGlzRXF1YWwodCkge1xuICAgICAgICAvLyBUT0RPKG1yc2NobWlkdCk6IEltcGxlbWVudCBpc0VxdWFsc1xuICAgICAgICByZXR1cm4gdGhpcyA9PT0gdDtcbiAgICB9XG59XG5cbi8qKiBQYXJzZSB1cGRhdGUgZGF0YSBmcm9tIGFuIHVwZGF0ZSgpIGNhbGwuICovIGZ1bmN0aW9uIG9sKHQsIGUsIG4sIHMpIHtcbiAgICBjb25zdCBpID0gdC5nYSgxIC8qIFVzZXJEYXRhU291cmNlLlVwZGF0ZSAqLyAsIGUsIG4pO1xuICAgIGZsKFwiRGF0YSBtdXN0IGJlIGFuIG9iamVjdCwgYnV0IGl0IHdhczpcIiwgaSwgcyk7XG4gICAgY29uc3QgciA9IFtdLCBvID0gdW4uZW1wdHkoKTtcbiAgICBnZShzLCAoKHQsIHMpID0+IHtcbiAgICAgICAgY29uc3QgdSA9IHdsKGUsIHQsIG4pO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgcyA9IGdldE1vZHVsYXJJbnN0YW5jZShzKTtcbiAgICAgICAgY29uc3QgYyA9IGkuZmEodSk7XG4gICAgICAgIGlmIChzIGluc3RhbmNlb2YgdGwpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgci5wdXNoKHUpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBhbChzLCBjKTtcbiAgICAgICAgICAgIG51bGwgIT0gdCAmJiAoci5wdXNoKHUpLCBvLnNldCh1LCB0KSk7XG4gICAgICAgIH1cbiAgICB9KSk7XG4gICAgY29uc3QgdSA9IG5ldyB2ZShyKTtcbiAgICByZXR1cm4gbmV3IFdoKG8sIHUsIGkuZmllbGRUcmFuc2Zvcm1zKTtcbn1cblxuLyoqIFBhcnNlIHVwZGF0ZSBkYXRhIGZyb20gYSBsaXN0IG9mIGZpZWxkL3ZhbHVlIGFyZ3VtZW50cy4gKi8gZnVuY3Rpb24gdWwodCwgZSwgbiwgcywgaSwgcikge1xuICAgIGNvbnN0IG8gPSB0LmdhKDEgLyogVXNlckRhdGFTb3VyY2UuVXBkYXRlICovICwgZSwgbiksIHUgPSBbIGRsKGUsIHMsIG4pIF0sIGMgPSBbIGkgXTtcbiAgICBpZiAoci5sZW5ndGggJSAyICE9IDApIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEZ1bmN0aW9uICR7ZX0oKSBuZWVkcyB0byBiZSBjYWxsZWQgd2l0aCBhbiBldmVuIG51bWJlciBvZiBhcmd1bWVudHMgdGhhdCBhbHRlcm5hdGUgYmV0d2VlbiBmaWVsZCBuYW1lcyBhbmQgdmFsdWVzLmApO1xuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgci5sZW5ndGg7IHQgKz0gMikgdS5wdXNoKGRsKGUsIHJbdF0pKSwgYy5wdXNoKHJbdCArIDFdKTtcbiAgICBjb25zdCBhID0gW10sIGggPSB1bi5lbXB0eSgpO1xuICAgIC8vIFdlIGl0ZXJhdGUgaW4gcmV2ZXJzZSBvcmRlciB0byBwaWNrIHRoZSBsYXN0IHZhbHVlIGZvciBhIGZpZWxkIGlmIHRoZVxuICAgIC8vIHVzZXIgc3BlY2lmaWVkIHRoZSBmaWVsZCBtdWx0aXBsZSB0aW1lcy5cbiAgICBmb3IgKGxldCB0ID0gdS5sZW5ndGggLSAxOyB0ID49IDA7IC0tdCkgaWYgKCFnbChhLCB1W3RdKSkge1xuICAgICAgICBjb25zdCBlID0gdVt0XTtcbiAgICAgICAgbGV0IG4gPSBjW3RdO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbiA9IGdldE1vZHVsYXJJbnN0YW5jZShuKTtcbiAgICAgICAgY29uc3QgcyA9IG8uZmEoZSk7XG4gICAgICAgIGlmIChuIGluc3RhbmNlb2YgdGwpIFxuICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIGZpZWxkIG1hc2ssIGJ1dCBkb24ndCBhZGQgYW55dGhpbmcgdG8gdXBkYXRlRGF0YS5cbiAgICAgICAgYS5wdXNoKGUpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBhbChuLCBzKTtcbiAgICAgICAgICAgIG51bGwgIT0gdCAmJiAoYS5wdXNoKGUpLCBoLnNldChlLCB0KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgbCA9IG5ldyB2ZShhKTtcbiAgICByZXR1cm4gbmV3IFdoKGgsIGwsIG8uZmllbGRUcmFuc2Zvcm1zKTtcbn1cblxuLyoqXG4gKiBQYXJzZSBhIFwicXVlcnkgdmFsdWVcIiAoZS5nLiB2YWx1ZSBpbiBhIHdoZXJlIGZpbHRlciBvciBhIHZhbHVlIGluIGEgY3Vyc29yXG4gKiBib3VuZCkuXG4gKlxuICogQHBhcmFtIGFsbG93QXJyYXlzIC0gV2hldGhlciB0aGUgcXVlcnkgdmFsdWUgaXMgYW4gYXJyYXkgdGhhdCBtYXkgZGlyZWN0bHlcbiAqIGNvbnRhaW4gYWRkaXRpb25hbCBhcnJheXMgKGUuZy4gdGhlIG9wZXJhbmQgb2YgYW4gYGluYCBxdWVyeSkuXG4gKi8gZnVuY3Rpb24gY2wodCwgZSwgbiwgcyA9ICExKSB7XG4gICAgcmV0dXJuIGFsKG4sIHQuZ2EocyA/IDQgLyogVXNlckRhdGFTb3VyY2UuQXJyYXlBcmd1bWVudCAqLyA6IDMgLyogVXNlckRhdGFTb3VyY2UuQXJndW1lbnQgKi8gLCBlKSk7XG59XG5cbi8qKlxuICogUGFyc2VzIHVzZXIgZGF0YSB0byBQcm90b2J1ZiBWYWx1ZXMuXG4gKlxuICogQHBhcmFtIGlucHV0IC0gRGF0YSB0byBiZSBwYXJzZWQuXG4gKiBAcGFyYW0gY29udGV4dCAtIEEgY29udGV4dCBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSBjdXJyZW50IHBhdGggYmVpbmcgcGFyc2VkLFxuICogdGhlIHNvdXJjZSBvZiB0aGUgZGF0YSBiZWluZyBwYXJzZWQsIGV0Yy5cbiAqIEByZXR1cm5zIFRoZSBwYXJzZWQgdmFsdWUsIG9yIG51bGwgaWYgdGhlIHZhbHVlIHdhcyBhIEZpZWxkVmFsdWUgc2VudGluZWxcbiAqIHRoYXQgc2hvdWxkIG5vdCBiZSBpbmNsdWRlZCBpbiB0aGUgcmVzdWx0aW5nIHBhcnNlZCBkYXRhLlxuICovIGZ1bmN0aW9uIGFsKHQsIGUpIHtcbiAgICBpZiAobGwoXG4gICAgLy8gVW53cmFwIHRoZSBBUEkgdHlwZSBmcm9tIHRoZSBDb21wYXQgU0RLLiBUaGlzIHdpbGwgcmV0dXJuIHRoZSBBUEkgdHlwZVxuICAgIC8vIGZyb20gZmlyZXN0b3JlLWV4cC5cbiAgICB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpKSkgcmV0dXJuIGZsKFwiVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6XCIsIGUsIHQpLCBobCh0LCBlKTtcbiAgICBpZiAodCBpbnN0YW5jZW9mIEdoKSBcbiAgICAvLyBGaWVsZFZhbHVlcyB1c3VhbGx5IHBhcnNlIGludG8gdHJhbnNmb3JtcyAoZXhjZXB0IGRlbGV0ZUZpZWxkKCkpXG4gICAgLy8gaW4gd2hpY2ggY2FzZSB3ZSBkbyBub3Qgd2FudCB0byBpbmNsdWRlIHRoaXMgZmllbGQgaW4gb3VyIHBhcnNlZCBkYXRhXG4gICAgLy8gKGFzIGRvaW5nIHNvIHdpbGwgb3ZlcndyaXRlIHRoZSBmaWVsZCBkaXJlY3RseSBwcmlvciB0byB0aGUgdHJhbnNmb3JtXG4gICAgLy8gdHJ5aW5nIHRvIHRyYW5zZm9ybSBpdCkuIFNvIHdlIGRvbid0IGFkZCB0aGlzIGxvY2F0aW9uIHRvXG4gICAgLy8gY29udGV4dC5maWVsZE1hc2sgYW5kIHdlIHJldHVybiBudWxsIGFzIG91ciBwYXJzaW5nIHJlc3VsdC5cbiAgICAvKipcbiAqIFwiUGFyc2VzXCIgdGhlIHByb3ZpZGVkIEZpZWxkVmFsdWVJbXBsLCBhZGRpbmcgYW55IG5lY2Vzc2FyeSB0cmFuc2Zvcm1zIHRvXG4gKiBjb250ZXh0LmZpZWxkVHJhbnNmb3Jtcy5cbiAqL1xuICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIC8vIFNlbnRpbmVscyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCB3cml0ZXMsIGFuZCBub3Qgd2l0aGluIGFycmF5cy5cbiAgICAgICAgaWYgKCFIaChlLnVhKSkgdGhyb3cgZS5fYShgJHt0Ll9tZXRob2ROYW1lfSgpIGNhbiBvbmx5IGJlIHVzZWQgd2l0aCB1cGRhdGUoKSBhbmQgc2V0KClgKTtcbiAgICAgICAgaWYgKCFlLnBhdGgpIHRocm93IGUuX2EoYCR7dC5fbWV0aG9kTmFtZX0oKSBpcyBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBpbnNpZGUgYXJyYXlzYCk7XG4gICAgICAgIGNvbnN0IG4gPSB0Ll90b0ZpZWxkVHJhbnNmb3JtKGUpO1xuICAgICAgICBuICYmIGUuZmllbGRUcmFuc2Zvcm1zLnB1c2gobik7XG4gICAgfVxuICAgIC8qKlxuICogSGVscGVyIHRvIHBhcnNlIGEgc2NhbGFyIHZhbHVlIChpLmUuIG5vdCBhbiBPYmplY3QsIEFycmF5LCBvciBGaWVsZFZhbHVlKVxuICpcbiAqIEByZXR1cm5zIFRoZSBwYXJzZWQgdmFsdWVcbiAqLyAodCwgZSksIG51bGw7XG4gICAgaWYgKHZvaWQgMCA9PT0gdCAmJiBlLmlnbm9yZVVuZGVmaW5lZFByb3BlcnRpZXMpIFxuICAgIC8vIElmIHRoZSBpbnB1dCBpcyB1bmRlZmluZWQgaXQgY2FuIG5ldmVyIHBhcnRpY2lwYXRlIGluIHRoZSBmaWVsZE1hc2ssIHNvXG4gICAgLy8gZG9uJ3QgaGFuZGxlIHRoaXMgYmVsb3cuIElmIGBpZ25vcmVVbmRlZmluZWRQcm9wZXJ0aWVzYCBpcyBmYWxzZSxcbiAgICAvLyBgcGFyc2VTY2FsYXJWYWx1ZWAgd2lsbCByZWplY3QgYW4gdW5kZWZpbmVkIHZhbHVlLlxuICAgIHJldHVybiBudWxsO1xuICAgIGlmIChcbiAgICAvLyBJZiBjb250ZXh0LnBhdGggaXMgbnVsbCB3ZSBhcmUgaW5zaWRlIGFuIGFycmF5IGFuZCB3ZSBkb24ndCBzdXBwb3J0XG4gICAgLy8gZmllbGQgbWFzayBwYXRocyBtb3JlIGdyYW51bGFyIHRoYW4gdGhlIHRvcC1sZXZlbCBhcnJheS5cbiAgICBlLnBhdGggJiYgZS5maWVsZE1hc2sucHVzaChlLnBhdGgpLCB0IGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICAgICAgLy8gVE9ETyhiLzM0ODcxMTMxKTogSW5jbHVkZSB0aGUgcGF0aCBjb250YWluaW5nIHRoZSBhcnJheSBpbiB0aGUgZXJyb3JcbiAgICAgICAgLy8gbWVzc2FnZS5cbiAgICAgICAgLy8gSW4gdGhlIGNhc2Ugb2YgSU4gcXVlcmllcywgdGhlIHBhcnNlZCBkYXRhIGlzIGFuIGFycmF5IChyZXByZXNlbnRpbmdcbiAgICAgICAgLy8gdGhlIHNldCBvZiB2YWx1ZXMgdG8gYmUgaW5jbHVkZWQgZm9yIHRoZSBJTiBxdWVyeSkgdGhhdCBtYXkgZGlyZWN0bHlcbiAgICAgICAgLy8gY29udGFpbiBhZGRpdGlvbmFsIGFycmF5cyAoZWFjaCByZXByZXNlbnRpbmcgYW4gaW5kaXZpZHVhbCBmaWVsZFxuICAgICAgICAvLyB2YWx1ZSksIHNvIHdlIGRpc2FibGUgdGhpcyB2YWxpZGF0aW9uLlxuICAgICAgICBpZiAoZS5zZXR0aW5ncy5oYSAmJiA0IC8qIFVzZXJEYXRhU291cmNlLkFycmF5QXJndW1lbnQgKi8gIT09IGUudWEpIHRocm93IGUuX2EoXCJOZXN0ZWQgYXJyYXlzIGFyZSBub3Qgc3VwcG9ydGVkXCIpO1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgY29uc3QgbiA9IFtdO1xuICAgICAgICAgICAgbGV0IHMgPSAwO1xuICAgICAgICAgICAgZm9yIChjb25zdCBpIG9mIHQpIHtcbiAgICAgICAgICAgICAgICBsZXQgdCA9IGFsKGksIGUuZGEocykpO1xuICAgICAgICAgICAgICAgIG51bGwgPT0gdCAmJiAoXG4gICAgICAgICAgICAgICAgLy8gSnVzdCBpbmNsdWRlIG51bGxzIGluIHRoZSBhcnJheSBmb3IgZmllbGRzIGJlaW5nIHJlcGxhY2VkIHdpdGggYVxuICAgICAgICAgICAgICAgIC8vIHNlbnRpbmVsLlxuICAgICAgICAgICAgICAgIHQgPSB7XG4gICAgICAgICAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgICAgICAgICB9KSwgbi5wdXNoKHQpLCBzKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFycmF5VmFsdWU6IHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBuXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSh0LCBlKTtcbiAgICB9XG4gICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgaWYgKG51bGwgPT09ICh0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpKSkgcmV0dXJuIHtcbiAgICAgICAgICAgIG51bGxWYWx1ZTogXCJOVUxMX1ZBTFVFXCJcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwibnVtYmVyXCIgPT0gdHlwZW9mIHQpIHJldHVybiBFcyhlLnNlcmlhbGl6ZXIsIHQpO1xuICAgICAgICBpZiAoXCJib29sZWFuXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBib29sZWFuVmFsdWU6IHRcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIHQpIHJldHVybiB7XG4gICAgICAgICAgICBzdHJpbmdWYWx1ZTogdFxuICAgICAgICB9O1xuICAgICAgICBpZiAodCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBpdC5mcm9tRGF0ZSh0KTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IERpKGUuc2VyaWFsaXplciwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBpdCkge1xuICAgICAgICAgICAgLy8gRmlyZXN0b3JlIGJhY2tlbmQgdHJ1bmNhdGVzIHByZWNpc2lvbiBkb3duIHRvIG1pY3Jvc2Vjb25kcy4gVG8gZW5zdXJlXG4gICAgICAgICAgICAvLyBvZmZsaW5lIG1vZGUgd29ya3MgdGhlIHNhbWUgd2l0aCByZWdhcmRzIHRvIHRydW5jYXRpb24sIHBlcmZvcm0gdGhlXG4gICAgICAgICAgICAvLyB0cnVuY2F0aW9uIGltbWVkaWF0ZWx5IHdpdGhvdXQgd2FpdGluZyBmb3IgdGhlIGJhY2tlbmQgdG8gZG8gdGhhdC5cbiAgICAgICAgICAgIGNvbnN0IG4gPSBuZXcgaXQodC5zZWNvbmRzLCAxZTMgKiBNYXRoLmZsb29yKHQubmFub3NlY29uZHMgLyAxZTMpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdGltZXN0YW1wVmFsdWU6IERpKGUuc2VyaWFsaXplciwgbilcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiBRaCkgcmV0dXJuIHtcbiAgICAgICAgICAgIGdlb1BvaW50VmFsdWU6IHtcbiAgICAgICAgICAgICAgICBsYXRpdHVkZTogdC5sYXRpdHVkZSxcbiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IHQubG9uZ2l0dWRlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgcWgpIHJldHVybiB7XG4gICAgICAgICAgICBieXRlc1ZhbHVlOiBDaShlLnNlcmlhbGl6ZXIsIHQuX2J5dGVTdHJpbmcpXG4gICAgICAgIH07XG4gICAgICAgIGlmICh0IGluc3RhbmNlb2YgbGgpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSBlLmRhdGFiYXNlSWQsIHMgPSB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZDtcbiAgICAgICAgICAgIGlmICghcy5pc0VxdWFsKG4pKSB0aHJvdyBlLl9hKGBEb2N1bWVudCByZWZlcmVuY2UgaXMgZm9yIGRhdGFiYXNlICR7cy5wcm9qZWN0SWR9LyR7cy5kYXRhYmFzZX0gYnV0IHNob3VsZCBiZSBmb3IgZGF0YWJhc2UgJHtuLnByb2plY3RJZH0vJHtuLmRhdGFiYXNlfWApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICByZWZlcmVuY2VWYWx1ZToga2kodC5maXJlc3RvcmUuX2RhdGFiYXNlSWQgfHwgZS5kYXRhYmFzZUlkLCB0Ll9rZXkucGF0aClcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZS5fYShgVW5zdXBwb3J0ZWQgZmllbGQgdmFsdWU6ICR7cmgodCl9YCk7XG4gICAgfVxuICAgIC8qKlxuICogQ2hlY2tzIHdoZXRoZXIgYW4gb2JqZWN0IGxvb2tzIGxpa2UgYSBKU09OIG9iamVjdCB0aGF0IHNob3VsZCBiZSBjb252ZXJ0ZWRcbiAqIGludG8gYSBzdHJ1Y3QuIE5vcm1hbCBjbGFzcy9wcm90b3R5cGUgaW5zdGFuY2VzIGFyZSBjb25zaWRlcmVkIHRvIGxvb2sgbGlrZVxuICogSlNPTiBvYmplY3RzIHNpbmNlIHRoZXkgc2hvdWxkIGJlIGNvbnZlcnRlZCB0byBhIHN0cnVjdCB2YWx1ZS4gQXJyYXlzLCBEYXRlcyxcbiAqIEdlb1BvaW50cywgZXRjLiBhcmUgbm90IGNvbnNpZGVyZWQgdG8gbG9vayBsaWtlIEpTT04gb2JqZWN0cyBzaW5jZSB0aGV5IG1hcFxuICogdG8gc3BlY2lmaWMgRmllbGRWYWx1ZSB0eXBlcyBvdGhlciB0aGFuIE9iamVjdFZhbHVlLlxuICovICh0LCBlKTtcbn1cblxuZnVuY3Rpb24gaGwodCwgZSkge1xuICAgIGNvbnN0IG4gPSB7fTtcbiAgICByZXR1cm4geWUodCkgPyBcbiAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgYW4gZW1wdHkgb2JqZWN0LCB3ZSBleHBsaWNpdGx5IGFkZCBpdCB0byB0aGUgdXBkYXRlXG4gICAgLy8gbWFzayB0byBlbnN1cmUgdGhhdCB0aGUgc2VydmVyIGNyZWF0ZXMgYSBtYXAgZW50cnkuXG4gICAgZS5wYXRoICYmIGUucGF0aC5sZW5ndGggPiAwICYmIGUuZmllbGRNYXNrLnB1c2goZS5wYXRoKSA6IGdlKHQsICgodCwgcykgPT4ge1xuICAgICAgICBjb25zdCBpID0gYWwocywgZS5hYSh0KSk7XG4gICAgICAgIG51bGwgIT0gaSAmJiAoblt0XSA9IGkpO1xuICAgIH0pKSwge1xuICAgICAgICBtYXBWYWx1ZToge1xuICAgICAgICAgICAgZmllbGRzOiBuXG4gICAgICAgIH1cbiAgICB9O1xufVxuXG5mdW5jdGlvbiBsbCh0KSB7XG4gICAgcmV0dXJuICEoXCJvYmplY3RcIiAhPSB0eXBlb2YgdCB8fCBudWxsID09PSB0IHx8IHQgaW5zdGFuY2VvZiBBcnJheSB8fCB0IGluc3RhbmNlb2YgRGF0ZSB8fCB0IGluc3RhbmNlb2YgaXQgfHwgdCBpbnN0YW5jZW9mIFFoIHx8IHQgaW5zdGFuY2VvZiBxaCB8fCB0IGluc3RhbmNlb2YgbGggfHwgdCBpbnN0YW5jZW9mIEdoKTtcbn1cblxuZnVuY3Rpb24gZmwodCwgZSwgbikge1xuICAgIGlmICghbGwobikgfHwgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgcmV0dXJuIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQgJiYgbnVsbCAhPT0gdCAmJiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKHQpID09PSBPYmplY3QucHJvdG90eXBlIHx8IG51bGwgPT09IE9iamVjdC5nZXRQcm90b3R5cGVPZih0KSk7XG4gICAgfShuKSkge1xuICAgICAgICBjb25zdCBzID0gcmgobik7XG4gICAgICAgIHRocm93IFwiYW4gb2JqZWN0XCIgPT09IHMgPyBlLl9hKHQgKyBcIiBhIGN1c3RvbSBvYmplY3RcIikgOiBlLl9hKHQgKyBcIiBcIiArIHMpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBmcm9tRG90U2VwYXJhdGVkU3RyaW5nKCkgYnV0IHdyYXBzIGFueSBlcnJvciB0aHJvd24uXG4gKi8gZnVuY3Rpb24gZGwodCwgZSwgbikge1xuICAgIGlmICgoXG4gICAgLy8gSWYgcmVxdWlyZWQsIHJlcGxhY2UgdGhlIEZpZWxkUGF0aCBDb21wYXQgY2xhc3Mgd2l0aCB3aXRoIHRoZSBmaXJlc3RvcmUtZXhwXG4gICAgLy8gRmllbGRQYXRoLlxuICAgIGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIGluc3RhbmNlb2YgVWgpIHJldHVybiBlLl9pbnRlcm5hbFBhdGg7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGUpIHJldHVybiB3bCh0LCBlKTtcbiAgICB0aHJvdyBtbChcIkZpZWxkIHBhdGggYXJndW1lbnRzIG11c3QgYmUgb2YgdHlwZSBzdHJpbmcgb3IgXCIsIHQsIFxuICAgIC8qIGhhc0NvbnZlcnRlcj0gKi8gITEsIFxuICAgIC8qIHBhdGg9ICovIHZvaWQgMCwgbik7XG59XG5cbi8qKlxuICogTWF0Y2hlcyBhbnkgY2hhcmFjdGVycyBpbiBhIGZpZWxkIHBhdGggc3RyaW5nIHRoYXQgYXJlIHJlc2VydmVkLlxuICovIGNvbnN0IF9sID0gbmV3IFJlZ0V4cChcIlt+XFxcXCovXFxcXFtcXFxcXV1cIik7XG5cbi8qKlxuICogV3JhcHMgZnJvbURvdFNlcGFyYXRlZFN0cmluZyB3aXRoIGFuIGVycm9yIG1lc3NhZ2UgYWJvdXQgdGhlIG1ldGhvZCB0aGF0XG4gKiB3YXMgdGhyb3duLlxuICogQHBhcmFtIG1ldGhvZE5hbWUgLSBUaGUgcHVibGljbHkgdmlzaWJsZSBtZXRob2QgbmFtZVxuICogQHBhcmFtIHBhdGggLSBUaGUgZG90LXNlcGFyYXRlZCBzdHJpbmcgZm9ybSBvZiBhIGZpZWxkIHBhdGggd2hpY2ggd2lsbCBiZVxuICogc3BsaXQgb24gZG90cy5cbiAqIEBwYXJhbSB0YXJnZXREb2MgLSBUaGUgZG9jdW1lbnQgYWdhaW5zdCB3aGljaCB0aGUgZmllbGQgcGF0aCB3aWxsIGJlXG4gKiBldmFsdWF0ZWQuXG4gKi8gZnVuY3Rpb24gd2wodCwgZSwgbikge1xuICAgIGlmIChlLnNlYXJjaChfbCkgPj0gMCkgdGhyb3cgbWwoYEludmFsaWQgZmllbGQgcGF0aCAoJHtlfSkuIFBhdGhzIG11c3Qgbm90IGNvbnRhaW4gJ34nLCAnKicsICcvJywgJ1snLCBvciAnXSdgLCB0LCBcbiAgICAvKiBoYXNDb252ZXJ0ZXI9ICovICExLCBcbiAgICAvKiBwYXRoPSAqLyB2b2lkIDAsIG4pO1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBuZXcgVWgoLi4uZS5zcGxpdChcIi5cIikpLl9pbnRlcm5hbFBhdGg7XG4gICAgfSBjYXRjaCAocykge1xuICAgICAgICB0aHJvdyBtbChgSW52YWxpZCBmaWVsZCBwYXRoICgke2V9KS4gUGF0aHMgbXVzdCBub3QgYmUgZW1wdHksIGJlZ2luIHdpdGggJy4nLCBlbmQgd2l0aCAnLicsIG9yIGNvbnRhaW4gJy4uJ2AsIHQsIFxuICAgICAgICAvKiBoYXNDb252ZXJ0ZXI9ICovICExLCBcbiAgICAgICAgLyogcGF0aD0gKi8gdm9pZCAwLCBuKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIG1sKHQsIGUsIG4sIHMsIGkpIHtcbiAgICBjb25zdCByID0gcyAmJiAhcy5pc0VtcHR5KCksIG8gPSB2b2lkIDAgIT09IGk7XG4gICAgbGV0IHUgPSBgRnVuY3Rpb24gJHtlfSgpIGNhbGxlZCB3aXRoIGludmFsaWQgZGF0YWA7XG4gICAgbiAmJiAodSArPSBcIiAodmlhIGB0b0ZpcmVzdG9yZSgpYClcIiksIHUgKz0gXCIuIFwiO1xuICAgIGxldCBjID0gXCJcIjtcbiAgICByZXR1cm4gKHIgfHwgbykgJiYgKGMgKz0gXCIgKGZvdW5kXCIsIHIgJiYgKGMgKz0gYCBpbiBmaWVsZCAke3N9YCksIG8gJiYgKGMgKz0gYCBpbiBkb2N1bWVudCAke2l9YCksIFxuICAgIGMgKz0gXCIpXCIpLCBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIHUgKyB0ICsgYyk7XG59XG5cbi8qKiBDaGVja3MgYGhheXN0YWNrYCBpZiBGaWVsZFBhdGggYG5lZWRsZWAgaXMgcHJlc2VudC4gUnVucyBpbiBPKG4pLiAqLyBmdW5jdGlvbiBnbCh0LCBlKSB7XG4gICAgcmV0dXJuIHQuc29tZSgodCA9PiB0LmlzRXF1YWwoZSkpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyIEZpcmVzdG9yZVxuICogZGF0YWJhc2UuIFRoZSBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvXG4gKiBnZXQgYSBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBGb3IgYSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwb2ludHMgdG8gYSBub24tZXhpc3RpbmcgZG9jdW1lbnQsIGFueSBkYXRhXG4gKiBhY2Nlc3Mgd2lsbCByZXR1cm4gJ3VuZGVmaW5lZCcuIFlvdSBjYW4gdXNlIHRoZSBgZXhpc3RzKClgIG1ldGhvZCB0b1xuICogZXhwbGljaXRseSB2ZXJpZnkgYSBkb2N1bWVudCdzIGV4aXN0ZW5jZS5cbiAqLyBjbGFzcyB5bCB7XG4gICAgLy8gTm90ZTogVGhpcyBjbGFzcyBpcyBzdHJpcHBlZCBkb3duIHZlcnNpb24gb2YgdGhlIERvY3VtZW50U25hcHNob3QgaW5cbiAgICAvLyB0aGUgbGVnYWN5IFNESy4gVGhlIGNoYW5nZXMgYXJlOlxuICAgIC8vIC0gTm8gc3VwcG9ydCBmb3IgU25hcHNob3RNZXRhZGF0YS5cbiAgICAvLyAtIE5vIHN1cHBvcnQgZm9yIFNuYXBzaG90T3B0aW9ucy5cbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciBwcm90ZWN0ZWQgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX3VzZXJEYXRhV3JpdGVyID0gZSwgdGhpcy5fa2V5ID0gbiwgdGhpcy5fZG9jdW1lbnQgPSBzLCBcbiAgICAgICAgdGhpcy5fY29udmVydGVyID0gaTtcbiAgICB9XG4gICAgLyoqIFByb3BlcnR5IG9mIHRoZSBgRG9jdW1lbnRTbmFwc2hvdGAgdGhhdCBwcm92aWRlcyB0aGUgZG9jdW1lbnQncyBJRC4gKi8gICAgZ2V0IGlkKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fa2V5LnBhdGgubGFzdFNlZ21lbnQoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogVGhlIGBEb2N1bWVudFJlZmVyZW5jZWAgZm9yIHRoZSBkb2N1bWVudCBpbmNsdWRlZCBpbiB0aGUgYERvY3VtZW50U25hcHNob3RgLlxuICAgICAqLyAgICBnZXQgcmVmKCkge1xuICAgICAgICByZXR1cm4gbmV3IGxoKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fY29udmVydGVyLCB0aGlzLl9rZXkpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBTaWduYWxzIHdoZXRoZXIgb3Igbm90IHRoZSBkb2N1bWVudCBhdCB0aGUgc25hcHNob3QncyBsb2NhdGlvbiBleGlzdHMuXG4gICAgICpcbiAgICAgKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBkb2N1bWVudCBleGlzdHMuXG4gICAgICovICAgIGV4aXN0cygpIHtcbiAgICAgICAgcmV0dXJuIG51bGwgIT09IHRoaXMuX2RvY3VtZW50O1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXRyaWV2ZXMgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgYXMgYW4gYE9iamVjdGAuIFJldHVybnMgYHVuZGVmaW5lZGAgaWZcbiAgICAgKiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQgb3IgYHVuZGVmaW5lZGBcbiAgICAgKiBpZiB0aGUgZG9jdW1lbnQgZG9lc24ndCBleGlzdC5cbiAgICAgKi8gICAgZGF0YSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY29udmVydGVyKSB7XG4gICAgICAgICAgICAgICAgLy8gV2Ugb25seSB3YW50IHRvIHVzZSB0aGUgY29udmVydGVyIGFuZCBjcmVhdGUgYSBuZXcgRG9jdW1lbnRTbmFwc2hvdFxuICAgICAgICAgICAgICAgIC8vIGlmIGEgY29udmVydGVyIGhhcyBiZWVuIHByb3ZpZGVkLlxuICAgICAgICAgICAgICAgIGNvbnN0IHQgPSBuZXcgcGwodGhpcy5fZmlyZXN0b3JlLCB0aGlzLl91c2VyRGF0YVdyaXRlciwgdGhpcy5fa2V5LCB0aGlzLl9kb2N1bWVudCwgXG4gICAgICAgICAgICAgICAgLyogY29udmVydGVyPSAqLyBudWxsKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fY29udmVydGVyLmZyb21GaXJlc3RvcmUodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKHRoaXMuX2RvY3VtZW50LmRhdGEudmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgZmllbGQgc3BlY2lmaWVkIGJ5IGBmaWVsZFBhdGhgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IG9yIGZpZWxkIGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZmllbGRQYXRoIC0gVGhlIHBhdGggKGZvciBleGFtcGxlICdmb28nIG9yICdmb28uYmFyJykgdG8gYSBzcGVjaWZpY1xuICAgICAqIGZpZWxkLlxuICAgICAqIEByZXR1cm5zIFRoZSBkYXRhIGF0IHRoZSBzcGVjaWZpZWQgZmllbGQgbG9jYXRpb24gb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2hcbiAgICAgKiBmaWVsZCBleGlzdHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIC8vIFdlIGFyZSB1c2luZyBgYW55YCBoZXJlIHRvIGF2b2lkIGFuIGV4cGxpY2l0IGNhc3QgYnkgb3VyIHVzZXJzLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgZ2V0KHQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2RvY3VtZW50KSB7XG4gICAgICAgICAgICBjb25zdCBlID0gdGhpcy5fZG9jdW1lbnQuZGF0YS5maWVsZChJbChcIkRvY3VtZW50U25hcHNob3QuZ2V0XCIsIHQpKTtcbiAgICAgICAgICAgIGlmIChudWxsICE9PSBlKSByZXR1cm4gdGhpcy5fdXNlckRhdGFXcml0ZXIuY29udmVydFZhbHVlKGUpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5RG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbnMgZGF0YSByZWFkIGZyb20gYSBkb2N1bWVudCBpbiB5b3VyXG4gKiBGaXJlc3RvcmUgZGF0YWJhc2UgYXMgcGFydCBvZiBhIHF1ZXJ5LiBUaGUgZG9jdW1lbnQgaXMgZ3VhcmFudGVlZCB0byBleGlzdFxuICogYW5kIGl0cyBkYXRhIGNhbiBiZSBleHRyYWN0ZWQgd2l0aCBgLmRhdGEoKWAgb3IgYC5nZXQoPGZpZWxkPilgIHRvIGdldCBhXG4gKiBzcGVjaWZpYyBmaWVsZC5cbiAqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIG9mZmVycyB0aGUgc2FtZSBBUEkgc3VyZmFjZSBhcyBhXG4gKiBgRG9jdW1lbnRTbmFwc2hvdGAuIFNpbmNlIHF1ZXJ5IHJlc3VsdHMgY29udGFpbiBvbmx5IGV4aXN0aW5nIGRvY3VtZW50cywgdGhlXG4gKiBgZXhpc3RzYCBwcm9wZXJ0eSB3aWxsIGFsd2F5cyBiZSB0cnVlIGFuZCBgZGF0YSgpYCB3aWxsIG5ldmVyIHJldHVyblxuICogJ3VuZGVmaW5lZCcuXG4gKi8gY2xhc3MgcGwgZXh0ZW5kcyB5bCB7XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLlxuICAgICAqXG4gICAgICogQG92ZXJyaWRlXG4gICAgICogQHJldHVybnMgQW4gYE9iamVjdGAgY29udGFpbmluZyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudC5cbiAgICAgKi9cbiAgICBkYXRhKCkge1xuICAgICAgICByZXR1cm4gc3VwZXIuZGF0YSgpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBIZWxwZXIgdGhhdCBjYWxscyBgZnJvbURvdFNlcGFyYXRlZFN0cmluZygpYCBidXQgd3JhcHMgYW55IGVycm9yIHRocm93bi5cbiAqLyBmdW5jdGlvbiBJbCh0LCBlKSB7XG4gICAgcmV0dXJuIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyB3bCh0LCBlKSA6IGUgaW5zdGFuY2VvZiBVaCA/IGUuX2ludGVybmFsUGF0aCA6IGUuX2RlbGVnYXRlLl9pbnRlcm5hbFBhdGg7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIGZ1bmN0aW9uIFRsKHQpIHtcbiAgICBpZiAoXCJMXCIgLyogTGltaXRUeXBlLkxhc3QgKi8gPT09IHQubGltaXRUeXBlICYmIDAgPT09IHQuZXhwbGljaXRPcmRlckJ5Lmxlbmd0aCkgdGhyb3cgbmV3IFUocS5VTklNUExFTUVOVEVELCBcImxpbWl0VG9MYXN0KCkgcXVlcmllcyByZXF1aXJlIHNwZWNpZnlpbmcgYXQgbGVhc3Qgb25lIG9yZGVyQnkoKSBjbGF1c2VcIik7XG59XG5cbi8qKlxuICogQW4gYEFwcGxpYWJsZUNvbnN0cmFpbnRgIGlzIGFuIGFic3RyYWN0aW9uIG9mIGEgY29uc3RyYWludCB0aGF0IGNhbiBiZSBhcHBsaWVkXG4gKiB0byBhIEZpcmVzdG9yZSBxdWVyeS5cbiAqLyBjbGFzcyBFbCB7fVxuXG4vKipcbiAqIEEgYFF1ZXJ5Q29uc3RyYWludGAgaXMgdXNlZCB0byBuYXJyb3cgdGhlIHNldCBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnkgYVxuICogRmlyZXN0b3JlIHF1ZXJ5LiBgUXVlcnlDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIHdoZXJlfSxcbiAqIHtAbGluayBvcmRlckJ5fSwge0BsaW5rIChzdGFydEF0OjEpfSwge0BsaW5rIChzdGFydEFmdGVyOjEpfSwge0BsaW5rXG4gKiAoZW5kQmVmb3JlOjEpfSwge0BsaW5rIChlbmRBdDoxKX0sIHtAbGluayBsaW1pdH0sIHtAbGluayBsaW1pdFRvTGFzdH0gYW5kXG4gKiBjYW4gdGhlbiBiZSBwYXNzZWQgdG8ge0BsaW5rIChxdWVyeToxKX0gdG8gY3JlYXRlIGEgbmV3IHF1ZXJ5IGluc3RhbmNlIHRoYXRcbiAqIGFsc28gY29udGFpbnMgdGhpcyBgUXVlcnlDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBBbCBleHRlbmRzIEVsIHt9XG5cbmZ1bmN0aW9uIFJsKHQsIGUsIC4uLm4pIHtcbiAgICBsZXQgcyA9IFtdO1xuICAgIGUgaW5zdGFuY2VvZiBFbCAmJiBzLnB1c2goZSksIHMgPSBzLmNvbmNhdChuKSwgZnVuY3Rpb24odCkge1xuICAgICAgICBjb25zdCBlID0gdC5maWx0ZXIoKHQgPT4gdCBpbnN0YW5jZW9mIGJsKSkubGVuZ3RoLCBuID0gdC5maWx0ZXIoKHQgPT4gdCBpbnN0YW5jZW9mIHZsKSkubGVuZ3RoO1xuICAgICAgICBpZiAoZSA+IDEgfHwgZSA+IDAgJiYgbiA+IDApIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkUXVlcnkuIFdoZW4gdXNpbmcgY29tcG9zaXRlIGZpbHRlcnMsIHlvdSBjYW5ub3QgdXNlIG1vcmUgdGhhbiBvbmUgZmlsdGVyIGF0IHRoZSB0b3AgbGV2ZWwuIENvbnNpZGVyIG5lc3RpbmcgdGhlIG11bHRpcGxlIGZpbHRlcnMgd2l0aGluIGFuIGBhbmQoLi4uKWAgc3RhdGVtZW50LiBGb3IgZXhhbXBsZTogY2hhbmdlIGBxdWVyeShxdWVyeSwgd2hlcmUoLi4uKSwgb3IoLi4uKSlgIHRvIGBxdWVyeShxdWVyeSwgYW5kKHdoZXJlKC4uLiksIG9yKC4uLikpKWAuXCIpO1xuICAgIH1cbiAgICAvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuICAgIC8qKlxuICogQ29udmVydHMgRmlyZXN0b3JlJ3MgaW50ZXJuYWwgdHlwZXMgdG8gdGhlIEphdmFTY3JpcHQgdHlwZXMgdGhhdCB3ZSBleHBvc2VcbiAqIHRvIHRoZSB1c2VyLlxuICpcbiAqIEBpbnRlcm5hbFxuICovIChzKTtcbiAgICBmb3IgKGNvbnN0IGUgb2YgcykgdCA9IGUuX2FwcGx5KHQpO1xuICAgIHJldHVybiB0O1xufVxuXG4vKipcbiAqIEEgYFF1ZXJ5RmllbGRGaWx0ZXJDb25zdHJhaW50YCBpcyB1c2VkIHRvIG5hcnJvdyB0aGUgc2V0IG9mIGRvY3VtZW50cyByZXR1cm5lZCBieVxuICogYSBGaXJlc3RvcmUgcXVlcnkgYnkgZmlsdGVyaW5nIG9uIG9uZSBvciBtb3JlIGRvY3VtZW50IGZpZWxkcy5cbiAqIGBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludGBzIGFyZSBjcmVhdGVkIGJ5IGludm9raW5nIHtAbGluayB3aGVyZX0gYW5kIGNhbiB0aGVuXG4gKiBiZSBwYXNzZWQgdG8ge0BsaW5rIChxdWVyeToxKX0gdG8gY3JlYXRlIGEgbmV3IHF1ZXJ5IGluc3RhbmNlIHRoYXQgYWxzbyBjb250YWluc1xuICogdGhpcyBgUXVlcnlGaWVsZEZpbHRlckNvbnN0cmFpbnRgLlxuICovIGNsYXNzIHZsIGV4dGVuZHMgQWwge1xuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUsIG4pIHtcbiAgICAgICAgc3VwZXIoKSwgdGhpcy5fZmllbGQgPSB0LCB0aGlzLl9vcCA9IGUsIHRoaXMuX3ZhbHVlID0gbiwgXG4gICAgICAgIC8qKiBUaGUgdHlwZSBvZiB0aGlzIHF1ZXJ5IGNvbnN0cmFpbnQgKi9cbiAgICAgICAgdGhpcy50eXBlID0gXCJ3aGVyZVwiO1xuICAgIH1cbiAgICBzdGF0aWMgX2NyZWF0ZSh0LCBlLCBuKSB7XG4gICAgICAgIHJldHVybiBuZXcgdmwodCwgZSwgbik7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLl9wYXJzZSh0KTtcbiAgICAgICAgcmV0dXJuIEdsKHQuX3F1ZXJ5LCBlKSwgbmV3IGZoKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgWW4odC5fcXVlcnksIGUpKTtcbiAgICB9XG4gICAgX3BhcnNlKHQpIHtcbiAgICAgICAgY29uc3QgZSA9IFhoKHQuZmlyZXN0b3JlKSwgbiA9IGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIsIG8pIHtcbiAgICAgICAgICAgIGxldCB1O1xuICAgICAgICAgICAgaWYgKGkuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgaWYgKFwiYXJyYXktY29udGFpbnNcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOUyAqLyA9PT0gciB8fCBcImFycmF5LWNvbnRhaW5zLWFueVwiIC8qIE9wZXJhdG9yLkFSUkFZX0NPTlRBSU5TX0FOWSAqLyA9PT0gcikgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gWW91IGNhbid0IHBlcmZvcm0gJyR7cn0nIHF1ZXJpZXMgb24gZG9jdW1lbnRJZCgpLmApO1xuICAgICAgICAgICAgICAgIGlmIChcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gPT09IHIgfHwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gPT09IHIpIHtcbiAgICAgICAgICAgICAgICAgICAgS2wobywgcik7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGUgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIG8pIGUucHVzaChVbChzLCB0LCBuKSk7XG4gICAgICAgICAgICAgICAgICAgIHUgPSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcnJheVZhbHVlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzOiBlXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHUgPSBVbChzLCB0LCBvKTtcbiAgICAgICAgICAgIH0gZWxzZSBcImluXCIgLyogT3BlcmF0b3IuSU4gKi8gIT09IHIgJiYgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gIT09IHIgJiYgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi8gIT09IHIgfHwgS2wobywgciksIFxuICAgICAgICAgICAgdSA9IGNsKG4sIGUsIG8sIFxuICAgICAgICAgICAgLyogYWxsb3dBcnJheXM9ICovIFwiaW5cIiAvKiBPcGVyYXRvci5JTiAqLyA9PT0gciB8fCBcIm5vdC1pblwiIC8qIE9wZXJhdG9yLk5PVF9JTiAqLyA9PT0gcik7XG4gICAgICAgICAgICByZXR1cm4gbW4uY3JlYXRlKGksIHIsIHUpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBcIndoZXJlXCIsIGUsIHQuZmlyZXN0b3JlLl9kYXRhYmFzZUlkLCB0aGlzLl9maWVsZCwgdGhpcy5fb3AsIHRoaXMuX3ZhbHVlKTtcbiAgICAgICAgcmV0dXJuIG47XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlGaWVsZEZpbHRlckNvbnN0cmFpbnR9IHRoYXQgZW5mb3JjZXMgdGhhdCBkb2N1bWVudHNcbiAqIG11c3QgY29udGFpbiB0aGUgc3BlY2lmaWVkIGZpZWxkIGFuZCB0aGF0IHRoZSB2YWx1ZSBzaG91bGQgc2F0aXNmeSB0aGVcbiAqIHJlbGF0aW9uIGNvbnN0cmFpbnQgcHJvdmlkZWQuXG4gKlxuICogQHBhcmFtIGZpZWxkUGF0aCAtIFRoZSBwYXRoIHRvIGNvbXBhcmVcbiAqIEBwYXJhbSBvcFN0ciAtIFRoZSBvcGVyYXRpb24gc3RyaW5nIChlLmcgXCImbHQ7XCIsIFwiJmx0Oz1cIiwgXCI9PVwiLCBcIiZsdDtcIixcbiAqICAgXCImbHQ7PVwiLCBcIiE9XCIpLlxuICogQHBhcmFtIHZhbHVlIC0gVGhlIHZhbHVlIGZvciBjb21wYXJpc29uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnlGaWVsZEZpbHRlckNvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIFBsKHQsIGUsIG4pIHtcbiAgICBjb25zdCBzID0gZSwgaSA9IElsKFwid2hlcmVcIiwgdCk7XG4gICAgcmV0dXJuIHZsLl9jcmVhdGUoaSwgcywgbik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50YCBpcyB1c2VkIHRvIG5hcnJvdyB0aGUgc2V0IG9mIGRvY3VtZW50c1xuICogcmV0dXJuZWQgYnkgYSBGaXJlc3RvcmUgcXVlcnkgYnkgcGVyZm9ybWluZyB0aGUgbG9naWNhbCBPUiBvciBBTkQgb2YgbXVsdGlwbGVcbiAqIHtAbGluayBRdWVyeUZpZWxkRmlsdGVyQ29uc3RyYWludH1zIG9yIHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9cy5cbiAqIGBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnRgcyBhcmUgY3JlYXRlZCBieSBpbnZva2luZyB7QGxpbmsgb3J9IG9yXG4gKiB7QGxpbmsgYW5kfSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeVxuICogaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoZSBgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBibCBleHRlbmRzIEVsIHtcbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgdCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLl9xdWVyeUNvbnN0cmFpbnRzID0gZTtcbiAgICB9XG4gICAgc3RhdGljIF9jcmVhdGUodCwgZSkge1xuICAgICAgICByZXR1cm4gbmV3IGJsKHQsIGUpO1xuICAgIH1cbiAgICBfcGFyc2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5fcXVlcnlDb25zdHJhaW50cy5tYXAoKGUgPT4gZS5fcGFyc2UodCkpKS5maWx0ZXIoKHQgPT4gdC5nZXRGaWx0ZXJzKCkubGVuZ3RoID4gMCkpO1xuICAgICAgICByZXR1cm4gMSA9PT0gZS5sZW5ndGggPyBlWzBdIDogZ24uY3JlYXRlKGUsIHRoaXMuX2dldE9wZXJhdG9yKCkpO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5fcGFyc2UodCk7XG4gICAgICAgIHJldHVybiAwID09PSBlLmdldEZpbHRlcnMoKS5sZW5ndGggPyB0IDogKGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIGxldCBuID0gdDtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBlLmdldEZsYXR0ZW5lZEZpbHRlcnMoKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgdCBvZiBzKSBHbChuLCB0KSwgbiA9IFluKG4sIHQpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrcyBpZiBhbnkgb2YgdGhlIHByb3ZpZGVkIGZpbHRlciBvcGVyYXRvcnMgYXJlIGluY2x1ZGVkIGluIHRoZSBnaXZlbiBsaXN0IG9mIGZpbHRlcnMgYW5kXG4gICAgICAgIC8vIHJldHVybnMgdGhlIGZpcnN0IG9uZSB0aGF0IGlzLCBvciBudWxsIGlmIG5vbmUgYXJlLlxuICAgICAgICAodC5fcXVlcnksIGUpLCBuZXcgZmgodC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBZbih0Ll9xdWVyeSwgZSkpKTtcbiAgICB9XG4gICAgX2dldFF1ZXJ5Q29uc3RyYWludHMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9xdWVyeUNvbnN0cmFpbnRzO1xuICAgIH1cbiAgICBfZ2V0T3BlcmF0b3IoKSB7XG4gICAgICAgIHJldHVybiBcImFuZFwiID09PSB0aGlzLnR5cGUgPyBcImFuZFwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLkFORCAqLyA6IFwib3JcIiAvKiBDb21wb3NpdGVPcGVyYXRvci5PUiAqLztcbiAgICB9XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyB7QGxpbmsgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50fSB0aGF0IGlzIGEgZGlzanVuY3Rpb24gb2ZcbiAqIHRoZSBnaXZlbiBmaWx0ZXIgY29uc3RyYWludHMuIEEgZGlzanVuY3Rpb24gZmlsdGVyIGluY2x1ZGVzIGEgZG9jdW1lbnQgaWYgaXRcbiAqIHNhdGlzZmllcyBhbnkgb2YgdGhlIGdpdmVuIGZpbHRlcnMuXG4gKlxuICogQHBhcmFtIHF1ZXJ5Q29uc3RyYWludHMgLSBPcHRpb25hbC4gVGhlIGxpc3Qgb2ZcbiAqIHtAbGluayBRdWVyeUZpbHRlckNvbnN0cmFpbnR9cyB0byBwZXJmb3JtIGEgZGlzanVuY3Rpb24gZm9yLiBUaGVzZSBtdXN0IGJlXG4gKiBjcmVhdGVkIHdpdGggY2FsbHMgdG8ge0BsaW5rIHdoZXJlfSwge0BsaW5rIG9yfSwgb3Ige0BsaW5rIGFuZH0uXG4gKiBAcmV0dXJucyBUaGUgbmV3bHkgY3JlYXRlZCB7QGxpbmsgUXVlcnlDb21wb3NpdGVGaWx0ZXJDb25zdHJhaW50fS5cbiAqLyBmdW5jdGlvbiBWbCguLi50KSB7XG4gICAgLy8gT25seSBzdXBwb3J0IFF1ZXJ5RmlsdGVyQ29uc3RyYWludHNcbiAgICByZXR1cm4gdC5mb3JFYWNoKCh0ID0+IGpsKFwib3JcIiwgdCkpKSwgYmwuX2NyZWF0ZShcIm9yXCIgLyogQ29tcG9zaXRlT3BlcmF0b3IuT1IgKi8gLCB0KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9IHRoYXQgaXMgYSBjb25qdW5jdGlvbiBvZlxuICogdGhlIGdpdmVuIGZpbHRlciBjb25zdHJhaW50cy4gQSBjb25qdW5jdGlvbiBmaWx0ZXIgaW5jbHVkZXMgYSBkb2N1bWVudCBpZiBpdFxuICogc2F0aXNmaWVzIGFsbCBvZiB0aGUgZ2l2ZW4gZmlsdGVycy5cbiAqXG4gKiBAcGFyYW0gcXVlcnlDb25zdHJhaW50cyAtIE9wdGlvbmFsLiBUaGUgbGlzdCBvZlxuICoge0BsaW5rIFF1ZXJ5RmlsdGVyQ29uc3RyYWludH1zIHRvIHBlcmZvcm0gYSBjb25qdW5jdGlvbiBmb3IuIFRoZXNlIG11c3QgYmVcbiAqIGNyZWF0ZWQgd2l0aCBjYWxscyB0byB7QGxpbmsgd2hlcmV9LCB7QGxpbmsgb3J9LCBvciB7QGxpbmsgYW5kfS5cbiAqIEByZXR1cm5zIFRoZSBuZXdseSBjcmVhdGVkIHtAbGluayBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIFNsKC4uLnQpIHtcbiAgICAvLyBPbmx5IHN1cHBvcnQgUXVlcnlGaWx0ZXJDb25zdHJhaW50c1xuICAgIHJldHVybiB0LmZvckVhY2goKHQgPT4gamwoXCJhbmRcIiwgdCkpKSwgYmwuX2NyZWF0ZShcImFuZFwiIC8qIENvbXBvc2l0ZU9wZXJhdG9yLkFORCAqLyAsIHQpO1xufVxuXG4vKipcbiAqIEEgYFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnRgIGlzIHVzZWQgdG8gc29ydCB0aGUgc2V0IG9mIGRvY3VtZW50cyByZXR1cm5lZCBieSBhXG4gKiBGaXJlc3RvcmUgcXVlcnkuIGBRdWVyeU9yZGVyQnlDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmdcbiAqIHtAbGluayBvcmRlckJ5fSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ldyBxdWVyeVxuICogaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnRgLlxuICpcbiAqIE5vdGU6IERvY3VtZW50cyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSBvcmRlckJ5IGZpZWxkIHdpbGwgbm90IGJlIHByZXNlbnQgaW5cbiAqIHRoZSBxdWVyeSByZXN1bHQuXG4gKi8gY2xhc3MgRGwgZXh0ZW5kcyBBbCB7XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovXG4gICAgY29uc3RydWN0b3IodCwgZSkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLl9maWVsZCA9IHQsIHRoaXMuX2RpcmVjdGlvbiA9IGUsIFxuICAgICAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgICAgIHRoaXMudHlwZSA9IFwib3JkZXJCeVwiO1xuICAgIH1cbiAgICBzdGF0aWMgX2NyZWF0ZSh0LCBlKSB7XG4gICAgICAgIHJldHVybiBuZXcgRGwodCwgZSk7XG4gICAgfVxuICAgIF9hcHBseSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgICAgICBpZiAobnVsbCAhPT0gdC5zdGFydEF0KSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiSW52YWxpZCBxdWVyeS4gWW91IG11c3Qgbm90IGNhbGwgc3RhcnRBdCgpIG9yIHN0YXJ0QWZ0ZXIoKSBiZWZvcmUgY2FsbGluZyBvcmRlckJ5KCkuXCIpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IHQuZW5kQXQpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJJbnZhbGlkIHF1ZXJ5LiBZb3UgbXVzdCBub3QgY2FsbCBlbmRBdCgpIG9yIGVuZEJlZm9yZSgpIGJlZm9yZSBjYWxsaW5nIG9yZGVyQnkoKS5cIik7XG4gICAgICAgICAgICBjb25zdCBzID0gbmV3IGRuKGUsIG4pO1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgICAgICBpZiAobnVsbCA9PT0gam4odCkpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVGhpcyBpcyB0aGUgZmlyc3Qgb3JkZXIgYnkuIEl0IG11c3QgbWF0Y2ggYW55IGluZXF1YWxpdHkuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB6bih0KTtcbiAgICAgICAgICAgICAgICAgICAgbnVsbCAhPT0gbiAmJiBRbCh0LCBuLCBlLmZpZWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KHQsIHMpLCBzO1xuICAgICAgICB9XG4gICAgICAgIC8qKlxuICogQ3JlYXRlIGEgYEJvdW5kYCBmcm9tIGEgcXVlcnkgYW5kIGEgZG9jdW1lbnQuXG4gKlxuICogTm90ZSB0aGF0IHRoZSBgQm91bmRgIHdpbGwgYWx3YXlzIGluY2x1ZGUgdGhlIGtleSBvZiB0aGUgZG9jdW1lbnRcbiAqIGFuZCBzbyBvbmx5IHRoZSBwcm92aWRlZCBkb2N1bWVudCB3aWxsIGNvbXBhcmUgZXF1YWwgdG8gdGhlIHJldHVybmVkXG4gKiBwb3NpdGlvbi5cbiAqXG4gKiBXaWxsIHRocm93IGlmIHRoZSBkb2N1bWVudCBkb2VzIG5vdCBjb250YWluIGFsbCBmaWVsZHMgb2YgdGhlIG9yZGVyIGJ5XG4gKiBvZiB0aGUgcXVlcnkgb3IgaWYgYW55IG9mIHRoZSBmaWVsZHMgaW4gdGhlIG9yZGVyIGJ5IGFyZSBhbiB1bmNvbW1pdHRlZFxuICogc2VydmVyIHRpbWVzdGFtcC5cbiAqLyAodC5fcXVlcnksIHRoaXMuX2ZpZWxkLCB0aGlzLl9kaXJlY3Rpb24pO1xuICAgICAgICByZXR1cm4gbmV3IGZoKHQuZmlyZXN0b3JlLCB0LmNvbnZlcnRlciwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgLy8gVE9ETyhkaW1vbmQpOiB2YWxpZGF0ZSB0aGF0IG9yZGVyQnkgZG9lcyBub3QgbGlzdCB0aGUgc2FtZSBrZXkgdHdpY2UuXG4gICAgICAgICAgICBjb25zdCBuID0gdC5leHBsaWNpdE9yZGVyQnkuY29uY2F0KFsgZSBdKTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW4odC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgbiwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCB0LnN0YXJ0QXQsIHQuZW5kQXQpO1xuICAgICAgICB9KHQuX3F1ZXJ5LCBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlPcmRlckJ5Q29uc3RyYWludH0gdGhhdCBzb3J0cyB0aGUgcXVlcnkgcmVzdWx0IGJ5IHRoZVxuICogc3BlY2lmaWVkIGZpZWxkLCBvcHRpb25hbGx5IGluIGRlc2NlbmRpbmcgb3JkZXIgaW5zdGVhZCBvZiBhc2NlbmRpbmcuXG4gKlxuICogTm90ZTogRG9jdW1lbnRzIHRoYXQgZG8gbm90IGNvbnRhaW4gdGhlIHNwZWNpZmllZCBmaWVsZCB3aWxsIG5vdCBiZSBwcmVzZW50XG4gKiBpbiB0aGUgcXVlcnkgcmVzdWx0LlxuICpcbiAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgZmllbGQgdG8gc29ydCBieS5cbiAqIEBwYXJhbSBkaXJlY3Rpb25TdHIgLSBPcHRpb25hbCBkaXJlY3Rpb24gdG8gc29ydCBieSAoJ2FzYycgb3IgJ2Rlc2MnKS4gSWZcbiAqIG5vdCBzcGVjaWZpZWQsIG9yZGVyIHdpbGwgYmUgYXNjZW5kaW5nLlxuICogQHJldHVybnMgVGhlIGNyZWF0ZWQge0BsaW5rIFF1ZXJ5T3JkZXJCeUNvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIENsKHQsIGUgPSBcImFzY1wiKSB7XG4gICAgY29uc3QgbiA9IGUsIHMgPSBJbChcIm9yZGVyQnlcIiwgdCk7XG4gICAgcmV0dXJuIERsLl9jcmVhdGUocywgbik7XG59XG5cbi8qKlxuICogQSBgUXVlcnlMaW1pdENvbnN0cmFpbnRgIGlzIHVzZWQgdG8gbGltaXQgdGhlIG51bWJlciBvZiBkb2N1bWVudHMgcmV0dXJuZWQgYnlcbiAqIGEgRmlyZXN0b3JlIHF1ZXJ5LlxuICogYFF1ZXJ5TGltaXRDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIGxpbWl0fSBvclxuICoge0BsaW5rIGxpbWl0VG9MYXN0fSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ld1xuICogcXVlcnkgaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5TGltaXRDb25zdHJhaW50YC5cbiAqLyBjbGFzcyB4bCBleHRlbmRzIEFsIHtcbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgdCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLl9saW1pdCA9IGUsIHRoaXMuX2xpbWl0VHlwZSA9IG47XG4gICAgfVxuICAgIHN0YXRpYyBfY3JlYXRlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyB4bCh0LCBlLCBuKTtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBmaCh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIFhuKHQuX3F1ZXJ5LCB0aGlzLl9saW1pdCwgdGhpcy5fbGltaXRUeXBlKSk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYSB7QGxpbmsgUXVlcnlMaW1pdENvbnN0cmFpbnR9IHRoYXQgb25seSByZXR1cm5zIHRoZSBmaXJzdCBtYXRjaGluZ1xuICogZG9jdW1lbnRzLlxuICpcbiAqIEBwYXJhbSBsaW1pdCAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiBpdGVtcyB0byByZXR1cm4uXG4gKiBAcmV0dXJucyBUaGUgY3JlYXRlZCB7QGxpbmsgUXVlcnlMaW1pdENvbnN0cmFpbnR9LlxuICovIGZ1bmN0aW9uIE5sKHQpIHtcbiAgICByZXR1cm4gdWgoXCJsaW1pdFwiLCB0KSwgeGwuX2NyZWF0ZShcImxpbWl0XCIsIHQsIFwiRlwiIC8qIExpbWl0VHlwZS5GaXJzdCAqLyk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIHtAbGluayBRdWVyeUxpbWl0Q29uc3RyYWludH0gdGhhdCBvbmx5IHJldHVybnMgdGhlIGxhc3QgbWF0Y2hpbmdcbiAqIGRvY3VtZW50cy5cbiAqXG4gKiBZb3UgbXVzdCBzcGVjaWZ5IGF0IGxlYXN0IG9uZSBgb3JkZXJCeWAgY2xhdXNlIGZvciBgbGltaXRUb0xhc3RgIHF1ZXJpZXMsXG4gKiBvdGhlcndpc2UgYW4gZXhjZXB0aW9uIHdpbGwgYmUgdGhyb3duIGR1cmluZyBleGVjdXRpb24uXG4gKlxuICogQHBhcmFtIGxpbWl0IC0gVGhlIG1heGltdW0gbnVtYmVyIG9mIGl0ZW1zIHRvIHJldHVybi5cbiAqIEByZXR1cm5zIFRoZSBjcmVhdGVkIHtAbGluayBRdWVyeUxpbWl0Q29uc3RyYWludH0uXG4gKi8gZnVuY3Rpb24ga2wodCkge1xuICAgIHJldHVybiB1aChcImxpbWl0VG9MYXN0XCIsIHQpLCB4bC5fY3JlYXRlKFwibGltaXRUb0xhc3RcIiwgdCwgXCJMXCIgLyogTGltaXRUeXBlLkxhc3QgKi8pO1xufVxuXG4vKipcbiAqIEEgYFF1ZXJ5U3RhcnRBdENvbnN0cmFpbnRgIGlzIHVzZWQgdG8gZXhjbHVkZSBkb2N1bWVudHMgZnJvbSB0aGUgc3RhcnQgb2YgYVxuICogcmVzdWx0IHNldCByZXR1cm5lZCBieSBhIEZpcmVzdG9yZSBxdWVyeS5cbiAqIGBRdWVyeVN0YXJ0QXRDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIChzdGFydEF0OjEpfSBvclxuICoge0BsaW5rIChzdGFydEFmdGVyOjEpfSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhXG4gKiBuZXcgcXVlcnkgaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5U3RhcnRBdENvbnN0cmFpbnRgLlxuICovIGNsYXNzIE1sIGV4dGVuZHMgQWwge1xuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKFxuICAgIC8qKiBUaGUgdHlwZSBvZiB0aGlzIHF1ZXJ5IGNvbnN0cmFpbnQgKi9cbiAgICB0LCBlLCBuKSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMudHlwZSA9IHQsIHRoaXMuX2RvY09yRmllbGRzID0gZSwgdGhpcy5faW5jbHVzaXZlID0gbjtcbiAgICB9XG4gICAgc3RhdGljIF9jcmVhdGUodCwgZSwgbikge1xuICAgICAgICByZXR1cm4gbmV3IE1sKHQsIGUsIG4pO1xuICAgIH1cbiAgICBfYXBwbHkodCkge1xuICAgICAgICBjb25zdCBlID0gcWwodCwgdGhpcy50eXBlLCB0aGlzLl9kb2NPckZpZWxkcywgdGhpcy5faW5jbHVzaXZlKTtcbiAgICAgICAgcmV0dXJuIG5ldyBmaCh0LmZpcmVzdG9yZSwgdC5jb252ZXJ0ZXIsIGZ1bmN0aW9uKHQsIGUpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVW4odC5wYXRoLCB0LmNvbGxlY3Rpb25Hcm91cCwgdC5leHBsaWNpdE9yZGVyQnkuc2xpY2UoKSwgdC5maWx0ZXJzLnNsaWNlKCksIHQubGltaXQsIHQubGltaXRUeXBlLCBlLCB0LmVuZEF0KTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gT2woLi4udCkge1xuICAgIHJldHVybiBNbC5fY3JlYXRlKFwic3RhcnRBdFwiLCB0LCBcbiAgICAvKmluY2x1c2l2ZT0qLyAhMCk7XG59XG5cbmZ1bmN0aW9uICRsKC4uLnQpIHtcbiAgICByZXR1cm4gTWwuX2NyZWF0ZShcInN0YXJ0QWZ0ZXJcIiwgdCwgXG4gICAgLyppbmNsdXNpdmU9Ki8gITEpO1xufVxuXG4vKipcbiAqIEEgYFF1ZXJ5RW5kQXRDb25zdHJhaW50YCBpcyB1c2VkIHRvIGV4Y2x1ZGUgZG9jdW1lbnRzIGZyb20gdGhlIGVuZCBvZiBhXG4gKiByZXN1bHQgc2V0IHJldHVybmVkIGJ5IGEgRmlyZXN0b3JlIHF1ZXJ5LlxuICogYFF1ZXJ5RW5kQXRDb25zdHJhaW50YHMgYXJlIGNyZWF0ZWQgYnkgaW52b2tpbmcge0BsaW5rIChlbmRBdDoxKX0gb3JcbiAqIHtAbGluayAoZW5kQmVmb3JlOjEpfSBhbmQgY2FuIHRoZW4gYmUgcGFzc2VkIHRvIHtAbGluayAocXVlcnk6MSl9IHRvIGNyZWF0ZSBhIG5ld1xuICogcXVlcnkgaW5zdGFuY2UgdGhhdCBhbHNvIGNvbnRhaW5zIHRoaXMgYFF1ZXJ5RW5kQXRDb25zdHJhaW50YC5cbiAqLyBjbGFzcyBGbCBleHRlbmRzIEFsIHtcbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAvKiogVGhlIHR5cGUgb2YgdGhpcyBxdWVyeSBjb25zdHJhaW50ICovXG4gICAgdCwgZSwgbikge1xuICAgICAgICBzdXBlcigpLCB0aGlzLnR5cGUgPSB0LCB0aGlzLl9kb2NPckZpZWxkcyA9IGUsIHRoaXMuX2luY2x1c2l2ZSA9IG47XG4gICAgfVxuICAgIHN0YXRpYyBfY3JlYXRlKHQsIGUsIG4pIHtcbiAgICAgICAgcmV0dXJuIG5ldyBGbCh0LCBlLCBuKTtcbiAgICB9XG4gICAgX2FwcGx5KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IHFsKHQsIHRoaXMudHlwZSwgdGhpcy5fZG9jT3JGaWVsZHMsIHRoaXMuX2luY2x1c2l2ZSk7XG4gICAgICAgIHJldHVybiBuZXcgZmgodC5maXJlc3RvcmUsIHQuY29udmVydGVyLCBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFVuKHQucGF0aCwgdC5jb2xsZWN0aW9uR3JvdXAsIHQuZXhwbGljaXRPcmRlckJ5LnNsaWNlKCksIHQuZmlsdGVycy5zbGljZSgpLCB0LmxpbWl0LCB0LmxpbWl0VHlwZSwgdC5zdGFydEF0LCBlKTtcbiAgICAgICAgfSh0Ll9xdWVyeSwgZSkpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gQmwoLi4udCkge1xuICAgIHJldHVybiBGbC5fY3JlYXRlKFwiZW5kQmVmb3JlXCIsIHQsIFxuICAgIC8qaW5jbHVzaXZlPSovICExKTtcbn1cblxuZnVuY3Rpb24gTGwoLi4udCkge1xuICAgIHJldHVybiBGbC5fY3JlYXRlKFwiZW5kQXRcIiwgdCwgXG4gICAgLyppbmNsdXNpdmU9Ki8gITApO1xufVxuXG4vKiogSGVscGVyIGZ1bmN0aW9uIHRvIGNyZWF0ZSBhIGJvdW5kIGZyb20gYSBkb2N1bWVudCBvciBmaWVsZHMgKi8gZnVuY3Rpb24gcWwodCwgZSwgbiwgcykge1xuICAgIGlmIChuWzBdID0gZ2V0TW9kdWxhckluc3RhbmNlKG5bMF0pLCBuWzBdIGluc3RhbmNlb2YgeWwpIHJldHVybiBmdW5jdGlvbih0LCBlLCBuLCBzLCBpKSB7XG4gICAgICAgIGlmICghcykgdGhyb3cgbmV3IFUocS5OT1RfRk9VTkQsIGBDYW4ndCB1c2UgYSBEb2N1bWVudFNuYXBzaG90IHRoYXQgZG9lc24ndCBleGlzdCBmb3IgJHtufSgpLmApO1xuICAgICAgICBjb25zdCByID0gW107XG4gICAgICAgIC8vIEJlY2F1c2UgcGVvcGxlIGV4cGVjdCB0byBjb250aW51ZS9lbmQgYSBxdWVyeSBhdCB0aGUgZXhhY3QgZG9jdW1lbnRcbiAgICAgICAgLy8gcHJvdmlkZWQsIHdlIG5lZWQgdG8gdXNlIHRoZSBpbXBsaWNpdCBzb3J0IG9yZGVyIHJhdGhlciB0aGFuIHRoZSBleHBsaWNpdFxuICAgICAgICAvLyBzb3J0IG9yZGVyLCBiZWNhdXNlIGl0J3MgZ3VhcmFudGVlZCB0byBjb250YWluIHRoZSBkb2N1bWVudCBrZXkuIFRoYXQgd2F5XG4gICAgICAgIC8vIHRoZSBwb3NpdGlvbiBiZWNvbWVzIHVuYW1iaWd1b3VzIGFuZCB0aGUgcXVlcnkgY29udGludWVzL2VuZHMgZXhhY3RseSBhdFxuICAgICAgICAvLyB0aGUgcHJvdmlkZWQgZG9jdW1lbnQuIFdpdGhvdXQgdGhlIGtleSAoYnkgdXNpbmcgdGhlIGV4cGxpY2l0IHNvcnRcbiAgICAgICAgLy8gb3JkZXJzKSwgbXVsdGlwbGUgZG9jdW1lbnRzIGNvdWxkIG1hdGNoIHRoZSBwb3NpdGlvbiwgeWllbGRpbmcgZHVwbGljYXRlXG4gICAgICAgIC8vIHJlc3VsdHMuXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBuIG9mIEhuKHQpKSBpZiAobi5maWVsZC5pc0tleUZpZWxkKCkpIHIucHVzaChXZShlLCBzLmtleSkpOyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHQgPSBzLmRhdGEuZmllbGQobi5maWVsZCk7XG4gICAgICAgICAgICBpZiAoTmUodCkpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgJ0ludmFsaWQgcXVlcnkuIFlvdSBhcmUgdHJ5aW5nIHRvIHN0YXJ0IG9yIGVuZCBhIHF1ZXJ5IHVzaW5nIGEgZG9jdW1lbnQgZm9yIHdoaWNoIHRoZSBmaWVsZCBcIicgKyBuLmZpZWxkICsgJ1wiIGlzIGFuIHVuY29tbWl0dGVkIHNlcnZlciB0aW1lc3RhbXAuIChTaW5jZSB0aGUgdmFsdWUgb2YgdGhpcyBmaWVsZCBpcyB1bmtub3duLCB5b3UgY2Fubm90IHN0YXJ0L2VuZCBhIHF1ZXJ5IHdpdGggaXQuKScpO1xuICAgICAgICAgICAgaWYgKG51bGwgPT09IHQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0ID0gbi5maWVsZC5jYW5vbmljYWxTdHJpbmcoKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgYXJlIHRyeWluZyB0byBzdGFydCBvciBlbmQgYSBxdWVyeSB1c2luZyBhIGRvY3VtZW50IGZvciB3aGljaCB0aGUgZmllbGQgJyR7dH0nICh1c2VkIGFzIHRoZSBvcmRlckJ5KSBkb2VzIG5vdCBleGlzdC5gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHIucHVzaCh0KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV3IGhuKHIsIGkpO1xuICAgIH1cbiAgICAvKipcbiAqIENvbnZlcnRzIGEgbGlzdCBvZiBmaWVsZCB2YWx1ZXMgdG8gYSBgQm91bmRgIGZvciB0aGUgZ2l2ZW4gcXVlcnkuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgZSwgblswXS5fZG9jdW1lbnQsIHMpO1xuICAgIHtcbiAgICAgICAgY29uc3QgaSA9IFhoKHQuZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHQsIGUsIG4sIHMsIGksIHIpIHtcbiAgICAgICAgICAgIC8vIFVzZSBleHBsaWNpdCBvcmRlciBieSdzIGJlY2F1c2UgaXQgaGFzIHRvIG1hdGNoIHRoZSBxdWVyeSB0aGUgdXNlciBtYWRlXG4gICAgICAgICAgICBjb25zdCBvID0gdC5leHBsaWNpdE9yZGVyQnk7XG4gICAgICAgICAgICBpZiAoaS5sZW5ndGggPiBvLmxlbmd0aCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgVG9vIG1hbnkgYXJndW1lbnRzIHByb3ZpZGVkIHRvICR7c30oKS4gVGhlIG51bWJlciBvZiBhcmd1bWVudHMgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gdGhlIG51bWJlciBvZiBvcmRlckJ5KCkgY2xhdXNlc2ApO1xuICAgICAgICAgICAgY29uc3QgdSA9IFtdO1xuICAgICAgICAgICAgZm9yIChsZXQgciA9IDA7IHIgPCBpLmxlbmd0aDsgcisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IGlbcl07XG4gICAgICAgICAgICAgICAgaWYgKG9bcl0uZmllbGQuaXNLZXlGaWVsZCgpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChcInN0cmluZ1wiICE9IHR5cGVvZiBjKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBFeHBlY3RlZCBhIHN0cmluZyBmb3IgZG9jdW1lbnQgSUQgaW4gJHtzfSgpLCBidXQgZ290IGEgJHt0eXBlb2YgY31gKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFXbih0KSAmJiAtMSAhPT0gYy5pbmRleE9mKFwiL1wiKSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCBiZSBhIHBsYWluIGRvY3VtZW50IElELCBidXQgJyR7Y30nIGNvbnRhaW5zIGEgc2xhc2guYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG4gPSB0LnBhdGguY2hpbGQodXQuZnJvbVN0cmluZyhjKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmICghaHQuaXNEb2N1bWVudEtleShuKSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYW5kIG9yZGVyaW5nIGJ5IGRvY3VtZW50SWQoKSwgdGhlIHZhbHVlIHBhc3NlZCB0byAke3N9KCkgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7bn0nIGlzIG5vdCBiZWNhdXNlIGl0IGNvbnRhaW5zIGFuIG9kZCBudW1iZXIgb2Ygc2VnbWVudHMuYCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBuZXcgaHQobik7XG4gICAgICAgICAgICAgICAgICAgIHUucHVzaChXZShlLCBpKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdCA9IGNsKG4sIHMsIGMpO1xuICAgICAgICAgICAgICAgICAgICB1LnB1c2godCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG5ldyBobih1LCByKTtcbiAgICAgICAgfVxuICAgICAgICAvKipcbiAqIFBhcnNlcyB0aGUgZ2l2ZW4gYGRvY3VtZW50SWRWYWx1ZWAgaW50byBhIGBSZWZlcmVuY2VWYWx1ZWAsIHRocm93aW5nXG4gKiBhcHByb3ByaWF0ZSBlcnJvcnMgaWYgdGhlIHZhbHVlIGlzIGFueXRoaW5nIG90aGVyIHRoYW4gYSBgRG9jdW1lbnRSZWZlcmVuY2VgXG4gKiBvciBgc3RyaW5nYCwgb3IgaWYgdGhlIHN0cmluZyBpcyBtYWxmb3JtZWQuXG4gKi8gKHQuX3F1ZXJ5LCB0LmZpcmVzdG9yZS5fZGF0YWJhc2VJZCwgaSwgZSwgbiwgcyk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBVbCh0LCBlLCBuKSB7XG4gICAgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIChuID0gZ2V0TW9kdWxhckluc3RhbmNlKG4pKSkge1xuICAgICAgICBpZiAoXCJcIiA9PT0gbikgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIkludmFsaWQgcXVlcnkuIFdoZW4gcXVlcnlpbmcgd2l0aCBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSB2YWxpZCBkb2N1bWVudCBJRCwgYnV0IGl0IHdhcyBhbiBlbXB0eSBzdHJpbmcuXCIpO1xuICAgICAgICBpZiAoIVduKGUpICYmIC0xICE9PSBuLmluZGV4T2YoXCIvXCIpKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIGEgY29sbGVjdGlvbiBieSBkb2N1bWVudElkKCksIHlvdSBtdXN0IHByb3ZpZGUgYSBwbGFpbiBkb2N1bWVudCBJRCwgYnV0ICcke259JyBjb250YWlucyBhICcvJyBjaGFyYWN0ZXIuYCk7XG4gICAgICAgIGNvbnN0IHMgPSBlLnBhdGguY2hpbGQodXQuZnJvbVN0cmluZyhuKSk7XG4gICAgICAgIGlmICghaHQuaXNEb2N1bWVudEtleShzKSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gV2hlbiBxdWVyeWluZyBhIGNvbGxlY3Rpb24gZ3JvdXAgYnkgZG9jdW1lbnRJZCgpLCB0aGUgdmFsdWUgcHJvdmlkZWQgbXVzdCByZXN1bHQgaW4gYSB2YWxpZCBkb2N1bWVudCBwYXRoLCBidXQgJyR7c30nIGlzIG5vdCBiZWNhdXNlIGl0IGhhcyBhbiBvZGQgbnVtYmVyIG9mIHNlZ21lbnRzICgke3MubGVuZ3RofSkuYCk7XG4gICAgICAgIHJldHVybiBXZSh0LCBuZXcgaHQocykpO1xuICAgIH1cbiAgICBpZiAobiBpbnN0YW5jZW9mIGxoKSByZXR1cm4gV2UodCwgbi5fa2V5KTtcbiAgICB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBXaGVuIHF1ZXJ5aW5nIHdpdGggZG9jdW1lbnRJZCgpLCB5b3UgbXVzdCBwcm92aWRlIGEgdmFsaWQgc3RyaW5nIG9yIGEgRG9jdW1lbnRSZWZlcmVuY2UsIGJ1dCBpdCB3YXM6ICR7cmgobil9LmApO1xufVxuXG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSB2YWx1ZSBwYXNzZWQgaW50byBhIGRpc2p1bmN0aXZlIGZpbHRlciBzYXRpc2ZpZXMgYWxsXG4gKiBhcnJheSByZXF1aXJlbWVudHMuXG4gKi8gZnVuY3Rpb24gS2wodCwgZSkge1xuICAgIGlmICghQXJyYXkuaXNBcnJheSh0KSB8fCAwID09PSB0Lmxlbmd0aCkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBRdWVyeS4gQSBub24tZW1wdHkgYXJyYXkgaXMgcmVxdWlyZWQgZm9yICcke2UudG9TdHJpbmcoKX0nIGZpbHRlcnMuYCk7XG59XG5cbi8qKlxuICogR2l2ZW4gYW4gb3BlcmF0b3IsIHJldHVybnMgdGhlIHNldCBvZiBvcGVyYXRvcnMgdGhhdCBjYW5ub3QgYmUgdXNlZCB3aXRoIGl0LlxuICpcbiAqIFRoaXMgaXMgbm90IGEgY29tcHJlaGVuc2l2ZSBjaGVjaywgYW5kIHRoaXMgZnVuY3Rpb24gc2hvdWxkIGJlIHJlbW92ZWQgaW4gdGhlXG4gKiBsb25nIHRlcm0uIFZhbGlkYXRpb25zIHNob3VsZCBvY2N1ciBpbiB0aGUgRmlyZXN0b3JlIGJhY2tlbmQuXG4gKlxuICogT3BlcmF0b3JzIGluIGEgcXVlcnkgbXVzdCBhZGhlcmUgdG8gdGhlIGZvbGxvd2luZyBzZXQgb2YgcnVsZXM6XG4gKiAxLiBPbmx5IG9uZSBpbmVxdWFsaXR5IHBlciBxdWVyeS5cbiAqIDIuIGBOT1RfSU5gIGNhbm5vdCBiZSB1c2VkIHdpdGggYXJyYXksIGRpc2p1bmN0aXZlLCBvciBgTk9UX0VRVUFMYCBvcGVyYXRvcnMuXG4gKi8gZnVuY3Rpb24gR2wodCwgZSkge1xuICAgIGlmIChlLmlzSW5lcXVhbGl0eSgpKSB7XG4gICAgICAgIGNvbnN0IG4gPSB6bih0KSwgcyA9IGUuZmllbGQ7XG4gICAgICAgIGlmIChudWxsICE9PSBuICYmICFuLmlzRXF1YWwocykpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgYEludmFsaWQgcXVlcnkuIEFsbCB3aGVyZSBmaWx0ZXJzIHdpdGggYW4gaW5lcXVhbGl0eSAoPCwgPD0sICE9LCBub3QtaW4sID4sIG9yID49KSBtdXN0IGJlIG9uIHRoZSBzYW1lIGZpZWxkLiBCdXQgeW91IGhhdmUgaW5lcXVhbGl0eSBmaWx0ZXJzIG9uICcke24udG9TdHJpbmcoKX0nIGFuZCAnJHtzLnRvU3RyaW5nKCl9J2ApO1xuICAgICAgICBjb25zdCBpID0gam4odCk7XG4gICAgICAgIG51bGwgIT09IGkgJiYgUWwodCwgcywgaSk7XG4gICAgfVxuICAgIGNvbnN0IG4gPSBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGZvciAoY29uc3QgbiBvZiB0KSBmb3IgKGNvbnN0IHQgb2Ygbi5nZXRGbGF0dGVuZWRGaWx0ZXJzKCkpIGlmIChlLmluZGV4T2YodC5vcCkgPj0gMCkgcmV0dXJuIHQub3A7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0odC5maWx0ZXJzLCBmdW5jdGlvbih0KSB7XG4gICAgICAgIHN3aXRjaCAodCkge1xuICAgICAgICAgIGNhc2UgXCIhPVwiIC8qIE9wZXJhdG9yLk5PVF9FUVVBTCAqLyA6XG4gICAgICAgICAgICByZXR1cm4gWyBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovICwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gXTtcblxuICAgICAgICAgIGNhc2UgXCJhcnJheS1jb250YWlucy1hbnlcIiAvKiBPcGVyYXRvci5BUlJBWV9DT05UQUlOU19BTlkgKi8gOlxuICAgICAgICAgIGNhc2UgXCJpblwiIC8qIE9wZXJhdG9yLklOICovIDpcbiAgICAgICAgICAgIHJldHVybiBbIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovIF07XG5cbiAgICAgICAgICBjYXNlIFwibm90LWluXCIgLyogT3BlcmF0b3IuTk9UX0lOICovIDpcbiAgICAgICAgICAgIHJldHVybiBbIFwiYXJyYXktY29udGFpbnMtYW55XCIgLyogT3BlcmF0b3IuQVJSQVlfQ09OVEFJTlNfQU5ZICovICwgXCJpblwiIC8qIE9wZXJhdG9yLklOICovICwgXCJub3QtaW5cIiAvKiBPcGVyYXRvci5OT1RfSU4gKi8gLCBcIiE9XCIgLyogT3BlcmF0b3IuTk9UX0VRVUFMICovIF07XG5cbiAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgfShlLm9wKSk7XG4gICAgaWYgKG51bGwgIT09IG4pIFxuICAgIC8vIFNwZWNpYWwgY2FzZSB3aGVuIGl0J3MgYSBkdXBsaWNhdGUgb3AgdG8gZ2l2ZSBhIHNsaWdodGx5IGNsZWFyZXIgZXJyb3IgbWVzc2FnZS5cbiAgICB0aHJvdyBuID09PSBlLm9wID8gbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBgSW52YWxpZCBxdWVyeS4gWW91IGNhbm5vdCB1c2UgbW9yZSB0aGFuIG9uZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXIuYCkgOiBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgY2Fubm90IHVzZSAnJHtlLm9wLnRvU3RyaW5nKCl9JyBmaWx0ZXJzIHdpdGggJyR7bi50b1N0cmluZygpfScgZmlsdGVycy5gKTtcbn1cblxuZnVuY3Rpb24gUWwodCwgZSwgbikge1xuICAgIGlmICghbi5pc0VxdWFsKGUpKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBJbnZhbGlkIHF1ZXJ5LiBZb3UgaGF2ZSBhIHdoZXJlIGZpbHRlciB3aXRoIGFuIGluZXF1YWxpdHkgKDwsIDw9LCAhPSwgbm90LWluLCA+LCBvciA+PSkgb24gZmllbGQgJyR7ZS50b1N0cmluZygpfScgYW5kIHNvIHlvdSBtdXN0IGFsc28gdXNlICcke2UudG9TdHJpbmcoKX0nIGFzIHlvdXIgZmlyc3QgYXJndW1lbnQgdG8gb3JkZXJCeSgpLCBidXQgeW91ciBmaXJzdCBvcmRlckJ5KCkgaXMgb24gZmllbGQgJyR7bi50b1N0cmluZygpfScgaW5zdGVhZC5gKTtcbn1cblxuZnVuY3Rpb24gamwodCwgZSkge1xuICAgIGlmICghKGUgaW5zdGFuY2VvZiB2bCB8fCBlIGluc3RhbmNlb2YgYmwpKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIGBGdW5jdGlvbiAke3R9KCkgcmVxdWlyZXMgQXBwbGlhYmxlQ29uc3RyYWludHMgY3JlYXRlZCB3aXRoIGEgY2FsbCB0byAnd2hlcmUoLi4uKScsICdvciguLi4pJywgb3IgJ2FuZCguLi4pJy5gKTtcbn1cblxuY2xhc3Mgemwge1xuICAgIGNvbnZlcnRWYWx1ZSh0LCBlID0gXCJub25lXCIpIHtcbiAgICAgICAgc3dpdGNoIChMZSh0KSkge1xuICAgICAgICAgIGNhc2UgMCAvKiBUeXBlT3JkZXIuTnVsbFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuXG4gICAgICAgICAgY2FzZSAxIC8qIFR5cGVPcmRlci5Cb29sZWFuVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHQuYm9vbGVhblZhbHVlO1xuXG4gICAgICAgICAgY2FzZSAyIC8qIFR5cGVPcmRlci5OdW1iZXJWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gQ2UodC5pbnRlZ2VyVmFsdWUgfHwgdC5kb3VibGVWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDMgLyogVHlwZU9yZGVyLlRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAodC50aW1lc3RhbXBWYWx1ZSk7XG5cbiAgICAgICAgICBjYXNlIDQgLyogVHlwZU9yZGVyLlNlcnZlclRpbWVzdGFtcFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRTZXJ2ZXJUaW1lc3RhbXAodCwgZSk7XG5cbiAgICAgICAgICBjYXNlIDUgLyogVHlwZU9yZGVyLlN0cmluZ1ZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0LnN0cmluZ1ZhbHVlO1xuXG4gICAgICAgICAgY2FzZSA2IC8qIFR5cGVPcmRlci5CbG9iVmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydEJ5dGVzKHhlKHQuYnl0ZXNWYWx1ZSkpO1xuXG4gICAgICAgICAgY2FzZSA3IC8qIFR5cGVPcmRlci5SZWZWYWx1ZSAqLyA6XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jb252ZXJ0UmVmZXJlbmNlKHQucmVmZXJlbmNlVmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA4IC8qIFR5cGVPcmRlci5HZW9Qb2ludFZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRHZW9Qb2ludCh0Lmdlb1BvaW50VmFsdWUpO1xuXG4gICAgICAgICAgY2FzZSA5IC8qIFR5cGVPcmRlci5BcnJheVZhbHVlICovIDpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRBcnJheSh0LmFycmF5VmFsdWUsIGUpO1xuXG4gICAgICAgICAgY2FzZSAxMCAvKiBUeXBlT3JkZXIuT2JqZWN0VmFsdWUgKi8gOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udmVydE9iamVjdCh0Lm1hcFZhbHVlLCBlKTtcblxuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyAkKCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29udmVydE9iamVjdCh0LCBlKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRPYmplY3RNYXAodC5maWVsZHMsIGUpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBAaW50ZXJuYWxcbiAgICAgKi8gICAgY29udmVydE9iamVjdE1hcCh0LCBlID0gXCJub25lXCIpIHtcbiAgICAgICAgY29uc3QgbiA9IHt9O1xuICAgICAgICByZXR1cm4gZ2UodCwgKCh0LCBzKSA9PiB7XG4gICAgICAgICAgICBuW3RdID0gdGhpcy5jb252ZXJ0VmFsdWUocywgZSk7XG4gICAgICAgIH0pKSwgbjtcbiAgICB9XG4gICAgY29udmVydEdlb1BvaW50KHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBRaChDZSh0LmxhdGl0dWRlKSwgQ2UodC5sb25naXR1ZGUpKTtcbiAgICB9XG4gICAgY29udmVydEFycmF5KHQsIGUpIHtcbiAgICAgICAgcmV0dXJuICh0LnZhbHVlcyB8fCBbXSkubWFwKCh0ID0+IHRoaXMuY29udmVydFZhbHVlKHQsIGUpKSk7XG4gICAgfVxuICAgIGNvbnZlcnRTZXJ2ZXJUaW1lc3RhbXAodCwgZSkge1xuICAgICAgICBzd2l0Y2ggKGUpIHtcbiAgICAgICAgICBjYXNlIFwicHJldmlvdXNcIjpcbiAgICAgICAgICAgIGNvbnN0IG4gPSBrZSh0KTtcbiAgICAgICAgICAgIHJldHVybiBudWxsID09IG4gPyBudWxsIDogdGhpcy5jb252ZXJ0VmFsdWUobiwgZSk7XG5cbiAgICAgICAgICBjYXNlIFwiZXN0aW1hdGVcIjpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmNvbnZlcnRUaW1lc3RhbXAoTWUodCkpO1xuXG4gICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnZlcnRUaW1lc3RhbXAodCkge1xuICAgICAgICBjb25zdCBlID0gRGUodCk7XG4gICAgICAgIHJldHVybiBuZXcgaXQoZS5zZWNvbmRzLCBlLm5hbm9zKTtcbiAgICB9XG4gICAgY29udmVydERvY3VtZW50S2V5KHQsIGUpIHtcbiAgICAgICAgY29uc3QgbiA9IHV0LmZyb21TdHJpbmcodCk7XG4gICAgICAgIEYodXIobikpO1xuICAgICAgICBjb25zdCBzID0gbmV3ICRlKG4uZ2V0KDEpLCBuLmdldCgzKSksIGkgPSBuZXcgaHQobi5wb3BGaXJzdCg1KSk7XG4gICAgICAgIHJldHVybiBzLmlzRXF1YWwoZSkgfHwgXG4gICAgICAgIC8vIFRPRE8oYi82NDEzMDIwMik6IFNvbWVob3cgc3VwcG9ydCBmb3JlaWduIHJlZmVyZW5jZXMuXG4gICAgICAgIGsoYERvY3VtZW50ICR7aX0gY29udGFpbnMgYSBkb2N1bWVudCByZWZlcmVuY2Ugd2l0aGluIGEgZGlmZmVyZW50IGRhdGFiYXNlICgke3MucHJvamVjdElkfS8ke3MuZGF0YWJhc2V9KSB3aGljaCBpcyBub3Qgc3VwcG9ydGVkLiBJdCB3aWxsIGJlIHRyZWF0ZWQgYXMgYSByZWZlcmVuY2UgaW4gdGhlIGN1cnJlbnQgZGF0YWJhc2UgKCR7ZS5wcm9qZWN0SWR9LyR7ZS5kYXRhYmFzZX0pIGluc3RlYWQuYCksIFxuICAgICAgICBpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ29udmVydHMgY3VzdG9tIG1vZGVsIG9iamVjdCBvZiB0eXBlIFQgaW50byBgRG9jdW1lbnREYXRhYCBieSBhcHBseWluZyB0aGVcbiAqIGNvbnZlcnRlciBpZiBpdCBleGlzdHMuXG4gKlxuICogVGhpcyBmdW5jdGlvbiBpcyB1c2VkIHdoZW4gY29udmVydGluZyB1c2VyIG9iamVjdHMgdG8gYERvY3VtZW50RGF0YWBcbiAqIGJlY2F1c2Ugd2Ugd2FudCB0byBwcm92aWRlIHRoZSB1c2VyIHdpdGggYSBtb3JlIHNwZWNpZmljIGVycm9yIG1lc3NhZ2UgaWZcbiAqIHRoZWlyIGBzZXQoKWAgb3IgZmFpbHMgZHVlIHRvIGludmFsaWQgZGF0YSBvcmlnaW5hdGluZyBmcm9tIGEgYHRvRmlyZXN0b3JlKClgXG4gKiBjYWxsLlxuICovIGZ1bmN0aW9uIFdsKHQsIGUsIG4pIHtcbiAgICBsZXQgcztcbiAgICAvLyBDYXN0IHRvIGBhbnlgIGluIG9yZGVyIHRvIHNhdGlzZnkgdGhlIHVuaW9uIHR5cGUgY29uc3RyYWludCBvblxuICAgIC8vIHRvRmlyZXN0b3JlKCkuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICByZXR1cm4gcyA9IHQgPyBuICYmIChuLm1lcmdlIHx8IG4ubWVyZ2VGaWVsZHMpID8gdC50b0ZpcmVzdG9yZShlLCBuKSA6IHQudG9GaXJlc3RvcmUoZSkgOiBlLCBcbiAgICBzO1xufVxuXG5jbGFzcyBIbCBleHRlbmRzIHpsIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHN1cGVyKCksIHRoaXMuZmlyZXN0b3JlID0gdDtcbiAgICB9XG4gICAgY29udmVydEJ5dGVzKHQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBxaCh0KTtcbiAgICB9XG4gICAgY29udmVydFJlZmVyZW5jZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSB0aGlzLmNvbnZlcnREb2N1bWVudEtleSh0LCB0aGlzLmZpcmVzdG9yZS5fZGF0YWJhc2VJZCk7XG4gICAgICAgIHJldHVybiBuZXcgbGgodGhpcy5maXJlc3RvcmUsIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCwgZSk7XG4gICAgfVxufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDcmVhdGUgYW4gQWdncmVnYXRlRmllbGQgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcHV0ZSB0aGUgc3VtIG9mXG4gKiBhIHNwZWNpZmllZCBmaWVsZCBvdmVyIGEgcmFuZ2Ugb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIGEgcXVlcnkuXG4gKiBAcGFyYW0gZmllbGQgU3BlY2lmaWVzIHRoZSBmaWVsZCB0byBzdW0gYWNyb3NzIHRoZSByZXN1bHQgc2V0LlxuICogQGludGVybmFsIFRPRE8gKHN1bS9hdmcpIHJlbW92ZSB3aGVuIHB1YmxpY1xuICovIGZ1bmN0aW9uIEpsKHQpIHtcbiAgICByZXR1cm4gbmV3IEJoKFwic3VtXCIsIGRsKFwic3VtXCIsIHQpKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYW4gQWdncmVnYXRlRmllbGQgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcHV0ZSB0aGUgYXZlcmFnZSBvZlxuICogYSBzcGVjaWZpZWQgZmllbGQgb3ZlciBhIHJhbmdlIG9mIGRvY3VtZW50cyBpbiB0aGUgcmVzdWx0IHNldCBvZiBhIHF1ZXJ5LlxuICogQHBhcmFtIGZpZWxkIFNwZWNpZmllcyB0aGUgZmllbGQgdG8gYXZlcmFnZSBhY3Jvc3MgdGhlIHJlc3VsdCBzZXQuXG4gKiBAaW50ZXJuYWwgVE9ETyAoc3VtL2F2ZykgcmVtb3ZlIHdoZW4gcHVibGljXG4gKi8gZnVuY3Rpb24gWWwodCkge1xuICAgIHJldHVybiBuZXcgQmgoXCJhdmdcIiwgZGwoXCJhdmVyYWdlXCIsIHQpKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgYW4gQWdncmVnYXRlRmllbGQgb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gY29tcHV0ZSB0aGUgY291bnQgb2ZcbiAqIGRvY3VtZW50cyBpbiB0aGUgcmVzdWx0IHNldCBvZiBhIHF1ZXJ5LlxuICogQGludGVybmFsIFRPRE8gKHN1bS9hdmcpIHJlbW92ZSB3aGVuIHB1YmxpY1xuICovIGZ1bmN0aW9uIFhsKCkge1xuICAgIHJldHVybiBuZXcgQmgoXCJjb3VudFwiKTtcbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0d28gJ0FnZ3JlZ2F0ZUZpZWxkYCBpbnN0YW5jZXMgZm9yIGVxdWFsaXR5LlxuICpcbiAqIEBwYXJhbSBsZWZ0IENvbXBhcmUgdGhpcyBBZ2dyZWdhdGVGaWVsZCB0byB0aGUgYHJpZ2h0YC5cbiAqIEBwYXJhbSByaWdodCBDb21wYXJlIHRoaXMgQWdncmVnYXRlRmllbGQgdG8gdGhlIGBsZWZ0YC5cbiAqIEBpbnRlcm5hbCBUT0RPIChzdW0vYXZnKSByZW1vdmUgd2hlbiBwdWJsaWNcbiAqLyBmdW5jdGlvbiBabCh0LCBlKSB7XG4gICAgdmFyIG4sIHM7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBCaCAmJiBlIGluc3RhbmNlb2YgQmggJiYgdC5fYWdncmVnYXRlVHlwZSA9PT0gZS5fYWdncmVnYXRlVHlwZSAmJiAobnVsbCA9PT0gKG4gPSB0Ll9pbnRlcm5hbEZpZWxkUGF0aCkgfHwgdm9pZCAwID09PSBuID8gdm9pZCAwIDogbi5jYW5vbmljYWxTdHJpbmcoKSkgPT09IChudWxsID09PSAocyA9IGUuX2ludGVybmFsRmllbGRQYXRoKSB8fCB2b2lkIDAgPT09IHMgPyB2b2lkIDAgOiBzLmNhbm9uaWNhbFN0cmluZygpKTtcbn1cblxuLyoqXG4gKiBDb21wYXJlcyB0d28gYEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RgIGluc3RhbmNlcyBmb3IgZXF1YWxpdHkuXG4gKlxuICogVHdvIGBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90YCBpbnN0YW5jZXMgYXJlIGNvbnNpZGVyZWQgXCJlcXVhbFwiIGlmIHRoZXkgaGF2ZVxuICogdW5kZXJseWluZyBxdWVyaWVzIHRoYXQgY29tcGFyZSBlcXVhbCwgYW5kIHRoZSBzYW1lIGRhdGEuXG4gKlxuICogQHBhcmFtIGxlZnQgLSBUaGUgZmlyc3QgYEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RgIHRvIGNvbXBhcmUuXG4gKiBAcGFyYW0gcmlnaHQgLSBUaGUgc2Vjb25kIGBBZ2dyZWdhdGVRdWVyeVNuYXBzaG90YCB0byBjb21wYXJlLlxuICpcbiAqIEByZXR1cm5zIGB0cnVlYCBpZiB0aGUgb2JqZWN0cyBhcmUgXCJlcXVhbFwiLCBhcyBkZWZpbmVkIGFib3ZlLCBvciBgZmFsc2VgXG4gKiBvdGhlcndpc2UuXG4gKi8gZnVuY3Rpb24gdGYodCwgZSkge1xuICAgIHJldHVybiB5aCh0LnF1ZXJ5LCBlLnF1ZXJ5KSAmJiBkZWVwRXF1YWwodC5kYXRhKCksIGUuZGF0YSgpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogTWV0YWRhdGEgYWJvdXQgYSBzbmFwc2hvdCwgZGVzY3JpYmluZyB0aGUgc3RhdGUgb2YgdGhlIHNuYXBzaG90LlxuICovIGNsYXNzIGVmIHtcbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgdGhpcy5oYXNQZW5kaW5nV3JpdGVzID0gdCwgdGhpcy5mcm9tQ2FjaGUgPSBlO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvdGhlciAtIFRoZSBgU25hcHNob3RNZXRhZGF0YWAgdG8gY29tcGFyZSBhZ2FpbnN0LlxuICAgICAqIEByZXR1cm5zIHRydWUgaWYgdGhpcyBgU25hcHNob3RNZXRhZGF0YWAgaXMgZXF1YWwgdG8gdGhlIHByb3ZpZGVkIG9uZS5cbiAgICAgKi8gICAgaXNFcXVhbCh0KSB7XG4gICAgICAgIHJldHVybiB0aGlzLmhhc1BlbmRpbmdXcml0ZXMgPT09IHQuaGFzUGVuZGluZ1dyaXRlcyAmJiB0aGlzLmZyb21DYWNoZSA9PT0gdC5mcm9tQ2FjaGU7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91ciBGaXJlc3RvcmVcbiAqIGRhdGFiYXNlLiBUaGUgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0b1xuICogZ2V0IGEgc3BlY2lmaWMgZmllbGQuXG4gKlxuICogRm9yIGEgYERvY3VtZW50U25hcHNob3RgIHRoYXQgcG9pbnRzIHRvIGEgbm9uLWV4aXN0aW5nIGRvY3VtZW50LCBhbnkgZGF0YVxuICogYWNjZXNzIHdpbGwgcmV0dXJuICd1bmRlZmluZWQnLiBZb3UgY2FuIHVzZSB0aGUgYGV4aXN0cygpYCBtZXRob2QgdG9cbiAqIGV4cGxpY2l0bHkgdmVyaWZ5IGEgZG9jdW1lbnQncyBleGlzdGVuY2UuXG4gKi8gY2xhc3MgbmYgZXh0ZW5kcyB5bCB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgcHJvdGVjdGVkICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcywgaSwgcikge1xuICAgICAgICBzdXBlcih0LCBlLCBuLCBzLCByKSwgdGhpcy5fZmlyZXN0b3JlID0gdCwgdGhpcy5fZmlyZXN0b3JlSW1wbCA9IHQsIHRoaXMubWV0YWRhdGEgPSBpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHdoZXRoZXIgb3Igbm90IHRoZSBkYXRhIGV4aXN0cy4gVHJ1ZSBpZiB0aGUgZG9jdW1lbnQgZXhpc3RzLlxuICAgICAqLyAgICBleGlzdHMoKSB7XG4gICAgICAgIHJldHVybiBzdXBlci5leGlzdHMoKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0cmlldmVzIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IGFzIGFuIGBPYmplY3RgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmXG4gICAgICogdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBgc2VydmVyVGltZXN0YW1wKClgIHZhbHVlcyB0aGF0IGhhdmUgbm90IHlldCBiZWVuXG4gICAgICogc2V0IHRvIHRoZWlyIGZpbmFsIHZhbHVlIHdpbGwgYmUgcmV0dXJuZWQgYXMgYG51bGxgLiBZb3UgY2FuIG92ZXJyaWRlXG4gICAgICogdGhpcyBieSBwYXNzaW5nIGFuIG9wdGlvbnMgb2JqZWN0LlxuICAgICAqXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvcHRpb25zIG9iamVjdCB0byBjb25maWd1cmUgaG93IGRhdGEgaXMgcmV0cmlldmVkIGZyb21cbiAgICAgKiB0aGUgc25hcHNob3QgKGZvciBleGFtcGxlIHRoZSBkZXNpcmVkIGJlaGF2aW9yIGZvciBzZXJ2ZXIgdGltZXN0YW1wcyB0aGF0XG4gICAgICogaGF2ZSBub3QgeWV0IGJlZW4gc2V0IHRvIHRoZWlyIGZpbmFsIHZhbHVlKS5cbiAgICAgKiBAcmV0dXJucyBBbiBgT2JqZWN0YCBjb250YWluaW5nIGFsbCBmaWVsZHMgaW4gdGhlIGRvY3VtZW50IG9yIGB1bmRlZmluZWRgIGlmXG4gICAgICogdGhlIGRvY3VtZW50IGRvZXNuJ3QgZXhpc3QuXG4gICAgICovICAgIGRhdGEodCA9IHt9KSB7XG4gICAgICAgIGlmICh0aGlzLl9kb2N1bWVudCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbnZlcnRlcikge1xuICAgICAgICAgICAgICAgIC8vIFdlIG9ubHkgd2FudCB0byB1c2UgdGhlIGNvbnZlcnRlciBhbmQgY3JlYXRlIGEgbmV3IERvY3VtZW50U25hcHNob3RcbiAgICAgICAgICAgICAgICAvLyBpZiBhIGNvbnZlcnRlciBoYXMgYmVlbiBwcm92aWRlZC5cbiAgICAgICAgICAgICAgICBjb25zdCBlID0gbmV3IHNmKHRoaXMuX2ZpcmVzdG9yZSwgdGhpcy5fdXNlckRhdGFXcml0ZXIsIHRoaXMuX2tleSwgdGhpcy5fZG9jdW1lbnQsIHRoaXMubWV0YWRhdGEsIFxuICAgICAgICAgICAgICAgIC8qIGNvbnZlcnRlcj0gKi8gbnVsbCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbnZlcnRlci5mcm9tRmlyZXN0b3JlKGUsIHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3VzZXJEYXRhV3JpdGVyLmNvbnZlcnRWYWx1ZSh0aGlzLl9kb2N1bWVudC5kYXRhLnZhbHVlLCB0LnNlcnZlclRpbWVzdGFtcHMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyB0aGUgZmllbGQgc3BlY2lmaWVkIGJ5IGBmaWVsZFBhdGhgLiBSZXR1cm5zIGB1bmRlZmluZWRgIGlmIHRoZVxuICAgICAqIGRvY3VtZW50IG9yIGZpZWxkIGRvZXNuJ3QgZXhpc3QuXG4gICAgICpcbiAgICAgKiBCeSBkZWZhdWx0LCBhIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdGhhdCBoYXMgbm90IHlldCBiZWVuIHNldCB0b1xuICAgICAqIGl0cyBmaW5hbCB2YWx1ZSB3aWxsIGJlIHJldHVybmVkIGFzIGBudWxsYC4gWW91IGNhbiBvdmVycmlkZSB0aGlzIGJ5XG4gICAgICogcGFzc2luZyBhbiBvcHRpb25zIG9iamVjdC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBmaWVsZFBhdGggLSBUaGUgcGF0aCAoZm9yIGV4YW1wbGUgJ2Zvbycgb3IgJ2Zvby5iYXInKSB0byBhIHNwZWNpZmljXG4gICAgICogZmllbGQuXG4gICAgICogQHBhcmFtIG9wdGlvbnMgLSBBbiBvcHRpb25zIG9iamVjdCB0byBjb25maWd1cmUgaG93IHRoZSBmaWVsZCBpcyByZXRyaWV2ZWRcbiAgICAgKiBmcm9tIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzXG4gICAgICogdGhhdCBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIFRoZSBkYXRhIGF0IHRoZSBzcGVjaWZpZWQgZmllbGQgbG9jYXRpb24gb3IgdW5kZWZpbmVkIGlmIG5vIHN1Y2hcbiAgICAgKiBmaWVsZCBleGlzdHMgaW4gdGhlIGRvY3VtZW50LlxuICAgICAqL1xuICAgIC8vIFdlIGFyZSB1c2luZyBgYW55YCBoZXJlIHRvIGF2b2lkIGFuIGV4cGxpY2l0IGNhc3QgYnkgb3VyIHVzZXJzLlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgZ2V0KHQsIGUgPSB7fSkge1xuICAgICAgICBpZiAodGhpcy5fZG9jdW1lbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IG4gPSB0aGlzLl9kb2N1bWVudC5kYXRhLmZpZWxkKElsKFwiRG9jdW1lbnRTbmFwc2hvdC5nZXRcIiwgdCkpO1xuICAgICAgICAgICAgaWYgKG51bGwgIT09IG4pIHJldHVybiB0aGlzLl91c2VyRGF0YVdyaXRlci5jb252ZXJ0VmFsdWUobiwgZS5zZXJ2ZXJUaW1lc3RhbXBzKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuLyoqXG4gKiBBIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGNvbnRhaW5zIGRhdGEgcmVhZCBmcm9tIGEgZG9jdW1lbnQgaW4geW91clxuICogRmlyZXN0b3JlIGRhdGFiYXNlIGFzIHBhcnQgb2YgYSBxdWVyeS4gVGhlIGRvY3VtZW50IGlzIGd1YXJhbnRlZWQgdG8gZXhpc3RcbiAqIGFuZCBpdHMgZGF0YSBjYW4gYmUgZXh0cmFjdGVkIHdpdGggYC5kYXRhKClgIG9yIGAuZ2V0KDxmaWVsZD4pYCB0byBnZXQgYVxuICogc3BlY2lmaWMgZmllbGQuXG4gKlxuICogQSBgUXVlcnlEb2N1bWVudFNuYXBzaG90YCBvZmZlcnMgdGhlIHNhbWUgQVBJIHN1cmZhY2UgYXMgYVxuICogYERvY3VtZW50U25hcHNob3RgLiBTaW5jZSBxdWVyeSByZXN1bHRzIGNvbnRhaW4gb25seSBleGlzdGluZyBkb2N1bWVudHMsIHRoZVxuICogYGV4aXN0c2AgcHJvcGVydHkgd2lsbCBhbHdheXMgYmUgdHJ1ZSBhbmQgYGRhdGEoKWAgd2lsbCBuZXZlciByZXR1cm5cbiAqICd1bmRlZmluZWQnLlxuICovIGNsYXNzIHNmIGV4dGVuZHMgbmYge1xuICAgIC8qKlxuICAgICAqIFJldHJpZXZlcyBhbGwgZmllbGRzIGluIHRoZSBkb2N1bWVudCBhcyBhbiBgT2JqZWN0YC5cbiAgICAgKlxuICAgICAqIEJ5IGRlZmF1bHQsIGBzZXJ2ZXJUaW1lc3RhbXAoKWAgdmFsdWVzIHRoYXQgaGF2ZSBub3QgeWV0IGJlZW5cbiAgICAgKiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUgd2lsbCBiZSByZXR1cm5lZCBhcyBgbnVsbGAuIFlvdSBjYW4gb3ZlcnJpZGVcbiAgICAgKiB0aGlzIGJ5IHBhc3NpbmcgYW4gb3B0aW9ucyBvYmplY3QuXG4gICAgICpcbiAgICAgKiBAb3ZlcnJpZGVcbiAgICAgKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBob3cgZGF0YSBpcyByZXRyaWV2ZWQgZnJvbVxuICAgICAqIHRoZSBzbmFwc2hvdCAoZm9yIGV4YW1wbGUgdGhlIGRlc2lyZWQgYmVoYXZpb3IgZm9yIHNlcnZlciB0aW1lc3RhbXBzIHRoYXRcbiAgICAgKiBoYXZlIG5vdCB5ZXQgYmVlbiBzZXQgdG8gdGhlaXIgZmluYWwgdmFsdWUpLlxuICAgICAqIEByZXR1cm5zIEFuIGBPYmplY3RgIGNvbnRhaW5pbmcgYWxsIGZpZWxkcyBpbiB0aGUgZG9jdW1lbnQuXG4gICAgICovXG4gICAgZGF0YSh0ID0ge30pIHtcbiAgICAgICAgcmV0dXJuIHN1cGVyLmRhdGEodCk7XG4gICAgfVxufVxuXG4vKipcbiAqIEEgYFF1ZXJ5U25hcHNob3RgIGNvbnRhaW5zIHplcm8gb3IgbW9yZSBgRG9jdW1lbnRTbmFwc2hvdGAgb2JqZWN0c1xuICogcmVwcmVzZW50aW5nIHRoZSByZXN1bHRzIG9mIGEgcXVlcnkuIFRoZSBkb2N1bWVudHMgY2FuIGJlIGFjY2Vzc2VkIGFzIGFuXG4gKiBhcnJheSB2aWEgdGhlIGBkb2NzYCBwcm9wZXJ0eSBvciBlbnVtZXJhdGVkIHVzaW5nIHRoZSBgZm9yRWFjaGAgbWV0aG9kLiBUaGVcbiAqIG51bWJlciBvZiBkb2N1bWVudHMgY2FuIGJlIGRldGVybWluZWQgdmlhIHRoZSBgZW1wdHlgIGFuZCBgc2l6ZWBcbiAqIHByb3BlcnRpZXMuXG4gKi8gY2xhc3MgcmYge1xuICAgIC8qKiBAaGlkZWNvbnN0cnVjdG9yICovXG4gICAgY29uc3RydWN0b3IodCwgZSwgbiwgcykge1xuICAgICAgICB0aGlzLl9maXJlc3RvcmUgPSB0LCB0aGlzLl91c2VyRGF0YVdyaXRlciA9IGUsIHRoaXMuX3NuYXBzaG90ID0gcywgdGhpcy5tZXRhZGF0YSA9IG5ldyBlZihzLmhhc1BlbmRpbmdXcml0ZXMsIHMuZnJvbUNhY2hlKSwgXG4gICAgICAgIHRoaXMucXVlcnkgPSBuO1xuICAgIH1cbiAgICAvKiogQW4gYXJyYXkgb2YgYWxsIHRoZSBkb2N1bWVudHMgaW4gdGhlIGBRdWVyeVNuYXBzaG90YC4gKi8gICAgZ2V0IGRvY3MoKSB7XG4gICAgICAgIGNvbnN0IHQgPSBbXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuZm9yRWFjaCgoZSA9PiB0LnB1c2goZSkpKSwgdDtcbiAgICB9XG4gICAgLyoqIFRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBzaXplKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc25hcHNob3QuZG9jcy5zaXplO1xuICAgIH1cbiAgICAvKiogVHJ1ZSBpZiB0aGVyZSBhcmUgbm8gZG9jdW1lbnRzIGluIHRoZSBgUXVlcnlTbmFwc2hvdGAuICovICAgIGdldCBlbXB0eSgpIHtcbiAgICAgICAgcmV0dXJuIDAgPT09IHRoaXMuc2l6ZTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogRW51bWVyYXRlcyBhbGwgb2YgdGhlIGRvY3VtZW50cyBpbiB0aGUgYFF1ZXJ5U25hcHNob3RgLlxuICAgICAqXG4gICAgICogQHBhcmFtIGNhbGxiYWNrIC0gQSBjYWxsYmFjayB0byBiZSBjYWxsZWQgd2l0aCBhIGBRdWVyeURvY3VtZW50U25hcHNob3RgIGZvclxuICAgICAqIGVhY2ggZG9jdW1lbnQgaW4gdGhlIHNuYXBzaG90LlxuICAgICAqIEBwYXJhbSB0aGlzQXJnIC0gVGhlIGB0aGlzYCBiaW5kaW5nIGZvciB0aGUgY2FsbGJhY2suXG4gICAgICovICAgIGZvckVhY2godCwgZSkge1xuICAgICAgICB0aGlzLl9zbmFwc2hvdC5kb2NzLmZvckVhY2goKG4gPT4ge1xuICAgICAgICAgICAgdC5jYWxsKGUsIG5ldyBzZih0aGlzLl9maXJlc3RvcmUsIHRoaXMuX3VzZXJEYXRhV3JpdGVyLCBuLmtleSwgbiwgbmV3IGVmKHRoaXMuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmtleSksIHRoaXMuX3NuYXBzaG90LmZyb21DYWNoZSksIHRoaXMucXVlcnkuY29udmVydGVyKSk7XG4gICAgICAgIH0pKTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogUmV0dXJucyBhbiBhcnJheSBvZiB0aGUgZG9jdW1lbnRzIGNoYW5nZXMgc2luY2UgdGhlIGxhc3Qgc25hcHNob3QuIElmIHRoaXNcbiAgICAgKiBpcyB0aGUgZmlyc3Qgc25hcHNob3QsIGFsbCBkb2N1bWVudHMgd2lsbCBiZSBpbiB0aGUgbGlzdCBhcyAnYWRkZWQnXG4gICAgICogY2hhbmdlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBvcHRpb25zIC0gYFNuYXBzaG90TGlzdGVuT3B0aW9uc2AgdGhhdCBjb250cm9sIHdoZXRoZXIgbWV0YWRhdGEtb25seVxuICAgICAqIGNoYW5nZXMgKGkuZS4gb25seSBgRG9jdW1lbnRTbmFwc2hvdC5tZXRhZGF0YWAgY2hhbmdlZCkgc2hvdWxkIHRyaWdnZXJcbiAgICAgKiBzbmFwc2hvdCBldmVudHMuXG4gICAgICovICAgIGRvY0NoYW5nZXModCA9IHt9KSB7XG4gICAgICAgIGNvbnN0IGUgPSAhIXQuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlcztcbiAgICAgICAgaWYgKGUgJiYgdGhpcy5fc25hcHNob3QuZXhjbHVkZXNNZXRhZGF0YUNoYW5nZXMpIHRocm93IG5ldyBVKHEuSU5WQUxJRF9BUkdVTUVOVCwgXCJUbyBpbmNsdWRlIG1ldGFkYXRhIGNoYW5nZXMgd2l0aCB5b3VyIGRvY3VtZW50IGNoYW5nZXMsIHlvdSBtdXN0IGFsc28gcGFzcyB7IGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6dHJ1ZSB9IHRvIG9uU25hcHNob3QoKS5cIik7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZWRDaGFuZ2VzICYmIHRoaXMuX2NhY2hlZENoYW5nZXNJbmNsdWRlTWV0YWRhdGFDaGFuZ2VzID09PSBlIHx8ICh0aGlzLl9jYWNoZWRDaGFuZ2VzID0gXG4gICAgICAgIC8qKiBDYWxjdWxhdGVzIHRoZSBhcnJheSBvZiBgRG9jdW1lbnRDaGFuZ2VgcyBmb3IgYSBnaXZlbiBgVmlld1NuYXBzaG90YC4gKi9cbiAgICAgICAgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKHQuX3NuYXBzaG90Lm9sZERvY3MuaXNFbXB0eSgpKSB7XG4gICAgICAgICAgICAgICAgbGV0IGUgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiB0Ll9zbmFwc2hvdC5kb2NDaGFuZ2VzLm1hcCgobiA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHMgPSBuZXcgc2YodC5fZmlyZXN0b3JlLCB0Ll91c2VyRGF0YVdyaXRlciwgbi5kb2Mua2V5LCBuLmRvYywgbmV3IGVmKHQuX3NuYXBzaG90Lm11dGF0ZWRLZXlzLmhhcyhuLmRvYy5rZXkpLCB0Ll9zbmFwc2hvdC5mcm9tQ2FjaGUpLCB0LnF1ZXJ5LmNvbnZlcnRlcik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuLmRvYywge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhZGRlZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZG9jOiBzLFxuICAgICAgICAgICAgICAgICAgICAgICAgb2xkSW5kZXg6IC0xLFxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3SW5kZXg6IGUrK1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAvLyBBIGBEb2N1bWVudFNldGAgdGhhdCBpcyB1cGRhdGVkIGluY3JlbWVudGFsbHkgYXMgY2hhbmdlcyBhcmUgYXBwbGllZCB0byB1c2VcbiAgICAgICAgICAgICAgICAvLyB0byBsb29rdXAgdGhlIGluZGV4IG9mIGEgZG9jdW1lbnQuXG4gICAgICAgICAgICAgICAgbGV0IG4gPSB0Ll9zbmFwc2hvdC5vbGREb2NzO1xuICAgICAgICAgICAgICAgIHJldHVybiB0Ll9zbmFwc2hvdC5kb2NDaGFuZ2VzLmZpbHRlcigodCA9PiBlIHx8IDMgLyogQ2hhbmdlVHlwZS5NZXRhZGF0YSAqLyAhPT0gdC50eXBlKSkubWFwKChlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcyA9IG5ldyBzZih0Ll9maXJlc3RvcmUsIHQuX3VzZXJEYXRhV3JpdGVyLCBlLmRvYy5rZXksIGUuZG9jLCBuZXcgZWYodC5fc25hcHNob3QubXV0YXRlZEtleXMuaGFzKGUuZG9jLmtleSksIHQuX3NuYXBzaG90LmZyb21DYWNoZSksIHQucXVlcnkuY29udmVydGVyKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGkgPSAtMSwgciA9IC0xO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMCAvKiBDaGFuZ2VUeXBlLkFkZGVkICovICE9PSBlLnR5cGUgJiYgKGkgPSBuLmluZGV4T2YoZS5kb2Mua2V5KSwgbiA9IG4uZGVsZXRlKGUuZG9jLmtleSkpLCBcbiAgICAgICAgICAgICAgICAgICAgMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gIT09IGUudHlwZSAmJiAobiA9IG4uYWRkKGUuZG9jKSwgciA9IG4uaW5kZXhPZihlLmRvYy5rZXkpKSwgXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IG9mKGUudHlwZSksXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2M6IHMsXG4gICAgICAgICAgICAgICAgICAgICAgICBvbGRJbmRleDogaSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0luZGV4OiByXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHRoaXMsIGUpLCB0aGlzLl9jYWNoZWRDaGFuZ2VzSW5jbHVkZU1ldGFkYXRhQ2hhbmdlcyA9IGUpLCB0aGlzLl9jYWNoZWRDaGFuZ2VzO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gb2YodCkge1xuICAgIHN3aXRjaCAodCkge1xuICAgICAgY2FzZSAwIC8qIENoYW5nZVR5cGUuQWRkZWQgKi8gOlxuICAgICAgICByZXR1cm4gXCJhZGRlZFwiO1xuXG4gICAgICBjYXNlIDIgLyogQ2hhbmdlVHlwZS5Nb2RpZmllZCAqLyA6XG4gICAgICBjYXNlIDMgLyogQ2hhbmdlVHlwZS5NZXRhZGF0YSAqLyA6XG4gICAgICAgIHJldHVybiBcIm1vZGlmaWVkXCI7XG5cbiAgICAgIGNhc2UgMSAvKiBDaGFuZ2VUeXBlLlJlbW92ZWQgKi8gOlxuICAgICAgICByZXR1cm4gXCJyZW1vdmVkXCI7XG5cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiAkKCk7XG4gICAgfVxufVxuXG4vLyBUT0RPKGZpcmVzdG9yZWV4cCk6IEFkZCB0ZXN0cyBmb3Igc25hcHNob3RFcXVhbCB3aXRoIGRpZmZlcmVudCBzbmFwc2hvdFxuLy8gbWV0YWRhdGFcbi8qKlxuICogUmV0dXJucyB0cnVlIGlmIHRoZSBwcm92aWRlZCBzbmFwc2hvdHMgYXJlIGVxdWFsLlxuICpcbiAqIEBwYXJhbSBsZWZ0IC0gQSBzbmFwc2hvdCB0byBjb21wYXJlLlxuICogQHBhcmFtIHJpZ2h0IC0gQSBzbmFwc2hvdCB0byBjb21wYXJlLlxuICogQHJldHVybnMgdHJ1ZSBpZiB0aGUgc25hcHNob3RzIGFyZSBlcXVhbC5cbiAqLyBmdW5jdGlvbiB1Zih0LCBlKSB7XG4gICAgcmV0dXJuIHQgaW5zdGFuY2VvZiBuZiAmJiBlIGluc3RhbmNlb2YgbmYgPyB0Ll9maXJlc3RvcmUgPT09IGUuX2ZpcmVzdG9yZSAmJiB0Ll9rZXkuaXNFcXVhbChlLl9rZXkpICYmIChudWxsID09PSB0Ll9kb2N1bWVudCA/IG51bGwgPT09IGUuX2RvY3VtZW50IDogdC5fZG9jdW1lbnQuaXNFcXVhbChlLl9kb2N1bWVudCkpICYmIHQuX2NvbnZlcnRlciA9PT0gZS5fY29udmVydGVyIDogdCBpbnN0YW5jZW9mIHJmICYmIGUgaW5zdGFuY2VvZiByZiAmJiAodC5fZmlyZXN0b3JlID09PSBlLl9maXJlc3RvcmUgJiYgeWgodC5xdWVyeSwgZS5xdWVyeSkgJiYgdC5tZXRhZGF0YS5pc0VxdWFsKGUubWV0YWRhdGEpICYmIHQuX3NuYXBzaG90LmlzRXF1YWwoZS5fc25hcHNob3QpKTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYC5cbiAqXG4gKiBOb3RlOiBgZ2V0RG9jKClgIGF0dGVtcHRzIHRvIHByb3ZpZGUgdXAtdG8tZGF0ZSBkYXRhIHdoZW4gcG9zc2libGUgYnkgd2FpdGluZ1xuICogZm9yIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBidXQgaXQgbWF5IHJldHVybiBjYWNoZWQgZGF0YSBvciBmYWlsIGlmIHlvdSBhcmVcbiAqIG9mZmxpbmUgYW5kIHRoZSBzZXJ2ZXIgY2Fubm90IGJlIHJlYWNoZWQuIFRvIHNwZWNpZnkgdGhpcyBiZWhhdmlvciwgaW52b2tlXG4gKiB7QGxpbmsgZ2V0RG9jRnJvbUNhY2hlfSBvciB7QGxpbmsgZ2V0RG9jRnJvbVNlcnZlcn0uXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZSAtIFRoZSByZWZlcmVuY2Ugb2YgdGhlIGRvY3VtZW50IHRvIGZldGNoLlxuICogQHJldHVybnMgQSBQcm9taXNlIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRTbmFwc2hvdGAgY29udGFpbmluZyB0aGVcbiAqIGN1cnJlbnQgZG9jdW1lbnQgY29udGVudHMuXG4gKi8gZnVuY3Rpb24gY2YodCkge1xuICAgIHQgPSBvaCh0LCBsaCk7XG4gICAgY29uc3QgZSA9IG9oKHQuZmlyZXN0b3JlLCBBaCk7XG4gICAgcmV0dXJuIHphKFBoKGUpLCB0Ll9rZXkpLnRoZW4oKG4gPT4gRWYoZSwgdCwgbikpKTtcbn1cblxuY2xhc3MgYWYgZXh0ZW5kcyB6bCB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBzdXBlcigpLCB0aGlzLmZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIGNvbnZlcnRCeXRlcyh0KSB7XG4gICAgICAgIHJldHVybiBuZXcgcWgodCk7XG4gICAgfVxuICAgIGNvbnZlcnRSZWZlcmVuY2UodCkge1xuICAgICAgICBjb25zdCBlID0gdGhpcy5jb252ZXJ0RG9jdW1lbnRLZXkodCwgdGhpcy5maXJlc3RvcmUuX2RhdGFiYXNlSWQpO1xuICAgICAgICByZXR1cm4gbmV3IGxoKHRoaXMuZmlyZXN0b3JlLCAvKiBjb252ZXJ0ZXI9ICovIG51bGwsIGUpO1xuICAgIH1cbn1cblxuLyoqXG4gKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhpcyBgRG9jdW1lbnRSZWZlcmVuY2VgIGZyb20gY2FjaGUuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBkb2N1bWVudCBpcyBub3QgY3VycmVudGx5IGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCByZXNvbHZlZCB3aXRoIGEgYERvY3VtZW50U25hcHNob3RgIGNvbnRhaW5pbmcgdGhlXG4gKiBjdXJyZW50IGRvY3VtZW50IGNvbnRlbnRzLlxuICovIGZ1bmN0aW9uIGhmKHQpIHtcbiAgICB0ID0gb2godCwgbGgpO1xuICAgIGNvbnN0IGUgPSBvaCh0LmZpcmVzdG9yZSwgQWgpLCBuID0gUGgoZSksIHMgPSBuZXcgYWYoZSk7XG4gICAgcmV0dXJuIGphKG4sIHQuX2tleSkudGhlbigobiA9PiBuZXcgbmYoZSwgcywgdC5fa2V5LCBuLCBuZXcgZWYobnVsbCAhPT0gbiAmJiBuLmhhc0xvY2FsTXV0YXRpb25zLCBcbiAgICAvKiBmcm9tQ2FjaGU9ICovICEwKSwgdC5jb252ZXJ0ZXIpKSk7XG59XG5cbi8qKlxuICogUmVhZHMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoaXMgYERvY3VtZW50UmVmZXJlbmNlYCBmcm9tIHRoZSBzZXJ2ZXIuXG4gKiBSZXR1cm5zIGFuIGVycm9yIGlmIHRoZSBuZXR3b3JrIGlzIG5vdCBhdmFpbGFibGUuXG4gKlxuICogQHJldHVybnMgQSBgUHJvbWlzZWAgcmVzb2x2ZWQgd2l0aCBhIGBEb2N1bWVudFNuYXBzaG90YCBjb250YWluaW5nIHRoZVxuICogY3VycmVudCBkb2N1bWVudCBjb250ZW50cy5cbiAqLyBmdW5jdGlvbiBsZih0KSB7XG4gICAgdCA9IG9oKHQsIGxoKTtcbiAgICBjb25zdCBlID0gb2godC5maXJlc3RvcmUsIEFoKTtcbiAgICByZXR1cm4gemEoUGgoZSksIHQuX2tleSwge1xuICAgICAgICBzb3VyY2U6IFwic2VydmVyXCJcbiAgICB9KS50aGVuKChuID0+IEVmKGUsIHQsIG4pKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIHF1ZXJ5IGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGFzIGEgYFF1ZXJ5U25hcHNob3RgLlxuICpcbiAqIE5vdGU6IGBnZXREb2NzKClgIGF0dGVtcHRzIHRvIHByb3ZpZGUgdXAtdG8tZGF0ZSBkYXRhIHdoZW4gcG9zc2libGUgYnlcbiAqIHdhaXRpbmcgZm9yIGRhdGEgZnJvbSB0aGUgc2VydmVyLCBidXQgaXQgbWF5IHJldHVybiBjYWNoZWQgZGF0YSBvciBmYWlsIGlmXG4gKiB5b3UgYXJlIG9mZmxpbmUgYW5kIHRoZSBzZXJ2ZXIgY2Fubm90IGJlIHJlYWNoZWQuIFRvIHNwZWNpZnkgdGhpcyBiZWhhdmlvcixcbiAqIGludm9rZSB7QGxpbmsgZ2V0RG9jc0Zyb21DYWNoZX0gb3Ige0BsaW5rIGdldERvY3NGcm9tU2VydmVyfS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gZmYodCkge1xuICAgIHQgPSBvaCh0LCBmaCk7XG4gICAgY29uc3QgZSA9IG9oKHQuZmlyZXN0b3JlLCBBaCksIG4gPSBQaChlKSwgcyA9IG5ldyBhZihlKTtcbiAgICByZXR1cm4gVGwodC5fcXVlcnkpLCBIYShuLCB0Ll9xdWVyeSkudGhlbigobiA9PiBuZXcgcmYoZSwgcywgdCwgbikpKTtcbn1cblxuLyoqXG4gKiBFeGVjdXRlcyB0aGUgcXVlcnkgYW5kIHJldHVybnMgdGhlIHJlc3VsdHMgYXMgYSBgUXVlcnlTbmFwc2hvdGAgZnJvbSBjYWNoZS5cbiAqIFJldHVybnMgYW4gZW1wdHkgcmVzdWx0IHNldCBpZiBubyBkb2N1bWVudHMgbWF0Y2hpbmcgdGhlIHF1ZXJ5IGFyZSBjdXJyZW50bHlcbiAqIGNhY2hlZC5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gZGYodCkge1xuICAgIHQgPSBvaCh0LCBmaCk7XG4gICAgY29uc3QgZSA9IG9oKHQuZmlyZXN0b3JlLCBBaCksIG4gPSBQaChlKSwgcyA9IG5ldyBhZihlKTtcbiAgICByZXR1cm4gV2EobiwgdC5fcXVlcnkpLnRoZW4oKG4gPT4gbmV3IHJmKGUsIHMsIHQsIG4pKSk7XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIHF1ZXJ5IGFuZCByZXR1cm5zIHRoZSByZXN1bHRzIGFzIGEgYFF1ZXJ5U25hcHNob3RgIGZyb20gdGhlXG4gKiBzZXJ2ZXIuIFJldHVybnMgYW4gZXJyb3IgaWYgdGhlIG5ldHdvcmsgaXMgbm90IGF2YWlsYWJsZS5cbiAqXG4gKiBAcmV0dXJucyBBIGBQcm9taXNlYCB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgcmVzdWx0cyBvZiB0aGUgcXVlcnkuXG4gKi8gZnVuY3Rpb24gX2YodCkge1xuICAgIHQgPSBvaCh0LCBmaCk7XG4gICAgY29uc3QgZSA9IG9oKHQuZmlyZXN0b3JlLCBBaCksIG4gPSBQaChlKSwgcyA9IG5ldyBhZihlKTtcbiAgICByZXR1cm4gSGEobiwgdC5fcXVlcnksIHtcbiAgICAgICAgc291cmNlOiBcInNlcnZlclwiXG4gICAgfSkudGhlbigobiA9PiBuZXcgcmYoZSwgcywgdCwgbikpKTtcbn1cblxuZnVuY3Rpb24gd2YodCwgZSwgbikge1xuICAgIHQgPSBvaCh0LCBsaCk7XG4gICAgY29uc3QgcyA9IG9oKHQuZmlyZXN0b3JlLCBBaCksIGkgPSBXbCh0LmNvbnZlcnRlciwgZSwgbik7XG4gICAgcmV0dXJuIFRmKHMsIFsgWmgoWGgocyksIFwic2V0RG9jXCIsIHQuX2tleSwgaSwgbnVsbCAhPT0gdC5jb252ZXJ0ZXIsIG4pLnRvTXV0YXRpb24odC5fa2V5LCBGcy5ub25lKCkpIF0pO1xufVxuXG5mdW5jdGlvbiBtZih0LCBlLCBuLCAuLi5zKSB7XG4gICAgdCA9IG9oKHQsIGxoKTtcbiAgICBjb25zdCBpID0gb2godC5maXJlc3RvcmUsIEFoKSwgciA9IFhoKGkpO1xuICAgIGxldCBvO1xuICAgIG8gPSBcInN0cmluZ1wiID09IHR5cGVvZiAoXG4gICAgLy8gRm9yIENvbXBhdCB0eXBlcywgd2UgaGF2ZSB0byBcImV4dHJhY3RcIiB0aGUgdW5kZXJseWluZyB0eXBlcyBiZWZvcmVcbiAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgZSA9IGdldE1vZHVsYXJJbnN0YW5jZShlKSkgfHwgZSBpbnN0YW5jZW9mIFVoID8gdWwociwgXCJ1cGRhdGVEb2NcIiwgdC5fa2V5LCBlLCBuLCBzKSA6IG9sKHIsIFwidXBkYXRlRG9jXCIsIHQuX2tleSwgZSk7XG4gICAgcmV0dXJuIFRmKGksIFsgby50b011dGF0aW9uKHQuX2tleSwgRnMuZXhpc3RzKCEwKSkgXSk7XG59XG5cbi8qKlxuICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHNwZWNpZmllZCBgRG9jdW1lbnRSZWZlcmVuY2VgLlxuICpcbiAqIEBwYXJhbSByZWZlcmVuY2UgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gZGVsZXRlLlxuICogQHJldHVybnMgQSBQcm9taXNlIHJlc29sdmVkIG9uY2UgdGhlIGRvY3VtZW50IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseVxuICogZGVsZXRlZCBmcm9tIHRoZSBiYWNrZW5kIChub3RlIHRoYXQgaXQgd29uJ3QgcmVzb2x2ZSB3aGlsZSB5b3UncmUgb2ZmbGluZSkuXG4gKi8gZnVuY3Rpb24gZ2YodCkge1xuICAgIHJldHVybiBUZihvaCh0LmZpcmVzdG9yZSwgQWgpLCBbIG5ldyBZcyh0Ll9rZXksIEZzLm5vbmUoKSkgXSk7XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGRvY3VtZW50IHRvIHNwZWNpZmllZCBgQ29sbGVjdGlvblJlZmVyZW5jZWAgd2l0aCB0aGUgZ2l2ZW4gZGF0YSxcbiAqIGFzc2lnbmluZyBpdCBhIGRvY3VtZW50IElEIGF1dG9tYXRpY2FsbHkuXG4gKlxuICogQHBhcmFtIHJlZmVyZW5jZSAtIEEgcmVmZXJlbmNlIHRvIHRoZSBjb2xsZWN0aW9uIHRvIGFkZCB0aGlzIGRvY3VtZW50IHRvLlxuICogQHBhcmFtIGRhdGEgLSBBbiBPYmplY3QgY29udGFpbmluZyB0aGUgZGF0YSBmb3IgdGhlIG5ldyBkb2N1bWVudC5cbiAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIHdpdGggYSBgRG9jdW1lbnRSZWZlcmVuY2VgIHBvaW50aW5nIHRvIHRoZVxuICogbmV3bHkgY3JlYXRlZCBkb2N1bWVudCBhZnRlciBpdCBoYXMgYmVlbiB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIChOb3RlIHRoYXQgaXRcbiAqIHdvbid0IHJlc29sdmUgd2hpbGUgeW91J3JlIG9mZmxpbmUpLlxuICovIGZ1bmN0aW9uIHlmKHQsIGUpIHtcbiAgICBjb25zdCBuID0gb2godC5maXJlc3RvcmUsIEFoKSwgcyA9IG1oKHQpLCBpID0gV2wodC5jb252ZXJ0ZXIsIGUpO1xuICAgIHJldHVybiBUZihuLCBbIFpoKFhoKHQuZmlyZXN0b3JlKSwgXCJhZGREb2NcIiwgcy5fa2V5LCBpLCBudWxsICE9PSB0LmNvbnZlcnRlciwge30pLnRvTXV0YXRpb24ocy5fa2V5LCBGcy5leGlzdHMoITEpKSBdKS50aGVuKCgoKSA9PiBzKSk7XG59XG5cbmZ1bmN0aW9uIHBmKHQsIC4uLmUpIHtcbiAgICB2YXIgbiwgcywgaTtcbiAgICB0ID0gZ2V0TW9kdWxhckluc3RhbmNlKHQpO1xuICAgIGxldCByID0ge1xuICAgICAgICBpbmNsdWRlTWV0YWRhdGFDaGFuZ2VzOiAhMVxuICAgIH0sIG8gPSAwO1xuICAgIFwib2JqZWN0XCIgIT0gdHlwZW9mIGVbb10gfHwgSWgoZVtvXSkgfHwgKHIgPSBlW29dLCBvKyspO1xuICAgIGNvbnN0IHUgPSB7XG4gICAgICAgIGluY2x1ZGVNZXRhZGF0YUNoYW5nZXM6IHIuaW5jbHVkZU1ldGFkYXRhQ2hhbmdlc1xuICAgIH07XG4gICAgaWYgKEloKGVbb10pKSB7XG4gICAgICAgIGNvbnN0IHQgPSBlW29dO1xuICAgICAgICBlW29dID0gbnVsbCA9PT0gKG4gPSB0Lm5leHQpIHx8IHZvaWQgMCA9PT0gbiA/IHZvaWQgMCA6IG4uYmluZCh0KSwgZVtvICsgMV0gPSBudWxsID09PSAocyA9IHQuZXJyb3IpIHx8IHZvaWQgMCA9PT0gcyA/IHZvaWQgMCA6IHMuYmluZCh0KSwgXG4gICAgICAgIGVbbyArIDJdID0gbnVsbCA9PT0gKGkgPSB0LmNvbXBsZXRlKSB8fCB2b2lkIDAgPT09IGkgPyB2b2lkIDAgOiBpLmJpbmQodCk7XG4gICAgfVxuICAgIGxldCBjLCBhLCBoO1xuICAgIGlmICh0IGluc3RhbmNlb2YgbGgpIGEgPSBvaCh0LmZpcmVzdG9yZSwgQWgpLCBoID0gR24odC5fa2V5LnBhdGgpLCBjID0ge1xuICAgICAgICBuZXh0OiBuID0+IHtcbiAgICAgICAgICAgIGVbb10gJiYgZVtvXShFZihhLCB0LCBuKSk7XG4gICAgICAgIH0sXG4gICAgICAgIGVycm9yOiBlW28gKyAxXSxcbiAgICAgICAgY29tcGxldGU6IGVbbyArIDJdXG4gICAgfTsgZWxzZSB7XG4gICAgICAgIGNvbnN0IG4gPSBvaCh0LCBmaCk7XG4gICAgICAgIGEgPSBvaChuLmZpcmVzdG9yZSwgQWgpLCBoID0gbi5fcXVlcnk7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgYWYoYSk7XG4gICAgICAgIGMgPSB7XG4gICAgICAgICAgICBuZXh0OiB0ID0+IHtcbiAgICAgICAgICAgICAgICBlW29dICYmIGVbb10obmV3IHJmKGEsIHMsIG4sIHQpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvcjogZVtvICsgMV0sXG4gICAgICAgICAgICBjb21wbGV0ZTogZVtvICsgMl1cbiAgICAgICAgfSwgVGwodC5fcXVlcnkpO1xuICAgIH1cbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbiwgcykge1xuICAgICAgICBjb25zdCBpID0gbmV3IFZhKHMpLCByID0gbmV3IE5jKGUsIGksIG4pO1xuICAgICAgICByZXR1cm4gdC5hc3luY1F1ZXVlLmVucXVldWVBbmRGb3JnZXQoKGFzeW5jICgpID0+IFZjKGF3YWl0IEthKHQpLCByKSkpLCAoKSA9PiB7XG4gICAgICAgICAgICBpLlNjKCksIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiBTYyhhd2FpdCBLYSh0KSwgcikpKTtcbiAgICAgICAgfTtcbiAgICB9KFBoKGEpLCBoLCB1LCBjKTtcbn1cblxuZnVuY3Rpb24gSWYodCwgZSkge1xuICAgIHJldHVybiBKYShQaCh0ID0gb2godCwgQWgpKSwgSWgoZSkgPyBlIDoge1xuICAgICAgICBuZXh0OiBlXG4gICAgfSk7XG59XG5cbi8qKlxuICogTG9jYWxseSB3cml0ZXMgYG11dGF0aW9uc2Agb24gdGhlIGFzeW5jIHF1ZXVlLlxuICogQGludGVybmFsXG4gKi8gZnVuY3Rpb24gVGYodCwgZSkge1xuICAgIHJldHVybiBmdW5jdGlvbih0LCBlKSB7XG4gICAgICAgIGNvbnN0IG4gPSBuZXcgSztcbiAgICAgICAgcmV0dXJuIHQuYXN5bmNRdWV1ZS5lbnF1ZXVlQW5kRm9yZ2V0KChhc3luYyAoKSA9PiB6Yyhhd2FpdCBxYSh0KSwgZSwgbikpKSwgbi5wcm9taXNlO1xuICAgIH0oUGgodCksIGUpO1xufVxuXG4vKipcbiAqIENvbnZlcnRzIGEge0BsaW5rIFZpZXdTbmFwc2hvdH0gdGhhdCBjb250YWlucyB0aGUgc2luZ2xlIGRvY3VtZW50IHNwZWNpZmllZCBieSBgcmVmYFxuICogdG8gYSB7QGxpbmsgRG9jdW1lbnRTbmFwc2hvdH0uXG4gKi8gZnVuY3Rpb24gRWYodCwgZSwgbikge1xuICAgIGNvbnN0IHMgPSBuLmRvY3MuZ2V0KGUuX2tleSksIGkgPSBuZXcgYWYodCk7XG4gICAgcmV0dXJuIG5ldyBuZih0LCBpLCBlLl9rZXksIHMsIG5ldyBlZihuLmhhc1BlbmRpbmdXcml0ZXMsIG4uZnJvbUNhY2hlKSwgZS5jb252ZXJ0ZXIpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBDYWxjdWxhdGVzIHRoZSBudW1iZXIgb2YgZG9jdW1lbnRzIGluIHRoZSByZXN1bHQgc2V0IG9mIHRoZSBnaXZlbiBxdWVyeSxcbiAqIHdpdGhvdXQgYWN0dWFsbHkgZG93bmxvYWRpbmcgdGhlIGRvY3VtZW50cy5cbiAqXG4gKiBVc2luZyB0aGlzIGZ1bmN0aW9uIHRvIGNvdW50IHRoZSBkb2N1bWVudHMgaXMgZWZmaWNpZW50IGJlY2F1c2Ugb25seSB0aGVcbiAqIGZpbmFsIGNvdW50LCBub3QgdGhlIGRvY3VtZW50cycgZGF0YSwgaXMgZG93bmxvYWRlZC4gVGhpcyBmdW5jdGlvbiBjYW4gZXZlblxuICogY291bnQgdGhlIGRvY3VtZW50cyBpZiB0aGUgcmVzdWx0IHNldCB3b3VsZCBiZSBwcm9oaWJpdGl2ZWx5IGxhcmdlIHRvXG4gKiBkb3dubG9hZCBlbnRpcmVseSAoZS5nLiB0aG91c2FuZHMgb2YgZG9jdW1lbnRzKS5cbiAqXG4gKiBUaGUgcmVzdWx0IHJlY2VpdmVkIGZyb20gdGhlIHNlcnZlciBpcyBwcmVzZW50ZWQsIHVuYWx0ZXJlZCwgd2l0aG91dFxuICogY29uc2lkZXJpbmcgYW55IGxvY2FsIHN0YXRlLiBUaGF0IGlzLCBkb2N1bWVudHMgaW4gdGhlIGxvY2FsIGNhY2hlIGFyZSBub3RcbiAqIHRha2VuIGludG8gY29uc2lkZXJhdGlvbiwgbmVpdGhlciBhcmUgbG9jYWwgbW9kaWZpY2F0aW9ucyBub3QgeWV0XG4gKiBzeW5jaHJvbml6ZWQgd2l0aCB0aGUgc2VydmVyLiBQcmV2aW91c2x5LWRvd25sb2FkZWQgcmVzdWx0cywgaWYgYW55LCBhcmUgbm90XG4gKiB1c2VkOiBldmVyeSByZXF1ZXN0IHVzaW5nIHRoaXMgc291cmNlIG5lY2Vzc2FyaWx5IGludm9sdmVzIGEgcm91bmQgdHJpcCB0b1xuICogdGhlIHNlcnZlci5cbiAqXG4gKiBAcGFyYW0gcXVlcnkgLSBUaGUgcXVlcnkgd2hvc2UgcmVzdWx0IHNldCBzaXplIHRvIGNhbGN1bGF0ZS5cbiAqIEByZXR1cm5zIEEgUHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgd2l0aCB0aGUgY291bnQ7IHRoZSBjb3VudCBjYW4gYmVcbiAqIHJldHJpZXZlZCBmcm9tIGBzbmFwc2hvdC5kYXRhKCkuY291bnRgLCB3aGVyZSBgc25hcHNob3RgIGlzIHRoZVxuICogYEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RgIHRvIHdoaWNoIHRoZSByZXR1cm5lZCBQcm9taXNlIHJlc29sdmVzLlxuICovIGZ1bmN0aW9uIEFmKHQpIHtcbiAgICByZXR1cm4gUmYodCwge1xuICAgICAgICBjb3VudDogWGwoKVxuICAgIH0pO1xufVxuXG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIHNwZWNpZmllZCBhZ2dyZWdhdGlvbnMgb3ZlciB0aGUgZG9jdW1lbnRzIGluIHRoZSByZXN1bHRcbiAqIHNldCBvZiB0aGUgZ2l2ZW4gcXVlcnksIHdpdGhvdXQgYWN0dWFsbHkgZG93bmxvYWRpbmcgdGhlIGRvY3VtZW50cy5cbiAqXG4gKiBVc2luZyB0aGlzIGZ1bmN0aW9uIHRvIHBlcmZvcm0gYWdncmVnYXRpb25zIGlzIGVmZmljaWVudCBiZWNhdXNlIG9ubHkgdGhlXG4gKiBmaW5hbCBhZ2dyZWdhdGlvbiB2YWx1ZXMsIG5vdCB0aGUgZG9jdW1lbnRzJyBkYXRhLCBpcyBkb3dubG9hZGVkLiBUaGlzXG4gKiBmdW5jdGlvbiBjYW4gZXZlbiBwZXJmb3JtIGFnZ3JlZ2F0aW9ucyBvZiB0aGUgZG9jdW1lbnRzIGlmIHRoZSByZXN1bHQgc2V0XG4gKiB3b3VsZCBiZSBwcm9oaWJpdGl2ZWx5IGxhcmdlIHRvIGRvd25sb2FkIGVudGlyZWx5IChlLmcuIHRob3VzYW5kcyBvZiBkb2N1bWVudHMpLlxuICpcbiAqIFRoZSByZXN1bHQgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyIGlzIHByZXNlbnRlZCwgdW5hbHRlcmVkLCB3aXRob3V0XG4gKiBjb25zaWRlcmluZyBhbnkgbG9jYWwgc3RhdGUuIFRoYXQgaXMsIGRvY3VtZW50cyBpbiB0aGUgbG9jYWwgY2FjaGUgYXJlIG5vdFxuICogdGFrZW4gaW50byBjb25zaWRlcmF0aW9uLCBuZWl0aGVyIGFyZSBsb2NhbCBtb2RpZmljYXRpb25zIG5vdCB5ZXRcbiAqIHN5bmNocm9uaXplZCB3aXRoIHRoZSBzZXJ2ZXIuIFByZXZpb3VzbHktZG93bmxvYWRlZCByZXN1bHRzLCBpZiBhbnksIGFyZSBub3RcbiAqIHVzZWQ6IGV2ZXJ5IHJlcXVlc3QgdXNpbmcgdGhpcyBzb3VyY2UgbmVjZXNzYXJpbHkgaW52b2x2ZXMgYSByb3VuZCB0cmlwIHRvXG4gKiB0aGUgc2VydmVyLlxuICpcbiAqIEBwYXJhbSBxdWVyeSBUaGUgcXVlcnkgd2hvc2UgcmVzdWx0IHNldCB0byBhZ2dyZWdhdGUgb3Zlci5cbiAqIEBwYXJhbSBhZ2dyZWdhdGVTcGVjIEFuIGBBZ2dyZWdhdGVTcGVjYCBvYmplY3QgdGhhdCBzcGVjaWZpZXMgdGhlIGFnZ3JlZ2F0ZXNcbiAqIHRvIHBlcmZvcm0gb3ZlciB0aGUgcmVzdWx0IHNldC4gVGhlIEFnZ3JlZ2F0ZVNwZWMgc3BlY2lmaWVzIGFsaWFzZXMgZm9yIGVhY2hcbiAqIGFnZ3JlZ2F0ZSwgd2hpY2ggY2FuIGJlIHVzZWQgdG8gcmV0cmlldmUgdGhlIGFnZ3JlZ2F0ZSByZXN1bHQuXG4gKiBAZXhhbXBsZVxuICogYGBgdHlwZXNjcmlwdFxuICogY29uc3QgYWdncmVnYXRlU25hcHNob3QgPSBhd2FpdCBnZXRBZ2dyZWdhdGVGcm9tU2VydmVyKHF1ZXJ5LCB7XG4gKiAgIGNvdW50T2ZEb2NzOiBjb3VudCgpLFxuICogICB0b3RhbEhvdXJzOiBzdW0oJ2hvdXJzJyksXG4gKiAgIGF2ZXJhZ2VTY29yZTogYXZlcmFnZSgnc2NvcmUnKVxuICogfSk7XG4gKlxuICogY29uc3QgY291bnRPZkRvY3M6IG51bWJlciA9IGFnZ3JlZ2F0ZVNuYXBzaG90LmRhdGEoKS5jb3VudE9mRG9jcztcbiAqIGNvbnN0IHRvdGFsSG91cnM6IG51bWJlciA9IGFnZ3JlZ2F0ZVNuYXBzaG90LmRhdGEoKS50b3RhbEhvdXJzO1xuICogY29uc3QgYXZlcmFnZVNjb3JlOiBudW1iZXIgfCBudWxsID0gYWdncmVnYXRlU25hcHNob3QuZGF0YSgpLmF2ZXJhZ2VTY29yZTtcbiAqIGBgYFxuICogQGludGVybmFsIFRPRE8gKHN1bS9hdmcpIHJlbW92ZSB3aGVuIHB1YmxpY1xuICovIGZ1bmN0aW9uIFJmKHQsIGUpIHtcbiAgICBjb25zdCBuID0gb2godC5maXJlc3RvcmUsIEFoKSwgcyA9IFBoKG4pLCBpID0gZnVuY3Rpb24odCwgZSkge1xuICAgICAgICBjb25zdCBuID0gW107XG4gICAgICAgIGZvciAoY29uc3QgcyBpbiB0KSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCwgcykgJiYgbi5wdXNoKGUodFtzXSwgcywgdCkpO1xuICAgICAgICByZXR1cm4gbjtcbiAgICB9KGUsICgodCwgZSkgPT4gbmV3IG5pKGUsIHQuX2FnZ3JlZ2F0ZVR5cGUsIHQuX2ludGVybmFsRmllbGRQYXRoKSkpO1xuICAgIC8vIFJ1biB0aGUgYWdncmVnYXRpb24gYW5kIGNvbnZlcnQgdGhlIHJlc3VsdHNcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gbmV3IEs7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgLy8gVE9ETyAoc3VtL2F2Zykgc2hvdWxkIHdlIHVwZGF0ZSB0aGlzIHRvIHVzZSB0aGUgZXZlbnQgbWFuYWdlcj9cbiAgICAgICAgICAgIC8vIEltcGxlbWVudCBhbmQgY2FsbCBleGVjdXRlQWdncmVnYXRlUXVlcnlWaWFTbmFwc2hvdExpc3RlbmVyLCBzaW1pbGFyXG4gICAgICAgICAgICAvLyB0byB0aGUgaW1wbGVtZW50YXRpb24gaW4gZmlyZXN0b3JlQ2xpZW50R2V0RG9jdW1lbnRzVmlhU25hcHNob3RMaXN0ZW5lclxuICAgICAgICAgICAgLy8gYWJvdmVcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gVE9ETyhiLzI3NzYyODM4NCk6IGNoZWNrIGBjYW5Vc2VOZXR3b3JrKClgIGFuZCBoYW5kbGUgbXVsdGktdGFiLlxuICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBhd2FpdCBVYSh0KTtcbiAgICAgICAgICAgICAgICBzLnJlc29sdmUoR3UoaSwgZSwgbikpO1xuICAgICAgICAgICAgfSBjYXRjaCAodCkge1xuICAgICAgICAgICAgICAgIHMucmVqZWN0KHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KSksIHMucHJvbWlzZTtcbiAgICB9KHMsIHQuX3F1ZXJ5LCBpKS50aGVuKChlID0+IFxuICAgIC8qKlxuICogQ29udmVydHMgdGhlIGNvcmUgYWdncmVncmF0aW9uIHJlc3VsdCB0byBhbiBgQWdncmVnYXRlUXVlcnlTbmFwc2hvdGBcbiAqIHRoYXQgY2FuIGJlIHJldHVybmVkIHRvIHRoZSBjb25zdW1lci5cbiAqIEBwYXJhbSBxdWVyeVxuICogQHBhcmFtIGFnZ3JlZ2F0ZVJlc3VsdCBDb3JlIGFnZ3JlZ2F0aW9uIHJlc3VsdFxuICogQGludGVybmFsXG4gKi9cbiAgICBmdW5jdGlvbih0LCBlLCBuKSB7XG4gICAgICAgIGNvbnN0IHMgPSBuZXcgYWYodCk7XG4gICAgICAgIHJldHVybiBuZXcgTGgoZSwgcywgbik7XG4gICAgfVxuICAgIC8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIzIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovIChuLCB0LCBlKSkpO1xufVxuXG5jbGFzcyB2ZiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICB0aGlzLmtpbmQgPSBcIm1lbW9yeVwiLCB0aGlzLl9vbmxpbmVDb21wb25lbnRQcm92aWRlciA9IG5ldyBQYSwgKG51bGwgPT0gdCA/IHZvaWQgMCA6IHQuZ2FyYmFnZUNvbGxlY3RvcikgPyB0aGlzLl9vZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgPSB0LmdhcmJhZ2VDb2xsZWN0b3IuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA6IHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IG5ldyBFYTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBQZiB7XG4gICAgY29uc3RydWN0b3IodCkge1xuICAgICAgICBsZXQgZTtcbiAgICAgICAgdGhpcy5raW5kID0gXCJwZXJzaXN0ZW50XCIsIChudWxsID09IHQgPyB2b2lkIDAgOiB0LnRhYk1hbmFnZXIpID8gKHQudGFiTWFuYWdlci5faW5pdGlhbGl6ZSh0KSwgXG4gICAgICAgIGUgPSB0LnRhYk1hbmFnZXIpIDogKGUgPSBNZih2b2lkIDApLCBlLl9pbml0aWFsaXplKHQpKSwgdGhpcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIgPSBlLl9vbmxpbmVDb21wb25lbnRQcm92aWRlciwgXG4gICAgICAgIHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IGUuX29mZmxpbmVDb21wb25lbnRQcm92aWRlcjtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG5jbGFzcyBiZiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMua2luZCA9IFwibWVtb3J5RWFnZXJcIiwgdGhpcy5fb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyID0gbmV3IEVhO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBraW5kOiB0aGlzLmtpbmRcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmNsYXNzIFZmIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMua2luZCA9IFwibWVtb3J5THJ1XCIsIHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IG5ldyBBYSh0KTtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYE1lbW9yeUVhZ2VyR2FyYmFnZUNvbGxlY3RvcmAuIFRoaXMgaXMgYWxzbyB0aGVcbiAqIGRlZmF1bHQgZ2FyYmFnZSBjb2xsZWN0b3IgdW5sZXNzIGl0IGlzIGV4cGxpY2l0bHkgc3BlY2lmaWVkIG90aGVyd2lzZS5cbiAqLyBmdW5jdGlvbiBTZigpIHtcbiAgICByZXR1cm4gbmV3IGJmO1xufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYE1lbW9yeUxydUdhcmJhZ2VDb2xsZWN0b3JgLlxuICpcbiAqIEEgdGFyZ2V0IHNpemUgY2FuIGJlIHNwZWNpZmllZCBhcyBwYXJ0IG9mIHRoZSBzZXR0aW5nIHBhcmFtZXRlci4gVGhlXG4gKiBjb2xsZWN0b3Igd2lsbCBzdGFydCBkZWxldGluZyBkb2N1bWVudHMgb25jZSB0aGUgY2FjaGUgc2l6ZSBleGNlZWRzXG4gKiB0aGUgZ2l2ZW4gc2l6ZS4gVGhlIGRlZmF1bHQgY2FjaGUgc2l6ZSBpcyA0ME1CICg0MCAqIDEwMjQgKiAxMDI0IGJ5dGVzKS5cbiAqLyBmdW5jdGlvbiBEZih0KSB7XG4gICAgcmV0dXJuIG5ldyBWZihudWxsID09IHQgPyB2b2lkIDAgOiB0LmNhY2hlU2l6ZUJ5dGVzKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBNZW1vcnlMb2NhbENhY2hlYC4gVGhlIGluc3RhbmNlIGNhbiBiZSBzZXQgdG9cbiAqIGBGaXJlc3RvcmVTZXR0aW5ncy5jYWNoZWAgdG8gdGVsbCB0aGUgU0RLIHdoaWNoIGNhY2hlIGxheWVyIHRvIHVzZS5cbiAqLyBmdW5jdGlvbiBDZih0KSB7XG4gICAgcmV0dXJuIG5ldyB2Zih0KTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50TG9jYWxDYWNoZWAuIFRoZSBpbnN0YW5jZSBjYW4gYmUgc2V0IHRvXG4gKiBgRmlyZXN0b3JlU2V0dGluZ3MuY2FjaGVgIHRvIHRlbGwgdGhlIFNESyB3aGljaCBjYWNoZSBsYXllciB0byB1c2UuXG4gKi8gZnVuY3Rpb24geGYodCkge1xuICAgIHJldHVybiBuZXcgUGYodCk7XG59XG5cbmNsYXNzIE5mIHtcbiAgICBjb25zdHJ1Y3Rvcih0KSB7XG4gICAgICAgIHRoaXMuZm9yY2VPd25lcnNoaXAgPSB0LCB0aGlzLmtpbmQgPSBcInBlcnNpc3RlbnRTaW5nbGVUYWJcIjtcbiAgICB9XG4gICAgdG9KU09OKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2luZDogdGhpcy5raW5kXG4gICAgICAgIH07XG4gICAgfVxuICAgIC8qKlxuICAgICAqIEBpbnRlcm5hbFxuICAgICAqLyAgICBfaW5pdGlhbGl6ZSh0KSB7XG4gICAgICAgIHRoaXMuX29ubGluZUNvbXBvbmVudFByb3ZpZGVyID0gbmV3IFBhLCB0aGlzLl9vZmZsaW5lQ29tcG9uZW50UHJvdmlkZXIgPSBuZXcgUmEodGhpcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIsIG51bGwgPT0gdCA/IHZvaWQgMCA6IHQuY2FjaGVTaXplQnl0ZXMsIHRoaXMuZm9yY2VPd25lcnNoaXApO1xuICAgIH1cbn1cblxuY2xhc3Mga2Yge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmtpbmQgPSBcIlBlcnNpc3RlbnRNdWx0aXBsZVRhYlwiO1xuICAgIH1cbiAgICB0b0pTT04oKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBraW5kOiB0aGlzLmtpbmRcbiAgICAgICAgfTtcbiAgICB9XG4gICAgLyoqXG4gICAgICogQGludGVybmFsXG4gICAgICovICAgIF9pbml0aWFsaXplKHQpIHtcbiAgICAgICAgdGhpcy5fb25saW5lQ29tcG9uZW50UHJvdmlkZXIgPSBuZXcgUGEsIHRoaXMuX29mZmxpbmVDb21wb25lbnRQcm92aWRlciA9IG5ldyB2YSh0aGlzLl9vbmxpbmVDb21wb25lbnRQcm92aWRlciwgbnVsbCA9PSB0ID8gdm9pZCAwIDogdC5jYWNoZVNpemVCeXRlcyk7XG4gICAgfVxufVxuXG4vKipcbiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYFBlcnNpc3RlbnRTaW5nbGVUYWJNYW5hZ2VyYC5cbiAqXG4gKiBAcGFyYW0gc2V0dGluZ3MgQ29uZmlndXJlcyB0aGUgY3JlYXRlZCB0YWIgbWFuYWdlci5cbiAqLyBmdW5jdGlvbiBNZih0KSB7XG4gICAgcmV0dXJuIG5ldyBOZihudWxsID09IHQgPyB2b2lkIDAgOiB0LmZvcmNlT3duZXJzaGlwKTtcbn1cblxuLyoqXG4gKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mIGBQZXJzaXN0ZW50TXVsdGlwbGVUYWJNYW5hZ2VyYC5cbiAqLyBmdW5jdGlvbiBPZigpIHtcbiAgICByZXR1cm4gbmV3IGtmO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMiBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBjb25zdCAkZiA9IHtcbiAgICBtYXhBdHRlbXB0czogNVxufTtcblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQSB3cml0ZSBiYXRjaCwgdXNlZCB0byBwZXJmb3JtIG11bHRpcGxlIHdyaXRlcyBhcyBhIHNpbmdsZSBhdG9taWMgdW5pdC5cbiAqXG4gKiBBIGBXcml0ZUJhdGNoYCBvYmplY3QgY2FuIGJlIGFjcXVpcmVkIGJ5IGNhbGxpbmcge0BsaW5rIHdyaXRlQmF0Y2h9LiBJdFxuICogcHJvdmlkZXMgbWV0aG9kcyBmb3IgYWRkaW5nIHdyaXRlcyB0byB0aGUgd3JpdGUgYmF0Y2guIE5vbmUgb2YgdGhlIHdyaXRlc1xuICogd2lsbCBiZSBjb21taXR0ZWQgKG9yIHZpc2libGUgbG9jYWxseSkgdW50aWwge0BsaW5rIFdyaXRlQmF0Y2guY29tbWl0fSBpc1xuICogY2FsbGVkLlxuICovXG5jbGFzcyBGZiB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX2NvbW1pdEhhbmRsZXIgPSBlLCB0aGlzLl9tdXRhdGlvbnMgPSBbXSwgdGhpcy5fY29tbWl0dGVkID0gITEsIFxuICAgICAgICB0aGlzLl9kYXRhUmVhZGVyID0gWGgodCk7XG4gICAgfVxuICAgIHNldCh0LCBlLCBuKSB7XG4gICAgICAgIHRoaXMuX3ZlcmlmeU5vdENvbW1pdHRlZCgpO1xuICAgICAgICBjb25zdCBzID0gQmYodCwgdGhpcy5fZmlyZXN0b3JlKSwgaSA9IFdsKHMuY29udmVydGVyLCBlLCBuKSwgciA9IFpoKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC5zZXRcIiwgcy5fa2V5LCBpLCBudWxsICE9PSBzLmNvbnZlcnRlciwgbik7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMucHVzaChyLnRvTXV0YXRpb24ocy5fa2V5LCBGcy5ub25lKCkpKSwgdGhpcztcbiAgICB9XG4gICAgdXBkYXRlKHQsIGUsIG4sIC4uLnMpIHtcbiAgICAgICAgdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCk7XG4gICAgICAgIGNvbnN0IGkgPSBCZih0LCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbGV0IHI7XG4gICAgICAgIHJldHVybiByID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIHx8IGUgaW5zdGFuY2VvZiBVaCA/IHVsKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlLCBuLCBzKSA6IG9sKHRoaXMuX2RhdGFSZWFkZXIsIFwiV3JpdGVCYXRjaC51cGRhdGVcIiwgaS5fa2V5LCBlKSwgXG4gICAgICAgIHRoaXMuX211dGF0aW9ucy5wdXNoKHIudG9NdXRhdGlvbihpLl9rZXksIEZzLmV4aXN0cyghMCkpKSwgdGhpcztcbiAgICB9XG4gICAgLyoqXG4gICAgICogRGVsZXRlcyB0aGUgZG9jdW1lbnQgcmVmZXJyZWQgdG8gYnkgdGhlIHByb3ZpZGVkIHtAbGluayBEb2N1bWVudFJlZmVyZW5jZX0uXG4gICAgICpcbiAgICAgKiBAcGFyYW0gZG9jdW1lbnRSZWYgLSBBIHJlZmVyZW5jZSB0byB0aGUgZG9jdW1lbnQgdG8gYmUgZGVsZXRlZC5cbiAgICAgKiBAcmV0dXJucyBUaGlzIGBXcml0ZUJhdGNoYCBpbnN0YW5jZS4gVXNlZCBmb3IgY2hhaW5pbmcgbWV0aG9kIGNhbGxzLlxuICAgICAqLyAgICBkZWxldGUodCkge1xuICAgICAgICB0aGlzLl92ZXJpZnlOb3RDb21taXR0ZWQoKTtcbiAgICAgICAgY29uc3QgZSA9IEJmKHQsIHRoaXMuX2ZpcmVzdG9yZSk7XG4gICAgICAgIHJldHVybiB0aGlzLl9tdXRhdGlvbnMgPSB0aGlzLl9tdXRhdGlvbnMuY29uY2F0KG5ldyBZcyhlLl9rZXksIEZzLm5vbmUoKSkpLCB0aGlzO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBDb21taXRzIGFsbCBvZiB0aGUgd3JpdGVzIGluIHRoaXMgd3JpdGUgYmF0Y2ggYXMgYSBzaW5nbGUgYXRvbWljIHVuaXQuXG4gICAgICpcbiAgICAgKiBUaGUgcmVzdWx0IG9mIHRoZXNlIHdyaXRlcyB3aWxsIG9ubHkgYmUgcmVmbGVjdGVkIGluIGRvY3VtZW50IHJlYWRzIHRoYXRcbiAgICAgKiBvY2N1ciBhZnRlciB0aGUgcmV0dXJuZWQgcHJvbWlzZSByZXNvbHZlcy4gSWYgdGhlIGNsaWVudCBpcyBvZmZsaW5lLCB0aGVcbiAgICAgKiB3cml0ZSBmYWlscy4gSWYgeW91IHdvdWxkIGxpa2UgdG8gc2VlIGxvY2FsIG1vZGlmaWNhdGlvbnMgb3IgYnVmZmVyIHdyaXRlc1xuICAgICAqIHVudGlsIHRoZSBjbGllbnQgaXMgb25saW5lLCB1c2UgdGhlIGZ1bGwgRmlyZXN0b3JlIFNESy5cbiAgICAgKlxuICAgICAqIEByZXR1cm5zIEEgYFByb21pc2VgIHJlc29sdmVkIG9uY2UgYWxsIG9mIHRoZSB3cml0ZXMgaW4gdGhlIGJhdGNoIGhhdmUgYmVlblxuICAgICAqIHN1Y2Nlc3NmdWxseSB3cml0dGVuIHRvIHRoZSBiYWNrZW5kIGFzIGFuIGF0b21pYyB1bml0IChub3RlIHRoYXQgaXQgd29uJ3RcbiAgICAgKiByZXNvbHZlIHdoaWxlIHlvdSdyZSBvZmZsaW5lKS5cbiAgICAgKi8gICAgY29tbWl0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fdmVyaWZ5Tm90Q29tbWl0dGVkKCksIHRoaXMuX2NvbW1pdHRlZCA9ICEwLCB0aGlzLl9tdXRhdGlvbnMubGVuZ3RoID4gMCA/IHRoaXMuX2NvbW1pdEhhbmRsZXIodGhpcy5fbXV0YXRpb25zKSA6IFByb21pc2UucmVzb2x2ZSgpO1xuICAgIH1cbiAgICBfdmVyaWZ5Tm90Q29tbWl0dGVkKCkge1xuICAgICAgICBpZiAodGhpcy5fY29tbWl0dGVkKSB0aHJvdyBuZXcgVShxLkZBSUxFRF9QUkVDT05ESVRJT04sIFwiQSB3cml0ZSBiYXRjaCBjYW4gbm8gbG9uZ2VyIGJlIHVzZWQgYWZ0ZXIgY29tbWl0KCkgaGFzIGJlZW4gY2FsbGVkLlwiKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIEJmKHQsIGUpIHtcbiAgICBpZiAoKHQgPSBnZXRNb2R1bGFySW5zdGFuY2UodCkpLmZpcmVzdG9yZSAhPT0gZSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIlByb3ZpZGVkIGRvY3VtZW50IHJlZmVyZW5jZSBpcyBmcm9tIGEgZGlmZmVyZW50IEZpcmVzdG9yZSBpbnN0YW5jZS5cIik7XG4gICAgcmV0dXJuIHQ7XG59XG5cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vLyBUT0RPKG1yc2NobWlkdCkgQ29uc2lkZXIgdXNpbmcgYEJhc2VUcmFuc2FjdGlvbmAgYXMgdGhlIGJhc2UgY2xhc3MgaW4gdGhlXG4vLyBsZWdhY3kgU0RLLlxuLyoqXG4gKiBBIHJlZmVyZW5jZSB0byBhIHRyYW5zYWN0aW9uLlxuICpcbiAqIFRoZSBgVHJhbnNhY3Rpb25gIG9iamVjdCBwYXNzZWQgdG8gYSB0cmFuc2FjdGlvbidzIGB1cGRhdGVGdW5jdGlvbmAgcHJvdmlkZXNcbiAqIHRoZSBtZXRob2RzIHRvIHJlYWQgYW5kIHdyaXRlIGRhdGEgd2l0aGluIHRoZSB0cmFuc2FjdGlvbiBjb250ZXh0LiBTZWVcbiAqIHtAbGluayBydW5UcmFuc2FjdGlvbn0uXG4gKi9cbi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAyMDIwIEdvb2dsZSBMTENcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG4vKipcbiAqIEEgcmVmZXJlbmNlIHRvIGEgdHJhbnNhY3Rpb24uXG4gKlxuICogVGhlIGBUcmFuc2FjdGlvbmAgb2JqZWN0IHBhc3NlZCB0byBhIHRyYW5zYWN0aW9uJ3MgYHVwZGF0ZUZ1bmN0aW9uYCBwcm92aWRlc1xuICogdGhlIG1ldGhvZHMgdG8gcmVhZCBhbmQgd3JpdGUgZGF0YSB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uIGNvbnRleHQuIFNlZVxuICoge0BsaW5rIHJ1blRyYW5zYWN0aW9ufS5cbiAqL1xuY2xhc3MgTGYgZXh0ZW5kcyBjbGFzcyB7XG4gICAgLyoqIEBoaWRlY29uc3RydWN0b3IgKi9cbiAgICBjb25zdHJ1Y3Rvcih0LCBlKSB7XG4gICAgICAgIHRoaXMuX2ZpcmVzdG9yZSA9IHQsIHRoaXMuX3RyYW5zYWN0aW9uID0gZSwgdGhpcy5fZGF0YVJlYWRlciA9IFhoKHQpO1xuICAgIH1cbiAgICAvKipcbiAgICAgKiBSZWFkcyB0aGUgZG9jdW1lbnQgcmVmZXJlbmNlZCBieSB0aGUgcHJvdmlkZWQge0BsaW5rIERvY3VtZW50UmVmZXJlbmNlfS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBkb2N1bWVudFJlZiAtIEEgcmVmZXJlbmNlIHRvIHRoZSBkb2N1bWVudCB0byBiZSByZWFkLlxuICAgICAqIEByZXR1cm5zIEEgYERvY3VtZW50U25hcHNob3RgIHdpdGggdGhlIHJlYWQgZGF0YS5cbiAgICAgKi8gICAgZ2V0KHQpIHtcbiAgICAgICAgY29uc3QgZSA9IEJmKHQsIHRoaXMuX2ZpcmVzdG9yZSksIG4gPSBuZXcgSGwodGhpcy5fZmlyZXN0b3JlKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3RyYW5zYWN0aW9uLmxvb2t1cChbIGUuX2tleSBdKS50aGVuKCh0ID0+IHtcbiAgICAgICAgICAgIGlmICghdCB8fCAxICE9PSB0Lmxlbmd0aCkgcmV0dXJuICQoKTtcbiAgICAgICAgICAgIGNvbnN0IHMgPSB0WzBdO1xuICAgICAgICAgICAgaWYgKHMuaXNGb3VuZERvY3VtZW50KCkpIHJldHVybiBuZXcgeWwodGhpcy5fZmlyZXN0b3JlLCBuLCBzLmtleSwgcywgZS5jb252ZXJ0ZXIpO1xuICAgICAgICAgICAgaWYgKHMuaXNOb0RvY3VtZW50KCkpIHJldHVybiBuZXcgeWwodGhpcy5fZmlyZXN0b3JlLCBuLCBlLl9rZXksIG51bGwsIGUuY29udmVydGVyKTtcbiAgICAgICAgICAgIHRocm93ICQoKTtcbiAgICAgICAgfSkpO1xuICAgIH1cbiAgICBzZXQodCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gQmYodCwgdGhpcy5fZmlyZXN0b3JlKSwgaSA9IFdsKHMuY29udmVydGVyLCBlLCBuKSwgciA9IFpoKHRoaXMuX2RhdGFSZWFkZXIsIFwiVHJhbnNhY3Rpb24uc2V0XCIsIHMuX2tleSwgaSwgbnVsbCAhPT0gcy5jb252ZXJ0ZXIsIG4pO1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNhY3Rpb24uc2V0KHMuX2tleSwgciksIHRoaXM7XG4gICAgfVxuICAgIHVwZGF0ZSh0LCBlLCBuLCAuLi5zKSB7XG4gICAgICAgIGNvbnN0IGkgPSBCZih0LCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICAvLyBGb3IgQ29tcGF0IHR5cGVzLCB3ZSBoYXZlIHRvIFwiZXh0cmFjdFwiIHRoZSB1bmRlcmx5aW5nIHR5cGVzIGJlZm9yZVxuICAgICAgICAvLyBwZXJmb3JtaW5nIHZhbGlkYXRpb24uXG4gICAgICAgICAgICAgICAgbGV0IHI7XG4gICAgICAgIHJldHVybiByID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgKGUgPSBnZXRNb2R1bGFySW5zdGFuY2UoZSkpIHx8IGUgaW5zdGFuY2VvZiBVaCA/IHVsKHRoaXMuX2RhdGFSZWFkZXIsIFwiVHJhbnNhY3Rpb24udXBkYXRlXCIsIGkuX2tleSwgZSwgbiwgcykgOiBvbCh0aGlzLl9kYXRhUmVhZGVyLCBcIlRyYW5zYWN0aW9uLnVwZGF0ZVwiLCBpLl9rZXksIGUpLCBcbiAgICAgICAgdGhpcy5fdHJhbnNhY3Rpb24udXBkYXRlKGkuX2tleSwgciksIHRoaXM7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIERlbGV0ZXMgdGhlIGRvY3VtZW50IHJlZmVycmVkIHRvIGJ5IHRoZSBwcm92aWRlZCB7QGxpbmsgRG9jdW1lbnRSZWZlcmVuY2V9LlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50UmVmIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGJlIGRlbGV0ZWQuXG4gICAgICogQHJldHVybnMgVGhpcyBgVHJhbnNhY3Rpb25gIGluc3RhbmNlLiBVc2VkIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHMuXG4gICAgICovICAgIGRlbGV0ZSh0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBCZih0LCB0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gdGhpcy5fdHJhbnNhY3Rpb24uZGVsZXRlKGUuX2tleSksIHRoaXM7XG4gICAgfVxufSB7XG4gICAgLy8gVGhpcyBjbGFzcyBpbXBsZW1lbnRzIHRoZSBzYW1lIGxvZ2ljIGFzIHRoZSBUcmFuc2FjdGlvbiBBUEkgaW4gdGhlIExpdGUgU0RLXG4gICAgLy8gYnV0IGlzIHN1YmNsYXNzZWQgaW4gb3JkZXIgdG8gcmV0dXJuIGl0cyBvd24gRG9jdW1lbnRTbmFwc2hvdCB0eXBlcy5cbiAgICAvKiogQGhpZGVjb25zdHJ1Y3RvciAqL1xuICAgIGNvbnN0cnVjdG9yKHQsIGUpIHtcbiAgICAgICAgc3VwZXIodCwgZSksIHRoaXMuX2ZpcmVzdG9yZSA9IHQ7XG4gICAgfVxuICAgIC8qKlxuICAgICAqIFJlYWRzIHRoZSBkb2N1bWVudCByZWZlcmVuY2VkIGJ5IHRoZSBwcm92aWRlZCB7QGxpbmsgRG9jdW1lbnRSZWZlcmVuY2V9LlxuICAgICAqXG4gICAgICogQHBhcmFtIGRvY3VtZW50UmVmIC0gQSByZWZlcmVuY2UgdG8gdGhlIGRvY3VtZW50IHRvIGJlIHJlYWQuXG4gICAgICogQHJldHVybnMgQSBgRG9jdW1lbnRTbmFwc2hvdGAgd2l0aCB0aGUgcmVhZCBkYXRhLlxuICAgICAqLyAgICBnZXQodCkge1xuICAgICAgICBjb25zdCBlID0gQmYodCwgdGhpcy5fZmlyZXN0b3JlKSwgbiA9IG5ldyBhZih0aGlzLl9maXJlc3RvcmUpO1xuICAgICAgICByZXR1cm4gc3VwZXIuZ2V0KHQpLnRoZW4oKHQgPT4gbmV3IG5mKHRoaXMuX2ZpcmVzdG9yZSwgbiwgZS5fa2V5LCB0Ll9kb2N1bWVudCwgbmV3IGVmKFxuICAgICAgICAvKiBoYXNQZW5kaW5nV3JpdGVzPSAqLyAhMSwgXG4gICAgICAgIC8qIGZyb21DYWNoZT0gKi8gITEpLCBlLmNvbnZlcnRlcikpKTtcbiAgICB9XG59XG5cbi8qKlxuICogRXhlY3V0ZXMgdGhlIGdpdmVuIGB1cGRhdGVGdW5jdGlvbmAgYW5kIHRoZW4gYXR0ZW1wdHMgdG8gY29tbWl0IHRoZSBjaGFuZ2VzXG4gKiBhcHBsaWVkIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb24uIElmIGFueSBkb2N1bWVudCByZWFkIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb25cbiAqIGhhcyBjaGFuZ2VkLCBDbG91ZCBGaXJlc3RvcmUgcmV0cmllcyB0aGUgYHVwZGF0ZUZ1bmN0aW9uYC4gSWYgaXQgZmFpbHMgdG9cbiAqIGNvbW1pdCBhZnRlciA1IGF0dGVtcHRzLCB0aGUgdHJhbnNhY3Rpb24gZmFpbHMuXG4gKlxuICogVGhlIG1heGltdW0gbnVtYmVyIG9mIHdyaXRlcyBhbGxvd2VkIGluIGEgc2luZ2xlIHRyYW5zYWN0aW9uIGlzIDUwMC5cbiAqXG4gKiBAcGFyYW0gZmlyZXN0b3JlIC0gQSByZWZlcmVuY2UgdG8gdGhlIEZpcmVzdG9yZSBkYXRhYmFzZSB0byBydW4gdGhpc1xuICogdHJhbnNhY3Rpb24gYWdhaW5zdC5cbiAqIEBwYXJhbSB1cGRhdGVGdW5jdGlvbiAtIFRoZSBmdW5jdGlvbiB0byBleGVjdXRlIHdpdGhpbiB0aGUgdHJhbnNhY3Rpb25cbiAqIGNvbnRleHQuXG4gKiBAcGFyYW0gb3B0aW9ucyAtIEFuIG9wdGlvbnMgb2JqZWN0IHRvIGNvbmZpZ3VyZSBtYXhpbXVtIG51bWJlciBvZiBhdHRlbXB0cyB0b1xuICogY29tbWl0LlxuICogQHJldHVybnMgSWYgdGhlIHRyYW5zYWN0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHkgb3Igd2FzIGV4cGxpY2l0bHkgYWJvcnRlZFxuICogKHRoZSBgdXBkYXRlRnVuY3Rpb25gIHJldHVybmVkIGEgZmFpbGVkIHByb21pc2UpLCB0aGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGVcbiAqIGB1cGRhdGVGdW5jdGlvbiBgaXMgcmV0dXJuZWQgaGVyZS4gT3RoZXJ3aXNlLCBpZiB0aGUgdHJhbnNhY3Rpb24gZmFpbGVkLCBhXG4gKiByZWplY3RlZCBwcm9taXNlIHdpdGggdGhlIGNvcnJlc3BvbmRpbmcgZmFpbHVyZSBlcnJvciBpcyByZXR1cm5lZC5cbiAqLyBmdW5jdGlvbiBxZih0LCBlLCBuKSB7XG4gICAgdCA9IG9oKHQsIEFoKTtcbiAgICBjb25zdCBzID0gT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCAkZiksIG4pO1xuICAgICFmdW5jdGlvbih0KSB7XG4gICAgICAgIGlmICh0Lm1heEF0dGVtcHRzIDwgMSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIk1heCBhdHRlbXB0cyBtdXN0IGJlIGF0IGxlYXN0IDFcIik7XG4gICAgfShzKTtcbiAgICByZXR1cm4gZnVuY3Rpb24odCwgZSwgbikge1xuICAgICAgICBjb25zdCBzID0gbmV3IEs7XG4gICAgICAgIHJldHVybiB0LmFzeW5jUXVldWUuZW5xdWV1ZUFuZEZvcmdldCgoYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaSA9IGF3YWl0IFVhKHQpO1xuICAgICAgICAgICAgbmV3IENhKHQuYXN5bmNRdWV1ZSwgaSwgbiwgZSwgcykucnVuKCk7XG4gICAgICAgIH0pKSwgcy5wcm9taXNlO1xuICAgIH0oUGgodCksIChuID0+IGUobmV3IExmKHQsIG4pKSksIHMpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMCBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuLyoqXG4gKiBSZXR1cm5zIGEgc2VudGluZWwgZm9yIHVzZSB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gb3JcbiAqIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gd2l0aCBge21lcmdlOiB0cnVlfWAgdG8gbWFyayBhIGZpZWxkIGZvciBkZWxldGlvbi5cbiAqLyBmdW5jdGlvbiBVZigpIHtcbiAgICByZXR1cm4gbmV3IHRsKFwiZGVsZXRlRmllbGRcIik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNlbnRpbmVsIHVzZWQgd2l0aCB7QGxpbmsgQGZpcmViYXNlL2ZpcmVzdG9yZS9saXRlIyhzZXREb2M6MSl9IG9yIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdG9cbiAqIGluY2x1ZGUgYSBzZXJ2ZXItZ2VuZXJhdGVkIHRpbWVzdGFtcCBpbiB0aGUgd3JpdHRlbiBkYXRhLlxuICovIGZ1bmN0aW9uIEtmKCkge1xuICAgIHJldHVybiBuZXcgbmwoXCJzZXJ2ZXJUaW1lc3RhbXBcIik7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIHVuaW9uIHRoZSBnaXZlbiBlbGVtZW50cyB3aXRoIGFueSBhcnJheVxuICogdmFsdWUgdGhhdCBhbHJlYWR5IGV4aXN0cyBvbiB0aGUgc2VydmVyLiBFYWNoIHNwZWNpZmllZCBlbGVtZW50IHRoYXQgZG9lc24ndFxuICogYWxyZWFkeSBleGlzdCBpbiB0aGUgYXJyYXkgd2lsbCBiZSBhZGRlZCB0byB0aGUgZW5kLiBJZiB0aGUgZmllbGQgYmVpbmdcbiAqIG1vZGlmaWVkIGlzIG5vdCBhbHJlYWR5IGFuIGFycmF5IGl0IHdpbGwgYmUgb3ZlcndyaXR0ZW4gd2l0aCBhbiBhcnJheVxuICogY29udGFpbmluZyBleGFjdGx5IHRoZSBzcGVjaWZpZWQgZWxlbWVudHMuXG4gKlxuICogQHBhcmFtIGVsZW1lbnRzIC0gVGhlIGVsZW1lbnRzIHRvIHVuaW9uIGludG8gdGhlIGFycmF5LlxuICogQHJldHVybnMgVGhlIGBGaWVsZFZhbHVlYCBzZW50aW5lbCBmb3IgdXNlIGluIGEgY2FsbCB0byBgc2V0RG9jKClgIG9yXG4gKiBgdXBkYXRlRG9jKClgLlxuICovIGZ1bmN0aW9uIEdmKC4uLnQpIHtcbiAgICAvLyBOT1RFOiBXZSBkb24ndCBhY3R1YWxseSBwYXJzZSB0aGUgZGF0YSB1bnRpbCBpdCdzIHVzZWQgaW4gc2V0KCkgb3JcbiAgICAvLyB1cGRhdGUoKSBzaW5jZSB3ZSdkIG5lZWQgdGhlIEZpcmVzdG9yZSBpbnN0YW5jZSB0byBkbyB0aGlzLlxuICAgIHJldHVybiBuZXcgc2woXCJhcnJheVVuaW9uXCIsIHQpO1xufVxuXG4vKipcbiAqIFJldHVybnMgYSBzcGVjaWFsIHZhbHVlIHRoYXQgY2FuIGJlIHVzZWQgd2l0aCB7QGxpbmsgKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiB1cGRhdGVEb2M6MX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIHJlbW92ZSB0aGUgZ2l2ZW4gZWxlbWVudHMgZnJvbSBhbnlcbiAqIGFycmF5IHZhbHVlIHRoYXQgYWxyZWFkeSBleGlzdHMgb24gdGhlIHNlcnZlci4gQWxsIGluc3RhbmNlcyBvZiBlYWNoIGVsZW1lbnRcbiAqIHNwZWNpZmllZCB3aWxsIGJlIHJlbW92ZWQgZnJvbSB0aGUgYXJyYXkuIElmIHRoZSBmaWVsZCBiZWluZyBtb2RpZmllZCBpcyBub3RcbiAqIGFscmVhZHkgYW4gYXJyYXkgaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiB3aXRoIGFuIGVtcHR5IGFycmF5LlxuICpcbiAqIEBwYXJhbSBlbGVtZW50cyAtIFRoZSBlbGVtZW50cyB0byByZW1vdmUgZnJvbSB0aGUgYXJyYXkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWBcbiAqLyBmdW5jdGlvbiBRZiguLi50KSB7XG4gICAgLy8gTk9URTogV2UgZG9uJ3QgYWN0dWFsbHkgcGFyc2UgdGhlIGRhdGEgdW50aWwgaXQncyB1c2VkIGluIHNldCgpIG9yXG4gICAgLy8gdXBkYXRlKCkgc2luY2Ugd2UnZCBuZWVkIHRoZSBGaXJlc3RvcmUgaW5zdGFuY2UgdG8gZG8gdGhpcy5cbiAgICByZXR1cm4gbmV3IGlsKFwiYXJyYXlSZW1vdmVcIiwgdCk7XG59XG5cbi8qKlxuICogUmV0dXJucyBhIHNwZWNpYWwgdmFsdWUgdGhhdCBjYW4gYmUgdXNlZCB3aXRoIHtAbGluayBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHNldERvYzoxKX0gb3Ige0BsaW5rXG4gKiBAZmlyZWJhc2UvZmlyZXN0b3JlL2xpdGUjKHVwZGF0ZURvYzoxKX0gdGhhdCB0ZWxscyB0aGUgc2VydmVyIHRvIGluY3JlbWVudCB0aGUgZmllbGQncyBjdXJyZW50IHZhbHVlIGJ5XG4gKiB0aGUgZ2l2ZW4gdmFsdWUuXG4gKlxuICogSWYgZWl0aGVyIHRoZSBvcGVyYW5kIG9yIHRoZSBjdXJyZW50IGZpZWxkIHZhbHVlIHVzZXMgZmxvYXRpbmcgcG9pbnRcbiAqIHByZWNpc2lvbiwgYWxsIGFyaXRobWV0aWMgZm9sbG93cyBJRUVFIDc1NCBzZW1hbnRpY3MuIElmIGJvdGggdmFsdWVzIGFyZVxuICogaW50ZWdlcnMsIHZhbHVlcyBvdXRzaWRlIG9mIEphdmFTY3JpcHQncyBzYWZlIG51bWJlciByYW5nZVxuICogKGBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUmAgdG8gYE51bWJlci5NQVhfU0FGRV9JTlRFR0VSYCkgYXJlIGFsc28gc3ViamVjdCB0b1xuICogcHJlY2lzaW9uIGxvc3MuIEZ1cnRoZXJtb3JlLCBvbmNlIHByb2Nlc3NlZCBieSB0aGUgRmlyZXN0b3JlIGJhY2tlbmQsIGFsbFxuICogaW50ZWdlciBvcGVyYXRpb25zIGFyZSBjYXBwZWQgYmV0d2VlbiAtMl42MyBhbmQgMl42My0xLlxuICpcbiAqIElmIHRoZSBjdXJyZW50IGZpZWxkIHZhbHVlIGlzIG5vdCBvZiB0eXBlIGBudW1iZXJgLCBvciBpZiB0aGUgZmllbGQgZG9lcyBub3RcbiAqIHlldCBleGlzdCwgdGhlIHRyYW5zZm9ybWF0aW9uIHNldHMgdGhlIGZpZWxkIHRvIHRoZSBnaXZlbiB2YWx1ZS5cbiAqXG4gKiBAcGFyYW0gbiAtIFRoZSB2YWx1ZSB0byBpbmNyZW1lbnQgYnkuXG4gKiBAcmV0dXJucyBUaGUgYEZpZWxkVmFsdWVgIHNlbnRpbmVsIGZvciB1c2UgaW4gYSBjYWxsIHRvIGBzZXREb2MoKWAgb3JcbiAqIGB1cGRhdGVEb2MoKWBcbiAqLyBmdW5jdGlvbiBqZih0KSB7XG4gICAgcmV0dXJuIG5ldyBybChcImluY3JlbWVudFwiLCB0KTtcbn1cblxuLyoqXG4gKiBAbGljZW5zZVxuICogQ29weXJpZ2h0IDIwMjAgR29vZ2xlIExMQ1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbi8qKlxuICogQ3JlYXRlcyBhIHdyaXRlIGJhdGNoLCB1c2VkIGZvciBwZXJmb3JtaW5nIG11bHRpcGxlIHdyaXRlcyBhcyBhIHNpbmdsZVxuICogYXRvbWljIG9wZXJhdGlvbi4gVGhlIG1heGltdW0gbnVtYmVyIG9mIHdyaXRlcyBhbGxvd2VkIGluIGEgc2luZ2xlIHtAbGluayBXcml0ZUJhdGNofVxuICogaXMgNTAwLlxuICpcbiAqIFVubGlrZSB0cmFuc2FjdGlvbnMsIHdyaXRlIGJhdGNoZXMgYXJlIHBlcnNpc3RlZCBvZmZsaW5lIGFuZCB0aGVyZWZvcmUgYXJlXG4gKiBwcmVmZXJhYmxlIHdoZW4geW91IGRvbid0IG5lZWQgdG8gY29uZGl0aW9uIHlvdXIgd3JpdGVzIG9uIHJlYWQgZGF0YS5cbiAqXG4gKiBAcmV0dXJucyBBIHtAbGluayBXcml0ZUJhdGNofSB0aGF0IGNhbiBiZSB1c2VkIHRvIGF0b21pY2FsbHkgZXhlY3V0ZSBtdWx0aXBsZVxuICogd3JpdGVzLlxuICovIGZ1bmN0aW9uIHpmKHQpIHtcbiAgICByZXR1cm4gUGgodCA9IG9oKHQsIEFoKSksIG5ldyBGZih0LCAoZSA9PiBUZih0LCBlKSkpO1xufVxuXG4vKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgMjAyMSBHb29nbGUgTExDXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqLyBmdW5jdGlvbiBXZih0LCBlKSB7XG4gICAgdmFyIG47XG4gICAgY29uc3QgcyA9IFBoKHQgPSBvaCh0LCBBaCkpO1xuICAgIGlmICghcy5fdW5pbml0aWFsaXplZENvbXBvbmVudHNQcm92aWRlciB8fCBcIm1lbW9yeVwiID09PSAobnVsbCA9PT0gKG4gPSBzLl91bmluaXRpYWxpemVkQ29tcG9uZW50c1Byb3ZpZGVyKSB8fCB2b2lkIDAgPT09IG4gPyB2b2lkIDAgOiBuLl9vZmZsaW5lS2luZCkpIFxuICAgIC8vIFBPUlRJTkcgTk9URTogV2UgZG9uJ3QgcmV0dXJuIGFuIGVycm9yIGlmIHRoZSB1c2VyIGhhcyBub3QgZW5hYmxlZFxuICAgIC8vIHBlcnNpc3RlbmNlIHNpbmNlIGBlbmFibGVJbmRleGVkZGJQZXJzaXN0ZW5jZSgpYCBjYW4gZmFpbCBvbiB0aGUgV2ViLlxuICAgIHJldHVybiBNKFwiQ2Fubm90IGVuYWJsZSBpbmRleGVzIHdoZW4gcGVyc2lzdGVuY2UgaXMgZGlzYWJsZWRcIiksIFByb21pc2UucmVzb2x2ZSgpO1xuICAgIGNvbnN0IGkgPSBmdW5jdGlvbih0KSB7XG4gICAgICAgIGNvbnN0IGUgPSBcInN0cmluZ1wiID09IHR5cGVvZiB0ID8gZnVuY3Rpb24odCkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZSh0KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKHQpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsIFwiRmFpbGVkIHRvIHBhcnNlIEpTT046IFwiICsgKG51bGwgPT0gdCA/IHZvaWQgMCA6IHQubWVzc2FnZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KHQpIDogdCwgbiA9IFtdO1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShlLmluZGV4ZXMpKSBmb3IgKGNvbnN0IHQgb2YgZS5pbmRleGVzKSB7XG4gICAgICAgICAgICBjb25zdCBlID0gSGYodCwgXCJjb2xsZWN0aW9uR3JvdXBcIiksIHMgPSBbXTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHQuZmllbGRzKSkgZm9yIChjb25zdCBlIG9mIHQuZmllbGRzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgdCA9IHdsKFwic2V0SW5kZXhDb25maWd1cmF0aW9uXCIsIEhmKGUsIFwiZmllbGRQYXRoXCIpKTtcbiAgICAgICAgICAgICAgICBcIkNPTlRBSU5TXCIgPT09IGUuYXJyYXlDb25maWcgPyBzLnB1c2gobmV3IHd0KHQsIDIgLyogSW5kZXhLaW5kLkNPTlRBSU5TICovKSkgOiBcIkFTQ0VORElOR1wiID09PSBlLm9yZGVyID8gcy5wdXNoKG5ldyB3dCh0LCAwIC8qIEluZGV4S2luZC5BU0NFTkRJTkcgKi8pKSA6IFwiREVTQ0VORElOR1wiID09PSBlLm9yZGVyICYmIHMucHVzaChuZXcgd3QodCwgMSAvKiBJbmRleEtpbmQuREVTQ0VORElORyAqLykpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbi5wdXNoKG5ldyBsdChsdC5VTktOT1dOX0lELCBlLCBzLCBndC5lbXB0eSgpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG47XG4gICAgfShlKTtcbiAgICByZXR1cm4gWmEocywgaSk7XG59XG5cbmZ1bmN0aW9uIEhmKHQsIGUpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiAhPSB0eXBlb2YgdFtlXSkgdGhyb3cgbmV3IFUocS5JTlZBTElEX0FSR1VNRU5ULCBcIk1pc3Npbmcgc3RyaW5nIHZhbHVlIGZvcjogXCIgKyBlKTtcbiAgICByZXR1cm4gdFtlXTtcbn1cblxuLyoqXG4gKiBDbG91ZCBGaXJlc3RvcmVcbiAqXG4gKiBAcGFja2FnZURvY3VtZW50YXRpb25cbiAqLyAhZnVuY3Rpb24odCwgZSA9ICEwKSB7XG4gICAgIWZ1bmN0aW9uKHQpIHtcbiAgICAgICAgUyA9IHQ7XG4gICAgfShTREtfVkVSU0lPTiksIF9yZWdpc3RlckNvbXBvbmVudChuZXcgQ29tcG9uZW50KFwiZmlyZXN0b3JlXCIsICgodCwge2luc3RhbmNlSWRlbnRpZmllcjogbiwgb3B0aW9uczogc30pID0+IHtcbiAgICAgICAgY29uc3QgaSA9IHQuZ2V0UHJvdmlkZXIoXCJhcHBcIikuZ2V0SW1tZWRpYXRlKCksIHIgPSBuZXcgQWgobmV3IHoodC5nZXRQcm92aWRlcihcImF1dGgtaW50ZXJuYWxcIikpLCBuZXcgWSh0LmdldFByb3ZpZGVyKFwiYXBwLWNoZWNrLWludGVybmFsXCIpKSwgZnVuY3Rpb24odCwgZSkge1xuICAgICAgICAgICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmFwcGx5KHQub3B0aW9ucywgWyBcInByb2plY3RJZFwiIF0pKSB0aHJvdyBuZXcgVShxLklOVkFMSURfQVJHVU1FTlQsICdcInByb2plY3RJZFwiIG5vdCBwcm92aWRlZCBpbiBmaXJlYmFzZS5pbml0aWFsaXplQXBwLicpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyAkZSh0Lm9wdGlvbnMucHJvamVjdElkLCBlKTtcbiAgICAgICAgfShpLCBuKSwgaSk7XG4gICAgICAgIHJldHVybiBzID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICB1c2VGZXRjaFN0cmVhbXM6IGVcbiAgICAgICAgfSwgcyksIHIuX3NldFNldHRpbmdzKHMpLCByO1xuICAgIH0pLCBcIlBVQkxJQ1wiKS5zZXRNdWx0aXBsZUluc3RhbmNlcyghMCkpLCByZWdpc3RlclZlcnNpb24oYiwgXCIzLjExLjBcIiwgdCksIFxuICAgIC8vIEJVSUxEX1RBUkdFVCB3aWxsIGJlIHJlcGxhY2VkIGJ5IHZhbHVlcyBsaWtlIGVzbTUsIGVzbTIwMTcsIGNqczUsIGV0YyBkdXJpbmcgdGhlIGNvbXBpbGF0aW9uXG4gICAgcmVnaXN0ZXJWZXJzaW9uKGIsIFwiMy4xMS4wXCIsIFwiZXNtMjAxN1wiKTtcbn0oKTtcblxuZXhwb3J0IHsgemwgYXMgQWJzdHJhY3RVc2VyRGF0YVdyaXRlciwgQmggYXMgQWdncmVnYXRlRmllbGQsIExoIGFzIEFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3QsIHFoIGFzIEJ5dGVzLCBFaCBhcyBDQUNIRV9TSVpFX1VOTElNSVRFRCwgZGggYXMgQ29sbGVjdGlvblJlZmVyZW5jZSwgbGggYXMgRG9jdW1lbnRSZWZlcmVuY2UsIG5mIGFzIERvY3VtZW50U25hcHNob3QsIFVoIGFzIEZpZWxkUGF0aCwgR2ggYXMgRmllbGRWYWx1ZSwgQWggYXMgRmlyZXN0b3JlLCBVIGFzIEZpcmVzdG9yZUVycm9yLCBRaCBhcyBHZW9Qb2ludCwgVGggYXMgTG9hZEJ1bmRsZVRhc2ssIGZoIGFzIFF1ZXJ5LCBibCBhcyBRdWVyeUNvbXBvc2l0ZUZpbHRlckNvbnN0cmFpbnQsIEFsIGFzIFF1ZXJ5Q29uc3RyYWludCwgc2YgYXMgUXVlcnlEb2N1bWVudFNuYXBzaG90LCBGbCBhcyBRdWVyeUVuZEF0Q29uc3RyYWludCwgdmwgYXMgUXVlcnlGaWVsZEZpbHRlckNvbnN0cmFpbnQsIHhsIGFzIFF1ZXJ5TGltaXRDb25zdHJhaW50LCBEbCBhcyBRdWVyeU9yZGVyQnlDb25zdHJhaW50LCByZiBhcyBRdWVyeVNuYXBzaG90LCBNbCBhcyBRdWVyeVN0YXJ0QXRDb25zdHJhaW50LCBlZiBhcyBTbmFwc2hvdE1ldGFkYXRhLCBpdCBhcyBUaW1lc3RhbXAsIExmIGFzIFRyYW5zYWN0aW9uLCBGZiBhcyBXcml0ZUJhdGNoLCAkZSBhcyBfRGF0YWJhc2VJZCwgaHQgYXMgX0RvY3VtZW50S2V5LCBYIGFzIF9FbXB0eUFwcENoZWNrVG9rZW5Qcm92aWRlciwgUSBhcyBfRW1wdHlBdXRoQ3JlZGVudGlhbHNQcm92aWRlciwgYXQgYXMgX0ZpZWxkUGF0aCwgY2kgYXMgX1Rlc3RpbmdIb29rcywgb2ggYXMgX2Nhc3QsIEIgYXMgX2RlYnVnQXNzZXJ0LCBiZSBhcyBfaXNCYXNlNjRBdmFpbGFibGUsIE0gYXMgX2xvZ1dhcm4sIG5oIGFzIF92YWxpZGF0ZUlzTm90VXNlZFRvZ2V0aGVyLCB5ZiBhcyBhZGREb2MsIFpsIGFzIGFnZ3JlZ2F0ZUZpZWxkRXF1YWwsIHRmIGFzIGFnZ3JlZ2F0ZVF1ZXJ5U25hcHNob3RFcXVhbCwgU2wgYXMgYW5kLCBRZiBhcyBhcnJheVJlbW92ZSwgR2YgYXMgYXJyYXlVbmlvbiwgWWwgYXMgYXZlcmFnZSwgQ2ggYXMgY2xlYXJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgX2ggYXMgY29sbGVjdGlvbiwgd2ggYXMgY29sbGVjdGlvbkdyb3VwLCBoaCBhcyBjb25uZWN0RmlyZXN0b3JlRW11bGF0b3IsIFhsIGFzIGNvdW50LCBnZiBhcyBkZWxldGVEb2MsIFVmIGFzIGRlbGV0ZUZpZWxkLCBraCBhcyBkaXNhYmxlTmV0d29yaywgbWggYXMgZG9jLCBLaCBhcyBkb2N1bWVudElkLCBWaCBhcyBlbmFibGVJbmRleGVkRGJQZXJzaXN0ZW5jZSwgU2ggYXMgZW5hYmxlTXVsdGlUYWJJbmRleGVkRGJQZXJzaXN0ZW5jZSwgTmggYXMgZW5hYmxlTmV0d29yaywgTGwgYXMgZW5kQXQsIEJsIGFzIGVuZEJlZm9yZSwgUGggYXMgZW5zdXJlRmlyZXN0b3JlQ29uZmlndXJlZCwgVGYgYXMgZXhlY3V0ZVdyaXRlLCBSZiBhcyBnZXRBZ2dyZWdhdGVGcm9tU2VydmVyLCBBZiBhcyBnZXRDb3VudEZyb21TZXJ2ZXIsIGNmIGFzIGdldERvYywgaGYgYXMgZ2V0RG9jRnJvbUNhY2hlLCBsZiBhcyBnZXREb2NGcm9tU2VydmVyLCBmZiBhcyBnZXREb2NzLCBkZiBhcyBnZXREb2NzRnJvbUNhY2hlLCBfZiBhcyBnZXREb2NzRnJvbVNlcnZlciwgdmggYXMgZ2V0RmlyZXN0b3JlLCBqZiBhcyBpbmNyZW1lbnQsIFJoIGFzIGluaXRpYWxpemVGaXJlc3RvcmUsIE5sIGFzIGxpbWl0LCBrbCBhcyBsaW1pdFRvTGFzdCwgT2ggYXMgbG9hZEJ1bmRsZSwgU2YgYXMgbWVtb3J5RWFnZXJHYXJiYWdlQ29sbGVjdG9yLCBDZiBhcyBtZW1vcnlMb2NhbENhY2hlLCBEZiBhcyBtZW1vcnlMcnVHYXJiYWdlQ29sbGVjdG9yLCAkaCBhcyBuYW1lZFF1ZXJ5LCBwZiBhcyBvblNuYXBzaG90LCBJZiBhcyBvblNuYXBzaG90c0luU3luYywgVmwgYXMgb3IsIENsIGFzIG9yZGVyQnksIHhmIGFzIHBlcnNpc3RlbnRMb2NhbENhY2hlLCBPZiBhcyBwZXJzaXN0ZW50TXVsdGlwbGVUYWJNYW5hZ2VyLCBNZiBhcyBwZXJzaXN0ZW50U2luZ2xlVGFiTWFuYWdlciwgUmwgYXMgcXVlcnksIHloIGFzIHF1ZXJ5RXF1YWwsIGdoIGFzIHJlZkVxdWFsLCBxZiBhcyBydW5UcmFuc2FjdGlvbiwgS2YgYXMgc2VydmVyVGltZXN0YW1wLCB3ZiBhcyBzZXREb2MsIFdmIGFzIHNldEluZGV4Q29uZmlndXJhdGlvbiwgeCBhcyBzZXRMb2dMZXZlbCwgdWYgYXMgc25hcHNob3RFcXVhbCwgJGwgYXMgc3RhcnRBZnRlciwgT2wgYXMgc3RhcnRBdCwgSmwgYXMgc3VtLCBNaCBhcyB0ZXJtaW5hdGUsIG1mIGFzIHVwZGF0ZURvYywgeGggYXMgd2FpdEZvclBlbmRpbmdXcml0ZXMsIFBsIGFzIHdoZXJlLCB6ZiBhcyB3cml0ZUJhdGNoIH07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5lc20yMDE3LmpzLm1hcFxuIiwiaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJmaXJlYmFzZS9hcHBcIjtcclxuaW1wb3J0IGZpcmViYXNlQ29uZmlnIGZyb20gJy4uLy4uLy4uL2ZpcmViYXNlX2NvbmZpZyc7XHJcbmltcG9ydCB7IGFkZERvYywgZGVsZXRlRG9jLCBnZXRGaXJlc3RvcmUgfSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XHJcbmltcG9ydCB7IGNvbGxlY3Rpb24sIGdldERvY3MsIGRvYywgZ2V0RG9jLCBxdWVyeSB9IGZyb20gXCJmaXJlYmFzZS9maXJlc3RvcmVcIjtcclxuaW1wb3J0IHsgUHJvamVjdCwgUHJvamVjdENvbnZlcnRlciB9IGZyb20gXCIuL1Byb2plY3RcIjtcclxuXHJcbmNvbnNvbGUubG9nKGZpcmViYXNlQ29uZmlnKTtcclxuLy8gSW5pdGlhbGl6ZSBGaXJlYmFzZVxyXG5jb25zdCBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcclxuXHJcbi8vIEluaXRpYWxpemUgQ2xvdWQgRmlyZXN0b3JlIGFuZCBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIHNlcnZpY2VcclxuY29uc3QgZGIgPSBnZXRGaXJlc3RvcmUoYXBwKTtcclxuXHJcbmNvbnN0IFByb2plY3RSZXBvc2l0b3J5ID0gKCgpID0+IHtcclxuICAgIGNvbnN0IGdldFByb2plY3RzID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGxldCBxID0gcXVlcnkoY29sbGVjdGlvbihkYiwgJ3Byb2plY3RzJykpLndpdGhDb252ZXJ0ZXIoUHJvamVjdENvbnZlcnRlcik7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgICAgICAgICAgcmV0dXJuIHByb2plY3RzLmRvY3MubWFwKGRvYyA9PiBkb2MuZGF0YSgpKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB3aGVuIHJldHJpZXZpbmcgcHJvamVjdHMgZnJvbSBkYXRhYmFzZScsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZ2V0UHJvamVjdEJ5SWQgPSBhc3luYyAoaWQpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBjb25zdCBwcm9qZWN0UmVmID0gZG9jKGRiLCAncHJvamVjdHMnLCBpZCkud2l0aENvbnZlcnRlcihQcm9qZWN0Q29udmVydGVyKTtcclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdFNuYXAgPSBhd2FpdCBnZXREb2MocHJvamVjdFJlZik7XHJcbiAgICBcclxuICAgICAgICAgICAgaWYocHJvamVjdFNuYXAuZXhpc3RzKCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9qZWN0U25hcC5kYXRhKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHdoZW4gcmV0cmlldmluZyBwcm9qZWN0IHdpdGggaWQgJHtpZH1gLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfSBcclxuICAgIFxyXG4gICAgY29uc3QgYWRkUHJvamVjdCA9IGFzeW5jIChwcm9qZWN0KSA9PiB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdFJlZiA9IGF3YWl0IGFkZERvYyhjb2xsZWN0aW9uKGRiLCAncHJvamVjdHMnKSwgcHJvamVjdCk7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm9qZWN0UmVmO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHdoZW4gYWRkaW5nIHByb2plY3QgJHt7Li4ucHJvamVjdH19YCwgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkZWxldGVQcm9qZWN0ID0gYXN5bmMgKHByb2plY3RJZCkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGV0ZURvYyhkb2MoZGIsICdwcm9qZWN0cycsIHByb2plY3RJZCkpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHdoZW4gZGVsZXRpbmcgcHJvamVjdCB3aXRoIGlkICR7cHJvamVjdElkfWAsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0UHJvamVjdHMsXHJcbiAgICAgICAgZ2V0UHJvamVjdEJ5SWQsXHJcbiAgICAgICAgYWRkUHJvamVjdCxcclxuICAgICAgICBkZWxldGVQcm9qZWN0XHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcm9qZWN0UmVwb3NpdG9yeTsiLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vUHJvamVjdFwiO1xyXG5pbXBvcnQgeyBnZXROZXh0SWQsIGdldEluZGV4RnJvbUlkIH0gZnJvbSBcIi4uL3V0aWxcIjtcclxuaW1wb3J0IFB1YlN1YiBmcm9tIFwiLi4vUHViU3ViXCI7XHJcblxyXG5cclxuY29uc3QgUHJvamVjdFJlcG9zaXRvcnlMb2NhbCA9ICgoKSA9PiB7XHJcbiAgICBjb25zdCBwcm9qZWN0cyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RzJykpIHx8IFtdO1xyXG5cclxuICAgIGNvbnN0IGdldFByb2plY3RzID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBwcm9qZWN0cztcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBnZXRQcm9qZWN0QnlJZCA9IGFzeW5jIChpZCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBwcm9qZWN0cy5maW5kKHByb2plY3QgPT4gcHJvamVjdC5pZCA9PT0gaWQpO1xyXG4gICAgICAgIHJldHVybiBwcm9qZWN0O1xyXG4gICAgfSBcclxuICAgIFxyXG4gICAgY29uc3QgYWRkUHJvamVjdCA9IGFzeW5jIChwcm9qZWN0KSA9PiB7XHJcbiAgICAgICAgY29uc3QgbmV3SWQgPSBnZXROZXh0SWQocHJvamVjdHMpO1xyXG4gICAgICAgIGNvbnN0IG5ld1Byb2plY3QgPSBuZXcgUHJvamVjdChuZXdJZCwgcHJvamVjdC5uYW1lKTtcclxuICAgICAgICBwcm9qZWN0cy5wdXNoKG5ld1Byb2plY3QpO1xyXG4gICAgICAgIHJldHVybiBuZXdQcm9qZWN0O1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGRlbGV0ZVByb2plY3QgPSBhc3luYyAocHJvamVjdElkKSA9PiB7XHJcbiAgICAgICAgcHJvamVjdHMuc3BsaWNlKGdldEluZGV4RnJvbUlkKHByb2plY3RzLCBwcm9qZWN0SWQpLCAxKTtcclxuICAgIH1cclxuXHJcbiAgICBQdWJTdWIuc3Vic2NyaWJlKCdQcm9qZWN0Q2hhbmdlZCcsICgpID0+IHtcclxuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBKU09OLnN0cmluZ2lmeShwcm9qZWN0cykpO1xyXG4gICAgfSk7XHJcbiAgICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0UHJvamVjdHMsXHJcbiAgICAgICAgZ2V0UHJvamVjdEJ5SWQsXHJcbiAgICAgICAgYWRkUHJvamVjdCxcclxuICAgICAgICBkZWxldGVQcm9qZWN0XHJcbiAgICB9XHJcbn0pKCk7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBQcm9qZWN0UmVwb3NpdG9yeUxvY2FsOyIsImltcG9ydCB7IFByb2plY3QgfSBmcm9tIFwiLi9Qcm9qZWN0XCI7XHJcbmltcG9ydCB7IGdldE5leHRJZCwgZ2V0SW5kZXhGcm9tSWQgfSBmcm9tIFwiLi4vdXRpbFwiO1xyXG5pbXBvcnQgUHViU3ViIGZyb20gXCIuLi9QdWJTdWJcIjtcclxuaW1wb3J0IFByb2plY3RSZXBvc2l0b3J5IGZyb20gXCIuL1Byb2plY3RSZXBvc2l0b3J5XCI7XHJcbmltcG9ydCBQcm9qZWN0UmVwb3NpdG9yeUxvY2FsIGZyb20gXCIuL1Byb2plY3RSZXBvc2l0b3J5TG9jYWxcIjtcclxuXHJcbmNvbnN0IHJlcG9zaXRvcnkgPSBQcm9qZWN0UmVwb3NpdG9yeUxvY2FsO1xyXG5cclxuY29uc3QgYWRkUHJvamVjdCA9IGFzeW5jIChuYW1lKSA9PiB7XHJcbiAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoJycsIG5hbWUpO1xyXG4gICAgY29uc3QgYWRkZWRQcm9qZWN0ID0gYXdhaXQgcmVwb3NpdG9yeS5hZGRQcm9qZWN0KG5ld1Byb2plY3QpO1xyXG4gICAgUHViU3ViLnB1Ymxpc2goJ1Byb2plY3RDaGFuZ2VkJyk7XHJcbiAgICByZXR1cm4gYWRkZWRQcm9qZWN0O1xyXG59XHJcblxyXG5jb25zdCBnZXRQcm9qZWN0cyA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IHByb2plY3RzID0gYXdhaXQgcmVwb3NpdG9yeS5nZXRQcm9qZWN0cygpO1xyXG4gICAgcmV0dXJuIHByb2plY3RzO1xyXG59XHJcblxyXG5jb25zdCBnZXRQcm9qZWN0QnlJZCA9IGFzeW5jIChpZCkgPT4ge1xyXG4gICAgY29uc3QgcHJvamVjdCA9IGF3YWl0IHJlcG9zaXRvcnkuZ2V0UHJvamVjdEJ5SWQoaWQpO1xyXG4gICAgcmV0dXJuIHByb2plY3Q7XHJcbn1cclxuXHJcbmNvbnN0IGRlbGV0ZVByb2plY3QgPSBhc3luYyAoaWQpID0+IHtcclxuICAgIGF3YWl0IHJlcG9zaXRvcnkuZGVsZXRlUHJvamVjdChpZCk7XHJcbiAgICBQdWJTdWIucHVibGlzaCgnUHJvamVjdENoYW5nZWQnKTtcclxufVxyXG5cclxuY29uc3QgYWRkRGVmYXVsdFByb2plY3QgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBwcm9qZWN0cyA9IGF3YWl0IGdldFByb2plY3RzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhwcm9qZWN0cyk7XHJcbiAgICBpZiAocHJvamVjdHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgYWRkUHJvamVjdCgnRGVmYXVsdCcpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuYWRkRGVmYXVsdFByb2plY3QoKTtcclxuXHJcblxyXG5leHBvcnQgeyBhZGRQcm9qZWN0LCBnZXRQcm9qZWN0cywgZ2V0UHJvamVjdEJ5SWQsIGRlbGV0ZVByb2plY3QgfSIsIlxuICAgICAgaW1wb3J0IEFQSSBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiO1xuICAgICAgaW1wb3J0IGRvbUFQSSBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0Rm4gZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRCeVNlbGVjdG9yLmpzXCI7XG4gICAgICBpbXBvcnQgc2V0QXR0cmlidXRlcyBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3NldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcy5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydFN0eWxlRWxlbWVudCBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydFN0eWxlRWxlbWVudC5qc1wiO1xuICAgICAgaW1wb3J0IHN0eWxlVGFnVHJhbnNmb3JtRm4gZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qc1wiO1xuICAgICAgaW1wb3J0IGNvbnRlbnQsICogYXMgbmFtZWRFeHBvcnQgZnJvbSBcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9Ub2RvSXRlbURldGFpbC5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL1RvZG9JdGVtRGV0YWlsLmNzc1wiO1xuICAgICAgIGV4cG9ydCBkZWZhdWx0IGNvbnRlbnQgJiYgY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHVuZGVmaW5lZDtcbiIsIlxuICAgICAgaW1wb3J0IEFQSSBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiO1xuICAgICAgaW1wb3J0IGRvbUFQSSBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0Rm4gZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRCeVNlbGVjdG9yLmpzXCI7XG4gICAgICBpbXBvcnQgc2V0QXR0cmlidXRlcyBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3NldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcy5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydFN0eWxlRWxlbWVudCBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydFN0eWxlRWxlbWVudC5qc1wiO1xuICAgICAgaW1wb3J0IHN0eWxlVGFnVHJhbnNmb3JtRm4gZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qc1wiO1xuICAgICAgaW1wb3J0IGNvbnRlbnQsICogYXMgbmFtZWRFeHBvcnQgZnJvbSBcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9DaGVja2JveC5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL0NoZWNrYm94LmNzc1wiO1xuICAgICAgIGV4cG9ydCBkZWZhdWx0IGNvbnRlbnQgJiYgY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHVuZGVmaW5lZDtcbiIsImltcG9ydCBjaGVja1N2ZyBmcm9tICcuLi8uLi9hc3NldHMvaWNvbnMvY2hlY2suc3ZnJ1xyXG5pbXBvcnQgJy4vQ2hlY2tib3guY3NzJztcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2hlY2tib3gge1xyXG4gICAgY29uc3RydWN0b3IoY2hlY2tlZCwgY2FsbGJhY2spIHtcclxuICAgICAgICB0aGlzLmNoZWNrZWQgPSBjaGVja2VkO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgICAgICB0aGlzLmNoZWNrYm94RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgdGhpcy5jaGVja2JveERpdi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbGljay5iaW5kKHRoaXMpKTtcclxuICAgICAgICB0aGlzLmNoZWNrYm94RGl2LmNsYXNzTGlzdC5hZGQoJ2NoZWNrYm94Jyk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVDaGVja01hcmsoKTtcclxuICAgICAgICByZXR1cm4gdGhpcy5jaGVja2JveERpdjtcclxuICAgIH1cclxuXHJcbiAgICB0b2dnbGUoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2hlY2tlZCkge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmNoZWNrZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnVwZGF0ZUNoZWNrTWFyaygpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUNoZWNrTWFyaygpIHtcclxuICAgICAgICBpZiAodGhpcy5jaGVja2VkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRlbXBTdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgdGVtcFN2Zy5pbm5lckhUTUwgPSBjaGVja1N2ZztcclxuICAgICAgICAgICAgdGhpcy5jaGVja2JveERpdi5hcHBlbmRDaGlsZCh0ZW1wU3ZnLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2hlY2tib3hEaXYuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xpY2soKSB7XHJcbiAgICAgICAgdGhpcy50b2dnbGUoKTtcclxuICAgICAgICB0aGlzLmNhbGxiYWNrKCk7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBhZGRMZWFkaW5nWmVyb3MobnVtYmVyLCB0YXJnZXRMZW5ndGgpIHtcbiAgdmFyIHNpZ24gPSBudW1iZXIgPCAwID8gJy0nIDogJyc7XG4gIHZhciBvdXRwdXQgPSBNYXRoLmFicyhudW1iZXIpLnRvU3RyaW5nKCk7XG5cbiAgd2hpbGUgKG91dHB1dC5sZW5ndGggPCB0YXJnZXRMZW5ndGgpIHtcbiAgICBvdXRwdXQgPSAnMCcgKyBvdXRwdXQ7XG4gIH1cblxuICByZXR1cm4gc2lnbiArIG91dHB1dDtcbn0iLCJpbXBvcnQgdG9EYXRlIGZyb20gXCIuLi90b0RhdGUvaW5kZXguanNcIjtcbmltcG9ydCBhZGRMZWFkaW5nWmVyb3MgZnJvbSBcIi4uL19saWIvYWRkTGVhZGluZ1plcm9zL2luZGV4LmpzXCI7XG5pbXBvcnQgcmVxdWlyZWRBcmdzIGZyb20gXCIuLi9fbGliL3JlcXVpcmVkQXJncy9pbmRleC5qc1wiO1xuLyoqXG4gKiBAbmFtZSBmb3JtYXRJU09cbiAqIEBjYXRlZ29yeSBDb21tb24gSGVscGVyc1xuICogQHN1bW1hcnkgRm9ybWF0IHRoZSBkYXRlIGFjY29yZGluZyB0byB0aGUgSVNPIDg2MDEgc3RhbmRhcmQgKGh0dHBzOi8vc3VwcG9ydC5zYXMuY29tL2RvY3VtZW50YXRpb24vY2RsL2VuL2xyZGljdC82NDMxNi9IVE1ML2RlZmF1bHQvdmlld2VyLmh0bSNhMDAzMTY5ODE0Lmh0bSkuXG4gKlxuICogQGRlc2NyaXB0aW9uXG4gKiBSZXR1cm4gdGhlIGZvcm1hdHRlZCBkYXRlIHN0cmluZyBpbiBJU08gODYwMSBmb3JtYXQuIE9wdGlvbnMgbWF5IGJlIHBhc3NlZCB0byBjb250cm9sIHRoZSBwYXJ0cyBhbmQgbm90YXRpb25zIG9mIHRoZSBkYXRlLlxuICpcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGUgLSB0aGUgb3JpZ2luYWwgZGF0ZVxuICogQHBhcmFtIHtPYmplY3R9IFtvcHRpb25zXSAtIGFuIG9iamVjdCB3aXRoIG9wdGlvbnMuXG4gKiBAcGFyYW0geydleHRlbmRlZCd8J2Jhc2ljJ30gW29wdGlvbnMuZm9ybWF0PSdleHRlbmRlZCddIC0gaWYgJ2Jhc2ljJywgaGlkZSBkZWxpbWl0ZXJzIGJldHdlZW4gZGF0ZSBhbmQgdGltZSB2YWx1ZXMuXG4gKiBAcGFyYW0geydjb21wbGV0ZSd8J2RhdGUnfCd0aW1lJ30gW29wdGlvbnMucmVwcmVzZW50YXRpb249J2NvbXBsZXRlJ10gLSBmb3JtYXQgZGF0ZSwgdGltZSB3aXRoIGxvY2FsIHRpbWUgem9uZSwgb3IgYm90aC5cbiAqIEByZXR1cm5zIHtTdHJpbmd9IHRoZSBmb3JtYXR0ZWQgZGF0ZSBzdHJpbmcgKGluIGxvY2FsIHRpbWUgem9uZSlcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gMSBhcmd1bWVudCByZXF1aXJlZFxuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gYGRhdGVgIG11c3Qgbm90IGJlIEludmFsaWQgRGF0ZVxuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gYG9wdGlvbnMuZm9ybWF0YCBtdXN0IGJlICdleHRlbmRlZCcgb3IgJ2Jhc2ljJ1xuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gYG9wdGlvbnMucmVwcmVzZW50YXRpb25gIG11c3QgYmUgJ2RhdGUnLCAndGltZScgb3IgJ2NvbXBsZXRlJ1xuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXByZXNlbnQgMTggU2VwdGVtYmVyIDIwMTkgaW4gSVNPIDg2MDEgZm9ybWF0IChsb2NhbCB0aW1lIHpvbmUgaXMgVVRDKTpcbiAqIGNvbnN0IHJlc3VsdCA9IGZvcm1hdElTTyhuZXcgRGF0ZSgyMDE5LCA4LCAxOCwgMTksIDAsIDUyKSlcbiAqIC8vPT4gJzIwMTktMDktMThUMTk6MDA6NTJaJ1xuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXByZXNlbnQgMTggU2VwdGVtYmVyIDIwMTkgaW4gSVNPIDg2MDEsIHNob3J0IGZvcm1hdCAobG9jYWwgdGltZSB6b25lIGlzIFVUQyk6XG4gKiBjb25zdCByZXN1bHQgPSBmb3JtYXRJU08obmV3IERhdGUoMjAxOSwgOCwgMTgsIDE5LCAwLCA1MiksIHsgZm9ybWF0OiAnYmFzaWMnIH0pXG4gKiAvLz0+ICcyMDE5MDkxOFQxOTAwNTInXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIFJlcHJlc2VudCAxOCBTZXB0ZW1iZXIgMjAxOSBpbiBJU08gODYwMSBmb3JtYXQsIGRhdGUgb25seTpcbiAqIGNvbnN0IHJlc3VsdCA9IGZvcm1hdElTTyhuZXcgRGF0ZSgyMDE5LCA4LCAxOCwgMTksIDAsIDUyKSwgeyByZXByZXNlbnRhdGlvbjogJ2RhdGUnIH0pXG4gKiAvLz0+ICcyMDE5LTA5LTE4J1xuICpcbiAqIEBleGFtcGxlXG4gKiAvLyBSZXByZXNlbnQgMTggU2VwdGVtYmVyIDIwMTkgaW4gSVNPIDg2MDEgZm9ybWF0LCB0aW1lIG9ubHkgKGxvY2FsIHRpbWUgem9uZSBpcyBVVEMpOlxuICogY29uc3QgcmVzdWx0ID0gZm9ybWF0SVNPKG5ldyBEYXRlKDIwMTksIDgsIDE4LCAxOSwgMCwgNTIpLCB7IHJlcHJlc2VudGF0aW9uOiAndGltZScgfSlcbiAqIC8vPT4gJzE5OjAwOjUyWidcbiAqL1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBmb3JtYXRJU08oZGF0ZSwgb3B0aW9ucykge1xuICB2YXIgX29wdGlvbnMkZm9ybWF0LCBfb3B0aW9ucyRyZXByZXNlbnRhdGk7XG5cbiAgcmVxdWlyZWRBcmdzKDEsIGFyZ3VtZW50cyk7XG4gIHZhciBvcmlnaW5hbERhdGUgPSB0b0RhdGUoZGF0ZSk7XG5cbiAgaWYgKGlzTmFOKG9yaWdpbmFsRGF0ZS5nZXRUaW1lKCkpKSB7XG4gICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoJ0ludmFsaWQgdGltZSB2YWx1ZScpO1xuICB9XG5cbiAgdmFyIGZvcm1hdCA9IFN0cmluZygoX29wdGlvbnMkZm9ybWF0ID0gb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLmZvcm1hdCkgIT09IG51bGwgJiYgX29wdGlvbnMkZm9ybWF0ICE9PSB2b2lkIDAgPyBfb3B0aW9ucyRmb3JtYXQgOiAnZXh0ZW5kZWQnKTtcbiAgdmFyIHJlcHJlc2VudGF0aW9uID0gU3RyaW5nKChfb3B0aW9ucyRyZXByZXNlbnRhdGkgPSBvcHRpb25zID09PSBudWxsIHx8IG9wdGlvbnMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG9wdGlvbnMucmVwcmVzZW50YXRpb24pICE9PSBudWxsICYmIF9vcHRpb25zJHJlcHJlc2VudGF0aSAhPT0gdm9pZCAwID8gX29wdGlvbnMkcmVwcmVzZW50YXRpIDogJ2NvbXBsZXRlJyk7XG5cbiAgaWYgKGZvcm1hdCAhPT0gJ2V4dGVuZGVkJyAmJiBmb3JtYXQgIT09ICdiYXNpYycpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcImZvcm1hdCBtdXN0IGJlICdleHRlbmRlZCcgb3IgJ2Jhc2ljJ1wiKTtcbiAgfVxuXG4gIGlmIChyZXByZXNlbnRhdGlvbiAhPT0gJ2RhdGUnICYmIHJlcHJlc2VudGF0aW9uICE9PSAndGltZScgJiYgcmVwcmVzZW50YXRpb24gIT09ICdjb21wbGV0ZScpIHtcbiAgICB0aHJvdyBuZXcgUmFuZ2VFcnJvcihcInJlcHJlc2VudGF0aW9uIG11c3QgYmUgJ2RhdGUnLCAndGltZScsIG9yICdjb21wbGV0ZSdcIik7XG4gIH1cblxuICB2YXIgcmVzdWx0ID0gJyc7XG4gIHZhciB0ek9mZnNldCA9ICcnO1xuICB2YXIgZGF0ZURlbGltaXRlciA9IGZvcm1hdCA9PT0gJ2V4dGVuZGVkJyA/ICctJyA6ICcnO1xuICB2YXIgdGltZURlbGltaXRlciA9IGZvcm1hdCA9PT0gJ2V4dGVuZGVkJyA/ICc6JyA6ICcnOyAvLyBSZXByZXNlbnRhdGlvbiBpcyBlaXRoZXIgJ2RhdGUnIG9yICdjb21wbGV0ZSdcblxuICBpZiAocmVwcmVzZW50YXRpb24gIT09ICd0aW1lJykge1xuICAgIHZhciBkYXkgPSBhZGRMZWFkaW5nWmVyb3Mob3JpZ2luYWxEYXRlLmdldERhdGUoKSwgMik7XG4gICAgdmFyIG1vbnRoID0gYWRkTGVhZGluZ1plcm9zKG9yaWdpbmFsRGF0ZS5nZXRNb250aCgpICsgMSwgMik7XG4gICAgdmFyIHllYXIgPSBhZGRMZWFkaW5nWmVyb3Mob3JpZ2luYWxEYXRlLmdldEZ1bGxZZWFyKCksIDQpOyAvLyB5eXl5TU1kZCBvciB5eXl5LU1NLWRkLlxuXG4gICAgcmVzdWx0ID0gXCJcIi5jb25jYXQoeWVhcikuY29uY2F0KGRhdGVEZWxpbWl0ZXIpLmNvbmNhdChtb250aCkuY29uY2F0KGRhdGVEZWxpbWl0ZXIpLmNvbmNhdChkYXkpO1xuICB9IC8vIFJlcHJlc2VudGF0aW9uIGlzIGVpdGhlciAndGltZScgb3IgJ2NvbXBsZXRlJ1xuXG5cbiAgaWYgKHJlcHJlc2VudGF0aW9uICE9PSAnZGF0ZScpIHtcbiAgICAvLyBBZGQgdGhlIHRpbWV6b25lLlxuICAgIHZhciBvZmZzZXQgPSBvcmlnaW5hbERhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKTtcblxuICAgIGlmIChvZmZzZXQgIT09IDApIHtcbiAgICAgIHZhciBhYnNvbHV0ZU9mZnNldCA9IE1hdGguYWJzKG9mZnNldCk7XG4gICAgICB2YXIgaG91ck9mZnNldCA9IGFkZExlYWRpbmdaZXJvcyhNYXRoLmZsb29yKGFic29sdXRlT2Zmc2V0IC8gNjApLCAyKTtcbiAgICAgIHZhciBtaW51dGVPZmZzZXQgPSBhZGRMZWFkaW5nWmVyb3MoYWJzb2x1dGVPZmZzZXQgJSA2MCwgMik7IC8vIElmIGxlc3MgdGhhbiAwLCB0aGUgc2lnbiBpcyArLCBiZWNhdXNlIGl0IGlzIGFoZWFkIG9mIHRpbWUuXG5cbiAgICAgIHZhciBzaWduID0gb2Zmc2V0IDwgMCA/ICcrJyA6ICctJztcbiAgICAgIHR6T2Zmc2V0ID0gXCJcIi5jb25jYXQoc2lnbikuY29uY2F0KGhvdXJPZmZzZXQsIFwiOlwiKS5jb25jYXQobWludXRlT2Zmc2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdHpPZmZzZXQgPSAnWic7XG4gICAgfVxuXG4gICAgdmFyIGhvdXIgPSBhZGRMZWFkaW5nWmVyb3Mob3JpZ2luYWxEYXRlLmdldEhvdXJzKCksIDIpO1xuICAgIHZhciBtaW51dGUgPSBhZGRMZWFkaW5nWmVyb3Mob3JpZ2luYWxEYXRlLmdldE1pbnV0ZXMoKSwgMik7XG4gICAgdmFyIHNlY29uZCA9IGFkZExlYWRpbmdaZXJvcyhvcmlnaW5hbERhdGUuZ2V0U2Vjb25kcygpLCAyKTsgLy8gSWYgdGhlcmUncyBhbHNvIGRhdGUsIHNlcGFyYXRlIGl0IHdpdGggdGltZSB3aXRoICdUJ1xuXG4gICAgdmFyIHNlcGFyYXRvciA9IHJlc3VsdCA9PT0gJycgPyAnJyA6ICdUJzsgLy8gQ3JlYXRlcyBhIHRpbWUgc3RyaW5nIGNvbnNpc3Rpbmcgb2YgaG91ciwgbWludXRlLCBhbmQgc2Vjb25kLCBzZXBhcmF0ZWQgYnkgZGVsaW1pdGVycywgaWYgZGVmaW5lZC5cblxuICAgIHZhciB0aW1lID0gW2hvdXIsIG1pbnV0ZSwgc2Vjb25kXS5qb2luKHRpbWVEZWxpbWl0ZXIpOyAvLyBISG1tc3Mgb3IgSEg6bW06c3MuXG5cbiAgICByZXN1bHQgPSBcIlwiLmNvbmNhdChyZXN1bHQpLmNvbmNhdChzZXBhcmF0b3IpLmNvbmNhdCh0aW1lKS5jb25jYXQodHpPZmZzZXQpO1xuICB9XG5cbiAgcmV0dXJuIHJlc3VsdDtcbn0iLCJpbXBvcnQgeyBkZWxldGVUb2RvSXRlbSwgZ2V0VG9kb0l0ZW1CeUlkLCB1cGRhdGVUb2RvSXRlbSB9IGZyb20gXCIuL1RvZG9JdGVtQ29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBnZXRQcm9qZWN0QnlJZCwgZ2V0UHJvamVjdHMgfSBmcm9tIFwiLi4vUHJvamVjdC9Qcm9qZWN0Q29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IFRvZG9JdGVtIH0gZnJvbSBcIi4vVG9kb0l0ZW1cIjtcclxuaW1wb3J0ICcuL1RvZG9JdGVtRGV0YWlsLmNzcyc7XHJcbmltcG9ydCBQdWJTdWIgZnJvbSBcIi4uL1B1YlN1YlwiO1xyXG5pbXBvcnQgQ2hlY2tib3ggZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvQ2hlY2tib3hcIjtcclxuaW1wb3J0IGZvcm1hdElTTyBmcm9tICdkYXRlLWZucy9mb3JtYXRJU08nXHJcbmNsYXNzIFRvZG9JdGVtRGV0YWlsIHtcclxuICAgIGFzeW5jIHJlbmRlcihpZCkge1xyXG4gICAgICAgIHRoaXMudG9kb0l0ZW0gPSBhd2FpdCBnZXRUb2RvSXRlbUJ5SWQoaWQpO1xyXG4gICAgICAgIGlmICghdGhpcy50b2RvSXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBhd2FpdCBnZXRQcm9qZWN0QnlJZCh0aGlzLnRvZG9JdGVtLnByb2plY3RJZCk7XHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW1EaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0b2RvSXRlbURpdi5jbGFzc0xpc3QuYWRkKCd0b2RvLWl0ZW0tY29udGFpbmVyJyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICAgICAgICB0b2RvSXRlbUhlYWRlci50ZXh0Q29udGVudCA9IHRoaXMudG9kb0l0ZW0udGl0bGU7XHJcbiAgICBcclxuICAgICAgICBjb25zdCB0b2RvSXRlbUNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuY2xhc3NMaXN0LmFkZCgndG9kb0l0ZW1Db250ZW50Jyk7XHJcblxyXG4gICAgICAgIGNvbnN0IHByb2plY3RTcGFuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIHByb2plY3RTcGFuLnRleHRDb250ZW50ID0gJ1Byb2plY3Q6ICc7XHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKHByb2plY3RTcGFuKTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvamVjdExpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgcHJvamVjdExpbmsuaHJlZiA9ICcjJztcclxuICAgICAgICBwcm9qZWN0TGluay50ZXh0Q29udGVudCA9IHByb2plY3QubmFtZTtcclxuICAgICAgICBwcm9qZWN0TGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgcHVibGlzaExpbmsoJ1Byb2plY3REZXRhaWwnLCBwcm9qZWN0LmlkKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHByb2plY3RTcGFuLmFwcGVuZENoaWxkKHByb2plY3RMaW5rKTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvamVjdFNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NlbGVjdCcpO1xyXG4gICAgICAgIHByb2plY3RTZWxlY3QubmFtZSA9ICdwcm9qZWN0JztcclxuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IGF3YWl0IGdldFByb2plY3RzKCk7XHJcbiAgICAgICAgZm9yIChsZXQgcHJvamVjdCBvZiBwcm9qZWN0cylcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICAgICAgICAgcHJvamVjdE9wdGlvbi5uYW1lID0gJ3Byb2plY3QnO1xyXG4gICAgICAgICAgICBwcm9qZWN0T3B0aW9uLnZhbHVlID0gcHJvamVjdC5pZDtcclxuICAgICAgICAgICAgcHJvamVjdE9wdGlvbi50ZXh0ID0gcHJvamVjdC5uYW1lO1xyXG4gICAgICAgICAgICBwcm9qZWN0U2VsZWN0LmFwcGVuZENoaWxkKHByb2plY3RPcHRpb24pO1xyXG4gICAgICAgICAgICBpZiAocHJvamVjdC5pZCA9PT0gdGhpcy50b2RvSXRlbS5wcm9qZWN0SWQpIHtcclxuICAgICAgICAgICAgICAgIHByb2plY3RPcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHByb2plY3RTZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2RvSXRlbS5wcm9qZWN0SWQgPSBOdW1iZXIoZS50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLm9uSXRlbUNoYW5nZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKHByb2plY3RTZWxlY3QpO1xyXG5cclxuICAgICAgICBjb25zdCBwcmlvcml0eUxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcclxuICAgICAgICBwcmlvcml0eUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3ByaW9yaXR5Jyk7XHJcbiAgICAgICAgcHJpb3JpdHlMYWJlbC50ZXh0Q29udGVudCA9ICdQcmlvcml0eSc7XHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKHByaW9yaXR5TGFiZWwpO1xyXG4gICAgICAgIGNvbnN0IHByaW9yaXR5U2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jyk7XHJcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QucmVxdWlyZWQgPSB0cnVlO1xyXG4gICAgICAgIHByaW9yaXR5U2VsZWN0Lm5hbWUgPSAncHJpb3JpdHknO1xyXG4gICAgICAgIHByaW9yaXR5U2VsZWN0LmlkID0gJ3ByaW9yaXR5JztcclxuICAgICAgICBmb3IgKGNvbnN0IHByaW9yaXR5IG9mIE9iamVjdC5rZXlzKFRvZG9JdGVtLnByaW9yaXRpZXMpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByaW9yaXR5TnVtID0gTnVtYmVyKHByaW9yaXR5KTtcclxuICAgICAgICAgICAgY29uc3QgcHJpb3JpdHlPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICAgICAgICAgcHJpb3JpdHlPcHRpb24ubmFtZSA9ICdwcmlvcml0eSc7XHJcbiAgICAgICAgICAgIHByaW9yaXR5T3B0aW9uLnZhbHVlID0gcHJpb3JpdHlOdW07XHJcbiAgICAgICAgICAgIHByaW9yaXR5T3B0aW9uLnRleHQgPSBUb2RvSXRlbS5wcmlvcml0aWVzW3ByaW9yaXR5TnVtXTtcclxuICAgICAgICAgICAgaWYgKHByaW9yaXR5TnVtID09PSB0aGlzLnRvZG9JdGVtLnByaW9yaXR5KSB7XHJcbiAgICAgICAgICAgICAgICBwcmlvcml0eU9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcHJpb3JpdHlTZWxlY3QuYXBwZW5kQ2hpbGQocHJpb3JpdHlPcHRpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBwcmlvcml0eVNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRvZG9JdGVtLnByaW9yaXR5ID0gTnVtYmVyKGUudGFyZ2V0LnZhbHVlKTtcclxuICAgICAgICAgICAgdGhpcy5vbkl0ZW1DaGFuZ2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChwcmlvcml0eVNlbGVjdCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xyXG4gICAgICAgIGRlc2NyaXB0aW9uTGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAnZGVzY3JpcHRpb24nKTtcclxuICAgICAgICBkZXNjcmlwdGlvbkxhYmVsLnRleHRDb250ZW50ID0gJ0Rlc2NyaXB0aW9uJztcclxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICBkZXNjcmlwdGlvbklucHV0LnZhbHVlID0gdGhpcy50b2RvSXRlbS5kZXNjcmlwdGlvbjtcclxuICAgICAgICBkZXNjcmlwdGlvbklucHV0Lm5hbWUgPSAnZGVzY3JpcHRpb24nO1xyXG4gICAgICAgIGRlc2NyaXB0aW9uSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2RvSXRlbS5kZXNjcmlwdGlvbiA9IGUudGFyZ2V0LnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLm9uSXRlbUNoYW5nZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChkZXNjcmlwdGlvbkxhYmVsKTtcclxuICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQoZGVzY3JpcHRpb25JbnB1dCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGR1ZURhdGVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XHJcbiAgICAgICAgZHVlRGF0ZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2R1ZURhdGUnKTtcclxuICAgICAgICBkdWVEYXRlTGFiZWwudGV4dENvbnRlbnQgPSAnRHVlIERhdGUnO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChkdWVEYXRlTGFiZWwpO1xyXG4gICAgICAgIGNvbnN0IGR1ZURhdGVTZWxlY3RvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgZHVlRGF0ZVNlbGVjdG9yLnR5cGUgPSAnZGF0ZSc7XHJcbiAgICAgICAgZHVlRGF0ZVNlbGVjdG9yLm5hbWUgPSAnZHVlRGF0ZSc7XHJcbiAgICAgICAgZHVlRGF0ZVNlbGVjdG9yLnZhbHVlID0gZm9ybWF0SVNPKHRoaXMudG9kb0l0ZW0uZHVlRGF0ZSwge3JlcHJlc2VudGF0aW9uOiAnZGF0ZSd9KTtcclxuICAgICAgICBkdWVEYXRlU2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2RvSXRlbS5kdWVEYXRlID0gbmV3IERhdGUoZS50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICB0aGlzLm9uSXRlbUNoYW5nZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChkdWVEYXRlU2VsZWN0b3IpO1xyXG5cclxuICAgICAgICBjb25zdCBpc0NvbXBsZXRlU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcclxuICAgICAgICBpc0NvbXBsZXRlU3Bhbi50ZXh0Q29udGVudCA9ICdJcyBjb21wbGV0ZWQnO1xyXG4gICAgICAgIGNvbnN0IGlzQ29tcGxldGVDaGVja2JveCA9IG5ldyBDaGVja2JveCh0aGlzLnRvZG9JdGVtLmlzQ29tcGxldGUsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2RvSXRlbS5pc0NvbXBsZXRlID0gIXRoaXMudG9kb0l0ZW0uaXNDb21wbGV0ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5vbkl0ZW1DaGFuZ2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChpc0NvbXBsZXRlU3Bhbik7XHJcbiAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKGlzQ29tcGxldGVDaGVja2JveCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi50ZXh0Q29udGVudCA9ICdEZWxldGUnO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdkZWxldGUtdG9kb2l0ZW0tYnV0dG9uJyk7XHJcbiAgICAgICAgZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgYXdhaXQgZGVsZXRlVG9kb0l0ZW0odGhpcy50b2RvSXRlbS5pZCk7XHJcbiAgICAgICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdjaGFuZ2VQYWdlJywge3BhZ2U6ICdQcm9qZWN0RGV0YWlsJywgZGF0YTogcHJvamVjdC5pZH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvZG9JdGVtQ29udGVudC5hcHBlbmRDaGlsZChkZWxldGVCdXR0b24pO1xyXG4gICAgICAgIFxyXG4gICAgXHJcbiAgICAgICAgdG9kb0l0ZW1EaXYuYXBwZW5kQ2hpbGQodG9kb0l0ZW1IZWFkZXIpO1xyXG4gICAgICAgIHRvZG9JdGVtRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtQ29udGVudCk7XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gdG9kb0l0ZW1EaXY7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25JdGVtQ2hhbmdlKCkge1xyXG4gICAgICAgIGF3YWl0IHVwZGF0ZVRvZG9JdGVtKHRoaXMudG9kb0l0ZW0pO1xyXG4gICAgICAgIHB1Ymxpc2hMaW5rKCdUb2RvSXRlbURldGFpbCcsIHRoaXMudG9kb0l0ZW0uaWQpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgVG9kb0l0ZW1EZXRhaWwoKTsiLCJcbiAgICAgIGltcG9ydCBBUEkgZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIjtcbiAgICAgIGltcG9ydCBkb21BUEkgZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZURvbUFQSS5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydEZuIGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0QnlTZWxlY3Rvci5qc1wiO1xuICAgICAgaW1wb3J0IHNldEF0dHJpYnV0ZXMgZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXMuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRTdHlsZUVsZW1lbnQgZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRTdHlsZUVsZW1lbnQuanNcIjtcbiAgICAgIGltcG9ydCBzdHlsZVRhZ1RyYW5zZm9ybUZuIGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVUYWdUcmFuc2Zvcm0uanNcIjtcbiAgICAgIGltcG9ydCBjb250ZW50LCAqIGFzIG5hbWVkRXhwb3J0IGZyb20gXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vQWRkQ29tcG9uZW50LmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vQWRkQ29tcG9uZW50LmNzc1wiO1xuICAgICAgIGV4cG9ydCBkZWZhdWx0IGNvbnRlbnQgJiYgY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHVuZGVmaW5lZDtcbiIsImltcG9ydCAnLi9BZGRDb21wb25lbnQuY3NzJztcclxuaW1wb3J0IGFkZEljb25TdmcgZnJvbSAnLi4vLi4vYXNzZXRzL2ljb25zL3BsdXMuc3ZnJztcclxuaW1wb3J0IGNoZXZyb25TdmcgZnJvbSAnLi4vLi4vYXNzZXRzL2ljb25zL2NoZXZyb24tZG93bi5zdmcnO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gJy4uL21vZHVsZXMvdXRpbCc7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFkZENvbXBvbmVudCB7XHJcbiAgICBsaW5rcyA9IFtcclxuICAgICAgICB7bmFtZTogJ0FkZCBUb2RvIEl0ZW0nLCBsaW5rOiAnQWRkVG9kb0l0ZW0nfSxcclxuICAgICAgICB7bmFtZTogJ0FkZCBQcm9qZWN0JywgbGluazogJ0FkZFByb2plY3QnfVxyXG4gICAgXVxyXG4gICAgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IGFkZENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGFkZENvbnRhaW5lci5jbGFzc05hbWUgPSAnYWRkLWNvbnRhaW5lcic7XHJcblxyXG4gICAgICAgIGNvbnN0IGljb25Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBpY29uQ29udGFpbmVyLmNsYXNzTmFtZSA9ICdpY29uLWNvbnRhaW5lcic7XHJcbiAgICAgICAgY29uc3QgYWRkSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2knKTtcclxuICAgICAgICBhZGRJY29uLmlubmVySFRNTCA9IGFkZEljb25Tdmc7XHJcbiAgICAgICAgYWRkSWNvbi5jbGFzc05hbWUgPSAnYWRkLWljb24nO1xyXG5cclxuICAgICAgICBjb25zdCBjaGV2cm9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaScpO1xyXG4gICAgICAgIGNoZXZyb24uaW5uZXJIVE1MID0gY2hldnJvblN2ZztcclxuICAgICAgICBjaGV2cm9uLmNsYXNzTmFtZSA9ICdjaGV2cm9uLWljb24nO1xyXG5cclxuICAgICAgICBpY29uQ29udGFpbmVyLmFwcGVuZENoaWxkKGFkZEljb24pO1xyXG4gICAgICAgIGljb25Db250YWluZXIuYXBwZW5kQ2hpbGQoY2hldnJvbik7XHJcbiAgICAgICAgYWRkQ29udGFpbmVyLmFwcGVuZENoaWxkKGljb25Db250YWluZXIpO1xyXG5cclxuICAgICAgICBjb25zdCBkcm9wZG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGRyb3Bkb3duLmNsYXNzTmFtZSA9ICdhZGQtZHJvcGRvd24nO1xyXG4gICAgICAgIGRyb3Bkb3duLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcblxyXG4gICAgICAgIGNvbnN0IGRyb3Bkb3duTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XHJcbiAgICAgICAgZHJvcGRvd25MaXN0LmNsYXNzTmFtZSA9ICdhZGQtZHJvcGRvd24tbGlzdCc7XHJcbiAgICAgICAgZm9yIChsZXQgbGluayBvZiB0aGlzLmxpbmtzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRyb3Bkb3duTGlzdEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0SXRlbUxpbmsgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgICAgIGxpc3RJdGVtTGluay5ocmVmID0gJyc7XHJcbiAgICAgICAgICAgIGxpc3RJdGVtTGluay50ZXh0ID0gbGluay5uYW1lO1xyXG4gICAgICAgICAgICBsaXN0SXRlbUxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgcHVibGlzaExpbmsobGluay5saW5rKTtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIH0pXHJcblxyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIGRyb3Bkb3duTGlzdEl0ZW0uYXBwZW5kQ2hpbGQobGlzdEl0ZW1MaW5rKTtcclxuICAgICAgICAgICAgZHJvcGRvd25MaXN0LmFwcGVuZENoaWxkKGRyb3Bkb3duTGlzdEl0ZW0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZHJvcGRvd24uYXBwZW5kQ2hpbGQoZHJvcGRvd25MaXN0KTtcclxuXHJcbiAgICAgICAgY29uc3Qgb3V0c2lkZUNsaWNrTGlzdGVuZXIgPSBlID0+IHtcclxuICAgICAgICAgICAgaWYoIWFkZENvbnRhaW5lci5jb250YWlucyhlLnRhcmdldCkgJiYgZHJvcGRvd24uc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKSB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG91dHNpZGVDbGlja0xpc3RlbmVyKTtcclxuICAgICAgICBcclxuICAgICAgICBpY29uQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKGRyb3Bkb3duLnN0eWxlLmRpc3BsYXkgPT09ICdub25lJykge1xyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24uc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFkZENvbnRhaW5lci5hcHBlbmRDaGlsZChkcm9wZG93bik7XHJcblxyXG4gICAgICAgIHJldHVybiBhZGRDb250YWluZXI7XHJcbiAgICB9XHJcbn0iLCJcbiAgICAgIGltcG9ydCBBUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIjtcbiAgICAgIGltcG9ydCBkb21BUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZURvbUFQSS5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydEZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0QnlTZWxlY3Rvci5qc1wiO1xuICAgICAgaW1wb3J0IHNldEF0dHJpYnV0ZXMgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXMuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRTdHlsZUVsZW1lbnQgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRTdHlsZUVsZW1lbnQuanNcIjtcbiAgICAgIGltcG9ydCBzdHlsZVRhZ1RyYW5zZm9ybUZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVUYWdUcmFuc2Zvcm0uanNcIjtcbiAgICAgIGltcG9ydCBjb250ZW50LCAqIGFzIG5hbWVkRXhwb3J0IGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vaGVhZGVyLmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vaGVhZGVyLmNzc1wiO1xuICAgICAgIGV4cG9ydCBkZWZhdWx0IGNvbnRlbnQgJiYgY29udGVudC5sb2NhbHMgPyBjb250ZW50LmxvY2FscyA6IHVuZGVmaW5lZDtcbiIsImltcG9ydCBBZGRDb21wb25lbnQgZnJvbSBcIi4uLy4uL2NvbXBvbmVudHMvQWRkQ29tcG9uZW50XCI7XHJcbmltcG9ydCBQdWJTdWIgZnJvbSBcIi4uL1B1YlN1YlwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCBsb2dvSWNvblN2ZyBmcm9tICcuLi8uLi8uLi9hc3NldHMvaWNvbnMvY2xpcGJvYXJkLWxpc3Qtb3V0bGluZS5zdmcnO1xyXG5pbXBvcnQgJy4vaGVhZGVyLmNzcyc7XHJcbmltcG9ydCB7IGdldFRvZG9JdGVtcyB9IGZyb20gXCIuLi9Ub2RvSXRlbS9Ub2RvSXRlbUNvbnRyb2xsZXJcIjtcclxuXHJcbmNsYXNzIEhlYWRlciB7XHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaGVhZGVyJyk7XHJcbiAgICAgICAgY29uc3QgbG9nb0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIGxvZ29Db250YWluZXIuY2xhc3NOYW1lID0gJ2xvZ28tY29udGFpbmVyJztcclxuXHJcbiAgICAgICAgY29uc3QgbG9nb0ljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XHJcbiAgICAgICAgbG9nb0ljb24uY2xhc3NOYW1lID0gJ2xvZ28taWNvbic7XHJcbiAgICAgICAgbG9nb0ljb24uaW5uZXJIVE1MID0gbG9nb0ljb25Tdmc7XHJcbiAgICAgICAgbG9nb0NvbnRhaW5lci5hcHBlbmRDaGlsZChsb2dvSWNvbik7XHJcblxyXG4gICAgICAgIGNvbnN0IGxvZ29UZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgIGxvZ29UZXh0LnRleHRDb250ZW50ID0gJ09kaW4gVG9kby1MaXN0JztcclxuICAgICAgICBsb2dvVGV4dC5jbGFzc05hbWUgPSAnbG9nby10ZXh0JztcclxuICAgICAgICBsb2dvQ29udGFpbmVyLmFwcGVuZENoaWxkKGxvZ29UZXh0KTtcclxuXHJcbiAgICAgICAgbG9nb0NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdUb2RvSXRlbUxpc3QnLCB7dGl0bGU6J0FsbCBpdGVtcycsIGNhbGxiYWNrOmdldFRvZG9JdGVtc30pO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgaGVhZGVyLmFwcGVuZENoaWxkKGxvZ29Db250YWluZXIpO1xyXG5cclxuICAgICAgICBjb25zdCBidXR0b25zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgYnV0dG9uc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdidXR0b25zLWNvbnRhaW5lcicpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGRDb21wb25lbnQgPSBuZXcgQWRkQ29tcG9uZW50KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYnV0dG9uc0NvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRDb21wb25lbnQucmVuZGVyKCkpO1xyXG4gICAgICAgIGhlYWRlci5hcHBlbmRDaGlsZChidXR0b25zQ29udGFpbmVyKTtcclxuICAgICAgICByZXR1cm4gaGVhZGVyO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSGVhZGVyTGlua0NsaWNrKGUsIG5ld1BhZ2UpIHtcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgUHViU3ViLnB1Ymxpc2goJ2NoYW5nZVBhZ2UnLCB7cGFnZTogbmV3UGFnZS5wYWdlfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IG5ldyBIZWFkZXIoKTsiLCJpbXBvcnQgeyBnZXRUb2RvSXRlbXMgfSBmcm9tIFwiLi9Ub2RvSXRlbS9Ub2RvSXRlbUNvbnRyb2xsZXJcIjtcclxuXHJcbmNsYXNzIFByb2plY3RUb2RvSXRlbU1lZGlhdG9yIHtcclxuICAgIGFzeW5jIGdldFRvZG9JdGVtc0ZvclByb2plY3QocHJvamVjdElkKSB7XHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW1zID0gYXdhaXQgZ2V0VG9kb0l0ZW1zKCk7XHJcbiAgICAgICAgcmV0dXJuIHRvZG9JdGVtcy5maWx0ZXIoaXRlbSA9PiBpdGVtLnByb2plY3RJZCA9PT0gcHJvamVjdElkKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IFByb2plY3RUb2RvSXRlbU1lZGlhdG9yKCk7XHJcblxyXG4iLCJcbiAgICAgIGltcG9ydCBBUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIjtcbiAgICAgIGltcG9ydCBkb21BUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZURvbUFQSS5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydEZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0QnlTZWxlY3Rvci5qc1wiO1xuICAgICAgaW1wb3J0IHNldEF0dHJpYnV0ZXMgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXMuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRTdHlsZUVsZW1lbnQgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRTdHlsZUVsZW1lbnQuanNcIjtcbiAgICAgIGltcG9ydCBzdHlsZVRhZ1RyYW5zZm9ybUZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVUYWdUcmFuc2Zvcm0uanNcIjtcbiAgICAgIGltcG9ydCBjb250ZW50LCAqIGFzIG5hbWVkRXhwb3J0IGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vc2lkZWJhci5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi8uLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL3NpZGViYXIuY3NzXCI7XG4gICAgICAgZXhwb3J0IGRlZmF1bHQgY29udGVudCAmJiBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDogdW5kZWZpbmVkO1xuIiwiXG4gICAgICBpbXBvcnQgQVBJIGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCI7XG4gICAgICBpbXBvcnQgZG9tQVBJIGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVEb21BUEkuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRGbiBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydEJ5U2VsZWN0b3IuanNcIjtcbiAgICAgIGltcG9ydCBzZXRBdHRyaWJ1dGVzIGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc2V0QXR0cmlidXRlc1dpdGhvdXRBdHRyaWJ1dGVzLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0U3R5bGVFbGVtZW50IGZyb20gXCIhLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0U3R5bGVFbGVtZW50LmpzXCI7XG4gICAgICBpbXBvcnQgc3R5bGVUYWdUcmFuc2Zvcm1GbiBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlVGFnVHJhbnNmb3JtLmpzXCI7XG4gICAgICBpbXBvcnQgY29udGVudCwgKiBhcyBuYW1lZEV4cG9ydCBmcm9tIFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL1NpZGViYXJMaW5rSXRlbS5jc3NcIjtcbiAgICAgIFxuICAgICAgXG5cbnZhciBvcHRpb25zID0ge307XG5cbm9wdGlvbnMuc3R5bGVUYWdUcmFuc2Zvcm0gPSBzdHlsZVRhZ1RyYW5zZm9ybUZuO1xub3B0aW9ucy5zZXRBdHRyaWJ1dGVzID0gc2V0QXR0cmlidXRlcztcblxuICAgICAgb3B0aW9ucy5pbnNlcnQgPSBpbnNlcnRGbi5iaW5kKG51bGwsIFwiaGVhZFwiKTtcbiAgICBcbm9wdGlvbnMuZG9tQVBJID0gZG9tQVBJO1xub3B0aW9ucy5pbnNlcnRTdHlsZUVsZW1lbnQgPSBpbnNlcnRTdHlsZUVsZW1lbnQ7XG5cbnZhciB1cGRhdGUgPSBBUEkoY29udGVudCwgb3B0aW9ucyk7XG5cblxuXG5leHBvcnQgKiBmcm9tIFwiISEuLi8uLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL1NpZGViYXJMaW5rSXRlbS5jc3NcIjtcbiAgICAgICBleHBvcnQgZGVmYXVsdCBjb250ZW50ICYmIGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB1bmRlZmluZWQ7XG4iLCJpbXBvcnQgUHViU3ViIGZyb20gXCIuLi9tb2R1bGVzL1B1YlN1YlwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi9tb2R1bGVzL3V0aWxcIjtcclxuaW1wb3J0ICcuL1NpZGViYXJMaW5rSXRlbS5jc3MnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2lkZWJhckxpbmtJdGVtIHtcclxuICAgIGNvbnN0cnVjdG9yKHRpdGxlLCBjYWxsYmFjaywgaWNvbiwgcHJvamVjdElkKSB7XHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcclxuICAgICAgICB0aGlzLmljb24gPSBpY29uO1xyXG4gICAgICAgIHRoaXMucHJvamVjdElkID0gcHJvamVjdElkO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJlbmRlcigpIHtcclxuICAgICAgICBjb25zdCBsaW5rSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgbGlua0l0ZW0uY2xhc3NOYW1lID0gJ3NpZGViYXItbGluay1pdGVtJztcclxuXHJcbiAgICAgICAgY29uc3QgbGlua0EgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgICAgICAgbGlua0EuaHJlZiA9ICcjJztcclxuXHJcbiAgICAgICAgY29uc3QgbGlua1RleHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgbGlua1RleHQudGV4dENvbnRlbnQgPSB0aGlzLnRpdGxlO1xyXG5cclxuICAgICAgICBpZih0aGlzLmljb24pIHtcclxuICAgICAgICAgICAgY29uc3QgbGlua0ljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpJyk7XHJcbiAgICAgICAgICAgIGxpbmtJY29uLmlubmVySFRNTCA9IHRoaXMuaWNvbjtcclxuICAgICAgICAgICAgbGlua0EuYXBwZW5kQ2hpbGQobGlua0ljb24pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgbGlua0l0ZW1OdW1iZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgbGlua0l0ZW1OdW1iZXIuY2xhc3NOYW1lID0gJ3NpZGViYXItbGluay1pdGVtLW51bWJlcic7XHJcbiAgICAgICAgY29uc3QgaXRlbXMgPSBhd2FpdCB0aGlzLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgbGlua0l0ZW1OdW1iZXIudGV4dENvbnRlbnQgPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiAhaXRlbS5pc0NvbXBsZXRlKS5sZW5ndGg7XHJcblxyXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ1RvZG9JdGVtc0NoYW5nZWQnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgdGhpcy5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgICBsaW5rSXRlbU51bWJlci50ZXh0Q29udGVudCA9IGl0ZW1zLmZpbHRlcihpdGVtID0+ICFpdGVtLmlzQ29tcGxldGUpLmxlbmd0aDtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGlua0EuYXBwZW5kKGxpbmtUZXh0LCBsaW5rSXRlbU51bWJlcik7XHJcbiAgICAgICAgbGlua0l0ZW0uYXBwZW5kQ2hpbGQobGlua0EpO1xyXG4gICAgICAgIGxpbmtJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wcm9qZWN0SWQpIHtcclxuICAgICAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdQcm9qZWN0RGV0YWlsJywgdGhpcy5wcm9qZWN0SWQpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcHVibGlzaExpbmsoJ1RvZG9JdGVtTGlzdCcsIHt0aXRsZTp0aGlzLnRpdGxlLCBjYWxsYmFjazp0aGlzLmNhbGxiYWNrfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIGxpbmtJdGVtO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgZ2V0UHJvamVjdHMgfSBmcm9tICcuLi9Qcm9qZWN0L1Byb2plY3RDb250cm9sbGVyJztcclxuaW1wb3J0IHsgZ2V0VG9kb0l0ZW1zLCBnZXRUb2RvSXRlbXNUb2RheSwgZ2V0VG9kb0l0ZW1zVXBjb21pbmcgfSBmcm9tICcuLi9Ub2RvSXRlbS9Ub2RvSXRlbUNvbnRyb2xsZXInO1xyXG5pbXBvcnQgUHJvamVjdFRvZG9JdGVtTWVkaWF0b3IgZnJvbSBcIi4uL1Byb2plY3RUb2RvSXRlbU1lZGlhdG9yXCI7XHJcbmltcG9ydCAnLi9zaWRlYmFyLmNzcyc7XHJcbmltcG9ydCBQdWJTdWIgZnJvbSAnLi4vUHViU3ViJztcclxuaW1wb3J0IFNpZGViYXJMaW5rSXRlbSBmcm9tICcuLi8uLi9jb21wb25lbnRzL1NpZGViYXJMaW5rSXRlbSc7XHJcbmltcG9ydCBhbGxTdmcgZnJvbSAnLi4vLi4vLi4vYXNzZXRzL2ljb25zL2xpc3QtYm94LnN2Zyc7XHJcbmltcG9ydCB0b2RheVN2ZyBmcm9tICcuLi8uLi8uLi9hc3NldHMvaWNvbnMvY2FsZW5kYXItYmxhbmsuc3ZnJztcclxuaW1wb3J0IHVwY29taW5nU3ZnIGZyb20gJy4uLy4uLy4uL2Fzc2V0cy9pY29ucy9jYWxlbmRhci1jbG9jay5zdmcnO1xyXG5cclxuY2xhc3MgU2lkZWJhciB7XHJcbiAgICBtYWluTGlua3MgPSBbXHJcbiAgICAgICAgeyd0aXRsZSc6J0FsbCBpdGVtcycsJ2NhbGxiYWNrJzpnZXRUb2RvSXRlbXMsJ2ljb24nOmFsbFN2Z30sXHJcbiAgICAgICAgeyd0aXRsZSc6J1RvZGF5JywnY2FsbGJhY2snOmdldFRvZG9JdGVtc1RvZGF5LCAnaWNvbic6dG9kYXlTdmd9LFxyXG4gICAgICAgIHsndGl0bGUnOidVcGNvbWluZycsJ2NhbGxiYWNrJzpnZXRUb2RvSXRlbXNVcGNvbWluZywgJ2ljb24nOnVwY29taW5nU3ZnfVxyXG4gICAgXVxyXG4gICAgYXN5bmMgcmVuZGVyKCkge1xyXG4gICAgICAgIGNvbnN0IHNpZGViYXJEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBzaWRlYmFyRGl2LmNsYXNzTmFtZSA9ICdzaWRlYmFyJztcclxuXHJcbiAgICAgICAgY29uc3QgbWFpbkxpbmtzTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XHJcbiAgICAgICAgbWFpbkxpbmtzTGlzdC5jbGFzc05hbWUgPSAnc2lkZWJhci1saW5rLWxpc3QnO1xyXG4gICAgICAgIGZvciAobGV0IGxpbmsgb2YgdGhpcy5tYWluTGlua3MpIHtcclxuICAgICAgICAgICAgY29uc3QgbWFpbkxpbmtJdGVtID0gYXdhaXQgbmV3IFNpZGViYXJMaW5rSXRlbShsaW5rLnRpdGxlLCBsaW5rLmNhbGxiYWNrLCBsaW5rLmljb24gfHwgbnVsbCkucmVuZGVyKCk7XHJcbiAgICAgICAgICAgIG1haW5MaW5rc0xpc3QuYXBwZW5kQ2hpbGQobWFpbkxpbmtJdGVtKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHByb2plY3RMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcclxuICAgICAgICBwcm9qZWN0TGlzdC5jbGFzc05hbWUgPSAnc2lkZWJhci1saW5rLWxpc3QnXHJcbiAgICAgICAgdGhpcy5jcmVhdGVQcm9qZWN0TGlzdChwcm9qZWN0TGlzdCk7XHJcblxyXG4gICAgICAgIFB1YlN1Yi5zdWJzY3JpYmUoJ1Byb2plY3RDaGFuZ2VkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBwcm9qZWN0TGlzdC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVQcm9qZWN0TGlzdChwcm9qZWN0TGlzdCk7XHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgc2lkZWJhckRpdi5hcHBlbmRDaGlsZChtYWluTGlua3NMaXN0KTtcclxuICAgICAgICBzaWRlYmFyRGl2LmFwcGVuZENoaWxkKHByb2plY3RMaXN0KTtcclxuICAgICAgICByZXR1cm4gc2lkZWJhckRpdjtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVQcm9qZWN0TGlzdChwcm9qZWN0TGlzdCkge1xyXG5cclxuICAgICAgICBjb25zdCBwcm9qZWN0TGlzdEhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgICAgICAgcHJvamVjdExpc3RIZWFkZXIuY2xhc3NMaXN0LmFkZCgnc2lkZWJhci1saW5rLWxpc3QtaGVhZGVyJywgJ3NpZGViYXItbGluay1pdGVtJyk7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdExpc3RIZWFkZXJMaW5rID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xyXG4gICAgICAgIHByb2plY3RMaXN0SGVhZGVyTGluay5ocmVmID0gJyMnO1xyXG4gICAgICAgIHByb2plY3RMaXN0SGVhZGVyTGluay50ZXh0ID0gJ1Byb2plY3RzJztcclxuICAgICAgICBwcm9qZWN0TGlzdEhlYWRlci5hcHBlbmRDaGlsZChwcm9qZWN0TGlzdEhlYWRlckxpbmspO1xyXG4gICAgICAgIHByb2plY3RMaXN0LmFwcGVuZENoaWxkKHByb2plY3RMaXN0SGVhZGVyKTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRQcm9qZWN0TGlua3MocHJvamVjdExpc3QpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGFkZFByb2plY3RMaW5rcyhwYXJlbnQpIHtcclxuICAgICAgICBjb25zdCBwcm9qZWN0cyA9IGF3YWl0IGdldFByb2plY3RzKCk7XHJcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdHMpO1xyXG4gICAgICAgIGZvciAobGV0IHByb2plY3Qgb2YgcHJvamVjdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcHJvamVjdEl0ZW0gPSBhd2FpdCBuZXcgU2lkZWJhckxpbmtJdGVtKFxyXG4gICAgICAgICAgICAgICAgcHJvamVjdC5uYW1lLCBcclxuICAgICAgICAgICAgICAgICgpID0+IFByb2plY3RUb2RvSXRlbU1lZGlhdG9yLmdldFRvZG9JdGVtc0ZvclByb2plY3QocHJvamVjdC5pZCksXHJcbiAgICAgICAgICAgICAgICBudWxsLFxyXG4gICAgICAgICAgICAgICAgcHJvamVjdC5pZClcclxuICAgICAgICAgICAgICAgIC5yZW5kZXIoKTtcclxuICAgICAgICAgICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChwcm9qZWN0SXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgU2lkZWJhcigpOyIsIlxuICAgICAgaW1wb3J0IEFQSSBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiO1xuICAgICAgaW1wb3J0IGRvbUFQSSBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0Rm4gZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRCeVNlbGVjdG9yLmpzXCI7XG4gICAgICBpbXBvcnQgc2V0QXR0cmlidXRlcyBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3NldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcy5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydFN0eWxlRWxlbWVudCBmcm9tIFwiIS4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydFN0eWxlRWxlbWVudC5qc1wiO1xuICAgICAgaW1wb3J0IHN0eWxlVGFnVHJhbnNmb3JtRm4gZnJvbSBcIiEuLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qc1wiO1xuICAgICAgaW1wb3J0IGNvbnRlbnQsICogYXMgbmFtZWRFeHBvcnQgZnJvbSBcIiEhLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9Ub2RvSXRlbXNMaXN0LmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vVG9kb0l0ZW1zTGlzdC5jc3NcIjtcbiAgICAgICBleHBvcnQgZGVmYXVsdCBjb250ZW50ICYmIGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB1bmRlZmluZWQ7XG4iLCJpbXBvcnQgdG9EYXRlIGZyb20gXCIuLi90b0RhdGUvaW5kZXguanNcIjtcbmltcG9ydCByZXF1aXJlZEFyZ3MgZnJvbSBcIi4uL19saWIvcmVxdWlyZWRBcmdzL2luZGV4LmpzXCI7XG4vKipcbiAqIEBuYW1lIGlzQmVmb3JlXG4gKiBAY2F0ZWdvcnkgQ29tbW9uIEhlbHBlcnNcbiAqIEBzdW1tYXJ5IElzIHRoZSBmaXJzdCBkYXRlIGJlZm9yZSB0aGUgc2Vjb25kIG9uZT9cbiAqXG4gKiBAZGVzY3JpcHRpb25cbiAqIElzIHRoZSBmaXJzdCBkYXRlIGJlZm9yZSB0aGUgc2Vjb25kIG9uZT9cbiAqXG4gKiBAcGFyYW0ge0RhdGV8TnVtYmVyfSBkYXRlIC0gdGhlIGRhdGUgdGhhdCBzaG91bGQgYmUgYmVmb3JlIHRoZSBvdGhlciBvbmUgdG8gcmV0dXJuIHRydWVcbiAqIEBwYXJhbSB7RGF0ZXxOdW1iZXJ9IGRhdGVUb0NvbXBhcmUgLSB0aGUgZGF0ZSB0byBjb21wYXJlIHdpdGhcbiAqIEByZXR1cm5zIHtCb29sZWFufSB0aGUgZmlyc3QgZGF0ZSBpcyBiZWZvcmUgdGhlIHNlY29uZCBkYXRlXG4gKiBAdGhyb3dzIHtUeXBlRXJyb3J9IDIgYXJndW1lbnRzIHJlcXVpcmVkXG4gKlxuICogQGV4YW1wbGVcbiAqIC8vIElzIDEwIEp1bHkgMTk4OSBiZWZvcmUgMTEgRmVicnVhcnkgMTk4Nz9cbiAqIGNvbnN0IHJlc3VsdCA9IGlzQmVmb3JlKG5ldyBEYXRlKDE5ODksIDYsIDEwKSwgbmV3IERhdGUoMTk4NywgMSwgMTEpKVxuICogLy89PiBmYWxzZVxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGlzQmVmb3JlKGRpcnR5RGF0ZSwgZGlydHlEYXRlVG9Db21wYXJlKSB7XG4gIHJlcXVpcmVkQXJncygyLCBhcmd1bWVudHMpO1xuICB2YXIgZGF0ZSA9IHRvRGF0ZShkaXJ0eURhdGUpO1xuICB2YXIgZGF0ZVRvQ29tcGFyZSA9IHRvRGF0ZShkaXJ0eURhdGVUb0NvbXBhcmUpO1xuICByZXR1cm4gZGF0ZS5nZXRUaW1lKCkgPCBkYXRlVG9Db21wYXJlLmdldFRpbWUoKTtcbn0iLCJpbXBvcnQgeyB1cGRhdGVUb2RvSXRlbSB9IGZyb20gXCIuLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi9tb2R1bGVzL3V0aWxcIjtcclxuaW1wb3J0ICcuL1RvZG9JdGVtc0xpc3QuY3NzJztcclxuaW1wb3J0IENoZWNrYm94IGZyb20gXCIuL0NoZWNrYm94XCI7XHJcbmltcG9ydCBmb3JtYXRJU08gZnJvbSBcImRhdGUtZm5zL2Zvcm1hdElTT1wiO1xyXG5pbXBvcnQgeyBpc0JlZm9yZSB9IGZyb20gXCJkYXRlLWZuc1wiO1xyXG5pbXBvcnQgeyBUb2RvSXRlbSB9IGZyb20gXCIuLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtXCI7XHJcblxyXG5jbGFzcyBUb2RvSXRlbXNMaXN0IHtcclxuICAgIGNvbnN0cnVjdG9yKHRvZG9JdGVtcykge1xyXG4gICAgICAgIHRoaXMudG9kb0l0ZW1zID0gdG9kb0l0ZW1zO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBpZiAoIXRoaXMudG9kb0l0ZW1zKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMudG9kb0l0ZW1zTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3VsJyk7XHJcbiAgICAgICAgdGhpcy50b2RvSXRlbXNMaXN0LmNsYXNzTmFtZSA9ICd0b2RvLWl0ZW1zLWxpc3QnO1xyXG4gICAgICAgIHRoaXMucmVuZGVyTGlzdEl0ZW1zKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRoaXMudG9kb0l0ZW1zTGlzdDtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJMaXN0SXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy50b2RvSXRlbXMuc29ydCgoaXRlbTEsIGl0ZW0yKSA9PiB7XHJcbiAgICAgICAgICAgIC8qIFNvcnRzIGJhc2VkIG9uIGNoZWNrZWQgc3RhdHVzLiBJZiB0aGUgaXRlbSBpc24ndCBjaGVja2VkLCBzb3J0c1xyXG4gICAgICAgICAgICBieSBwcmlvcml0eSB0aGVuIGRhdGUuIElmIHRoZSBpdGVtIGlzIGNoZWNrZWQsIHNvcnRzIG9ubHkgYnkgZGF0ZSAqL1xyXG4gICAgICAgICAgICBpZiAoaXRlbTEuaXNDb21wbGV0ZSA9PT0gaXRlbTIuaXNDb21wbGV0ZSAmJiBpdGVtMS5pc0NvbXBsZXRlID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0xLnByaW9yaXR5ID09PSBpdGVtMi5wcmlvcml0eSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChpc0JlZm9yZShpdGVtMS5kdWVEYXRlLCBpdGVtMi5kdWVEYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtMS5wcmlvcml0eSAtIGl0ZW0yLnByaW9yaXR5O1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGl0ZW0xLmlzQ29tcGxldGUgPT09IGl0ZW0yLmlzQ29tcGxldGUgJiYgaXRlbTEuaXNDb21wbGV0ZSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGlzQmVmb3JlKGl0ZW0xLmR1ZURhdGUsIGl0ZW0yLmR1ZURhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoaXRlbTEuaXNDb21wbGV0ZSAmJiAhaXRlbTIuaXNDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgdG9kb0l0ZW0gb2YgdGhpcy50b2RvSXRlbXMpIHtcclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1zTGlzdEl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpO1xyXG4gICAgICAgICAgICBpZiAodG9kb0l0ZW0uaXNDb21wbGV0ZSkge1xyXG4gICAgICAgICAgICAgICAgdG9kb0l0ZW1zTGlzdEl0ZW0uY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrQm94ID0gbmV3IENoZWNrYm94KHRvZG9JdGVtLmlzQ29tcGxldGUsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRvZG9JdGVtLmlzQ29tcGxldGUgPSAhdG9kb0l0ZW0uaXNDb21wbGV0ZTtcclxuICAgICAgICAgICAgICAgIHVwZGF0ZVRvZG9JdGVtKHRvZG9JdGVtKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9kb0l0ZW1zTGlzdC5pbm5lckhUTUwgPSAnJztcclxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyTGlzdEl0ZW1zKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjaGVja0JveC5jbGFzc0xpc3QuYWRkKGAke1RvZG9JdGVtLnByaW9yaXRpZXNbdG9kb0l0ZW0ucHJpb3JpdHldLnRvTG93ZXJDYXNlKCl9YCk7XHJcblxyXG4gICAgICAgICAgICB0b2RvSXRlbXNMaXN0SXRlbS5hcHBlbmRDaGlsZChjaGVja0JveCk7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvZG9JdGVtQ29udGVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUNvbnRlbnQuY2xhc3NOYW1lID0gJ3RvZG8taXRlbXMtbGlzdC1pdGVtLWNvbnRlbnQnO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgdG9kb0l0ZW1OYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xyXG4gICAgICAgICAgICB0b2RvSXRlbU5hbWUudGV4dENvbnRlbnQgPSB0b2RvSXRlbS50aXRsZTtcclxuICAgICAgICAgICAgdG9kb0l0ZW1Db250ZW50LmFwcGVuZENoaWxkKHRvZG9JdGVtTmFtZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCB0b2RvSXRlbUR1ZURhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgICAgICAgICAgIHRvZG9JdGVtRHVlRGF0ZS50ZXh0Q29udGVudCA9IGZvcm1hdElTTyh0b2RvSXRlbS5kdWVEYXRlLCB7cmVwcmVzZW50YXRpb246ICdkYXRlJ30pO1xyXG4gICAgICAgICAgICB0b2RvSXRlbUNvbnRlbnQuYXBwZW5kQ2hpbGQodG9kb0l0ZW1EdWVEYXRlKTtcclxuXHJcbiAgICAgICAgICAgIHRvZG9JdGVtc0xpc3RJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldCA9PT0gdG9kb0l0ZW1zTGlzdEl0ZW0gfHwgdG9kb0l0ZW1Db250ZW50LmNvbnRhaW5zKGUudGFyZ2V0KSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdUb2RvSXRlbURldGFpbCcsIHRvZG9JdGVtLmlkKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIHRvZG9JdGVtc0xpc3RJdGVtLmFwcGVuZENoaWxkKHRvZG9JdGVtQ29udGVudCk7XHJcbiAgICAgICAgICAgIHRoaXMudG9kb0l0ZW1zTGlzdC5hcHBlbmRDaGlsZCh0b2RvSXRlbXNMaXN0SXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBUb2RvSXRlbXNMaXN0OyIsIlxuICAgICAgaW1wb3J0IEFQSSBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luamVjdFN0eWxlc0ludG9TdHlsZVRhZy5qc1wiO1xuICAgICAgaW1wb3J0IGRvbUFQSSBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlRG9tQVBJLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0Rm4gZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRCeVNlbGVjdG9yLmpzXCI7XG4gICAgICBpbXBvcnQgc2V0QXR0cmlidXRlcyBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3NldEF0dHJpYnV0ZXNXaXRob3V0QXR0cmlidXRlcy5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydFN0eWxlRWxlbWVudCBmcm9tIFwiIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydFN0eWxlRWxlbWVudC5qc1wiO1xuICAgICAgaW1wb3J0IHN0eWxlVGFnVHJhbnNmb3JtRm4gZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZVRhZ1RyYW5zZm9ybS5qc1wiO1xuICAgICAgaW1wb3J0IGNvbnRlbnQsICogYXMgbmFtZWRFeHBvcnQgZnJvbSBcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9Qcm9qZWN0RGV0YWlsLmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vUHJvamVjdERldGFpbC5jc3NcIjtcbiAgICAgICBleHBvcnQgZGVmYXVsdCBjb250ZW50ICYmIGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB1bmRlZmluZWQ7XG4iLCJpbXBvcnQgVG9kb0l0ZW1zTGlzdCBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9Ub2RvSXRlbXNMaXN0XCI7XHJcbmltcG9ydCBQcm9qZWN0VG9kb0l0ZW1NZWRpYXRvciBmcm9tIFwiLi4vUHJvamVjdFRvZG9JdGVtTWVkaWF0b3JcIjtcclxuaW1wb3J0IHsgZ2V0VG9kb0l0ZW1zIH0gZnJvbSBcIi4uL1RvZG9JdGVtL1RvZG9JdGVtQ29udHJvbGxlclwiO1xyXG5pbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IGRlbGV0ZVByb2plY3QsIGdldFByb2plY3RCeUlkLCBnZXRQcm9qZWN0cyB9IGZyb20gXCIuL1Byb2plY3RDb250cm9sbGVyXCI7XHJcbmltcG9ydCAnLi9Qcm9qZWN0RGV0YWlsLmNzcyc7XHJcblxyXG5jbGFzcyBQcm9qZWN0RGV0YWlsIHtcclxuICAgIGFzeW5jIHJlbmRlcihpZCkge1xyXG4gICAgICAgIGNvbnN0IHByb2plY3QgPSBhd2FpdCBnZXRQcm9qZWN0QnlJZChpZCk7XHJcbiAgICAgICAgY29uc3QgdG9kb0l0ZW1zID0gYXdhaXQgUHJvamVjdFRvZG9JdGVtTWVkaWF0b3IuZ2V0VG9kb0l0ZW1zRm9yUHJvamVjdChwcm9qZWN0LmlkKTtcclxuXHJcbiAgICAgICAgY29uc3QgcHJvamVjdERldGFpbERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG4gICAgICAgIHByb2plY3REZXRhaWxEaXYuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1kZXRhaWwnKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBwcm9qZWN0RGV0YWlsSGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICAgICAgICBwcm9qZWN0RGV0YWlsSGVhZGVyLnRleHRDb250ZW50ID0gcHJvamVjdC5uYW1lIHx8ICdQcm9qZWN0IERldGFpbHMnO1xyXG4gICAgICAgIHByb2plY3REZXRhaWxEaXYuYXBwZW5kQ2hpbGQocHJvamVjdERldGFpbEhlYWRlcik7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHRvZG9JdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgY29uc3QgZW1wdHlUb2RvSXRlbXNUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gICAgICAgICAgICBlbXB0eVRvZG9JdGVtc1RleHQudGV4dENvbnRlbnQgPSAnVGhlcmUgYXJlIGN1cnJlbnRseSBubyBpdGVtcyBpbiB0aGlzIHByb2plY3QuJztcclxuICAgICAgICAgICAgcHJvamVjdERldGFpbERpdi5hcHBlbmRDaGlsZChlbXB0eVRvZG9JdGVtc1RleHQpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvZG9JdGVtc0xpc3QgPSBuZXcgVG9kb0l0ZW1zTGlzdCh0b2RvSXRlbXMpO1xyXG4gICAgICAgICAgICBwcm9qZWN0RGV0YWlsRGl2LmFwcGVuZENoaWxkKHRvZG9JdGVtc0xpc3QucmVuZGVyKCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBkZWxldGVCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBkZWxldGVCdXR0b24udGV4dENvbnRlbnQgPSAnRGVsZXRlIFByb2plY3QnO1xyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdkZWxldGUtcHJvamVjdC1idXR0b24nKTtcclxuXHJcbiAgICAgICAgaWYgKHByb2plY3QubmFtZSA9PT0gJ0RlZmF1bHQnIHx8IGF3YWl0IGdldFByb2plY3RzKCkubGVuZ3RoIDw9IDEpIHtcclxuICAgICAgICAgICAgZGVsZXRlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGF3YWl0IGRlbGV0ZVByb2plY3QocHJvamVjdC5pZCk7XHJcbiAgICAgICAgICAgIHB1Ymxpc2hMaW5rKCdUb2RvSXRlbUxpc3QnLCB7dGl0bGU6J0FsbCBpdGVtcycsIGNhbGxiYWNrOmdldFRvZG9JdGVtc30pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHByb2plY3REZXRhaWxEaXYuYXBwZW5kQ2hpbGQoZGVsZXRlQnV0dG9uKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcHJvamVjdERldGFpbERpdjtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IFByb2plY3REZXRhaWwoKTsiLCJcbiAgICAgIGltcG9ydCBBUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbmplY3RTdHlsZXNJbnRvU3R5bGVUYWcuanNcIjtcbiAgICAgIGltcG9ydCBkb21BUEkgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zdHlsZURvbUFQSS5qc1wiO1xuICAgICAgaW1wb3J0IGluc2VydEZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0QnlTZWxlY3Rvci5qc1wiO1xuICAgICAgaW1wb3J0IHNldEF0dHJpYnV0ZXMgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9zZXRBdHRyaWJ1dGVzV2l0aG91dEF0dHJpYnV0ZXMuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRTdHlsZUVsZW1lbnQgZnJvbSBcIiEuLi8uLi8uLi9ub2RlX21vZHVsZXMvc3R5bGUtbG9hZGVyL2Rpc3QvcnVudGltZS9pbnNlcnRTdHlsZUVsZW1lbnQuanNcIjtcbiAgICAgIGltcG9ydCBzdHlsZVRhZ1RyYW5zZm9ybUZuIGZyb20gXCIhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVUYWdUcmFuc2Zvcm0uanNcIjtcbiAgICAgIGltcG9ydCBjb250ZW50LCAqIGFzIG5hbWVkRXhwb3J0IGZyb20gXCIhIS4uLy4uLy4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vQWRkVG9kb0l0ZW0uY3NzXCI7XG4gICAgICBcbiAgICAgIFxuXG52YXIgb3B0aW9ucyA9IHt9O1xuXG5vcHRpb25zLnN0eWxlVGFnVHJhbnNmb3JtID0gc3R5bGVUYWdUcmFuc2Zvcm1Gbjtcbm9wdGlvbnMuc2V0QXR0cmlidXRlcyA9IHNldEF0dHJpYnV0ZXM7XG5cbiAgICAgIG9wdGlvbnMuaW5zZXJ0ID0gaW5zZXJ0Rm4uYmluZChudWxsLCBcImhlYWRcIik7XG4gICAgXG5vcHRpb25zLmRvbUFQSSA9IGRvbUFQSTtcbm9wdGlvbnMuaW5zZXJ0U3R5bGVFbGVtZW50ID0gaW5zZXJ0U3R5bGVFbGVtZW50O1xuXG52YXIgdXBkYXRlID0gQVBJKGNvbnRlbnQsIG9wdGlvbnMpO1xuXG5cblxuZXhwb3J0ICogZnJvbSBcIiEhLi4vLi4vLi4vbm9kZV9tb2R1bGVzL2Nzcy1sb2FkZXIvZGlzdC9janMuanMhLi9BZGRUb2RvSXRlbS5jc3NcIjtcbiAgICAgICBleHBvcnQgZGVmYXVsdCBjb250ZW50ICYmIGNvbnRlbnQubG9jYWxzID8gY29udGVudC5sb2NhbHMgOiB1bmRlZmluZWQ7XG4iLCJpbXBvcnQgeyBnZXRQcm9qZWN0cyB9IGZyb20gXCIuLi9Qcm9qZWN0L1Byb2plY3RDb250cm9sbGVyXCI7XHJcbmltcG9ydCAnLi9BZGRUb2RvSXRlbS5jc3MnO1xyXG5pbXBvcnQgeyBUb2RvSXRlbSB9IGZyb20gXCIuL1RvZG9JdGVtXCI7XHJcbmltcG9ydCB7IGFkZFRvZG9JdGVtIH0gZnJvbSBcIi4vVG9kb0l0ZW1Db250cm9sbGVyXCI7XHJcblxyXG5jbGFzcyBBZGRUb2RvSXRlbSB7XHJcbiAgICBhc3luYyByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgcHJvamVjdHMgPSBhd2FpdCBnZXRQcm9qZWN0cygpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGRUb2RvSXRlbUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgICAgICBjb25zdCBhZGRUb2RvSXRlbUhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2gyJyk7XHJcbiAgICAgICAgYWRkVG9kb0l0ZW1IZWFkZXIudGV4dENvbnRlbnQgPSAnQWRkIFRvZG8gSXRlbSc7XHJcblxyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtRm9ybSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcclxuICAgICAgICB0b2RvSXRlbUZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5vbkZvcm1TdWJtaXQpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG5hbWVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XHJcbiAgICAgICAgbmFtZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ3RpdGxlJyk7XHJcbiAgICAgICAgbmFtZUxhYmVsLnRleHRDb250ZW50ID0gJ1RpdGxlJztcclxuICAgICAgICB0b2RvSXRlbUZvcm0uYXBwZW5kQ2hpbGQobmFtZUxhYmVsKTtcclxuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xyXG4gICAgICAgIG5hbWVJbnB1dC5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgbmFtZUlucHV0Lm5hbWUgPSAndGl0bGUnO1xyXG4gICAgICAgIG5hbWVJbnB1dC50eXBlID0gJ3RleHQnO1xyXG4gICAgICAgIG5hbWVJbnB1dC5pZCA9ICd0aXRsZSc7XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKG5hbWVJbnB1dCk7XHJcblxyXG4gICAgICAgIGNvbnN0IHByaW9yaXR5TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xyXG4gICAgICAgIHByaW9yaXR5TGFiZWwuc2V0QXR0cmlidXRlKCdmb3InLCAncHJpb3JpdHknKTtcclxuICAgICAgICBwcmlvcml0eUxhYmVsLnRleHRDb250ZW50ID0gJ1ByaW9yaXR5JztcclxuICAgICAgICB0b2RvSXRlbUZvcm0uYXBwZW5kQ2hpbGQocHJpb3JpdHlMYWJlbCk7XHJcbiAgICAgICAgY29uc3QgcHJpb3JpdHlTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcclxuICAgICAgICBwcmlvcml0eVNlbGVjdC5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QubmFtZSA9ICdwcmlvcml0eSc7XHJcbiAgICAgICAgcHJpb3JpdHlTZWxlY3QuaWQgPSAncHJpb3JpdHknO1xyXG4gICAgICAgIGZvciAobGV0IHByaW9yaXR5IG9mIE9iamVjdC5rZXlzKFRvZG9JdGVtLnByaW9yaXRpZXMpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByaW9yaXR5T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICAgICAgICAgIHByaW9yaXR5T3B0aW9uLm5hbWUgPSAncHJpb3JpdHknO1xyXG4gICAgICAgICAgICBwcmlvcml0eU9wdGlvbi52YWx1ZSA9IHByaW9yaXR5O1xyXG4gICAgICAgICAgICBwcmlvcml0eU9wdGlvbi50ZXh0ID0gVG9kb0l0ZW0ucHJpb3JpdGllc1twcmlvcml0eV07XHJcbiAgICAgICAgICAgIHByaW9yaXR5U2VsZWN0LmFwcGVuZENoaWxkKHByaW9yaXR5T3B0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKHByaW9yaXR5U2VsZWN0KTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvbkxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTtcclxuICAgICAgICBkZXNjcmlwdGlvbkxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ2Rlc2NyaXB0aW9uJyk7XHJcbiAgICAgICAgZGVzY3JpcHRpb25MYWJlbC50ZXh0Q29udGVudCA9ICdEZXNjcmlwdGlvbic7XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uTGFiZWwpO1xyXG4gICAgICAgIGNvbnN0IGRlc2NyaXB0aW9uVGV4dEFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xyXG4gICAgICAgIGRlc2NyaXB0aW9uVGV4dEFyZWEucmVxdWlyZWQgPSB0cnVlO1xyXG4gICAgICAgIGRlc2NyaXB0aW9uVGV4dEFyZWEubmFtZSA9ICdkZXNjcmlwdGlvbic7XHJcbiAgICAgICAgZGVzY3JpcHRpb25UZXh0QXJlYS5pZCA9ICdkZXNjcmlwdGlvbic7XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKGRlc2NyaXB0aW9uVGV4dEFyZWEpO1xyXG5cclxuICAgICAgICBjb25zdCBkdWVEYXRlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xyXG4gICAgICAgIGR1ZURhdGVMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdkdWVEYXRlJyk7XHJcbiAgICAgICAgZHVlRGF0ZUxhYmVsLnRleHRDb250ZW50ID0gJ0R1ZSBEYXRlJztcclxuICAgICAgICB0b2RvSXRlbUZvcm0uYXBwZW5kQ2hpbGQoZHVlRGF0ZUxhYmVsKTtcclxuICAgICAgICBjb25zdCBkdWVEYXRlUGlja2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTtcclxuICAgICAgICBkdWVEYXRlUGlja2VyLnJlcXVpcmVkID0gdHJ1ZTtcclxuICAgICAgICBkdWVEYXRlUGlja2VyLnR5cGUgPSAnZGF0ZSc7XHJcbiAgICAgICAgZHVlRGF0ZVBpY2tlci5uYW1lID0gJ2R1ZURhdGUnO1xyXG4gICAgICAgIGR1ZURhdGVQaWNrZXIuaWQgPSAnZHVlRGF0ZSc7XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKGR1ZURhdGVQaWNrZXIpO1xyXG5cclxuICAgICAgICBjb25zdCBwcm9qZWN0TGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpO1xyXG4gICAgICAgIHByb2plY3RMYWJlbC5zZXRBdHRyaWJ1dGUoJ2ZvcicsICdwcm9qZWN0Jyk7XHJcbiAgICAgICAgcHJvamVjdExhYmVsLnRleHRDb250ZW50ID0gJ1Byb2plY3QnO1xyXG4gICAgICAgIGNvbnN0IHByb2plY3RTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTtcclxuICAgICAgICBwcm9qZWN0U2VsZWN0LnJlcXVpcmVkID0gdHJ1ZTtcclxuICAgICAgICBwcm9qZWN0U2VsZWN0Lm5hbWUgPSAncHJvamVjdCc7XHJcbiAgICAgICAgcHJvamVjdFNlbGVjdC5pZCA9ICdwcm9qZWN0JztcclxuICAgICAgICBmb3IgKGxldCBwcm9qZWN0IG9mIHByb2plY3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb2plY3RPcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICAgICAgICAgcHJvamVjdE9wdGlvbi52YWx1ZSA9IHByb2plY3QuaWQ7XHJcbiAgICAgICAgICAgIHByb2plY3RPcHRpb24udGV4dENvbnRlbnQgPSBwcm9qZWN0Lm5hbWU7XHJcbiAgICAgICAgICAgIHByb2plY3RTZWxlY3QuYXBwZW5kQ2hpbGQocHJvamVjdE9wdGlvbik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvZG9JdGVtRm9ybS5hcHBlbmRDaGlsZChwcm9qZWN0U2VsZWN0KTtcclxuICAgIFxyXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xyXG4gICAgICAgIHN1Ym1pdEJ1dHRvbi50eXBlID0gJ3N1Ym1pdCc7XHJcbiAgICAgICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gJ0FkZCc7XHJcbiAgICAgICAgdG9kb0l0ZW1Gb3JtLmFwcGVuZENoaWxkKHN1Ym1pdEJ1dHRvbik7XHJcblxyXG4gICAgICAgIGFkZFRvZG9JdGVtQ29udGFpbmVyLmFwcGVuZENoaWxkKGFkZFRvZG9JdGVtSGVhZGVyKTtcclxuICAgICAgICBhZGRUb2RvSXRlbUNvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvSXRlbUZvcm0pO1xyXG4gICAgICAgIHJldHVybiBhZGRUb2RvSXRlbUNvbnRhaW5lcjtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbkZvcm1TdWJtaXQoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjb25zdCBmb3JtID0gZS50YXJnZXQ7XHJcbiAgICAgICAgaWYoIWZvcm0uY2hlY2tWYWxpZGl0eSgpKSB7XHJcbiAgICAgICAgICAgIGZvcm0ucmVwb3J0VmFsaWRpdHkoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbGV0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xyXG4gICAgICAgIGNvbnN0IG5ld1RvZG9JdGVtID0gYXdhaXQgYWRkVG9kb0l0ZW0oXHJcbiAgICAgICAgICAgIGZvcm1EYXRhLmdldCgndGl0bGUnKSwgXHJcbiAgICAgICAgICAgIGZvcm1EYXRhLmdldCgncHJpb3JpdHknKSxcclxuICAgICAgICAgICAgZm9ybURhdGEuZ2V0KCdkZXNjcmlwdGlvbicpLCBcclxuICAgICAgICAgICAgZm9ybURhdGEuZ2V0KCdkdWVEYXRlJyksXHJcbiAgICAgICAgICAgIE51bWJlcihmb3JtRGF0YS5nZXQoJ3Byb2plY3QnKSlcclxuICAgICAgICApO1xyXG4gICAgICAgIGlmIChuZXdUb2RvSXRlbSkge1xyXG4gICAgICAgICAgICBmb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgQWRkVG9kb0l0ZW0oKTsiLCJpbXBvcnQgeyBwdWJsaXNoTGluayB9IGZyb20gXCIuLi91dGlsXCI7XHJcbmltcG9ydCB7IGFkZFByb2plY3QgfSBmcm9tIFwiLi9Qcm9qZWN0Q29udHJvbGxlclwiO1xyXG5cclxuY2xhc3MgQWRkUHJvamVjdCB7XHJcbiAgICBhc3luYyByZW5kZXIoKSB7XHJcbiAgICAgICAgY29uc3QgYWRkUHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cclxuICAgICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICAgIGhlYWRlci50ZXh0Q29udGVudCA9ICdBZGQgUHJvamVjdCc7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdmb3JtJyk7XHJcbiAgICAgICAgZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLm9uRm9ybVN1Ym1pdCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5hbWVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xhYmVsJyk7XHJcbiAgICAgICAgbmFtZUxhYmVsLnNldEF0dHJpYnV0ZSgnZm9yJywgJ25hbWUnKTtcclxuICAgICAgICBuYW1lTGFiZWwudGV4dENvbnRlbnQgPSAnUHJvamVjdCBuYW1lJztcclxuICAgICAgICBmb3JtLmFwcGVuZENoaWxkKG5hbWVMYWJlbCk7XHJcblxyXG4gICAgICAgIGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XHJcbiAgICAgICAgbmFtZUlucHV0LnR5cGUgPSAndGV4dCc7XHJcbiAgICAgICAgbmFtZUlucHV0Lm5hbWUgPSAnbmFtZSc7XHJcbiAgICAgICAgbmFtZUlucHV0LmlkID0gJ25hbWUnO1xyXG4gICAgICAgIG5hbWVJbnB1dC5yZXF1aXJlZCA9IHRydWU7XHJcbiAgICAgICAgZm9ybS5hcHBlbmRDaGlsZChuYW1lSW5wdXQpO1xyXG5cclxuICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcclxuICAgICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnQWRkJztcclxuICAgICAgICBmb3JtLmFwcGVuZENoaWxkKHN1Ym1pdEJ1dHRvbik7XHJcblxyXG4gICAgICAgIGFkZFByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoaGVhZGVyKTtcclxuICAgICAgICBhZGRQcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKGZvcm0pO1xyXG5cclxuICAgICAgICByZXR1cm4gYWRkUHJvamVjdENvbnRhaW5lcjtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbkZvcm1TdWJtaXQoZSkge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBjb25zdCBmb3JtID0gZS50YXJnZXQ7XHJcbiAgICAgICAgaWYgKCFmb3JtLmNoZWNrVmFsaWRpdHkoKSkge1xyXG4gICAgICAgICAgICBmb3JtLnJlcG9ydFZhbGlkaXR5KCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKGZvcm0pO1xyXG5cclxuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gYXdhaXQgYWRkUHJvamVjdChcclxuICAgICAgICAgICAgZm9ybURhdGEuZ2V0KCduYW1lJylcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICBpZiAobmV3UHJvamVjdCkge1xyXG4gICAgICAgICAgICBwdWJsaXNoTGluaygnUHJvamVjdERldGFpbCcsIG5ld1Byb2plY3QuaWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgbmV3IEFkZFByb2plY3QoKTsiLCJpbXBvcnQgVG9kb0l0ZW1zTGlzdCBmcm9tIFwiLi4vLi4vY29tcG9uZW50cy9Ub2RvSXRlbXNMaXN0XCI7XHJcblxyXG5jbGFzcyBUb2RvSXRlbUxpc3Qge1xyXG4gICAgYXN5bmMgcmVuZGVyKHt0aXRsZSwgY2FsbGJhY2t9KSB7XHJcbiAgICAgICAgdGhpcy50b2RvSXRlbXMgPSBhd2FpdCBjYWxsYmFjaygpO1xyXG5cclxuICAgICAgICBjb25zdCB0b2RvSXRlbUxpc3RDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBjb25zdCB0b2RvSXRlbUxpc3RIZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gICAgICAgIHRvZG9JdGVtTGlzdEhlYWRlci50ZXh0Q29udGVudCA9IHRpdGxlO1xyXG4gICAgICAgIHRvZG9JdGVtTGlzdENvbnRhaW5lci5hcHBlbmRDaGlsZCh0b2RvSXRlbUxpc3RIZWFkZXIpO1xyXG4gICAgICAgIGNvbnN0IHRvZG9JdGVtc0xpc3QgPSBuZXcgVG9kb0l0ZW1zTGlzdCh0aGlzLnRvZG9JdGVtcykucmVuZGVyKCk7XHJcbiAgICAgICAgdG9kb0l0ZW1MaXN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHRvZG9JdGVtc0xpc3QpO1xyXG5cclxuICAgICAgICByZXR1cm4gdG9kb0l0ZW1MaXN0Q29udGFpbmVyO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBuZXcgVG9kb0l0ZW1MaXN0KCk7IiwiXG4gICAgICBpbXBvcnQgQVBJIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5qZWN0U3R5bGVzSW50b1N0eWxlVGFnLmpzXCI7XG4gICAgICBpbXBvcnQgZG9tQVBJIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc3R5bGVEb21BUEkuanNcIjtcbiAgICAgIGltcG9ydCBpbnNlcnRGbiBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL2luc2VydEJ5U2VsZWN0b3IuanNcIjtcbiAgICAgIGltcG9ydCBzZXRBdHRyaWJ1dGVzIGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvc2V0QXR0cmlidXRlc1dpdGhvdXRBdHRyaWJ1dGVzLmpzXCI7XG4gICAgICBpbXBvcnQgaW5zZXJ0U3R5bGVFbGVtZW50IGZyb20gXCIhLi4vbm9kZV9tb2R1bGVzL3N0eWxlLWxvYWRlci9kaXN0L3J1bnRpbWUvaW5zZXJ0U3R5bGVFbGVtZW50LmpzXCI7XG4gICAgICBpbXBvcnQgc3R5bGVUYWdUcmFuc2Zvcm1GbiBmcm9tIFwiIS4uL25vZGVfbW9kdWxlcy9zdHlsZS1sb2FkZXIvZGlzdC9ydW50aW1lL3N0eWxlVGFnVHJhbnNmb3JtLmpzXCI7XG4gICAgICBpbXBvcnQgY29udGVudCwgKiBhcyBuYW1lZEV4cG9ydCBmcm9tIFwiISEuLi9ub2RlX21vZHVsZXMvY3NzLWxvYWRlci9kaXN0L2Nqcy5qcyEuL3N0eWxlLmNzc1wiO1xuICAgICAgXG4gICAgICBcblxudmFyIG9wdGlvbnMgPSB7fTtcblxub3B0aW9ucy5zdHlsZVRhZ1RyYW5zZm9ybSA9IHN0eWxlVGFnVHJhbnNmb3JtRm47XG5vcHRpb25zLnNldEF0dHJpYnV0ZXMgPSBzZXRBdHRyaWJ1dGVzO1xuXG4gICAgICBvcHRpb25zLmluc2VydCA9IGluc2VydEZuLmJpbmQobnVsbCwgXCJoZWFkXCIpO1xuICAgIFxub3B0aW9ucy5kb21BUEkgPSBkb21BUEk7XG5vcHRpb25zLmluc2VydFN0eWxlRWxlbWVudCA9IGluc2VydFN0eWxlRWxlbWVudDtcblxudmFyIHVwZGF0ZSA9IEFQSShjb250ZW50LCBvcHRpb25zKTtcblxuXG5cbmV4cG9ydCAqIGZyb20gXCIhIS4uL25vZGVfbW9kdWxlcy9jc3MtbG9hZGVyL2Rpc3QvY2pzLmpzIS4vc3R5bGUuY3NzXCI7XG4gICAgICAgZXhwb3J0IGRlZmF1bHQgY29udGVudCAmJiBjb250ZW50LmxvY2FscyA/IGNvbnRlbnQubG9jYWxzIDogdW5kZWZpbmVkO1xuIiwiaW1wb3J0IFB1YlN1YiBmcm9tICcuL21vZHVsZXMvUHViU3ViJztcclxuaW1wb3J0IHsgYWRkVG9kb0l0ZW0sIGdldFRvZG9JdGVtcyB9IGZyb20gJy4vbW9kdWxlcy9Ub2RvSXRlbS9Ub2RvSXRlbUNvbnRyb2xsZXInO1xyXG5pbXBvcnQgVG9kb0l0ZW1EZXRhaWwgZnJvbSAnLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtRGV0YWlsJztcclxuaW1wb3J0IEhlYWRlciBmcm9tICcuL21vZHVsZXMvTGF5b3V0L2hlYWRlcic7XHJcbmltcG9ydCBTaWRlYmFyIGZyb20gJy4vbW9kdWxlcy9MYXlvdXQvc2lkZWJhcic7XHJcbmltcG9ydCBQcm9qZWN0RGV0YWlsIGZyb20gJy4vbW9kdWxlcy9Qcm9qZWN0L1Byb2plY3REZXRhaWwnO1xyXG5pbXBvcnQgQWRkVG9kb0l0ZW0gZnJvbSAnLi9tb2R1bGVzL1RvZG9JdGVtL0FkZFRvZG9JdGVtJztcclxuaW1wb3J0IEFkZFByb2plY3QgZnJvbSAnLi9tb2R1bGVzL1Byb2plY3QvQWRkUHJvamVjdCc7XHJcbmltcG9ydCBUb2RvSXRlbUxpc3QgZnJvbSAnLi9tb2R1bGVzL1RvZG9JdGVtL1RvZG9JdGVtTGlzdCc7XHJcbmltcG9ydCB7IGluaXRpYWxpemVBcHAgfSBmcm9tICdmaXJlYmFzZS9hcHAnO1xyXG5pbXBvcnQgZmlyZWJhc2VDb25maWcgZnJvbSAnLi4vZmlyZWJhc2VfY29uZmlnJztcclxuaW1wb3J0ICcuL3N0eWxlLmNzcyc7XHJcblxyXG4oYXN5bmMgKCkgPT4ge1xyXG4gICAgaWYgKGdldFRvZG9JdGVtcygpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGFkZFRvZG9JdGVtKFwiVGVzdFwiLCAzLCBcIlRlc3QgRGVzY3JpcHRpb25cIiwgXCIyMDIyLTEyLTI5XCIpO1xyXG4gICAgICAgIGFkZFRvZG9JdGVtKFwiVGVzdDJcIiwgMywgXCJUZXN0IERlc2NyaXB0aW9uIDJcIiwgXCIyMDIyLTEyLTMwXCIpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBjb25zdCBwYWdlcyA9IHtcclxuICAgICAgICBcIlRvZG9JdGVtRGV0YWlsXCI6IFRvZG9JdGVtRGV0YWlsLFxyXG4gICAgICAgIFwiUHJvamVjdERldGFpbFwiOlByb2plY3REZXRhaWwsXHJcbiAgICAgICAgXCJBZGRUb2RvSXRlbVwiOkFkZFRvZG9JdGVtLFxyXG4gICAgICAgIFwiQWRkUHJvamVjdFwiOkFkZFByb2plY3QsXHJcbiAgICAgICAgJ1RvZG9JdGVtTGlzdCc6VG9kb0l0ZW1MaXN0LFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBQdWJTdWIuc3Vic2NyaWJlKCdjaGFuZ2VQYWdlJywgY2hhbmdlUGFnZSk7XHJcbiAgICBcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoSGVhZGVyLnJlbmRlcigpKTtcclxuICAgIGNvbnN0IHNpZGViYXIgPSBhd2FpdCBTaWRlYmFyLnJlbmRlcigpO1xyXG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzaWRlYmFyKTtcclxuICAgIGNvbnN0IG1haW5Db250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICBtYWluQ29udGVudC5jbGFzc0xpc3QuYWRkKCdtYWluLWNvbnRlbnQnKTtcclxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWFpbkNvbnRlbnQpO1xyXG4gICAgXHJcbiAgICBhc3luYyBmdW5jdGlvbiBjaGFuZ2VQYWdlKGRhdGEpIHtcclxuICAgICAgICBpZiAoIWRhdGEucGFnZSB8fCAhcGFnZXNbZGF0YS5wYWdlXSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgY29uc3QgZWxlbWVudCA9IGF3YWl0IHBhZ2VzW2RhdGEucGFnZV0ucmVuZGVyKGRhdGEuZGF0YSk7XHJcbiAgICAgICAgbWFpbkNvbnRlbnQuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgICAgICBtYWluQ29udGVudC5hcHBlbmRDaGlsZChlbGVtZW50KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgYXdhaXQgY2hhbmdlUGFnZSh7XHJcbiAgICAgICAgcGFnZTogXCJUb2RvSXRlbUxpc3RcIixcclxuICAgICAgICBkYXRhOiB7dGl0bGU6J0FsbCBpdGVtcycsIGNhbGxiYWNrOmdldFRvZG9JdGVtc31cclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICBjb25zdCBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcclxufSkoKVxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiJdLCJuYW1lcyI6WyJfX19DU1NfTE9BREVSX0VYUE9SVF9fXyIsInB1c2giLCJtb2R1bGUiLCJpZCIsImV4cG9ydHMiLCJjc3NXaXRoTWFwcGluZ1RvU3RyaW5nIiwibGlzdCIsInRvU3RyaW5nIiwidGhpcyIsIm1hcCIsIml0ZW0iLCJjb250ZW50IiwibmVlZExheWVyIiwiY29uY2F0IiwibGVuZ3RoIiwiam9pbiIsImkiLCJtb2R1bGVzIiwibWVkaWEiLCJkZWR1cGUiLCJzdXBwb3J0cyIsImxheWVyIiwidW5kZWZpbmVkIiwiYWxyZWFkeUltcG9ydGVkTW9kdWxlcyIsImsiLCJfayIsImNzc01hcHBpbmciLCJidG9hIiwiYmFzZTY0IiwidW5lc2NhcGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJKU09OIiwic3RyaW5naWZ5IiwiZGF0YSIsInNvdXJjZU1hcHBpbmciLCJzdHlsZXNJbkRPTSIsImdldEluZGV4QnlJZGVudGlmaWVyIiwiaWRlbnRpZmllciIsInJlc3VsdCIsIm1vZHVsZXNUb0RvbSIsIm9wdGlvbnMiLCJpZENvdW50TWFwIiwiaWRlbnRpZmllcnMiLCJiYXNlIiwiY291bnQiLCJpbmRleEJ5SWRlbnRpZmllciIsIm9iaiIsImNzcyIsInNvdXJjZU1hcCIsInJlZmVyZW5jZXMiLCJ1cGRhdGVyIiwiYWRkRWxlbWVudFN0eWxlIiwiYnlJbmRleCIsInNwbGljZSIsImFwaSIsImRvbUFQSSIsInVwZGF0ZSIsIm5ld09iaiIsInJlbW92ZSIsImxhc3RJZGVudGlmaWVycyIsIm5ld0xpc3QiLCJpbmRleCIsIm5ld0xhc3RJZGVudGlmaWVycyIsIl9pIiwiX2luZGV4IiwibWVtbyIsImluc2VydCIsInN0eWxlIiwidGFyZ2V0Iiwic3R5bGVUYXJnZXQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJ3aW5kb3ciLCJIVE1MSUZyYW1lRWxlbWVudCIsImNvbnRlbnREb2N1bWVudCIsImhlYWQiLCJlIiwiZ2V0VGFyZ2V0IiwiRXJyb3IiLCJhcHBlbmRDaGlsZCIsImVsZW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlcyIsImF0dHJpYnV0ZXMiLCJzdHlsZUVsZW1lbnQiLCJub25jZSIsInNldEF0dHJpYnV0ZSIsImluc2VydFN0eWxlRWxlbWVudCIsInN0eWxlVGFnVHJhbnNmb3JtIiwiYXBwbHkiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJyZW1vdmVTdHlsZUVsZW1lbnQiLCJzdHlsZVNoZWV0IiwiY3NzVGV4dCIsImZpcnN0Q2hpbGQiLCJjcmVhdGVUZXh0Tm9kZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJuIiwiZ2V0dGVyIiwiX19lc01vZHVsZSIsImQiLCJhIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJnIiwiZ2xvYmFsVGhpcyIsIkZ1bmN0aW9uIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIm5jIiwiZXZlbnRzIiwicHVibGlzaCIsImV2ZW50IiwibGlzdGVuZXIiLCJzdWJzY3JpYmUiLCJjYWxsYmFjayIsInVuc3Vic2NyaWJlIiwiZmluZCIsIlRvZG9JdGVtIiwiY29uc3RydWN0b3IiLCJ0aXRsZSIsInByaW9yaXR5IiwiZGVzY3JpcHRpb24iLCJkdWVEYXRlIiwiaXNDb21wbGV0ZSIsInByb2plY3RJZCIsInN0YXRpYyIsImdldE5leHRJZCIsImFyciIsInJlZHVjZSIsInByZXZpb3VzIiwicHVibGlzaExpbmsiLCJwYWdlIiwiZ2V0SW5kZXhGcm9tSWQiLCJmaW5kSW5kZXgiLCJyZXF1aXJlZEFyZ3MiLCJyZXF1aXJlZCIsImFyZ3MiLCJUeXBlRXJyb3IiLCJfdHlwZW9mIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJ0b0RhdGUiLCJhcmd1bWVudCIsImFyZ3VtZW50cyIsImFyZ1N0ciIsIkRhdGUiLCJnZXRUaW1lIiwiY29uc29sZSIsIndhcm4iLCJzdGFjayIsIk5hTiIsInN0YXJ0T2ZEYXkiLCJkaXJ0eURhdGUiLCJkYXRlIiwic2V0SG91cnMiLCJpc1NhbWVEYXkiLCJkaXJ0eURhdGVMZWZ0IiwiZGlydHlEYXRlUmlnaHQiLCJkYXRlTGVmdFN0YXJ0T2ZEYXkiLCJkYXRlUmlnaHRTdGFydE9mRGF5IiwiVG9kb0l0ZW1SZXBvc2l0b3J5TG9jYWwiLCJ0b2RvSXRlbXMiLCJ0ZW1wVG9kb0l0ZW1zIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiTnVtYmVyIiwibG9hZFRvZG9JdGVtcyIsImFzeW5jIiwiZ2V0VG9kb0l0ZW1CeUlkIiwic2V0SXRlbSIsImdldFRvZG9JdGVtcyIsImFkZFRvZG9JdGVtIiwibmV3SWQiLCJuZXdUb2RvSXRlbSIsImRlbGV0ZVRvZG9JdGVtIiwidXBkYXRlVG9kb0l0ZW0iLCJyZXBvc2l0b3J5IiwiZ2V0VG9kb0l0ZW1zVG9kYXkiLCJmaWx0ZXIiLCJub3ciLCJpc1RvZGF5IiwiZ2V0VG9kb0l0ZW1zVXBjb21pbmciLCJpc0Z1dHVyZSIsIlByb2plY3QiLCJuYW1lIiwic3RyaW5nVG9CeXRlQXJyYXkkMSIsInN0ciIsIm91dCIsInAiLCJjIiwiY2hhckNvZGVBdCIsImJ5dGVUb0NoYXJNYXBfIiwiY2hhclRvQnl0ZU1hcF8iLCJieXRlVG9DaGFyTWFwV2ViU2FmZV8iLCJjaGFyVG9CeXRlTWFwV2ViU2FmZV8iLCJFTkNPREVEX1ZBTFNfQkFTRSIsIkVOQ09ERURfVkFMUyIsIkVOQ09ERURfVkFMU19XRUJTQUZFIiwiSEFTX05BVElWRV9TVVBQT1JUIiwiYXRvYiIsImVuY29kZUJ5dGVBcnJheSIsImlucHV0Iiwid2ViU2FmZSIsIkFycmF5IiwiaXNBcnJheSIsImluaXRfIiwiYnl0ZVRvQ2hhck1hcCIsIm91dHB1dCIsImJ5dGUxIiwiaGF2ZUJ5dGUyIiwiYnl0ZTIiLCJoYXZlQnl0ZTMiLCJieXRlMyIsIm91dEJ5dGUxIiwib3V0Qnl0ZTIiLCJvdXRCeXRlMyIsIm91dEJ5dGU0IiwiZW5jb2RlU3RyaW5nIiwiZGVjb2RlU3RyaW5nIiwiYnl0ZXMiLCJwb3MiLCJjMSIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsImMyIiwidSIsImMzIiwiYnl0ZUFycmF5VG9TdHJpbmciLCJkZWNvZGVTdHJpbmdUb0J5dGVBcnJheSIsImNoYXJUb0J5dGVNYXAiLCJjaGFyQXQiLCJieXRlNCIsIkRlY29kZUJhc2U2NFN0cmluZ0Vycm9yIiwic3VwZXIiLCJiYXNlNjR1cmxFbmNvZGVXaXRob3V0UGFkZGluZyIsInV0ZjhCeXRlcyIsImJhc2U2NEVuY29kZSIsInJlcGxhY2UiLCJnZXREZWZhdWx0cyIsInNlbGYiLCJnZXRHbG9iYWwiLCJfX0ZJUkVCQVNFX0RFRkFVTFRTX18iLCJwcm9jZXNzIiwiZW52IiwiZGVmYXVsdHNKc29uU3RyaW5nIiwiZ2V0RGVmYXVsdHNGcm9tRW52VmFyaWFibGUiLCJtYXRjaCIsImNvb2tpZSIsImRlY29kZWQiLCJlcnJvciIsImJhc2U2NERlY29kZSIsImdldERlZmF1bHRzRnJvbUNvb2tpZSIsImluZm8iLCJEZWZlcnJlZCIsInJlamVjdCIsInJlc29sdmUiLCJwcm9taXNlIiwiUHJvbWlzZSIsIndyYXBDYWxsYmFjayIsInZhbHVlIiwiY2F0Y2giLCJGaXJlYmFzZUVycm9yIiwiY29kZSIsIm1lc3NhZ2UiLCJjdXN0b21EYXRhIiwic2V0UHJvdG90eXBlT2YiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIkVycm9yRmFjdG9yeSIsImNyZWF0ZSIsInNlcnZpY2UiLCJzZXJ2aWNlTmFtZSIsImVycm9ycyIsImZ1bGxDb2RlIiwidGVtcGxhdGUiLCJQQVRURVJOIiwiXyIsInJlcGxhY2VUZW1wbGF0ZSIsImZ1bGxNZXNzYWdlIiwiYiIsImFLZXlzIiwia2V5cyIsImJLZXlzIiwiaW5jbHVkZXMiLCJhUHJvcCIsImJQcm9wIiwiaXNPYmplY3QiLCJ0aGluZyIsIkNvbXBvbmVudCIsImluc3RhbmNlRmFjdG9yeSIsInR5cGUiLCJtdWx0aXBsZUluc3RhbmNlcyIsInNlcnZpY2VQcm9wcyIsImluc3RhbnRpYXRpb25Nb2RlIiwib25JbnN0YW5jZUNyZWF0ZWQiLCJzZXRJbnN0YW50aWF0aW9uTW9kZSIsIm1vZGUiLCJzZXRNdWx0aXBsZUluc3RhbmNlcyIsInNldFNlcnZpY2VQcm9wcyIsInByb3BzIiwic2V0SW5zdGFuY2VDcmVhdGVkQ2FsbGJhY2siLCJERUZBVUxUX0VOVFJZX05BTUUiLCJQcm92aWRlciIsImNvbnRhaW5lciIsImNvbXBvbmVudCIsImluc3RhbmNlcyIsIk1hcCIsImluc3RhbmNlc0RlZmVycmVkIiwiaW5zdGFuY2VzT3B0aW9ucyIsIm9uSW5pdENhbGxiYWNrcyIsIm5vcm1hbGl6ZWRJZGVudGlmaWVyIiwibm9ybWFsaXplSW5zdGFuY2VJZGVudGlmaWVyIiwiaGFzIiwiZGVmZXJyZWQiLCJzZXQiLCJpc0luaXRpYWxpemVkIiwic2hvdWxkQXV0b0luaXRpYWxpemUiLCJpbnN0YW5jZSIsImdldE9ySW5pdGlhbGl6ZVNlcnZpY2UiLCJpbnN0YW5jZUlkZW50aWZpZXIiLCJnZXRJbW1lZGlhdGUiLCJfYSIsIm9wdGlvbmFsIiwiZ2V0Q29tcG9uZW50Iiwic2V0Q29tcG9uZW50IiwiaXNDb21wb25lbnRFYWdlciIsImluc3RhbmNlRGVmZXJyZWQiLCJlbnRyaWVzIiwiY2xlYXJJbnN0YW5jZSIsImRlbGV0ZSIsInNlcnZpY2VzIiwiZnJvbSIsInZhbHVlcyIsImFsbCIsIklOVEVSTkFMIiwiX2RlbGV0ZSIsImlzQ29tcG9uZW50U2V0IiwiZ2V0T3B0aW9ucyIsImluaXRpYWxpemUiLCJvcHRzIiwib25Jbml0IiwiZXhpc3RpbmdDYWxsYmFja3MiLCJTZXQiLCJhZGQiLCJleGlzdGluZ0luc3RhbmNlIiwiaW52b2tlT25Jbml0Q2FsbGJhY2tzIiwiY2FsbGJhY2tzIiwiQ29tcG9uZW50Q29udGFpbmVyIiwicHJvdmlkZXJzIiwiYWRkQ29tcG9uZW50IiwicHJvdmlkZXIiLCJnZXRQcm92aWRlciIsImFkZE9yT3ZlcndyaXRlQ29tcG9uZW50IiwiZ2V0UHJvdmlkZXJzIiwiTG9nTGV2ZWwiLCJsZXZlbFN0cmluZ1RvRW51bSIsIkRFQlVHIiwiVkVSQk9TRSIsIklORk8iLCJXQVJOIiwiRVJST1IiLCJTSUxFTlQiLCJkZWZhdWx0TG9nTGV2ZWwiLCJDb25zb2xlTWV0aG9kIiwiZGVmYXVsdExvZ0hhbmRsZXIiLCJsb2dUeXBlIiwibG9nTGV2ZWwiLCJ0b0lTT1N0cmluZyIsIm1ldGhvZCIsIkxvZ2dlciIsIl9sb2dMZXZlbCIsIl9sb2dIYW5kbGVyIiwiX3VzZXJMb2dIYW5kbGVyIiwidmFsIiwic2V0TG9nTGV2ZWwiLCJsb2dIYW5kbGVyIiwidXNlckxvZ0hhbmRsZXIiLCJkZWJ1ZyIsImxvZyIsImlkYlByb3h5YWJsZVR5cGVzIiwiY3Vyc29yQWR2YW5jZU1ldGhvZHMiLCJjdXJzb3JSZXF1ZXN0TWFwIiwiV2Vha01hcCIsInRyYW5zYWN0aW9uRG9uZU1hcCIsInRyYW5zYWN0aW9uU3RvcmVOYW1lc01hcCIsInRyYW5zZm9ybUNhY2hlIiwicmV2ZXJzZVRyYW5zZm9ybUNhY2hlIiwiaWRiUHJveHlUcmFwcyIsInJlY2VpdmVyIiwiSURCVHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZU5hbWVzIiwib2JqZWN0U3RvcmUiLCJ0cmFuc2Zvcm1DYWNoYWJsZVZhbHVlIiwiZnVuYyIsIklEQkRhdGFiYXNlIiwidHJhbnNhY3Rpb24iLCJJREJDdXJzb3IiLCJhZHZhbmNlIiwiY29udGludWUiLCJjb250aW51ZVByaW1hcnlLZXkiLCJ1bndyYXAiLCJzdG9yZU5hbWVzIiwidHgiLCJzb3J0IiwiZG9uZSIsInVubGlzdGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbXBsZXRlIiwiRE9NRXhjZXB0aW9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNhY2hlRG9uZVByb21pc2VGb3JUcmFuc2FjdGlvbiIsIm9iamVjdCIsIklEQk9iamVjdFN0b3JlIiwiSURCSW5kZXgiLCJzb21lIiwiUHJveHkiLCJJREJSZXF1ZXN0IiwicmVxdWVzdCIsInN1Y2Nlc3MiLCJ0aGVuIiwicHJvbWlzaWZ5UmVxdWVzdCIsIm5ld1ZhbHVlIiwicmVhZE1ldGhvZHMiLCJ3cml0ZU1ldGhvZHMiLCJjYWNoZWRNZXRob2RzIiwiZ2V0TWV0aG9kIiwidGFyZ2V0RnVuY05hbWUiLCJ1c2VJbmRleCIsImlzV3JpdGUiLCJzdG9yZU5hbWUiLCJzdG9yZSIsInNoaWZ0Iiwib2xkVHJhcHMiLCJQbGF0Zm9ybUxvZ2dlclNlcnZpY2VJbXBsIiwiZ2V0UGxhdGZvcm1JbmZvU3RyaW5nIiwiaXNWZXJzaW9uU2VydmljZVByb3ZpZGVyIiwibGlicmFyeSIsInZlcnNpb24iLCJsb2dTdHJpbmciLCJuYW1lJG8iLCJ2ZXJzaW9uJDEiLCJsb2dnZXIiLCJQTEFURk9STV9MT0dfU1RSSU5HIiwiX2FwcHMiLCJfY29tcG9uZW50cyIsIl9hZGRDb21wb25lbnQiLCJhcHAiLCJfcmVnaXN0ZXJDb21wb25lbnQiLCJjb21wb25lbnROYW1lIiwiRVJST1JfRkFDVE9SWSIsIkZpcmViYXNlQXBwSW1wbCIsImNvbmZpZyIsIl9pc0RlbGV0ZWQiLCJfb3B0aW9ucyIsImFzc2lnbiIsIl9jb25maWciLCJfbmFtZSIsIl9hdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQiLCJhdXRvbWF0aWNEYXRhQ29sbGVjdGlvbkVuYWJsZWQiLCJfY29udGFpbmVyIiwiY2hlY2tEZXN0cm95ZWQiLCJpc0RlbGV0ZWQiLCJhcHBOYW1lIiwiaW5pdGlhbGl6ZUFwcCIsInJhd0NvbmZpZyIsImV4aXN0aW5nQXBwIiwibmV3QXBwIiwicmVnaXN0ZXJWZXJzaW9uIiwibGlicmFyeUtleU9yTmFtZSIsInZhcmlhbnQiLCJsaWJyYXJ5TWlzbWF0Y2giLCJ2ZXJzaW9uTWlzbWF0Y2giLCJ3YXJuaW5nIiwiU1RPUkVfTkFNRSIsImRiUHJvbWlzZSIsImdldERiUHJvbWlzZSIsImJsb2NrZWQiLCJ1cGdyYWRlIiwiYmxvY2tpbmciLCJ0ZXJtaW5hdGVkIiwiaW5kZXhlZERCIiwib3BlbiIsIm9wZW5Qcm9taXNlIiwib2xkVmVyc2lvbiIsIm5ld1ZlcnNpb24iLCJkYiIsIm9wZW5EQiIsImNyZWF0ZU9iamVjdFN0b3JlIiwib3JpZ2luYWxFcnJvck1lc3NhZ2UiLCJ3cml0ZUhlYXJ0YmVhdHNUb0luZGV4ZWREQiIsImhlYXJ0YmVhdE9iamVjdCIsInB1dCIsImNvbXB1dGVLZXkiLCJpZGJHZXRFcnJvciIsImFwcElkIiwiSGVhcnRiZWF0U2VydmljZUltcGwiLCJfaGVhcnRiZWF0c0NhY2hlIiwiX3N0b3JhZ2UiLCJIZWFydGJlYXRTdG9yYWdlSW1wbCIsIl9oZWFydGJlYXRzQ2FjaGVQcm9taXNlIiwicmVhZCIsImFnZW50IiwiZ2V0VVRDRGF0ZVN0cmluZyIsImxhc3RTZW50SGVhcnRiZWF0RGF0ZSIsImhlYXJ0YmVhdHMiLCJzaW5nbGVEYXRlSGVhcnRiZWF0IiwiaGJUaW1lc3RhbXAiLCJ2YWx1ZU9mIiwib3ZlcndyaXRlIiwiaGVhcnRiZWF0c1RvU2VuZCIsInVuc2VudEVudHJpZXMiLCJoZWFydGJlYXRzQ2FjaGUiLCJtYXhTaXplIiwic2xpY2UiLCJoZWFydGJlYXRFbnRyeSIsImhiIiwiZGF0ZXMiLCJjb3VudEJ5dGVzIiwicG9wIiwiZXh0cmFjdEhlYXJ0YmVhdHNGb3JIZWFkZXIiLCJoZWFkZXJTdHJpbmciLCJzdWJzdHJpbmciLCJfY2FuVXNlSW5kZXhlZERCUHJvbWlzZSIsInJ1bkluZGV4ZWREQkVudmlyb25tZW50Q2hlY2siLCJwcmVFeGlzdCIsIkRCX0NIRUNLX05BTUUiLCJvbnN1Y2Nlc3MiLCJjbG9zZSIsImRlbGV0ZURhdGFiYXNlIiwib251cGdyYWRlbmVlZGVkIiwib25lcnJvciIsInJlYWRIZWFydGJlYXRzRnJvbUluZGV4ZWREQiIsImhlYXJ0YmVhdHNPYmplY3QiLCJleGlzdGluZ0hlYXJ0YmVhdHNPYmplY3QiLCJhcGlLZXkiLCJhdXRoRG9tYWluIiwic3RvcmFnZUJ1Y2tldCIsIm1lc3NhZ2luZ1NlbmRlcklkIiwiY29tbW9uanNHbG9iYWwiLCJnbG9iYWwiLCJlc20iLCJnb29nIiwibCIsImFhIiwiYmEiLCJkYSIsIk1hdGgiLCJyYW5kb20iLCJlYSIsImZhIiwiYmluZCIsImhhIiwidW5zaGlmdCIsInEiLCJpbmRleE9mIiwiamEiLCJyIiwiJCIsImFjIiwiZiIsImgiLCJtIiwidiIsInMiLCJyYSIsIk4iLCJtYSIsIm5hIiwib2EiLCJ3IiwiZGVmYXVsdFByZXZlbnRlZCIsInBhIiwicWEiLCJ0ZXN0IiwidHJpbSIsImV4ZWMiLCJzYSIsInRhIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwieCIsInVhIiwidmEiLCJDYSIsIndhIiwieSIsInhhIiwieWEiLCJ6YSIsInRvTG93ZXJDYXNlIiwiQWEiLCJCYSIsImRvY3VtZW50TW9kZSIsIkRhIiwiRWEiLCJGYSIsInBhcnNlRmxvYXQiLCJJYSIsIkdhIiwicGFyc2VJbnQiLCJLYSIsInoiLCJyZWxhdGVkVGFyZ2V0IiwiYnV0dG9uIiwic2NyZWVuWSIsInNjcmVlblgiLCJjbGllbnRZIiwiY2xpZW50WCIsIm1ldGFLZXkiLCJzaGlmdEtleSIsImFsdEtleSIsImN0cmxLZXkiLCJzdGF0ZSIsInBvaW50ZXJJZCIsInBvaW50ZXJUeXBlIiwiY2hhbmdlZFRvdWNoZXMiLCJzcmNFbGVtZW50Iiwibm9kZU5hbWUiLCJmcm9tRWxlbWVudCIsInRvRWxlbWVudCIsInBhZ2VYIiwicGFnZVkiLCJOYSIsInByZXZlbnREZWZhdWx0IiwicmV0dXJuVmFsdWUiLCJBIiwiT2EiLCJQYSIsInByb3h5Iiwic3JjIiwiY2FwdHVyZSIsImxhIiwiaWEiLCJRYSIsIlJhIiwiU2EiLCJUYSIsInNwbGl0IiwiVWEiLCJWYSIsIlhhIiwiV2EiLCJZYSIsIlphIiwiYWIiLCJvbmNlIiwiYmIiLCJjYiIsIk8iLCJlYiIsImZiIiwiYXR0YWNoRXZlbnQiLCJnYiIsImFkZExpc3RlbmVyIiwicmVtb3ZlTGlzdGVuZXIiLCJQIiwiaWIiLCJqYiIsImRldGFjaEV2ZW50Iiwia2IiLCJoYW5kbGVFdmVudCIsIkIiLCJTIiwiSiIsIkMiLCJsYiIsInQiLCJtYiIsIm5iIiwib2IiLCJuZXh0IiwidWIiLCJxYiIsImoiLCJyYiIsInJlc2V0Iiwic2IiLCJzZXRUaW1lb3V0IiwidGIiLCJ4YiIsInZiIiwid2IiLCJ5YiIsInpiIiwiZ2EiLCJUIiwiY2xlYXJUaW1lb3V0IiwiQWIiLCJCYiIsInN0YXJ0IiwiQ2IiLCJEYiIsIkViIiwiR2IiLCJIYiIsIkliIiwiRCIsIkxiIiwiRSIsIk5iIiwiT2IiLCJQYiIsIlFiIiwiUmIiLCJTVEFUX0VWRU5UIiwic3RhdCIsIkYiLCJTYiIsInNpemUiLCJUYiIsIlViIiwiTk9fRVJST1IiLCJGYiIsIlRJTUVPVVQiLCJWYiIsIktiIiwiSmIiLCIkYiIsIldiIiwiWGIiLCJZYiIsImJjIiwiWmIiLCJPUEVOIiwiY2MiLCJkYyIsIlciLCJVIiwiZWMiLCJWIiwiSSIsIkwiLCJHIiwiWSIsIk0iLCJjYSIsIksiLCJmYyIsIlhNTEh0dHBSZXF1ZXN0IiwiZ2MiLCJoYyIsImljIiwiamMiLCJrYyIsImxjIiwibWMiLCJxYyIsIkhhIiwidGMiLCJ2YyIsInNjIiwid2MiLCJyYyIsImlzTmFOIiwic3Vic3RyIiwieGMiLCJwYyIsIkgiLCJ1YyIsImFib3J0IiwieWMiLCJKYSIsInpjIiwiQWMiLCJCYyIsIkNjIiwiTGEiLCJNYSIsImdldFJlc3BvbnNlSGVhZGVyIiwiRGMiLCJFYyIsIkZjIiwiR2MiLCJIYyIsIkljIiwiTGMiLCJmb3JFYWNoIiwiWiIsIktjIiwiSmMiLCJvYyIsIlRleHREZWNvZGVyIiwiZGVjb2RlIiwic3RyZWFtIiwiY2FuY2VsIiwiTWIiLCJNYyIsIlJlZ0V4cCIsIk9jIiwiUGMiLCJRYyIsIlJjIiwiU2MiLCJhZCIsIlljIiwiVGMiLCJaYyIsImZsb29yIiwiYWJzIiwiZGVjb2RlVVJJIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZW5jb2RlVVJJIiwiJGMiLCJVYyIsIlZjIiwiV2MiLCJYYyIsIk5jIiwiYmQiLCJkZCIsImVkIiwiUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nIiwicGVyZm9ybWFuY2UiLCJnZXRFbnRyaWVzQnlUeXBlIiwibmV4dEhvcFByb3RvY29sIiwiZmQiLCJnZCIsImhkIiwiamQiLCJsZCIsIm9ubG9hZCIsIm9uYWJvcnQiLCJvbnRpbWVvdXQiLCJtZCIsIm5kIiwicmVhZHlTdGF0ZSIsIm9kIiwic3RhdHVzIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2VUZXh0IiwicmVzcG9uc2UiLCJzdGF0dXNUZXh0Iiwib25yZWFkeXN0YXRlY2hhbmdlIiwiSGVhZGVycyIsImNsZWFyIiwicmQiLCJrYSIsInFkIiwicGQiLCJzZW5kIiwiaGVhZGVycyIsImNyZWRlbnRpYWxzIiwiY2FjaGUiLCJib2R5IiwiZmV0Y2giLCJSZXF1ZXN0IiwiJGEiLCJhcnJheUJ1ZmZlciIsIlJlYWRhYmxlU3RyZWFtIiwiZ2V0UmVhZGVyIiwidGV4dCIsIlVpbnQ4QXJyYXkiLCJzZXRSZXF1ZXN0SGVhZGVyIiwiYXBwZW5kIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwic2QiLCJ0ZCIsInVkIiwidmQiLCJ3ZCIsInpkIiwiQWQiLCJCZCIsImxvY2F0aW9uIiwicHJvdG9jb2wiLCJ4ZCIsIm1velJlc3BvbnNlQXJyYXlCdWZmZXIiLCJDZCIsIkRkIiwiRWQiLCJpbnRlcm5hbENoYW5uZWxQYXJhbXMiLCJGZCIsInhtbEh0dHBGYWN0b3J5Iiwic3VwcG9ydHNDcm9zc0RvbWFpblhociIsImNvbmN1cnJlbnRSZXF1ZXN0TGltaXQiLCJmYXN0SGFuZHNoYWtlIiwiZW5jb2RlSW5pdE1lc3NhZ2VIZWFkZXJzIiwiZm9yY2VMb25nUG9sbGluZyIsImRldGVjdEJ1ZmZlcmluZ1Byb3h5IiwiR2QiLCJIZCIsInNlbmRCZWFjb24iLCJJbWFnZSIsIklkIiwiTWQiLCJMZCIsInJvdW5kIiwibWluIiwibWF4IiwiS2QiLCJOZCIsIkpkIiwicGIiLCJrZCIsImhvc3RuYW1lIiwicG9ydCIsIk9kIiwiUGQiLCJRIiwibWVzc2FnZVVybFBhcmFtcyIsIm1lc3NhZ2VIZWFkZXJzIiwiY2xpZW50UHJvdG9jb2xIZWFkZXJSZXF1aXJlZCIsImluaXRNZXNzYWdlSGVhZGVycyIsIm1lc3NhZ2VDb250ZW50VHlwZSIsInNlbmRSYXdKc29uIiwiaHR0cFNlc3Npb25JZFBhcmFtIiwiUiIsIlFkIiwiX19zbV9fIiwiUmQiLCJibG9ja1NpemUiLCJUZCIsInRvVXBwZXJDYXNlIiwiZ2V0UHJvdG90eXBlT2YiLCJGb3JtRGF0YSIsIndpdGhDcmVkZW50aWFscyIsInRpbWVvdXQiLCJ5ZCIsIl9fZGF0YV9fIiwiVWQiLCJWZCIsImlzRmluaXRlIiwiV2QiLCJZZCIsIlpkIiwiWCIsImFlIiwiYmUiLCJjZSIsIiRkIiwiZGUiLCJjZWlsIiwiTE4yIiwicG93IiwiYW5kIiwib3IiLCJ4b3IiLCJjcmVhdGVXZWJDaGFubmVsIiwiSFRUUF9FUlJPUiIsIkNPTVBMRVRFIiwiRXZlbnRUeXBlIiwiQ0xPU0UiLCJNRVNTQUdFIiwibGlzdGVuIiwibGlzdGVuT25jZSIsImdldExhc3RFcnJvciIsImdldExhc3RFcnJvckNvZGUiLCJnZXRTdGF0dXMiLCJnZXRSZXNwb25zZUpzb24iLCJnZXRSZXNwb25zZVRleHQiLCJzZXRXaXRoQ3JlZGVudGlhbHMiLCJkaWdlc3QiLCJtdWx0aXBseSIsIm1vZHVsbyIsImNvbXBhcmUiLCJ0b051bWJlciIsImdldEJpdHMiLCJmcm9tTnVtYmVyIiwiZnJvbVN0cmluZyIsIlhkIiwiY3JlYXRlV2ViQ2hhbm5lbFRyYW5zcG9ydCIsImdldFN0YXRFdmVudFRhcmdldCIsIkVycm9yQ29kZSIsIkV2ZW50IiwiU3RhdCIsIlBST1hZIiwiTk9QUk9YWSIsIkZldGNoWG1sSHR0cEZhY3RvcnkiLCJXZWJDaGFubmVsIiwiWGhySW8iLCJNZDUiLCJJbnRlZ2VyIiwidWlkIiwiaXNBdXRoZW50aWNhdGVkIiwidG9LZXkiLCJpc0VxdWFsIiwiVU5BVVRIRU5USUNBVEVEIiwiR09PR0xFX0NSRURFTlRJQUxTIiwiRklSU1RfUEFSVFkiLCJNT0NLX1VTRVIiLCJ1c2VyIiwiZ2V0VG9rZW4iLCJpbnZhbGlkYXRlVG9rZW4iLCJlbnF1ZXVlUmV0cnlhYmxlIiwic2h1dGRvd24iLCJ0b2tlbiIsImNoYW5nZUxpc3RlbmVyIiwiY3VycmVudFVzZXIiLCJmb3JjZVJlZnJlc2giLCJhdXRoIiwiYWRkQXV0aFRva2VuTGlzdGVuZXIiLCJhY2Nlc3NUb2tlbiIsInJlbW92ZUF1dGhUb2tlbkxpc3RlbmVyIiwiZ2V0VWlkIiwiYXBwQ2hlY2siLCJhZGRUb2tlbkxpc3RlbmVyIiwicmVtb3ZlVG9rZW5MaXN0ZW5lciIsImNyeXB0byIsIm1zQ3J5cHRvIiwiZ2V0UmFuZG9tVmFsdWVzIiwidHQiLCJldCIsIm90Iiwic2VnbWVudHMiLCJvZmZzZXQiLCJsZW4iLCJjb21wYXJhdG9yIiwiY2hpbGQiLCJsaW1pdCIsImNvbnN0cnVjdCIsInBvcEZpcnN0IiwicG9wTGFzdCIsImZpcnN0U2VnbWVudCIsImxhc3RTZWdtZW50IiwiaXNFbXB0eSIsImlzUHJlZml4T2YiLCJpc0ltbWVkaWF0ZVBhcmVudE9mIiwidG9BcnJheSIsInV0IiwiY2Fub25pY2FsU3RyaW5nIiwiaHQiLCJwYXRoIiwiZW1wdHlQYXRoIiwiY29sbGVjdGlvbkdyb3VwIiwiaGFzQ29sbGVjdGlvbklkIiwiZ2V0Q29sbGVjdGlvbkdyb3VwIiwiZ2V0Q29sbGVjdGlvblBhdGgiLCJEdCIsInBlIiwicm9vdCIsIlRlIiwiRU1QVFkiLCJjb3B5IiwiQkxBQ0siLCJsZWZ0IiwicmlnaHQiLCJtaW5LZXkiLCJtYXhLZXkiLCJpbm9yZGVyVHJhdmVyc2FsIiwicmV2ZXJzZVRyYXZlcnNhbCIsImdldEl0ZXJhdG9yIiwiSWUiLCJnZXRJdGVyYXRvckZyb20iLCJnZXRSZXZlcnNlSXRlcmF0b3IiLCJnZXRSZXZlcnNlSXRlcmF0b3JGcm9tIiwiaXNSZXZlcnNlIiwibm9kZVN0YWNrIiwiZ2V0TmV4dCIsImhhc05leHQiLCJwZWVrIiwiY29sb3IiLCJSRUQiLCJmaXhVcCIsInJlbW92ZU1pbiIsImlzUmVkIiwibW92ZVJlZExlZnQiLCJyb3RhdGVSaWdodCIsIm1vdmVSZWRSaWdodCIsInJvdGF0ZUxlZnQiLCJjb2xvckZsaXAiLCJjaGVja01heERlcHRoIiwiY2hlY2siLCJFZSIsImZpcnN0IiwibGFzdCIsImZvckVhY2hJblJhbmdlIiwiZm9yRWFjaFdoaWxlIiwiZmlyc3RBZnRlck9yRXF1YWwiLCJBZSIsInVuaW9uV2l0aCIsIml0ZXIiLCJQZSIsIlZlIiwiYmluYXJ5U3RyaW5nIiwidG9CYXNlNjQiLCJ0b1VpbnQ4QXJyYXkiLCJhcHByb3hpbWF0ZUJ5dGVTaXplIiwiY29tcGFyZVRvIiwiQ2UiLCJFTVBUWV9CWVRFX1NUUklORyIsIk9lIiwiZGF0YWJhc2VJZCIsInBlcnNpc3RlbmNlS2V5IiwiaG9zdCIsInNzbCIsImF1dG9EZXRlY3RMb25nUG9sbGluZyIsInVzZUZldGNoU3RyZWFtcyIsIiRlIiwiZGF0YWJhc2UiLCJpc0RlZmF1bHREYXRhYmFzZSIsImlpIiwicmkiLCJPSyIsIkNBTkNFTExFRCIsIlVOS05PV04iLCJJTlZBTElEX0FSR1VNRU5UIiwiREVBRExJTkVfRVhDRUVERUQiLCJOT1RfRk9VTkQiLCJBTFJFQURZX0VYSVNUUyIsIlBFUk1JU1NJT05fREVOSUVEIiwiUkVTT1VSQ0VfRVhIQVVTVEVEIiwiRkFJTEVEX1BSRUNPTkRJVElPTiIsIkFCT1JURUQiLCJPVVRfT0ZfUkFOR0UiLCJVTklNUExFTUVOVEVEIiwiVU5BVkFJTEFCTEUiLCJEQVRBX0xPU1MiLCJ3aSIsImJyIiwiX2UiLCJ3ZSIsIm1lIiwiZ2UiLCJ5ZSIsImJvb2xlYW5WYWx1ZSIsImludGVnZXJWYWx1ZSIsImRvdWJsZVZhbHVlIiwiQnQiLCJ0aW1lc3RhbXBWYWx1ZSIsInNlY29uZHMiLCJuYW5vcyIsInN0cmluZ1ZhbHVlIiwiZnJvbUJhc2U2NFN0cmluZyIsImZyb21VaW50OEFycmF5IiwieGUiLCJieXRlc1ZhbHVlIiwicmVmZXJlbmNlVmFsdWUiLCJnZW9Qb2ludFZhbHVlIiwibGF0aXR1ZGUiLCJsb25naXR1ZGUiLCJtYXBWYWx1ZSIsImZpZWxkcyIsIl9fdHlwZV9fIiwiZW4iLCJNQVhfU0FGRV9JTlRFR0VSIiwiUmUiLCJ2ZSIsImFycmF5VmFsdWUiLCJmcm9tTmFtZSIsInNvIiwiY2FjaGVTaXplQ29sbGVjdGlvblRocmVzaG9sZCIsInBlcmNlbnRpbGVUb0NvbGxlY3QiLCJtYXhpbXVtU2VxdWVuY2VOdW1iZXJzVG9Db2xsZWN0IiwiREVGQVVMVF9DT0xMRUNUSU9OX1BFUkNFTlRJTEUiLCJERUZBVUxUX01BWF9TRVFVRU5DRV9OVU1CRVJTX1RPX0NPTExFQ1QiLCIkdSIsIkRFRkFVTFQiLCJESVNBQkxFRCIsIkJ1Iiwic2kiLCJ0aW1lcklkIiwidm8iLCJQbyIsImJvIiwiVm8iLCJTbyIsIkRvIiwiQ28iLCJ4byIsIk5vIiwiZW5xdWV1ZUFmdGVyRGVsYXkiLCJrbyIsInNraXBEZWxheSIsImFzeW5jUXVldWUiLCJ0YXJnZXRUaW1lTXMiLCJvcCIsInJlbW92YWxDYWxsYmFjayIsInRpbWVySGFuZGxlIiwiaGFuZGxlRGVsYXlFbGFwc2VkIiwiZW5xdWV1ZUFuZEZvcmdldCIsImF1dGhDcmVkZW50aWFscyIsImFwcENoZWNrQ3JlZGVudGlhbHMiLCJkYXRhYmFzZUluZm8iLCJjbGllbnRJZCIsImF1dGhDcmVkZW50aWFsTGlzdGVuZXIiLCJhcHBDaGVja0NyZWRlbnRpYWxMaXN0ZW5lciIsImluaXRpYWxVc2VyIiwibWF4Q29uY3VycmVudExpbWJvUmVzb2x1dGlvbnMiLCJzZXRDcmVkZW50aWFsQ2hhbmdlTGlzdGVuZXIiLCJzZXRBcHBDaGVja1Rva2VuQ2hhbmdlTGlzdGVuZXIiLCJ2ZXJpZnlOb3RUZXJtaW5hdGVkIiwiaXNTaHV0dGluZ0Rvd24iLCJ0ZXJtaW5hdGUiLCJlbnRlclJlc3RyaWN0ZWRNb2RlIiwiZW5xdWV1ZUFuZEZvcmdldEV2ZW5XaGlsZVJlc3RyaWN0ZWQiLCJfb25saW5lQ29tcG9uZW50cyIsIl9vZmZsaW5lQ29tcG9uZW50cyIsInRoIiwib2giLCJfZGVsZWdhdGUiLCJyaCIsImNoIiwiaWdub3JlVW5kZWZpbmVkUHJvcGVydGllcyIsImxvY2FsQ2FjaGUiLCJjYWNoZVNpemVCeXRlcyIsIm5oIiwiZXhwZXJpbWVudGFsRm9yY2VMb25nUG9sbGluZyIsImV4cGVyaW1lbnRhbEF1dG9EZXRlY3RMb25nUG9sbGluZyIsImFoIiwiX2F1dGhDcmVkZW50aWFscyIsIl9hcHBDaGVja0NyZWRlbnRpYWxzIiwiX2RhdGFiYXNlSWQiLCJfYXBwIiwiX3BlcnNpc3RlbmNlS2V5IiwiX3NldHRpbmdzIiwiX3NldHRpbmdzRnJvemVuIiwiX2luaXRpYWxpemVkIiwiX3Rlcm1pbmF0ZWQiLCJfdGVybWluYXRlVGFzayIsIl9zZXRTZXR0aW5ncyIsInNlc3Npb25JbmRleCIsImlhbVRva2VuIiwiYXV0aFRva2VuRmFjdG9yeSIsImNsaWVudCIsIl9nZXRTZXR0aW5ncyIsIl9mcmVlemVTZXR0aW5ncyIsIl90ZXJtaW5hdGUiLCJ0b0pTT04iLCJzZXR0aW5ncyIsImhoIiwibW9ja1VzZXJUb2tlbiIsInByb2plY3QiLCJpYXQiLCJzdWIiLCJ1c2VyX2lkIiwicGF5bG9hZCIsImlzcyIsImF1ZCIsImV4cCIsImF1dGhfdGltZSIsImZpcmViYXNlIiwic2lnbl9pbl9wcm92aWRlciIsImlkZW50aXRpZXMiLCJhbGciLCJjcmVhdGVNb2NrVXNlclRva2VuIiwicGgiLCJMbyIsInZpc2liaWxpdHlTdGF0ZSIsImVucXVldWUiLCJjcmVhdGVBbmRTY2hlZHVsZSIsInZlcmlmeU9wZXJhdGlvbkluUHJvZ3Jlc3MiLCJBaCIsIl9xdWV1ZSIsIl9maXJlc3RvcmVDbGllbnQiLCJfb2ZmbGluZUNvbXBvbmVudFByb3ZpZGVyIiwiX29ubGluZUNvbXBvbmVudFByb3ZpZGVyIiwiX3VuaW5pdGlhbGl6ZWRDb21wb25lbnRzUHJvdmlkZXIiLCJfb2ZmbGluZUtpbmQiLCJraW5kIiwiX29mZmxpbmUiLCJfb25saW5lIiwiYmgiLCJoZWFydGJlYXRDb250cm9sbGVyIiwidHJpZ2dlckhlYXJ0YmVhdCIsImdldEFwcCIsInByb2R1Y3ROYW1lIiwiX2IiLCJlbXVsYXRvckhvc3RzIiwiZ2V0RGVmYXVsdEVtdWxhdG9ySG9zdCIsInNlcGFyYXRvckluZGV4IiwibGFzdEluZGV4T2YiLCJnZXREZWZhdWx0RW11bGF0b3JIb3N0bmFtZUFuZFBvcnQiLCJQcm9qZWN0UmVwb3NpdG9yeUxvY2FsIiwicHJvamVjdHMiLCJnZXRQcm9qZWN0cyIsImdldFByb2plY3RCeUlkIiwiYWRkUHJvamVjdCIsIm5ld1Byb2plY3QiLCJkZWxldGVQcm9qZWN0IiwiYWRkZWRQcm9qZWN0IiwiYWRkRGVmYXVsdFByb2plY3QiLCJjaGVja2VkIiwiY2hlY2tib3hEaXYiLCJvbkNsaWNrIiwiY2xhc3NMaXN0IiwidXBkYXRlQ2hlY2tNYXJrIiwidG9nZ2xlIiwidGVtcFN2ZyIsImlubmVySFRNTCIsImFkZExlYWRpbmdaZXJvcyIsIm51bWJlciIsInRhcmdldExlbmd0aCIsInNpZ24iLCJmb3JtYXRJU08iLCJfb3B0aW9ucyRmb3JtYXQiLCJfb3B0aW9ucyRyZXByZXNlbnRhdGkiLCJvcmlnaW5hbERhdGUiLCJSYW5nZUVycm9yIiwiZm9ybWF0IiwicmVwcmVzZW50YXRpb24iLCJ0ek9mZnNldCIsImRhdGVEZWxpbWl0ZXIiLCJ0aW1lRGVsaW1pdGVyIiwiZGF5IiwiZ2V0RGF0ZSIsIm1vbnRoIiwiZ2V0TW9udGgiLCJ5ZWFyIiwiZ2V0RnVsbFllYXIiLCJnZXRUaW1lem9uZU9mZnNldCIsImFic29sdXRlT2Zmc2V0IiwiaG91ck9mZnNldCIsIm1pbnV0ZU9mZnNldCIsImhvdXIiLCJnZXRIb3VycyIsIm1pbnV0ZSIsImdldE1pbnV0ZXMiLCJzZWNvbmQiLCJnZXRTZWNvbmRzIiwic2VwYXJhdG9yIiwidGltZSIsInRvZG9JdGVtIiwidG9kb0l0ZW1EaXYiLCJ0b2RvSXRlbUhlYWRlciIsInRleHRDb250ZW50IiwidG9kb0l0ZW1Db250ZW50IiwicHJvamVjdFNwYW4iLCJwcm9qZWN0TGluayIsImhyZWYiLCJwcm9qZWN0U2VsZWN0IiwicHJvamVjdE9wdGlvbiIsInNlbGVjdGVkIiwib25JdGVtQ2hhbmdlIiwicHJpb3JpdHlMYWJlbCIsInByaW9yaXR5U2VsZWN0IiwicHJpb3JpdGllcyIsInByaW9yaXR5TnVtIiwicHJpb3JpdHlPcHRpb24iLCJkZXNjcmlwdGlvbkxhYmVsIiwiZGVzY3JpcHRpb25JbnB1dCIsImR1ZURhdGVMYWJlbCIsImR1ZURhdGVTZWxlY3RvciIsImlzQ29tcGxldGVTcGFuIiwiaXNDb21wbGV0ZUNoZWNrYm94IiwiZGVsZXRlQnV0dG9uIiwibGlua3MiLCJsaW5rIiwicmVuZGVyIiwiYWRkQ29udGFpbmVyIiwiY2xhc3NOYW1lIiwiaWNvbkNvbnRhaW5lciIsImFkZEljb24iLCJjaGV2cm9uIiwiZHJvcGRvd24iLCJkaXNwbGF5IiwiZHJvcGRvd25MaXN0IiwiZHJvcGRvd25MaXN0SXRlbSIsImxpc3RJdGVtTGluayIsImNvbnRhaW5zIiwiaGVhZGVyIiwibG9nb0NvbnRhaW5lciIsImxvZ29JY29uIiwibG9nb1RleHQiLCJidXR0b25zQ29udGFpbmVyIiwib25IZWFkZXJMaW5rQ2xpY2siLCJuZXdQYWdlIiwiaWNvbiIsImxpbmtJdGVtIiwibGlua0EiLCJsaW5rVGV4dCIsImxpbmtJY29uIiwibGlua0l0ZW1OdW1iZXIiLCJpdGVtcyIsIm1haW5MaW5rcyIsInNpZGViYXJEaXYiLCJtYWluTGlua3NMaXN0IiwibWFpbkxpbmtJdGVtIiwicHJvamVjdExpc3QiLCJjcmVhdGVQcm9qZWN0TGlzdCIsInByb2plY3RMaXN0SGVhZGVyIiwicHJvamVjdExpc3RIZWFkZXJMaW5rIiwiYWRkUHJvamVjdExpbmtzIiwicGFyZW50IiwicHJvamVjdEl0ZW0iLCJpc0JlZm9yZSIsImRpcnR5RGF0ZVRvQ29tcGFyZSIsImRhdGVUb0NvbXBhcmUiLCJ0b2RvSXRlbXNMaXN0IiwicmVuZGVyTGlzdEl0ZW1zIiwiaXRlbTEiLCJpdGVtMiIsInRvZG9JdGVtc0xpc3RJdGVtIiwiY2hlY2tCb3giLCJ0b2RvSXRlbU5hbWUiLCJ0b2RvSXRlbUR1ZURhdGUiLCJwcm9qZWN0RGV0YWlsRGl2IiwicHJvamVjdERldGFpbEhlYWRlciIsImVtcHR5VG9kb0l0ZW1zVGV4dCIsImRpc2FibGVkIiwiYWRkVG9kb0l0ZW1Db250YWluZXIiLCJhZGRUb2RvSXRlbUhlYWRlciIsInRvZG9JdGVtRm9ybSIsIm9uRm9ybVN1Ym1pdCIsIm5hbWVMYWJlbCIsIm5hbWVJbnB1dCIsImRlc2NyaXB0aW9uVGV4dEFyZWEiLCJkdWVEYXRlUGlja2VyIiwicHJvamVjdExhYmVsIiwic3VibWl0QnV0dG9uIiwiZm9ybSIsImNoZWNrVmFsaWRpdHkiLCJyZXBvcnRWYWxpZGl0eSIsImZvcm1EYXRhIiwiYWRkUHJvamVjdENvbnRhaW5lciIsInRvZG9JdGVtTGlzdENvbnRhaW5lciIsInRvZG9JdGVtTGlzdEhlYWRlciIsInBhZ2VzIiwiY2hhbmdlUGFnZSIsInNpZGViYXIiLCJtYWluQ29udGVudCJdLCJzb3VyY2VSb290IjoiIn0=